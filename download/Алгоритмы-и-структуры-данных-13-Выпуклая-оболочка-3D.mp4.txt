[00:00.000 --> 00:05.720]  Стороной, ну обязательно с стороной многогранника.
[00:05.720 --> 00:09.880]  Конечно, да, конечно, конечно, конечно.
[00:09.880 --> 00:18.480]  Ну потенциально можно, но это нам нужно строить уравнение плоскости, проецировать туда все
[00:18.480 --> 00:25.720]  точки, ну типа выкидывать какую-то координату. Это не самое приятное занятие. Лучшее. Ну и это тоже.
[00:25.720 --> 00:34.760]  Вот, то еще раз давайте овервью алгоритма. Мы сначала нашли какое-то одно ребро.
[00:34.760 --> 00:43.800]  Кстати, как? Давайте подумаем. Хорошо, давайте поймем, как найти то самое ребро Е.
[00:43.800 --> 00:51.320]  Ну типа того, да, как найти первое ребро Е.
[00:56.560 --> 01:02.000]  Вот, давайте сначала возьмем самую нижнюю точку с минимальным Z.
[01:02.000 --> 01:05.160]  Чего?
[01:11.160 --> 01:16.400]  Ну да, ну в смысле из таких несколько, то как обычно минимальную по Y, среди таких минимальную по X.
[01:16.400 --> 01:23.920]  Вот. Ну давайте опять для удобства, я считаю, что точка с таким Z одна.
[01:23.920 --> 01:30.000]  Дальше я понимаю, что у меня все точки лежат выше, чем она. То есть я могу провести вот такую
[01:30.000 --> 01:36.800]  опорную плоскость с фиксированным Z вот такую вот горизонтальную. Такую, что все остальные
[01:36.800 --> 01:42.880]  точки лежат выше нее. Ну теперь как найти какое-нибудь ребро, которое точно лежит в нашем многограннике?
[01:53.920 --> 01:59.280]  Вот это я не уверен. Это, кажется, неправда.
[01:59.280 --> 02:10.720]  Я бы сказал так, давайте мы возьмем такой вектор, от которого расстоит угол до плоскости вот этой
[02:10.720 --> 02:17.880]  горизонтальной. Минимально возможен? Вот этот угол минимален. Вот, если он нулевой, то мы живем в
[02:17.880 --> 02:23.480]  плоскости, уж там как-нибудь одно ребровые поклоблочки мы найдем. Там можно типа, вот если это
[02:23.480 --> 02:29.960]  точка минимальная, то нужна та, от которой угол, на которой угол максимален. Ну как обычно, когда мы,
[02:29.960 --> 02:34.200]  если мы в плоскости живем, мы знаем, что одна точка вершины, как найти другую сторону. Ну вот
[02:34.200 --> 02:39.160]  надо все посортировать. Ну не посортировать, а найти короче максимальную, с максимальным таким углом.
[02:39.160 --> 02:45.720]  Вот. А вот в этом пространственном случае, если у меня здесь одна точка и есть все остальные, я
[02:45.720 --> 02:52.560]  могу для каждой точки провести вот такой вектор, посчитать, какой угол этот вектор образует с
[02:52.560 --> 02:58.600]  горизонтальной плоскостью и взять минимальный угол среди всех таких. Вот. Ну, посчитать угол с
[02:58.600 --> 03:04.920]  плоскостью, наверно, не очень приятно. Можно считать, так как-то тоже через смешанное произведение говорят,
[03:04.920 --> 03:13.920]  можно это делать. Ну, во-первых, смотрите, можно считать не угол до плоскости, а угол с нормалью,
[03:13.920 --> 03:26.880]  то есть вот, картинку перерисую. А нет, тут как раз более-менее руками, кажется, нужно это делать.
[03:26.880 --> 03:36.120]  Вот у меня есть опорная плоскость, есть какая-то стартовая точка. Как понять угол между каким-то
[03:36.120 --> 03:43.160]  вектором и плоскостью? Ну, это то же самое, что 90 градусов минус вот этот угол. Да, ну,
[03:43.160 --> 03:48.800]  а между векторами мы уж как-нибудь угол найдем. У нас есть, например, скаллярное произведение,
[03:48.800 --> 03:54.600]  которое принимает, ну, как бы, после деления надлинно возвращает косинус, и нам нужно найти
[03:54.600 --> 04:11.440]  максимальный угол вот здесь, то есть минимальный косинус. Базис в этой плоскости? Нет, объем,
[04:11.440 --> 04:16.000]  ну, объем содержит не только угол, но еще и вот как бы длинный вектор учитывает, к сожалению.
[04:16.000 --> 04:23.200]  Поэтому, ну, тут как раз кажется, либо надо прям в тупую мерить углы, либо как-нибудь, ну, там,
[04:23.200 --> 04:29.720]  считать квадрат скаллярное произведение, делить на квадраты длин, тогда не будет этих самых доблов,
[04:29.720 --> 04:36.200]  но будет там в больших целых числах. Вот, короче, так или иначе, можно найти вектор, который ближе
[04:36.200 --> 04:46.680]  всего к нашей плоскости, и это точно будет ребро. Так, нормально же? Ну вот, все, значит,
[04:46.680 --> 04:51.760]  тогда алгоритм, да, мы находим сначала одно ребро вот этим способом. Дальше давайте делать
[04:51.760 --> 04:56.600]  следующее. Для каждого найденного ребра давайте заведем очередь ребер, которые нам надо обработать.
[04:56.600 --> 05:01.200]  Достаем сначала вот это вот ребро E, изначальное ребро, которое мы нашли, добавляем в очередь.
[05:01.200 --> 05:06.920]  Достаем ребра из очереди по одному. У нас есть ребро. Давайте мы вот таким вот образом найдем
[05:06.920 --> 05:13.920]  относительно этого ребра самые крайние точки, вот эти крайние страницы книжки, если корешок
[05:13.920 --> 05:24.800]  поместить вдоль этого ребра. Да, мы найдем такие две плоскости. Ну, вот здесь надо две найти в
[05:24.800 --> 05:29.800]  самом начале. На самом деле можно взять одну, да, то есть можно сначала вот здесь вот найти две и
[05:29.800 --> 05:36.080]  потом уже искать по одной, но это все тонкость несущественная. То есть можно найти вот эти две
[05:36.080 --> 05:42.840]  крайние плоскости, они задают нам какие-то новые ребра. То есть, скажем, вот мы нашли какой-то
[05:42.840 --> 05:47.000]  треугольник, да, тогда мы говорим, что, грубо говоря, вот эта вот грань, вот эти штуки задают мне
[05:47.000 --> 05:57.800]  ребра многогранника. Ну и дальше, если их еще не было в очереди, то я их туда добавляю. Ну и факт.
[05:57.800 --> 06:15.040]  Ну вот это, да, всегда добавится точно. Ну что, это совсем неприятно. Я бы все-таки делал скорее так,
[06:15.040 --> 06:21.320]  да, что у меня, я все-таки давайте добавлю треугольник такой полностью, а потом, а потом в
[06:21.320 --> 06:26.240]  момент, если я, скажем, буду для этого ребра находить две самые крайние, пойму, что они как бы
[06:26.240 --> 06:32.200]  параллельны друг к другу, то есть у меня, на самом деле, вот это ребро, оно лежит в грани, ну вот в этой вот,
[06:32.200 --> 06:37.080]  да, и тогда по факту ребра на это надо удалить. Ну надо еще тогда сделать проверочку, что если у меня
[06:37.080 --> 06:42.440]  две самые крайние полуплоскости, они параллельны, то есть как раз образуют угол 180 градусов развернутый,
[06:42.440 --> 06:47.640]  то мне нужно это ребро удалить и те два треугольника, которые я построил, склеить. Ну и там опять вот
[06:47.640 --> 06:53.120]  эти два новых ребра, вот эти два новых найденных ребра добавить в очередь и запустить уже от них.
[06:53.120 --> 07:13.680]  Вот так вроде будет терпимо. Так, ну что, ау? Да, ну из них, значит, среди таких надо опять какую-то выбрать, да?
[07:13.680 --> 07:23.760]  Ну, смотрите, кажется, что, кажется, что вот, вот в этот момент, когда я проговорил, что если я понимаю,
[07:23.760 --> 07:28.960]  что ребро, на самом деле, внутри грани, а не граница грани, тогда его можно просто удалить и тогда вроде
[07:28.960 --> 07:34.720]  тоже ничего не сломается. Даже если это ребро я нашел не как ребро, а как диагональ в грани какой-то,
[07:34.720 --> 07:40.000]  то опять я встаю в него, нахожу, что у меня книжечка полностью раскрыта на 180 градусов,
[07:40.000 --> 07:43.160]  нахожу там какие-то два треугольника, это стираю. То есть, грубо говоря, у меня была
[07:43.160 --> 07:48.280]  треангуляция четырехугольника, да, я понял, что вот это ребро надо удалить, потому что она лежит в грани.
[07:48.280 --> 08:02.600]  Ну, кажется, кажется, этот, этот случай, этот вбирает в себя. Да, да. Ну, потому что мы переберем только
[08:02.600 --> 08:22.640]  нормальные ребра и плюс, видимо, какие-то диагонали, да. Нет. Ну, в смысле, в смысле, еще раз, конечно, есть
[08:22.640 --> 08:28.080]  проверка, что если ребро уже в очередь, то мы ее не добавляем туда, его туда не добавляем. Нужен,
[08:28.400 --> 08:33.400]  еще какой-то типа, что-то типа сета, которое для каждой ребра говорит о новой очереди или там,
[08:33.400 --> 08:37.520]  может оно уже вообще было обработано, тогда его нет смысла добавлять в очередь. Тогда мы в очереди
[08:37.520 --> 08:44.640]  явно обработаем только какие-то ребра, ну и вообще у нас на самом деле каждое ребро порождает два
[08:44.640 --> 08:50.800]  новых ребра и поэтому у нас время работы будет как раз пропорционально размеру.
[08:50.800 --> 09:06.920]  Да, это как раз не сложно. Это пишется.
[09:06.920 --> 09:25.160]  Почему симпотика такая? Согласны ли вы, что она такая, если у нас все грани треугольные?
[09:25.160 --> 09:35.600]  Сейчас у нас есть верификатор. Ну, просто потому что каждое ребро порождает грани,
[09:35.600 --> 09:42.720]  как бы там грани примерно столько же сколько ребер и там каждый обрабатывается за ОАТН. А дальше
[09:42.720 --> 09:48.120]  надо аккуратно повозиться, типа ну пусть у нас есть как бы грани, который многоугольник на самом
[09:48.120 --> 09:51.480]  деле. Как мы ее обрабатываем? Мы сначала скажем, добавим вот это ребро, потом вот так
[09:51.480 --> 09:55.360]  триангулируем, добавим вот эти два, потом это удалено, добавим вот эти два, потом это удалено,
[09:55.360 --> 10:01.040]  добавим вот эти два. Ну, кажется, время работы это плюс количество диагоналей в какой-то
[10:01.040 --> 10:05.120]  триангуляции. Ну, в смысле, вот это к увеличивается на количество диагоналей в триангуляции. Их там
[10:05.120 --> 10:17.120]  тоже от числа ребер на границе, это тоже типа вот к получается сумма. Давайте разберемся сначала,
[10:17.120 --> 10:29.720]  ладно, потом вопрос. Вопросы может? Окей. Хорошо, тогда давайте попробуем Зайн Логен, еще алгоритм.
[10:29.720 --> 10:49.080]  Нет. Так, сейчас будет перерыв, да, про корректность. Ну, а что, ну понятно же там,
[10:49.080 --> 10:55.880]  книжечка. Не, вообще про про корректность тут как бы надо сказать примерно следующее, что, что
[10:55.880 --> 11:01.800]  такое грань вообще, как можно воспринимать грань. Грани у вас выступает такой, ну, набор точек по факту,
[11:01.800 --> 11:06.720]  да, ну вот на границе многоугольника, что если провести через них плоскость, то все остальные будут
[11:06.720 --> 11:11.920]  жать по одну сторону от этой плоскости. В каком-то смысле мы это и делаем, да, у нас как бы мы знаем,
[11:11.920 --> 11:16.120]  что вот эта вот эта часть какой-то граня, мы в каком-то смысле рассматриваем все плоскости через
[11:16.120 --> 11:21.560]  эту грань проходящие и из них выбираем вот ту самую крайний, ну, точнее две крайние, которые с двух
[11:21.560 --> 11:30.920]  сторон все обрамляют, вот. Идеально студент уже не будет решать. Не будет, не будет. И теорки не будет. Давайте
[11:30.920 --> 11:37.440]  дальше. Тоже не будет, скорее всего. Садитесь, давайте. Я не знаю.
[11:48.440 --> 11:59.600]  Так, как это делать за NLogin? Не знаю, будет ли это проще для понимания? Сейчас проверим. Может там
[11:59.600 --> 12:07.880]  меньше технических деталей может быть будет. Посмотрим. Значит, смотрите. Тут идея такая. Будет
[12:07.880 --> 12:14.480]  инкрементальный рандомизированный алгоритм. Значит, мы будем идти по точкам инкрементально
[12:14.480 --> 12:21.600]  рандомизированных, будем идти по точкам в порядке 1, 2, 3 и так далее N и будем поддерживать текущую
[12:21.600 --> 12:28.840]  выпуклую оболочку для рассмотренного множества точек. Ну, давайте как-нибудь начнем. Как начать?
[12:28.840 --> 12:34.600]  Нам нужен какой-нибудь многогранник на каких-то вершинах. Ну, наверное, можно начать с каких-нибудь
[12:34.600 --> 12:40.360]  четырех точек. Давайте я для удобства буду считать, что у меня текущая выпуклая оболочка всегда уже
[12:40.360 --> 12:44.400]  многогранник. Значит, мне нужно, наверное, тогда найти четыре вершины, не лежащие в одной плоскости,
[12:44.400 --> 12:50.360]  и понятно тогда, что их выпуклая оболочка это как бы тетраэдр с вершинами на них. Любые четыре точки
[12:50.360 --> 12:54.200]  задают как раз тетраэдр. То есть, есть три в одной плоскости, есть одна, не лежащая в той же
[12:54.200 --> 13:02.280]  плоскости. Вот как раз все ребра между ними задают тетраэдр. Ну, конечно, если у нас исходно все
[13:02.280 --> 13:06.000]  N точек в одной плоскости, у нас задача двумерная, и дальше мы как-нибудь уже на плоскости-то решим.
[13:06.000 --> 13:11.400]  Вот, значит, иначе я говорю, что за линейное время можно найти четыре точки, не лежащие в одной
[13:11.400 --> 13:17.480]  плоскости. Ну, скажем, берем первую, берем вторую, дальше находим третью, не лежащую с ними на одной
[13:17.480 --> 13:21.960]  прямой. То есть, перебираем все остальные, ищем не лежащую с ними на одной прямой. Нашли третью. И дальше
[13:21.960 --> 13:26.000]  идем, ищем четвертую, не лежащую с ними в одной плоскости. Это все делается просто одним проходом по
[13:26.000 --> 13:34.840]  точкам. Итак, значит, старт. Это у нас тетраэдр на каких-то четырех точках.
[13:34.840 --> 13:48.160]  Вот какая-то такая картинка. Это база нашего алгоритма. Мы начинаем с такого тетраэдра. Вот.
[13:48.160 --> 13:53.440]  Давайте все остальные точки я случайно перемешаю. Ну, в смысле, веду на них случайный порядок.
[13:53.440 --> 13:59.000]  Н-4 точки, я их по рандом-шафлю, будет теперь какой-то новый случайный порядок точек P5,
[13:59.000 --> 14:04.120]  и так далее, Pn. То есть, вот здесь были первые четыре, все остальные я случайно посаштировал.
[14:04.120 --> 14:18.000]  Случайно переставил, точнее. Что? Да нет. Нет. Ну, типа, мы просто идем 1, 2, 3, 4, 5, и так далее,
[14:18.000 --> 14:22.720]  ну, по изначальному порядку вершин находим первый попавшийся тетраэдр. Это неважно. Начало
[14:22.720 --> 14:27.720]  может быть любым. Вот. А вот все остальные мы случайно перемешали. И дальше давайте по одной
[14:27.720 --> 14:36.000]  вводить точки в рассмотрение и перестраивать текущую выпуклооболочку. Вот. Идеальный случай
[14:36.000 --> 14:40.080]  был бы, когда точка попадает внутрь текущего многогранника, тогда ничего перестраивать не
[14:40.080 --> 14:45.560]  нужно, она внутри, ее просто игнорируем. В случае же, когда она не внутри, значит, она снаружи,
[14:45.560 --> 14:55.000]  надо что-то перестроить. Да, ну вот представьте, давайте я опять нарисую картинку с усеченной пирамидкой.
[14:55.000 --> 15:08.520]  Вот. Представьте, что точка, новая там, новая точка приходит вот где-то вот здесь,
[15:08.520 --> 15:12.440]  чуть-чуть выше, чем верхняя грань. Значит, если она приходит совсем чуть-чуть выше,
[15:12.560 --> 15:20.840]  где-то вот здесь вот она лежит, тогда нужно просто вот эти вот новые четыре треугольника добавить,
[15:20.840 --> 15:25.360]  то есть у меня есть вот эта крышка верхняя, прямоугольник какой-то, у меня есть точка чуть-чуть
[15:25.360 --> 15:29.920]  выше него, понятно, мне нужно просто провести отрезки во все вершины этого прямоугольника и
[15:29.920 --> 15:36.200]  сказать, что вот эти треугольники новая грань. Вот. Если же она будет сильно выше, где-то вот там вот,
[15:36.820 --> 15:43.040]  вот здесь вот возможно, да, то у меня на самом деле нужно будет также что-то удалить. Мне нужно
[15:43.040 --> 15:47.140]  будет целиком этот прямоугольник удалить, потому что у меня все будет лежать вот в такой вот Пирамидке.
[15:47.140 --> 15:51.560]  Вот, значит, вот до этой вершины, до этой, вот до этой. Вот,
[15:51.560 --> 15:55.320]  то есть вот верхняя крышка удаляется, все будет целиком вложено в такой,
[15:55.320 --> 16:02.620]  в такую Пирамидку с вершины вот этой точки. То есть мне на самом деле нужно будет сделатьести
[16:02.620 --> 16:09.780]  следующее, мне нужно будет найти те грани, которые я вижу из этой точки, и их
[16:09.780 --> 16:14.740]  удалить. То есть, если я стою здесь как раз, вот если мы очень высоко над
[16:14.740 --> 16:18.820]  пирамидкой, то мы видим не только верхнюю эту крышку, но и вот эти четыре
[16:18.820 --> 16:23.020]  боковые стороны, они-то могут под углом, но мы их будем видеть. И вот как раз их
[16:23.020 --> 16:27.820]  нужно будет удалить, и вот этот внешний контур, вот эту внешнюю
[16:27.820 --> 16:31.900]  границу, которую мы видим, то есть, представьте, я над этой пирамидкой стою
[16:31.900 --> 16:36.420]  сверху, вижу какие-то грани, и крайние точки, что я вижу, это как раз нижний вот
[16:36.420 --> 16:40.420]  этот вот опорный прямоугольник в плоскости. Вот мне нужно на него провести
[16:40.420 --> 16:45.180]  отрезки, и сказать, что это мои будут новые грани.
[16:45.180 --> 17:04.980]  Ну вот. Еще раз? Если мы где-то сзади стоим, типа, да? Ну, то же самое, на самом деле, в
[17:04.980 --> 17:08.300]  общем случае, будет ровно это. Мы стоим в точке, мы смотрим на наш многогранник.
[17:08.300 --> 17:13.460]  Какие-то грани мы видим, какие-то не видим. Ну, неформально, да? Вот то, что мы
[17:13.460 --> 17:18.580]  видим, образует для нас какой-то контур. Там какие-то фигурки, вот мы их видим,
[17:18.580 --> 17:22.220]  они чем-то обрамляются каким-то выпуклым многоугольником. То есть, грубо говоря,
[17:22.220 --> 17:24.940]  если я стою в точке, все, что я вижу, вот я могу так нарисовать, будет какой-то
[17:24.940 --> 17:29.140]  выпуклый многоугольник. Вот мне нужно все, что внутри него, все грани, которые, все
[17:29.140 --> 17:32.780]  грани, которые я вижу, мне нужно удалить, а в границу этого выпуклого
[17:32.780 --> 17:36.220]  многоугольника провести треугольнички, сказать, что вот это все, все внешний грань.
[17:36.220 --> 17:54.540]  Например, если бы она лежала в этой же плоскости, да? Хороший вопрос. Ну, тогда
[17:54.540 --> 17:58.260]  надо просто грани склеить, на самом деле. Это важный, важный выраженный случай.
[17:58.260 --> 18:01.420]  Ну, представьте, вот у меня есть вот эта пирамидка усеченная, вот здесь точка.
[18:01.420 --> 18:06.420]  Тогда что меняется? Ну, у меня эта грань, она как бы остается, но она немножко так
[18:06.420 --> 18:09.900]  продлевается, на самом деле, да? То есть, будет что-то вот такое. Ну, а здесь вот эта
[18:09.900 --> 18:13.980]  грань пропадает, у меня будут вот здесь вот такие, такие касательные. Но у меня
[18:13.980 --> 18:18.140]  просто верхняя грань продлевается. Если у меня вот здесь вот был какой-то столик
[18:18.140 --> 18:23.580]  сверху, какая-то граница, я встал сюда, я пускаю лучи, как я вижу эту грань, ну,
[18:23.580 --> 18:27.940]  то есть, она будет выглядеть ребром, но я просто пускаю туда ребра и объединяю все это
[18:27.940 --> 18:31.220]  в одну большую грань. То есть, вот этот треугольник объединиться с этим
[18:31.220 --> 18:35.820]  прямоугольником, удаля по дороге вот это вот ребро, которое было здесь, раньше было
[18:35.820 --> 18:44.460]  ребром, теперь пропало. Мы будем делать именно так, потому что, потому что на той
[18:44.460 --> 18:49.900]  грани и так могло быть много точек, а мы добавляем всего, ну, как бы всего два
[18:49.900 --> 18:53.700]  новых ребра. То есть, проще удалить одну и добавить два новых. Ну, просто, то есть,
[18:53.700 --> 18:57.740]  по смыслу мы ровно это делаем, мы удаляем старую грань, добавляем новую, но с
[18:57.740 --> 19:01.220]  точки зрения времени работы, будет проще добавить две новые точки в старую, чем
[19:01.220 --> 19:03.740]  заводить новую, скажем так.
[19:12.740 --> 19:21.060]  Нам удобнее хранить ребра, потому что, потому что реброинцидент на двум граням
[19:21.060 --> 19:29.380]  всегда. Вот. Ну, и вообще, как бы, ребро более-менее однозначно задает грань,
[19:29.380 --> 19:32.620]  которую нам принадлежит. Особенно, если мы ребра ориентируем в обе стороны, то есть, я
[19:32.620 --> 19:37.060]  для каждого ребра ввожу два полуребра, то есть, ориентированный, одно вот такое,
[19:37.060 --> 19:41.500]  другое вот такое. И если я считаю, что каждая грань обходится против всего
[19:41.500 --> 19:46.260]  стрелки, если смотреть с внешности многогранника, тогда у него просто ребро
[19:46.260 --> 19:52.580]  однозначно грани соответствует. А если мы как бы, как вершины храним, то, ну, короче,
[19:52.580 --> 19:56.980]  непонятно. То есть, там много граней, непонятно какая из них. Собственно, как и
[19:56.980 --> 20:01.460]  здесь, да, мы за опорную, за опорный привет, мы были, брали ребро. Относительно него
[20:01.460 --> 20:04.900]  две крайние грани однозначно определены. Если бы мы брали вершину, то ничего бы не
[20:04.900 --> 20:11.300]  получилось. Вот. Значит, давайте, что-то, что-то здесь попишу. Мы что-то перебираем,
[20:11.300 --> 20:15.060]  рассматриваем точку в этом порядке.
[20:20.940 --> 20:27.940]  Удаляем видимые грани,
[20:29.780 --> 20:38.300]  видимые из нее грани. Сейчас, сейчас все проговорим. Видимые из нее грани. Значит,
[20:38.300 --> 20:43.420]  я что-то удалил. Дальше, то, что я видел, образовывало какой-то контур. И вот мне
[20:43.420 --> 20:56.860]  нужно в вершины этого контура провести еще ребра. Проводим ребра в вершины контура.
[20:56.860 --> 21:10.500]  Вот. Ну, как-то, вот что-то такое мы хотим делать. Значит, да, что такое видимые грани
[21:10.500 --> 21:21.020]  и невидимые грани? Это как раз очень просто. Смотрите, у нас каждая грань,
[21:21.500 --> 21:27.500]  каждая грань многогранника разбивает пространство на два, на два полупространства. То, что лежит по ту же
[21:27.500 --> 21:34.160]  сторону, что и многогранник, и по другую, по внешнюю сторону. Давайте просто говорим, что точка видит
[21:34.160 --> 21:41.420]  грань, если она лежит во внешнем полупространстве относительно вот этой плоскости. Ну, то есть,
[21:41.420 --> 21:49.420]  То есть как бы вот из нее, вот она и многогранник по разные стороны от этой плоскости.
[21:49.420 --> 22:08.420]  Точка P видит грань F.
[22:08.420 --> 22:12.420]  Ну или так, да.
[22:12.420 --> 22:15.420]  Так, значит, P видит грань F.
[22:15.420 --> 22:36.420]  Если P лежит в другом, ну я напишу открытом полупространстве, задаваемом F,
[22:36.420 --> 22:44.420]  чем многогранник.
[22:44.420 --> 22:48.420]  Открытая, то есть если я лежу на плоскости, то я считаю, что я грань не вижу.
[22:48.420 --> 22:53.420]  Это как раз тот выраженный случай, если я из точки смотрю на плоскость, в которой я лежу, то я ее как бы не вижу.
[22:53.420 --> 22:55.420]  Мне надо ее полностью обозреть.
[22:55.420 --> 23:02.420]  Это мне нужно как раз подняться наверх, мне нужно быть над этой плоскостью.
[23:02.420 --> 23:08.420]  Ну а там как-нибудь плоскость...
[23:08.420 --> 23:13.420]  Ну как понять, например, вот если у меня есть какая-то грань, то тут, например, есть какие-то два ребра.
[23:13.420 --> 23:15.420]  Ну давайте, давайте вот на этом примере.
[23:15.420 --> 23:22.420]  Вот есть у меня такая грань, то есть у меня в ней два ребра, и есть какое-нибудь еще ребро вот такое вот ведущее в другую вершину.
[23:22.420 --> 23:25.420]  Ну тогда как бы там одно смешанное произведение должно быть положительным,
[23:25.420 --> 23:28.420]  вовнутрь вот туда вот в сторону многогранника должно быть положительным,
[23:28.420 --> 23:30.420]  а во внешнюю сторону должно быть отрицательным.
[23:30.420 --> 23:34.420]  Короче, смешанное произведение должно быть разных знаков.
[23:34.420 --> 23:36.420]  То есть одно по одну сторону, другое по другую.
[23:42.420 --> 23:49.420]  Содаваемом f, чем многогранник. То есть многограни по одну сторону от плоскости, точка p по другую.
[23:53.420 --> 23:56.420]  Вот. Ну собственно все, вот так будем делать.
[23:56.420 --> 24:01.420]  Значит в каждом моменте времени, для каждой точки я нахожу видимые грани.
[24:01.420 --> 24:07.420]  Вот их там может быть много штук, если у меня какой-то сложный сейчас многогранник, я могу увидеть много граний.
[24:07.420 --> 24:10.420]  Они там как-то, ну они образуют вот связанную область.
[24:10.420 --> 24:17.420]  Я нахожу границу, нахожу контур этой грани, все что внутри удаляю и провожу ребра в контур.
[24:22.420 --> 24:25.420]  Вот давайте тогда проговорим, что мы будем хранить.
[24:27.420 --> 24:29.420]  Давайте пропишем, как хранить многогранник.
[24:33.420 --> 24:43.420]  У меня будет три сущности, у меня будет вершина, у меня будет полуребро и у меня будет грань.
[24:45.420 --> 24:49.420]  Для каждой из них будет свой, ну там не знаю, свой класс грубо говоря, своя какая-то сущность.
[24:50.420 --> 24:53.420]  Что такое полуребро? Полуребро это как раз ориентированное ребро.
[24:54.420 --> 25:10.420]  В случае с тетраедром я хочу сделать так, чтобы на каждой грани вот эти вот полуребро, ориентированные ребра были согласованы с обходом против щелвой стрелки.
[25:10.420 --> 25:17.420]  То есть скажем вот для этой грани, для вот этого вот бокового треугольника я хочу, чтобы у меня ребра были ориентированы вот так вот.
[25:18.420 --> 25:31.420]  Значит тогда я в частности для каждого вот такого полуребра, для каждого ориентированного ребра, буду скажем хранить ссылку или указатель на ту грань, которая лежит по правильную сторону, по левую сторону от ребра.
[25:31.420 --> 25:36.420]  То есть у меня есть ребро вот это вот, по левую сторону лежит такая эта грань, по правую другая эта.
[25:36.420 --> 25:38.420]  Вот давайте хранить то, что по левую руку.
[25:39.420 --> 25:52.420]  Для полуребра храним указатель на грань по левую руку.
[25:52.420 --> 26:09.420]  Ну и еще нужно хранить указатель на противоположное полуребро, то есть на то же ребро, проходимое в противоположную сторону.
[26:09.420 --> 26:14.420]  Тогда у меня будет указатель вот с такого ребра на противоположное, вот на такое соответственно.
[26:14.420 --> 26:22.420]  Ну и эта штука уже будет соответствовать вот такому правильному обходу моего вот этого другого треугольника и другой грани.
[26:22.420 --> 26:31.420]  То есть у меня эта грань тоже обходится вот таким вот способом, ну и как бы у меня есть биекция между полуребром и гранями.
[26:31.420 --> 26:37.420]  Ну не биекция в смысле, а в каком-то смысле однозначном отображение между полуребром и гранями.
[26:37.420 --> 26:43.420]  Что каждая грань обходится таким-то набором ребер, а каждое полуребро задает такую-то грань.
[26:43.420 --> 26:47.420]  То, что по левую руку от него ту гранину и задает.
[26:47.420 --> 26:51.420]  Да, это вот ребро со стрелочкой.
[26:51.420 --> 26:57.420]  Вот, ну какое-то такое, не знаю, так обычно называют.
[26:57.420 --> 27:02.420]  Так, значит тогда, что мы хотим?
[27:02.420 --> 27:12.420]  Значит, для новой точки П мы хотим удалить, ну собственно, я это уже писал, да, удалить все видимые грани.
[27:15.420 --> 27:17.420]  Вот, это понятно?
[27:17.420 --> 27:22.420]  А дальше мне нужно еще вот контур определить, да, по левому руку от него.
[27:22.420 --> 27:32.420]  Если я знаю какие грани я вижу, мне еще нужно понять, какие вот были внешние ребра, которые я, в которые нужно провести грани.
[27:32.420 --> 27:36.420]  Что это за ребра, скажите, пожалуйста?
[27:36.420 --> 27:38.420]  То есть...
[27:38.420 --> 27:40.420]  Еще раз?
[27:40.420 --> 27:42.420]  Продолжающее что?
[27:52.420 --> 27:54.420]  Да, я понял, я понял.
[27:54.420 --> 27:59.420]  Но не только такие, потому что если я провожу в стол, то мне еще вот такие ребра надо.
[27:59.420 --> 28:01.420]  Там вниз, вот в эти точки.
[28:01.420 --> 28:07.420]  Вот я спрашиваю, как понять тот контур, в который нужно провести грани, нужно провести отрезки.
[28:08.420 --> 28:10.420]  Да, именно так.
[28:10.420 --> 28:13.420]  Давайте сделаем такое предположение.
[28:13.420 --> 28:20.420]  Давайте считать, что я стою где-то вот здесь, многограни где-то там, я в этой точке смотрю на многограни и давайте нарисую, что я вижу.
[28:20.420 --> 28:24.420]  Вот я вижу, какая там грани, там в этом месте.
[28:24.420 --> 28:31.420]  Да, именно так. Давайте сделаем такое предположение. Давайте считать, что я стою где-то вот здесь,
[28:31.420 --> 28:36.420]  многограни где-то там, я в этой точке смотрю на многограни, и давайте нарисую, что я вижу.
[28:36.420 --> 28:43.420]  Я вижу какой-то такой вот выпуклый контур, который разбит на какие-то там выпуклые многоугольники.
[28:43.420 --> 28:52.420]  Что-то такое. Соответственно, это какая-то грань наклона, это еще какая-то другая грань, и здесь есть какие-то ребра.
[28:52.420 --> 28:57.420]  Мне нужно найти как раз вот эти вот внешние ребра, мне нужно удалить все, что здесь было внутри,
[28:57.420 --> 29:04.420]  мне нужно все вот эти полуребра удалить, все эти грани стереть, мне нужно провести грани новые вот в эти крайние ребра.
[29:04.420 --> 29:13.420]  Крайние это как раз те такие, что по одну сторону от них у меня получается грань видимая мной, а по другую невидимая.
[29:13.420 --> 29:19.420]  Потому что для всех вот этих внутренних ребр как раз обе примыкающие к ней грани будут видимыми,
[29:19.420 --> 29:23.420]  а для граничных как раз одна будет видимая, другая невидимая.
[29:23.420 --> 29:42.420]  Поэтому контур, в который надо провести новые грани, это те полуребра, причем более того, здесь будет хорошая ориентация, вот такая вот на них,
[29:42.420 --> 29:47.420]  потому что каждая грань обходится как раз будет против всего стрелки.
[29:47.420 --> 30:06.420]  Значит, это те полуребра, что грань по левую руку видима, а по правую невидима.
[30:06.420 --> 30:22.420]  Если я знаю список всех этих граней, которые надо удалить, я по ним прохожу, проверяю все полуребра, которые я здесь вижу,
[30:22.420 --> 30:27.420]  и те из них, которые как раз такие граничные, в них надо провести новые грани.
[30:27.420 --> 30:35.420]  И если заодно, то есть если я опускаю новую грань через точку, через новую пришедшую точку П, и вот то ребро, мне еще нужно понять,
[30:35.420 --> 30:42.420]  а вот та другая грань, то есть смотрите, вот это полуребро было, оно соответствовало какой-то вот такой грани, который я удаляю, и какой-то другой такой боковой.
[30:42.420 --> 30:48.420]  Если внезапно наша новая точка лежит в той же самой плоскости, которая вот по правую руку от того ребра лежала,
[30:48.420 --> 30:54.420]  значит мне нужно склеить мой вводимый треугольник и то ли вот то боковое ребро, эту боковую грань.
[30:54.420 --> 31:04.420]  Вот. Что-то такое будем делать. Ну да, да, да, да. Вот.
[31:04.420 --> 31:19.420]  Вот. Отлично. Вот ровно это как раз надо починить. Потому что в целом мы как бы описали алгоритм.
[31:19.420 --> 31:27.420]  Если мы храним наш многогранник в такой структуре, то вот приходит новая точка. Как ее обработать?
[31:27.420 --> 31:32.420]  Надо найти все видимые грани. Кстати говоря, если она ни одной не видит, значит она внутри, ее можно скипнуть.
[31:32.420 --> 31:46.420]  Чуть более хитро. Погодите, погодите. Давайте еще раз проговорю.
[31:46.420 --> 31:55.420]  Вот приходит новая точка. Я должен понять, какие грани она видит, какие не видит. Если ни одной не видит, значит она внутри.
[31:55.420 --> 32:02.420]  Потому что не видит, это значит, что она в том же полупространстве относительно всех граний, что и многогранник.
[32:02.420 --> 32:06.420]  Значит, она лежит в пересечении полупространства, то есть внутри многогранника. Поэтому я ее скипаю.
[32:06.420 --> 32:13.420]  А если она что-то видит, то значит ее нужно добавить. Все, что она видит, все вот эти грани, которые она видит, надо удалить.
[32:13.420 --> 32:19.420]  И добавить новые вот такие вот треугольные грани. Если что, их склеить с продолжениями вот в тех же плоскостях.
[32:19.420 --> 32:26.420]  Значит, все, что осталось, это научиться понимать видимые грани.
[32:26.420 --> 32:37.420]  Как быстро находить видимые грани.
[32:37.420 --> 32:40.420]  Очень просто. Давайте это хранить.
[32:40.420 --> 32:45.420]  Вот в каждый момент времени для каждой грани и для каждой точки, ну или там просто типа,
[32:45.420 --> 32:54.420]  давайте будем хранить для каждой еще не добавленной в оболочку точки, будем хранить те грани, которые она видит.
[32:54.420 --> 33:17.420]  Ничего, не пугайтесь. В каждый момент для каждой точки храним список видимых граний.
[33:17.420 --> 33:21.420]  Чего?
[33:21.420 --> 33:28.420]  Не огромное. Вот не огромное будет.
[33:28.420 --> 33:34.420]  Будем хранить это очень-очень простым образом. У меня будет двудольный граф.
[33:34.420 --> 33:40.420]  Такой, что в одной доле будут еще не добавленные вершины. То есть вот вершины с номерами больше, чем текущие.
[33:40.420 --> 33:45.420]  Начиная с какой-то P i и P plus 1 и так далее, вплоть до последней.
[33:45.420 --> 33:54.420]  Во второй грани все присутствующие на данный момент грани моего многогранника. Все грани f1 и так далее fk.
[33:54.420 --> 34:01.420]  Ну и просто типа вот граф, да, я провожу ребро между точкой и гранью, если из этой точки видна такая-то грань.
[34:01.420 --> 34:03.420]  Вот у меня будет какой-то такой двудольный граф.
[34:03.420 --> 34:07.420]  Для каждой точки я знаю видимые грани, для каждой грани знаю точки, из которых она видна.
[34:07.420 --> 34:18.420]  Будем хранить такую структуру.
[34:18.420 --> 34:31.420]  Вот. Ну давайте просто хранить не только выпуклую оболочку, но и раз я такую структуру обвожу, давайте покажем, как ее пересчитывать.
[34:31.420 --> 34:36.420]  Это не просто двудольный граф. Одна доля это все еще не добавлены в оболочку точки.
[34:36.420 --> 34:43.420]  Другая доля это все текущие грани, которые сейчас есть в многограннике.
[34:43.420 --> 34:48.420]  Провожу ребро, если из точки видна грань.
[34:48.420 --> 34:53.420]  Вот. Значит как этот граф хранить? Ну давайте с самого начала, да, вот мы начинаем с тетраэдра.
[34:53.420 --> 34:57.420]  Давайте для тетраэдра посмотрим, как это сделать.
[34:57.420 --> 34:59.420]  Ну вроде не очень сложно. У меня всего 4 грани.
[34:59.420 --> 35:03.420]  Значит я завожу во второй доле 4 точки.
[35:03.420 --> 35:07.420]  Здесь будут все элементы моего множества.
[35:07.420 --> 35:09.420]  П5, П6 и так далее, ПН.
[35:09.420 --> 35:14.420]  Ну и для каждой точки, для каждой грани я уж, ну, наверное, могу понять, видно оно или нет.
[35:14.420 --> 35:16.420]  Это за линию причем делается.
[35:16.420 --> 35:20.420]  Потому что у меня всего 4 грани и N точек.
[35:20.420 --> 35:39.420]  Значит, старт, строим граф, давайте назову его граф видимости, граф видимости для тетраэдра.
[35:39.420 --> 35:42.420]  Да, это работает причем за линию и тут никаких пока проблем нет.
[35:42.420 --> 35:47.420]  Вот. И давайте теперь просто поймем, как этот граф перестраивается по дороге, по пути нашего алгоритма.
[35:47.420 --> 35:53.420]  Что происходит с графом, когда мы вводим в рассмотрение новую точку, какие-то грани удаляем, какие-то новые добавляем.
[36:07.420 --> 36:14.420]  Ну, во-первых, за счет того, что мы храним для каждой точки список видимых граний, мы точно знаем, что надо удалять.
[36:14.420 --> 36:18.420]  То есть как раз вот мы сразу ответили на вопрос, как быстро находить видимые грани.
[36:18.420 --> 36:21.420]  Очень просто, это просто список тех граний, в которые есть сейчас ребра.
[36:21.420 --> 36:24.420]  Вот в этом графе, куда есть ребра.
[36:24.420 --> 36:28.420]  У меня есть ребра во все вот эти грани, я их все вижу, я их все удаляю, строю новые грани.
[36:28.420 --> 36:33.420]  Значит, единственная проблема, это понять, какие появились новые конфликты.
[36:33.420 --> 36:37.420]  То есть какие теперь появились новые видимости, потому что я ввел новые грани.
[36:37.420 --> 36:41.420]  Мне нужно для них понять, какие точки их видят.
[36:42.420 --> 36:45.420]  Значит, после рассмотрения очередной точки
[36:51.420 --> 36:53.420]  появляются новые грани.
[36:58.420 --> 37:04.420]  Ну, соответственно, для каждой из них и для каждой из оставшихся точек надо понять, видна эта грани или нет.
[37:05.420 --> 37:08.420]  Вот. Хорошо.
[37:08.420 --> 37:11.420]  И это делается, на удивление, тоже несложно.
[37:11.420 --> 37:14.420]  Потому что смотрите, какие грани мы вводим.
[37:14.420 --> 37:19.420]  Вот если вот это была наша видимая область, вот эти грани были видимы, я их все удалил,
[37:19.420 --> 37:25.420]  то я ввожу грани, ну, давайте в простом случае, являющиеся треугольниками с вершиной в этой точке
[37:25.420 --> 37:28.420]  и с основаниями в каждом из вот этих вот ребер.
[37:28.420 --> 37:31.420]  То есть вот я прохожу по контуру, такие вот все треугольнички делаю.
[37:31.420 --> 37:34.420]  С вершиной в этой точке и с основаниями в этих ребрах.
[37:36.420 --> 37:39.420]  Так, то есть, да вот давайте, есть какое-то ребро Е.
[37:41.420 --> 37:45.420]  Тогда я утверждаю, что та новая грань, которую я построил,
[37:45.420 --> 37:50.420]  вот если новая построенная грань видна из какой-то точки ПЖ,
[37:51.420 --> 37:57.420]  то тогда обязательно хотя бы одна из грани инцидентных этому ребру в старом многограннике была тоже видна из ПЖ.
[37:58.420 --> 38:00.420]  Значит, картинка.
[38:03.420 --> 38:04.420]  Вот ребро Е.
[38:05.420 --> 38:11.420]  Вот, давайте я нарисую вот такую одну грань,
[38:11.420 --> 38:15.420]  и вот там где-то будет другая грань.
[38:15.420 --> 38:19.420]  Такая книжечка, так, не очень, давайте наоборот.
[38:20.420 --> 38:25.420]  Так вот, и вот так вот.
[38:28.420 --> 38:32.420]  То есть такая книжечка, опять у меня вот это ребро, есть вот одна такая страничка, другая вот такая страничка.
[38:33.420 --> 38:37.420]  Вот до этого, до того как я перешел к новой точке П,
[38:37.420 --> 38:41.420]  у меня это ребро было инцидентно двум граням, вот этой и вот той.
[38:42.420 --> 38:46.420]  Дальше пришла какая-то точка П, давайте скажу, где-то она вот здесь, вот она где-то вот здесь.
[38:46.420 --> 38:48.420]  Она одну грань видит, другую не видит.
[38:48.420 --> 38:54.420]  Как раз у нас ребра Е, которые лежат на контуре, это такие, что одна грань видима, другая не видима.
[38:55.420 --> 38:58.420]  Я что?
[38:58.420 --> 39:00.420]  Еще раз?
[39:00.420 --> 39:02.420]  Я нарисовал только граней, в смысле.
[39:02.420 --> 39:06.420]  Эта грань, типа понятно, они там как-то еще до замыкаются, до всего многогранника.
[39:06.420 --> 39:08.420]  Я просто нарисовал вот эти две полуплоскости.
[39:08.420 --> 39:10.420]  Ну да.
[39:10.420 --> 39:12.420]  Вот.
[39:14.420 --> 39:17.420]  Значит, из точки П была видна вот эта грань.
[39:17.420 --> 39:22.420]  Значит, я ее удаляю и в частности провожу вот такую новую грань.
[39:22.420 --> 39:24.420]  Так, ну давайте где-нибудь ее вот здесь вот нарисую.
[39:24.420 --> 39:26.420]  Вот здесь вот.
[39:30.420 --> 39:33.420]  Ну, соответственно, у меня теперь, у меня была вот такая наклонная полоска, стала вот такая.
[39:33.420 --> 39:37.420]  И все вот здесь вот лежит в многограннике.
[39:37.420 --> 39:40.420]  Значит, тогда утверждение следующее.
[39:40.420 --> 39:45.420]  Пусть F, новая грань,
[39:46.420 --> 39:48.420]  новая грань,
[39:51.420 --> 39:57.420]  построенная по П или Бруге,
[40:00.420 --> 40:06.420]  и пусть F1, F2, это старая грань инцидентной Е.
[40:16.420 --> 40:22.420]  То есть вот эти две странички F1, F2, это старые грани, которые раньше были инцидентны Е.
[40:22.420 --> 40:29.420]  Тогда я утверждаю, что ПЖ видит F,
[40:31.420 --> 40:36.420]  то есть если ПЖ видит F, то она видела хотя бы одну из двух старых граней.
[40:37.420 --> 40:44.420]  ПЖ видела F1 или ПЖ видела F2.
[40:45.420 --> 41:04.420]  Ну почему?
[41:04.420 --> 41:08.420]  Потому что если ПЖ видит F, смотрите, то есть я по факту что я сделал,
[41:08.420 --> 41:12.420]  вот у меня при ребре Е была какая-то книжка вот с таким углом, скажем.
[41:12.420 --> 41:17.420]  Я взял и одну из граней чуть-чуть поднял, у меня увеличился угол.
[41:17.420 --> 41:20.420]  То есть у меня был сначала такой угол, теперь стал вот такой угол.
[41:20.420 --> 41:22.420]  Угол стал побольше.
[41:22.420 --> 41:25.420]  И теперь я проверяю, какие точки видят вот эту грань новую.
[41:25.420 --> 41:30.420]  Ну раз ПЖ видит эту новую грань, то она в частности видит ребро Е.
[41:32.420 --> 41:33.420]  Это что значит?
[41:33.420 --> 41:36.420]  Вот если я через это ребро проведу какую-нибудь плоскость,
[41:37.420 --> 41:40.420]  то значит по крайней мере...
[41:42.420 --> 41:44.420]  Сейчас, не так.
[42:00.420 --> 42:03.420]  То есть внутри, если мне где-то здесь...
[42:06.420 --> 42:08.420]  Ну да, еще раз смотрите.
[42:08.420 --> 42:11.420]  У меня даже есть книжечка.
[42:12.420 --> 42:15.420]  Вот представьте, вот это...
[42:19.420 --> 42:22.420]  Значит вот это старое ребро Е...
[42:22.420 --> 42:24.420]  Извините, пожалуйста.
[42:24.420 --> 42:26.420]  Значит это старое ребро Е.
[42:26.420 --> 42:28.420]  Это F1 и F2, которые я удаляю.
[42:28.420 --> 42:31.420]  Приходит новая грань F, скажем, где-то вот здесь.
[42:31.420 --> 42:33.420]  Я хочу сказать, что это старое ребро Е.
[42:33.420 --> 42:36.420]  Приходит новая грань F, скажем, где-то вот здесь.
[42:36.420 --> 42:38.420]  Я хочу сказать, что если кто-то ее видит,
[42:38.420 --> 42:41.420]  то она обязательно видела либо вот эту заднюю грань, либо переднюю.
[42:41.420 --> 42:42.420]  Ну почему?
[42:42.420 --> 42:46.420]  Давайте я какую-нибудь плоскость проведу через это ребро Е.
[42:46.420 --> 42:48.420]  Какую-нибудь плоскость через это ребро Е
[42:48.420 --> 42:50.420]  между вот этими гранями F1 и F2.
[42:50.420 --> 42:53.420]  Тогда, чтобы видеть новую грань...
[42:55.420 --> 42:58.420]  И давайте посмотрим, где наша новая точка ПЖ лежит.
[42:58.420 --> 43:02.420]  Она лежит как бы либо по одну сторону от этой плоскости, либо по другую.
[43:02.420 --> 43:05.420]  Если она лежит по эту сторону, то...
[43:10.420 --> 43:12.420]  Что, она обязательно одну из них видит, что ли?
[43:15.420 --> 43:16.420]  Ну, кажется, да.
[43:16.420 --> 43:20.420]  То есть если точка видит новую грань, то она, в частности, видит это ребро.
[43:20.420 --> 43:24.420]  Поэтому если она лежала, скажем, в этом полупространстве,
[43:24.420 --> 43:26.420]  она видела вот эту заднюю грань.
[43:26.420 --> 43:29.420]  Если она лежала в этом полупространстве, она видит вот эту грань.
[43:29.420 --> 43:33.420]  Поэтому если у нас есть новая какая-то грань, содержащая то же самое ребро Е,
[43:33.420 --> 43:36.420]  то хотя бы одну из старых граней она обязательно видела.
[43:36.420 --> 43:38.420]  То есть либо по одну сторону от плоскости, либо по другую.
[43:38.420 --> 43:40.420]  И хотя бы что-то мы точно видим.
[43:44.420 --> 43:45.420]  Как-то так.
[43:49.420 --> 43:50.420]  Упражнения.
[43:50.420 --> 43:51.420]  Вот.
[43:51.420 --> 43:58.420]  И тогда, чтобы понять, какие новые появились конфликты с новой гранью F,
[43:58.420 --> 44:05.420]  мне достаточно просто перебрать конфликты, которые имела F1 или F2.
[44:05.420 --> 44:08.420]  У меня получится какой-то номер точек, и для каждой из этих надо проверить,
[44:08.420 --> 44:10.420]  образует ли она конфликт с новой гранью F.
[44:11.420 --> 44:13.420]  Ну, конфликт-видимость, да, то есть.
[44:13.420 --> 44:14.420]  Чего?
[44:17.420 --> 44:25.420]  Значит, чтобы найти все Pj, из которых видна F,
[44:25.420 --> 44:31.420]  значит, мы перебираем все точки, из которых видны хотя бы одна F1 или F2.
[44:34.420 --> 44:38.420]  Перебираем все точки, из которых видна F1.
[44:38.420 --> 44:48.740]  в которых видна f, значит мы перебираем все точки,
[44:48.740 --> 44:54.620]  из которых видны хотя бы одна f1 или f2, перебираем
[44:54.620 --> 45:05.500]  все точки, из которых видны f1 или f2, но это легко сделать,
[45:05.500 --> 45:08.380]  потому что у меня есть вот такой вдольный граф,
[45:08.380 --> 45:11.300]  точки из которых видна данная грань, это просто те, ну
[45:11.300 --> 45:14.780]  как бы, откуда есть ребро в данную вот конкретную
[45:14.780 --> 45:15.780]  f.
[45:15.780 --> 45:26.860]  Я перебираю все такие точки, тестирую их на видимость,
[45:26.860 --> 45:29.660]  ну и если как бы тест пройден, то есть если она лежит по
[45:29.660 --> 45:33.220]  там правильную сторону от f, то я ввожу новый конфликт,
[45:33.660 --> 45:38.100]  ввожу условие, что эта точка видит ту грань, которую
[45:38.100 --> 45:39.100]  я только что добавил.
[45:39.100 --> 45:40.100]  Вот.
[45:40.100 --> 45:41.100]  Теперь все.
[45:41.100 --> 45:55.460]  Да, если у нас какой-то треугольник склеивается с одной старой
[45:55.460 --> 45:59.260]  граней, то на самом деле мне нужно просто отождествить,
[45:59.260 --> 46:02.020]  ну давайте еще раз картинку вот эту вот со столом сделаем.
[46:02.020 --> 46:23.660]  Вот, если у меня точка, то есть вот если я из этой точки
[46:23.660 --> 46:31.700]  вижу какое-то ребро g, которое склеивается с одной из
[46:31.700 --> 46:34.820]  старых граней, то по факту я просто я не ввожу новую
[46:34.820 --> 46:37.420]  вершину, то есть смотрите, вот здесь, когда я там обрамлял
[46:37.420 --> 46:40.660]  контур, я ввожу новые грани, вот это вот f, я ввожу новую
[46:40.660 --> 46:42.500]  вершину вот в ту правую долю.
[46:42.500 --> 46:46.100]  Если же строимый треугольник лежит в той же плоскости,
[46:46.100 --> 46:49.860]  что и соответствующая грань, которую я не удаляю, значит
[46:49.860 --> 46:52.220]  я просто не ввожу новую вершину и говорю, что этот
[46:52.220 --> 46:54.820]  треугольник задает ту же грань, ту же вершину в
[46:54.820 --> 46:56.140]  графе, что и вот эта вот грань.
[46:56.140 --> 46:58.740]  По факту я просто две грани склеиваю и не ввожу
[46:58.820 --> 47:03.820]  новой вершины в правую долю, а поскольку у меня плоскость
[47:03.820 --> 47:06.460]  задающая грань осталась той же самой, то и видимость
[47:06.460 --> 47:09.460]  у меня все те же самые, раз плоскость та же самая,
[47:09.460 --> 47:12.900]  то и все видимости сохранились, потому что плоскость не
[47:12.900 --> 47:13.900]  изменилась.
[47:13.900 --> 47:18.140]  Это как раз случай простой, что если мы лежим в той
[47:18.140 --> 47:20.700]  же плоскости, что одна из граней, мы просто склеиваем
[47:20.700 --> 47:25.140]  и вот это даже делать ничего не нужно, а если она где-то
[47:25.140 --> 47:30.180]  вот здесь, да, я там какие-то грани удаляю, то мне нужно
[47:30.180 --> 47:32.740]  протестировать для каждого ребра, вот для каждого
[47:32.740 --> 47:36.220]  ребра, который я здесь перебираю, для каждого контурного
[47:36.220 --> 47:41.060]  ребра, я тестирую вот эти две грани, смотрю на все,
[47:41.060 --> 47:43.580]  на все точки, которые из них видны, и каждую из
[47:43.580 --> 47:45.660]  них проверяю, а видно ли теперь из этой точки вот
[47:45.660 --> 47:46.660]  эту новую грань.
[47:46.660 --> 47:48.380]  Если видно, то добавляю это условие.
[47:48.380 --> 47:57.380]  Ну мы не обязаны, но как бы достаточно их точно
[47:57.380 --> 47:58.380]  перебрать.
[47:58.380 --> 48:03.580]  Ну то есть если отсюда следует это, то значит любая точка
[48:03.580 --> 48:05.980]  в объединении вот этих множеств, если она удалится
[48:05.980 --> 48:07.740]  этому условию, то мы как раз все переберем.
[48:07.740 --> 48:16.860]  Нет, нет, нет, ну мы просто проходим все в тупую по объединению.
[48:16.860 --> 48:22.940]  Не достаточно, не достаточно, нам как раз именно по объединению
[48:22.940 --> 48:23.940]  надо пройтись.
[48:23.940 --> 48:36.540]  Нет, нет, здесь дизъюнция, да, да, да, да, квадратная
[48:36.540 --> 48:37.540]  скобка.
[48:37.540 --> 48:43.060]  Вот, ну и все, утверждается, что тогда такая штука
[48:43.060 --> 48:59.140]  вся работает в среднем за n лог n, да, что?
[48:59.140 --> 49:03.900]  Говорю, если больше число размерности, то там, во-первых,
[49:03.900 --> 49:09.540]  квадратичное число может быть граней, и что вообще
[49:09.540 --> 49:11.900]  такое грань, я не знаю, я не знаю, что такое пространство
[49:11.900 --> 49:16.780]  является грань, это для меня too much, выше чем R3 я не умею
[49:16.780 --> 49:17.780]  разговаривать со всем.
[49:17.780 --> 49:20.780]  Давай, расскажете?
[49:20.780 --> 49:31.580]  Так, все ли я сказал здесь, что надо?
[49:31.580 --> 49:32.580]  Кажется все хорошо.
[49:32.580 --> 49:35.580]  Вопросы, может какие-то?
[49:35.580 --> 49:36.580]  Давайте.
[49:36.580 --> 49:49.460]  Это вот новая грань, смотрите, у меня новая добавляемая
[49:49.460 --> 49:53.580]  точка, вот я рассмотрел точку P, я понял, что из нее,
[49:53.580 --> 49:56.980]  ну скажем, вот F1 была видна, я тогда удаляю все, что было
[49:56.980 --> 50:00.420]  вот здесь, E это одна из контурных граней, одна из контурных
[50:00.420 --> 50:02.940]  ребер, я провожу новую плоскость, вот эту вот F, через P и
[50:02.940 --> 50:03.940]  ребро E.
[50:03.940 --> 50:09.820]  Так вот, я ввел новую грань, мне нужно понять, какие точки,
[50:09.820 --> 50:11.660]  то есть смотрите, у меня появилась новая грань, значит по факту
[50:11.660 --> 50:14.260]  появилась новая вершина вот этой правой доли, мне
[50:14.260 --> 50:18.300]  нужно понять, из каких точек она видна, вот я сейчас перебираю
[50:18.300 --> 50:22.420]  все вот эти точки, ну там пусть беру какую-то ПЖ, вот
[50:22.420 --> 50:25.260]  я тоже что нужно привести ребро из ПЖ в F, то есть она
[50:25.260 --> 50:29.020]  видит F только в случае, если она видела хотя бы одну
[50:29.020 --> 50:33.340]  из двух старых граней инцидентных E.
[50:33.340 --> 50:37.620]  Ну давайте без доказательств, ну типа вот, тут опять на
[50:37.620 --> 50:43.220]  картинке, ну типа вот, ну я вот там с книжкой пытался
[50:43.220 --> 50:46.900]  показать, то есть еще раз, вот у вас были две грань
[50:46.900 --> 50:50.860]  инцидентная E, вот эта вот книжка, пришел как бы,
[50:50.860 --> 50:53.540]  угол немножко расширился, чтобы видеть вторую грань
[50:53.540 --> 50:55.180]  надо было видеть хотя бы одну из двух старых.
[50:55.180 --> 51:00.180]  Берите с собой.
[51:00.180 --> 51:03.940]  Все, спасибо.
