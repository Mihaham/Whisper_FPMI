[00:00.000 --> 00:08.200]  Так, значит, что мы уже умеем с прошлого раза?
[00:08.200 --> 00:09.200]  Давайте начинать.
[00:09.200 --> 00:12.640]  Мы научились перемножать два многочлена за n log n,
[00:12.640 --> 00:17.720]  если n – это, ну, длина, скажем, каждого из них.
[00:17.720 --> 00:23.040]  Мы научились это делать в поле ZP, и мы избавились
[00:23.040 --> 00:24.040]  от рекурсии.
[00:24.040 --> 00:28.520]  Избавились от рекурсии, чтобы это работало чуть
[00:28.520 --> 00:30.640]  быстрее в плане реализации.
[00:30.640 --> 00:31.640]  Вот.
[00:31.640 --> 00:36.720]  Давайте тогда вернемся к задачке, в которой мы мотивировали
[00:36.720 --> 00:38.720]  наше вхождение в FFT.
[00:38.720 --> 00:48.040]  Значит, есть текст T и шаблон S.
[00:48.040 --> 00:57.440]  Надо найти все вхождения S в T не более, чем с K ошибками.
[00:57.440 --> 00:58.440]  Секунду.
[00:58.440 --> 00:59.440]  Вот.
[00:59.440 --> 01:04.440]  Значит, что мы хотим?
[01:04.440 --> 01:30.520]  Смотрите, вот есть строка T, и мы всюду прикладываем
[01:30.520 --> 01:31.520]  к ней строчку S.
[01:32.520 --> 01:36.280]  То есть вот здесь вот выделяем окошко той же длины, что
[01:36.280 --> 01:37.280]  и S.
[01:37.280 --> 01:38.280]  Вот здесь вот.
[01:38.280 --> 01:39.280]  Вот здесь вот.
[01:39.280 --> 01:42.560]  Ну, в общем, все окошки одинаковой длины, равной длине S мы выделяем.
[01:42.560 --> 01:48.960]  И хотим понять, сколько есть совпадений между S и окошком,
[01:48.960 --> 01:49.960]  который мы выделили.
[01:49.960 --> 01:52.360]  То есть в каком-то смысле нам нужно во всех вот таких
[01:52.360 --> 01:55.440]  вот подстрочках T фиксированной длины найти, сколько символов
[01:55.440 --> 01:59.680]  совпадают с S.
[01:59.680 --> 02:00.960]  Для этого мы сделаем следующее.
[02:00.960 --> 02:07.800]  Значит, мы запустим цикл по всем буквам, цикл по
[02:07.800 --> 02:11.240]  всем буквам из алфавита, и давайте одновременно
[02:11.240 --> 02:15.000]  и в T, и в S заменим все вхождения C на единички, а все вхождения
[02:15.000 --> 02:16.000]  остальных букв на нули.
[02:16.000 --> 02:27.440]  Значит, внутри цикла заменяем вхождение C на единицу, вхождение
[02:27.440 --> 02:28.320]  всех остальных на ноль.
[02:28.320 --> 02:45.640]  Значит, такой переход удобен тем, что теперь можно считать
[02:45.640 --> 02:48.280]  скалярные произведения вот этих вот кусочков,
[02:48.280 --> 02:51.920]  соответственно, окошков T и всей строки S, тогда скалярные
[02:51.920 --> 02:55.640]  произведения равно просто-напросто числу совпадающих C, потому
[02:55.640 --> 02:59.560]  что у нас только 1 на 1 дает какой-то вклад в скалярные
[02:59.560 --> 03:00.560]  произведения.
[03:00.560 --> 03:05.480]  Если там 0, 0 или 0, 1 или 1, 0, это будет 0 в вклад в произведение.
[03:05.480 --> 03:08.040]  Поэтому вот такое вот скалярное произведение такого окошка
[03:08.040 --> 03:13.000]  на S – это число C совпадающих в этом отрезке с S.
[03:13.000 --> 03:15.600]  Дальше, если мы возьмем вот этот следующий окошек
[03:15.600 --> 03:17.440]  на 1, звеним его, то опять скалярное произведение
[03:17.440 --> 03:21.160]  его с S – это сколько совпадающих C в этом окошке с S, ну и
[03:21.160 --> 03:22.160]  так далее.
[03:22.160 --> 03:24.320]  И тогда, если мы это сделаем, если мы как-то посчитаем
[03:24.320 --> 03:27.920]  все такие скалярные произведения для всех буквок и, соответственно,
[03:27.920 --> 03:30.320]  тогда для каждого окошка просуммируем, сколько было
[03:30.320 --> 03:33.920]  совпадений по каждому символу алфавита, то мы узнаем,
[03:33.920 --> 03:38.640]  в скольких позициях происходит, наоборот, совпадение.
[03:38.640 --> 03:42.880]  И если это количество совпадений хотя бы S-K, то значит, ошибок
[03:42.880 --> 03:44.200]  не больше, чем K.
[03:44.200 --> 03:45.200]  Понятно?
[03:45.200 --> 03:48.160]  Если совпадений хотя бы S-K, то значит, ошибок максимум
[03:48.160 --> 03:49.160]  K.
[03:49.800 --> 03:51.640]  Поэтому наша цель сделать следующую.
[03:51.640 --> 04:01.480]  Для каждого символа алфавита T из Сигма найти скалярные
[04:01.480 --> 04:14.040]  произведения всех подотресков длины S в T и T.
[04:19.160 --> 04:26.680]  И S, sorry.
[04:26.680 --> 04:30.280]  То есть мы выделяем все окошки вот такой вот длины
[04:30.280 --> 04:31.280]  в нашей строке.
[04:31.280 --> 04:33.320]  Ну теперь уже эта строка из 0 единиц, можно ее рассматривать
[04:33.320 --> 04:35.840]  просто как вектор чисел, да, соответственно, как многочлен
[04:35.840 --> 04:36.840]  или как вектор.
[04:36.840 --> 04:41.320]  Выделяем все такие подотрезочки и их все скалярно умножаем
[04:41.320 --> 04:44.040]  на S, где S тоже вектор чисел, единицы нулей.
[04:44.040 --> 04:46.200]  Каждое такое скалярное произведение, то количество
[04:46.200 --> 04:47.200]  совпадений.
[04:47.200 --> 04:48.560]  Если выделяем все скалярные произведения, то мы будем
[04:48.560 --> 04:55.840]  знать количество всех совпадений для каждого окошка с S.
[04:55.840 --> 05:11.080]  Далее для каждого подотрезка суммируем количество совпадений
[05:11.080 --> 05:20.480]  по всем буквам.
[05:20.480 --> 05:23.000]  Если оно хотя бы модуль S-Sk, то значит, получилось
[05:23.000 --> 05:44.720]  вхождение максимум с ошибками.
[05:44.720 --> 05:46.480]  Вот, значит, теперь остается для каждого сима алфавита
[05:46.480 --> 05:50.000]  посчитать скалярные произведения всех подотрезочков на какой-то
[05:50.000 --> 05:51.000]  фиксированный вектор S.
[05:51.000 --> 05:58.200]  Значит, сделается это следующим образом.
[05:58.200 --> 06:01.520]  Давайте мы будем воспринимать, как я уже сказал, будем воспринимать
[06:01.520 --> 06:04.160]  T просто как многочлен, да, потому что здесь написаны
[06:04.160 --> 06:06.000]  какие-то числа, там нолики, единички.
[06:06.000 --> 06:09.040]  Давайте эти числа воспринимать как коэффициенты многочлена.
[06:09.040 --> 06:12.680]  Соответственно, если здесь были какие-то цифры, T0 и
[06:12.680 --> 06:18.640]  так далее, T там какое-то, N-1, давайте, да, N-1, тогда я
[06:18.640 --> 06:24.080]  ставлю в соответствии многочлен T от X равный T0 плюс T1X, плюс
[06:24.080 --> 06:29.120]  так далее, плюс Tn-1 и Xn-1, стандартным образом многочлен
[06:29.120 --> 06:30.120]  сопоставляю.
[06:30.120 --> 06:33.720]  Вот, а для S мы сопоставим реверс для многочлен.
[06:33.720 --> 06:37.880]  То есть если у меня строка S состоит из симулов, точнее
[06:37.880 --> 06:44.440]  из чисел, S0 и так далее, SM-1, вот, здесь я веду многочлен
[06:44.440 --> 06:47.480]  с противоположной нумерацией, то есть младший коэффициент
[06:47.480 --> 06:49.440]  будет вот этот, а этот будет старшим.
[06:49.440 --> 06:55.480]  То есть я ввожу такой многочлен S от X, равно SM-1, плюс SM-2
[06:55.480 --> 07:03.680]  на X, S0 и Xn-1, вот, а дальше я их перемножу.
[07:03.680 --> 07:14.200]  Ну и давайте, например, посмотрим, какой будет коэффициент
[07:14.200 --> 07:18.960]  при X в степени m-1.
[07:18.960 --> 07:27.480]  То есть если я перемножаю вот эти две штучки, какой
[07:27.480 --> 07:29.600]  будет коэффициент при X в степени m-1?
[07:29.600 --> 07:32.640]  Ну понятно, надо перемножить T0 на S0, чтобы получить вот
[07:32.640 --> 07:37.520]  это вот первое слагаемое, а значит T0 на S0, либо можно
[07:37.520 --> 07:42.320]  взять T1X умножить на S1 и Xn-2, потому что там будет
[07:42.320 --> 07:48.160]  X и Xn-2, они сложатся, получится как раз M-1, будет M1S1, ну и
[07:48.160 --> 07:49.160]  так далее.
[07:49.160 --> 07:51.080]  В общем, мы вот так должны пройтись, чтобы получить
[07:51.080 --> 07:55.200]  одинаковую степень m-1, вот это у меня будет как раз
[07:55.200 --> 07:57.280]  первое необходимое нам скалярное произведение.
[07:57.280 --> 08:00.280]  Согласны?
[08:00.280 --> 08:04.680]  Просто перемножил два многочлена.
[08:04.680 --> 08:07.800]  Вот, ну и аналогично, если я рассмотрю, скажем, коэффициент
[08:07.800 --> 08:16.640]  при X в m-2, значит тоже, откуда он берется?
[08:16.640 --> 08:22.520]  Надо умножить вот это на это, то есть T1S0, либо вот
[08:22.520 --> 08:27.680]  здесь второе слагаемое, T2X2, здесь предпоследнее, S1Xn-2
[08:27.680 --> 08:31.800]  будет как раз X в m-2, то есть T2S1 получается коэффициент,
[08:31.800 --> 08:32.800]  ну и так далее.
[08:32.800 --> 08:35.800]  Опять мы идем вот так друг на встречу дружки двумя
[08:35.800 --> 08:44.840]  На указателях получится последнее слагаемое TMSM-1,
[08:44.840 --> 08:45.840]  ну и так далее.
[08:45.840 --> 08:47.440]  Если я аккуратно напишу коэффициенты при всех больших
[08:47.440 --> 08:49.520]  степенях X, то у меня как раз получатся вот такие
[08:49.520 --> 08:52.280]  вот штуки, которые в точности равны тому, чему нужно, потому
[08:52.280 --> 08:55.600]  что вот это, это скалярное произведение первого подотрезка
[08:55.600 --> 09:00.880]  в T на S, T0, T1 и так далее, умножить на S0, S1 и так далее.
[09:00.880 --> 09:04.000]  Вот это, это скалярное произведение второго
[09:04.000 --> 09:10.080]  подотрезка на S, T1, T2 и так далее, на S0, S1 и так далее.
[09:10.080 --> 09:14.520]  Ну и в итоге коэффициент при, давайте напишем, коэффициент
[09:14.520 --> 09:26.200]  при X в степени m-1 плюс какой-нибудь k есть TKS0 плюс TK плюс 1S1 и так
[09:26.200 --> 09:27.200]  далее.
[09:27.200 --> 09:38.520]  A плюс m-1, S m-1, это одно из нужных скалярных произведений,
[09:38.520 --> 09:41.400]  одно из необходимых скалярных произведений.
[09:41.400 --> 09:48.520]  Ну и всё, значит, мы нашу задачу, поиск всех скалярных
[09:48.520 --> 09:50.280]  произведений свели просто к тому, что переносит два
[09:50.280 --> 09:52.960]  многочленов, и они вот так волшебным образом, коэффициенты
[09:52.960 --> 09:56.440]  при нужных степенях X дают нам как раз те самые скалярные
[09:56.440 --> 09:57.440]  произведения.
[09:57.440 --> 10:06.000]  Значит, мы вот эту задачу, вот эту вот верхнюю решили
[10:06.000 --> 10:10.200]  за время n лог n, то есть для каждого фиксированного
[10:10.200 --> 10:13.560]  цена нужно переносить два многочлена, и где-то там
[10:13.560 --> 10:16.880]  при должных степенях X как раз хранятся те самые скалярные
[10:16.880 --> 10:17.880]  произведения.
[10:17.880 --> 10:20.600]  Да, ну и поскольку раз у меня есть два многочлена,
[10:20.600 --> 10:23.360]  один с n коэффициентами, другой с m, понятно, что m меньше
[10:23.360 --> 10:25.960]  равно n, потому что иначе задача не очень осмысленна,
[10:25.960 --> 10:29.160]  то есть n больше из них, и время произведения это
[10:29.160 --> 10:30.160]  n лог n.
[10:30.160 --> 10:33.160]  При этом многочлены очень хорошие, там только нули
[10:33.160 --> 10:35.880]  единицы в качестве коэффициентов, поэтому скорее всего никаких
[10:35.880 --> 10:38.680]  переполнений, никаких проблем с точностью не будет, если
[10:38.680 --> 10:39.680]  просто в комплексных считать.
[10:39.680 --> 10:40.680]  Да.
[10:40.680 --> 10:46.400]  Это я для каждого, вот для фиксированного ц, время
[10:46.400 --> 10:47.400]  такое.
[10:47.400 --> 10:49.760]  И плюс, надо ещё умножить это всё на то, сколько символов
[10:49.760 --> 10:50.760]  в алфавите.
[10:50.760 --> 10:52.280]  Если он константо, то это и будет асимплотика, если
[10:52.280 --> 10:53.680]  он не константо, ну здесь дополнительно какой-то
[10:53.680 --> 10:55.600]  множественный появляется, множественный на размер
[10:55.600 --> 10:56.600]  сигма.
[10:56.600 --> 11:00.800]  Значит, давайте я ещё раз это пропишу, для каждого
[11:00.800 --> 11:14.520]  ц время работы есть n лог n, вовсе время работы, соответственно,
[11:15.280 --> 11:16.280]  на модуль сигма.
[11:16.280 --> 11:30.400]  Ну и значит, как обычно, если мы считаем, что алфавит
[11:30.400 --> 11:33.200]  – это маленькие латинские буквы, то это как бы константо,
[11:33.200 --> 11:35.920]  её можно в этим точке не учитывать, но для того, чтобы оценить
[11:35.920 --> 11:38.960]  реальный время работы, лучше как бы как-нибудь на 26 надо
[11:38.960 --> 11:39.960]  будет умножить.
[11:39.960 --> 11:41.400]  Вот это вот, чтобы понять вообще, насколько это быстро
[11:41.400 --> 11:45.880]  уложится ли это в время, которое вы хотите.
[11:45.880 --> 11:48.040]  Но если это не константо, если там, скажем, могут быть
[11:48.040 --> 11:53.840]  какие-нибудь, не знаю, какие-нибудь числа вместо символов,
[11:53.840 --> 11:57.520]  то тогда надо аккуратно смотреть, чему равен размер
[11:57.520 --> 11:58.520]  алфавита.
[11:58.520 --> 12:05.680]  А чтобы было вот так вот удобно, потому что когда мы переворачиваем
[12:05.680 --> 12:08.440]  строку и считаем коэффициент при какой-то степени х,
[12:08.440 --> 12:11.080]  у нас, чтобы найти коэффициент при должной степени, мы
[12:11.080 --> 12:13.840]  как бы идём с двух сторон, ну с противоположных сторон
[12:13.840 --> 12:15.760]  в наших многочленах, потому что если мы фиксировали
[12:15.760 --> 12:19.880]  степень, то при росте одной степени вторая должна убывать.
[12:19.880 --> 12:22.400]  А мне нужно, чтобы при вот таком движении у меня как
[12:22.400 --> 12:26.080]  бы и индекс УТ возрастал, и индекс УС возрастал, поэтому
[12:26.080 --> 12:27.080]  мне нужно С реверснуть.
[12:27.080 --> 12:35.840]  Вот, значит, вроде сделали, тем самым мы решили нашу
[12:35.840 --> 12:38.840]  задачу про строки, про вхождение максимум с к ошибочками.
[12:38.840 --> 12:39.840]  Вопросы?
[12:39.840 --> 12:40.840]  Хорошо.
[12:40.840 --> 12:41.840]  Да.
[12:41.840 --> 13:03.080]  Ну надо аккуратно написать, какие у нас границы на
[13:03.080 --> 13:04.080]  к.
[13:04.080 --> 13:09.200]  Значит, это верно, если, ну, собственно, вот это вот
[13:09.200 --> 13:14.560]  не превосходит n-1, то есть к не больше, чем n-m.
[13:14.560 --> 13:17.880]  Вот это верно, согласны, что если это верно, то можно
[13:17.880 --> 13:18.880]  так написать.
[13:18.880 --> 13:19.880]  Вот.
[13:19.880 --> 13:20.880]  Ну а другие нам на самом деле не нужны, потому что
[13:20.880 --> 13:23.800]  давайте поймём, вот если к такое, то что тут будет
[13:23.800 --> 13:24.800]  написано?
[13:24.800 --> 13:30.280]  Здесь будет написано t с индексом n-m на s0 плюс на
[13:30.280 --> 13:33.840]  s1 плюс и так далее, последний будет, видимо, как раз n-1
[13:33.840 --> 13:36.840]  на m-1.
[13:36.840 --> 13:39.360]  Но это, собственно, ровно последнее скалярное произведение,
[13:39.360 --> 13:40.360]  которое нам нужно.
[13:40.360 --> 13:43.000]  Оно заканчивается в последнем символе, значит, никакие
[13:43.000 --> 13:44.320]  другие коэффициенты нам просто не нужны.
[13:44.320 --> 13:49.640]  Значит, мы рассматриваем все к от нуля до n-m, они задают
[13:49.640 --> 13:51.440]  нам все необходимые скалярные произведения, больше нам
[13:51.440 --> 13:52.440]  ничего не нужно.
[13:52.440 --> 14:17.040]  Так, хорошо, задача следующая.
[14:17.040 --> 14:22.360]  Уже не про строки.
[14:22.360 --> 14:35.560]  Задача такая, есть многочлен p, p от x, надо найти обратный
[14:35.560 --> 14:54.200]  к нему по модулю x в степени m.
[14:54.200 --> 14:57.040]  Обратный – это такое число, что в произведении единица
[14:57.040 --> 14:58.040]  по модулю данному.
[14:58.040 --> 15:07.000]  То есть, ищем, такое-то q от x, такое, что p на q сравнимо
[15:07.000 --> 15:12.000]  с единицей по модулю x в m-t.
[15:12.000 --> 15:15.920]  Иными словами, p умножить на q минус 1 делится на x
[15:15.920 --> 15:18.920]  в m-t.
[15:18.920 --> 15:27.920]  Все одно и то же.
[15:27.920 --> 15:30.160]  Ну, что такое единица по модулю x в m-t, что такое
[15:30.160 --> 15:31.160]  вообще делится на x в m-t?
[15:31.160 --> 15:34.040]  Это значит, что у этого многочлена нет коэффициентов
[15:34.040 --> 15:35.040]  младше m-того.
[15:35.040 --> 15:37.960]  То есть, там свободный член, член при x, x в квадрате
[15:37.960 --> 15:40.600]  и так далее, при m минус 1 степени все нули, и только
[15:40.600 --> 15:44.080]  возможно при m-той более старших есть какие-то коэффициенты.
[15:44.080 --> 15:47.360]  Главное, что вот эти первые m коэффициентов от нулевого
[15:47.360 --> 15:48.360]  до m минус первого равны нулю.
[15:48.360 --> 15:52.040]  То есть, пока не понятно, зачем это нам нужно, давайте
[15:52.040 --> 15:54.160]  поверим, что это зачем-то нужно, мы это применим в
[15:54.160 --> 15:55.160]  следующей задаче.
[15:55.160 --> 15:56.400]  Давайте как лему это воспринимать.
[15:56.400 --> 16:02.000]  Первое, что я сделаю, это скажу, что давайте считать,
[16:02.000 --> 16:03.000]  что m – это степень двойки.
[16:03.000 --> 16:06.000]  Потому что, если m – это не степень двойки, то я могу
[16:06.000 --> 16:09.280]  m увеличить до ближайшей сверху степени двойки,
[16:09.280 --> 16:11.160]  так что это условие станет только более сильным.
[16:11.160 --> 16:14.680]  Если я решу задачу в более сильном условии, то я, соответственно,
[16:14.680 --> 16:15.680]  решу исходную задачу.
[16:15.680 --> 16:17.560]  Ну, потому что здесь тут написано делится на x в
[16:17.560 --> 16:20.800]  десятой, я скажу, а давайте вместо такого q найдем такое
[16:20.800 --> 16:24.440]  q-штрих, что оно делится на x в шестнадцатой.
[16:24.440 --> 16:26.800]  Давайте m – это 10, а я найду такое q-штрих, что делится
[16:26.800 --> 16:27.800]  на x в шестнадцатой.
[16:27.800 --> 16:31.520]  Понятно, что это только более крутой q-штрих, значит
[16:31.520 --> 16:33.640]  его в частности можно использовать вместо такой, мы решили
[16:33.640 --> 16:34.640]  исходную задачу.
[16:34.640 --> 16:38.400]  Поэтому можно считать, что m большой от степень двойки.
[16:38.400 --> 16:51.120]  В противном случае можно m увеличить.
[16:51.120 --> 17:05.160]  Можно увеличить.
[17:05.160 --> 17:07.680]  И тогда алгоритм, который мы будем использовать, работает
[17:07.680 --> 17:08.680]  так.
[17:08.680 --> 17:12.720]  Мы будем идти по всем m-кам, по всем степням двойки,
[17:12.720 --> 17:16.380]  1, 2, 4, 8 и так далее, и решать задачу для все больших и
[17:16.380 --> 17:17.380]  больших m.
[17:17.380 --> 17:21.800]  То есть мы сначала найдем такое q, что pq – это единица
[17:21.800 --> 17:26.000]  по модулю просто x в первой, потом, используя это q, мы
[17:26.000 --> 17:29.440]  найдем какое-то новое q, какой-то q-штрих, что pq-штрих
[17:29.440 --> 17:33.400]  – это единица по модулю x в квадрате, потом по модулю
[17:33.400 --> 17:35.520]  x в четвертой, ну и так далее, в общем, когда-то дойдем
[17:35.520 --> 17:36.520]  до x в м.
[17:36.520 --> 17:38.320]  То есть будем увеличивать степень у икса в два раза
[17:38.320 --> 17:39.320]  каждый раз.
[17:39.320 --> 17:52.400]  И решать вот эти задачи друг за дружкой.
[17:52.400 --> 17:55.000]  Скажите, пожалуйста, как решить задачу для единички
[17:55.000 --> 17:56.000]  вот здесь?
[17:56.000 --> 17:58.800]  Если у нас есть p, то чему равно q такое, что единица
[17:58.800 --> 18:02.040]  по модулю x?
[18:02.040 --> 18:09.560]  Да, конечно, если p, давайте я напишу, что у нас p состоит
[18:09.560 --> 18:14.400]  из коэффициентов а0, а1х и так далее, тогда в качестве
[18:14.400 --> 18:19.600]  q вот здесь можно взять просто 1 делить на а0, тогда их произведение
[18:19.600 --> 18:26.960]  – это единица плюс что-то деляющееся на x, потому что
[18:26.960 --> 18:29.920]  все вот эти вот слагаемые, когда я их поделю на а0,
[18:29.920 --> 18:32.400]  там будет, ну, в общем, что-то делящееся на x.
[18:32.400 --> 18:35.200]  Я так и напишу – x умножить на что-то.
[18:35.200 --> 18:40.400]  И это, конечно, единица по модулю x.
[18:40.400 --> 18:45.440]  Вот, ну так, конечно, можно сделать только если а0 не
[18:45.440 --> 18:53.840]  равно 0, но если а0 равно 0, то мы и исходную, и эту
[18:53.840 --> 18:56.400]  задачу никак решить не можем, потому что если в
[18:56.640 --> 18:59.760]  многочлене p у нас вот этого члена нет и все делится
[18:59.760 --> 19:04.480]  на x, то, извините, мы не можем никакого q подобрать,
[19:04.480 --> 19:06.840]  такое, что pq сравнимый с единицей по модулю x в
[19:06.840 --> 19:07.840]  m.
[19:07.840 --> 19:08.840]  Потому что эта штука всегда будет делится на x, раз
[19:08.840 --> 19:13.440]  это делится на x, то это делится на x, и x не может быть сравнимый
[19:13.440 --> 19:16.560]  с единицей по модулю x в m.
[19:16.560 --> 19:19.480]  На единица – значит, свободный член единица, а тут написано,
[19:19.480 --> 19:22.160]  что все члены хотя бы с x начинаются, поэтому такого
[19:22.160 --> 19:23.160]  быть не может.
[19:23.160 --> 19:25.600]  Значит, если это неверно, то есть а0 равно 0, то решения
[19:25.600 --> 19:28.280]  в принципе не существуют, давайте где-нибудь пометим,
[19:28.280 --> 19:36.800]  если а0 равно 0, то решения нет, решения нет.
[19:36.800 --> 19:40.480]  Если же все хорошо и вот это вот выполняется тогда,
[19:40.480 --> 19:42.720]  тогда мы можем решить базу, собственно, как бы это можно
[19:42.720 --> 19:44.840]  воспринимать как индукцию, вот базу мы решили, мы нашли
[19:44.840 --> 19:49.240]  такое q, что pq единица по модулю x.
[19:49.240 --> 19:53.320]  Хорошо, а теперь давайте считать, что у нас откуда-то
[19:53.320 --> 19:59.880]  есть такое q, пусть есть q, пусть есть q, такое, что
[19:59.880 --> 20:07.680]  p на q – это единица по модулю x в m какой-то, давайте m маленькая,
[20:07.680 --> 20:16.000]  мы хотим найти новый q штрих, хотим найти q штрих, такое,
[20:16.000 --> 20:24.000]  что p на q штрих – это единица по модулю x в степени 2m,
[20:46.760 --> 20:55.120]  значит мы будем искать q штрих в следующем виде,
[20:55.120 --> 21:01.440]  значит в виде q от x плюс x в m умножить на t от x, где
[21:01.440 --> 21:04.880]  t некий неизвестный на гаче, значит мы будем решать
[21:04.880 --> 21:09.120]  нашу задачу в предположении, что первые m коэффициентов
[21:09.120 --> 21:13.000]  в q штрихе совпадают с коэффициентами из q, но на самом деле можно
[21:13.000 --> 21:14.960]  показать, что это обязательно ровно так и выполняется,
[21:14.960 --> 21:18.040]  потому что если верно вот это, то после взятия
[21:18.040 --> 21:20.760]  всего по модулю x в m-той у меня здесь остается вот
[21:20.760 --> 21:23.320]  это p, а здесь значит должна остаться вот это вот q, поэтому
[21:23.320 --> 21:26.280]  как бы младше m коэффициентом из q штрих обязаны быть теми
[21:26.280 --> 21:30.040]  же из q, вот поэтому мы считаем, что мы просто перекопируем
[21:30.040 --> 21:33.600]  младше m коэффициентов из q, а следующие m коэффициентов
[21:33.600 --> 21:37.360]  это многочлен t и я еще из этого всего вынесу x в m-той,
[21:37.360 --> 21:41.560]  то есть обе вот эти штуки – это многочлены с m коэффициентами
[21:41.560 --> 21:44.760]  каждой, но только t это как бы коэффициенты при старших
[21:44.760 --> 21:49.480]  степнях x при второй половине степеней, будем искать q-штрих
[21:49.480 --> 21:55.940]  в таком виде, далее, далее, далее, давайте мы еще будем
[21:55.940 --> 22:04.280]  считать, что p от x это p0 от x плюс x в m-той на p1 от x,
[22:04.280 --> 22:08.600]  то есть вот у меня был какой-то большой p, вектор коэффициентов
[22:08.600 --> 22:13.320]  многочлена p, я во-первых сначала обрубился на первых
[22:13.320 --> 22:18.280]  2m коэффициентах, у меня все равно последнее нужное
[22:18.280 --> 22:20.840]  мне равенство, оно по модулю x в степени 2m, поэтому все
[22:20.840 --> 22:24.720]  что правее, все что начинается с 2m того символа меня не
[22:24.720 --> 22:27.360]  интересует, все что правее меня не интересует, а это
[22:27.360 --> 22:31.200]  я поделю пополам, слева будет p0, справа p1, когда p вот
[22:31.200 --> 22:35.560]  в таком виде представляется, значит есть такое, есть
[22:36.440 --> 22:45.440]  мы точно знаем еще, что p0 на q это 1 по модулю x в m-той,
[22:45.440 --> 22:53.400]  то есть это было верно для p, но понятно, что p и p0 не
[22:53.400 --> 22:57.960]  отличаются если мы работаем в x в степени m, поэтому вот
[22:57.960 --> 23:00.440]  это вот уравнение можно чуть уточнить, написать что
[23:00.440 --> 23:02.960]  здесь написано p0 вместо p, потому что все равно все старшие
[23:02.960 --> 23:09.960]  степень не влияют, ну и давайте мы вот это вот сравнение
[23:09.960 --> 23:14.200]  напишем чуть точнее, а именно мы напишем что p0, давайте
[23:14.200 --> 23:17.760]  я не буду писать в скобочках x, не лень, я напишу что p0
[23:17.760 --> 23:23.360]  на q это 1 плюс x в m-той умножить на r, а раз оно сравнимо с
[23:23.360 --> 23:26.400]  1 по модулю, значит есть какое-то вот это вот частное
[23:26.400 --> 23:32.920]  r, такое что выполняется такое равенство, ну и соответственно
[23:32.920 --> 23:35.120]  r, скажем, можно довольно легко посчитать, мы можем
[23:35.120 --> 23:38.360]  просто перемножить эти два многошена друг на друга,
[23:38.360 --> 23:41.320]  и все коэффициенты начиная с m-того засунуть в многошен
[23:41.320 --> 23:44.680]  r, а если нам известны p0 и q, то r можно просто одним f
[23:44.680 --> 23:47.600]  of t найти, ну точнее как бы тремя f of t, но одним перемножением.
[23:47.600 --> 23:53.600]  Вот, ну и теперь давайте попробуем понять, чему же
[23:53.600 --> 23:57.480]  тогда должен быть равно t, потому что у нас единственное
[23:57.480 --> 24:05.960]  неизвестно это t, надо его найти, ну мы хотим, чтобы
[24:05.960 --> 24:12.640]  выполнялось вот это вот равенство, то есть p0 плюс x в m-той p1 умножить
[24:12.640 --> 24:21.760]  на q плюс x в m-той t, было сравнимо с 1 по модулю x в степени 2m,
[24:21.760 --> 24:26.920]  это мы хотим, но мы хотим найти такое t, чтобы это выполнялось,
[24:26.920 --> 24:38.040]  ну давайте раскроем здесь скобки, будет p0 на q, дальше
[24:38.040 --> 24:49.000]  будет x в m-той на p1 q плюс p0 t, плюс еще произведение
[24:49.000 --> 24:52.400]  вот этих вот маномов, но оно сравнимо с нулем по
[24:52.400 --> 24:54.120]  этому модулю, потому что там есть просто множество
[24:54.120 --> 24:57.360]  по модулю x в степени 2m, мы можем вот это даже не перемножать,
[24:57.360 --> 25:01.400]  потому что оно делится на модуль, вот, значит есть
[25:01.400 --> 25:05.280]  такая штука, это все сравнимо по модулю x в степени 2m,
[25:05.280 --> 25:10.040]  и мы хотим, чтобы это было равно единице, хотим, чтобы
[25:10.040 --> 25:16.200]  это было сравнимо с единицей, так, ну давайте еще заменим
[25:16.200 --> 25:19.240]  вот это вот p0 q, у нас же есть что p0 q это 1 плюс x в m-той
[25:19.240 --> 25:28.160]  на r, значит все вот это вот вместе сравнимо с единицей
[25:28.160 --> 25:45.840]  плюс x в m-той на r плюс p1 q плюс p0 t, так, ну и что тогда
[25:45.840 --> 25:46.840]  дальше?
[25:46.840 --> 25:49.720]  Мы хотим, чтобы это было единицей по модуле x в степени
[25:49.720 --> 25:53.520]  2m, но вот единичка есть, единственное, что мне осталось
[25:53.520 --> 25:55.640]  сделать, это чтобы вот это вот делилось на x в степени
[25:55.640 --> 26:00.200]  m, потому что если это делится на x в степени m, то вот это
[26:00.200 --> 26:02.440]  все слагаемое делится на x в степени 2m, и здесь как
[26:02.440 --> 26:07.720]  раз та самая заветная единичка, поэтому мы теперь хотим,
[26:07.720 --> 26:12.160]  чтобы вот этот вот, вот этот множитель r плюс p1 q плюс
[26:12.160 --> 26:18.520]  p0 t был сравним с нулем по модуле x в m-той, потому что
[26:18.520 --> 26:21.120]  еще раз, если это верно, тогда весь этот множитель
[26:21.120 --> 26:24.880]  делится на x в m-той, это делится на x в степени 2m, а значит
[26:24.880 --> 26:26.800]  как раз вся эта сумма сравнима с единицей по модуле x в
[26:26.800 --> 26:31.320]  степени 2m, единичка плюс что-то делящееся на x в степени
[26:31.320 --> 26:34.480]  2m, поэтому если мы этого добьемся, то мы решим задачу.
[26:34.480 --> 26:39.520]  Осталось решить вот такое сравнение, ну давайте поймем,
[26:39.520 --> 26:42.040]  что здесь неизвестно, неизвестно здесь только t, все остальное
[26:42.040 --> 26:45.240]  нам известно, p0, p1 это то, что у нас было на входе, q
[26:45.240 --> 26:49.200]  это многочленец прошлого слоя, r это вот здесь вот
[26:49.200 --> 26:52.760]  неполное частное определение на x в степени 2m, это нам
[26:52.760 --> 26:53.760]  все известно.
[26:53.760 --> 26:55.760]  Вот, ну давайте разрешим это уравнение относительно
[26:55.760 --> 26:56.760]  t.
[26:56.760 --> 27:02.760]  t должно быть сравнимо с элементом обратным к p0, умноженному
[27:02.760 --> 27:09.760]  на минус r минус p1q по модуле x в степени 2m, но у чуда обратная
[27:14.280 --> 27:21.280]  к p0 по модуле x в степени 2m мы уже знаем, это q, вот она,
[27:24.440 --> 27:27.840]  обратная к p0 по модуле x в степени 2m это q, значит
[27:27.840 --> 27:30.840]  просто здесь я могу заменить обратное к p0 просто на q,
[27:30.920 --> 27:37.240]  значит у меня есть просто выражение для t, t это q умножить
[27:37.240 --> 27:44.240]  на минус r минус p1q по модулю x в мт, вроде все, то есть
[27:47.440 --> 27:54.440]  мы нашли то самое t, которое хотели, вот, ну теперь осталось
[27:54.440 --> 28:03.120]  разобраться со симптотикой, о чем мы сделали, мы научились
[28:03.120 --> 28:07.440]  переходить от, давайте вот сюда вернемся, вот такого
[28:07.440 --> 28:09.440]  сравнения к вот такому, то есть мы увеличили степень
[28:09.440 --> 28:12.600]  в 2 раза, за сколько, ну по сути что нам нужно было,
[28:12.600 --> 28:16.160]  нам нужно было найти вот это r, то есть вот первый
[28:16.160 --> 28:19.920]  кусок, это найти вот это вот r, которое нам здесь нужно,
[28:19.920 --> 28:22.440]  а дальше применить вот такое вот преобразование, но
[28:22.440 --> 28:24.640]  это все, это просто несколько перемножений многочленов,
[28:24.640 --> 28:26.000]  потому что вот здесь вот нам нужно перемножить
[28:26.000 --> 28:29.760]  p0 на q, чтобы извлечь те самые коэффициентции r, это
[28:29.760 --> 28:31.800]  просто перемножение, вычитание единиц и отбрасывание каких-то
[28:31.800 --> 28:36.000]  там коэффициентов, отсюда мы знаем r за одно перемножение,
[28:36.000 --> 28:38.840]  и здесь нужно сделать два перемножения, p1 умножить
[28:38.840 --> 28:45.840]  на q, потом изменить знак, вычесть r и еще умножить на q, значит
[28:45.920 --> 28:50.960]  все вот это, весь переход от x в мт к x в степени 2m выполнен,
[28:51.000 --> 28:58.000]  ну выполняется за o от m log m, потому что всюду по дороге
[28:59.120 --> 29:02.280]  у нас были многочлены всего лишь с m коэффициентами,
[29:02.280 --> 29:07.160]  у нас, ну окей, вот здесь возможно там, да, когда мы их перемножим
[29:07.160 --> 29:11.320]  у нас будет 2m коэффициентов, но это все равно o от m, я перемножил
[29:11.320 --> 29:14.400]  два многочлена с m коэффициентами, получил с 2m коэффициентами
[29:14.400 --> 29:20.720]  максимум, да, значит здесь нам известно r отсюда, ну
[29:20.760 --> 29:24.440]  и здесь все произведения производится по модуле x в мт, значит нам
[29:24.440 --> 29:26.640]  нужно от многочленов только первые m коэффициентов знать
[29:26.640 --> 29:31.040]  и перемножать мы их можем за m log m, вот, все, ну осталось
[29:31.040 --> 29:33.160]  оценить итог восьмую точку, когда вот мы много таких
[29:33.160 --> 29:35.800]  итераций делаем, по всем степеням двоечки, каждая
[29:35.800 --> 29:38.560]  итерация это новая m log m, вот чему равна эта сумма,
[29:38.560 --> 29:41.560]  давайте поймем, давайте.
[29:50.720 --> 30:01.240]  Ну, смотрите, мы вот это знаем, тогда в этом уравнении
[30:01.240 --> 30:05.600]  оно происходило по модуле x в мт, это ну как бы предположение
[30:05.600 --> 30:10.480]  индукции скорее, нет, нет, нет, еще раз, вот это предположение
[30:10.480 --> 30:13.760]  индукции, дальше, на самом деле вот это условие и вот
[30:13.760 --> 30:17.520]  это, это просто одно и то же, потому что здесь, у меня
[30:17.520 --> 30:20.280]  когда я пишу p от x и рассматриваю по модуле x в мт, мне на самом
[30:20.280 --> 30:24.120]  деле не нужны никакие коэффициенты старше, старше минус 1, здесь
[30:24.120 --> 30:25.880]  ровно это и написано, то есть я здесь отбросил все
[30:25.880 --> 30:30.280]  коэффициенты, начиная с мт, то есть p по модуле x в мт
[30:30.280 --> 30:38.440]  это просто p0, поэтому это одно и то же, так что нашли
[30:38.440 --> 30:42.360]  еще раз, да, мы часто перемножили, вычислил единичку, отбросил,
[30:42.360 --> 30:44.320]  ну как бы поделили на x в мт, деление просто сдвиг
[30:44.320 --> 30:53.920]  влево, так, ну чего, значит мне нужно посчитать переход
[30:53.920 --> 30:59.280]  по всем степеням двоечки, каждый переход от m к 2m работает
[30:59.280 --> 31:04.080]  за от m лог м, значит тогда итоговое время работы
[31:04.080 --> 31:06.840]  это просто сумма по всем степеням двойки, давайте
[31:06.840 --> 31:09.240]  я скажу, пусть m большой это два степени какой-нибудь
[31:09.240 --> 31:18.560]  в к, тогда мне нужна сумма по всем, скажем g от единицы
[31:18.560 --> 31:32.440]  до к, два вжитой, но логарифм два вжитой, похоже, так, вот
[31:32.440 --> 31:35.560]  тут кайф, я никогда это не проделывал явно, давайте
[31:36.560 --> 32:03.240]  попробуем, два вжитой ножи, гин два вжитой, да, умею
[32:03.240 --> 32:07.440]  делать, значит смотрите, это все не больше чем сумма
[32:07.440 --> 32:11.840]  пожи от одного до к, к на два вжитой, я оцениваю
[32:11.840 --> 32:16.920]  уже через к, и остается к умножить на сумму пожи
[32:16.920 --> 32:24.800]  от одного до к, два вжитой, вот, ну понятно, что это такое,
[32:24.800 --> 32:27.640]  мы знаем это точно, это заведомо не больше чем удвоенное
[32:27.640 --> 32:34.200]  два в степеника, то есть два в степеника плюс один,
[32:34.200 --> 32:44.640]  а это есть от m логм, вот, поэтому даже несмотря на
[32:44.640 --> 32:47.920]  то, что у меня вот здесь по дороге было куча fft, да,
[32:47.920 --> 32:49.880]  каждый из них соответственно работал за какой там m логм
[32:49.880 --> 32:53.120]  для разных m, но если мы все это просуммируем, то как
[32:53.120 --> 32:55.720]  бы самые сложные, самые сложные переходы, они вот
[32:55.720 --> 32:59.440]  в конце, да, от m пополам к m, как бы вот это вот дает
[32:59.440 --> 33:01.560]  основной вклад в симптотику, а все остальное там какая-то
[33:01.560 --> 33:03.940]  мелочь, которая ни на что не влияет, не там, коэффициент
[33:03.940 --> 33:06.920]  на два, возможно, умножить, да, вот здесь будет двоечка
[33:06.920 --> 33:10.440]  в определении у большого, ну и все, все мелкие, они
[33:10.440 --> 33:12.280]  как бы пренебрежимы малы по сравнению с последним
[33:12.280 --> 33:16.440]  шагом, то есть как будто бы мы просто взяли и там
[33:16.440 --> 33:19.000]  что-нибудь, что-нибудь на что-нибудь умножили, да,
[33:19.000 --> 33:20.640]  взяли два многошлина вот такой степени, просто друг
[33:20.640 --> 33:22.920]  на друга перемножили и как будто бы сразу обратили,
[33:22.920 --> 33:25.560]  но на самом деле по дороге мы делали много-много более
[33:25.560 --> 33:28.760]  мелких fft-шек, которые пренебрежимы малы по сравнению вот с
[33:28.760 --> 33:39.920]  этим, окей, ну хорошо, значит, тогда мы научились обращать
[33:39.920 --> 33:50.120]  по модулю x в m-той, теперь полезная задача, деление
[33:50.120 --> 33:53.320]  многочленов, есть два многочлена, надо поделить один на другой
[33:53.320 --> 34:02.040]  с остатком, значит, данные многочлены, давайте их назову
[34:02.040 --> 34:15.240]  f и g, а надо поделить f на g, то есть найти такие по и
[34:15.240 --> 34:25.040]  q, давайте q и r я их назову в разнообразии, q и r такие,
[34:25.040 --> 34:38.520]  что f это gq плюс r, а степень r меньше, чем степень g, ну
[34:38.520 --> 34:41.160]  вот прям как если бы вы их в столбик делили, у вас
[34:41.160 --> 34:43.480]  там получается какое-то неполное частное и остаток
[34:43.480 --> 34:45.520]  степени которого должно быть меньшей степенью делить
[34:45.520 --> 34:50.400]  это, вот, ну такая задача деления, научились умножать,
[34:50.400 --> 34:52.560]  давайте научиться делить, давайте научимся делить
[34:52.560 --> 35:12.800]  так, ну сейчас будет магия, а смотрите, давайте для
[35:13.800 --> 35:29.160]  с не нулевым старшим членом, не нулевым старшим коэффициентом,
[35:29.160 --> 35:35.200]  определим метод reverse, rev от p, это когда я просто-напросто
[35:35.200 --> 35:37.560]  беру и разворачиваю порядок следований коэффициентов,
[35:38.560 --> 35:44.200]  значит это опять многочлен, а n плюс а n минус 1 x плюс
[35:44.200 --> 35:57.480]  и так далее, а 0 x в n, просто reverse на векторе, так, значит
[35:57.480 --> 36:00.640]  тогда я утверждаю, что верно следующее, что reverse это
[36:00.640 --> 36:03.760]  мультипликативная функция, в том смысле, что reverse от
[36:03.760 --> 36:07.360]  произведения g на q равен произведению реверсов
[36:07.360 --> 36:17.480]  g на q, reverse от g на reverse от q, ну чего, давайте докажем
[36:17.480 --> 36:23.400]  для приличия, давайте скажем, что это утверждение, давайте
[36:23.400 --> 36:33.880]  докажем, пусть g это что-то типа g0 плюс g1x плюс g какой-нибудь
[36:33.880 --> 36:54.880]  kt x в kt, а q это q0 плюс q1x плюс qmt x в mt, ну считаю, что старшие
[36:54.880 --> 37:01.480]  коэффициенты не нулевые, но иначе можно отбросить
[37:01.480 --> 37:06.480]  несколько старших, чтобы первый значище был не нулевой,
[37:06.480 --> 37:10.480]  чтобы старший значище был не нулевой, вот, ну давайте
[37:10.480 --> 37:12.680]  посчитаем, чему равен коэффициент при какой-нибудь степени
[37:12.680 --> 37:20.640]  x в этом произведении, значит, коэффициент при какой-нибудь
[37:20.640 --> 37:26.920]  x в l-той в многочлене g на q, он равен, но понятное дело,
[37:26.920 --> 37:31.320]  нужно перебрать все такие и плюс g с суммой l и перемножить
[37:31.320 --> 37:38.000]  g i t на q g t, это коэффициент при x в l-той в многочлене
[37:38.000 --> 37:41.560]  g на q, значит, когда я применяю к нему реверс, вот к этому
[37:41.560 --> 37:44.440]  многочлену g умножить на q, я применяю реверс, у
[37:44.440 --> 37:48.480]  меня понятное дело, что старший коэффициент будет gkt на qmt,
[37:48.480 --> 37:51.200]  он будет не нулевой, многочлен будет в точности степени
[37:51.200 --> 37:58.480]  k плюс m, поэтому при реверсе у меня x в l-той перейдет
[37:58.480 --> 38:06.160]  в x что-то типа m плюс k минус l-той степени, да, значит,
[38:06.160 --> 38:16.680]  эта же штука, коэффициент при x в степени k плюс m в
[38:16.680 --> 38:28.200]  реверс от g умножить на q, правда, вот, ну и то же самое
[38:28.200 --> 38:32.520]  надо при какой-то степени x найти коэффициент в этом
[38:32.520 --> 38:50.200]  произведении, не очень интересно, ну давайте сделаем, давайте
[38:50.200 --> 38:55.040]  для приличия напишу ревод g и ревод q, что это такое,
[38:55.040 --> 39:17.080]  gk, gk минус 1x, g0x в k-той, ревод q, это qm, qm минус 1x, далее q0xvm-той,
[39:17.080 --> 39:19.160]  значит теперь я должен перемножить и понять, чему
[39:19.160 --> 39:23.920]  равен коэффициент при вот такой степени x, ну давайте
[39:23.920 --> 39:30.120]  посмотрим, коэффициент при x в степени k плюс m минус
[39:30.120 --> 39:37.960]  l в произведении этих реверсов, рев g на рев q, значит, чему
[39:37.960 --> 39:44.520]  он будет равен? Мне нужно взять отсюда какую-то степень
[39:44.520 --> 39:46.960]  x, отсюда степень x, а так, чтобы они вместе, чтобы сумма
[39:46.960 --> 39:50.520]  степени была k плюс m минус l и вот понять, чему там будут
[39:50.520 --> 39:59.480]  равны коэффициенты, ну давайте напишем сумма по, так, нужны
[39:59.480 --> 40:12.920]  какие-то еще буквы. Ух ты, да, кстати, где-то я такое
[40:12.920 --> 40:16.920]  видел, давайте еще раз равно x в k-той, нажимает 1 на x,
[40:16.920 --> 40:33.920]  и типа из этого все очевидно. Так, хорошо, давайте, действительно,
[40:33.920 --> 40:38.000]  кажется, это выглядит более приемлемо, ну понятно, что
[40:38.000 --> 40:40.520]  это доводится, да, то есть если аккуратно посчитать
[40:40.520 --> 40:43.120]  коэффициент такой степени в этом произведении, то
[40:43.120 --> 40:46.680]  будет ровно то же самое, зуб даю, да, но нам тут предлагают
[40:46.680 --> 40:48.840]  более изящное решение, действительно, можно заметить,
[40:48.840 --> 40:52.400]  что когда мы делаем реверс, это как если бы мы подставили
[40:52.400 --> 40:57.360]  1 делить на x вместо x и все умножить на x в k-той, да,
[40:57.360 --> 41:00.400]  потому что здесь, ну вот давайте сюда вернемся, здесь
[41:00.400 --> 41:03.720]  когда мы поставим вместо x, 1 на x, здесь ничего не меняется,
[41:03.720 --> 41:06.440]  здесь будет же 1 делить на x, она надо, чтобы умножить
[41:06.440 --> 41:10.760]  на x, а, умножить на x в k-минус, ну в общем, да, как раз ровно
[41:10.760 --> 41:14.920]  это и будет, так справа налево оно и получится. Так,
[41:15.360 --> 41:21.000]  хорошо, тогда что такое реверс от g умножить на k, g умножить
[41:21.000 --> 41:30.000]  на q, но это видимо как раз x в степени k плюс m на g на q,
[41:30.000 --> 41:35.840]  ну g от 1 x и q от 1 x, нам надо проверить, что вот это равно
[41:35.840 --> 41:37.640]  вот этому произведению, но это вроде как очевидно,
[41:37.640 --> 41:46.440]  да, окей, да, действительно, спасибо, так изящнее, значит,
[41:46.440 --> 41:48.920]  еще раз, да, вот первое доказательство, можно явно
[41:48.920 --> 41:52.920]  посчитать кефиценты и получится то же самое, либо более изящно
[41:52.920 --> 41:54.760]  заметить, что выполняется такое вот соотношение на
[41:54.760 --> 41:58.040]  ревы, тогда написать чему равно рев от g умножить на q,
[41:58.040 --> 42:00.240]  и оно будет в точности равно вот этому произведению.
[42:08.040 --> 42:14.720]  Так, ну хорошо, едем дальше, значит, это мы знаем, тогда,
[42:14.720 --> 42:18.880]  зная вот это равенство, я сейчас могу навсягать такое,
[42:18.880 --> 42:29.120]  рев от f равно рев от g умножить на рев от q плюс рев от r умножить на
[42:29.120 --> 42:41.280]  x в степени, степень f минус степень r, степень f минус степень r, значит,
[42:41.280 --> 42:43.880]  ну вот здесь, да, то есть мне нужно взять реверс из этой штуки,
[42:43.880 --> 42:47.760]  произведение понятно, что можно расщепить, да, поскольку рев мультипликативен,
[42:47.760 --> 42:51.600]  и ну тут еще проблема вот с этим r, да, потому что когда я взял такой
[42:51.600 --> 42:56.040]  многочлен и в конце вот g умножить на q, в конце добавил r, я как бы его добавил
[42:56.040 --> 42:58.720]  к младшим коэффициентам, и после реверса они стали самыми старшими,
[42:58.720 --> 43:04.000]  да, они стали идти прям в самом начале, вот там, где старшая степень f, там была
[43:04.000 --> 43:07.720]  младшая степень r, младший коэффициент r, ну и чтобы это учесть, мне нужно его
[43:07.720 --> 43:10.640]  реверснуть, а еще сдвинуть влево на достаточно большую степень, потому что
[43:10.640 --> 43:15.360]  если я ревершу r сам по себе, давайте картиночкой нарисуем, вот было g умножить
[43:15.360 --> 43:19.520]  на q, а r у меня было где-то здесь, то есть это прибавка к каким-то младшим
[43:19.520 --> 43:23.320]  коэффициентам, при вот этом большом реверсе, у меня r перемещается сюда вот
[43:23.320 --> 43:26.680]  сначала и реверсится, а если реверс на r сам по себе, то он будет вот здесь,
[43:26.680 --> 43:30.560]  мне нужно его еще сдвинуть на такую степень чтобы он как раз влиял на старшую степень
[43:30.560 --> 43:42.000]  окей вот хорошо значит есть и теперь мы берем обе части по модулю x в степени сейчас надо быть
[43:42.000 --> 43:58.000]  аккуратным дег f минус дег g плюс один да вот и поскольку смотрите поскольку дег r меньше дег g
[43:58.000 --> 44:04.240]  то вот эта вот штука большая равна вот этой
[44:20.840 --> 44:27.000]  потому что если меньше значит меньше равно значит дег g минус единицы ставим минусики в обеих частях
[44:27.000 --> 44:30.400]  не знать не нравится меня и с ним противоположные получается что вот эта степень это хотя бы вот
[44:30.400 --> 44:35.520]  этот степень значит когда я беру по такому модулю у меня последние слагами вообще уничтожится
[44:35.520 --> 44:41.280]  потому что здесь домножение на x хотя бы в той же степени в которой в модуле поэтому после
[44:41.280 --> 44:49.040]  взятия по модулю x в этой степени у меня получается такое равенство что реверс f равнимо с реверс g
[44:49.040 --> 45:00.840]  на реверс q по модуле вот этого x x в степени f минус дег g плюс один
[45:20.040 --> 45:26.320]  такие задачи мы уже умеем решать потому что смотрите здесь известный рев f и рев g мы не знаем
[45:26.320 --> 45:32.480]  только рев q и поэтому чтобы это решить да чтобы разрешить это сравнение нам нужно как бы поделить
[45:32.480 --> 45:39.520]  обе части на рев g то есть найти обратный к этой штуке по модуле x степени m а такой мы за что
[45:39.520 --> 45:45.160]  решали чтобы это сделать нам нужно идти обратно к этой к этой штуке благо она обязательно существует
[45:45.160 --> 45:49.640]  потому что реверс он что делать он нам на младший коэффициент ставит то что раньше было старшим
[45:49.640 --> 45:54.280]  а старший был не нулевой значит теперь младший не нулевой поэтому обратный всегда существует вот
[45:54.280 --> 46:11.840]  мы мы его находим по прошлому значит из прошлой задачи да значит находим обратный к рев от g по
[46:11.840 --> 46:24.840]  вот эту модулю ну и соответственно нужно слева домножить обе части на вот это самое обратное
[46:24.840 --> 46:32.160]  получится рев от q с помощью одного произведения опять да то есть одно переножение многочленов
[46:32.160 --> 46:52.760]  знаем рев от q по тому же модулю так но раз мы знаем рев q по такому модуле я утверждаю что мы на
[46:52.760 --> 46:58.200]  самом деле рев q целиком знаем потому что какая степень была у q если мы делили многочлен степени
[46:59.200 --> 47:06.440]  на многочлен степени g у нас обязательно получится многочлен степени ровно dg-g так работают так
[47:06.440 --> 47:13.560]  работают степени поэтому вот эта штука это многочлен степени максимум dg-g то есть просто q
[47:13.560 --> 47:19.320]  это многочлен ровно такой степени dg-g но когда я сделал реверс у меня на старшее место встал младший
[47:19.320 --> 47:24.360]  коэффициент возможно был нулевой поэтому степень от штуки не больше чем dg-g поэтому когда я
[47:24.680 --> 47:30.080]  многочлен по модулю x в степени больше его степень я ничего с ним не делал это я отбрасываю
[47:30.080 --> 47:34.440]  всем многочлен начинаю вот с этого все мономы начинаю вот с этого но они все и так нулевые
[47:34.440 --> 47:39.640]  потому что этот многочлен меньше степени значит на самом деле это просто в точности равно рев q
[47:39.640 --> 47:47.920]  без всяких зайти по модулю потому что степень меньше чем вот это вот но а если я знаю рев от q
[47:47.920 --> 47:52.720]  я знаю q, надо просто еще раз развернуть порядок следования коэффициентов. Но если мы знаем q,
[47:52.720 --> 47:59.840]  то r найти отсюда вообще никакого труда не составляет, надо перемножить g на q и вычесть из f.
[47:59.840 --> 48:16.080]  Ну все. Ну давайте раздаем. Чему равна вообще степень q? Степень q в точно равна степени f
[48:16.080 --> 48:21.680]  минус степень g. То есть если мы все операции делаем в множестве вещественных чисел,
[48:21.680 --> 48:28.320]  ну или там комплексных, то в степени складывается переперемножение. Раз вот здесь
[48:28.320 --> 48:33.120]  должно быть написано на грешной степени в точности f, то степень q должна быть равна
[48:33.120 --> 48:45.200]  dg f минус dg g. Это окей? Вот. Ну тогда после реверса степень q на самом деле может только упасть,
[48:45.200 --> 48:49.360]  потому что вот здесь гарантировать старший коэффициент не ноль, дальше я разворачиваю
[48:49.360 --> 48:52.600]  порядок следований элементов, теперь старшим на старшим оном это тот, который раньше был
[48:52.600 --> 48:56.560]  младшим. Старший коэффициент тот, который был младшим. И может здесь степень могла уменьшиться,
[48:56.560 --> 49:00.600]  но точно не вырасти, потому что число коэффициентов не увеличилось. Поэтому диагода r уже не больше,
[49:00.600 --> 49:14.160]  чем просто диагод q, но это равно dg f минус dg g. Вот. Здесь написано большая степень. Вот здесь x
[49:14.160 --> 49:19.040]  находится в большей степени, чем степень вот этого многочлена. Поэтому это взятие по модуле не
[49:19.040 --> 49:36.680]  влияет. Так. Ну вот вроде все. Ну смотрите, что такое обратное. Это такое, что домножение на
[49:36.680 --> 49:45.360]  этой единице. Ну давайте вот здесь я напишу. Пусть мы нашли какой-то многочлен h, такой,
[49:45.360 --> 49:54.040]  что h на rev g это единица по модуле нужному. Тогда давайте я теперь обе части умножу на h. Вот здесь
[49:54.040 --> 49:59.840]  умножу на h и здесь умножу на h. Тогда это будет единица, то есть можно отбросить. А здесь написано
[49:59.840 --> 50:07.560]  обратный к rev g на rev f. Ну поскольку надо просто поделить на эту штуку, а мы, ну как бы поделить
[50:07.560 --> 50:34.240]  то, что нужно обратный. Так. Начнем по симптотике. Значит вспоминаем, что мы здесь делали. Мы один раз
[50:34.240 --> 50:40.960]  нашли обратный по модулю. Причем этот, ну как бы вот здесь вот m не будет степень f. Это мы делаем
[50:40.960 --> 50:46.800]  за n лог n. Если n это степень f, делаем за n лог n из прошлой задачи. Но потом надо еще какие-то
[50:46.800 --> 50:51.000]  два многочлены перемножить, что-то там вычесть. Это тоже n лог n, где n максимальной степеней.
[50:51.000 --> 50:57.360]  Поэтому симптотика здесь опять n лог n. Да, конечно, с больше константа, чем в fft, потому что здесь
[50:57.360 --> 51:00.240]  много-много раз в fft применяется, но n лог n тем не менее.
[51:00.240 --> 51:30.080]  Вопросы? Хорошо. Так. Почему можно отбросить модуль? Смотрите, вот тут написано какой-то
[51:30.160 --> 51:34.460]  многощен по модуле и в степени большой. Что такое многощен по модуле x в какой-то степени?
[51:34.460 --> 51:40.940]  Конечно, мы просто в этом многощене отбрасываем все мономы, начиная с этой степень, нам мы отбрасываем
[51:40.940 --> 51:43.160]  все мономы, деляющиеся на x в такой степени. То есть, просто wouldn't mind 꼈 с этой степень
[51:43.160 --> 51:46.440]  отбрасыв., clouds smit & dir. Значит, если мы покажем, что степень этой
[51:46.440 --> 51:53.200]  штуки меньше чем вот это, значит, мы просто ничего не отбросили. Но давайте
[51:53.200 --> 51:57.980]  посчитаем, чему равна степеньieraェ 회за. Мы знаем, чему равна степень q, и это просто разность
[51:57.980 --> 52:01.840]  степеней f и g, потому что так не работает. А что происходит,
[52:01.840 --> 52:04.800]  когда мы делаем реверс? Ну мы взяли вот эти коэффициенты,
[52:04.800 --> 52:07.440]  меняли их порядок, понятно, что степень от этого, как
[52:07.440 --> 52:10.200]  бы, обычно не изменилась, но максимум могла, возможно,
[52:10.200 --> 52:12.480]  могла упасть, потому что мы, когда делаем реверс,
[52:12.480 --> 52:14.480]  у нас младший коэффициент стоит на место старшего,
[52:14.480 --> 52:16.480]  если младший был нулём, старший стал тоже нулём.
[52:16.480 --> 52:18.480]  Но по крайней мере точно не вырос, потому что число
[52:18.480 --> 52:21.480]  коэффициентов не выросло. Значит, Degfg не больше, чем
[52:21.480 --> 52:25.000]  Degq, равное Degf-Degg, а эта штука меньше, чем вот это,
[52:25.000 --> 52:40.500]  на единичку хотя бы. Всё. Так, дальше можно? Значит,
[52:40.500 --> 52:43.780]  следующая задача, тоже, тоже очень полезная, это так
[52:43.780 --> 52:54.000]  называемый мультипоинт эвалиуэйшн. Ну, собственно, название
[52:54.000 --> 52:56.560]  очень говорящее, на грошей надо посчитать его значение
[52:56.560 --> 53:15.380]  в данных k-точках. Давайте здесь будут h-ки. Нужно найти
[53:15.380 --> 53:34.960]  его значение в точках B0 и так далее Bk. Давай B1 и так
[53:34.960 --> 53:39.680]  далее Bk. Вот, ну если точек мало, то задача не интересна,
[53:39.680 --> 53:41.880]  ну там, если в одной точке, надо просто поставить это,
[53:41.880 --> 53:44.680]  за линию работает. Точек много, и мы применяем наивный
[53:44.680 --> 53:48.780]  алгоритм. То время работы будет примерно k-то, а мы
[53:48.780 --> 54:02.700]  сейчас научимся быстрее. Рема очень сложная. Значит,
[54:02.700 --> 54:13.980]  P от B равно значению остатка при линии P на x-b. Давай так
[54:13.980 --> 54:34.340]  напишу. Знаете, какую терему? Да, должны знать. Ну, это
[54:34.340 --> 54:39.100]  верно просто, если мы напишем, что P от x, не знаю, зачем
[54:39.100 --> 54:45.060]  значит, если вдруг мы знаем вот это вот, то есть если
[54:45.060 --> 54:49.180]  мы поделили P на x-б остатком, тогда на самом деле это
[54:49.180 --> 54:52.500]  никакое не R от X, а просто какое-то О, да, потому что
[54:52.500 --> 54:54.900]  степень остатка должна быть меньше, чем степень
[54:54.900 --> 54:56.900]  от 1 до 2. Ну, вот так вот. Ну, вот так вот. Ну, вот так вот.
[54:56.900 --> 54:58.900]  Ну, вот так вот. Ну, вот так вот. Ну, вот так вот. Ну, вот так вот.
[54:58.900 --> 55:00.900]  Ну, вот так вот. Ну, вот так вот. Ну, вот так вот. Ну, вот так вот.
[55:00.900 --> 55:02.900]  Ну, вот так вот. Ну, вот так вот. Ну, вот так вот. Ну, вот так вот.
[55:02.900 --> 55:04.900]  Ну, вот так вот. Ну, вот так вот. Ну, вот так вот. Ну, вот так вот.
[55:04.900 --> 55:06.900]  Ну, вот так вот. Ну, вот так вот. Ну, вот так вот. Ну, вот так вот.
[55:06.900 --> 55:08.900]  Ну, вот так вот. Ну, вот так вот. Ну, вот так вот. Ну, вот так вот.
[55:08.900 --> 55:10.900]  Ну, вот так вот. Ну, вот так вот. Ну, вот так вот. Ну, вот так вот.
[55:10.900 --> 55:12.900]  Спасибо за просмотр!
[55:40.900 --> 55:42.900]  Спасибо за просмотр!
[56:10.900 --> 56:12.900]  Спасибо за просмотр!
[56:12.900 --> 56:14.900]  Спасибо за просмотр!
[56:14.900 --> 56:16.900]  Спасибо за просмотр!
[56:16.900 --> 56:18.900]  Спасибо за просмотр!
[56:20.900 --> 56:22.900]  Спасибо за просмотр!
[56:22.900 --> 56:24.900]  Спасибо за просмотр!
[56:24.900 --> 56:26.900]  Спасибо за просмотр!
[56:26.900 --> 56:28.900]  Спасибо за просмотр!
[56:28.900 --> 56:30.900]  Спасибо за просмотр!
[56:30.900 --> 56:32.900]  Спасибо за просмотр!
[56:32.900 --> 56:34.900]  Спасибо за просмотр!
[56:34.900 --> 56:36.900]  Спасибо за просмотр!
[56:36.900 --> 56:38.900]  Спасибо за просмотр!
[56:38.900 --> 56:41.900]  meditation.x-b!
[56:41.900 --> 56:43.900] allesus.org
[56:43.900 --> 56:45.900]  meditation.x-b!
[56:45.900 --> 56:47.900]  discount.y-x!
[56:47.900 --> 56:49.900]  discount.y-x!
[56:50.900 --> 56:52.900] wu!
[56:52.900 --> 56:54.900]  free.
[56:54.900 --> 56:56.900]  free.
[56:56.900 --> 56:58.900]  free.
[56:58.900 --> 57:00.900]  free.
[57:00.900 --> 57:02.900]  free.
[57:02.900 --> 57:04.900]  free.
[57:04.900 --> 57:06.900]  free.
[57:06.900 --> 57:12.100]  Здесь произведение «всех», но вот «всех» я уже не буду
[57:12.100 --> 57:13.100]  писать.
[57:13.100 --> 57:21.060]  Ну какое дерево?
[57:21.060 --> 57:28.300]  Значит, смотрите, я утверждаю, что можно наш нлщnp просеивать
[57:28.300 --> 57:32.300]  сверху вниз и брать, ну то есть как бы, если бы мы
[57:32.300 --> 57:35.500]  просто брали p по модулю всех вот этих вот листиков,
[57:35.500 --> 57:37.460]  то мы бы ничего не выиграли, потому что мы все равно
[57:37.460 --> 57:40.860]  делим как бы много раз, один тоже многошлин на маленькой
[57:40.860 --> 57:42.780]  степени, это та же самая симптотика была.
[57:42.780 --> 57:45.860]  Вместо этого давайте сделаем следующее, давайте мы возьмем
[57:45.860 --> 57:50.900]  сначала p по вот этому модулю, то есть, например, мы ищем
[57:50.900 --> 57:56.180]  x по модулю x-b3, тогда я взял p по этому модулю, потом
[57:56.180 --> 57:58.660]  по этому, потом по этому, потом по этому, каждый раз
[57:58.660 --> 58:02.100]  у нас степень уменьшается вдвое, поэтому задача становится
[58:02.100 --> 58:03.100]  все проще.
[58:03.300 --> 58:05.420]  Здесь мы когда брали по модулю, у нас там, ну примерно
[58:05.420 --> 58:07.660]  n логн, это было, дальше у нас стало многошлен на
[58:07.660 --> 58:10.780]  степени 8, потом мы многошлен на степени 8 делим на многошлен
[58:10.780 --> 58:14.140]  на степени 4 с остатком, это примерно 8 лог 8, дальше
[58:14.140 --> 58:18.460]  здесь 4 лог 4, да, 4 лог 4, здесь 2 лог 2.
[58:18.460 --> 58:22.580]  Вот это вот мы уже такое делали, да, сумма m лог m по
[58:22.580 --> 58:24.220]  степеням двойки, это то же самое, что последнее с
[58:24.220 --> 58:27.300]  логами с точки зрения симптотики, поэтому вот такой спуск
[58:27.300 --> 58:30.260]  это по времени то же самое, как просто взять по модулю
[58:30.260 --> 58:34.700]  первого многочлена, вот, и при этом ответ у нас не
[58:34.700 --> 58:36.660]  портится, да, потому что если я беру по модулю вот
[58:36.660 --> 58:38.780]  этого, потом по модулю этого, потом по модулю этого,
[58:38.780 --> 58:41.380]  потом по модулю этого, то это как если бы я изначально
[58:41.380 --> 58:42.380]  взял по эту модулю.
[58:42.380 --> 58:46.620]  Значит, ну наверное здесь нужно какое-то утверждение,
[58:46.620 --> 59:02.460]  что если многочлена, то p по модулю, ну как бы процент
[59:02.460 --> 59:08.720]  qr, процент r, это то же самое, что p, процент r, где процент
[59:08.720 --> 59:09.720]  это остаток отделения.
[59:09.720 --> 59:18.200]  Ну ровно это здесь и происходит, да, вот если r это то, что
[59:18.200 --> 59:22.200]  в листике, qr это все по дороге, то есть я делю исходное
[59:22.200 --> 59:25.000]  многочлен сначала на что-то больше, ну содержащее r,
[59:25.000 --> 59:27.680]  вот оно, да, содержит r, умножь на что-то, потом на
[59:27.680 --> 59:30.360]  что-то меньше и меньше, и в итоге делю на r с остатком,
[59:30.360 --> 59:33.200]  ну от этого понятно, что остаток такой же, как если
[59:33.200 --> 59:44.960]  бы я сразу поделил на r, да, сейчас, сейчас мы дойдем,
[59:44.960 --> 59:47.840]  это чтобы время работы было хорошим, пока скажите
[59:47.840 --> 59:52.080]  пожалуйста, это очевидно или как это доказывать,
[59:52.080 --> 59:55.360]  очевидно, хорошо, я просто пока не сразу понимаю верно
[59:55.360 --> 59:58.560]  это или нет, в смысле почему это верно, но это верно конечно,
[59:58.560 --> 01:00:07.440]  я не понимаю почему, а, ну понятно, да, потому что
[01:00:07.440 --> 01:00:12.320]  просто если я, скажем, рассмотрю все в кольце вычетов по
[01:00:12.320 --> 01:00:15.960]  модулю r, да, то есть рассматривать все по модулю r, то вот это
[01:00:15.960 --> 01:00:18.880]  вот, оно не меняет остатка по модулю r, потому что здесь
[01:00:18.880 --> 01:00:21.960]  я как бы вычитал что-то обратное qr, поэтому остаток по модуле
[01:00:21.960 --> 01:00:25.080]  r не поменялся, вот так можно сказать, ну хорошо, значит
[01:00:25.080 --> 01:00:27.840]  мы поняли, что спуск вот такого вот вниз, он не меняет
[01:00:27.840 --> 01:00:31.160]  остатка по модулю последнего листика, который мы идем,
[01:00:31.160 --> 01:00:33.040]  тогда смотрите, алгоритм такой, мне же нужно найти
[01:00:33.040 --> 01:00:34.960]  как бы остатки отделения исходного многочлена на
[01:00:34.960 --> 01:00:38.520]  все вот эти листики, тогда алгоритм такой, сначала
[01:00:38.520 --> 01:00:44.300]  я беру p по модулю вот этого многочлена, это работает
[01:00:44.300 --> 01:00:49.760]  примерно за, ну давайте считать, что k не больше
[01:00:49.760 --> 01:00:53.000]  чем n для удобства, давай считаем, что k не больше
[01:00:53.000 --> 01:00:58.200]  чем n, можно и больше, ничего не поменяется, значит,
[01:00:58.200 --> 01:01:00.640]  по скане больше чем n, тогда я вот здесь делю многочлен
[01:01:00.640 --> 01:01:03.680]  степени n на многочлен степени k, значит это работает за
[01:01:03.680 --> 01:01:09.800]  n лог n, дальше, у меня есть остаток p определение на
[01:01:09.800 --> 01:01:13.040]  этот большой многочлен, чтобы получить остаток p
[01:01:13.040 --> 01:01:15.760]  определение на это и на вот это, я могу делить уже
[01:01:15.760 --> 01:01:19.640]  не p, а остаток, но при этом остаток имеет уже степень
[01:01:20.360 --> 01:01:23.980]  не n, а k, уже меньшую степень, потому что я делил на многочлен
[01:01:23.980 --> 01:01:26.680]  k-та степень, значит остаток имеет степень меньше к,
[01:01:26.680 --> 01:01:28.480]  поэтому вот здесь вот, когда я беру p процент, Вот эта
[01:01:28.480 --> 01:01:33.120]  штука, это занимает времени примерно кокол к, а потому
[01:01:33.120 --> 01:01:35.920]  что я уже поделил, то есть я никак не п делю, а вот
[01:01:35.920 --> 01:01:39.740]  это вот все делю с остатком на этом многочлен, и это
[01:01:39.740 --> 01:01:42.540]  работает за кокол к, тоже самое я этот многочлен делю
[01:01:42.540 --> 01:01:49.360]  с остатком вот на этот, это опять за кокол k работает.
[01:01:49.360 --> 01:01:52.200]  значит, я знаю остаток определения p на вот это и вот на то
[01:01:52.640 --> 01:01:54.640]  теперь этот остаток я делю на это и на вот это
[01:01:55.020 --> 01:01:59.360]  это работает за k пополам лог k пополам потому, что опять степень хотя бы в два раза уменьшилась
[01:02:00.240 --> 01:02:04.080]  поэтому здесь вот p процент эта штука работает за k пополам лог k пополам
[01:02:05.900 --> 01:02:07.900]  здесь то же самое я беру p
[01:02:08.300 --> 01:02:12.760]  по модулю этого многочлена это работает за k пополам лог k пополам
[01:02:13.280 --> 01:02:15.260]  ну и так далее вот здесь и вот здесь
[01:02:15.260 --> 01:02:20.020]  И, наконец, зная вот эти все остатки, я беру опять эту штуку по модулю последнего.
[01:02:20.020 --> 01:02:24.380]  Это работает опять за k делить на 4, ло k на 4, потому что степень хотя бы два раза уменьшилась.
[01:02:26.380 --> 01:02:29.500]  То есть я просто взял исходно многочлен по большому этому модулю,
[01:02:29.500 --> 01:02:35.100]  по тому модулю, и ну просто спускаю, зная остаток, спускаю вниз по всё меньшим и меньшим многочленам.
[01:02:36.860 --> 01:02:38.860]  Значит, тогда чему уровну время работы?
[01:02:42.380 --> 01:02:45.180]  Ну вот, я его тут, собственно, писал, да? Сначала будет n log n.
[01:02:46.260 --> 01:02:48.260]  Потом будет два раза k log k.
[01:02:51.260 --> 01:02:55.260]  Потом четыре раза k пополам, ло k пополам.
[01:02:59.260 --> 01:03:03.260]  Восемь раз k на 4, ло k на 4, ну и так далее.
[01:03:06.260 --> 01:03:10.260]  Вот. И вот это вот всё можно тоже как-нибудь аккуратненько оценить.
[01:03:10.260 --> 01:03:12.260]  Как же это оцениваю?
[01:03:13.260 --> 01:03:15.260]  Ну давайте напишем, что тут написано, да?
[01:03:15.260 --> 01:03:19.260]  Ну если k это степень двойки какая-нибудь, пусть k это два в степени какой-нибудь l,
[01:03:21.260 --> 01:03:23.260]  ой, мамочки, то у меня написана сумма.
[01:03:25.260 --> 01:03:27.260]  Вложи это на вот l.
[01:03:36.260 --> 01:03:38.260]  А, ну да.
[01:03:38.260 --> 01:03:42.260]  Значит, смотрите, здесь будет 2k. Вот, короче, вот эти множители будут одинаковые везде.
[01:03:42.260 --> 01:03:44.260]  Это будет всегда 2k, то есть два в степени плюс один.
[01:03:44.260 --> 01:03:46.260]  Множество логарифов.
[01:03:50.260 --> 01:03:52.260]  Два вжигай.
[01:03:56.260 --> 01:03:58.260]  Похоже на правду?
[01:04:02.260 --> 01:04:04.260]  Вот. Ну вот такое мы уже когда-то делали.
[01:04:05.260 --> 01:04:07.260]  А, ну не совсем.
[01:04:07.260 --> 01:04:09.260]  Немножко другая, но тоже хорошая сумма.
[01:04:10.260 --> 01:04:14.260]  Значит, когда мы складываем логарифмы от 2 в степенежи,
[01:04:14.260 --> 01:04:16.260]  у меня логарифмы двойка исчезают.
[01:04:16.260 --> 01:04:18.260]  Это просто сумма жишек.
[01:04:18.260 --> 01:04:21.260]  Сумма первых l натуральных шисел ведёт себя как l квадратно-симпатически.
[01:04:21.260 --> 01:04:23.260]  Поэтому здесь написано 2...
[01:04:23.260 --> 01:04:25.260]  Значит, о, вот l квадрат.
[01:04:25.260 --> 01:04:27.260]  О, вот л квадрат.
[01:04:27.260 --> 01:04:29.260]  А вот л квадрат.
[01:04:29.260 --> 01:04:31.260]  А вот л квадрат.
[01:04:31.260 --> 01:04:33.260]  И здесь написано 2...
[01:04:33.260 --> 01:04:35.260]  Значит, о, вот l квадрат на 2 в степени l.
[01:04:35.260 --> 01:04:39.260]  Потому что здесь сумма первых l натуральных шисел.
[01:04:39.260 --> 01:04:44.260]  Вот. И с точки зрения k это, я так понимаю,
[01:04:44.260 --> 01:04:46.260]  k на лог квадрат k.
[01:04:51.260 --> 01:04:53.260]  Правда?
[01:04:55.260 --> 01:04:58.260]  Вот это k, l это лог, значит лог квадрат.
[01:04:59.260 --> 01:05:01.260]  Вот.
[01:05:01.260 --> 01:05:03.260]  Ну, собственно, тогда получается, что основное...
[01:05:03.260 --> 01:05:07.260]  Ну, там одно деление занимает какой-то n лог n.
[01:05:07.260 --> 01:05:09.260]  А дальше k лог k квадрат.
[01:05:09.260 --> 01:05:11.260]  Лог квадрат k, в смысле.
[01:05:11.260 --> 01:05:13.260]  Вот.
[01:05:13.260 --> 01:05:15.260]  Мы всё сделали. Единственное, надо ещё сказать,
[01:05:15.260 --> 01:05:17.260]  как мы эти многочлены находим.
[01:05:17.260 --> 01:05:19.260]  Надо ещё аккуратно посчитать,
[01:05:19.260 --> 01:05:22.260]  сколько уходит времени на то, чтобы все вот эти многочлены явно записать.
[01:05:22.260 --> 01:05:25.260]  Потому что тут я их так написал, красиво, как произведение.
[01:05:25.260 --> 01:05:28.260]  Ну, и, в самом деле, когда я беру, там, многочлен по модулю многочлена,
[01:05:28.260 --> 01:05:30.260]  мне не нужно знать его как произведение.
[01:05:30.260 --> 01:05:32.260]  Мне нужно знать его как набор коэффициентов.
[01:05:32.260 --> 01:05:34.260]  Поэтому мне ещё нужно аккуратно посчитать,
[01:05:34.260 --> 01:05:37.260]  сколько времени занимает вот эти вот подсчёты всех многочленов,
[01:05:37.260 --> 01:05:40.260]  раскрытия всех скобок, когда я иду снизу вверх.
[01:05:40.260 --> 01:05:41.260]  То есть, первый шаг моего алгоритма.
[01:05:41.260 --> 01:05:43.260]  Я строю такое полнабинарное дерево
[01:05:43.260 --> 01:05:45.260]  и во всех этих многочленах раскрываю скобки
[01:05:45.260 --> 01:05:47.260]  с помощью обычного произведения многочленов.
[01:05:47.260 --> 01:05:49.260]  Да, то есть, вот здесь написано, на самом деле,
[01:05:49.260 --> 01:05:51.260]  произведение этих двух, нормальное такое раскрытое,
[01:05:51.260 --> 01:05:53.260]  как набор коэффициентов.
[01:05:53.260 --> 01:05:57.140]  строил это дерево, надо понять, за сколько это работает, а дальше я просто п, беру по модулю
[01:05:57.140 --> 01:06:03.220]  корня и спускаю этот остаток вниз, не сниз, беря каждый раз остаток за там очередное кало к.
[01:06:03.220 --> 01:06:16.500]  За сколько работает подсырение дерева? Ну, видимо, что-то такое же сейчас получится. Да,
[01:06:16.500 --> 01:06:20.300]  очевидно, получится то же самое, потому что, смотрите, вот тут я когда писал какое-то
[01:06:20.300 --> 01:06:25.900]  время работы, да, вот оно кало к, это я делил многочлен с остатком на многочлен степени к,
[01:06:25.900 --> 01:06:30.900]  но понятно, что примерно столько же с точки зрения симптотики занимает время просто произведения
[01:06:30.900 --> 01:06:35.540]  двух многочленов размеров вдвое меньше, потому что если я делил многочлен степени к на многочлен
[01:06:35.540 --> 01:06:40.220]  степени к за кало к, ну, то это занимает столько же времени, как если бы я взял два многочлена
[01:06:40.220 --> 01:06:45.500]  размера как пополам и перемножил с помощью fft. Поэтому вот эти вот суммы, которые я написал,
[01:06:45.500 --> 01:06:51.940]  от кало к, кополам лока и так далее, вот эта вот сумма, а вот она. Это же время равно времени
[01:06:51.940 --> 01:06:55.900]  просто построения дерева. То есть вот эта штука просто равна времени построения дерева.
[01:06:55.900 --> 01:07:05.540]  То есть новых слагаемых у нас не появляется и итоговая симптотика,
[01:07:05.540 --> 01:07:24.100]  н лог н плюс к лог квадрат к. Нет, к – это число точек, с которых мы ищем значение. Ну,
[01:07:24.100 --> 01:07:28.860]  я тут предполагал, что они больше, чем n, если к больше, чем n, ну, давайте напишу так, давайте,
[01:07:28.860 --> 01:07:39.140]  пусть. Значит, точно верна такая оценка. Если m – это максимум из n и k, тогда симптотика
[01:07:39.140 --> 01:07:47.700]  точно от m лог квадрат m. Это прям железно. Просто взяли максимальное и м лог квадрат
[01:07:47.700 --> 01:08:01.340]  посчитали. Вот теорема без у, что значение в точке – это значение остатка определений на
[01:08:01.340 --> 01:08:10.980]  листья как раз. Просто теорема. Окей? Ну, еще раз смотрите, вот есть теорема, что значение
[01:08:10.980 --> 01:08:16.620]  многочлена в точке в точности совпадает со значением остатка уделения многочлена на такой
[01:08:16.620 --> 01:08:24.620]  вот 2-члене x – b. Это теорема без у, вот мы ее доказали здесь. Чтобы найти значение p в каких-то там
[01:08:24.620 --> 01:08:30.900]  к точках, b1 и так далее, bk, мне по сути нужно взять исходный многочлен и поделить его с остатком на
[01:08:30.900 --> 01:08:37.020]  всевозможные x – b и t. x – b1, x – b2 и так далее. Все остатки – это как раз значение, которое мы ищем
[01:08:37.020 --> 01:08:42.780]  по теореме. Но вот ровно это мы и делаем в нашем дереве. Мы идем сверху вниз, берем p по модулю
[01:08:42.780 --> 01:08:48.380]  текущего многочлена и в конце p по модулю x – b, это есть как раз значение в точке b. Профит.
[01:09:04.380 --> 01:09:09.380]  Несколько я понимаю, более эффективного алгоритма пока неизвестно здесь. То есть мы умножаем и делим
[01:09:09.380 --> 01:09:13.580]  за одно и то же время, да, за n лог n примерно. А здесь вот квадрат алгоритма возникает. Несколько
[01:09:13.580 --> 01:09:21.300]  я понимаю, пока здесь не умеют скачивать этот лог квадрат, пока вот вроде m лог квадрат – самое
[01:09:21.300 --> 01:09:36.300]  эффективное, что есть. Так, ну и вероятно последний на сегодня. Задача тоже такая весьма-весьма
[01:09:36.300 --> 01:09:47.500]  естественная. У нас есть линейная рекуррента. Как бы я ее задал? Давайте пусть будут у меня
[01:09:47.500 --> 01:10:01.260]  коэффициенты ее какие-нибудь. Не помню, ну ладно. Бог с ним. c0 и так далее, c, s-1 – какие-то числа.
[01:10:01.260 --> 01:10:13.020]  Дальше a0 и так далее, a, s-1 тоже какие-то числа. A it для всех i больше равных s равны
[01:10:13.020 --> 01:10:16.780]  линейной комбинации предыдущих s членов последовательности вот с такими коэффициентами.
[01:10:16.780 --> 01:10:32.900]  Ну давайте я напишу t0 на a i-s, c1 на a i-s-1 и так далее, t, s-1 на a i-1. То есть эта сумма
[01:10:32.900 --> 01:10:55.140]  по всем g от 0a до s-1, cgt a i- с плюс g, кажется. Да, похоже на правду. Вот, и с нас задана линейная
[01:10:55.140 --> 01:11:03.460]  рекуррента. Вот ее начальный отрезок, начальные условия. Вот ее коэффициенты. И мы знаем, что каждый
[01:11:03.460 --> 01:11:09.300]  каждый член выражается через s предыдущих вот такой линейной комбинации. Ну соответственно,
[01:11:09.300 --> 01:11:18.580]  задача найти какое-то там аэнное для достаточно большого аэн, ну для аэн, которое дано.
[01:11:18.580 --> 01:11:33.780]  Так, ну вопрос в зал. За сколько мы умеем такое решать? Вот представьте, что s какое-нибудь не
[01:11:33.780 --> 01:11:40.580]  очень большое, там порядка тысячи, а аэн большое, там миллиарды. За сколько можно такое решать,
[01:11:40.580 --> 01:11:48.660]  зная уже то, что мы знаем? Без FFT даже, про FFT можно не думать. Да, прекрасно. Потому что у нас
[01:11:48.660 --> 01:11:53.740]  есть очень простое соотношение. Мы такое когда-то выписывали, что мы можем написать столбец
[01:11:53.740 --> 01:12:01.300]  значений, столбец s последовательных значений, написать, что он получается из предыдущего,
[01:12:01.460 --> 01:12:06.540]  домножения на не очень сложную матрицу. Ну здесь что-то будет видимо вот такое,
[01:12:06.540 --> 01:12:15.500]  а здесь будут как раз вот те самые коэффициенты cs-1, cs-2 и так далее ценоривое. И поэтому,
[01:12:15.500 --> 01:12:20.340]  чтобы посчитать там какое-то аэнное, нужно взять начальный столбец вот этих вот чисел,
[01:12:20.340 --> 01:12:26.220]  возвести эту матрицу в степень что-то типа n-s, и это как раз работает за куб этой матрицы,
[01:12:26.220 --> 01:12:30.020]  но алгорифм в степени, потому что произведение работает за куб, произведение матрицы работает
[01:12:30.020 --> 01:12:34.100]  за куб. Но что еще на алгорифм, мы за бинардного зрения в степень. То есть,
[01:12:34.100 --> 01:12:37.620]  такой подход даст нам асимптотику, давайте мы пишем teta s-куп луган.
[01:12:46.220 --> 01:12:47.340]  Сейчас сделаем еще лучше.
[01:13:00.020 --> 01:13:13.340]  Так, смотрите, давайте предположим, что в какой-то момент времени у нас нашлось выражение для
[01:13:13.340 --> 01:13:22.580]  ak как линейная комбинация первых с численов нашей последовательности. Значит, сумма по g от 0 до
[01:13:22.580 --> 01:13:30.340]  s-1 некая, пусть будет bg на aj. То есть, вот пусть откуда-то мы знаем линейное представление
[01:13:30.340 --> 01:13:43.060]  какого там k-того члена последовательности через первое s. Хотим найти новые коэффициенты d0 и
[01:13:43.060 --> 01:13:49.140]  так далее ds-1 такие, что они выражают 2 k-тый элемент нашей последовательности через те же самые
[01:13:49.140 --> 01:14:02.540]  первые s-членов. Если мы такое научимся делать достаточно эффективно, то получается, что мы
[01:14:02.540 --> 01:14:08.060]  смогли перейти от k к 2 k за какое-то быстрое время. А дальше та же самая техника бинардного
[01:14:08.060 --> 01:14:12.980]  зрения в степень, что если нам нужно умножить на k на 2, то мы умножаем вот за это. Если нам нужно
[01:14:12.980 --> 01:14:17.460]  от k прийти к k плюс 1, то там еще какая-то должна быть проверочка, тоже простая, чуть позже просмотрим.
[01:14:17.460 --> 01:14:22.820]  Значит, вот самый интересный шаг вот такой. Зная откуда-то выражение ak через первые
[01:14:22.820 --> 01:14:26.460]  s-членов, давайте попробуем найти выражение для 2k через те же самые первые s-членов.
[01:14:26.460 --> 01:14:44.540]  Ну, мы точно можем написать вот такое. Значит, откуда? Ну, потому что если ak выражается
[01:14:44.540 --> 01:14:55.460]  через первые s, то 2k выражается ровно таким же образом через члены, начиная с k. Это верно,
[01:14:55.460 --> 01:15:02.500]  если k у нас хотя бы с. То есть, если k как-то выражается через первые, давайте нарисую,
[01:15:02.500 --> 01:15:09.420]  вот k как-то выражается через 0 и так далее с-1. Тогда 2k выражается ровно тем же образом через
[01:15:09.420 --> 01:15:14.620]  вот эти вот k и так далее k плюс с-1. Ну, просто потому что зависимость вот этого от всех предыдущих
[01:15:14.620 --> 01:15:20.260]  такая же, как вот этого от вот этих предыдущих. Там просто одно и то же правило навешивается,
[01:15:20.260 --> 01:15:24.180]  вон оно там какая-то сумма насчитывается. Поэтому понятно, что это как бы просто сдвиг нашей
[01:15:24.180 --> 01:15:31.020]  последовательности на k куда-то, и поэтому у нас выполняется такое соотношение. Дальше я могу
[01:15:31.020 --> 01:15:41.020]  написать то же самое для g плюс k. А g плюс k, это сумма давайте по i, на 0 до s-1, b и t, на а и плюс g.
[01:15:41.020 --> 01:15:48.980]  Ну, то же самое, вот это вот написал для g плюс k. Опять, если k выражается как-то через
[01:15:48.980 --> 01:15:58.620]  первые s, то g плюс k также выражается через элементы, начиная с g, до g плюс 8-1. Поэтому
[01:15:58.620 --> 01:16:03.180]  вот сюда я могу подставить, да, вот это вот сюда могу подставить, и получится, что у меня адвокаты,
[01:16:03.180 --> 01:16:19.620]  это сумма по всем g, 0 до s-1, по всем i, 0 до s-1, b и t, b g t, на а и плюс g t. Вот, а это страшно
[01:16:19.620 --> 01:16:25.580]  похоже на произведение многочленов. Да, вот прям сумма по i, сумма по g, произведение коэффициентов,
[01:16:25.580 --> 01:16:35.580]  на а с индексом сумма индексов, сумма и плюс g. Вот, поэтому, если я нарешу вот такой вот многочлен,
[01:16:35.580 --> 01:16:55.380]  возведу его в квадрат. Ну, давайте, давайте он будет е у меня. Значит, b от x умножить на b
[01:16:55.380 --> 01:17:01.780]  от x с помощью fft за s лог s. Ну, значит, я могу взять все это многочлены в квадрат за s лог s.
[01:17:01.780 --> 01:17:09.100]  Это будет ровно вот это. На, если его коэффициенты какие-то ешки, то здесь написано просто сумма
[01:17:09.100 --> 01:17:35.220]  по всем i от 0 до 2 s-2, e и t, a и t. Просто потому, что коэффициент при каком-то, ну, давайте,
[01:17:35.220 --> 01:17:41.140]  при вот этом вот a и t равен всевозможным, ну, значит, суммой всевозможных произведений b
[01:17:41.140 --> 01:17:45.700]  с разными индексами, сумма которых равна вот этому. А это ровно, как если бы мы просто
[01:17:45.700 --> 01:17:55.780]  b взяли в квадрат и взяли оттуда нужный коэффициент. Понятно? Вот, это почти то, что нужно. А именно,
[01:17:55.780 --> 01:18:01.980]  мы что хотели? Мы хотели выразить двокатый член через первые s, а взяли и выразили через первые
[01:18:01.980 --> 01:18:10.500]  2s. То есть, здесь выражение, зависящее от а0 и так далее, а2s-2. Нам нужно как-то это преобразовать
[01:18:10.500 --> 01:18:27.860]  сумму d и t, a и t для i от 0 до 1. Так, давайте думать.
[01:18:40.500 --> 01:18:49.900]  То есть, мне нужно в каком-то смысле выразить все вот эти вот ашки с номерами 2s-2, 2s-3 и так далее
[01:18:49.900 --> 01:18:57.140]  вплоть до s через первые s, через нулевой и так далее с минус первой. Значит, как это сделать?
[01:18:57.140 --> 01:19:07.180]  На самом деле, я утверждаю, что достаточно рассмотреть вот такой многочлен. Так, надо понять,
[01:19:07.180 --> 01:19:15.140]  правильно ли я написал. Ну, сейчас давайте какой-нибудь нарисую. Такой попробуем.
[01:19:25.140 --> 01:19:31.740]  Просто-просто. Это, по сути, характеристический многочлен нашей рекурренты.
[01:19:37.740 --> 01:19:42.940]  Видимо, не совсем. Да, вот здесь у меня, значит, тут, ну короче, короче, если что, я могу здесь вот
[01:19:42.940 --> 01:19:47.780]  массив c развернуть, чтобы, если надо, вот это вот старше, старше было вот здесь. Ну, короче,
[01:19:47.780 --> 01:19:52.220]  посмотрим. Возможно, не надо, возможно, надо. Я рассматриваю такой многочлен и я утверждаю,
[01:19:52.220 --> 01:19:58.100]  что если рассматривать вот это опять вновь как многочлен e, как набор коэффициентов e, то мне
[01:19:58.100 --> 01:20:02.780]  нужно будет просто взять его по модулю p, и это будет нужное мне представление.
[01:20:02.780 --> 01:20:15.180]  Что такое f? Это e у меня такое.
[01:20:15.180 --> 01:20:28.180]  E. Там минусы именно, да. Ну, это характеристический многочлен.
[01:20:36.700 --> 01:20:42.500]  Значит, я утверждаю, что чтобы получить набор вот этих вот коэффициентов, мне нужно взять e по
[01:20:42.500 --> 01:20:48.260]  модулю p, и это будет то, что нужно. Ну, по крайней мере, остаток действительно будет
[01:20:48.260 --> 01:20:52.820]  иметь степень ровная с минус 1, ну не большим с минус 1, да, и вот те коэффициенты как раз там
[01:20:52.820 --> 01:20:57.740]  будут лежать. Так, ну давайте поймем, почему это верно. На примере какого-нибудь, ну давайте
[01:20:57.740 --> 01:21:06.340]  рассмотрим просто e, e, значит, давайте вот здесь вот есть слагаемая e it на x, еs на x в st. Давайте
[01:21:06.340 --> 01:21:14.180]  поймем, что происходит при взятии его по модулю p от x. Значит, еs на x в st при взятии по вот
[01:21:14.180 --> 01:21:22.780]  этому модулю, ну давайте я множитель отдельно оставлю, возьму x в st по модулю p от x. Чему это
[01:21:22.780 --> 01:21:28.420]  равно? Ну, понятно, что неполно частной будет единица, а остаток будет как раз c с минус 1,
[01:21:28.420 --> 01:21:37.460]  x в st минус 1, плюс c с минус 2, x в st минус 2 и так далее, c нулевое. Согласны? Просто если x в st
[01:21:37.460 --> 01:21:42.500]  поделюсь с остатком, то вот это ровно будет остатком. Да, неполно частная единица это остаток.
[01:21:42.500 --> 01:21:49.060]  То есть получается, смотрите, мы взяли и теперь я еще на еs это все умножу.
[01:21:49.060 --> 01:21:56.340]  Просто еs здесь выпишу.
[01:21:56.340 --> 01:22:10.340]  То есть при взятии еs и x в st по модулю p у нас как раз пропадает зависимость от x в st и
[01:22:10.340 --> 01:22:15.980]  появляется зависимость через x в st минус 1 и так далее, x и тогда ну как бы вплоть до
[01:22:15.980 --> 01:22:27.300]  x в нулевой степени. Значит, сейчас, верно ли, что она правильная? Мне хочется понять, что еs,
[01:22:27.300 --> 01:22:36.580]  а st это еs на c с минус 1, а с минус 1, плюс и так далее, плюс c ноль. Ну, это верно, вроде,
[01:22:36.580 --> 01:22:42.780]  просто по нашему определению. Вот если я поставлю там вместо и s, то у меня получится ровно вот это,
[01:22:42.780 --> 01:22:47.220]  еще умножено нужный коэффициент. Поэтому, действительно, взятие вот этого манома по модулю
[01:22:47.220 --> 01:22:55.500]  p от x и замена, да, как бы x в степени какой-то на а с тем же индексом, это в точности прокидывание
[01:22:55.500 --> 01:23:02.940]  еs в более младшие слагаемые, в более младшие члены нашей прогрессии, нашей последовательности.
[01:23:02.940 --> 01:23:10.940]  Ну и, собственно, тоже самое работает дальше для всех остальных. Если возьму x в s плюс 1 по
[01:23:10.940 --> 01:23:15.460]  модулю p от x, то это что? То это вот это вот, еще умножить на x и взять еще раз по модулю.
[01:23:15.460 --> 01:23:28.340]  Ну, сейчас. Давайте одну строчку напишу и на этом закончим. Вот это вот.
[01:23:28.340 --> 01:23:42.420]  Дальше я раскрываю, вот эти остаются, и будет здесь опять x в s, да, то есть здесь останется одно
[01:23:42.420 --> 01:23:47.500]  x в s, которое надо будет брать по модулю, а x в s по модулю p от x как раз раскрывается так как нам
[01:23:47.500 --> 01:23:52.860]  нужно. Поэтому все вот то, что я написал, действительно верно, и мне нужно просто этот многочлен взять,
[01:23:52.860 --> 01:23:57.540]  взять его остаток по модулю p от x, и тем самым все вот эти вот более старшие члены прокинем в младшие.
[01:23:57.660 --> 01:24:05.740]  Да, у нас появится зависимость более старших членов от более младших. Вот, ну и итоговая симптотика
[01:24:05.740 --> 01:24:16.860]  будет s лог s на лог n, потому что s лог s это время, необходимое на вот это вот все промежуточное,
[01:24:16.860 --> 01:24:22.380]  да, мне, значит, я что сделал? Я возделал многочлен в квадрат и взял его по модулю p. Все это работает
[01:24:22.380 --> 01:24:27.780]  за s лог s, потому что у меня были по дороге многочлены степени s, и это нужно сделать примерно лог n раз,
[01:24:27.780 --> 01:24:33.740]  потому что так работает бинарное разделение в степень. Мне нужно там единицу добить до n,
[01:24:33.740 --> 01:24:39.820]  умея переходить там от как 2k, но еще нужно научиться переходить от как k плюс 1, но это
[01:24:39.820 --> 01:24:45.420]  тривиально, там нужно просто, там нужно один раз сделать вот это вот прокидывание, это вообще
[01:24:45.420 --> 01:24:49.740]  можно сделать до вот s. Вот, ну время вышло, поэтому на этом все. Спасибо.
