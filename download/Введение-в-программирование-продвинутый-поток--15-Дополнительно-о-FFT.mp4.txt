[00:00.000 --> 00:10.000]  Ладно, многочлены поделили, числа поделили.
[00:10.000 --> 00:17.000]  Ладно, давайте попробуем тогда немножко размяться.
[00:17.000 --> 00:23.000]  Итак, что еще можно вообще делать с перемножением многочленов?
[00:23.000 --> 00:28.000]  Да, как я уже сказал, не именно с фурье, а скорее с перемножением многочленов.
[00:28.000 --> 00:35.000]  Но начнем мы с такой маленькой разминочной задачи про дуэль.
[00:35.000 --> 00:42.000]  Итак, представьте, задача заключается в следующем.
[00:42.000 --> 00:48.000]  Два товарища очень любят стреляться на дуэлях.
[00:48.000 --> 00:51.000]  Из пинбольных орудий, конечно.
[00:51.000 --> 00:56.000]  Что болит?
[00:56.000 --> 01:02.000]  Во-первых, если в правильной одежде, то нормально, а во-вторых, как всегда.
[01:02.000 --> 01:11.000]  Если из какого-то вида спорта, то есть чего-то убрать в риск для жизни, то это превращается в вид спорта, где можно четверть финал, полуфинал и так далее.
[01:11.000 --> 01:17.000]  Или потом в финале большой матч до пяти побед, я не знаю.
[01:17.000 --> 01:22.000]  В общем, они очень это любят.
[01:22.000 --> 01:26.000]  Но вообще теперь возникает вопрос. Что такое дуэль вообще?
[01:26.000 --> 01:31.000]  Ну, конкретно в их интерпретации обычно это происходит так.
[01:31.000 --> 01:36.000]  Значит, есть некий прямой отрезок.
[01:36.000 --> 01:42.000]  У товарищей есть по одному пистолету в каждом пистолете один патрон.
[01:42.000 --> 01:47.000]  В середине стоит барьер.
[01:47.000 --> 01:52.000]  Они становятся спиной друг к другу.
[01:52.000 --> 01:57.000]  Значит, расходятся на какое-то одинаковое расстояние.
[01:57.000 --> 02:01.000]  Раз, сворачиваются.
[02:01.000 --> 02:05.000]  И по команде секунданта сходитесь.
[02:05.000 --> 02:08.000]  Собственно, игра начинается. Они идут навстречу друг к другу.
[02:08.000 --> 02:13.000]  Каждый имеет право выстрелить в тот момент, когда он считает нужным.
[02:13.000 --> 02:18.000]  Вы можете стрелять сразу, выстрелить когда-нибудь потом.
[02:18.000 --> 02:23.000]  Если вас очень хорошо попали, то до вашего выстрела речь может не дойти.
[02:23.000 --> 02:28.000]  Вот такая интеллектуальная игра.
[02:28.000 --> 02:33.000]  Но товарищам очень хотелось это опробировать.
[02:33.000 --> 02:41.000]  То есть они там у себя рядом с Черной Речкой нашли даже для этого дела идеально прямую аллею.
[02:41.000 --> 02:46.000]  Длины 10 в пятый.
[02:46.000 --> 02:50.000]  Да, ну как всегда, да.
[02:50.000 --> 02:56.000]  Даже кривизна земли каким-то образом не помешала.
[02:56.000 --> 03:01.000]  Ну или сантиметров, я не знаю.
[03:01.000 --> 03:04.000]  Ну тоже сомнительно, сейчас увидите почему.
[03:04.000 --> 03:10.000]  Она мало того, что идеально прямая, так еще и хорошо размельчена прям по метрам.
[03:10.000 --> 03:16.000]  Вообще изначально планировалось засадить кустариками.
[03:16.000 --> 03:21.000]  Через каждый метр тут какие-то кустарики посадить.
[03:21.000 --> 03:27.000]  Но пока посадили не все. Где-то посадили, где-то нет.
[03:27.000 --> 03:34.000]  Товарищи хотят устроить дуэль.
[03:34.000 --> 03:43.000]  Думают устроить дуэль так, что барьер должен быть на какой-нибудь отметке.
[03:43.000 --> 03:51.000]  И соответственно разойтись они должны на одинаковое расстояние тоже до какого-то дерева.
[03:51.000 --> 03:59.000]  Но они очень любят дуэль, поэтому возникает вопрос, сколько различных дуэлей они могут...
[03:59.000 --> 04:10.000]  Да, вполне.
[04:10.000 --> 04:14.000]  Ну до разведки, на которой стоит куст, причем в обе стороны.
[04:14.000 --> 04:20.000]  И они должны быть на одинаковом расстоянии. Вот такая вот задачка.
[04:20.000 --> 04:25.000]  Вот спрашивается, причем тут SST?
[04:25.000 --> 04:30.000]  Да.
[04:30.000 --> 04:37.000]  Ну в общем-то это даже менее критично на самом деле.
[04:37.000 --> 04:41.000]  Да, да, да.
[04:41.000 --> 04:44.000]  Так, ну совершенно верно, да.
[04:44.000 --> 04:46.000]  Что это было?
[04:46.000 --> 04:49.000]  Рассмотреть. А идея очень простая.
[04:49.000 --> 04:52.000]  Ну да, то есть действительно.
[04:52.000 --> 05:01.000]  Чем отличаются дуэли с центром в позиции, скажем, в точке A?
[05:01.000 --> 05:06.000]  То есть это какие-то дуэли типа A плюс X и A минус X.
[05:06.000 --> 05:17.000]  Эти числа интересны тем, что их сумма не зависит от X, потому что их сумма равна 2A.
[05:17.000 --> 05:19.000]  И теперь возникает такая идея.
[05:19.000 --> 05:21.000]  А давайте действительно забабахаем многочлен.
[05:21.000 --> 05:23.000]  Вот прям так и забабахаем.
[05:23.000 --> 05:29.000]  Вот нам допустим АТ равно, ну в нашем случае будет T в четвертой, там плюс T в шестой,
[05:29.000 --> 05:36.000]  плюс T в восьмой, плюс T в девятой, плюс T в десятой, плюс T, ну соответственно, в тринадцатой.
[05:36.000 --> 05:38.000]  Видите, да?
[05:38.000 --> 05:41.000]  То есть вот какая-нибудь такая приятность.
[05:41.000 --> 05:44.000]  Вот.
[05:44.000 --> 05:47.000]  И вот нам хочется, ну вот.
[05:47.000 --> 05:49.000]  И теперь вот идея такая.
[05:49.000 --> 05:52.000]  А давайте попробуем многочлен А умножить на сам себя.
[05:52.000 --> 05:54.000]  Тогда что получится?
[05:54.000 --> 06:01.000]  Тогда вот действительно давайте задумаемся, что у нас будет, например, при коэффициенте T в двенадцатой.
[06:01.000 --> 06:08.000]  Но при Т в двенадцатой будет находиться, ну если тут коэффициенты назвать там A0, A1, A2 и так далее,
[06:08.000 --> 06:09.000]  то что это такое?
[06:09.000 --> 06:19.000]  То при Т в двенадцатой тут будет, например, A0, A12, плюс A1, A11, плюс A2, A10, плюс и так далее,
[06:19.000 --> 06:23.000]  плюс там A12, A0.
[06:23.000 --> 06:25.000]  Вот.
[06:25.000 --> 06:27.000]  То есть вот такая скобочка.
[06:27.000 --> 06:33.000]  Заметим, что каждое произведение оно вообще символизирует дуэль,
[06:33.000 --> 06:36.000]  которая может быть с центром шестерки.
[06:36.000 --> 06:42.000]  Ну правда, ладно, с оговоркой, без учета того, что там в этой шестерке есть единичка или нет, правда?
[06:42.000 --> 06:52.000]  Причем более того, именно в такой терминологии вот A, T у нас понимаем, что либо произведение равно единице и дуэль возможны,
[06:52.000 --> 06:54.000]  либо ноль, и она и ее нет.
[06:54.000 --> 06:56.000]  Очень удобно.
[06:56.000 --> 06:58.000]  То есть единственное, конечно, какие оговорки надо сделать?
[06:58.000 --> 07:02.000]  Ну, во-первых, заметим, что каждая не тривиальная дуэль,
[07:02.000 --> 07:10.000]  потому что заметим, что где-то тут на самом деле, на самом деле есть коэффициент А6 в квадрате.
[07:10.000 --> 07:12.000]  Вот.
[07:12.000 --> 07:16.000]  Но помимо этого коэффициента, то есть это коэффициент символизирует такую тривиальную дуэль,
[07:16.000 --> 07:18.000]  то есть это дуэль через платок.
[07:18.000 --> 07:22.000]  То есть в принципе тоже вариант на самом деле, когда вы там просто рядом стоите,
[07:22.000 --> 07:24.000]  стреляетесь просто через платок,
[07:24.000 --> 07:28.000]  только проблема в том, что только в одном из пистолетов заряд.
[07:28.000 --> 07:31.000]  Да, то есть практически рандом.
[07:31.000 --> 07:33.000]  Ну, то есть вы вытягиваете наугад.
[07:33.000 --> 07:35.000]  То есть да, вот бы было такой вариант.
[07:35.000 --> 07:37.000]  Вот.
[07:37.000 --> 07:39.000]  Соответственно.
[07:39.000 --> 07:41.000]  Но мы тут через платок не стреляемся,
[07:41.000 --> 07:43.000]  но помимо этого слагаем,
[07:43.000 --> 07:45.000]  и все остальные символизируют дуэль.
[07:45.000 --> 07:48.000]  Причем у стена, она, как видите, два раза.
[07:48.000 --> 07:50.000]  Вот.
[07:50.000 --> 07:52.000]  Поэтому на самом деле, можно просто сразу сказать,
[07:52.000 --> 07:54.000]  что если у нас при каком-нибудь Т в степени,
[07:54.000 --> 07:59.000]  допустим, 2К оказался нечетный, допустим, коэффициент,
[07:59.000 --> 08:04.000]  то значит, получается, это означает, что ТКТ было с единичкой,
[08:04.000 --> 08:06.000]  в нем можно устраивать дуэли,
[08:06.000 --> 08:10.000]  и количество дуэли, которые тут можно устроить, этот коэффициент пополам.
[08:10.000 --> 08:12.000]  Вот.
[08:12.000 --> 08:14.000]  Ну или можно было просто, конечно, проверить, перебирать все К,
[08:14.000 --> 08:16.000]  скажем так, если вот в центре К можно устраивать,
[08:16.000 --> 08:18.000]  то отберем коэффициент делим на два.
[08:18.000 --> 08:20.000]  Так вот так.
[08:20.000 --> 08:24.000]  То есть вот такая вот не сильно сложная задачка.
[08:26.000 --> 08:28.000]  Вот.
[08:29.000 --> 08:32.000]  То есть действительно, вот оказывается,
[08:32.000 --> 08:34.000]  что если тут где-то что-то надо просуммировать,
[08:34.000 --> 08:38.000]  то, скорее всего, все в порядке.
[08:38.000 --> 08:40.000]  Вот.
[08:40.000 --> 08:42.000]  Ну давайте, да, хочется сказать это,
[08:42.000 --> 08:44.000]  давайте поднимем планочку,
[08:44.000 --> 08:46.000]  но на самом деле следующая задача, в общем-то,
[08:46.000 --> 08:48.000]  сильно сложнее не будет.
[08:48.000 --> 08:50.000]  Смотрите.
[08:52.000 --> 08:54.000]  Задача такая.
[08:54.000 --> 08:56.000]  Ну вот.
[08:56.000 --> 08:58.000]  По-разному ее можно формулировать.
[08:58.000 --> 09:00.000]  Вот, например, я ее так,
[09:00.000 --> 09:02.000]  чтобы, может быть, совсем запутать.
[09:02.000 --> 09:04.000]  Вот представь себе, есть массив чисел.
[09:12.000 --> 09:14.000]  Вот.
[09:14.000 --> 09:16.000]  Абсолютно тут.
[09:16.000 --> 09:18.000]  Какие сами все числа вообще отбалдаются.
[09:20.000 --> 09:22.000]  Вот.
[09:22.000 --> 09:26.000]  Значит, у нас есть трафарет.
[09:26.000 --> 09:28.000]  Это вот какой-то такой массив
[09:28.000 --> 09:30.000]  меньшей длины.
[09:30.000 --> 09:32.000]  Ну трафарет, ну то есть это значит,
[09:32.000 --> 09:34.000]  что где-то тут есть дырочки,
[09:34.000 --> 09:36.000]  а где-то дырочек нет.
[09:38.000 --> 09:40.000]  И когда я могу этот массив
[09:40.000 --> 09:42.000]  наложить, как бы, на вот
[09:42.000 --> 09:44.000]  в какое-то место большого массива
[09:44.000 --> 09:46.000]  и увидеть в окошечках какие-то чиселки.
[09:48.000 --> 09:50.000]  Вот. Я могу эти чиселки просуммировать.
[09:50.000 --> 09:52.000]  Внимание. Вопрос.
[09:52.000 --> 09:54.000]  А какие числа я могу
[09:54.000 --> 09:56.000]  вообще получить?
[09:56.000 --> 09:58.000]  Ну в том плане, что я могу этих наложить
[09:58.000 --> 10:00.000]  вот сюда, сюда, сюда, сюда.
[10:00.000 --> 10:02.000]  Там n-m плюс одно число.
[10:02.000 --> 10:04.000]  Вот я все эти числа хочу получить.
[10:06.000 --> 10:08.000]  Прям вот как последовательность.
[10:10.000 --> 10:12.000]  Ну на самом деле, да.
[10:12.000 --> 10:14.000]  То есть, действительно, тут мы введем
[10:14.000 --> 10:16.000]  многочлен, формально говоря.
[10:16.000 --> 10:18.000]  А, Т, равно, соответственно,
[10:18.000 --> 10:20.000]  вот так и введем.
[10:20.000 --> 10:22.000]  Значит, в данном случае
[10:22.000 --> 10:24.000]  5 плюс 4t плюс
[10:24.000 --> 10:26.000]  2t квадрат плюс 4t в кубе
[10:26.000 --> 10:28.000]  плюс 3t в четвертый
[10:28.000 --> 10:30.000]  плюс t в пятый
[10:30.000 --> 10:32.000]  плюс 7t в шестой
[10:32.000 --> 10:34.000]  плюс 5t в седьмой
[10:34.000 --> 10:36.000]  плюс 6t в восьмой
[10:36.000 --> 10:38.000]  плюс 8t в девятый.
[10:38.000 --> 10:40.000]  Вот. А здесь,
[10:40.000 --> 10:42.000]  а вот здесь мы сделаем хипрея.
[10:44.000 --> 10:46.000]  А здесь, знаете, я даже
[10:46.000 --> 10:48.000]  не буду разворачивать саму маску,
[10:48.000 --> 10:50.000]  я просто многочлен нарисую чуть по-другому.
[10:52.000 --> 10:54.000]  То есть, bt
[10:54.000 --> 10:56.000]  у меня будет равен.
[10:56.000 --> 10:58.000]  Сразу напишу.
[10:58.000 --> 11:00.000]  0 плюс, значит,
[11:00.000 --> 11:02.000]  t плюс t квадрат
[11:02.000 --> 11:04.000]  плюс 0
[11:04.000 --> 11:06.000]  на t в кубе
[11:06.000 --> 11:08.000]  плюс t в четвертый.
[11:08.000 --> 11:10.000]  Почему я нарисовал
[11:10.000 --> 11:12.000]  именно в обратном порядке?
[11:12.000 --> 11:14.000]  Потому что заметим, что
[11:14.000 --> 11:16.000]  когда я буду перемножать
[11:16.000 --> 11:18.000]  теперь a на b,
[11:18.000 --> 11:20.000]  что у меня получится, тогда
[11:20.000 --> 11:22.000]  при t в четвертый у меня будет
[11:22.000 --> 11:24.000]  5, то есть смотрите,
[11:24.000 --> 11:26.000]  5 на t в четвертый,
[11:26.000 --> 11:28.000]  то есть 5 умножить на 1 плюс 4 умножить на 0
[11:28.000 --> 11:30.000]  плюс 2 умножить на 1
[11:30.000 --> 11:32.000]  плюс 4 умножить на 1 плюс 3 умножить на 0.
[11:34.000 --> 11:36.000]  То есть ровно та сумма, обратите внимание,
[11:36.000 --> 11:38.000]  которая нам нужна.
[11:38.000 --> 11:40.000]  Вот, понимаете, да?
[11:42.000 --> 11:44.000]  Вот.
[11:44.000 --> 11:46.000]  То есть, видите, вот зачем, собственно, развернули?
[11:46.000 --> 11:48.000]  А что будет
[11:48.000 --> 11:50.000]  при четвертом, при
[11:50.000 --> 11:52.000]  степени 4, окажется вот
[11:52.000 --> 11:54.000]  ровно то, что будет, если мы приложим
[11:54.000 --> 11:56.000]  сюда. А если мы хотим приложить
[11:56.000 --> 11:58.000]  чуть правее, то тогда получается
[11:58.000 --> 12:00.000]  будет тогда 4 на 1
[12:00.000 --> 12:02.000]  плюс 2 на 0 плюс 4 на 1 плюс 3
[12:02.000 --> 12:04.000]  на 1 плюс 1
[12:04.000 --> 12:06.000]  на 0. Это будет тоже
[12:06.000 --> 12:08.000]  то, что будет просто при пятом
[12:08.000 --> 12:10.000]  коэффициенте.
[12:10.000 --> 12:12.000]  Понимаете, да?
[12:12.000 --> 12:14.000]  Вот. И так далее. То есть вот оказывается
[12:14.000 --> 12:16.000]  действительно очень удобно. То есть на самом деле
[12:16.000 --> 12:18.000]  задача могла быть сформулирована в виде,
[12:18.000 --> 12:20.000]  что, ну, вот
[12:20.000 --> 12:22.000]  и можно так сформулировать. Вот для массивов
[12:22.000 --> 12:24.000]  двух одинаковой длины, вот двух массивов
[12:24.000 --> 12:26.000]  одинаковой длины
[12:26.000 --> 12:28.000]  существует такое понятие, как
[12:28.000 --> 12:30.000]  скалярное
[12:30.000 --> 12:32.000]  произведение, например, да?
[12:32.000 --> 12:34.000]  Так что я не сказал расстояние хэминга, но это
[12:34.000 --> 12:36.000]  не совсем, да? То есть просто, когда мы
[12:36.000 --> 12:38.000]  просто кладем один
[12:38.000 --> 12:40.000]  один над другим и прям вот
[12:40.000 --> 12:42.000]  делаем такие, суммируем вот такие
[12:42.000 --> 12:44.000]  попарные произведения, да?
[12:44.000 --> 12:46.000]  А можно сказать, что давайте
[12:46.000 --> 12:48.000]  вот у меня есть один массив, есть более маленький
[12:48.000 --> 12:50.000]  массив, я его прикладываю везде и хочу
[12:50.000 --> 12:52.000]  везде скалярное произведение.
[12:52.000 --> 12:54.000]  Ну, как легко убедиться, ровно этим же
[12:54.000 --> 12:56.000]  хаком, то есть мы это можем легко сделать.
[12:56.000 --> 12:58.000]  Вот.
[12:58.000 --> 13:00.000]  Да. То есть вот такая вот
[13:00.000 --> 13:02.000]  действительно при...
[13:02.000 --> 13:04.000]  Вот такая вот приятность есть.
[13:04.000 --> 13:06.000]  Вот.
[13:06.000 --> 13:08.000]  Так что, соответственно, да,
[13:08.000 --> 13:10.000]  чуть-чуть поразминались.
[13:10.000 --> 13:12.000]  Вот.
[13:12.000 --> 13:14.000]  Вот.
[13:14.000 --> 13:16.000]  Давайте, значит, еще
[13:16.000 --> 13:18.000]  попробуем.
[13:18.000 --> 13:20.000]  Что еще хочется сделать?
[13:20.000 --> 13:22.000]  Ну, иногда...
[13:22.000 --> 13:24.000]  Вот.
[13:24.000 --> 13:26.000]  Так.
[13:26.000 --> 13:28.000]  А, ну, впрочем,
[13:28.000 --> 13:30.000]  если немножко
[13:30.000 --> 13:32.000]  разминаться, то на самом деле тут есть
[13:32.000 --> 13:34.000]  конечно еще чит, связанный именно с комплексными
[13:34.000 --> 13:36.000]  числами.
[13:36.000 --> 13:38.000]  Вот.
[13:38.000 --> 13:40.000]  Но, правда, тут, к сожалению, еще придется
[13:40.000 --> 13:42.000]  вспомнить, что такое FFT само по себе.
[13:42.000 --> 13:44.000]  Да. То есть не как черный ящик,
[13:44.000 --> 13:46.000]  типа, что у нас есть перемножение
[13:46.000 --> 13:48.000]  многочленов.
[13:48.000 --> 13:50.000]  А может, в общем, нам и повезет.
[13:50.000 --> 13:52.000]  Вот. Ну, потому что
[13:52.000 --> 13:54.000]  дело в том, что действительно сколько FFT
[13:54.000 --> 13:56.000]  вообще обычно нам надо, чтобы перемножить
[13:56.000 --> 13:58.000]  два многочлена?
[13:58.000 --> 14:00.000]  Сколько раз там нужно
[14:00.000 --> 14:02.000]  запустить там функцию, которая вычисляет
[14:02.000 --> 14:04.000]  там...
[14:04.000 --> 14:06.000]  Нет, зачем?
[14:06.000 --> 14:08.000]  То есть не понятно.
[14:08.000 --> 14:10.000]  Ну, конечно, три, да.
[14:10.000 --> 14:12.000]  То есть у нас, помним, один преобразовали,
[14:12.000 --> 14:14.000]  второй преобразовали, помните,
[14:14.000 --> 14:16.000]  перемножили там по члену,
[14:16.000 --> 14:18.000]  а потом применили обратно, которое свелось
[14:18.000 --> 14:20.000]  к обычному.
[14:20.000 --> 14:22.000]  Только там еще поделить на T и подставить там
[14:22.000 --> 14:24.000]  другое. Ну, понятно, не важно.
[14:24.000 --> 14:26.000]  Вот.
[14:26.000 --> 14:28.000]  Так вот возникает
[14:28.000 --> 14:30.000]  неожиданная идея.
[14:30.000 --> 14:32.000]  Если вы... Чаще всего вы, наверное,
[14:32.000 --> 14:34.000]  перемножаете все-таки не комплексные
[14:34.000 --> 14:36.000]  многочлены, а действительные.
[14:36.000 --> 14:38.000]  Правда?
[14:38.000 --> 14:40.000]  А вот тогда...
[14:40.000 --> 14:42.000]  Ну, вот.
[14:42.000 --> 14:44.000]  А вот возникает такая задача. Смотрите. Вот если,
[14:44.000 --> 14:46.000]  допустим, мы хотим перемножать многочлены
[14:46.000 --> 14:48.000]  даже одинаковой длины,
[14:50.000 --> 14:52.000]  вот прям вот, АТ
[14:52.000 --> 14:54.000]  равно там, так и написать,
[14:54.000 --> 14:56.000]  А0 плюс А1Т плюс
[14:56.000 --> 14:58.000]  А2Т квадрат плюс и так далее,
[14:58.000 --> 15:00.000]  Е плюс АН минус 1
[15:00.000 --> 15:02.000]  на Т в степень Н минус 1.
[15:02.000 --> 15:04.000]  И B от Т.
[15:04.000 --> 15:06.000]  Значит, у меня там B0
[15:06.000 --> 15:08.000]  плюс B1Т плюс B2Т
[15:08.000 --> 15:10.000]  квадрат плюс и так далее,
[15:10.000 --> 15:12.000]  плюс BН минус 1 Т в степень
[15:12.000 --> 15:14.000]  Н минус 1. Даже для веселья
[15:14.000 --> 15:16.000]  пусть Н еще и степень 2.
[15:18.000 --> 15:20.000]  Вот.
[15:22.000 --> 15:24.000]  Вот. И мы как...
[15:24.000 --> 15:26.000]  Как устроено перемножение? Мы делаем FFT для этого,
[15:26.000 --> 15:28.000]  FFT для этого,
[15:28.000 --> 15:30.000]  ну и там перемножаем.
[15:30.000 --> 15:32.000]  А теперь возникает вопрос.
[15:32.000 --> 15:34.000]  Смотрите. Возникает такая идея.
[15:36.000 --> 15:38.000]  Давайте введем такой интересный
[15:38.000 --> 15:40.000]  многочлен, я даже вот D от
[15:40.000 --> 15:42.000]  Т назову,
[15:42.000 --> 15:44.000]  который будет равен
[15:44.000 --> 15:46.000]  вот А0 плюс B0
[15:46.000 --> 15:48.000]  на И, где И там не моя единица,
[15:48.000 --> 15:50.000]  а не то, что вы подумали.
[15:50.000 --> 15:52.000]  Хотя, скорее всего, вы именно это и подумали.
[15:54.000 --> 15:56.000]  А что такое не моя единица?
[16:00.000 --> 16:02.000]  Ну...
[16:02.000 --> 16:04.000]  Ну индекс.
[16:04.000 --> 16:06.000]  Как...
[16:06.000 --> 16:08.000]  Как это называется? Что такое рота?
[16:08.000 --> 16:10.000]  Рота? Ну рота!
[16:10.000 --> 16:12.000]  Ну под носой.
[16:12.000 --> 16:14.000]  Ну вот шо?
[16:14.000 --> 16:16.000]  В роту входит 150 человек.
[16:16.000 --> 16:18.000]  Так.
[16:18.000 --> 16:20.000]  Так.
[16:26.000 --> 16:28.000]  Вот.
[16:28.000 --> 16:30.000]  Ну вот.
[16:30.000 --> 16:32.000]  Вот хочется взять
[16:32.000 --> 16:34.000]  и, ну то есть
[16:34.000 --> 16:36.000]  действительно сказать, что вот взять просто
[16:36.000 --> 16:38.000]  многочлен, который в действительной части написан
[16:38.000 --> 16:40.000]  многочлен А, а в мнимой части многочлен
[16:40.000 --> 16:42.000]  B.
[16:42.000 --> 16:44.000]  И...
[16:44.000 --> 16:46.000]  Ну вот. И соответственно
[16:46.000 --> 16:48.000]  запустить, так сказать, FFT
[16:48.000 --> 16:50.000]  от D от
[16:50.000 --> 16:52.000]  Т.
[16:52.000 --> 16:54.000]  Вот внимание и вопрос.
[16:56.000 --> 16:58.000]  Можно ли по...
[16:58.000 --> 17:00.000]  Вот теперь задача.
[17:00.000 --> 17:02.000]  По FFT
[17:02.000 --> 17:04.000]  от D от Т, то есть по этим корням,
[17:04.000 --> 17:06.000]  восстановить FFTшки
[17:06.000 --> 17:08.000]  для многочлена
[17:08.000 --> 17:10.000]  А и многочлена B.
[17:10.000 --> 17:12.000]  Да.
[17:12.000 --> 17:14.000]  Да.
[17:14.000 --> 17:16.000]  Да.
[17:16.000 --> 17:18.000]  Да.
[17:18.000 --> 17:20.000]  Да.
[17:20.000 --> 17:22.000]  Да.
[17:22.000 --> 17:24.000]  Да.
[17:24.000 --> 17:26.000]  Ну хотела, да. Нет, в принципе, да.
[17:26.000 --> 17:28.000]  Как всегда, конечно, да.
[17:28.000 --> 17:30.000]  То есть вылить воду из чайника,
[17:30.000 --> 17:32.000]  конечно, действительно
[17:32.000 --> 17:34.000]  это конечно здорово.
[17:34.000 --> 17:36.000]  Но нам, конечно, хотелось, чтобы лишних FFT
[17:36.000 --> 17:38.000]  больше не делать.
[17:38.000 --> 17:40.000]  Давайте.
[17:48.000 --> 17:50.000]  Ну у нас будут такие штуки,
[17:50.000 --> 17:52.000]  как D от единицы,
[17:52.000 --> 17:54.000]  D от...
[17:56.000 --> 17:58.000]  Так. Как у нас там буква
[17:58.000 --> 18:00.000]  называлась? Да, господи, вот так
[18:00.000 --> 18:02.000]  оно называется. D от W
[18:02.000 --> 18:04.000]  в квадрате и так далее.
[18:04.000 --> 18:06.000]  Напоминаю W от W
[18:06.000 --> 18:08.000]  в степени n-1,
[18:08.000 --> 18:10.000]  где Wn равно
[18:10.000 --> 18:12.000]  вот этот вот комплексный корень
[18:12.000 --> 18:14.000]  на степени из единицы. Вот этот вот.
[18:18.000 --> 18:20.000]  Да, вот у нас откуда-то взялся.
[18:20.000 --> 18:22.000]  Давайте попробуем из этого
[18:22.000 --> 18:24.000]  вычислить от единицы.
[18:24.000 --> 18:26.000]  Но это очень легко. Так.
[18:26.000 --> 18:28.000]  А от единицы каким образом?
[18:28.000 --> 18:30.000]  Ну, забить
[18:30.000 --> 18:32.000]  на воображаемую часть
[18:32.000 --> 18:34.000]  и оставить только настоящую.
[18:34.000 --> 18:36.000]  Вот. Да, но на самом деле
[18:38.000 --> 18:40.000]  ну как? Не совсем так.
[18:42.000 --> 18:44.000]  Хотя
[18:44.000 --> 18:46.000]  это правда, да.
[18:46.000 --> 18:48.000]  То есть мы замечаем, что эта штука на самом деле
[18:48.000 --> 18:50.000]  равно тупо A от единицы
[18:50.000 --> 18:52.000]  плюс B от единицы
[18:52.000 --> 18:54.000]  умножить на I.
[18:54.000 --> 18:56.000]  Да. То есть поэтому
[18:56.000 --> 18:58.000]  конкретно для
[18:58.000 --> 19:00.000]  нуля действительно вы это без труда
[19:00.000 --> 19:02.000]  сделаете. А вот дальше
[19:02.000 --> 19:04.000]  я боюсь так халявно вы уже
[19:04.000 --> 19:06.000]  не проскочите.
[19:08.000 --> 19:10.000]  Ну давайте посмотрим.
[19:10.000 --> 19:12.000]  Ну давайте
[19:12.000 --> 19:14.000]  посмотрим. Ну давайте попробуем
[19:14.000 --> 19:16.000]  для начала в явном виде пописать.
[19:16.000 --> 19:18.000]  Давайте сравним усилия.
[19:18.000 --> 19:20.000]  Так D от Wn в степени g.
[19:20.000 --> 19:22.000]  Это что такое?
[19:24.000 --> 19:26.000]  Ну, формально говоря,
[19:26.000 --> 19:28.000]  по определению, это я просто
[19:28.000 --> 19:30.000]  перебираю все коэффициенты и говорю, что
[19:30.000 --> 19:32.000]  это DkT
[19:32.000 --> 19:34.000]  на Wn
[19:34.000 --> 19:36.000]  в степени g
[19:36.000 --> 19:38.000]  умножить на k.
[19:38.000 --> 19:40.000]  Вот. Согласны, да?
[19:44.000 --> 19:46.000]  Ну вот. Как говорится, это похоже.
[19:46.000 --> 19:48.000]  Ну или если прям более точно
[19:48.000 --> 19:50.000]  расписать.
[19:54.000 --> 19:56.000]  Вот они еще там спрашивают, зачем я каждую неделю
[19:56.000 --> 19:58.000]  маркеры беру.
[20:00.000 --> 20:02.000]  Так.
[20:02.000 --> 20:04.000]  Ну вот. То есть на самом деле получается
[20:04.000 --> 20:06.000]  можно расписать так. Я вот даже
[20:06.000 --> 20:08.000]  сразу распишу вот так.
[20:08.000 --> 20:10.000]  Значит akTWn
[20:10.000 --> 20:12.000]  в степени gk
[20:12.000 --> 20:14.000]  плюс i на
[20:16.000 --> 20:18.000]  n-1 bk
[20:18.000 --> 20:20.000]  Wn
[20:20.000 --> 20:22.000]  в степени gk. Да, на этот раз эти
[20:22.000 --> 20:24.000]  числа уже глубоко комплексные, поэтому
[20:24.000 --> 20:26.000]  просто так мы друг от друга не отличим.
[20:26.000 --> 20:28.000]  Но тем не менее.
[20:28.000 --> 20:30.000]  Вот.
[20:34.000 --> 20:36.000]  Ну а теперь давайте
[20:36.000 --> 20:38.000]  вот.
[20:38.000 --> 20:40.000]  Ну действительно. То есть
[20:40.000 --> 20:42.000]  какая тут
[20:42.000 --> 20:44.000]  идея? То есть очень хочется
[20:44.000 --> 20:46.000]  например, чтобы узнать вот эту h,
[20:46.000 --> 20:48.000]  то есть вот эту вот часть.
[20:48.000 --> 20:50.000]  То есть хочется убить эту часть.
[20:50.000 --> 20:52.000]  То есть в принципе нам бы помогло,
[20:52.000 --> 20:54.000]  если бы у нас вот
[20:54.000 --> 20:56.000]  получилось то же самое, то только тут
[20:56.000 --> 20:58.000]  бы стоял не
[20:58.000 --> 21:00.000]  допустим знак плюс, а
[21:00.000 --> 21:02.000]  знак минус.
[21:02.000 --> 21:04.000]  Найти такую же
[21:04.000 --> 21:06.000]  штуку.
[21:06.000 --> 21:08.000]  Ну если бы у вас было
[21:08.000 --> 21:10.000]  тоже, вот такое же
[21:10.000 --> 21:12.000]  число, только тут знак минус.
[21:12.000 --> 21:14.000]  Да, дополнительно.
[21:14.000 --> 21:16.000]  Конечно, да.
[21:16.000 --> 21:18.000]  Да, если и то и то, то да, то мы там
[21:18.000 --> 21:20.000]  складываем пополам.
[21:20.000 --> 21:22.000]  Вот. Ну а с другой стороны действительно.
[21:22.000 --> 21:24.000]  Откуда же нам их
[21:24.000 --> 21:26.000]  взять?
[21:26.000 --> 21:28.000]  Ну на самом деле что нужно сделать, чтобы плюс
[21:28.000 --> 21:30.000]  и заменился на минус и?
[21:30.000 --> 21:32.000]  Конечно же взять сопряженное.
[21:32.000 --> 21:34.000]  Вот.
[21:34.000 --> 21:36.000]  Вот давайте. Если мы о этой штуке возьмем
[21:36.000 --> 21:38.000]  сопряженное, то получится
[21:38.000 --> 21:40.000]  что?
[21:40.000 --> 21:42.000]  Ну давайте
[21:42.000 --> 21:44.000]  посмотрим какая.
[21:44.000 --> 21:46.000]  То есть берем сопряженное.
[21:46.000 --> 21:48.000]  Ну получится понятно, что
[21:48.000 --> 21:50.000]  ладно, сопряженная сумма это сумма
[21:50.000 --> 21:52.000]  сопряженных, сопряженное произведение
[21:52.000 --> 21:54.000]  сопряженных, да, это все знают.
[21:54.000 --> 21:56.000]  А сопряженная действительного числа равна
[21:56.000 --> 21:58.000]  самому действительному числу.
[21:58.000 --> 22:00.000]  Поэтому получается примерно следующая штука.
[22:00.000 --> 22:02.000]  Значит АК, сопряженная
[22:02.000 --> 22:04.000]  WN, вот в этой мистической
[22:04.000 --> 22:06.000]  степени.
[22:06.000 --> 22:08.000]  Минус и
[22:08.000 --> 22:10.000]  на сумму
[22:12.000 --> 22:14.000]  значит BKT
[22:14.000 --> 22:16.000]  и WN
[22:16.000 --> 22:18.000]  в степени ЖК.
[22:18.000 --> 22:20.000]  Вот.
[22:24.000 --> 22:26.000]  Теперь вот внимание вопрос.
[22:26.000 --> 22:28.000]  А чему у нас
[22:28.000 --> 22:30.000]  равно сопряженная WN?
[22:42.000 --> 22:44.000]  То же самое, только степень с минусом.
[22:44.000 --> 22:46.000]  То есть на самом деле
[22:46.000 --> 22:48.000]  можно заметить, что это равно
[22:52.000 --> 22:54.000]  то есть можно так написать, что это равно
[22:54.000 --> 22:56.000]  А от WN в степени
[22:56.000 --> 22:58.000]  минус Ж
[22:58.000 --> 23:00.000]  минус И
[23:00.000 --> 23:02.000]  В от WN
[23:02.000 --> 23:04.000]  в степени
[23:04.000 --> 23:06.000]  минус Ж.
[23:10.000 --> 23:12.000]  Но правда, смотрите как интересно.
[23:12.000 --> 23:14.000]  Ведь дело в том, что у нас на самом деле
[23:14.000 --> 23:16.000]  будет что-то похожее, на самом деле уже есть.
[23:22.000 --> 23:24.000]  Ну да, потому что WN в степени
[23:24.000 --> 23:26.000]  минус Ж
[23:26.000 --> 23:28.000]  то же самое, что WN в степени
[23:28.000 --> 23:30.000]  N минус Ж.
[23:30.000 --> 23:32.000]  Ж равно нулю мы даже не рассматриваем,
[23:32.000 --> 23:34.000]  потому что мы уже его рассмотрели.
[23:36.000 --> 23:38.000]  Так.
[23:38.000 --> 23:40.000]  Но что же у нас тогда будет?
[23:40.000 --> 23:42.000]  То есть в принципе да,
[23:42.000 --> 23:44.000]  если тут написать, что это равно
[23:44.000 --> 23:46.000]  действительно A от
[23:46.000 --> 23:48.000]  действительно WG
[23:48.000 --> 23:50.000]  плюс I на IB
[23:50.000 --> 23:52.000]  на WN в степени Ж.
[23:52.000 --> 23:54.000]  Но правда мы замечаем, то есть очень хочется
[23:54.000 --> 23:56.000]  рассмотреть такую штуку, как WN
[23:56.000 --> 23:58.000]  в степени минус Ж.
[23:58.000 --> 24:00.000]  Чему она равна? Она равна
[24:00.000 --> 24:02.000]  ну A от
[24:02.000 --> 24:04.000]  WN в степени минус Ж
[24:04.000 --> 24:06.000]  плюс I на
[24:06.000 --> 24:08.000]  B от WN в степени
[24:08.000 --> 24:10.000]  минус Ж.
[24:12.000 --> 24:14.000]  Но к сожалению,
[24:14.000 --> 24:16.000]  если прям честно писать,
[24:16.000 --> 24:18.000]  честно подставить вместо Ж минус Ж, то
[24:18.000 --> 24:20.000]  как бы непонятно с чего там взялся минус.
[24:20.000 --> 24:22.000]  Так что к сожалению, пока
[24:22.000 --> 24:24.000]  действительно не все так хорошо.
[24:32.000 --> 24:34.000]  Вот, тупо это.
[24:34.000 --> 24:36.000]  Вот.
[24:36.000 --> 24:38.000]  Так.
[24:40.000 --> 24:42.000]  Но тут
[24:42.000 --> 24:44.000]  мы действительно
[24:44.000 --> 24:46.000]  вот, то есть
[24:46.000 --> 24:48.000]  вот.
[24:48.000 --> 24:50.000]  Но теперь давайте смотреть.
[24:50.000 --> 24:52.000]  Но тогда давайте попробуем наоборот.
[24:52.000 --> 24:54.000]  То есть раз WN минус Ж
[24:54.000 --> 24:56.000]  равно тому, то
[24:56.000 --> 24:58.000]  сопряженное к нему
[24:58.000 --> 25:00.000]  равно
[25:00.000 --> 25:02.000]  чему оно равно?
[25:02.000 --> 25:04.000]  Ну оно равно,
[25:04.000 --> 25:06.000]  на самом деле, так как у нас A это
[25:06.000 --> 25:08.000]  многочисленность с действительными коэффициентами,
[25:08.000 --> 25:10.000]  то получается A от
[25:10.000 --> 25:12.000]  сопряженного к WN минус Ж
[25:12.000 --> 25:14.000]  минус I на
[25:14.000 --> 25:16.000]  B на WN в степени
[25:16.000 --> 25:18.000]  минус Ж сопряженной.
[25:18.000 --> 25:20.000]  Вот.
[25:20.000 --> 25:22.000]  Но сопряженное
[25:22.000 --> 25:24.000]  к WN в степени минус Ж
[25:24.000 --> 25:26.000]  это в точности WN в степени Ж,
[25:26.000 --> 25:28.000]  как мы уже узнали.
[25:28.000 --> 25:30.000]  Значит,
[25:30.000 --> 25:32.000]  D от WN в степени Ж
[25:32.000 --> 25:34.000]  то есть оказывается нам надо
[25:34.000 --> 25:36.000]  просто взять,
[25:36.000 --> 25:38.000]  то есть если мы рассмотрим D от WN
[25:38.000 --> 25:40.000]  в степени Ж
[25:40.000 --> 25:42.000]  и D от WN в степени минус Ж
[25:42.000 --> 25:44.000]  и возьмем к нему сопряженное,
[25:44.000 --> 25:46.000]  то есть просто
[25:46.000 --> 25:48.000]  минимую часть на минус единичку
[25:48.000 --> 25:50.000]  домножим,
[25:50.000 --> 25:52.000]  то оказывается у нас есть число
[25:52.000 --> 25:54.000]  вот это
[25:54.000 --> 25:56.000]  минус это
[25:56.000 --> 25:58.000]  и есть число вот это плюс это.
[25:58.000 --> 26:00.000]  И тут посложу, у меня получится 2A
[26:00.000 --> 26:02.000]  от WN в степени Ж.
[26:02.000 --> 26:04.000]  Все, делим на 2,
[26:04.000 --> 26:06.000]  получаем A, ну и потом соответственно
[26:06.000 --> 26:08.000]  и B.
[26:08.000 --> 26:10.000]  То есть вот такой
[26:10.000 --> 26:12.000]  оказывается приятный лайфхак,
[26:12.000 --> 26:14.000]  который позволяет вам
[26:14.000 --> 26:16.000]  разделить,
[26:16.000 --> 26:18.000]  вот, позволяет вам разделить,
[26:18.000 --> 26:20.000]  короче.
[26:22.000 --> 26:24.000]  Шо?
[26:24.000 --> 26:26.000]  Были некоторые где-то источники,
[26:26.000 --> 26:28.000]  в смысле, что мы
[26:28.000 --> 26:30.000]  очень хорошо замяли вопросик
[26:30.000 --> 26:32.000]  с тем, что когда мы
[26:32.000 --> 26:34.000]  доделали приятный лайфхак, мы как бы забиваем
[26:34.000 --> 26:36.000]  на минимую часть, потому что она скорее всего
[26:36.000 --> 26:38.000]  немного замешалась
[26:38.000 --> 26:40.000]  и оставляем как
[26:40.000 --> 26:42.000]  действительно ее тоже округляем.
[26:42.000 --> 26:44.000]  А вот здесь как бы
[26:44.000 --> 26:46.000]  с точностью 2 раза больше
[26:46.000 --> 26:48.000]  стало. Нет, мы не совсем
[26:48.000 --> 26:50.000]  заминаем. Мы не замярием,
[26:50.000 --> 26:52.000]  мы сказали, что у нас есть
[26:52.000 --> 26:54.000]  такие данные, которые говорят, что если коэффициенты не
[26:54.000 --> 26:56.000]  превосходят 10 в 11 и 10 в 12,
[26:56.000 --> 26:58.000]  то это по точности работает нормально.
[26:58.000 --> 27:00.000]  Вот, то есть это просто
[27:00.000 --> 27:02.000]  такой практически факт.
[27:02.000 --> 27:04.000]  То есть на чуть больше, ну вот
[27:04.000 --> 27:06.000]  да, проблемы.
[27:06.000 --> 27:08.000]  Ну вот, ну и здесь на самом деле
[27:08.000 --> 27:10.000]  примерно тоже, то есть возможно где-то
[27:10.000 --> 27:12.000]  ну, то есть там
[27:12.000 --> 27:14.000]  под 10 в 11
[27:14.000 --> 27:16.000]  думаю, это нормально работать будет.
[27:16.000 --> 27:18.000]  Вот.
[27:20.000 --> 27:22.000]  Так что да, есть вот такой
[27:22.000 --> 27:24.000]  маленький приятный лайфхак.
[27:24.000 --> 27:26.000]  Лайфхак чек.
[27:26.000 --> 27:28.000]  Так, ну что, остались у нас еще
[27:30.000 --> 27:32.000]  остались, какие у нас еще мелочи
[27:32.000 --> 27:34.000]  остались?
[27:42.000 --> 27:44.000]  Ну да, ладно, мелочей видимо не осталось.
[27:46.000 --> 27:48.000]  А, хотя нет, оставь.
[27:48.000 --> 27:50.000]  А, нет, ну конечно.
[27:50.000 --> 27:52.000]  Значит, смотрите,
[27:52.000 --> 27:54.000]  что еще есть.
[27:54.000 --> 27:56.000]  Ну, на самом деле, конечно, в какой-то момент
[27:56.000 --> 27:58.000]  да, может быть, конечно, очень красиво было,
[27:58.000 --> 28:00.000]  конечно, на этом
[28:00.000 --> 28:02.000]  и закончить.
[28:02.000 --> 28:04.000]  Но все-таки не будем. Да, вот.
[28:04.000 --> 28:06.000]  Вот, да, вот. Большой у меня соблазн, конечно,
[28:06.000 --> 28:08.000]  оставить эту мелкую задачу на самый-самый
[28:08.000 --> 28:10.000]  конец, то есть
[28:10.000 --> 28:12.000]  конец четвертого севинара, потому что
[28:12.000 --> 28:14.000]  я думаю, сегодня мы с Фурье уже закончим.
[28:14.000 --> 28:16.000]  Вот.
[28:18.000 --> 28:20.000]  Так.
[28:20.000 --> 28:22.000]  Но мелкая задача будет такая.
[28:24.000 --> 28:26.000]  Нет, ладно, оставлю наконец.
[28:26.000 --> 28:28.000]  Нет, не могу.
[28:28.000 --> 28:30.000]  Ну, просто
[28:30.000 --> 28:32.000]  она объективная.
[28:32.000 --> 28:34.000]  Просто знаете, как-то по закону хорошего
[28:34.000 --> 28:36.000]  закольцованного произведения эта задача
[28:36.000 --> 28:38.000]  должна стоять в конце.
[28:38.000 --> 28:40.000]  А пока же мы, давайте
[28:40.000 --> 28:42.000]  повеселимся
[28:42.000 --> 28:44.000]  с более такой приятной задачей.
[28:46.000 --> 28:48.000]  Казалось бы, да, многочленов тут, казалось бы,
[28:48.000 --> 28:50.000]  не будет, а будут
[28:50.000 --> 28:52.000]  линейные рекурренты.
[28:54.000 --> 28:56.000]  А именно, давайте вот представим себе,
[28:56.000 --> 28:58.000]  что у нас есть рекуррента вот такого
[28:58.000 --> 29:00.000]  вида. A и плюс N
[29:00.000 --> 29:02.000]  равно.
[29:02.000 --> 29:04.000]  Значит, чему равно?
[29:04.000 --> 29:06.000]  Значит, C0 A и T
[29:06.000 --> 29:08.000]  плюс C1 A
[29:08.000 --> 29:10.000]  и плюс A1.
[29:10.000 --> 29:12.000]  Нет, лучше K, кстати, вот так.
[29:12.000 --> 29:14.000]  Плюс C2
[29:14.000 --> 29:16.000]  на A и плюс 2.
[29:16.000 --> 29:18.000]  Плюс и так далее.
[29:18.000 --> 29:20.000]  Плюс Ck-1
[29:20.000 --> 29:22.000]  на A и плюс K
[29:22.000 --> 29:24.000]  минус 1.
[29:24.000 --> 29:26.000]  Ну, где, понятно, I равно 0,
[29:26.000 --> 29:28.000]  1, 2 и так до бесконечности.
[29:28.000 --> 29:30.000]  Ну и, соответственно, понятно, что она
[29:30.000 --> 29:32.000]  инициализируется какими-то вот A0,
[29:32.000 --> 29:34.000]  A1, A2 и так далее.
[29:34.000 --> 29:36.000]  А там
[29:36.000 --> 29:38.000]  допустим, K-1.
[29:38.000 --> 29:40.000]  Ну, если вы самый первый
[29:40.000 --> 29:42.000]  коэффициент K знаете, то вот следующие
[29:42.000 --> 29:44.000]  определяются вот таким вот образом,
[29:44.000 --> 29:46.000]  где C это вот какие-то
[29:46.000 --> 29:48.000]  заданные, раз и навсегда, коэффициенты.
[29:56.000 --> 29:58.000]  Вот.
[30:00.000 --> 30:02.000]  Так вот, мистическая
[30:02.000 --> 30:04.000]  задачка.
[30:04.000 --> 30:06.000]  Найти
[30:06.000 --> 30:08.000]  А от М.
[30:14.000 --> 30:16.000]  Вот такое вот
[30:16.000 --> 30:18.000]  неожиданное БУ.
[30:24.000 --> 30:26.000]  Вот, да.
[30:26.000 --> 30:28.000]  Ну, естественно, тут, конечно,
[30:28.000 --> 30:30.000]  правильный вопрос, а какие ограничения?
[30:30.000 --> 30:32.000]  Потому что может быть
[30:32.000 --> 30:34.000]  просто за M на K его честно
[30:34.000 --> 30:36.000]  и вычислить.
[30:36.000 --> 30:38.000]  Но, естественно, мы потребуем от себя
[30:38.000 --> 30:40.000]  чуть побольше.
[30:40.000 --> 30:42.000]  Как минимум, мы потребуем, что
[30:42.000 --> 30:44.000]  N у нас может быть в 10, 18.
[30:48.000 --> 30:50.000]  Вот.
[30:52.000 --> 30:54.000]  Не-не-не, у нас
[30:54.000 --> 30:56.000]  все по какому-нибудь хорошему модулю.
[30:56.000 --> 30:58.000]  Ну, тут мы, как всегда, можем
[30:58.000 --> 31:00.000]  уговориться, что, во-первых, можно сказать, что у нас
[31:00.000 --> 31:02.000]  очень хороший модуль, вот тот самый
[31:02.000 --> 31:04.000]  фурьешный, да?
[31:04.000 --> 31:06.000]  Это с одной стороны.
[31:06.000 --> 31:08.000]  А с другой стороны, правда, заметим, что
[31:08.000 --> 31:10.000]  если у нас надо делать умножение
[31:10.000 --> 31:12.000]  по нефурьешному модулю,
[31:12.000 --> 31:14.000]  то, на самом деле, его, скорее всего,
[31:14.000 --> 31:16.000]  будет легко свести к умножению
[31:16.000 --> 31:18.000]  по двум-трём обычным.
[31:18.000 --> 31:20.000]  Вот такие фурьешные модуля.
[31:26.000 --> 31:28.000]  Нет, ну, смотрите.
[31:28.000 --> 31:30.000]  Нет, ну, смотрите.
[31:30.000 --> 31:32.000]  Нужно для того, чтобы сделать FFT
[31:32.000 --> 31:34.000]  по модулю, скажем, 10, 9, плюс 7.
[31:38.000 --> 31:40.000]  Но, по-хорошему, для этого просто надо взять
[31:40.000 --> 31:42.000]  один нарэксен, второй нарэксен, тупо,
[31:42.000 --> 31:44.000]  можно их тупо перемножить, а потом все коэффициенты
[31:44.000 --> 31:46.000]  взять по модулю миллиард 7, правда?
[31:48.000 --> 31:50.000]  Ну, почему не сработает?
[31:50.000 --> 31:52.000]  Нет, ну, конечно,
[31:52.000 --> 31:54.000]  по модулю того, что числа 10, 24
[31:54.000 --> 31:56.000]  у нас не хранятся,
[31:56.000 --> 31:58.000]  на самом деле, почему бы
[31:58.000 --> 32:00.000]  ему и не сработать?
[32:00.000 --> 32:02.000]  Вот.
[32:02.000 --> 32:04.000]  Значит, идея,
[32:04.000 --> 32:06.000]  на самом деле, следующая.
[32:06.000 --> 32:08.000]  Вот. Ну, да,
[32:08.000 --> 32:10.000]  то есть, конечно, да, 10, 24 это, конечно, может быть
[32:10.000 --> 32:12.000]  многовато, но тем не менее. Значит, идея такая.
[32:12.000 --> 32:14.000]  Значит,
[32:14.000 --> 32:16.000]  как сделать адекватный FFT?
[32:16.000 --> 32:18.000]  Ну, идея такая. То есть, пусть у нас есть какие-нибудь
[32:18.000 --> 32:20.000]  модули типа там P1,
[32:20.000 --> 32:22.000]  допустим, P2 и P3,
[32:22.000 --> 32:24.000]  все примерно
[32:24.000 --> 32:26.000]  10, 9, и они
[32:26.000 --> 32:28.000]  достаточно фурьершны.
[32:28.000 --> 32:30.000]  Ну, то есть, помните, вот это
[32:30.000 --> 32:32.000]  вот все там 1, плюс там
[32:32.000 --> 32:34.000]  что-то там на 2
[32:34.000 --> 32:36.000]  в адекватной степени, да?
[32:36.000 --> 32:38.000]  Помните? Ну, обсуждали.
[32:38.000 --> 32:40.000]  Ну, так вот.
[32:40.000 --> 32:42.000]  Но заметим
[32:42.000 --> 32:44.000]  следующее, что мы знаем,
[32:44.000 --> 32:46.000]  что если мы произведем перемножение
[32:46.000 --> 32:48.000]  этих многочленов вот по этим
[32:48.000 --> 32:50.000]  трем модулям,
[32:50.000 --> 32:52.000]  то, в принципе, мы по китайской теории
[32:52.000 --> 32:54.000]  об остатках можем восстановить и сами результаты,
[32:54.000 --> 32:56.000]  потому что, раз тут все числа изначально
[32:56.000 --> 32:58.000]  не превосходили 10, 9,
[32:58.000 --> 33:00.000]  и тут, и допустим,
[33:00.000 --> 33:02.000]  там у них тут n не превосходило,
[33:02.000 --> 33:04.000]  ну, там, как всегда, 10,
[33:04.000 --> 33:06.000]  допустим, 6,
[33:06.000 --> 33:08.000]  то тогда мы замечаем, что
[33:08.000 --> 33:10.000]  если тупо перемножить эти многочлены,
[33:10.000 --> 33:12.000]  то тогда у нас коэффициенты
[33:12.000 --> 33:14.000]  не будут превосходить.
[33:14.000 --> 33:16.000]  Чего они у нас не будут происходить? Давайте посчитаем.
[33:18.000 --> 33:20.000]  То есть, там каждое произведение
[33:20.000 --> 33:22.000]  это 10, 18.
[33:22.000 --> 33:24.000]  Нет, почему в 15?
[33:24.000 --> 33:26.000]  Смотрите, тут 10, 9 на 10, 9
[33:26.000 --> 33:28.000]  каждое произведение
[33:28.000 --> 33:30.000]  и в каждом коэффициенте
[33:30.000 --> 33:32.000]  суммируется 10, 6.
[33:32.000 --> 33:34.000]  10, 24.
[33:34.000 --> 33:36.000]  Не совсем я отбалды это число взял.
[33:36.000 --> 33:38.000]  Так.
[33:38.000 --> 33:40.000]  Хорошо,
[33:40.000 --> 33:42.000]  говорим мы.
[33:42.000 --> 33:44.000]  Но тогда, смотрите, если вы знаете,
[33:44.000 --> 33:46.000]  но я утверждаю, что если у вас число не более
[33:46.000 --> 33:48.000]  чем 10, 24, и вы знаете
[33:48.000 --> 33:50.000]  его остаток отделения на p1, p2
[33:50.000 --> 33:52.000]  и p3, 10, 9,
[33:52.000 --> 33:54.000]  то тогда я утверждаю, что по этим данным вы
[33:54.000 --> 33:56.000]  вот это число можете восстановить однозначно.
[34:02.000 --> 34:04.000]  Понятно это все.
[34:04.000 --> 34:06.000]  Китайская теория об остатках, там дальше уже
[34:06.000 --> 34:08.000]  либо диафантовое уравнение,
[34:08.000 --> 34:10.000]  либо еще какая-нибудь красивая математика,
[34:10.000 --> 34:12.000]  потому что были какие-то красивые
[34:12.000 --> 34:14.000]  эти штуки, что там x в степени p2
[34:14.000 --> 34:16.000]  на степени p1-1.
[34:16.000 --> 34:18.000]  Там что-то такое,
[34:18.000 --> 34:20.000]  там плюс
[34:20.000 --> 34:22.000]  x2,
[34:22.000 --> 34:24.000]  какие-то такие формулы
[34:24.000 --> 34:26.000]  возникали.
[34:30.000 --> 34:32.000]  Соответственно,
[34:32.000 --> 34:34.000]  восстановить можно.
[34:34.000 --> 34:36.000]  Так, надо подробнее.
[34:40.000 --> 34:42.000]  Ну вот, что-то подобное.
[34:42.000 --> 34:44.000]  Ну там, ладно, то есть там про малую
[34:44.000 --> 34:46.000]  фирму вам, наверное, нет смысла рассказывать.
[34:46.000 --> 34:48.000]  Ну вот, собственно, да, у вас есть
[34:48.000 --> 34:50.000]  УКТЧ, господи.
[34:50.000 --> 34:52.000]  Так что думаете вы.
[35:00.000 --> 35:02.000]  Ну понятно.
[35:02.000 --> 35:04.000]  Ну ладно.
[35:10.000 --> 35:12.000]  Ну да, логично.
[35:12.000 --> 35:14.000]  Ну вот.
[35:14.000 --> 35:16.000]  Так что, в принципе, на самом деле,
[35:16.000 --> 35:18.000]  если вы делаете умножение даже по обычному модулю,
[35:18.000 --> 35:20.000]  на самом деле, можно подобными лайфхаками
[35:20.000 --> 35:22.000]  попытаться это сделать, типа,
[35:22.000 --> 35:24.000]  и свести к умножению по обычному. Правда, их
[35:24.000 --> 35:26.000]  формально говоря, их несколько, но
[35:26.000 --> 35:28.000]  как бы, если...
[35:28.000 --> 35:30.000]  Но, пока ими, это n-логи.
[35:34.000 --> 35:36.000]  Так вот. Ну, короче говоря, ладно,
[35:36.000 --> 35:38.000]  мы тут не будем замарить, я говорю, что вот у нас
[35:38.000 --> 35:40.000]  m1018, да, естественно, вся эта рекуррента
[35:40.000 --> 35:42.000]  этого читается по какому-нибудь модулю,
[35:42.000 --> 35:44.000]  может быть, желательно, фугешному.
[35:44.000 --> 35:46.000]  Даже.
[35:46.000 --> 35:48.000]  То есть, поэтому, да, поэтому у нас там ответ
[35:48.000 --> 35:50.000]  длинным не будет.
[35:50.000 --> 35:52.000]  Ну вот, внимание, вопрос.
[35:52.000 --> 35:54.000]  Как же нам его найти?
[36:10.000 --> 36:12.000]  Ну, тут, наверное, надо
[36:12.000 --> 36:14.000]  расти постепенно, поэтому давайте
[36:14.000 --> 36:16.000]  так, разминочка, k равно 10.
[36:28.000 --> 36:30.000]  А чем тебе k равно 2 легче,
[36:30.000 --> 36:32.000]  чем k равно 10?
[36:32.000 --> 36:34.000]  А, да?
[36:34.000 --> 36:36.000]  Да ладно.
[36:36.000 --> 36:38.000]  Я не знаю, по-моему, если там начнешь
[36:38.000 --> 36:40.000]  решать квадратный уравнение, рассматривать все
[36:40.000 --> 36:42.000]  случаи, тебе будет больно.
[36:42.000 --> 36:44.000]  А уравнение 10-й
[36:44.000 --> 36:46.000]  к степени ты не начнешь решать, в принципе.
[36:46.000 --> 36:48.000]  А уравнение 10-й к степени
[36:48.000 --> 36:50.000]  ты не начнешь решать, в принципе.
[37:16.000 --> 37:18.000]  Так.
[37:24.000 --> 37:26.000]  Ну, какие варианты?
[37:26.000 --> 37:28.000]  k равно 10.
[37:34.000 --> 37:36.000]  Какого?
[37:36.000 --> 37:38.000]  Элементарно, смотрите.
[37:38.000 --> 37:40.000]  То есть...
[37:44.000 --> 37:46.000]  Это да.
[37:46.000 --> 37:48.000]  Правда, она не элементарно единичная,
[37:48.000 --> 37:50.000]  но...
[37:50.000 --> 37:52.000]  А, да?
[37:52.000 --> 37:54.000]  А.
[37:54.000 --> 37:56.000]  Не, ну это уже интересно.
[37:58.000 --> 38:00.000]  Хотя, как известно,
[38:00.000 --> 38:02.000]  смотрите, доказательства. То есть терема
[38:02.000 --> 38:04.000]  в матемае
[38:04.000 --> 38:06.000]  не интересных натуральных чисел нету.
[38:06.000 --> 38:08.000]  Доказательства.
[38:08.000 --> 38:10.000]  Так, предположим, что это не так.
[38:10.000 --> 38:12.000]  Тогда, среди неинтересных натуральных чисел
[38:12.000 --> 38:14.000]  найдется минимальное.
[38:14.000 --> 38:16.000]  Посмотрим на него. Интересно.
[38:30.000 --> 38:32.000]  Да.
[38:32.000 --> 38:34.000]  Потому что, да, в натуральном, да, в любом подмножении
[38:34.000 --> 38:36.000]  натуральных чисел найдется минимальное.
[38:38.000 --> 38:40.000]  В любом бесконечном.
[38:42.000 --> 38:44.000]  Просто возьмем первое
[38:44.000 --> 38:46.000]  попавшее число и заметим, что либо оно минимум,
[38:46.000 --> 38:48.000]  либо минимум кто-то, кто меньше его.
[38:48.000 --> 38:50.000]  А кто-то, а кого-то...
[39:00.000 --> 39:02.000]  Да, это важно.
[39:02.000 --> 39:04.000]  Для целых это да.
[39:04.000 --> 39:06.000]  Для целых числа могут быть неинтересными, да.
[39:06.000 --> 39:08.000]  А натуральные нет.
[39:08.000 --> 39:10.000]  Так вот. На самом деле
[39:10.000 --> 39:12.000]  можно попытаться придумать матрицу,
[39:14.000 --> 39:16.000]  чтобы было верно вот такое вот
[39:16.000 --> 39:18.000]  равенство.
[39:18.000 --> 39:20.000]  Ага.
[39:20.000 --> 39:22.000]  Так, совершенно верно.
[39:22.000 --> 39:24.000]  Да, давайте так и напишем, да.
[39:24.000 --> 39:26.000]  Тут С, как получается,
[39:26.000 --> 39:28.000]  К-1,
[39:28.000 --> 39:30.000]  К-20,
[39:30.000 --> 39:32.000]  К-20,
[39:32.000 --> 39:34.000]  К-20,
[39:34.000 --> 39:36.000]  К-20,
[39:36.000 --> 39:38.000]  К-20,
[39:38.000 --> 39:40.000]  К-20,
[39:40.000 --> 39:42.000]  К-20,
[39:42.000 --> 39:44.000]  К-20,
[39:44.000 --> 39:46.000]  К-20,
[39:46.000 --> 39:48.000]  К-20,
[39:48.000 --> 39:50.000]  К-20,
[39:50.000 --> 39:52.000]  К-20,
[39:54.000 --> 39:56.000]  К-20,
[39:56.000 --> 40:10.000]  К-20,
[40:10.000 --> 40:18.000]  Там вот ноль, там ноль, ноль, в общем, что-то такое, вот, ну и вот тут везде ноль, да?
[40:18.000 --> 40:25.000]  Вот, то есть чем приятна эта матрица? Она приятна тем, что она не зависит от И.
[40:25.000 --> 40:34.000]  Только от С-шек зависит. И тогда мы замечаем, что если мы хотим тут столбезы, чтобы вот тут было АН-ное,
[40:34.000 --> 40:41.000]  да, то есть я могу, например, так сказать, что А и там Н плюс К минус 1, там и так далее АН-ное.
[40:41.000 --> 40:52.000]  Это равно теперь М в степени Н на вот эту вот А0, А1, там и так далее, АК минус 1. Ура!
[40:52.000 --> 40:58.000]  Вот. И теперь, то есть все, что вам остается, это возвести эту матрицу с помощью быстрого возведения в степень,
[40:58.000 --> 41:04.000]  там, в Н-ую степень и домножить на этот вектор. Все. Можете возводить даже если там не в Н-ую степень,
[41:04.000 --> 41:10.000]  а в Н минус К какую-нибудь там, но это уже мелкие детали, принципиально ни на что не влияющие.
[41:10.000 --> 41:19.000]  То есть более того, такое решение работает даже не столько для карабно 10, сколько даже там карабно 100 вполне подойдет.
[41:19.000 --> 41:25.000]  Вот. То есть ну формально, конечно, да, может быть, если вы умеете уменьшать матрицу там этими там
[41:25.000 --> 41:38.000]  Копперсмитами, Виноградами за Н в степени 2.2354, но этот, который улучшенный способ за там предыдущего мета за Н в степени 2.23881.
[41:38.000 --> 41:50.000]  Ну да. Вот. Не значит, то может быть и быстрее, хотя сомнительно они так сами сомневаются, что это прям на практике прям так круто работает.
[41:50.000 --> 42:02.000]  Вот. Не важно. Но, конечно, да, это такое базовое соображение, то есть, конечно, да, в некоторых динамических программированиях это нам тоже пригождается.
[42:02.000 --> 42:13.000]  Ну что делать? Ну вот. Но теперь, значит, попробуем все-таки повысить планку.
[42:13.000 --> 42:23.000]  Давайте скажем, что все-таки К у нас приблизительно 2000.
[42:23.000 --> 42:28.000]  Да, сразу скажу на самом деле. Что?
[42:28.000 --> 42:37.000]  Ну да. Но нам хочется быстрее. За сутки. За сутки, да.
[42:37.000 --> 42:56.000]  Ну почему? Как квадрат логарифом нормально?
[42:56.000 --> 43:04.000]  Нет. На нее-то можно, но если я возместив квадрат, она уже будет не красивой.
[43:04.000 --> 43:07.000]  Это правда. Это правда, да.
[43:07.000 --> 43:18.000]  Ну окей. Но на самом деле тут, честно скажу, лучше думайте сразу в другую сторону. У нас все-таки лекция про фуриарий, про матрицу.
[43:18.000 --> 43:28.000]  Поэтому есть подозрение, что вам должно помочь FFT.
[43:28.000 --> 43:33.000]  Да? Закем?
[43:33.000 --> 43:50.000]  Короче, план такой. Решение будет выглядеть либо как возьмем FFT от A в FFT от C и перемножим их типа A0 на вот то, что оказалось в FFT от A,
[43:50.000 --> 43:57.000]  на то, что оказалось в FFT от C на 10 и 18, ну на FFT или не N.
[43:57.000 --> 44:07.000]  Короче, что-то похожее работать будет. Возьмем быстрее образование FFT от массива A, от массива C.
[44:07.000 --> 44:13.000]  Дальше, по сути, давайте сначала попробуем взять просто эксклярное произведение.
[44:13.000 --> 44:15.000]  Давайте.
[44:15.000 --> 44:29.000]  Получим то, что нужно. А теперь это не эксклярное произведение, а то, что в нулевой чеке, на то, что в нулевой чеке другого, в степени N.
[44:29.000 --> 44:37.000]  Так, нулевой... чего?
[44:37.000 --> 44:45.000]  У нас есть два массива, которые получились после преображения. В нормальном случае мы бы просто взяли их эксклярное произведение.
[44:45.000 --> 44:49.000]  Ну, взяли бы. А мы что сделаем?
[44:49.000 --> 45:02.000]  А теперь мы берем то, что в нулевой ящике, по ящикам умножаем то, что в FFT от A, на то, что FFT от C в степени 10 и 18.
[45:02.000 --> 45:07.000]  И что? Чем это помогает?
[45:07.000 --> 45:11.000]  Нет, не должно, иначе бы камеры упадут.
[45:11.000 --> 45:18.000]  Ну, я тут тоже. Может, я, конечно, занизил ограничение, чтобы усложнить задачу, как это часто водится.
[45:32.000 --> 45:36.000]  Так, нулевой ящик.
[45:36.000 --> 45:40.000]  Нулевой ящик.
[45:40.000 --> 45:43.000]  Нулевой ящик.
[45:43.000 --> 45:46.000]  Нулевой ящик.
[45:46.000 --> 45:49.000]  Нулевой ящик.
[45:49.000 --> 45:52.000]  Нулевой ящик.
[45:52.000 --> 45:55.000]  Нулевой ящик.
[45:55.000 --> 45:58.000]  Нулевой ящик.
[45:58.000 --> 46:01.000]  Нулевой ящик.
[46:01.000 --> 46:04.000]  Нулевой ящик.
[46:04.000 --> 46:07.000]  Нулевой ящик.
[46:07.000 --> 46:10.000]  Нулевой ящик.
[46:10.000 --> 46:13.000]  Нулевой ящик.
[46:13.000 --> 46:16.000]  Нулевой ящик.
[46:16.000 --> 46:19.000]  Нулевой ящик.
[46:19.000 --> 46:22.000]  Нулевой ящик.
[46:22.000 --> 46:25.000]  Нулевой ящик.
[46:25.000 --> 46:28.000]  Нулевой ящик.
[46:28.000 --> 46:31.000]  Нулевой ящик.
[46:31.000 --> 46:34.000]  Нулевой ящик.
[46:34.000 --> 46:37.000]  Нулевой ящик.
[46:37.000 --> 46:40.000]  Нулевой ящик.
[46:40.000 --> 46:43.000]  Нулевой ящик.
[46:43.000 --> 46:46.000]  Нулевой ящик.
[46:46.000 --> 46:49.000]  Нулевой ящик.
[46:49.000 --> 46:52.000]  Нулевой ящик.
[46:52.000 --> 46:55.000]  Нулевой ящик.
[46:55.000 --> 46:58.000]  Нулевой ящик.
[46:58.000 --> 47:01.000]  Нулевой ящик.
[47:01.000 --> 47:04.000]  Нулевой ящик.
[47:04.000 --> 47:07.000]  Нулевой ящик.
[47:07.000 --> 47:10.000]  Нулевой ящик.
[47:10.000 --> 47:13.000]  Не понятно.
[47:13.000 --> 47:16.000]  Да ладно.
[47:16.000 --> 47:19.000]  Ну хотя, смотрите.
[47:19.000 --> 47:22.000]  Чего-то вы сыты.
[47:22.000 --> 47:25.000]  Чего-то много.
[47:25.000 --> 47:28.000]  Не понятно.
[47:28.000 --> 47:31.000]  Так, это не понятно.
[47:31.000 --> 47:34.000]  Я же не знаю, что это такое.
[47:34.000 --> 47:37.000]  Это не понятно.
[47:37.000 --> 47:43.000]  Потому что это не похоже на классическими атомными алгоритмами.
[47:43.000 --> 47:45.000]  Ну почему?
[47:45.000 --> 47:47.000]  А как насчет...
[47:47.000 --> 47:53.000]  Ну не знаю, потому что тут могут возникнуть ассоциации с таким комбинаторным алгоритмом как LCA.
[47:53.000 --> 47:55.000]  Да, у меня не может.
[47:55.000 --> 47:57.000]  Нет?
[47:57.000 --> 47:59.000]  А двоичными подъемами?
[47:59.000 --> 48:01.000]  У меня тоже не может.
[48:01.000 --> 48:03.000]  Нет, ну просто вот, идея на самом деле такая.
[48:03.000 --> 48:05.000]  Идеи не одного дерева.
[48:05.000 --> 48:07.000]  Да, то с другой стороны, смотрите.
[48:07.000 --> 48:09.000]  Ну вот.
[48:09.000 --> 48:11.000]  Ну или какая-то такая ситуация.
[48:11.000 --> 48:13.000]  Чтобы возвести их число в степень 2n, что нужно?
[48:13.000 --> 48:15.000]  Возвести его в степень а2 и в квадрат.
[48:15.000 --> 48:17.000]  Ну, например, да.
[48:17.000 --> 48:19.000]  Вот.
[48:19.000 --> 48:21.000]  Ну и здесь, на самом деле, можно попытаться заметить,
[48:21.000 --> 48:27.000]  что если вы там хотите посчитать какое-нибудь число а2н, да?
[48:27.000 --> 48:29.000]  Вот, чтобы...
[48:29.000 --> 48:31.000]  Если вы умеете считать число аn,
[48:31.000 --> 48:33.000]  то, наверное, вы умеете считать число 2n.
[48:33.000 --> 48:35.000]  Не умеете.
[48:35.000 --> 48:37.000]  Не умеете?
[48:37.000 --> 48:39.000]  Вот.
[48:39.000 --> 48:41.000]  Но, смотрите.
[48:41.000 --> 48:43.000]  Начнем тогда вот с чего, смотрите.
[48:43.000 --> 48:45.000]  Вот вы умеете считать, допустим,
[48:45.000 --> 48:47.000]  и плюс катое число
[48:47.000 --> 48:49.000]  через такие коэффициенты, правда?
[48:49.000 --> 48:51.000]  Но я утверждаю, что на самом деле
[48:51.000 --> 48:53.000]  существует...
[48:53.000 --> 48:55.000]  Что можно записать еще так,
[48:55.000 --> 48:57.000]  что а и плюс ка плюс первое
[48:57.000 --> 48:59.000]  будет тоже равно,
[48:59.000 --> 49:01.000]  вот так я напишу, c0,1.
[49:01.000 --> 49:03.000]  Значит, а и т
[49:03.000 --> 49:05.000]  плюс c1,1,
[49:05.000 --> 49:07.000]  а и плюс первое.
[49:11.000 --> 49:13.000]  А сейчас скажу.
[49:13.000 --> 49:15.000]  Сейчас допишу и сейчас все скажу.
[49:15.000 --> 49:17.000]  Нет, если что,
[49:17.000 --> 49:19.000]  1 это не степень, это индекс.
[49:19.000 --> 49:21.000]  Как вы уже догадались.
[49:23.000 --> 49:25.000]  Просто я утверждаю,
[49:25.000 --> 49:27.000]  что можно подогнать вот такие коэффициенты,
[49:27.000 --> 49:29.000]  чтобы
[49:29.000 --> 49:31.000]  я через вот
[49:31.000 --> 49:33.000]  ка, идущих подряд ашек,
[49:33.000 --> 49:35.000]  вычислял не следующую ашку,
[49:35.000 --> 49:37.000]  а как бы через одну.
[49:39.000 --> 49:41.000]  Вот. Собственно, даже понятно,
[49:41.000 --> 49:43.000]  откуда я ее возьму, да?
[49:43.000 --> 49:45.000]  Ну, понятно, что я это запишу
[49:45.000 --> 49:47.000]  через и плюс один и плюс ка, потом и плюс ка подставлю, да?
[49:47.000 --> 49:49.000]  Но заметим, что я так могу, в принципе,
[49:49.000 --> 49:51.000]  и плюс ка плюс два
[49:51.000 --> 49:53.000]  подставить, правда?
[49:53.000 --> 49:55.000]  Да, но
[49:55.000 --> 49:57.000]  пока это просто
[49:57.000 --> 49:59.000]  математический факт.
[49:59.000 --> 50:01.000]  Я могу ввести такое понятие,
[50:01.000 --> 50:03.000]  как
[50:03.000 --> 50:05.000]  вот, то есть
[50:05.000 --> 50:07.000]  такие коэффициенты, как c0,
[50:07.000 --> 50:09.000]  ну, допустим, ладно, давайте
[50:09.000 --> 50:11.000]  букву m
[50:11.000 --> 50:13.000]  возьмем.
[50:13.000 --> 50:15.000]  Вот могу взять вот такую штуку.
[50:15.000 --> 50:17.000]  С, допустим,
[50:17.000 --> 50:19.000]  k-1m.
[50:19.000 --> 50:21.000]  Вот. То есть, существуют
[50:21.000 --> 50:23.000]  такие штуки, что
[50:23.000 --> 50:25.000]  на самом деле для любого и
[50:25.000 --> 50:27.000]  будет верно, что а
[50:27.000 --> 50:29.000]  значит и плюс ка плюс
[50:29.000 --> 50:31.000]  м
[50:31.000 --> 50:33.000]  будет равна
[50:33.000 --> 50:35.000]  c0 в степени m.
[50:35.000 --> 50:37.000]  Значит, как там
[50:37.000 --> 50:39.000]  было? Значит, аит
[50:39.000 --> 50:41.000]  плюс c1mt
[50:41.000 --> 50:43.000]  значит аи плюс
[50:43.000 --> 50:45.000]  первая, плюс
[50:45.000 --> 50:47.000]  c2mt значит
[50:47.000 --> 50:49.000]  аи плюс второе, плюс
[50:49.000 --> 50:51.000]  и так далее, плюс
[50:51.000 --> 50:53.000]  ck-1n
[50:53.000 --> 50:55.000]  значит а и плюс
[50:55.000 --> 50:57.000]  k-1.
[50:57.000 --> 50:59.000]  Вот.
[50:59.000 --> 51:01.000]  То есть, пока у нас получился такой
[51:01.000 --> 51:03.000]  математический факт, что просто такие коэффициенты
[51:03.000 --> 51:05.000]  вот существуют.
[51:05.000 --> 51:07.000]  Вот, понимаете, да?
[51:07.000 --> 51:09.000]  Вот.
[51:11.000 --> 51:13.000]  Так вот, но фишка, ну вот,
[51:13.000 --> 51:15.000]  и в принципе я неплохо был бы их найти,
[51:15.000 --> 51:17.000]  потому что если мы вот, допустим,
[51:17.000 --> 51:19.000]  н-ные такие коэффициенты найдем
[51:19.000 --> 51:21.000]  для какого-то n,
[51:21.000 --> 51:23.000]  ну там, научимся
[51:23.000 --> 51:25.000]  искать, то соответственно там соответствующие
[51:25.000 --> 51:27.000]  н-ные числа мы тоже найдем, правда?
[51:27.000 --> 51:29.000]  Вот.
[51:29.000 --> 51:31.000]  Но для этого мы вот о чем
[51:31.000 --> 51:33.000]  подумаем. Так вот.
[51:33.000 --> 51:35.000]  А.
[51:35.000 --> 51:37.000]  А почему не для каждой
[51:37.000 --> 51:39.000]  и свои cm?
[51:45.000 --> 51:47.000]  Ну вот так вот. Ну давайте, да,
[51:47.000 --> 51:49.000]  давайте аккуратно распишем, значит.
[51:49.000 --> 51:51.000]  Откуда они вообще берутся?
[51:51.000 --> 51:53.000]  Значит, как вообще получить
[51:53.000 --> 51:55.000]  там, ну как, ну понятно,
[51:55.000 --> 51:57.000]  как их вообще получить?
[51:57.000 --> 51:59.000]  Как вообще вот c1 коэффициенты получить?
[51:59.000 --> 52:01.000]  Ну получается они очень просто.
[52:01.000 --> 52:03.000]  Дело в том, что вот аи плюс k плюс 1
[52:03.000 --> 52:05.000]  равно, ну если вот прям в тупую
[52:05.000 --> 52:07.000]  изначально расписывать,
[52:07.000 --> 52:09.000]  вот, плюс 1, плюс
[52:09.000 --> 52:11.000]  c1, аи плюс 2, плюс
[52:11.000 --> 52:13.000]  c2, аи плюс 3,
[52:13.000 --> 52:15.000]  плюс и так далее, плюс
[52:15.000 --> 52:17.000]  c, k, минус 1, а
[52:17.000 --> 52:19.000]  и плюс k
[52:19.000 --> 52:21.000]  минус 1.
[52:21.000 --> 52:23.000]  Фу, уро, и плюс k. Разве?
[52:25.000 --> 52:27.000]  Ну теперь заметим, вспомним, что у нас
[52:27.000 --> 52:29.000]  и плюс k чему-то равно, правда?
[52:29.000 --> 52:31.000]  То есть это можно написать так, что c,
[52:31.000 --> 52:33.000]  это я пока тупо переписываю,
[52:33.000 --> 52:35.000]  плюс c1, значит,
[52:35.000 --> 52:37.000]  аи плюс 2, плюс
[52:37.000 --> 52:39.000]  и так далее, плюс c,
[52:39.000 --> 52:41.000]  значит, k, минус 2,
[52:41.000 --> 52:43.000]  аи плюс k, минус 1,
[52:43.000 --> 52:45.000]  плюс
[52:45.000 --> 52:47.000]  c, k, минус
[52:47.000 --> 52:49.000]  1 на, а вот здесь
[52:49.000 --> 52:51.000]  мы и плюс k вспоминаем, что это равно c0,
[52:51.000 --> 52:53.000]  значит, аи плюс
[52:53.000 --> 52:55.000]  c1, аи плюс 1,
[52:55.000 --> 52:57.000]  плюс и так далее,
[52:57.000 --> 52:59.000]  плюс c, k
[52:59.000 --> 53:01.000]  минус 1 на, а
[53:01.000 --> 53:03.000]  и плюс k, минус 1,
[53:03.000 --> 53:05.000]  ура.
[53:05.000 --> 53:07.000]  Теперь я могу это тупо
[53:07.000 --> 53:09.000]  перегруппировать
[53:09.000 --> 53:11.000]  и у меня получится примерно
[53:11.000 --> 53:13.000]  следующее, значит,
[53:13.000 --> 53:15.000]  c, k, минус 1, c0,
[53:15.000 --> 53:17.000]  значит, аи т, плюс
[53:17.000 --> 53:19.000]  там, c0, плюс
[53:19.000 --> 53:21.000]  c, k, минус 1,
[53:21.000 --> 53:23.000]  c1,
[53:23.000 --> 53:25.000]  аи плюс
[53:25.000 --> 53:27.000]  1, да, плюс там
[53:27.000 --> 53:29.000]  значит, c1, плюс
[53:29.000 --> 53:31.000]  c, k, минус 1
[53:31.000 --> 53:33.000]  на,
[53:33.000 --> 53:35.000]  c2, а, и плюс
[53:35.000 --> 53:37.000]  2, плюс и так далее.
[53:37.000 --> 53:39.000]  Вот.
[53:39.000 --> 53:41.000]  То есть, собственно, именно эти коэффициенты
[53:41.000 --> 53:43.000]  я теперь могу просто объявить как
[53:43.000 --> 53:45.000]  c0, 1, c0, 2 и так далее.
[53:45.000 --> 53:47.000]  Вот в чем идея.
[53:49.000 --> 53:51.000]  То есть, более того, заметим, что
[53:51.000 --> 53:53.000]  как бы да, я сделал это на один шаг
[53:53.000 --> 53:55.000]  вперед, но если бы у меня тут было и плюс
[53:55.000 --> 53:57.000]  2, плюс m, я мог бы просто делать
[53:57.000 --> 53:59.000]  ту же самую процедуру, только
[53:59.000 --> 54:01.000]  много раз.
[54:01.000 --> 54:03.000]  М раз.
[54:03.000 --> 54:05.000]  Но, конечно, хотелось бы
[54:05.000 --> 54:07.000]  эти коэффициенты выкапывать
[54:07.000 --> 54:09.000]  чуть-чуть побыстрее, очень сильно.
[54:11.000 --> 54:13.000]  Как же мы это будем делать?
[54:15.000 --> 54:17.000]  Ну, идея будет
[54:17.000 --> 54:19.000]  у нас заключаться
[54:19.000 --> 54:21.000]  в следующем.
[54:21.000 --> 54:23.000]  Смотрите.
[54:23.000 --> 54:25.000]  Давайте попробуем выкопать,
[54:25.000 --> 54:27.000]  то есть, мы научились вот этим,
[54:27.000 --> 54:29.000]  вот подобной махинации
[54:29.000 --> 54:31.000]  аналогичной мы можем
[54:31.000 --> 54:33.000]  по коэффициентам порядка m
[54:33.000 --> 54:35.000]  получать коэффициенты порядка
[54:35.000 --> 54:37.000]  m плюс 1.
[54:37.000 --> 54:39.000]  Срасно, да? Пока все просто.
[54:41.000 --> 54:43.000]  А теперь идея такая.
[54:45.000 --> 54:47.000]  А давайте попробуем
[54:47.000 --> 54:49.000]  из m
[54:49.000 --> 54:51.000]  получить
[54:51.000 --> 54:53.000]  2m.
[54:57.000 --> 54:59.000]  О, пустая доска, классно.
[54:59.000 --> 55:01.000]  Вот.
[55:01.000 --> 55:03.000]  Как же мы это сделаем?
[55:05.000 --> 55:07.000]  Ну, давайте просто
[55:07.000 --> 55:09.000]  самым-самым-самым
[55:09.000 --> 55:11.000]  тупым образом это напишем.
[55:11.000 --> 55:13.000]  Значит, a и плюс k
[55:13.000 --> 55:15.000]  плюс 2m.
[55:15.000 --> 55:17.000]  Это что такое?
[55:17.000 --> 55:19.000]  Ну, мы знаем, запишем
[55:19.000 --> 55:21.000]  через m, вот пусть мы знаем
[55:21.000 --> 55:23.000]  м т коэффициенты, тогда мы можем
[55:23.000 --> 55:25.000]  так и написать, что это равно,
[55:25.000 --> 55:27.000]  к чему это равно.
[55:27.000 --> 55:29.000]  Вот, соответственно, это равно
[55:29.000 --> 55:31.000]  c0mt на a
[55:31.000 --> 55:33.000]  и плюс k плюс mt
[55:35.000 --> 55:37.000]  плюс c1m
[55:37.000 --> 55:39.000]  a и плюс k
[55:39.000 --> 55:41.000]  плюс m
[55:41.000 --> 55:43.000]  плюс 1.
[55:43.000 --> 55:45.000]  Там, плюс и так далее,
[55:45.000 --> 55:47.000]  плюс cmk-1.
[55:49.000 --> 55:51.000]  Значит, a...
[55:51.000 --> 55:53.000]  Так, стоп.
[55:59.000 --> 56:01.000]  Нет, не так.
[56:01.000 --> 56:03.000]  Вот здесь
[56:03.000 --> 56:05.000]  колени.
[56:05.000 --> 56:07.000]  Да, вот так.
[56:07.000 --> 56:09.000]  Вот.
[56:09.000 --> 56:11.000]  Вот теперь хорошо.
[56:11.000 --> 56:13.000]  Вот теперь хорошо, вот теперь
[56:13.000 --> 56:15.000]  получается.
[56:15.000 --> 56:17.000]  k и плюс m
[56:17.000 --> 56:19.000]  и плюс m плюс 1.
[56:19.000 --> 56:21.000]  Тут и плюс m плюс 2.
[56:21.000 --> 56:23.000]  Ну, тут как раз и плюс
[56:23.000 --> 56:25.000]  и плюс k минус эти.
[56:25.000 --> 56:27.000]  То есть, видите, мы одну m-ку как бы
[56:27.000 --> 56:29.000]  убрали.
[56:29.000 --> 56:31.000]  А теперь заметим, что каждую
[56:31.000 --> 56:33.000]  из наших мы тоже можем расписать
[56:33.000 --> 56:35.000]  через те же самые коэффициенты, правда?
[56:37.000 --> 56:39.000]  Видите, да?
[56:39.000 --> 56:41.000]  Что получится?
[56:41.000 --> 56:43.000]  Получится. Значит, давайте смотреть
[56:43.000 --> 56:45.000]  внимательно. c0m на
[56:45.000 --> 56:47.000]  c0m
[56:47.000 --> 56:49.000]  значит a и t.
[56:49.000 --> 56:51.000]  Видите, тут не просто
[56:51.000 --> 56:53.000]  a и t, тут a и плюс mt, да?
[56:53.000 --> 56:55.000]  Тут вот плюс...
[56:55.000 --> 56:57.000]  Вот. Значит,
[56:57.000 --> 56:59.000]  a и t плюс c1m a
[56:59.000 --> 57:01.000]  и плюс 1.
[57:01.000 --> 57:03.000]  Плюс c,
[57:03.000 --> 57:05.000]  значит, это 2m a
[57:05.000 --> 57:07.000]  и плюс 2.
[57:07.000 --> 57:09.000]  Плюс и так далее.
[57:09.000 --> 57:11.000]  Плюс c k
[57:11.000 --> 57:13.000]  минус 1m.
[57:13.000 --> 57:15.000]  Значит, a и плюс k
[57:15.000 --> 57:17.000]  минус 1.
[57:19.000 --> 57:21.000]  Палюс.
[57:23.000 --> 57:25.000]  Значит, c1m
[57:25.000 --> 57:27.000]  на
[57:27.000 --> 57:29.000]  c0m
[57:29.000 --> 57:31.000]  a и плюс 1
[57:31.000 --> 57:33.000]  плюс c1m
[57:33.000 --> 57:35.000]  a и плюс 2
[57:35.000 --> 57:37.000]  плюс c2m
[57:37.000 --> 57:39.000]  a и плюс 3
[57:39.000 --> 57:41.000]  плюс и так далее.
[57:41.000 --> 57:43.000]  Плюс c k
[57:43.000 --> 57:45.000]  минус 1m
[57:45.000 --> 57:47.000]  на a и плюс k.
[57:49.000 --> 57:51.000]  Видите, да?
[57:51.000 --> 57:53.000]  Вот.
[57:53.000 --> 57:55.000]  Плюс.
[57:55.000 --> 57:57.000]  Ну, давайте все-таки так.
[57:57.000 --> 57:59.000]  Для чуть большей красоты
[57:59.000 --> 58:01.000]  я тут на один лишний напишу.
[58:03.000 --> 58:05.000]  Значит, c0m a и плюс 2
[58:05.000 --> 58:07.000]  плюс c1m
[58:07.000 --> 58:09.000]  a и плюс 3
[58:09.000 --> 58:11.000]  плюс c2m
[58:11.000 --> 58:13.000]  a и плюс 4
[58:13.000 --> 58:15.000]  плюс и так далее.
[58:15.000 --> 58:17.000]  Плюс c k
[58:17.000 --> 58:19.000]  минус 1m
[58:19.000 --> 58:21.000]  a и плюс k
[58:21.000 --> 58:23.000]  плюс 1.
[58:23.000 --> 58:25.000]  Ну, плюс, да.
[58:25.000 --> 58:27.000]  И так далее.
[58:27.000 --> 58:29.000]  Ну и что-то у нас будет теперь в итоге
[58:29.000 --> 58:31.000]  в самом конце.
[58:31.000 --> 58:33.000]  В самом конце у нас тут будет
[58:33.000 --> 58:35.000]  что там получается будет?
[58:37.000 --> 58:39.000]  Ну да, k минус 1 получается.
[58:39.000 --> 58:41.000]  k минус 1m.
[58:43.000 --> 58:45.000]  Значит, тут получается опять
[58:45.000 --> 58:47.000]  c0m a
[58:47.000 --> 58:49.000]  и плюс k минус 1.
[58:49.000 --> 58:51.000]  Нет, почему и плюс k минус 1?
[58:51.000 --> 58:53.000]  Да, и плюс k минус 1, да.
[58:53.000 --> 58:55.000]  Плюс
[58:55.000 --> 58:57.000]  c1m a
[58:57.000 --> 58:59.000]  и плюс k.
[58:59.000 --> 59:01.000]  Плюс c2m
[59:01.000 --> 59:03.000]  a и плюс k плюс 1.
[59:03.000 --> 59:05.000]  Плюс и так далее.
[59:05.000 --> 59:07.000]  Плюс c.
[59:07.000 --> 59:09.000]  Значит, что тут получается?
[59:11.000 --> 59:13.000]  Ну да, тут
[59:13.000 --> 59:15.000]  c k минус 1m.
[59:15.000 --> 59:17.000]  И тут ашечка получается
[59:19.000 --> 59:21.000]  какая?
[59:21.000 --> 59:23.000]  Получается, да, да.
[59:23.000 --> 59:25.000]  И плюс 2k минус 2.
[59:27.000 --> 59:29.000]  Вот.
[59:31.000 --> 59:33.000]  Значит, смотрите.
[59:35.000 --> 59:37.000]  Ну, теперь давайте внимательно смотреть.
[59:37.000 --> 59:39.000]  Что же у нас тут
[59:39.000 --> 59:41.000]  будет получаться?
[59:43.000 --> 59:45.000]  Вот, давайте, то есть
[59:45.000 --> 59:47.000]  теперь давайте попробуем это погруппировать.
[59:53.000 --> 59:55.000]  Ну, заметим, конечно, что ашки,
[59:55.000 --> 59:57.000]  ашек у нас, правда, не k минус 1.
[59:57.000 --> 59:59.000]  Ну, там их 2k.
[01:00:01.000 --> 01:00:03.000]  Но все-таки давайте посмотрим
[01:00:03.000 --> 01:00:05.000]  на какие коэффициенты получаются.
[01:00:05.000 --> 01:00:07.000]  Значит, при a и там получается
[01:00:07.000 --> 01:00:09.000]  ну, просто
[01:00:09.000 --> 01:00:11.000]  c0m умножить
[01:00:11.000 --> 01:00:13.000]  на c0m.
[01:00:17.000 --> 01:00:19.000]  А что получается при a и плюс 1?
[01:00:19.000 --> 01:00:21.000]  А что получается при a и плюс 1?
[01:00:39.000 --> 01:00:41.000]  Так, далее.
[01:00:41.000 --> 01:00:43.000]  А что получается при a и плюс 2?
[01:00:49.000 --> 01:00:51.000]  С1m.
[01:00:51.000 --> 01:00:53.000]  С1m.
[01:00:53.000 --> 01:00:55.000]  С1m.
[01:00:55.000 --> 01:00:57.000]  Плюс c2m.
[01:00:57.000 --> 01:00:59.000]  С0m.
[01:00:59.000 --> 01:01:01.000]  А и плюс 2.
[01:01:01.000 --> 01:01:03.000]  Ну, да, очень удобно.
[01:01:03.000 --> 01:01:05.000]  Но, тем не менее, хочется их
[01:01:05.000 --> 01:01:07.000]  так попереписывать.
[01:01:07.000 --> 01:01:09.000]  Вот.
[01:01:09.000 --> 01:01:11.000]  Потому что, в принципе, да, тут уже можно найти
[01:01:11.000 --> 01:01:13.000]  какую-то закономерность, правда?
[01:01:15.000 --> 01:01:17.000]  Ну, вот.
[01:01:17.000 --> 01:01:19.000]  Закономерность заключает в том, что это
[01:01:19.000 --> 01:01:21.000]  до жути похожее, на самом деле, на коэффициенты
[01:01:21.000 --> 01:01:23.000]  перемножения каких-то многочленов, правда?
[01:01:25.000 --> 01:01:27.000]  Ну, и действительно. То есть, фактически вы должны
[01:01:27.000 --> 01:01:29.000]  просто из этих c-шек взять многочлен
[01:01:29.000 --> 01:01:31.000]  размера k,
[01:01:31.000 --> 01:01:33.000]  перемножить его на сам себя и, собственно,
[01:01:33.000 --> 01:01:35.000]  ровно нужные коэффициенты и получится.
[01:01:37.000 --> 01:01:39.000]  То есть, можно вот таким образом убедиться.
[01:01:39.000 --> 01:01:41.000]  Можно более строго доказать,
[01:01:41.000 --> 01:01:43.000]  написав все то же самое, только в терминах
[01:01:43.000 --> 01:01:45.000]  там вот этих вот сигом.
[01:01:45.000 --> 01:01:47.000]  То есть, тогда там это совсем надежно
[01:01:47.000 --> 01:01:49.000]  получится.
[01:01:49.000 --> 01:01:51.000]  Но увидеть это можно вот таким вот образом.
[01:01:53.000 --> 01:01:55.000]  Итак.
[01:01:57.000 --> 01:01:59.000]  Да.
[01:02:11.000 --> 01:02:13.000]  Ну, да. То есть, да, маленькая проблема
[01:02:13.000 --> 01:02:15.000]  заключается в том, что, да, мы научились
[01:02:15.000 --> 01:02:17.000]  выражать i плюс 2m-ый коэффициент
[01:02:17.000 --> 01:02:19.000]  через коэффициенты
[01:02:19.000 --> 01:02:21.000]  и настояние 2m от него,
[01:02:21.000 --> 01:02:23.000]  но единственный минус у нас
[01:02:23.000 --> 01:02:25.000]  заключается в том, что этих
[01:02:25.000 --> 01:02:27.000]  коэффициентов у нас не k,
[01:02:27.000 --> 01:02:29.000]  как хотелось бы, а
[01:02:29.000 --> 01:02:31.000]  2k. Ну ладно, 2k-1.
[01:02:33.000 --> 01:02:35.000]  Ну, а теперь давайте думать.
[01:02:37.000 --> 01:02:39.000]  Сильно ли это большая проблема?
[01:02:39.000 --> 01:02:41.000]  Сильно.
[01:02:41.000 --> 01:02:43.000]  Вот там же хотелось через
[01:02:43.000 --> 01:02:45.000]  как коэффициентов, а не через 2k-1?
[01:02:47.000 --> 01:02:49.000]  Вот как вы думаете?
[01:02:49.000 --> 01:02:51.000]  Как такой проблем побагать?
[01:02:53.000 --> 01:02:55.000]  Чего?
[01:02:57.000 --> 01:02:59.000]  Куда? Кого развернуть?
[01:03:01.000 --> 01:03:03.000]  Что вы имеете в виду? Что развернуть там?
[01:03:03.000 --> 01:03:05.000]  Цк-1, цк-2 и так далее?
[01:03:09.000 --> 01:03:29.000]  ТРЕВОЖНАЯ МУЗЫКА
[01:03:29.000 --> 01:03:31.000]  Ну да, ответ у вас прям пред глазами, да.
[01:03:35.000 --> 01:03:37.000]  Не, не там, вон там
[01:03:39.000 --> 01:03:56.800]  А зачем нам их считать?
[01:03:56.800 --> 01:03:57.800]  Нам скорее наоборот.
[01:03:57.800 --> 01:04:02.800]  То есть смотрите, мы с вами только что получили, что
[01:04:02.800 --> 01:04:07.880]  у нас a и плюс два мт равно, я напишу так, от балды,
[01:04:07.880 --> 01:04:14.880]  там d нулевое i t, плюс d один i плюс первое, плюс и так далее,
[01:04:14.880 --> 01:04:21.880]  плюс d, у нас там сколько там, 2k минус второе, там a и плюс
[01:04:21.880 --> 01:04:22.880]  2k минус два.
[01:04:22.880 --> 01:04:27.880]  Где d, какие-то коэффициенты, но зато для любого i.
[01:04:27.880 --> 01:04:34.880]  Ну вот, мы раньше, помните, мы так сводили к предыдущему
[01:04:34.880 --> 01:04:37.880]  шагу, как наш шаг раньше, беря последнюю ашку и расписывая
[01:04:37.880 --> 01:04:38.880]  ее через сшки.
[01:04:38.880 --> 01:04:48.880]  А что нам мешает вот эту ашку просто расписать через
[01:04:48.880 --> 01:04:50.880]  сшки предыдущих?
[01:04:50.880 --> 01:04:55.880]  Ну, через а и плюс 2k минус 3, минус 4 и так далее.
[01:04:55.880 --> 01:04:59.880]  То есть они все здесь уложатся.
[01:04:59.880 --> 01:05:03.880]  У нас же k порядка 2000, так что можно в квадрат.
[01:05:03.880 --> 01:05:06.880]  Ну да, то есть обратите внимание, я не случайно k 2000.
[01:05:06.880 --> 01:05:09.880]  То есть предлагается просто прям честно в тупую это
[01:05:09.880 --> 01:05:11.880]  сделать.
[01:05:11.880 --> 01:05:14.880]  Прям вместо вот этой штуки, то есть просто сказать,
[01:05:14.880 --> 01:05:18.880]  что вот эта штука равна опять сумму вот этих вот
[01:05:18.880 --> 01:05:28.880]  с житых на а там условно и плюс k минус 2 плюс ж.
[01:05:28.880 --> 01:05:31.880]  И тогда сказать, что у меня теперь в этой линии, и тогда
[01:05:31.880 --> 01:05:34.880]  если их перегруппировать, то получится, что ашек у меня
[01:05:34.880 --> 01:05:37.880]  будет уже тут не до минус 2, а до минус 3.
[01:05:37.880 --> 01:05:40.880]  Повторим эту операцию k раз, и у меня тут останутся
[01:05:40.880 --> 01:05:44.880]  собственно только а к ашек, то, что мне и надо.
[01:05:44.880 --> 01:05:47.880]  То есть таким образом, смотрите, то есть чтобы посчитать,
[01:05:47.880 --> 01:05:50.880]  чтобы перейти от m к 2m, мне нужно одно произведение
[01:05:50.880 --> 01:05:54.880]  двух многочленов размера k одинаково, что приятно.
[01:05:54.880 --> 01:05:56.880]  Которое можно сделать за квадрат.
[01:05:56.880 --> 01:06:00.880]  Да, кстати, можно сделать за квадрат, а потом не менее
[01:06:00.880 --> 01:06:03.880]  в тупую вот это вот за квадрат проверить.
[01:06:03.880 --> 01:06:06.880]  Ну вот.
[01:06:06.880 --> 01:06:08.880]  Даже вурье не нужно.
[01:06:08.880 --> 01:06:10.880]  Ну как сказать.
[01:06:10.880 --> 01:06:13.880]  Ну я боюсь, это впендюривание в алгоритм черного ящика
[01:06:13.880 --> 01:06:18.880]  не делает задачу тривиально или нетривиально.
[01:06:18.880 --> 01:06:21.880]  Вот, мне кажется так.
[01:06:21.880 --> 01:06:24.880]  И так, то есть таким образом у нас какая симптомика
[01:06:24.880 --> 01:06:25.880]  получилась, кстати?
[01:06:25.880 --> 01:06:27.880]  Ну а теперь, нет, теперь, ладно, теперь задача.
[01:06:27.880 --> 01:06:28.880]  Хорошо, а там к 2m перешли.
[01:06:28.880 --> 01:06:31.880]  Теперь задача получить n коэффициенты.
[01:06:31.880 --> 01:06:34.880]  Давайте я разложу на стипинг 2 и научусь вспомнить того,
[01:06:34.880 --> 01:06:38.880]  что научусь также складывать.
[01:06:38.880 --> 01:06:39.880]  Ага.
[01:06:39.880 --> 01:06:42.880]  Ну да, то есть, ну во-первых, да, тут дальше два механизма
[01:06:42.880 --> 01:06:43.880]  есть.
[01:06:43.880 --> 01:06:45.880]  Да, можно, конечно, сказать, что если у нас есть коэффициенты
[01:06:45.880 --> 01:06:48.880]  по m1 и m2, то мы типа можем аналогичным образом
[01:06:48.880 --> 01:06:54.880]  получить m1 плюс m2, на самом деле.
[01:06:54.880 --> 01:06:55.880]  Ну как хотелось бы.
[01:06:55.880 --> 01:06:57.880]  Ну в принципе, роспись ровно та же.
[01:06:57.880 --> 01:07:00.880]  Только я при второй росписи, у меня тут просто, то есть
[01:07:00.880 --> 01:07:03.880]  просто при первой росписи, то есть у меня тут m1 плюс m2,
[01:07:03.880 --> 01:07:08.880]  при первой росписи у меня тут m2, а потом при второй m1.
[01:07:08.880 --> 01:07:11.880]  Вот, это вы уже можете в качестве упражнения расписать.
[01:07:11.880 --> 01:07:14.880]  Тем более, что на самом деле необходимости в этом нет.
[01:07:14.880 --> 01:07:17.880]  Потому что на самом деле нам уже достаточно того,
[01:07:17.880 --> 01:07:21.880]  что мы по m можем понимать m плюс 1 и по m понимать 2m.
[01:07:21.880 --> 01:07:24.880]  То есть, на самом деле, да.
[01:07:30.880 --> 01:07:33.880]  Так что, соответственно, просто там умеем прибавлять,
[01:07:33.880 --> 01:07:36.880]  умеем радоваться и, в общем-то, все.
[01:07:41.880 --> 01:07:46.880]  Вот.
[01:07:46.880 --> 01:07:49.880]  Так что, соответственно.
[01:07:49.880 --> 01:07:52.880]  Ну тогда какая всем точка-то получается?
[01:07:52.880 --> 01:07:56.880]  Да, совершенно верно.
[01:07:56.880 --> 01:07:58.880]  Такой уровень медиум.
[01:07:58.880 --> 01:08:00.880]  А вот теперь задача, в которой все-таки не придется
[01:08:00.880 --> 01:08:03.880]  ничего принципиально нового придумывать.
[01:08:03.880 --> 01:08:10.880]  Но как это часто бывает, а если я тут все-таки пару нулей еще напишу?
[01:08:10.880 --> 01:08:17.880]  Так, да, здесь фурия, а тут очки.
[01:08:17.880 --> 01:08:20.880]  Ну-ка, давайте внимательно подумаем.
[01:08:31.880 --> 01:08:34.880]  Нет, вот подумайте, это можно увидеть.
[01:08:34.880 --> 01:08:38.880]  Давайте подумайте, может, просписывайте чуть-чуть там.
[01:08:38.880 --> 01:08:41.880]  Давайте.
[01:08:44.880 --> 01:08:50.880]  То есть тут как бы нужно выглядеть более точно, какие тут формулы вообще появляются.
[01:09:38.880 --> 01:09:54.880]  А при чем тут фурия?
[01:09:54.880 --> 01:09:57.880]  Ну-ка, именно.
[01:10:01.880 --> 01:10:04.880]  То есть мы хотим домножить эту вторую половину,
[01:10:04.880 --> 01:10:10.880]  которую многочлен, который эти все ашки торжественно обнулит.
[01:10:10.880 --> 01:10:13.880]  Ну понятно, да.
[01:10:13.880 --> 01:10:16.880]  Просто обычно, если вы будете их домножать на какой-то многочлен,
[01:10:16.880 --> 01:10:21.880]  то там, скорее всего, просто эти коэффициенты, они же не в эту сторону пойдут.
[01:10:31.880 --> 01:10:33.880]  Ну давайте, давайте, давайте.
[01:10:33.880 --> 01:10:35.880]  Так, давайте.
[01:10:35.880 --> 01:10:37.880]  Как-то на вас даже не похоже.
[01:10:37.880 --> 01:10:41.880]  Это вообще не понятно.
[01:10:41.880 --> 01:10:45.880]  Ну не знаю, нет, обычно у вас как-то всегда это...
[01:10:45.880 --> 01:10:50.880]  Ну как сказать, обычно у вас в вашем стиле в течение пары минут
[01:10:50.880 --> 01:10:55.880]  поделите уже кучу идей, на которых мы потом вытягиваем все алгоритмы.
[01:10:55.880 --> 01:10:59.880]  Ну вот почти всегда это работает обычно.
[01:10:59.880 --> 01:11:02.880]  А это что?
[01:11:02.880 --> 01:11:06.880]  Да, это говорят люди, доказавшие мастер-тиререму.
[01:11:09.880 --> 01:11:13.880]  Да, Антон доказал мастер-тиререму и ушел.
[01:11:13.880 --> 01:11:15.880]  Ну окей, хорошо.
[01:11:21.880 --> 01:11:24.880]  Вот это вот дешку.
[01:11:24.880 --> 01:11:26.880]  Отсадить.
[01:11:26.880 --> 01:11:27.880]  Отсадить внимательно.
[01:11:27.880 --> 01:11:29.880]  На самом деле тут половина задачи решается методом,
[01:11:29.880 --> 01:11:32.880]  а давайте просто ручками это проделаем.
[01:11:32.880 --> 01:11:35.880]  Не получилось ни один из предыдущих шагов проделать ручками.
[01:11:35.880 --> 01:11:37.880]  Ну, смотрите.
[01:11:37.880 --> 01:11:40.880]  Давайте рассмотрим пример.
[01:11:40.880 --> 01:11:42.880]  Да.
[01:11:42.880 --> 01:11:46.880]  Давайте это редкий случай, рассмотрим пример.
[01:11:46.880 --> 01:11:50.880]  Вот представьте себе, что были и были у нас цешки.
[01:11:50.880 --> 01:11:52.880]  Какие?
[01:11:52.880 --> 01:11:54.880]  Ну, допустим, пять, два, три, четыре, один.
[01:11:54.880 --> 01:11:56.880]  Вот это цешки.
[01:11:59.880 --> 01:12:01.880]  И, допустим, у нас появились дешки.
[01:12:01.880 --> 01:12:05.880]  Ну тоже сейчас от балды распишем, потому что какие-то первые попавшиеся дешки.
[01:12:05.880 --> 01:12:07.880]  Кстати, сколько у нас там дешек будет?
[01:12:07.880 --> 01:12:09.880]  Девять штук, да?
[01:12:09.880 --> 01:12:11.880]  Вот дешки у нас получились, допустим,
[01:12:11.880 --> 01:12:14.880]  d0, d1, d2 и так далее, d8.
[01:12:14.880 --> 01:12:18.880]  И стали они равны, но по каким-то модулям, там черти шоу,
[01:12:18.880 --> 01:12:21.880]  поэтому тоже можем, в общем-то, написать от балды.
[01:12:21.880 --> 01:12:25.880]  Четыре, два, восемь.
[01:12:25.880 --> 01:12:27.880]  Ладно, так не получится.
[01:12:27.880 --> 01:12:31.880]  Так, 5, d6, d7, d8.
[01:12:31.880 --> 01:12:37.880]  Один, два, три, ноль, два, пять.
[01:12:37.880 --> 01:12:39.880]  Видите, да?
[01:12:39.880 --> 01:12:41.880]  Давайте смотрите.
[01:12:41.880 --> 01:12:43.880]  Что нам нужно сделать?
[01:12:43.880 --> 01:12:47.880]  Мы берем восьмую и расписываем, и отправляем ее в седьмую.
[01:12:47.880 --> 01:12:49.880]  То есть смотрите, что у меня получается.
[01:12:49.880 --> 01:12:54.880]  То есть тут у меня получается ноль, а вот здесь я прибавляю вот эти все цешки.
[01:12:54.880 --> 01:12:57.880]  Только умноженные на 5, обратите внимание.
[01:12:57.880 --> 01:13:03.880]  То есть получается, я прибавляю 2 плюс 5, то есть у меня тут получается 7.
[01:13:03.880 --> 01:13:06.880]  Тут у меня получается аж 20.
[01:13:06.880 --> 01:13:09.880]  Тут у меня получается плюс 15, 18.
[01:13:09.880 --> 01:13:12.880]  Сколько?
[01:13:12.880 --> 01:13:14.880]  Двенадцать, да.
[01:13:14.880 --> 01:13:17.880]  Тут 12, ну и там, соответственно, 26.
[01:13:17.880 --> 01:13:20.880]  Вот.
[01:13:20.880 --> 01:13:25.880]  Ну вот, теперь расписываем семерочку.
[01:13:25.880 --> 01:13:28.880]  Ну вот, расписываем семерочку.
[01:13:28.880 --> 01:13:31.880]  Так, значит, тут у нас получается нолик.
[01:13:31.880 --> 01:13:34.880]  А тут поехали, 27.
[01:13:34.880 --> 01:13:39.880]  Тут получается, сколько там, плюс 28, 46.
[01:13:39.880 --> 01:13:42.880]  Значит, тут получается плюс 21, 33.
[01:13:42.880 --> 01:13:45.880]  Тут получается плюс 14, 40.
[01:13:45.880 --> 01:13:49.880]  И тут получается плюс 35, 43.
[01:13:49.880 --> 01:13:52.880]  Видите, да?
[01:13:52.880 --> 01:13:55.880]  Вот, так, 27.
[01:13:55.880 --> 01:13:59.880]  Так, ну тоже расписываем, 27.
[01:13:59.880 --> 01:14:03.880]  Так, 66, 73.
[01:14:03.880 --> 01:14:04.880]  Так, тут 73.
[01:14:04.880 --> 01:14:06.880]  Так, 27 на 4 это 108.
[01:14:06.880 --> 01:14:08.880]  Так, 141.
[01:14:08.880 --> 01:14:11.880]  Вот, ладно, пока я тут упражняюсь в умножении, это называется сразу.
[01:14:11.880 --> 01:14:14.880]  Тут это просто ничего не напоминает.
[01:14:14.880 --> 01:14:18.880]  Нигде мы такую картинку не видели.
[01:14:18.880 --> 01:14:21.880]  Так, значит, это на 3. Сколько там, 81.
[01:14:21.880 --> 01:14:23.880]  Так, тут 121.
[01:14:23.880 --> 01:14:26.880]  Тут там, сколько там, 54, 43.
[01:14:26.880 --> 01:14:28.880]  Это 97.
[01:14:28.880 --> 01:14:31.880]  О, их сезону 27 на 5.
[01:14:31.880 --> 01:14:33.880]  Так, окей.
[01:14:33.880 --> 01:14:35.880]  Вот.
[01:14:45.880 --> 01:14:48.880]  Да, уверены?
[01:14:48.880 --> 01:14:51.880]  А теперь смотрите.
[01:14:53.880 --> 01:14:56.880]  Вот, возьмем такой многочлен.
[01:15:14.880 --> 01:15:17.880]  Вот.
[01:15:17.880 --> 01:15:20.880]  Вот сейчас мы его возьмем.
[01:15:20.880 --> 01:15:23.880]  И попытаемся поделиться остатком.
[01:15:23.880 --> 01:15:26.880]  Чего?
[01:15:26.880 --> 01:15:29.880]  Поделиться остатком.
[01:15:29.880 --> 01:15:32.880]  Правда, нам потребуется, нам даже и остаток и понадобится.
[01:15:32.880 --> 01:15:33.880]  Нам многочлен.
[01:15:33.880 --> 01:15:36.880]  Смотрите, какого вида.
[01:15:36.880 --> 01:15:39.880]  Вот.
[01:15:39.880 --> 01:15:42.880]  Минус.
[01:15:42.880 --> 01:15:45.880]  Так, только тут минус t в четвертой,
[01:15:45.880 --> 01:15:48.880]  минус 4t в кубе,
[01:15:48.880 --> 01:15:51.880]  минус 3t в квадрате.
[01:15:51.880 --> 01:15:54.880]  Вон оттуда.
[01:15:54.880 --> 01:15:57.880]  Вот оно, вот 5, вот 2.
[01:15:57.880 --> 01:16:00.880]  Вот.
[01:16:00.880 --> 01:16:03.880]  Вот.
[01:16:03.880 --> 01:16:06.880]  Вот.
[01:16:06.880 --> 01:16:09.880]  Вот оно, вот 5, вот 2.
[01:16:23.880 --> 01:16:26.880]  Ага.
[01:16:26.880 --> 01:16:29.880]  А теперь давайте сейчас будем делиться остатком.
[01:16:29.880 --> 01:16:32.880]  Ну.
[01:16:32.880 --> 01:16:35.880]  Точно.
[01:16:35.880 --> 01:16:38.880]  Ну вот.
[01:16:38.880 --> 01:16:41.880]  Давайте аккуратно поделим.
[01:16:41.880 --> 01:16:44.880]  Делим 5t.
[01:16:44.880 --> 01:16:47.880]  Это старшее на старшее, получается тут 5t в кубе.
[01:16:47.880 --> 01:16:50.880]  Теперь давайте смотреть.
[01:16:50.880 --> 01:16:53.880]  Тут получается 5t восьмой.
[01:16:53.880 --> 01:16:56.880]  А вот тут, слева направо я немножко пишу, такая арабская вещь.
[01:16:56.880 --> 01:16:59.880]  Ну что делать?
[01:16:59.880 --> 01:17:02.880]  Что у нас тут получается?
[01:17:03.880 --> 01:17:06.880]  Значит, так.
[01:17:06.880 --> 01:17:09.880]  5t восьмой, минус 5t в седьмой.
[01:17:09.880 --> 01:17:12.880]  Значит, тут получается в шестой у нас
[01:17:12.880 --> 01:17:15.880]  минус 20t в шестой.
[01:17:15.880 --> 01:17:18.880]  Значит, минус сколько там? Пятнадцать, да?
[01:17:18.880 --> 01:17:21.880]  t в пятой.
[01:17:21.880 --> 01:17:24.880]  Значит, минус 10t в четвертой.
[01:17:27.880 --> 01:17:30.880]  Минус 25t в кубе.
[01:17:32.880 --> 01:17:35.880]  Вот. То есть теперь смотрите, что происходит.
[01:17:35.880 --> 01:17:38.880]  Так как тут минусы, вот это вот шлеп-шлепается.
[01:17:38.880 --> 01:17:41.880]  А здесь вот эти коэффициенты,
[01:17:41.880 --> 01:17:44.880]  то есть 2 минус минус 5, это 2 плюс 5.
[01:17:44.880 --> 01:17:47.880]  То есть получается то самое.
[01:17:47.880 --> 01:17:50.880]  7t в седьмой, плюс 20t в шестой,
[01:17:50.880 --> 01:17:53.880]  плюс там 18t в пятой,
[01:17:53.880 --> 01:17:56.880]  плюс 12t в четвертой,
[01:17:56.880 --> 01:17:59.880]  плюс 26t в кубе.
[01:17:59.880 --> 01:18:02.880]  Ой, знакомые циферки, да?
[01:18:08.880 --> 01:18:11.880]  То есть по факту, да, вы как бы этот коэффициент,
[01:18:11.880 --> 01:18:14.880]  перенесли вот сюда, как раз прибавили
[01:18:14.880 --> 01:18:17.880]  и домножили на ц.
[01:18:17.880 --> 01:18:20.880]  Можно повторить, но, соответственно,
[01:18:20.880 --> 01:18:23.880]  получается, что на самом деле по факту
[01:18:23.880 --> 01:18:26.880]  вам нужно просто поделить это,
[01:18:26.880 --> 01:18:29.880]  взять это как многочлен и поделить его
[01:18:29.880 --> 01:18:32.880]  на вот мистический многочлен вот такого вида.
[01:18:35.880 --> 01:18:38.880]  А делить мы за энлогенумеем.
[01:18:38.880 --> 01:18:41.880]  В чем редкий случай, нам потребуется
[01:18:41.880 --> 01:18:44.880]  впервые в жизни не частное, а именно остаток.
[01:18:44.880 --> 01:18:47.880]  Обратите внимание.
[01:18:47.880 --> 01:18:50.880]  И ровно этот остаток – это то, что нам надо.
[01:18:51.880 --> 01:18:54.880]  И таким образом эта махинация
[01:18:54.880 --> 01:18:57.880]  и предлагает нам
[01:18:57.880 --> 01:19:00.880]  превратить k log n в k log k.
[01:19:04.880 --> 01:19:07.880]  Так что вот такая вот
[01:19:07.880 --> 01:19:10.880]  на самом деле красота.
[01:19:10.880 --> 01:19:13.880]  Да.
[01:19:16.880 --> 01:19:19.880]  Так, ну что, есть ли тут
[01:19:19.880 --> 01:19:22.880]  какие-то вопросы?
[01:19:26.880 --> 01:19:29.880]  Ну, можно было попробовать, да.
[01:19:29.880 --> 01:19:32.880]  Ну, бывает, ничего страшного.
[01:19:32.880 --> 01:19:35.880]  Как вы знаете, все-таки многие идеи
[01:19:35.880 --> 01:19:38.880]  все равно, может быть, лучше ложатся, если их попытаться придумать.
[01:19:38.880 --> 01:19:41.880]  Если вы там до конца полностью не придумаете.
[01:19:41.880 --> 01:19:44.880]  То есть все равно как-то ощущаете.
[01:19:44.880 --> 01:19:47.880]  Ну, это другой вопрос.
[01:19:47.880 --> 01:19:50.880]  Нет, ну знаете, там, знаете, иногда я люблю на самом деле такие вопросы в ЧГК, например,
[01:19:50.880 --> 01:19:53.880]  когда тоже так это думаешь, думаешь, там разные варианты перебрал,
[01:19:53.880 --> 01:19:56.880]  там разные гипотезы, а потом тебе сообщают ответ,
[01:19:56.880 --> 01:19:59.880]  и он тебя вот удивляет, потому что ты там то ли вообще в эту сторону не думал,
[01:19:59.880 --> 01:20:02.880]  то ли такого нет, то ли такой подлянки не ожидал.
[01:20:02.880 --> 01:20:05.880]  Ну, то есть на самом деле это прям особая красота получается.
[01:20:06.880 --> 01:20:09.880]  Но тогда именно для этого нужно, чтобы вы именно
[01:20:09.880 --> 01:20:12.880]  для этого поработали.
[01:20:12.880 --> 01:20:15.880]  Или аналогичный пример, то есть как известно, там,
[01:20:15.880 --> 01:20:18.880]  как бы, вот если вы там, там, смотрите, что-нибудь там, это
[01:20:18.880 --> 01:20:21.880]  великолепная, там, шахматная партия, там, я не знаю, Александра
[01:20:21.880 --> 01:20:24.880]  Алёхина, там, я не знаю, если он Александр, конечно.
[01:20:24.880 --> 01:20:27.880]  Вот, там что-нибудь, вот обычная то есть или там, кто-нибудь там великолепный,
[01:20:27.880 --> 01:20:30.880]  или лучшая партия Магдуса Карлсона,
[01:20:30.880 --> 01:20:33.880]  там, в 2013 году, там и так далее.
[01:20:33.880 --> 01:20:36.880]  Но тут вот есть такое подозрение, что обычно, если товарищ сыграл
[01:20:36.880 --> 01:20:39.880]  лучшую партию, то есть подозрение, что на той стороне доски тоже там
[01:20:39.880 --> 01:20:42.880]  не хухры-мухры-шо сидело, правда.
[01:20:42.880 --> 01:20:45.880]  Тоже там, скорее всего, кто-то сильно сидел, потому что
[01:20:45.880 --> 01:20:48.880]  как бы, наверное, против детсадовца он, наверное, шедевр играть не будет.
[01:20:52.880 --> 01:20:55.880]  Так, ну ладно, есть тут вопросов нет,
[01:20:55.880 --> 01:20:58.880]  но тогда, кажется, вот пришло время перерывчика.
[01:20:58.880 --> 01:21:01.880]  Так, ну что ж, пришло
[01:21:01.880 --> 01:21:04.880]  время перейти к...
[01:21:04.880 --> 01:21:07.880]  Так, там пришло время. А, ну да, пришло раз.
[01:21:07.880 --> 01:21:10.880]  Раз, потом в конце закрут. Значит, пришло время перейти
[01:21:10.880 --> 01:21:13.880]  к многомерному преобразованию фурье.
[01:21:13.880 --> 01:21:16.880]  Значит, на всякий случай прошу сегодня в конце это ещё напомнить, что там,
[01:21:16.880 --> 01:21:19.880]  что помимо него есть ещё одна штука, которая не связана
[01:21:19.880 --> 01:21:22.880]  с многомерным преобразованием фурье.
[01:21:22.880 --> 01:21:25.880]  Вот, но на ней вот, как я уже сказал, очень хочется закончить, ну просто вот.
[01:21:27.880 --> 01:21:30.880]  Это чертовски правильно было бы.
[01:21:30.880 --> 01:21:33.880]  Ну не чертовски, но вот.
[01:21:33.880 --> 01:21:36.880]  И так, значит, подумаем вот о чём.
[01:21:36.880 --> 01:21:39.880]  То есть вот, как известно,
[01:21:39.880 --> 01:21:42.880]  мы до сих пор работали с многочленами
[01:21:42.880 --> 01:21:45.880]  от одной переменной.
[01:21:45.880 --> 01:21:48.880]  Вот.
[01:21:48.880 --> 01:21:51.880]  Но бывают многочлены, в принципе, и от двух переменных,
[01:21:51.880 --> 01:21:54.880]  выглядящие вот примерно там следующим каким-то образом.
[01:21:54.880 --> 01:21:57.880]  То есть какой-нибудь там 5 плюс
[01:21:57.880 --> 01:22:00.880]  x, y в четвёртой, плюс y в кубе, там, я не знаю,
[01:22:00.880 --> 01:22:03.880]  минус 6 x квадрат,
[01:22:03.880 --> 01:22:06.880]  плюс там 7, я не знаю, x в кубе,
[01:22:06.880 --> 01:22:09.880]  y восьмой, ну и так далее.
[01:22:09.880 --> 01:22:12.880]  Вот, в принципе, такая штука есть.
[01:22:14.880 --> 01:22:17.880]  То есть пока вот для простоты от двух переменных.
[01:22:20.880 --> 01:22:23.880]  И нам бы очень хотелось
[01:22:23.880 --> 01:22:26.880]  эти многочлены уметь тоже перемножать.
[01:22:27.880 --> 01:22:30.880]  Ну а именно, значит, более точно сказать, что
[01:22:30.880 --> 01:22:33.880]  давайте скажем, что у нас многочлен имеет по x размер n,
[01:22:33.880 --> 01:22:36.880]  а по игроку размер m.
[01:22:36.880 --> 01:22:39.880]  Это что то же самое. То есть мы просто расписываем.
[01:22:39.880 --> 01:22:42.880]  Что у нас, значит,
[01:22:42.880 --> 01:22:45.880]  степень i мы, по x мы перебираем
[01:22:45.880 --> 01:22:48.880]  от 0 до n минус 1,
[01:22:48.880 --> 01:22:51.880]  а степень по игроку
[01:22:51.880 --> 01:22:54.880]  от 0 до m минус 1.
[01:22:54.880 --> 01:22:57.880]  А это j и x в степени i,
[01:22:57.880 --> 01:23:00.880]  и игрок в степени j.
[01:23:05.880 --> 01:23:08.880]  Вот.
[01:23:08.880 --> 01:23:11.880]  То есть вот такая вот штука. То есть у нас получается
[01:23:11.880 --> 01:23:14.880]  коэффициенты образуют на этот раз не массивчик, а вот
[01:23:14.880 --> 01:23:17.880]  табличку вот такую n
[01:23:17.880 --> 01:23:20.880]  на m.
[01:23:20.880 --> 01:23:23.880]  Понимаете, да?
[01:23:24.880 --> 01:23:27.880]  Ну и вот, соответственно, теперь.
[01:23:27.880 --> 01:23:30.880]  И теперь, соответственно, представим себе, что мы
[01:23:30.880 --> 01:23:33.880]  чего?
[01:23:33.880 --> 01:23:36.880]  Значит, теперь мы хотим взять два таких многочлена,
[01:23:36.880 --> 01:23:39.880]  может быть даже одинакового размера.
[01:23:39.880 --> 01:23:42.880]  Одинакового размера.
[01:23:42.880 --> 01:23:45.880]  И их поделить.
[01:23:45.880 --> 01:23:48.880]  Тут делить не понятно, что такое делить
[01:23:48.880 --> 01:23:51.880]  в данном случае.
[01:23:51.880 --> 01:23:54.880]  Вот мы хотим поумножать.
[01:23:57.880 --> 01:24:00.880]  Ну вот возникает такой внимание вопрос.
[01:24:00.880 --> 01:24:03.880]  Как же это сделать?
[01:24:03.880 --> 01:24:06.880]  Какие варианты?
[01:24:21.880 --> 01:24:24.880]  Ну да.
[01:24:24.880 --> 01:24:27.880]  Можно совсем в тупую перебирать тут все
[01:24:27.880 --> 01:24:30.880]  по слагаемому тут, слагаемому тут, поперебножать, порадоваться.
[01:24:30.880 --> 01:24:33.880]  Да, совершенно верно. Действительно, это можно успешно
[01:24:33.880 --> 01:24:36.880]  сделать.
[01:24:36.880 --> 01:24:39.880]  Да.
[01:24:52.880 --> 01:24:55.880]  Да.
[01:25:13.880 --> 01:25:16.880]  Ну как сказать, давайте так. То есть если у нас в a
[01:25:16.880 --> 01:25:19.880]  был моном i1 g1, а в b
[01:25:19.880 --> 01:25:22.880]  и 2g2, то попадут они куда?
[01:25:22.880 --> 01:25:25.880]  То есть они...
[01:25:25.880 --> 01:25:28.880]  Да, совершенно верно.
[01:25:28.880 --> 01:25:31.880]  Так, то есть получается, то есть как бы
[01:25:31.880 --> 01:25:34.880]  фактически...
[01:25:38.880 --> 01:25:41.880]  Так, откуда? Вот, допустим, вот в эту ячейку.
[01:25:41.880 --> 01:25:44.880]  Откуда же в нее попадут?
[01:25:44.880 --> 01:25:47.880]  Как говорится, попадут отсюда
[01:25:47.880 --> 01:25:50.880]  и отсюда, отсюда
[01:25:50.880 --> 01:25:53.880]  и отсюда.
[01:25:53.880 --> 01:25:56.880]  Что-что как-то еще.
[01:25:56.880 --> 01:25:59.880]  Отсюда и откуда?
[01:25:59.880 --> 01:26:02.880]  Ну примерно вот этот вот вектор отсюда.
[01:26:02.880 --> 01:26:05.880]  Тут, видите, тут на самом деле это сумма векторов на самом деле такая.
[01:26:10.880 --> 01:26:13.880]  Так что много откуда попадут.
[01:26:13.880 --> 01:26:16.880]  Ну давайте подумаем вот о чем.
[01:26:16.880 --> 01:26:19.880]  Ну да.
[01:26:19.880 --> 01:26:22.880]  Да, согласен.
[01:26:22.880 --> 01:26:25.880]  Согласен, да.
[01:26:25.880 --> 01:26:28.880]  Согласен.
[01:26:28.880 --> 01:26:31.880]  Но, заметьте в следующее, пока у нас это
[01:26:31.880 --> 01:26:34.880]  перемножение в тупую, это n2 m2.
[01:26:34.880 --> 01:26:37.880]  Можно за n2 m.
[01:26:37.880 --> 01:26:40.880]  Вау.
[01:26:40.880 --> 01:26:43.880]  Как?
[01:26:43.880 --> 01:26:46.880]  Смотри.
[01:26:49.880 --> 01:26:52.880]  Да, но тогда это не n2 m, а n2 m log m, наверное.
[01:26:52.880 --> 01:26:55.880]  Да.
[01:26:55.880 --> 01:26:58.880]  А зря. Они все-таки тоже в 20 раз это
[01:26:58.880 --> 01:27:01.880]  время работы увеличивает.
[01:27:04.880 --> 01:27:07.880]  Ну все.
[01:27:07.880 --> 01:27:10.880]  Ну все-таки.
[01:27:10.880 --> 01:27:13.880]  Значит, хорошо.
[01:27:13.880 --> 01:27:16.880]  Но на самом деле, да, тут можно постройки, можно, я бы сказал,
[01:27:16.880 --> 01:27:19.880]  даже так правильно заметить, что давайте так скажем, что
[01:27:19.880 --> 01:27:22.880]  a от x игр можно себе представить
[01:27:22.880 --> 01:27:25.880]  в виде
[01:27:25.880 --> 01:27:28.880]  такой замечательной суммы
[01:27:28.880 --> 01:27:31.880]  по i от нуля до n-1
[01:27:31.880 --> 01:27:34.880]  как x в степени i умножить
[01:27:34.880 --> 01:27:37.880]  на a it от игр.
[01:27:40.880 --> 01:27:43.880]  А именно, то есть, смотрите, то есть, я
[01:27:43.880 --> 01:27:46.880]  просто вот, то есть, обратите внимание, то есть, если я вот рассмотрю вот вы
[01:27:46.880 --> 01:27:49.880]  умножили на a вот такой ряд, то заметим, что
[01:27:49.880 --> 01:27:52.880]  то есть, это все коэффициенты, которые стоят при x в степени i
[01:27:52.880 --> 01:27:55.880]  и каких-то играх. Если вынести к степени i,
[01:27:55.880 --> 01:27:58.880]  то у меня получается многочлен.
[01:27:58.880 --> 01:28:01.880]  Вот. То есть, в принципе, ну я и про b
[01:28:01.880 --> 01:28:04.880]  могу, в общем-то, то же самое сказать, да.
[01:28:04.880 --> 01:28:07.880]  Значит, i равно n-1
[01:28:07.880 --> 01:28:10.880]  и там x в степени i на, на этот раз b it от игр.
[01:28:10.880 --> 01:28:13.880]  И тогда
[01:28:13.880 --> 01:28:16.880]  такой вариант умножения в тупую звучит
[01:28:16.880 --> 01:28:19.880]  теперь так, что
[01:28:19.880 --> 01:28:22.880]  с одной стороны, ну вот, что когда, то есть, мы перемножаем,
[01:28:22.880 --> 01:28:25.880]  то есть, у нас квадрат слагаемых, но каждый
[01:28:25.880 --> 01:28:28.880]  мы, значит, в каждом слагаемом мы делаем перемножение
[01:28:28.880 --> 01:28:31.880]  двух многочленов
[01:28:31.880 --> 01:28:34.880]  за m лог m. То есть, получается, что там, допустим,
[01:28:34.880 --> 01:28:37.880]  квадрат m квадрат такжественно превратился в n квадрат
[01:28:37.880 --> 01:28:40.880]  m лог m.
[01:28:40.880 --> 01:28:43.880]  Видите, да? Видите?
[01:28:43.880 --> 01:28:46.880]  Вот.
[01:28:46.880 --> 01:28:49.880]  Но теперь давайте думать вот о чем.
[01:28:49.880 --> 01:28:52.880]  Конечно, этот квадрат тоже хочется убить. Каким образом?
[01:28:52.880 --> 01:28:55.880]  Ну вот. А, в общем-то,
[01:28:55.880 --> 01:28:58.880]  достаточно просты.
[01:28:58.880 --> 01:29:01.880]  Смотрите. Ведь на самом деле,
[01:29:01.880 --> 01:29:04.880]  давайте вспомним, то есть, на этот раз там все-таки придется
[01:29:04.880 --> 01:29:07.880]  вспомнить, как же конкретно мы делали
[01:29:07.880 --> 01:29:10.880]  одномерное FFT.
[01:29:10.880 --> 01:29:13.880]  Мы считали значение в интересных прикольных патчах.
[01:29:13.880 --> 01:29:16.880]  Да, совершенно верно.
[01:29:16.880 --> 01:29:19.880]  Вот. А теперь вот возникает вопрос.
[01:29:19.880 --> 01:29:22.880]  А не получится ли у нас что-нибудь подобное здесь?
[01:29:22.880 --> 01:29:25.880]  Было бы круто, но у нас как-то пресечения будут кажется.
[01:29:25.880 --> 01:29:28.880]  Ну, давайте смотреть.
[01:29:28.880 --> 01:29:31.880]  Вот давайте к каждой ашке.
[01:29:31.880 --> 01:29:34.880]  Ну, давайте так.
[01:29:34.880 --> 01:29:37.880]  Вот там бы, действительно, хотелось бы, чтобы вот у нас есть
[01:29:37.880 --> 01:29:40.880]  многочлен AXY как в таблице, и хочется перевести это
[01:29:40.880 --> 01:29:43.880]  в таблицу A от WN в степени I
[01:29:43.880 --> 01:29:46.880]  и WN в степени G.
[01:29:49.880 --> 01:29:52.880]  WN, конечно, да.
[01:29:52.880 --> 01:29:55.880]  Ну, заметим следующее,
[01:29:55.880 --> 01:29:58.880]  что если нам тут потребуется для каждого ряда
[01:29:58.880 --> 01:30:01.880]  явно FFT разлечься.
[01:30:01.880 --> 01:30:04.880]  Ну, вот.
[01:30:04.880 --> 01:30:07.880]  И тогда, смотрите, ну, с другой стороны, заметим следующее,
[01:30:07.880 --> 01:30:10.880]  что что такое A, допустим,
[01:30:10.880 --> 01:30:13.880]  от X и WN?
[01:30:13.880 --> 01:30:16.880]  Ну, вот.
[01:30:16.880 --> 01:30:19.880]  Ну, с другой стороны, заметим следующее,
[01:30:19.880 --> 01:30:22.880]  допустим, от X и WN в степени G.
[01:30:24.880 --> 01:30:27.880]  Что это такое? WN в степени G.
[01:30:27.880 --> 01:30:30.880]  Это, значит, I равно нулю
[01:30:30.880 --> 01:30:33.880]  N-1, X в степени I
[01:30:33.880 --> 01:30:36.880]  на A и T от
[01:30:36.880 --> 01:30:39.880]  WN в степени G.
[01:30:43.880 --> 01:30:46.880]  Ну, обратите внимание, что поменялось?
[01:30:46.880 --> 01:30:49.880]  Поменялось то, что вот этот многочлен превратился
[01:30:49.880 --> 01:30:52.880]  в число, правда?
[01:30:52.880 --> 01:30:55.880]  Вот. То есть на самом деле,
[01:30:55.880 --> 01:30:58.880]  ну, в принципе, да, ничего удивительного.
[01:30:58.880 --> 01:31:01.880]  То есть как бы если бы подставили один игр, то у нас многочлен стал
[01:31:01.880 --> 01:31:04.880]  теперь это одной переменной.
[01:31:04.880 --> 01:31:07.880]  Но более того, смотрите,
[01:31:07.880 --> 01:31:10.880]  то есть по идее я должен теперь,
[01:31:10.880 --> 01:31:13.880]  то есть если я хочу посчитать, зафиксировать G
[01:31:13.880 --> 01:31:16.880]  и посчитать вот эту штуку для всех I,
[01:31:16.880 --> 01:31:19.880]  то фактически что? У меня получился
[01:31:19.880 --> 01:31:22.880]  одномерный многочлен,
[01:31:22.880 --> 01:31:25.880]  и я должен фактически к нему FFTA применить, правда?
[01:31:25.880 --> 01:31:28.880]  Секунду. Здесь у тебя A и T
[01:31:28.880 --> 01:31:31.880]  от WN в степени G.
[01:31:31.880 --> 01:31:34.880]  Да.
[01:31:34.880 --> 01:31:37.880]  Это число, оно разное для разных I.
[01:31:37.880 --> 01:31:40.880]  Конечно.
[01:31:40.880 --> 01:31:43.880]  Но при каждом X в степени I стоит свое число.
[01:31:43.880 --> 01:31:46.880]  То есть получается это многочлен
[01:31:46.880 --> 01:31:49.880]  от X. Вот.
[01:31:49.880 --> 01:31:52.880]  И если мы хотим теперь и в качестве X что-то подставить,
[01:31:52.880 --> 01:31:55.880]  там WN в какой-нибудь степени,
[01:31:55.880 --> 01:31:58.880]  ну, и здесь давайте вот я тут K напишу,
[01:31:58.880 --> 01:32:01.880]  чтобы мы не путались.
[01:32:01.880 --> 01:32:04.880]  Вот так вот. На самом деле.
[01:32:04.880 --> 01:32:07.880]  То есть если мы в качестве X хотим WN в какой-нибудь степени теперь
[01:32:07.880 --> 01:32:10.880]  то фактически мы должны взять теперь
[01:32:10.880 --> 01:32:13.880]  ну, привод уже подставленном G, мы должны взять уже этот многочлен.
[01:32:13.880 --> 01:32:16.880]  Видите, да?
[01:32:16.880 --> 01:32:19.880]  И просто подставить у него
[01:32:19.880 --> 01:32:22.880]  эти значения, то есть к нему для этого можно
[01:32:22.880 --> 01:32:25.880]  просто применить FFT.
[01:32:25.880 --> 01:32:28.880]  А теперь фишка. Смотрите.
[01:32:28.880 --> 01:32:31.880]  Как бы эти все числа объединяет один факт.
[01:32:31.880 --> 01:32:34.880]  То есть видите, мы подставляем одно и то же WN в степени G, правда?
[01:32:35.880 --> 01:32:38.880]  Но откуда мы взяли эти коэффициенты?
[01:32:38.880 --> 01:32:41.880]  Ну, взяли мы их, наверное,
[01:32:41.880 --> 01:32:44.880]  когда мы взяли вот эту H табличку
[01:32:44.880 --> 01:32:47.880]  и для каждого
[01:32:50.880 --> 01:32:53.880]  в каждом ряду сделали FFT.
[01:32:55.880 --> 01:32:58.880]  Да?
[01:32:58.880 --> 01:33:01.880]  Но тогда оказалось следующее, что
[01:33:01.880 --> 01:33:04.880]  тогда, на самом деле, я утверждаю, что
[01:33:04.880 --> 01:33:07.880]  просто все нужные коэффициенты находятся тупо в G столбце.
[01:33:07.880 --> 01:33:10.880]  Ну, потому что обратите внимание,
[01:33:10.880 --> 01:33:13.880]  что именно здесь находится A0
[01:33:13.880 --> 01:33:16.880]  от WN в степени G.
[01:33:16.880 --> 01:33:19.880]  Ну, потому что тут в этом ряду в принципе находится
[01:33:19.880 --> 01:33:22.880]  A0 от WN в степени 0,
[01:33:22.880 --> 01:33:25.880]  там A0 от WN в степени 1
[01:33:25.880 --> 01:33:28.880]  и так далее.
[01:33:28.880 --> 01:33:31.880]  Ну, просто по определению FFT, правда?
[01:33:31.880 --> 01:33:34.880]  Вот.
[01:33:34.880 --> 01:33:37.880]  Но с другой стороны, тут и A1 получается
[01:33:37.880 --> 01:33:40.880]  WN в степени 0, значит,
[01:33:40.880 --> 01:33:43.880]  тут A1 от WN в степени 1, ну и так далее.
[01:33:43.880 --> 01:33:46.880]  А в G там в столбце A1 от WN в степени G.
[01:33:46.880 --> 01:33:49.880]  То есть получается мистический факт.
[01:33:49.880 --> 01:33:52.880]  То есть, короче говоря, у нас получился многочлен,
[01:33:52.880 --> 01:33:55.880]  коэффициент которого образует тупо в G столбец.
[01:33:55.880 --> 01:33:58.880]  И мы хотим идем сделать FFT.
[01:33:58.880 --> 01:34:01.880]  Но не остается, Лена, то есть тогда получается,
[01:34:01.880 --> 01:34:04.880]  что надо, может быть, просто пройтись по столбцу
[01:34:04.880 --> 01:34:07.880]  и в каждом столбце сделать FFT.
[01:34:07.880 --> 01:34:10.880]  Вот, понимаете, да?
[01:34:10.880 --> 01:34:13.880]  Откуда это взялось, не очень понятно.
[01:34:13.880 --> 01:34:16.880]  В смысле, интуиции нихуй нет.
[01:34:16.880 --> 01:34:19.880]  Ну, вот.
[01:34:19.880 --> 01:34:22.880]  Ну...
[01:34:22.880 --> 01:34:25.880]  А почему?
[01:34:25.880 --> 01:34:28.880]  Ну, по факту мы просто...
[01:34:28.880 --> 01:34:31.880]  Тут даже интуиция просто мы начали аккуратненько
[01:34:31.880 --> 01:34:34.880]  подставлять по одной переменной.
[01:34:34.880 --> 01:34:37.880]  Сначала одну переменную подставить.
[01:34:37.880 --> 01:34:40.880]  Смотри, если в наращение из двух перемен
[01:34:40.880 --> 01:34:43.880]  подставить вместо одной переменной значение,
[01:34:43.880 --> 01:34:46.880]  получится наращение одной переменной, правда?
[01:34:46.880 --> 01:34:49.880]  Вот.
[01:34:49.880 --> 01:34:52.880]  Ну, вот.
[01:34:52.880 --> 01:34:55.880]  Ну, мы, собственно, что такое FFT?
[01:34:55.880 --> 01:34:58.880]  То есть мы в одновременный многочлен подставляем
[01:34:58.880 --> 01:35:01.880]  заданный набор значений, да?
[01:35:01.880 --> 01:35:04.880]  Ну, мы это и сделали.
[01:35:04.880 --> 01:35:07.880]  Ну, тогда если сделать вот такой вот ряд,
[01:35:07.880 --> 01:35:10.880]  в каждом ряду это сделать, то в каждом столбце получится
[01:35:10.880 --> 01:35:13.880]  просто значение... То есть если тут так...
[01:35:13.880 --> 01:35:16.880]  В столбце получается значение всех многочленов
[01:35:17.880 --> 01:35:20.880]  Вот. То есть в ряду находится значение
[01:35:20.880 --> 01:35:23.880]  одного и того же многочлена в разных точках, а столбце
[01:35:23.880 --> 01:35:26.880]  наоборот. Точка одна, многочлены разные.
[01:35:26.880 --> 01:35:29.880]  Вот. Но остается только вспомнить,
[01:35:29.880 --> 01:35:32.880]  что действительно при каких коэффициентах они стояли.
[01:35:32.880 --> 01:35:35.880]  То есть они стояли, когда у вас там х был
[01:35:35.880 --> 01:35:38.880]  разных степеней.
[01:35:38.880 --> 01:35:41.880]  Ну да, тут, конечно, не знаю, какую-нибудь более, может быть,
[01:35:41.880 --> 01:35:44.880]  наглядную интуицию тут сложно предложить.
[01:35:44.880 --> 01:35:47.880]  Вот. Ну, тут, конечно, наглядность, интуиция тут на вкус и цвет.
[01:35:48.880 --> 01:35:51.880]  Вот.
[01:35:51.880 --> 01:35:54.880]  И так. То есть вот действительно получается, что
[01:35:54.880 --> 01:35:57.880]  теперь у нас действительно есть многочлен по х,
[01:35:57.880 --> 01:36:00.880]  теперь мы можем сделать еще и FFT по столбцам.
[01:36:00.880 --> 01:36:03.880]  То есть таким образом мы делаем FFT
[01:36:03.880 --> 01:36:06.880]  сначала по всем рядам, потом
[01:36:06.880 --> 01:36:09.880]  по всем столбцам.
[01:36:09.880 --> 01:36:12.880]  Ну, в принципе, как вы дорадуетесь, можно было сначала
[01:36:12.880 --> 01:36:15.880]  по всем столбцам, потом по всем рядам, суть была бы та же.
[01:36:15.880 --> 01:36:18.880]  Правда?
[01:36:18.880 --> 01:36:21.880]  Потому что подставляли бы в другом порядке.
[01:36:21.880 --> 01:36:24.880]  Вот.
[01:36:24.880 --> 01:36:27.880]  То есть вот такая красота.
[01:36:27.880 --> 01:36:30.880]  Ну, тогда, то есть действительно тогда перемножение,
[01:36:30.880 --> 01:36:33.880]  ну вот, ну тогда получается, если, давайте считать,
[01:36:33.880 --> 01:36:36.880]  за сколько времени это будет?
[01:36:36.880 --> 01:36:39.880]  Ну, по времени получится N умножить на m лог m, это вот
[01:36:39.880 --> 01:36:42.880]  по всем рядам.
[01:36:42.880 --> 01:36:45.880]  И по всем столбцам получается m на
[01:36:45.880 --> 01:36:48.880]  n лог m.
[01:36:48.880 --> 01:36:51.880]  Ну, что такое лог m плюс лог m?
[01:36:51.880 --> 01:36:54.880]  Это лог m. Совершенно верно.
[01:36:54.880 --> 01:36:57.880]  То есть получается в итоге Nm лог Nm.
[01:36:57.880 --> 01:37:00.880]  То есть вот такая вот красота.
[01:37:05.880 --> 01:37:08.880]  Вот. То есть опять, ну, то есть в принципе опять же,
[01:37:08.880 --> 01:37:11.880]  то есть получается количество коэффициентов на логарифам, количество коэффициентов.
[01:37:11.880 --> 01:37:14.880]  Ну, в общем-то, то, что у нас до этого и было.
[01:37:17.880 --> 01:37:20.880]  Ну, теперь понятно, чтобы
[01:37:20.880 --> 01:37:23.880]  реально перемножить 2 многочлен,
[01:37:23.880 --> 01:37:26.880]  ну, конечно же, чтобы реально перемножить 2 многочлены,
[01:37:29.880 --> 01:37:32.880]  вам, конечно, потребуется...
[01:37:32.880 --> 01:37:35.880]  Понятно, что эти Nm
[01:37:35.880 --> 01:37:43.200]  эти nm мысленно там понятно домножить на два раза, потому что вам же еще обратное потом восстанавливать. Правда?
[01:37:43.200 --> 01:37:50.560]  Правда, кстати, возникает интересный вопрос. Действительно, вот, да, на тему того,
[01:37:50.560 --> 01:37:56.080]  почему это правильно, потому что, формально говоря, мы даже не умеем доказывать, что для
[01:37:56.080 --> 01:38:01.480]  двумерного многочлена, то есть размеров nm, то есть значение вот в этих вот точках
[01:38:01.480 --> 01:38:09.280]  действительно его однозначно восстановят. Хотя, насколько мы не умеем это доказывать?
[01:38:09.280 --> 01:38:16.840]  Нет, на самом деле мы сейчас, мы можем прямо сейчас доказать это и очень тупо.
[01:38:16.840 --> 01:38:31.080]  Ну, практически да. То есть просто заметим, что по многочлену мы вот делаем вот эти
[01:38:31.080 --> 01:38:41.000]  действия и получаем значение. Ну вот, но просто приятность в том, что эти действия они обратимы.
[01:38:41.000 --> 01:38:46.560]  То есть просто, дайте бы, один из вариантов, например, там рассказывать fft, на самом деле есть,
[01:38:46.560 --> 01:38:51.320]  это просто давайте, как сделать обратное fft? Давайте посмотрим, что делает прямое fft и заметим,
[01:38:51.320 --> 01:38:56.200]  что все эти действия можно просто в обратном порядке проделать. То есть само по себе это уже,
[01:38:56.680 --> 01:39:03.000]  уже доказательство того, что, то есть как бы, что нам нужно? То есть нам даны значения многочлена в точках,
[01:39:03.000 --> 01:39:08.560]  то есть нам нужно придумать какой-то такой многочлен, по которому вот этот алгоритм выдаст вот это.
[01:39:08.560 --> 01:39:13.600]  Но мы просто обращаем действие, однозначно восстановим многочлен. Это уже само по себе
[01:39:13.600 --> 01:39:20.640]  доказательство получается, что он существует и единственное. То есть просто потому, что у нас
[01:39:20.640 --> 01:39:26.280]  есть обратимый алгоритм. Тут, да, правда, отдельный прикол, да, конечно, тут надо быть внимательными,
[01:39:26.280 --> 01:39:30.480]  да, кажется, что, да, раз выеду сначала по рядам, потом по столбцам, значит и обратное надо
[01:39:30.480 --> 01:39:35.720]  брать. Сначала по столбцам, потом по рядам. Но на самом деле, как вы догадываетесь, если вы обратное
[01:39:35.720 --> 01:39:43.320]  тоже сделаете, сначала по рядам, потом по столбцам, то тоже получите то же самое. Вот. Такой вот локальный
[01:39:43.320 --> 01:39:51.000]  юмор получится. Вот. Так что вот, действительно, вот, то есть теперь вот таким образом получается,
[01:39:51.000 --> 01:40:03.080]  что мы умеем делать двумерное FFT. Ну, на самом деле, ровно таким же образом можно сделать и трехмерное FFT.
[01:40:03.080 --> 01:40:11.760]  Ну, вообще, любое мерное FFT на самом деле так можно сделать. Ну, единственное, возможно, вот, то есть
[01:40:12.000 --> 01:40:17.200]  тоже вот асимптотики там получится тоже там, соответственно, размер таблички, ну, алгоритм размера таблички.
[01:40:17.200 --> 01:40:24.400]  На два стебени размер таблички. Почему? На два стебени количества размерностей. Почему? Потому что когда мы
[01:40:24.400 --> 01:40:33.680]  умножаем, мы забыли табличку два раза расширить. А, да, проблема. Проблема небольшая. Говорят, по дереву Фенрика
[01:40:33.680 --> 01:40:40.440]  тоже забывают что-то на самом деле на два степени. Не, ну, почему не? Когда там камерную табличку, это помнят.
[01:40:40.680 --> 01:40:58.800]  Хотя, да, могут и забыть. Это, да, да, да, да. Нет, это, безусловно. Вот, но, казалось бы, да, казалось бы, маленькая,
[01:40:58.800 --> 01:41:06.840]  действительно приятная штучка. Так, ничего я по ней рассказать не забыл. Нет, вроде ничего. Да, ну, собственно, да.
[01:41:06.840 --> 01:41:11.240]  Ну, сама в себе эта штука действительно простая. Да, вот так вот, многомерное преобразование делается с ней.
[01:41:11.240 --> 01:41:18.080]  Там тоже можно теперь пытаться делать вот эти все задачи с табличками, с трафаретами, но уже в двумерном виде.
[01:41:21.280 --> 01:41:28.120]  Ну, в общем, тут по-разному. Я на всякий случай расскажу, как еще можно было бы, на самом деле, попытаться перемножать два
[01:41:28.120 --> 01:41:42.200]  двумерных многочлена. Вот, то есть на самом деле можно было еще действительно считерить и по многочлену вот такого вида, то есть двумерному, построить многочлен одномерный.
[01:41:42.200 --> 01:41:51.480]  Точно. Мы что делаем? Кто, как где? Я пытался вспомнить, как я решил задачу, о которой нужно было трафарет с таблички искать, и так он сводился к одному.
[01:41:51.480 --> 01:42:20.200]  Вот, да, на самом деле, да, потому что можно как бы вместо AXY, да, то есть можно вот эту сумму AITGT X в степени IY в степени G, то есть можно на самом деле здесь сказать, что это будет сумма AITGT, там какой-нибудь переменный Z в степени I плюс, там, по-моему, два, ну, допустим, два MG, ладно, по барабану, или NG, так, M или N.
[01:42:22.280 --> 01:42:39.400]  Да, лучше N. Ну, N, конечно, N лучше, потому что у нас ишки от нуля до N минус 1. Вот. Да, зачем они нам надо, да? Ну, заметим, что, во-первых, по этому многочлену вот этот вот тоже многочлен восстанавливается, правда? Однозначно.
[01:42:39.400 --> 01:43:04.440]  Ну, теперь самое приятное, что если мы А и Б так сделаем, то тогда в произведении у нас будет что-то типа, значит, AITI1G1, BI2G2 и отправится это все в Z в степень I1 плюс I2 плюс 2N на G1 плюс G2, вот, видите, да?
[01:43:04.440 --> 01:43:17.480]  То есть, когда мы будем перемножать вот этот многочлен, но заметим следующее, что по этой степени действительно I1 плюс I2 и G1 плюс G2 восстанавливаются, правда?
[01:43:17.480 --> 01:43:34.520]  То есть, однозначно. То есть, я по этому Z могу их сыграть. То есть, тогда, поэтому отсюда можно, тогда уже легко как раз увидеть, ну, увидеть вот уже и там, может быть, более аккуратно доказать, что на самом деле как бы перемножаю, то есть, произведение Ашек и Бэшек потом, то есть, на самом деле идентично вот этой штуке.
[01:43:34.520 --> 01:43:48.560]  То есть, на самом деле вот можно вот так развлечься еще. Ну, а можно, соответственно, вот так, типа FFT по строчкам, FFT по столбцам, FFT по вот этому вот, ну или сколько у вас там размерностей.
[01:43:48.560 --> 01:44:10.600]  Вот. Да, казалось бы, это вот простая вещь, но оказывается, с помощью этой штуки на самом деле можно очень неплохо копнуть, потому что сейчас я предложу задачу, которая, на первый взгляд, вообще не как с FFT не связана, вот вообще не при нее.
[01:44:10.600 --> 01:44:36.640]  Ну вот. Ну, как сказать? Ну, хотя, да, про дуэль тоже не очевидно, причем тут FFT, да, согласен. Ну вот. Ну, а сейчас вот прям вообще, по-моему, задача такая, значит, у вас, значит, есть функция.
[01:44:40.600 --> 01:45:09.640]  Функция F. Значит, это функция из множества 2 в степени 0, 1 и так далее, n-1. Ну, допустим, r, не важно куда. Ну, или что то же самое, то есть, обратите внимание, то есть, у меня здесь в качестве параметра практически такие n-битная масочка.
[01:45:09.680 --> 01:45:27.680]  Ну, или просто под множество элементов. Вот. То есть, какая функция абсолютно произвольная? Ну, просто набор 2 в степенье значений. Так вот, я хочу делать, ну, и у меня еще функция g есть вот такая.
[01:45:27.680 --> 01:45:56.720]  Так вот. Значит, я хочу сделать мистическую функцию. Я хочу сделать вот такую же функцию, только при этом я хочу следующее, что h от какой-нибудь масочки у меня должен быть равен.
[01:45:57.720 --> 01:46:15.720]  В сумме f от m1, значит, на g от m2, где m1 it m2 равно m.
[01:46:15.760 --> 01:46:30.760]  Ну, я почему тут пишу it, потому что в качестве it я хочу подставить or and xor.
[01:46:30.800 --> 01:46:45.800]  Так, и как же предлагается делать or? Какой?
[01:46:45.840 --> 01:46:49.840]  Это, ну, шо, шо, я хотел только вспомнить, что это.
[01:46:51.840 --> 01:46:56.840]  Ну, вот. Да, казалось бы, да. Все больше удар. Для конкретно ora кто-то, возможно, даже задает решение.
[01:46:57.840 --> 01:47:03.840]  Да, потому что последний, ну, я, ну, впрочем, я даже его упоминал, потому что это знаменитая sum over subset.
[01:47:05.840 --> 01:47:08.840]  Вот. Значит, давайте внимательно смотреть.
[01:47:11.840 --> 01:47:12.840]  Так.
[01:47:15.840 --> 01:47:16.840]  Давайте.
[01:47:17.840 --> 01:47:19.840]  Так, на что нам тут внимательно смотреть?
[01:47:20.840 --> 01:47:21.840]  Значит.
[01:47:24.840 --> 01:47:25.840]  Так.
[01:47:28.840 --> 01:47:29.840]  Ой, еще махер есть. Круто.
[01:47:30.840 --> 01:47:32.840]  Вот. Значит, смотрите. Внимательно.
[01:47:33.840 --> 01:47:39.840]  Так, ну, во-первых, да. Ну, начнем с того, кстати, что or and на самом деле достаточно похожие задачи, правда?
[01:47:39.880 --> 01:47:48.880]  Да, как можно заметить, что если вы там пытаетесь решать задачу для and, то вы во всех масках можете инвертировать биты и and превратиться в or, правда?
[01:47:50.880 --> 01:47:55.880]  Поэтому, в общем-то, с идейной точки зрения and можно не рассматривать.
[01:47:56.880 --> 01:47:58.880]  Теперь давайте смотреть.
[01:48:01.880 --> 01:48:03.880]  Я сказал, давайте смотреть.
[01:48:04.880 --> 01:48:06.880]  Итак, давайте смотреть or.
[01:48:06.920 --> 01:48:11.920]  Значит, местицизм тут предлагается такой.
[01:48:12.920 --> 01:48:22.920]  Значит, предлагается взять f, такую, то есть по функции f маленькая, то есть так, причем тут fft, да?
[01:48:23.920 --> 01:48:25.920]  Ну, так и есть вот, как бы, до легком уровне.
[01:48:26.920 --> 01:48:27.920]  Значит, объяснение, значит, такое.
[01:48:28.920 --> 01:48:31.920]  Давайте по функции f построим функцию f большое.
[01:48:33.920 --> 01:48:35.920]  Вот такую вот.
[01:48:36.920 --> 01:48:52.920]  И скажу я следующее, что f от m это сумма f от m' по всем m', так сказать, под маском m.
[01:48:55.920 --> 01:48:57.920]  Да, поэтому это называется sosdp.
[01:48:58.920 --> 01:49:00.920]  Потому что sum over subsets.
[01:49:00.960 --> 01:49:08.960]  Собственно, sum sum over subsets.
[01:49:11.960 --> 01:49:13.960]  Ну вот, по-морскому sos, да.
[01:49:15.960 --> 01:49:16.960]  Вот.
[01:49:17.960 --> 01:49:19.960]  Это страшная картинка, да.
[01:49:20.960 --> 01:49:26.960]  Как-то знаете, что такое sos, по-морскому sos должен четко и всегда знать любой матрос.
[01:49:27.960 --> 01:49:28.960]  Это точно капитан.
[01:49:29.000 --> 01:49:34.000]  Конечно, капитан можно отвечать и воспроизводит ему вот это, да.
[01:49:35.000 --> 01:49:40.000]  Вот, значит, спрашивается, зачем нам это?
[01:49:42.000 --> 01:49:46.000]  Так вот, мистическое утверждение.
[01:49:50.000 --> 01:49:52.000]  Значит, мистическое утверждение.
[01:49:59.000 --> 01:50:02.000]  G тоже большим стало?
[01:50:03.000 --> 01:50:05.000]  Да, и f, и h.
[01:50:06.000 --> 01:50:07.000]  А h-то да.
[01:50:08.000 --> 01:50:10.000]  Ну, понятно, что я...
[01:50:12.000 --> 01:50:21.000]  Ну, смотрите, g это просто функция, а h, давайте мы вот у этого безобразия тоже, у него существует его большой аналог.
[01:50:22.000 --> 01:50:24.000]  Так вот, есть такая мистическая функция.
[01:50:24.040 --> 01:50:26.040]  Это g, она тоже большая или нет?
[01:50:27.040 --> 01:50:28.040]  Да.
[01:50:31.040 --> 01:50:33.040]  Нет, ну вы по хвостику-то не ориентируетесь.
[01:50:34.040 --> 01:50:36.040]  Маленькая вот, большая вот.
[01:50:41.040 --> 01:50:43.040]  Обычно мы просто внутрь загибаем, и все.
[01:50:44.040 --> 01:50:46.040]  Нет, ну смотрите, нет, ладно, вот так.
[01:50:47.040 --> 01:50:50.040]  Вот это маленькая, а вот это большое, видите?
[01:50:51.040 --> 01:50:52.040]  Ладно.
[01:50:52.080 --> 01:50:54.080]  Вот в этом равенство, да.
[01:50:57.080 --> 01:50:58.080]  Ну да, да, да, как это?
[01:50:59.080 --> 01:51:01.080]  Нет, понятно, это да, это обычные 100 долларов.
[01:51:02.080 --> 01:51:04.080]  Потом достаем такой огромный лист, а это фальшивка.
[01:51:05.080 --> 01:51:09.080]  Там на ней нет водяных знаков, ее с трудом принимают банкоматы и все такое.
[01:51:10.080 --> 01:51:12.080]  Ладно, ну давайте посмотрим.
[01:51:14.080 --> 01:51:15.080]  Что же это?
[01:51:16.080 --> 01:51:19.080]  Вот откуда-то с небес по факсу нам прислали вот такое равенство.
[01:51:19.120 --> 01:51:20.120]  Вот ворону.
[01:51:21.120 --> 01:51:23.120]  Или там это, вороня где-то бог послал вот это вот.
[01:51:24.120 --> 01:51:25.120]  Вот.
[01:51:26.120 --> 01:51:28.120]  Ну вот, ну и конечно ворона хочет проверить, что это ей прислали.
[01:51:29.120 --> 01:51:31.120]  Ну давайте думать, что такое f от m и g от m.
[01:51:34.120 --> 01:51:35.120]  Так.
[01:51:36.120 --> 01:51:37.120]  Ну давайте все-таки проверим.
[01:51:38.120 --> 01:51:46.120]  Значит, сумма, значит тут f от m штрих на g от m два штриха.
[01:51:46.160 --> 01:51:47.160]  То есть тупо сумма по всем подмаскам.
[01:51:48.160 --> 01:51:49.160]  Видим, да?
[01:51:50.160 --> 01:51:51.160]  По всем парам подмасок.
[01:51:52.160 --> 01:51:53.160]  По всем парам подмасок.
[01:51:54.160 --> 01:51:55.160]  M-ки, да?
[01:51:56.160 --> 01:51:58.160]  Где обманывается условие, что m1 нужно m2 это m?
[01:51:59.160 --> 01:52:00.160]  Нигде пока что.
[01:52:01.160 --> 01:52:02.160]  Пока нигде.
[01:52:03.160 --> 01:52:05.160]  Пока я просто сказал, что f от m, g от m равно вот этой штуке.
[01:52:06.160 --> 01:52:07.160]  Больше я ничего не сказал.
[01:52:08.160 --> 01:52:09.160]  Но я могу теперь это перформулировать.
[01:52:10.160 --> 01:52:14.160]  То есть я перебираю такие пары подмасок, что каждый из этих паров,
[01:52:14.200 --> 01:52:19.200]  что каждый из этих подмасок является подмаской m.
[01:52:20.200 --> 01:52:25.200]  Но есть мистическое, но теперь есть еще одно мистическое, заметим, шо.
[01:52:26.200 --> 01:52:31.200]  Мы заметим, что две подмаски являются подмаской м,
[01:52:32.200 --> 01:52:40.200]  тогда и только тогда, когда m-штрих or m2-штриха является подмаской m.
[01:52:44.200 --> 01:52:56.200]  Поэтому получается, что я могу тогда это записать в виде просто вот суммы f от m-штрих g от m2-штриха.
[01:52:57.200 --> 01:53:05.200]  То есть я просто перебираю такие, что m-штрих or m2-штриха является подмаской m.
[01:53:06.200 --> 01:53:08.200]  Но это уже просто по определению h от m.
[01:53:08.240 --> 01:53:14.240]  То есть вот типичный пример ситуации, когда непонятно,
[01:53:15.240 --> 01:53:22.240]  когда вообще непонятно, с каких небес по факсу нам это прислали, но как говорится, проверить легко, но налицо.
[01:53:25.240 --> 01:53:31.240]  Но тогда, смотрите, но тогда мы можем просто сделать ровно ту же технологию,
[01:53:31.280 --> 01:53:38.280]  что и делали fft, то есть я превращаю, превратим f в f большое, g в g большое,
[01:53:39.280 --> 01:53:43.280]  тогда значит потом h построим вот так вот за 2 в степени n,
[01:53:44.280 --> 01:53:49.280]  а потом по h большому построим h маленькое.
[01:53:51.280 --> 01:53:53.280]  Вот такая штука.
[01:53:54.280 --> 01:53:57.280]  Теперь внимание, вопрос, как же это сделать?
[01:53:58.280 --> 01:54:00.280]  Как превратить f маленькое в f большое?
[01:54:01.280 --> 01:54:03.280]  Говори в степени n.
[01:54:06.280 --> 01:54:08.280]  О, точно, да.
[01:54:09.280 --> 01:54:13.280]  А, правда, еще надо обсудить тогда, как перебирать все подмаски за 3 в степени n.
[01:54:14.280 --> 01:54:19.280]  А, ну да, хотя можно сейчас обсудить, можно обсудить, когда мы будем обсуждать dp по профилю.
[01:54:20.280 --> 01:54:23.280]  Но обычно у меня это просто в этом месте происходит.
[01:54:26.280 --> 01:54:29.280]  Ну хотя это и неважно, потому что все равно это 3 в степени n это не та штука,
[01:54:29.320 --> 01:54:31.320]  которая нас здесь будет удовлетворять.
[01:54:34.320 --> 01:54:43.320]  Итак, как же превратить f в f?
[01:54:43.360 --> 01:54:44.360]  f
[01:54:48.360 --> 01:54:54.360]  Ну давайте dp it gt это...
[01:54:55.360 --> 01:54:57.360]  Может все-таки mask, mask gt?
[01:54:58.360 --> 01:54:59.360]  Ну да.
[01:54:59.360 --> 01:55:01.360]  Давайте вот все-таки.
[01:55:02.360 --> 01:55:07.360]  Так, dp mask gt, g у нас видимо от 0 до n будет,
[01:55:08.360 --> 01:55:09.360]  mask, ну mask понятно.
[01:55:09.400 --> 01:55:10.400]  Шет такое.
[01:55:13.400 --> 01:55:15.400]  Вот как бы это, давай как это определить.
[01:55:16.400 --> 01:55:35.400]  Это сумма по всем f маленькая от чего-то,
[01:55:35.440 --> 01:55:41.440]  что является, что напреки все длины g является подмаской маски.
[01:55:42.440 --> 01:55:43.440]  Шет такое.
[01:55:44.440 --> 01:55:45.440]  Шет не точно.
[01:55:48.440 --> 01:55:49.440]  Вот давайте аккуратнее.
[01:55:50.440 --> 01:55:51.440]  А дальше нули, давайте так.
[01:55:52.440 --> 01:55:53.440]  Нули, да ладно.
[01:55:54.440 --> 01:55:56.440]  Не, ну не знаю, по-моему может попроще.
[01:55:57.440 --> 01:56:01.440]  Пусть у нас m, значит суммируем по всем подмаскам маски,
[01:56:02.440 --> 01:56:04.440]  таким что первые.
[01:56:05.440 --> 01:56:12.440]  g bit у m и mask совпадают.
[01:56:17.440 --> 01:56:19.440]  Вот, такая вот красота.
[01:56:24.440 --> 01:56:26.440]  То есть вот введем такую dp.
[01:56:27.440 --> 01:56:30.440]  Ну во-первых заметим, что, ну тут немножко такой обратность
[01:56:30.480 --> 01:56:36.480]  получилось, потому что заметим, что dp от mask нулевое,
[01:56:37.480 --> 01:56:39.480]  это в точности что?
[01:56:42.480 --> 01:56:43.480]  Это то, что мы хотели.
[01:56:44.480 --> 01:56:47.480]  Да, то есть f большое от маски.
[01:56:48.480 --> 01:56:52.480]  Но с другой стороны, d, все буквально с другой стороны,
[01:56:53.480 --> 01:56:57.480]  f от маски n равно наоборот f от маски.
[01:56:57.520 --> 01:57:02.520]  То есть переберем все подмаски, у которых совпадают n bit.
[01:57:03.520 --> 01:57:06.520]  А у нас всего n bit, так что получается ровная f от маски.
[01:57:07.520 --> 01:57:10.520]  То есть поэтому получается, что нам бы хочется уметь как-то
[01:57:11.520 --> 01:57:13.520]  насчитывать dp, как-нибудь так это,
[01:57:14.520 --> 01:57:17.520]  возможно как-то перечислить справа налево, слева направо.
[01:57:18.520 --> 01:57:19.520]  Как раз вот перегонять.
[01:57:20.520 --> 01:57:22.520]  Но нам, ладно, чтобы получить из этого f это f,
[01:57:23.520 --> 01:57:26.520]  нам придется, это редкий случай, идти от n до нуля.
[01:57:27.520 --> 01:57:33.520]  Но давайте думать, как же это сделать?
[01:57:46.520 --> 01:57:47.520]  Так, нет, это понятно, да.
[01:57:48.520 --> 01:57:51.520]  Да, ну это понятно, да.
[01:57:52.520 --> 01:57:53.520]  Ладно, давай так и напишу, хорошо.
[01:57:53.560 --> 01:58:00.560]  0, for там маск, от нуля, то 2 в степень n минус 1, и что?
[01:58:01.560 --> 01:58:13.560]  dp, маск gt, равно dp, маск g минус первое.
[01:58:14.560 --> 01:58:15.560]  Минус первое?
[01:58:16.560 --> 01:58:17.560]  Плюс первое.
[01:58:17.600 --> 01:58:18.600]  Вот.
[01:58:19.600 --> 01:58:20.600]  Так.
[01:58:22.600 --> 01:58:23.600]  Ага.
[01:58:24.600 --> 01:58:26.600]  Плюс dp, маск, что-то.
[01:58:27.600 --> 01:58:28.600]  Ой-ой-ой.
[01:58:29.600 --> 01:58:30.600]  Не-не.
[01:58:31.600 --> 01:58:35.600]  Ну да не, кто-то так торопишься, спокойно.
[01:58:36.600 --> 01:58:37.600]  Смотрите.
[01:58:38.600 --> 01:58:39.600]  Итак, вы зафиксировали первое g bit, да?
[01:58:40.600 --> 01:58:41.600]  Да.
[01:58:42.600 --> 01:58:43.600]  Мы идем справа налево, но теперь смотрите,
[01:58:43.640 --> 01:58:46.640]  мы можем попытаться, раз мы первое g bit зафиксировали,
[01:58:47.640 --> 01:58:48.640]  0, 1 и так далее, вот g минус 1.
[01:58:49.640 --> 01:58:52.640]  Можем попытаться зафиксировать и g-ты, правда?
[01:58:53.640 --> 01:58:54.640]  Ну вот.
[01:58:55.640 --> 01:58:58.640]  Зафиксировать и g-ты, тогда у нас будет g плюс 1 bit зафиксирован.
[01:58:59.640 --> 01:59:02.640]  Мы его можем зафиксировать не более чем двумя способами.
[01:59:03.640 --> 01:59:05.640]  Потому что мы можем зафиксировать, что он 0,
[01:59:06.640 --> 01:59:10.640]  и иногда, если с маской повезет, можно зафиксировать, что он 1, правда?
[01:59:11.640 --> 01:59:12.640]  Да.
[01:59:13.640 --> 01:59:14.640]  Вот.
[01:59:16.640 --> 01:59:17.640]  Ну вот.
[01:59:18.640 --> 01:59:19.640]  Ну вот.
[01:59:20.640 --> 01:59:24.640]  Ну действительно, если он 0, то на самом деле просто надо вот так скопировать и все.
[01:59:25.640 --> 01:59:26.640]  Вот.
[01:59:27.640 --> 01:59:28.640]  То есть я могу написать так.
[01:59:29.640 --> 01:59:30.640]  То есть я могу так.
[01:59:31.640 --> 01:59:34.640]  Если маск, если g-ты bit там есть,
[01:59:35.640 --> 01:59:37.640]  ну я чаще всего пишу вот таким вот образом.
[01:59:38.640 --> 01:59:39.640]  Вы скорее всего пишете другим.
[01:59:40.640 --> 01:59:41.640]  Вот.
[01:59:41.680 --> 01:59:42.680]  Ну вот.
[01:59:43.680 --> 01:59:44.680]  Ну неважно.
[01:59:45.680 --> 01:59:49.680]  Так, то dp маск g-ты будет плюс равно dp.
[01:59:56.680 --> 01:59:57.680]  Ну вот, маск.
[01:59:58.680 --> 02:00:01.680]  А, можно даже так, тут конечно немножко запутано получилось,
[02:00:02.680 --> 02:00:03.680]  но можно и так.
[02:00:06.680 --> 02:00:07.680]  Во.
[02:00:08.680 --> 02:00:09.680]  Вот такая красота.
[02:00:09.720 --> 02:00:10.720]  Да.
[02:00:11.720 --> 02:00:13.720]  То есть как бы, смотрите, зафиксировать ту же масочку,
[02:00:14.720 --> 02:00:16.720]  то есть тот же bit, который есть, это всегда святое дело,
[02:00:17.720 --> 02:00:20.720]  но если это bit еще единичка, то тогда я могу его и обнулить.
[02:00:21.720 --> 02:00:22.720]  И тогда тоже к ответу прибавить.
[02:00:24.720 --> 02:00:27.720]  Более того, это преобразование чаще всего,
[02:00:28.720 --> 02:00:29.720]  ну вот,
[02:00:30.720 --> 02:00:34.720]  то есть это преобразование на самом деле чаще всего даже пишут не вот в таком двумерном массиве,
[02:00:35.720 --> 02:00:36.720]  а даже в одномерном.
[02:00:39.720 --> 02:00:43.720]  Ну потому что, это мы с вами определили dp скорее для математических целей,
[02:00:44.720 --> 02:00:49.720]  потому что на самом деле выполнить это преобразование я могу прекрасно и в одномерном массиве на самом деле.
[02:00:50.720 --> 02:00:51.720]  А, типа за римми памяти.
[02:00:52.720 --> 02:00:53.720]  Да.
[02:00:54.720 --> 02:00:57.720]  Ну да, то есть там будет еще такой мега сжатый код,
[02:00:58.720 --> 02:01:00.720]  то есть что-то for g равно n-1 до нуля,
[02:01:01.720 --> 02:01:04.720]  хотя, кстати, по барабану в каком порядке биты перебирать на самом деле будет.
[02:01:04.760 --> 02:01:05.760]  Дальше for,
[02:01:06.760 --> 02:01:10.760]  значит, mask равно от нуля до 2 в степени n-1,
[02:01:11.760 --> 02:01:17.760]  значит, мы говорим, что если mask n-1 хресь-хресь g,
[02:01:18.760 --> 02:01:24.760]  то dp масковое plus равно
[02:01:26.760 --> 02:01:30.760]  dp от mask
[02:01:30.800 --> 02:01:34.800]  mask минус 1 хресь-хресь g.
[02:01:36.800 --> 02:01:39.800]  То есть вот на самом деле в одном массиве это вообще вот так пишется.
[02:01:41.800 --> 02:01:44.800]  Красный маркер, жалко, пишет не очень, но
[02:01:46.800 --> 02:01:47.800]  суть такая.
[02:01:48.800 --> 02:01:52.800]  Но это мы превратили, это мы как бы отсюда-сюда прошлись.
[02:01:54.800 --> 02:01:56.800]  Но теперь заметим маленькую приятную вещь.
[02:01:56.840 --> 02:02:01.840]  Что нам нужно поменять в этом коде, чтобы пробег получился в обратную сторону?
[02:02:04.840 --> 02:02:08.840]  Ну вот, в идеале по-хорошему надо тут, конечно,
[02:02:09.840 --> 02:02:11.840]  для обратности написать от нуля до n-1,
[02:02:12.840 --> 02:02:13.840]  и тут вместо плюса написать минус.
[02:02:14.840 --> 02:02:16.840]  Но на самом деле, так как в каком порядке биты перебирать по барабану,
[02:02:17.840 --> 02:02:19.840]  то на самом деле вот этого можно не делать.
[02:02:20.840 --> 02:02:23.840]  То есть опять же, видите, прямое от обратного отличается только тем,
[02:02:23.880 --> 02:02:26.880]  что там вы плюс заменили буквально.
[02:02:29.880 --> 02:02:31.880]  То есть вот таким вот образом,
[02:02:34.880 --> 02:02:36.880]  вот таким вот образом
[02:02:37.880 --> 02:02:41.880]  у нас получилось OA2 в степени n на n.
[02:02:46.880 --> 02:02:48.880]  Да, то есть в принципе достаточно известная,
[02:02:48.920 --> 02:02:50.920]  то есть она вот, особенно если,
[02:02:51.920 --> 02:02:53.920]  то есть если так глубже не копать,
[02:02:54.920 --> 02:02:55.920]  то в принципе вот такая вот простая вещь,
[02:02:56.920 --> 02:02:58.920]  то есть периодически в задачах вот подсолвывают.
[02:02:59.920 --> 02:03:01.920]  То есть дальше там начинаются какие-то словосочетания,
[02:03:02.920 --> 02:03:06.920]  потому что, как бы, дай бог мне не ошибиться,
[02:03:07.920 --> 02:03:11.920]  но вообще это даже в науке может называться как свертка волша Адамара, кстати.
[02:03:14.920 --> 02:03:15.920]  А это не анаксвор?
[02:03:15.960 --> 02:03:17.960]  А может анаксвор?
[02:03:18.960 --> 02:03:19.960]  Хорошо.
[02:03:20.960 --> 02:03:22.960]  Ладно, ну для OR тоже есть, не важно.
[02:03:23.960 --> 02:03:25.960]  Так вот, но на самом деле,
[02:03:26.960 --> 02:03:28.960]  почему эта штука рассматривается именно здесь?
[02:03:29.960 --> 02:03:31.960]  Потому что у нас цель такая,
[02:03:32.960 --> 02:03:34.960]  мы собственно копнем, а откуда она вообще взялась?
[02:03:37.960 --> 02:03:41.960]  Ну да, просто заметим, что вот так вот делается.
[02:03:42.000 --> 02:03:43.000]  Вот.
[02:03:44.000 --> 02:03:45.000]  Вот.
[02:03:46.000 --> 02:03:47.000]  Но на самом деле, да,
[02:03:48.000 --> 02:03:49.000]  как это называется, казалось бы,
[02:03:50.000 --> 02:03:52.000]  при чем тут многомерное преобразование фурье, да?
[02:03:53.000 --> 02:03:55.000]  Так вот, на самом деле это оно.
[02:03:58.000 --> 02:04:00.000]  Значит, давайте смотреть внимательно где.
[02:04:02.000 --> 02:04:03.000]  Вот.
[02:04:04.000 --> 02:04:06.000]  Ну а для этого, может быть, давайте время,
[02:04:07.000 --> 02:04:09.000]  да, вот мы помним, какое-то такое решение динамика есть,
[02:04:10.000 --> 02:04:11.000]  какая-то такая мистика есть,
[02:04:12.000 --> 02:04:13.000]  может быть.
[02:04:22.000 --> 02:04:23.000]  Так.
[02:04:29.000 --> 02:04:30.000]  Значит, это мы все убираем.
[02:04:31.000 --> 02:04:32.000]  Давайте просто себе представим,
[02:04:33.000 --> 02:04:36.000]  что мы пытаемся проделать вот это вот.
[02:04:36.040 --> 02:04:37.040]  Вот.
[02:04:41.040 --> 02:04:44.040]  Но для этого мы попытаемся подумать вот о чем.
[02:04:45.040 --> 02:04:49.040]  То есть мы можем попытаться подумать об F и G
[02:04:50.040 --> 02:04:51.040]  как,
[02:04:52.040 --> 02:04:55.040]  ну, что-то типа о многочленах.
[02:04:56.040 --> 02:04:58.040]  О многочленах,
[02:04:59.040 --> 02:05:00.040]  о темпераменах.
[02:05:01.040 --> 02:05:03.040]  То есть вот такое вот буголга.
[02:05:03.080 --> 02:05:04.080]  Да.
[02:05:05.080 --> 02:05:07.080]  То есть представить себе, что у нас есть вот такая
[02:05:08.080 --> 02:05:12.080]  фактически функция F от x1, x2, x3 и так далее, xn.
[02:05:13.080 --> 02:05:17.080]  Что приятно по каждой переменной степени более чем 1.
[02:05:19.080 --> 02:05:20.080]  Вот, удобно, правда?
[02:05:21.080 --> 02:05:22.080]  Тогда, в принципе,
[02:05:23.080 --> 02:05:24.080]  но теперь заметим,
[02:05:25.080 --> 02:05:28.080]  тогда, теперь, как можно было бы вообще-то пытаться решать эту задачу?
[02:05:29.080 --> 02:05:30.080]  Можно было пытаться ее решать,
[02:05:30.120 --> 02:05:33.120]  но вот так, что вот у нас вот есть F такая функция,
[02:05:34.120 --> 02:05:35.120]  есть G вот такой многочлен,
[02:05:36.120 --> 02:05:39.120]  и можем попытаться найти произведение.
[02:05:40.120 --> 02:05:41.120]  Назовем его,
[02:05:42.120 --> 02:05:43.120]  как мы его назовем?
[02:05:44.120 --> 02:05:45.120]  Да, вот так лучше не называть.
[02:05:46.120 --> 02:05:47.120]  Давайте, как там?
[02:05:48.120 --> 02:05:49.120]  Давайте, назовем его C.
[02:05:51.120 --> 02:05:54.120]  Ну, просто раз мы всегда произведение C называем, правда?
[02:05:57.120 --> 02:05:58.120]  Ну, вот.
[02:05:58.160 --> 02:06:01.160]  Ну, заметим, что, конечно, почему я писал C?
[02:06:01.160 --> 02:06:04.160]  Потому что C, конечно, многочлену соответствующему H
[02:06:05.160 --> 02:06:07.160]  ни в коем случае не равен, согласны?
[02:06:10.160 --> 02:06:11.160]  Вот.
[02:06:12.160 --> 02:06:14.160]  То есть, Боже упаси, ни в коем случае не равен.
[02:06:16.160 --> 02:06:18.160]  Но мы можем заметить,
[02:06:19.160 --> 02:06:21.160]  что по крайней мере по многочлену C
[02:06:22.160 --> 02:06:23.160]  многочлен H
[02:06:24.160 --> 02:06:27.160]  можно однозначно восстановить, правда?
[02:06:28.160 --> 02:06:29.160]  Просто?
[02:06:30.160 --> 02:06:31.160]  Пока нет.
[02:06:32.160 --> 02:06:33.160]  Пока нет.
[02:06:34.160 --> 02:06:35.160]  Ну, смотрите.
[02:06:36.160 --> 02:06:37.160]  Вот, допустим, тут у нас было
[02:06:38.160 --> 02:06:42.160]  что-нибудь типа 5х1х3х4,
[02:06:43.160 --> 02:06:47.160]  а тут было, допустим, 7х2х4х8.
[02:06:48.160 --> 02:06:49.160]  Допустим.
[02:06:50.160 --> 02:06:53.160]  Тогда произведение этих маномов,
[02:06:54.160 --> 02:06:55.160]  тогда, смотрите,
[02:06:55.200 --> 02:06:57.200]  тогда в произведение масочек
[02:06:58.200 --> 02:07:00.200]  это должно было отправиться в
[02:07:01.200 --> 02:07:06.200]  что-то типа 35х1х2х3х4х8.
[02:07:07.200 --> 02:07:08.200]  Ну, такая масочка.
[02:07:09.200 --> 02:07:10.200]  Нет, это в произведении многочленов.
[02:07:11.200 --> 02:07:12.200]  Ну, хорошо, да, ладно.
[02:07:12.200 --> 02:07:13.200]  В произведении многочленов, да,
[02:07:13.200 --> 02:07:15.200]  вот если перемножить эти маномы, получится так.
[02:07:16.200 --> 02:07:18.200]  Но, с другой стороны, это соответствовало масочке
[02:07:19.200 --> 02:07:21.200]  что-то типа 1011000,
[02:07:22.200 --> 02:07:24.200]  а это соответствует масочке
[02:07:24.240 --> 02:07:26.240]  01000001.
[02:07:27.240 --> 02:07:29.240]  И тогда этот Орик бы соответствовал
[02:07:30.240 --> 02:07:34.240]  масочке 1 11110001.
[02:07:35.240 --> 02:07:36.240]  Да?
[02:07:37.240 --> 02:07:38.240]  Ну, тогда, смотрите.
[02:07:39.240 --> 02:07:40.240]  Заметьте, что приятность.
[02:07:41.240 --> 02:07:42.240]  То есть в чем разница?
[02:07:43.240 --> 02:07:44.240]  Разница в том, что тут две единички
[02:07:45.240 --> 02:07:46.240]  превращаются в единичку,
[02:07:47.240 --> 02:07:48.240]  а тут две единички в степени
[02:07:49.240 --> 02:07:50.240]  превращаются в двоечку, правда?
[02:07:51.240 --> 02:07:52.240]  Ну, с другой стороны, видите,
[02:07:52.280 --> 02:07:53.280]  ничего страшного в этом нет
[02:07:54.280 --> 02:07:55.280]  само по себе,
[02:07:56.280 --> 02:07:57.280]  потому что двоечка,
[02:07:58.280 --> 02:07:59.280]  что такое двоечка вообще?
[02:08:00.280 --> 02:08:01.280]  То есть вы замечаете, что
[02:08:02.280 --> 02:08:03.280]  на самом деле по маному,
[02:08:04.280 --> 02:08:05.280]  который у нас в произведении получится,
[02:08:06.280 --> 02:08:07.280]  мы можем легко понять,
[02:08:08.280 --> 02:08:09.280]  чему он соответствует, правда?
[02:08:10.280 --> 02:08:11.280]  Ну, да.
[02:08:12.280 --> 02:08:13.280]  Потому что по большому счету, да,
[02:08:14.280 --> 02:08:15.280]  то есть чтобы из манома и степени получить масочку,
[02:08:16.280 --> 02:08:17.280]  надо просто двойки на единицы занять, правда?
[02:08:18.280 --> 02:08:19.280]  Так что такая вот маленькая,
[02:08:20.280 --> 02:08:21.280]  приятная вещь.
[02:08:22.280 --> 02:08:23.280]  Но я не говорю, что
[02:08:24.280 --> 02:08:25.280]  может быть где-то по произведению
[02:08:26.280 --> 02:08:27.280]  достаточно легко было бы это восстановить.
[02:08:28.280 --> 02:08:29.280]  Единственная проблема,
[02:08:30.280 --> 02:08:31.280]  что произведение
[02:08:32.280 --> 02:08:33.280]  считается долго.
[02:08:34.280 --> 02:08:35.280]  То есть если мы сейчас с вами
[02:08:36.280 --> 02:08:37.280]  забабахаем
[02:08:38.280 --> 02:08:39.280]  n-мердное преобразование фурье
[02:08:40.280 --> 02:08:41.280]  в этом месте,
[02:08:42.280 --> 02:08:43.280]  то какая у нас там
[02:08:44.280 --> 02:08:45.280]  симпатика получится?
[02:08:48.280 --> 02:08:49.280]  Да, нормально.
[02:08:49.320 --> 02:08:50.320]  Да.
[02:08:51.320 --> 02:08:52.320]  Да.
[02:08:55.320 --> 02:08:56.320]  Да, в степени 1n.
[02:08:57.320 --> 02:08:58.320]  Угу.
[02:08:59.320 --> 02:09:00.320]  Все.
[02:09:01.320 --> 02:09:02.320]  Если бы на жод нуалэ,
[02:09:03.320 --> 02:09:04.320]  помните, что для перемножения многочленов
[02:09:05.320 --> 02:09:07.320]  у нас по каждой размерности в два раза надо умножить, да?
[02:09:08.320 --> 02:09:09.320]  Четырех степенен.
[02:09:10.320 --> 02:09:11.320]  Вот вы же и замечали,
[02:09:12.320 --> 02:09:13.320]  помнится кто-то из вас, да,
[02:09:14.320 --> 02:09:15.320]  что в фенвике мы что-то тут два степенен,
[02:09:16.320 --> 02:09:17.320]  лишь не забываем, да?
[02:09:17.360 --> 02:09:18.360]  Да.
[02:09:19.360 --> 02:09:20.360]  Просто так не получится,
[02:09:21.360 --> 02:09:22.360]  поэтому в тупую это получится 4 степени n,
[02:09:23.360 --> 02:09:24.360]  а на самом деле вон можно было уже 4 степени n
[02:09:25.360 --> 02:09:26.360]  и не заморять.
[02:09:27.360 --> 02:09:28.360]  Вот теперь давайте думать,
[02:09:29.360 --> 02:09:30.360]  как это можно оптимизировать?
[02:09:47.360 --> 02:09:48.360]  Ну хотелось.
[02:09:49.360 --> 02:09:50.360]  Нет, ну на самом деле тут две оптимизации.
[02:09:51.360 --> 02:09:52.360]  Одна тупая, одна умная.
[02:09:54.360 --> 02:09:55.360]  Вот есть одна тупая оптимизация,
[02:09:56.360 --> 02:09:57.360]  которая 4 в степенен нам сократит.
[02:09:58.360 --> 02:09:59.360]  Получим просто 1n.
[02:10:00.360 --> 02:10:01.360]  Нет.
[02:10:02.360 --> 02:10:03.360]  Ладно, подсказка.
[02:10:04.360 --> 02:10:05.360]  Она получит 3 в степенен.
[02:10:06.360 --> 02:10:07.360]  Получим 3 в степенен.
[02:10:12.360 --> 02:10:13.360]  Нет.
[02:10:14.360 --> 02:10:15.360]  Нет.
[02:10:16.360 --> 02:10:17.360]  Нет.
[02:10:18.360 --> 02:10:19.360]  Нет, нет.
[02:10:20.360 --> 02:10:21.360]  Да.
[02:10:22.360 --> 02:10:24.360]  Да, Лена умная.
[02:10:25.360 --> 02:10:26.360]  Не processed.
[02:10:27.360 --> 02:10:28.360]  Не run.
[02:10:29.360 --> 02:10:30.360]  Не run.
[02:10:30.360 --> 02:10:31.360]  Не run.
[02:10:32.360 --> 02:10:33.360]  Не run.
[02:10:34.360 --> 02:10:35.360]  Не run.
[02:10:36.360 --> 02:10:37.360]  Не run.
[02:10:38.360 --> 02:10:39.360]  Мы можем взять,
[02:10:40.360 --> 02:10:41.360]  перебрать
[02:10:42.360 --> 02:10:43.360]  все 2 separately.
[02:10:43.360 --> 02:11:11.360]  а не из подмасок, а из структуры f of t.
[02:11:12.360 --> 02:11:15.360]  А из структуры f of t. Откуда? Вот давайте так.
[02:11:15.360 --> 02:11:18.360]  В f of t у нас откуда 4 степени n принялось?
[02:11:20.360 --> 02:11:23.360]  Да, то есть мы как бы увеличили в два раза.
[02:11:23.360 --> 02:11:25.360]  А теперь у нас есть вопрос.
[02:11:25.360 --> 02:11:28.360]  А зачем мы всегда увеличиваем в два раза?
[02:11:30.360 --> 02:11:34.360]  Ну да, потому что размер, наращение размера n на наращение размера n.
[02:11:37.360 --> 02:11:39.360]  Да, на самом деле да, достаточно 2n-1.
[02:11:39.360 --> 02:11:42.360]  Правда, мы умножали 2n, потому что нам принципиально была степень двойки.
[02:11:43.360 --> 02:11:45.360]  Но теперь заметьте маленькую приятную вещь.
[02:11:45.360 --> 02:11:49.360]  Когда у вас каждое одномерное f of t размера 2, 3, 4,
[02:11:49.360 --> 02:11:52.360]  то вы можете даже сказать, что сделать его даже размера 3,
[02:11:52.360 --> 02:11:56.360]  потому что вы всё равно его сделаете за от трёх, правда?
[02:11:58.360 --> 02:12:03.360]  Да, можете даже подставить туда даже комплексные корни степени 3 из единицы, если очень хочется.
[02:12:03.360 --> 02:12:10.360]  Вот, и тогда получается, что если у вас размер будет там степени 3,
[02:12:10.360 --> 02:12:16.360]  то есть у вас тогда будет, то есть им аномов тут 3 в степени n,
[02:12:16.360 --> 02:12:20.360]  и собственно там произведения будут все такие адекватные, поэтому слава нот.
[02:12:20.360 --> 02:12:23.360]  Поэтому будет ура, а симптотика 3 в степени n.
[02:12:25.360 --> 02:12:26.360]  Правда, на n?
[02:12:28.360 --> 02:12:30.360]  Ну это уже оптимизация.
[02:12:31.360 --> 02:12:34.360]  А теперь следующий чит.
[02:12:35.360 --> 02:12:39.360]  Потому что заметим, что когда у нас f of t размера совсем уж 3,
[02:12:40.360 --> 02:12:46.360]  ну понятно, мы замечаем, что мы можем ещё и числа выбирать такие, какие мы хотим, вообще любые на этот раз.
[02:12:47.360 --> 02:12:51.360]  То есть раньше мы выбирали комплексные числа.
[02:12:52.360 --> 02:12:57.360]  Вот, ну а теперь заметим, что если мы выберем 57, 179, 2007,
[02:12:57.360 --> 02:13:01.360]  то в принципе тоже можно и прямое и обратное преобразование проводить, правда?
[02:13:06.360 --> 02:13:14.360]  Ну что, берём эту матрицу Вандермонда с 57, то есть там 1, 57, 57 в квадрате, 1179, 179, 179, подать и честно её обращаем.
[02:13:15.360 --> 02:13:16.360]  Вот.
[02:13:19.360 --> 02:13:22.360]  Но мы пойдём более хитрым путём.
[02:13:24.360 --> 02:13:30.360]  На самом деле, как вы смотрите, нам нужны значения какого-то многочленов в точках.
[02:13:31.360 --> 02:13:36.360]  То есть когда мы перемножали, мы получали вот такое.
[02:13:38.360 --> 02:13:40.360]  Но с другой стороны заметим,
[02:13:41.360 --> 02:13:49.360]  вот мы помним, как получить многочлен, да, то есть по многочлену С мы помним, мы можем получить его брата H.
[02:13:50.360 --> 02:13:55.360]  Как мы его получаем? Заменяя хит в квадрат на хит, правда?
[02:13:56.360 --> 02:13:57.360]  Понимаете, да?
[02:13:59.360 --> 02:14:01.360]  Но идея теперь заключается в следующем.
[02:14:01.360 --> 02:14:09.360]  Заметим, что не во всех точках, что конечно, когда мы этот многочлен заменяем, то конечно значения, что в принципе эти многочлены меняются, правда?
[02:14:10.360 --> 02:14:18.360]  Но если мы их рассмотрим, но если мы их рассмотрим в таких точках, что значение, в таких иксах, что значение от этого замены не поменяется,
[02:14:19.360 --> 02:14:20.360]  то будет неплохо, правда?
[02:14:23.360 --> 02:14:24.360]  Ну, в единиц не поменяется.
[02:14:25.360 --> 02:14:26.360]  То есть смотрите какой.
[02:14:27.360 --> 02:14:28.360]  А нужно ли нам больше?
[02:14:29.360 --> 02:14:30.360]  А нужно ли нам больше?
[02:14:35.360 --> 02:14:36.360]  А теперь будет две.
[02:14:38.360 --> 02:14:51.360]  Значит, смотрите, что будет, если мы сейчас в наглую и сделаем FFT, но в каждом многочлене будет у нас брать не три точки, а две, 0 и 1.
[02:14:52.360 --> 02:14:54.360]  Тогда смотрите, что у нас получится.
[02:14:55.360 --> 02:14:57.360]  Ну, во-первых, это будет за два в степени n на n, да?
[02:14:58.360 --> 02:14:59.360]  Понимаете, да?
[02:15:00.360 --> 02:15:01.360]  Понимаете?
[02:15:02.360 --> 02:15:03.360]  Ну, смотрите.
[02:15:04.360 --> 02:15:08.360]  Ну, давайте проделаем F, вот это вот, такое псевдо, вот это вот FFT, да?
[02:15:09.360 --> 02:15:17.360]  Только там, только на каждом измерении, то есть в каждой икс будем подставлять 0 и 1, два значения.
[02:15:18.360 --> 02:15:19.360]  Понимаете, да?
[02:15:19.360 --> 02:15:20.360]  Понимаете, да?
[02:15:22.360 --> 02:15:26.360]  То есть я вот проделаю вот эту мистику и проделаю вот эти произведения.
[02:15:27.360 --> 02:15:34.360]  То, что у меня получится, это будет, то есть у меня получится значение вот этого реального многочлена C произведения, да?
[02:15:35.360 --> 02:15:39.360]  В точках, там, в точках 0 и 1 в степени n, правда?
[02:15:40.360 --> 02:15:41.360]  Да.
[02:15:43.360 --> 02:15:48.360]  Конечно же, по нему нельзя восстановить сам многочлен C, потому что там надо 3 в степени n точек.
[02:15:49.360 --> 02:15:51.360]  Но нам это и не нужно.
[02:15:52.360 --> 02:16:05.360]  Потому что мы заметим, что эти значения многочлена C в этих точках, они на самом деле просто равны значению нужного нам многочлена H вот в этих точках.
[02:16:06.360 --> 02:16:10.360]  Ровно потому, что вот 0 и 1 обладают таким приятным свойством, видите, да?
[02:16:11.360 --> 02:16:23.360]  И тогда получается, то есть на самом деле, да, мы сделали эти произведения и получается у нас значение многочлена H в точках, и мы можем сделать обратное преобразование только вот от 0 и 1.
[02:16:24.360 --> 02:16:31.360]  Таким образом мы просто подобрали две, вот мы снова применили этот чит, мы подобрали такие две точки, чтобы нам было хорошо.
[02:16:33.360 --> 02:16:39.360]  Но самое главное теперь, а теперь давайте внимательно увидим.
[02:16:40.360 --> 02:16:42.360]  Как это будет выглядеть в коде?
[02:16:43.360 --> 02:16:47.360]  Вот как это вот мистическое преобразование Fourier будет выглядеть в коде?
[02:16:49.360 --> 02:16:50.360]  Вот.
[02:16:51.360 --> 02:16:55.360]  Ну, в коде оно будет выглядеть, да, что, ну, конечно, f от n переменных мы писать не будем, да?
[02:16:56.360 --> 02:17:07.360]  Ну, мы могли бы, конечно, там написать, да, что for там x2 равно от 0 до 1, там x3 от 0 до 1 и так далее, xn равно от 0 до 1, да.
[02:17:07.360 --> 02:17:14.360]  Извините, да, в наглую предположив, что вообще там pum pum pum c++ писать можно, да?
[02:17:16.360 --> 02:17:17.360]  Вот это вот.
[02:17:20.360 --> 02:17:24.360]  Ну вот, ну и там что, ну вот, а теперь думаем, что у нас получается?
[02:17:25.360 --> 02:17:34.360]  У нас есть два значения, да, то есть у нас есть f от 0, там от 0, x2 и так далее, xn.
[02:17:35.360 --> 02:17:37.360]  И от единицы.
[02:17:39.360 --> 02:17:50.360]  Заметим, что эти два значения, если я их особенно назову, допустим, для красоты a и b, то они образуют многочлен a плюс bt, правда, от одной переменной, правда?
[02:17:51.360 --> 02:17:57.360]  И мы хотим вот эти ab заменить на значение этого многочлена в точке 0 и 1.
[02:17:58.360 --> 02:18:03.360]  Но значение в точке 0 это и есть a, а значение в точке b это a плюс b.
[02:18:05.360 --> 02:18:17.360]  Поэтому получается, что я должен написать, что f от, просто все, что должен сделать, плюс равно f от 0, x2, xn.
[02:18:19.360 --> 02:18:26.360]  А если мы переведем это на язык масочек, то предыдущий код воспроизвелся сам собой.
[02:18:31.360 --> 02:18:33.360]  Ну для одного и что?
[02:18:34.360 --> 02:18:39.360]  Правильно, ну просто да, вот эту вот штуку придется сделать это n раз, только я буду пропускать...
[02:18:44.360 --> 02:18:46.360]  f от x1, 1 или нет?
[02:18:46.360 --> 02:18:56.360]  Ну да, правильно, значит x1, дальше 4x1, потом пропускаем x2, 4x3, там 4x4.
[02:18:56.360 --> 02:18:58.360]  Что? Чего? Я не понимаю.
[02:18:58.360 --> 02:19:00.360]  Пум-пум-пум еще.
[02:19:02.360 --> 02:19:07.360]  Вот. Нет, ну просто смотри, просто как выглядит n-мерное прообразование в фурье?
[02:19:08.360 --> 02:19:12.360]  Ну давай так, 2-мерное как? Мы все делаем по строкам, потом по столбцам.
[02:19:12.360 --> 02:19:16.360]  Как делаем 3-мерное? По строкам, по столбцам, по ыть.
[02:19:17.360 --> 02:19:19.360]  Как сделаем n-мерное?
[02:19:20.360 --> 02:19:25.360]  Ну смотри, это мы сделали только все fft по одному из n направлений.
[02:19:26.360 --> 02:19:27.360]  Да.
[02:19:27.360 --> 02:19:30.360]  Ну по тому направлению, который x1.
[02:19:30.360 --> 02:19:38.360]  Ну то есть смотрите, вот x1 направлено сюда, x2 перпендикулярно, x3 перпендикулярно и в обоем, x4 перпендикулярно там и всем, ну и так далее.
[02:19:39.360 --> 02:19:41.360]  Вот, ну простая картинка, да.
[02:19:43.360 --> 02:19:49.360]  То есть на самом деле да, вот будет такая вторая пачка форов, и в ней будет то же самое, f от...
[02:19:50.360 --> 02:20:03.360]  Получается x1, 1, x3, x4 и так далее xn, плюс равно f от x1, 0, x3 и так далее xn.
[02:20:04.360 --> 02:20:07.360]  Вот, и на самом деле в таких патчах я должен n-штук написать.
[02:20:08.360 --> 02:20:12.360]  Это если прям честно писать n-мерное прообразование в фурье.
[02:20:13.360 --> 02:20:19.360]  Но, конечно же мы этого делать не будем, тем более что и f мы наверное будем хранить не в n-мерном массиве, правда?
[02:20:20.360 --> 02:20:22.360]  Мы его будем хранить в виде масочки, правда?
[02:20:23.360 --> 02:20:32.360]  Но тогда получается нам нужно будет, то есть фактически, то есть эта пачка, тогда если тут вот хранить f от m, то получается нам нужно просто перебрать все масочки.
[02:20:33.360 --> 02:20:36.360]  То есть for m равно от 0 до 2 в степени n-1.
[02:20:37.360 --> 02:20:50.360]  Значит, если m and 1, то соответственно f от m, плюс равно f от m, в данном случае, минус 1.
[02:20:51.360 --> 02:20:53.360]  На что заменится вторая пачка?
[02:20:54.360 --> 02:21:09.360]  То же самое, то есть тоже прибираемся опять по всем масочкам и говорим, значит, if m and 2, то f от m, плюс равно f от m, минус 2.
[02:21:11.360 --> 02:21:15.360]  То есть дальше соответственно тут будет на этом месте 4, 8, 16 и так далее.
[02:21:15.360 --> 02:21:29.360]  Но на самом деле просто так и напрашивается, что остается только добавить, что на самом деле перебирать, что это 2 в степени g, и тогда получится for g от 0 до n-1,
[02:21:29.360 --> 02:21:49.360]  for m равно 0 до 2 в степени n-1, if 1 х х g, то f от m, плюс равно f от m, минус 1 х х g.
[02:21:54.360 --> 02:21:58.360]  Ну вот, код тогда, логика принципиально другая, а код тот же самый.
[02:22:00.360 --> 02:22:07.360]  То есть более того, на самом деле, как бы если дальше, то есть на самом деле получилось, что да, мы сделали просто инвергенное преобразование в фурье.
[02:22:08.360 --> 02:22:22.360]  Но просто если мы, то есть правда вот с 0 и 1, но видимо, если очень аккуратно покопать, что конкретно там мы в итоге делаем и что это преобразование в итоге делает, то тогда и получается, что да, по факту мы считаем сумму на подмножстве.
[02:22:25.360 --> 02:22:28.360]  То есть вот на самом деле, откуда это взялось.
[02:22:29.360 --> 02:22:42.360]  Ну что, давайте догадайтесь за оставшуюся минуту, откуда взялся нод, как теперь сделать то же самое к ссорам.
[02:22:50.360 --> 02:22:53.360]  Ну тут так называется, что такое так же?
[02:23:00.360 --> 02:23:03.360]  Нет, смотря что такое так же не получит.
[02:23:08.360 --> 02:23:25.360]  Потому что давайте воспроизведем еще раз технологию. То есть технология говорит, что мы хотим перемножать два многочлена, но потом мы заметили, что если вычислять значение многочлена в точках 0 и 1, значит так, мы хотели вычислить произведение, а потом сократить двойку в единицу и получить нужный нам многочлен.
[02:23:25.360 --> 02:23:27.360]  Заметили, что на единичке это свойство?
[02:23:27.360 --> 02:23:30.360]  Да, мы заметили, что квадрат превращался в ноль.
[02:23:30.360 --> 02:23:33.360]  Так, ну не в ноль, а в степень ноль.
[02:23:33.360 --> 02:23:35.360]  В степень ноль.
[02:23:35.360 --> 02:23:38.360]  Да, то есть теперь у нас получается вот тут.
[02:23:40.360 --> 02:23:42.360]  Это получится к ссорам.
[02:23:42.360 --> 02:23:44.360]  Да, тогда получится к ссорам.
[02:23:44.360 --> 02:23:49.360]  А существуют ли такие иксы, у которых квадрат превращается в X нулевое?
[02:23:49.360 --> 02:23:51.360]  Есть ноль.
[02:23:51.360 --> 02:23:53.360]  Нету нуля.
[02:23:53.360 --> 02:23:55.360]  Ноль в нулевой степени не равно 1.
[02:23:58.360 --> 02:24:00.360]  Так, давайте.
[02:24:00.360 --> 02:24:03.360]  А у каких чисел х квадрате равен х нулевой?
[02:24:03.360 --> 02:24:05.360]  И минус единичке.
[02:24:05.360 --> 02:24:07.360]  И минус единичке.
[02:24:14.360 --> 02:24:17.360]  Да, это прям в явном виде оно на самом деле.
[02:24:18.360 --> 02:24:21.360]  То есть делаем то же самое, только вычисляем многочлены.
[02:24:21.360 --> 02:24:23.360]  То есть это вот одномерные многочлены.
[02:24:23.360 --> 02:24:26.360]  В точках не 0,1, а 1, минус 1.
[02:24:28.360 --> 02:24:32.360]  Ну тогда тут получается, здесь получается а плюс b и а минус b.
[02:24:36.360 --> 02:24:38.360]  То есть просто делаем буквально то же самое.
[02:24:38.360 --> 02:24:43.360]  То есть в этих точках у произведения и у того, что надо значения совпадают.
[02:24:43.360 --> 02:24:46.360]  Поэтому остается только применить обратное fft.
[02:24:46.360 --> 02:24:50.360]  Но там придется тоже поскладывать, но еще пополам взять.
[02:24:52.360 --> 02:24:55.360]  Но получится вот абсолютно то же самое.
[02:25:07.360 --> 02:25:09.360]  А элементарно?
[02:25:09.360 --> 02:25:16.360]  Ну практически нам на каждом шаге, на житом шаге надо перебрать все пары масок, которые отличаются только житым битом.
[02:25:18.360 --> 02:25:21.360]  Значит смотри, получится примерно следующее.
[02:25:21.360 --> 02:25:23.360]  То есть в нашем случае...
[02:25:23.360 --> 02:25:25.360]  Так, ну вот...
[02:25:25.360 --> 02:25:27.360]  Синего маркера не валялось.
[02:25:27.360 --> 02:25:28.360]  Ну ладно, смотри.
[02:25:28.360 --> 02:25:30.360]  Значит в данном случае получится так.
[02:25:30.360 --> 02:25:41.360]  Значит, так сказать, int ссылка a в данном случае равно f от n минус 1 хресь-хресь z.
[02:25:43.360 --> 02:25:46.360]  Ну я тут ссылку введу, чтобы было удобно.
[02:25:48.360 --> 02:25:53.360]  Я хочу просто заменить a и b, то есть как многочлен размера 2,
[02:25:53.360 --> 02:25:57.360]  на значение этого многочлена в точках 1 и минус 1.
[02:25:58.360 --> 02:26:07.360]  И заменю я их, выражаясь питоновским языком, a, b равно, там, равно a плюс b, a минус b.
[02:26:10.360 --> 02:26:12.360]  Вот и все.
[02:26:12.360 --> 02:26:27.360]  Так что вот такая вот красивая магия.
[02:26:36.360 --> 02:26:38.360]  С какого момента?
[02:26:38.360 --> 02:26:46.360]  На самом деле с момента, когда мы превратили факт, что x² равно x для 0 единицы
[02:26:46.360 --> 02:26:53.360]  в многоверное преобразование в QE, как-то схлопнувшее что-то,
[02:26:53.360 --> 02:26:59.360]  он как-то переведет это куда-то и что-то получит.
[02:26:59.360 --> 02:27:04.360]  Я не могу понять шаг с многоверным преобразованием в QE.
[02:27:04.360 --> 02:27:08.360]  Я могу написать такую сумму под масками, как сумму под масками?
[02:27:08.360 --> 02:27:12.360]  Еще раз, схема, f и g, жили-были f и g.
[02:27:12.360 --> 02:27:18.360]  Которые были функции из масок и функции из n перемен.
[02:27:18.360 --> 02:27:23.360]  Вот такие функции, мы им сопоставили многочлены.
[02:27:23.360 --> 02:27:28.360]  Сопоставили, потому что неверно, что f будет то же самое.
[02:27:28.360 --> 02:27:31.360]  То есть каждой функции мы сопоставили вот такой многочлен.
[02:27:34.360 --> 02:27:36.360]  У нас была мечта.
[02:27:36.360 --> 02:27:38.360]  Откуда взялась коэффициент?
[02:27:38.360 --> 02:27:42.360]  Это коэффициент, это значение функции f в этой маске.
[02:27:42.360 --> 02:27:49.360]  Да, тут может быть немножко путаница, потому что многочлен и эта функция это неравные функции.
[02:27:49.360 --> 02:27:56.360]  Но теперь мы заметили, что если бы мы нашли произведение этого многочлена,
[02:27:56.360 --> 02:28:04.360]  то тогда бы мы получили многочлен, из которого потом обрубив лишние двойки, мы бы получили радость.
[02:28:04.360 --> 02:28:17.360]  Такой же многочлен, но для того, что нам надо.
[02:28:17.360 --> 02:28:22.360]  Мы сказали следующее.
[02:28:22.360 --> 02:28:26.360]  Что такое многомерное произведение fft по сути?
[02:28:26.360 --> 02:28:39.360]  Мы берем какие-нибудь два, три, четыре значения, находим значение многочленов f и g в этих точках.
[02:28:39.360 --> 02:28:51.360]  Тогда мы нашли, мы решили, а давайте найдем значение многочленов f и g в точках 0 и 1.
[02:28:51.360 --> 02:28:54.360]  В общем, 0 и 1 не потому, что они фолсты.
[02:28:54.360 --> 02:28:56.360]  Ну, в смысле?
[02:28:56.360 --> 02:28:58.360]  Ну, да, да, да.
[02:28:58.360 --> 02:29:00.360]  Каждый х является любым 0.
[02:29:00.360 --> 02:29:05.360]  В общем, 0 и 1 мы взяли не потому, что они фолсты, но потому, что x² равно x.
[02:29:05.360 --> 02:29:07.360]  Как мы этим воспользовались?
[02:29:07.360 --> 02:29:12.360]  Мы знаем значение многочлена соответствующего f, соответствующего g.
[02:29:12.360 --> 02:29:17.360]  Следовательно, знаем значение их произведения.
[02:29:17.360 --> 02:29:33.360]  Но так как в точках 0 и 1 x² равно x, то тогда мы знаем многочлена соответствующего h, соответствующего функции h вот в этих точках.
[02:29:33.360 --> 02:29:39.360]  Если мы посчитали значение всех этих штук, а потом взяли скалярное подчленение.
[02:29:39.360 --> 02:29:41.360]  Ну да, взяли, да.
[02:29:41.360 --> 02:29:43.360]  Ну, не скалярное, а подчленное.
[02:29:43.360 --> 02:29:45.360]  Скалярное это если бы мы их еще и просуммировали.
[02:29:45.360 --> 02:29:47.360]  Да, да, да, конечно.
[02:29:47.360 --> 02:29:49.360]  Вот.
[02:29:49.360 --> 02:30:00.360]  Но тогда получается, что мы нашли значение многочлена соответствующего этой функции в точках 0 и 1 в степени n.
[02:30:00.360 --> 02:30:01.360]  Вот.
[02:30:01.360 --> 02:30:03.360]  Ну и все, что нам остается, теперь это просто...
[02:30:03.360 --> 02:30:06.360]  Мы его нашли, если мы сделали какое-то...
[02:30:06.360 --> 02:30:11.360]  Если мы научились вычислять нужную нам точку.
[02:30:11.360 --> 02:30:12.360]  Да.
[02:30:12.360 --> 02:30:14.360]  Мы во всех их точках вычлили.
[02:30:14.360 --> 02:30:23.360]  Получилось, что у нас тут 2 в степени n значений мы нашли, а мы наращили на h самого 2 в степени n коэффициентов.
[02:30:23.360 --> 02:30:24.360]  Сейчас.
[02:30:24.360 --> 02:30:27.360]  А в какой момент мы нашли эти значения?
[02:30:27.360 --> 02:30:31.360]  Как мы нашли значения этих многоченых в ровных нам точках?
[02:30:31.360 --> 02:30:34.360]  В тот момент, когда мы тупо их перемножили.
[02:30:34.360 --> 02:30:36.360]  Так, секунду. Не, как?
[02:30:36.360 --> 02:30:39.360]  Смотри, когда ты перемножишь значения f...
[02:30:39.360 --> 02:30:43.360]  Ты нашел значение многоченого f в какой-то точке, да?
[02:30:43.360 --> 02:30:45.360]  Как?
[02:30:45.360 --> 02:30:50.360]  Ну, в f и g мы запустили аналог многомерного преобразования фурье.
[02:30:50.360 --> 02:30:53.360]  Вот я это не понял, потому что дальше мы их перемножим очевидно.
[02:30:54.360 --> 02:30:58.360]  Ну, а что я не понял? Ровно так же, как было раньше.
[02:30:58.360 --> 02:31:01.360]  А как это превратилось в такую сумму?
[02:31:01.360 --> 02:31:04.360]  Даже в такую сумму, как это превратилось?
[02:31:04.360 --> 02:31:07.360]  Как эту сумму дальше сворачивать очевидно?
[02:31:07.360 --> 02:31:10.360]  Ну, смотри еще. Откуда мы это взяли?
[02:31:10.360 --> 02:31:13.360]  Смотри, у нас есть многочлен.
[02:31:13.360 --> 02:31:23.360]  Обычная, да? То есть, допустим, есть у нас многочлен a0 плюс, условно, там a1t плюс a2t² плюс a3t в кубе плюс a4t в четвертой,
[02:31:23.360 --> 02:31:26.360]  даже чтобы до степень горьки не цепляться, да?
[02:31:26.360 --> 02:31:28.360]  Напишу, да?
[02:31:28.360 --> 02:31:31.360]  То что такое одномерное fft? Ну, обобщенно.
[02:31:31.360 --> 02:31:35.360]  Это я записываю значения этих многоченых в точках.
[02:31:35.360 --> 02:31:41.360]  Ну, я не знаю, в точке, условно, 57, 179, там, 2007.
[02:31:41.360 --> 02:31:43.360]  Там я не знаю.
[02:31:43.360 --> 02:31:48.360]  Давай, 345, да? Да.
[02:31:48.360 --> 02:31:51.360]  Но в данном случае, в данном случае заметим, что,
[02:31:51.360 --> 02:32:00.360]  ну, то есть, когда мы делаем n-мерное прообразование fft, мы как бы сводим его к куче одномерных, правда?
[02:32:00.360 --> 02:32:06.360]  То есть, мы перебираем каждое направление и по каждому направлению говорим,
[02:32:06.360 --> 02:32:11.360]  что фиксируем все возможные, перебираем все возможные значения остальных, фиксируем их.
[02:32:11.360 --> 02:32:16.360]  А когда мы фиксируем все остальные переменные, да, у нас как бы у этой переменной стоится одномерный многочлен,
[02:32:16.360 --> 02:32:20.360]  именно к нему мы это fft прибавляем и делаем.
[02:32:20.360 --> 02:32:26.360]  Но теперь, смотрите, теперь в нашем случае получилась ситуация, что у нас каждый многочлен имеет размер 2.
[02:32:26.360 --> 02:32:30.360]  То есть, вот он a0 плюс a1t, да?
[02:32:30.360 --> 02:32:36.360]  Мы хотим его заменить на значение в точке 0 и в точке 1.
[02:32:41.360 --> 02:32:51.360]  Но теперь мы просто заметили, что a0 равно тупо a0, а a1 равно тупо a0 плюс a1.
[02:32:52.360 --> 02:33:05.360]  То есть, получается, чтобы превратить, то есть мы, у нас есть массив a0, a1, мы хотим, чтобы в том же самом массиве было написано a0 и a0 плюс a1.
[02:33:05.360 --> 02:33:12.360]  Но для того, чтобы получить из этого массива этот, все, что нам нужно, это просто прибавить к этому к этому числу это.
[02:33:12.360 --> 02:33:15.360]  Что мы вон там везде и делаем.
[02:33:21.360 --> 02:33:31.360]  Почему у нас с лева plus b, а где?
[02:33:31.360 --> 02:33:36.360]  Почему у нас весь точек минус 1 получился а плюс b?
[02:33:36.360 --> 02:33:40.360]  Потому что сейчас я про орг рассказывал.
[02:33:40.360 --> 02:33:43.360]  Не-не-не, с красным маркером.
[02:33:43.360 --> 02:33:48.360]  А красным маркером, потому что красный маркер это то, что мы делали для ксора.
[02:33:48.360 --> 02:33:53.360]  Почему у нас с лева plus b, а этот точек минус 1?
[02:33:53.360 --> 02:33:58.360]  Ну, потому что мы так решили, что здесь будет а плюс b, а здесь а минус b.
[02:33:58.360 --> 02:34:01.360]  Но на самом деле лучше так.
[02:34:01.360 --> 02:34:03.360]  Ну, потому что если вот так, то это будет...
[02:34:03.360 --> 02:34:05.360]  Почему можно как угодно?
[02:34:05.360 --> 02:34:13.360]  Потому что суть у нас одна. Найти значение этих наращенов только уже в токиках не 0.1 в степени, а минус 1.1 в степени.
[02:34:14.360 --> 02:34:20.360]  То есть мы тут подменили, чтобы у нас суть квадратцев подал с нулевой степенью.
[02:34:20.360 --> 02:34:24.360]  Почему мы здесь делаем именно 1 минус 1?
[02:34:24.360 --> 02:34:29.360]  Потому что на самом деле, если вы думаете, что такое fft для массива размера 2,
[02:34:29.360 --> 02:34:38.360]  то если вы там расписали, что такое корни второй степени из единицы, то это будет как раз 1 минус 1, а не наоборот.
[02:34:38.360 --> 02:34:43.360]  Поэтому для отсора мы буквально запустили fft.
[02:34:43.360 --> 02:34:46.360]  То есть не почти fft, а буквально.
[02:34:46.360 --> 02:34:48.360]  То есть на этот раз это оно.
[02:34:57.360 --> 02:35:01.360]  Так что тут вот такая вот маленькая красота.
[02:35:08.360 --> 02:35:12.360]  Ну не совсем. То есть вы тут a плюс b и a минус b.
[02:35:12.360 --> 02:35:15.360]  Но тогда, смотрите, тогда как получить a из них?
[02:35:15.360 --> 02:35:18.360]  Их тоже надо сложить, но только еще пополам поделить.
[02:35:18.360 --> 02:35:20.360]  А тут наоборот, вычистить пополам.
[02:35:20.360 --> 02:35:22.360]  Но это опять то же самое fft.
[02:35:22.360 --> 02:35:24.360]  То есть как бы делаем...
[02:35:24.360 --> 02:35:27.360]  Здесь даже не придется менять ничего.
[02:35:27.360 --> 02:35:32.360]  Да, вы можете просто запустить функцию fft от массивов размера 2.
[02:35:32.360 --> 02:35:37.360]  Но правда, по факту вам лучше этого не делать, конечно, а лучше аналогичный код написать.
[02:35:37.360 --> 02:35:40.360]  Можно просто повторить, а потом сексент назад поделить.
[02:35:40.360 --> 02:35:41.360]  Ну да.
[02:35:51.360 --> 02:35:53.360]  Ну вот. Так что вот такая вот...
[02:35:53.360 --> 02:35:55.360]  Эх, приятная вещь.
[02:35:57.360 --> 02:36:01.360]  Ну в принципе да, остались только две мелочи на самом деле на fft.
[02:36:04.360 --> 02:36:06.360]  Что-то мы быстро идем.
[02:36:06.360 --> 02:36:08.360]  Ну ладно.
[02:36:08.360 --> 02:36:10.360]  Так, ну что? Ладно.
[02:36:15.360 --> 02:36:17.360]  Я уже не понимаю.
[02:36:17.360 --> 02:36:23.360]  Если мы запустим обратное, то тот же самый код просто запустим.
[02:36:23.360 --> 02:36:26.360]  И в конце поделим все коэффициенты по 2a.
[02:36:26.360 --> 02:36:33.360]  Или если мы запустим тот же самый код, и когда получаем a минус b, равно a плюс b пополам и запидаем a минус b пополам.
[02:36:33.360 --> 02:36:35.360]  Ну, получится не совсем...
[02:36:35.360 --> 02:36:38.360]  В самом конце тогда надо будет не на 2 делить, а на 2 в степени n.
[02:36:42.360 --> 02:36:43.360]  Ну да.
[02:36:43.360 --> 02:36:46.360]  Нет, ну на самом деле вы и в обычном fft у вас есть выбор.
[02:36:46.360 --> 02:36:50.360]  В самом конце поделить на n или в каждый момент времени делить на 2.
[02:36:52.360 --> 02:36:54.360]  Когда вы вот это преобразование бабочки делаете.
[02:36:56.360 --> 02:36:57.360]  Помните, вы же как раз...
[02:36:57.360 --> 02:36:59.360]  Помните, у вас там тоже заклинание есть.
[02:36:59.360 --> 02:37:05.360]  У вас есть u, v, и потом там в переменные вы пишете там куда-то u плюс v, а потом u минус v.
[02:37:05.360 --> 02:37:06.360]  Заклинание.
[02:37:06.360 --> 02:37:08.360]  Вот. Знакомое, да?
[02:37:08.360 --> 02:37:15.360]  Так вот, на самом деле один из вариантов обратного произвязывания fft сказать, что если вы делаете обратное, давайте в этот момент под на 2 поделим.
[02:37:20.360 --> 02:37:22.360]  Так что вот такая красота.
[02:37:22.360 --> 02:37:24.360]  Нет, слушайте, а давайте сейчас...
[02:37:24.360 --> 02:37:25.360]  Слушайте, у меня такое предложение.
[02:37:25.360 --> 02:37:27.360]  Давайте сейчас все-таки все fft добьем.
[02:37:28.360 --> 02:37:30.360]  А третью пару мы можем просто начать чуть попозже.
[02:37:32.360 --> 02:37:34.360]  Ну или закончить чуть пораньше, там не важно.
[02:37:34.360 --> 02:37:39.360]  У нас там на четвертой паре за 30 минут до конца начинается экстремация Региросского.
[02:37:41.360 --> 02:37:42.360]  Да?
[02:37:42.360 --> 02:37:43.360]  А, то есть если мы...
[02:37:43.360 --> 02:37:44.360]  А, то есть...
[02:37:44.360 --> 02:37:46.360]  А, ну то есть сейчас самое оно, попродолжать, да?
[02:37:46.360 --> 02:37:47.360]  Окей.
[02:37:48.360 --> 02:37:49.360]  Что?
[02:37:49.360 --> 02:37:51.360]  Как мы избавились от int?
[02:37:51.360 --> 02:37:53.360]  А int избавились очень просто.
[02:37:53.360 --> 02:37:59.360]  Дело в том, что мы просто взяли функции f и j, в них мысленно инвертировали все битики.
[02:37:59.360 --> 02:38:01.360]  И тогда там просто or превратился в int.
[02:38:02.360 --> 02:38:03.360]  И наоборот.
[02:38:03.360 --> 02:38:06.360]  f с чертой такое, что f с чертой от них ремасты.
[02:38:06.360 --> 02:38:07.360]  Ну типа да.
[02:38:07.360 --> 02:38:10.360]  Но самое, что f от полной маски 40.
[02:38:10.360 --> 02:38:11.360]  Ну вот.
[02:38:12.360 --> 02:38:13.360]  Ладно, значит смотрите.
[02:38:13.360 --> 02:38:15.360]  Какой, собственно, простой?
[02:38:15.360 --> 02:38:16.360]  Я сразу скажу простой.
[02:38:16.360 --> 02:38:18.360]  Я думаю, сейчас больше 10 минут у нас тут не осталось.
[02:38:19.360 --> 02:38:23.360]  Просто вот очень хотелось закончить именно этой задачей.
[02:38:23.360 --> 02:38:25.360]  Вот мне кажется, это было бы очень красиво.
[02:38:26.360 --> 02:38:27.360]  Задача такая.
[02:38:28.360 --> 02:38:29.360]  Да, многочлен.
[02:38:40.360 --> 02:38:44.360]  Вот как-то вот именно вот сейчас хочется тогда в конце рассмотреть такую задачу.
[02:38:44.360 --> 02:38:50.360]  Я хочу найти его значение в n точках.
[02:38:55.360 --> 02:38:57.360]  Только на этот раз они мне сверху даны.
[02:38:59.360 --> 02:39:01.360]  В общем, помните, мы с нее-то и начинали.
[02:39:03.360 --> 02:39:05.360]  Поэтому хотелось ей закончить.
[02:39:05.360 --> 02:39:07.360]  Ну ей и ее братом.
[02:39:15.360 --> 02:39:16.360]  Так.
[02:39:39.360 --> 02:39:40.360]  Вот.
[02:39:41.360 --> 02:39:42.360]  Как же это сделать?
[02:39:44.360 --> 02:39:45.360]  Ну вот.
[02:39:48.360 --> 02:39:51.360]  Но правда, да, но честно скажу, да, сразу предупрежду.
[02:39:51.360 --> 02:39:53.360]  Ладно, n лог n тут не будет.
[02:39:55.360 --> 02:39:57.360]  Да, тут будет n лог квадрат.
[02:39:59.360 --> 02:40:00.360]  Чего?
[02:40:01.360 --> 02:40:02.360]  Ну вот.
[02:40:02.360 --> 02:40:04.360]  Ну на самом деле да.
[02:40:05.360 --> 02:40:06.360]  Вот.
[02:40:08.360 --> 02:40:09.360]  Ну вот.
[02:40:11.360 --> 02:40:12.360]  Какое?
[02:40:14.360 --> 02:40:15.360]  Непонятно.
[02:40:26.360 --> 02:40:27.360]  Непонятно.
[02:40:44.360 --> 02:41:00.360]  Ну я даже подскажу, тут тоже разделяй власть.
[02:41:00.360 --> 02:41:08.360]  Да, хочется придумать какие-то более удобные точки, в которых его можно было бы посчитать.
[02:41:08.360 --> 02:41:09.360]  Да.
[02:41:10.360 --> 02:41:15.360]  А лучше посчитать его в чем?
[02:41:17.360 --> 02:41:19.360]  В n полом точках?
[02:41:22.360 --> 02:41:23.360]  А, вот так.
[02:41:23.360 --> 02:41:31.360]  Хочется тоже посчитать его короткую версию в n полом точках.
[02:41:32.360 --> 02:41:35.360]  И другую его короткую версию в n полом точках.
[02:41:35.360 --> 02:41:36.360]  А что такое короткая?
[02:41:36.360 --> 02:41:42.360]  Да, очень хочется свести задачу к...
[02:41:43.360 --> 02:41:47.360]  Очень хочется свести действительно задачу к задаче размера n пополам.
[02:41:48.360 --> 02:41:53.360]  Да, то есть как-то вот сказать, что что-то хочется, конечно, чтобы тут было от...
[02:41:54.360 --> 02:41:55.360]  Чтобы тут надо было бы...
[02:41:55.360 --> 02:41:58.360]  То есть чтобы значение только в этих точках.
[02:42:00.360 --> 02:42:01.360]  n пополам минус один.
[02:42:02.360 --> 02:42:10.360]  И тут хочется, чтобы что-то было от t n пополам, а от t n минус один.
[02:42:11.360 --> 02:42:13.360]  Только не а от, а все-таки...
[02:42:14.360 --> 02:42:15.360]  Ну а от.
[02:42:15.360 --> 02:42:17.360]  Нет, так-то легко сделать.
[02:42:17.360 --> 02:42:23.360]  Ну нет, это как-то разделить что-то там и возможно как-то что-то получить.
[02:42:24.360 --> 02:42:25.360]  Ну хотелось бы.
[02:42:27.360 --> 02:42:29.360]  Правда остается только действительно вопрос.
[02:42:29.360 --> 02:42:34.360]  А как это действительно можно было бы действительно так активно нот так прямо разделить?
[02:42:35.360 --> 02:42:36.360]  И вообще получится ли?
[02:42:36.360 --> 02:42:54.360]  А что если взять n-решлен a0 плюс a2 t2 плюс a4 t4 и так далее?
[02:42:54.360 --> 02:42:55.360]  Взяли и?
[02:42:56.360 --> 02:42:59.360]  Считать в точках t0 квадрат, t1 квадрат.
[02:43:00.360 --> 02:43:04.360]  Взять, заменить все квадраты на обычные степени.
[02:43:04.360 --> 02:43:05.360]  И что?
[02:43:05.360 --> 02:43:10.360]  Потом посчитать его в точках t1 квадрат, t2 квадрат.
[02:43:11.360 --> 02:43:13.360]  И сказать, что это то, что там не было.
[02:43:15.360 --> 02:43:17.360]  Да, но только тогда у вас проблем будет, что у вас квадрат...
[02:43:18.360 --> 02:43:20.360]  Нарешение размера n пополам будет.
[02:43:21.360 --> 02:43:27.360]  Но тогда и точек, в которых вы хотите их посчитать, будет n.
[02:43:28.360 --> 02:43:29.360]  Обид, да?
[02:43:29.360 --> 02:43:30.360]  Да, вот обид.
[02:43:36.360 --> 02:43:37.360]  Да, поэтому да.
[02:43:37.360 --> 02:43:38.360]  В идеале, конечно...
[02:43:40.360 --> 02:43:41.360]  Да, действительно, хотя...
[02:43:43.360 --> 02:43:45.360]  То есть как бы это действительно можно было бы сделать?
[02:43:47.360 --> 02:43:48.360]  Ну можно было бы...
[02:43:48.360 --> 02:43:54.360]  Но на самом деле, смотрите, вот мы хотим какой-то многочлены посчитать его значение вот в этих точках, да?
[02:43:55.360 --> 02:44:05.360]  Но заметим, что если я из этого многочлена вычту какой-нибудь многочлен, у которого значения вот в этих точках равны нулю,
[02:44:06.360 --> 02:44:08.360]  то значение не поменяется, правда?
[02:44:10.360 --> 02:44:11.360]  Прикольно.
[02:44:11.360 --> 02:44:12.360]  Поэтому смотрите, какая идея.
[02:44:12.360 --> 02:44:15.360]  Давайте я вот тут попытаюсь пополам посчитать его значение,
[02:44:15.360 --> 02:44:16.360]  поэтому смотрите, какая идея.
[02:44:16.360 --> 02:44:22.360]  Давайте я вот тут попытаюсь подсунуть многочлен a, то есть подсунуть a минус...
[02:44:23.360 --> 02:44:26.360]  Ну какого вам многочлена, а значения в этих точках равны нулю?
[02:44:33.360 --> 02:44:42.360]  Ну во-первых, мы не можем fft в произвольных точках, а во-вторых, задача построить многочлен n пополам той степени не вырожденный.
[02:44:43.360 --> 02:44:45.360]  Что там n пополам, размер n пополам?
[02:44:48.360 --> 02:44:49.360]  Вот, конечно.
[02:44:50.360 --> 02:44:55.360]  t минус там t0, t минус t1 и так далее.
[02:44:59.360 --> 02:45:04.360]  Но на самом деле просто у вас, ну как бы в перспективе вам придется также их там пополам делить,
[02:45:05.360 --> 02:45:10.360]  поэтому у вас там получится дерево таких многочленов, дерево отрезков таких многочленов.
[02:45:12.360 --> 02:45:17.360]  Вот, каждое следующее это типа произведение детей, кстати, ровно отсюда и лог квадрат появляется.
[02:45:22.360 --> 02:45:25.360]  Да, ну конечно же, если вы вычтете из многочлена a вот этот многочлен,
[02:45:26.360 --> 02:45:29.360]  значение этого многочлена в этих точках будет тем же самым, что и у многочлена a,
[02:45:30.360 --> 02:45:34.360]  но конечно же степень этого многочлена упасть dn пополам не обязана.
[02:45:35.360 --> 02:45:41.360]  Но, фишка теперь такая, раз уж мы тут все равно имеем право на этой высоте делать n log n,
[02:45:42.360 --> 02:45:48.360]  то есть у нас просто идея, что я могу вычесть не просто этот многочлен, а этот многочлен умножить на вообще что угодно, правда?
[02:45:51.360 --> 02:45:55.360]  Так у меня идея такая, а давайте я a поделюсь с остатком вот на это.
[02:45:59.360 --> 02:46:00.360]  И возьму остаток.
[02:46:00.360 --> 02:46:05.360]  То есть я возьму, поэтому я тут а не минус возьму эту штуку, а a процентик эта штука.
[02:46:10.360 --> 02:46:15.360]  То есть многочлен будет в степени строго меньше, чем n пополам, а значения его в этих точках будут те же.
[02:46:18.360 --> 02:46:27.360]  Ну и здесь соответственно a процент, вот это вот t-tn пополам, там t-tn пополам плюс один,
[02:46:27.360 --> 02:46:32.360]  t-tn пополам плюс один, t-tn минус один.
[02:46:42.360 --> 02:46:44.360]  И запустимся к нему рекурсивно.
[02:46:48.360 --> 02:46:50.360]  Да, поэтому остается только их рекурсивно найти.
[02:46:51.360 --> 02:47:00.360]  Но там такая, сначала вам придется построить дерево, вот эти многочлены насчитать, а потом уже идти еще раз так уже вниз и начать брать вот эти процентики, процентики, процентики.
[02:47:07.360 --> 02:47:08.360]  Вот такая красота.
[02:47:11.360 --> 02:47:12.360]  То есть вот так вот.
[02:47:13.360 --> 02:47:19.360]  Ну это получается, это к сожалению n лог квадрата не лог, но это не n квадрат хотя бы.
[02:47:23.360 --> 02:47:28.360]  Ну и правда конечно нельзя тогда не рассмотреть ее брата, называется интерполяция многочлена.
[02:47:30.360 --> 02:47:35.360]  То есть когда мы хотим не по многочлену получить значение, а наоборот по значениям получить.
[02:47:37.360 --> 02:47:40.360]  Вот как теперь по вот таким, вот теперь давайте наоборот.
[02:47:42.360 --> 02:47:55.360]  Как вот по ним получить собственно сам многочлен.
[02:47:56.360 --> 02:48:03.360]  То есть я знаю, что это многочлен размера n или даже менее, у которого значения вот в этих точках равны вот этим системам.
[02:48:04.360 --> 02:48:11.360]  Хочу восстановить многочлен, но я знаю, что как минимум я знаю, что я могу решить там систему лениных уравнений, но я хочу быстрее.
[02:48:12.360 --> 02:48:18.360]  Вот как мне теперь готов этот многочлен восстановить.
[02:48:42.360 --> 02:49:05.360]  То же самое.
[02:49:05.360 --> 02:49:13.360]  Ну погодите.
[02:49:14.360 --> 02:49:15.360]  Сейчас, а зачем нам их считать?
[02:49:16.360 --> 02:49:19.360]  Нет, ну тут смотрите, тут разделяем властность работает так.
[02:49:20.360 --> 02:49:23.360]  Давайте разделим эти точки на две половинки как всегда.
[02:49:25.360 --> 02:49:32.360]  И рекурсивно, вот откуда-нибудь из рекурсии получим такой многочлен, так сказать, аж триг.
[02:49:32.360 --> 02:49:37.360]  Это многочлен размера n пополам, который совпадает с а вот в этих точках.
[02:49:38.360 --> 02:49:41.360]  Тут я получу аж триг и тут я получу а2 штриха.
[02:49:42.360 --> 02:49:44.360]  То есть он совпадает во вторых точках.
[02:49:45.360 --> 02:49:49.360]  Так вот спрашивается, как мне их смиксовать?
[02:49:56.360 --> 02:49:57.360]  На самом деле да.
[02:49:58.360 --> 02:49:59.360]  Но как оно теперь будет работать?
[02:49:59.360 --> 02:50:00.360]  А работать оно будет так.
[02:50:01.360 --> 02:50:02.360]  Но давайте я сразу скажу.
[02:50:03.360 --> 02:50:10.360]  Потому что в идеале я хочу просто расширить этот многочлен так, чтобы он в остальных всех точках левр он был равен нулю.
[02:50:11.360 --> 02:50:12.360]  Как мне это сделать?
[02:50:13.360 --> 02:50:17.360]  Я просто делаю аж триг от t и честно говорю t н пополам минус один.
[02:50:18.360 --> 02:50:22.360]  Значит так t минус t н пополам t.
[02:50:23.360 --> 02:50:26.360]  Значит t минус t значит n пополам плюс один.
[02:50:26.360 --> 02:50:27.360]  Ну и так далее.
[02:50:28.360 --> 02:50:30.360]  Значит t минус t н.
[02:50:32.360 --> 02:50:33.360]  Вот, понимаете, да?
[02:50:37.360 --> 02:50:41.360]  Ну как бы вот эти многочлены мы уже научились за n лог квадрат насчитывать, да?
[02:50:42.360 --> 02:50:43.360]  И тут все равно за n лог н домножим.
[02:50:44.360 --> 02:50:45.360]  Правда есть маленькая проблема.
[02:50:46.360 --> 02:50:52.360]  Проблема заключается в том, что да, в этих точках многочлен равен нулю, но в точках t0, t1 и так далее...
[02:50:52.360 --> 02:50:56.360]  Да, он уже не очень понятно вот.
[02:50:57.360 --> 02:50:59.360]  Он уже, я бы сказал, даже к черту чему равен, правда?
[02:51:02.360 --> 02:51:10.360]  То есть на самом деле мы теперь можем заметить, что да, что теперь вот эта штука, если так домножить, то он в t0 будет...
[02:51:11.360 --> 02:51:15.360]  То есть значение домножится на фактике вот t0 минус t н минус пополам вот этого.
[02:51:16.360 --> 02:51:20.360]  Да, но надо тогда все значения поделить.
[02:51:20.360 --> 02:51:21.360]  В смысле? Давайте...
[02:51:22.360 --> 02:51:23.360]  Все левые значения.
[02:51:24.360 --> 02:51:25.360]  Перекурсию передавать.
[02:51:26.360 --> 02:51:27.360]  Да, другие значения. Да, совершенно верно.
[02:51:28.360 --> 02:51:29.360]  Откуда мы их сейчас возьмем, правда?
[02:51:30.360 --> 02:51:31.360]  В смысле?
[02:51:32.360 --> 02:51:33.360]  t1 минус t.
[02:51:34.360 --> 02:51:39.360]  А, ну да, но тут мы обнаружим, что мы уже интерполяцию, то есть это подставлятие на значение умеем.
[02:51:40.360 --> 02:51:41.360]  Это лог квадрат, что ли?
[02:51:42.360 --> 02:51:43.360]  Да.
[02:51:45.360 --> 02:51:46.360]  Господи.
[02:51:46.360 --> 02:51:47.360]  Да.
[02:51:52.360 --> 02:51:56.360]  Да, то есть идея такая, что мы каждое вот это значение будем на самом деле делить.
[02:51:57.360 --> 02:52:00.360]  Делить вот на такое число.
[02:52:02.360 --> 02:52:05.360]  То есть фактически что нам нужно для того, чтобы их вот так поделить?
[02:52:06.360 --> 02:52:10.360]  Нам надо найти, взять вот этот многочлен и подставить в него числа t0, t1, t2 и так далее.
[02:52:11.360 --> 02:52:13.360]  Да, они все не равны нулю, поэтому можно поделить.
[02:52:13.360 --> 02:52:18.360]  То есть это поделим так, то поделим, то поделим, то поделим и так далее.
[02:52:20.360 --> 02:52:21.360]  Вот.
[02:52:22.360 --> 02:52:26.360]  И тогда получится, что итоговую мы обнаружили, тогда мы домножаем на эту штуку и тогда он получается ради того, чего надо.
[02:52:27.360 --> 02:52:32.360]  Ну, делаем это, делаем то же самое с этой стороны, складываем, радуемся.
[02:52:33.360 --> 02:52:34.360]  Вот.
[02:52:36.360 --> 02:52:38.360]  Да, получается лог квадрат.
[02:52:43.360 --> 02:52:44.360]  Вот. Да.
[02:52:46.360 --> 02:52:48.360]  Так что вот такое вот шоу.
[02:52:52.360 --> 02:52:53.360]  Вот.
[02:52:54.360 --> 02:52:57.360]  Как говорится, вот таким вот было быстрое преобразование фурье.
[02:52:59.360 --> 02:53:02.360]  Господи, что ж вам еще рассказывать-то теперь?
[02:53:04.360 --> 02:53:06.360]  Нет, ну, точнее я найду, что рассказывать.
[02:53:07.360 --> 02:53:10.360]  Честно говоря, я даже не ожидал, что мы так быстро закончим.
[02:53:10.360 --> 02:53:15.360]  Но судя по всему, знаете, когда вы рассказывать не три пары подряд и четыре пары подряд, все-таки свои преимущества имеет.
[02:53:18.360 --> 02:53:25.360]  Нет, просто я вас могу, кстати, могу вас поздравить, по меркам как минимум двухлетней, даже однолетней давности мы только что закончили программу первого семестра.
[02:53:29.360 --> 02:53:32.360]  Нет, заметьте, и это при том, что софт-хипа там не было.
