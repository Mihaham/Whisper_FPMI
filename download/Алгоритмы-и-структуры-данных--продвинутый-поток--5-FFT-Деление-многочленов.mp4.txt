[00:00.000 --> 00:13.440]  Ладно, так и быть. Как говорится, это было сложное, в скобках нет решения, но сегодня мы все-таки
[00:13.440 --> 00:24.640]  перейдем к FFT. Мы ждали этого долго, мы откладывали это как могли. Ну в принципе, при большом желании
[00:24.640 --> 00:32.160]  у меня там по серверам 3 битс какой-то материал есть даже, но нет. Хотя нет, до сервера 3 битса мы тоже
[00:32.160 --> 00:40.360]  в свое время дойдем, естественно, но значит FFT так FFT. Так, ну в принципе, давайте вспоминать,
[00:40.360 --> 00:50.720]  какую задачу мы вообще решаем? Да. Ответ, какую из них? Вчера на кубке 3-5 задачи разбирали,
[00:50.800 --> 00:55.160]  да. Правда, выяснилось, что одну из них разбирали в теме тернарный поиск, да, но это другой вопрос.
[00:55.160 --> 01:03.440]  Вот, а мы с вами еще не разбирали. Вот, разбираем. Вот, а пока же мы решаем простую задачу. Даны два
[01:03.440 --> 01:14.880]  многочлена, перемножьте их, пожалуйста. Вот. Да, значит, напомним обозначение. А ну как напомним,
[01:14.880 --> 01:21.720]  ведем. Значит, смотрите, да, как известно, многочлены есть степень. Значит, мы пойдем дальше,
[01:21.720 --> 01:29.600]  скажем, что многочлены есть размер. Вот, будем говорить, что у нас многочлен имеет размер N,
[01:29.600 --> 01:38.080]  если у него N коэффициент. Значит, размер, он будет не точен, то есть в принципе старше коэффициент
[01:38.080 --> 01:44.480]  тоже может быть нулевым. Ничего страшного. Вот. То есть, мы можем сказать, что там размер,
[01:44.480 --> 01:49.080]  там, многочлен размера 5, это то же самое, что многочлен размера миллион. Просто там куча нулей.
[01:49.080 --> 01:54.040]  Вот, ну обычно, конечно, интуитивно нам это не очень нужно будет, но просто так, такой термин мы
[01:54.040 --> 02:02.680]  вводить себе будем. Вот. Значит, нам очень хочется перемножить два многочлена. Давайте пока для
[02:02.680 --> 02:12.480]  простоты будем считать, что они одинакового размера. Что же тут можно сделать? Ну, в принципе,
[02:12.480 --> 02:19.640]  да, карацубом мы уже в прошлом семестре с вами обсуждали, помнится, да. Вот. То есть,
[02:19.640 --> 02:25.200]  не будем повторяться, да, там, за как уже говорили, да, можно, там уже упоминалось, что можно,
[02:25.200 --> 02:30.560]  по идее, делить не на две части, а на три, четыре, пять, восемь и, в общем там, бесконечно долго
[02:30.560 --> 02:37.120]  развлекаться. Ну, вот, не будем сейчас на этом останавливаться. Вот, хотя будет интересно на
[02:37.120 --> 02:43.160]  экзамене вас спросить, как это делать, да. Нет, это хорошая задача на экзамен, на самом деле, да. Вот.
[02:43.160 --> 02:50.480]  Вот. Но, тем не менее, значит, мы пойдем другим путем. Значит, оказываю, ну, вот, потому что очень
[02:50.480 --> 02:56.480]  хочется все делать быстрее, чем за n в степени 1 плюс эпсилон. И идея такая есть, правда,
[02:56.480 --> 03:03.680]  нам придется кое во что поверить. Но об этом чуть позже. Потому что первая идея, которая возникает,
[03:03.680 --> 03:11.920]  возникает, когда мы хотим поперемножать многочлены, это, а как вообще хранить многочлены? Вот,
[03:11.920 --> 03:22.280]  в каком виде можно хранить многочлен размера n? Нет, дело даже не в этом. Ну, вот. Потому
[03:22.280 --> 03:26.960]  что, конечно, многочлен, но обычно мы храним в памяти, да. Логично хранить n чисел, которые
[03:26.960 --> 03:37.480]  являются вот этими коэффициентами. Ну, вот. Но, может быть, есть другие способы. Вот, кстати,
[03:37.480 --> 03:43.600]  самое смешное, что n корней хранить не получится. Многочлен ты не задашь однозначно. Ты его задашь
[03:43.600 --> 03:53.920]  с точностью до мультипликативной константы. Да, но есть риск, что это будет уже не n чисел, а n
[03:53.920 --> 04:02.760]  плюс 1. Ну, как-то. Нет, но хочется, чтобы еще там, ну да, чтобы излишнего не было, однозначность была
[04:02.760 --> 04:09.360]  нет. Оказывается, есть другой неожиданный вариант. Потому что есть вот вариант многочлена А, это вот
[04:09.360 --> 04:20.240]  в виде А0, А1 и так далее Аn-1. Вот. А, в принципе, можно вместо этого, я могу просто, если я знаю,
[04:20.240 --> 04:29.040]  что многочлен размера n, ну я так или иначе это знаю, вот, то я могу вместо этого действительно
[04:29.040 --> 04:35.640]  хранить такие вещи, как значение многочлена А в точке 0, значение многочлена точка А в точке 1,
[04:35.640 --> 04:52.960]  значение многочлена в точке 2 и так далее. Вот. Мультипликативная константа. Если ты
[04:52.960 --> 05:04.920]  давно многочлен на, собственно, 57, то корень n-1. А ведь действительно, да. Как говорится,
[05:04.920 --> 05:14.240]  да, у нас не степень n, у нас, да. Это хорошо. Вот. Это такое есть. Но правда, если тут 0, то как
[05:14.240 --> 05:22.160]  бы есть риск, что корней будет все-таки меньше. Вот. Даже с учетом этих ваших кратностей. Да. Вот.
[05:22.160 --> 05:27.520]  Ну и отдельная песня еще там доказывает, что этот корень существует когда-то там. А вот скотина такая
[05:27.520 --> 05:34.640]  не всегда существует, потому что мы не в ТФКП и не в топологии. Вот была бы у нас топология, были бы у
[05:34.640 --> 05:44.240]  нас комплексные числа. Вот. Ну, в общем, ладно, это все будет, как бы, куда деваться-то. Ладно,
[05:44.240 --> 05:49.680]  но пока заметим, что, в общем-то, нам может хватить и этого. Да, потому что действительно парадокс
[05:49.680 --> 05:53.640]  заключается в том, что, действительно, мало того, что, да, конечно, по коэффициентам восстановится
[05:53.640 --> 06:00.560]  значение однозначно, но фишка в том, что по вот этим n значениям вы тоже прекрасно восстановите
[06:00.560 --> 06:07.800]  коэффициенты. Причем одна эта трасса однозначно. Ну вот. То есть, ну, собственно, да, вы уже сдали,
[06:07.800 --> 06:12.680]  так вы уже, видимо, сдали линал за первый семестр, поэтому даже без труда это докажете,
[06:12.680 --> 06:29.640]  наверное. Вот, конечно. Каким образом? В слух. Так, классно. В слух от противного сопряженное пространство.
[06:42.680 --> 06:56.680]  Да, почему очевидность? Так, ну, допустим, да. Нет, ну, давайте скажем так. Нет, я это все-таки
[06:56.680 --> 07:03.080]  напишу, потому что нам это пригодится. Дело в том, что, да, оказывается, что просто можно написать
[07:03.080 --> 07:11.000]  вот такую вот, так сказать, систему линейных уравнений. То есть, оказывается, что это вот равно
[07:11.000 --> 07:24.800]  вот такой эпическое мото. Так, 1, 1, 1, 1, 1, 1, 2, 4, 2 в степени n-1 и так далее. Там 1, n-1, n-1 в квадрате.
[07:24.800 --> 07:39.520]  Ну вот. О, вы знаете фамилию Вандермонд. Здорово. Нет, просто не все ее знают, на самом деле, как я с
[07:39.520 --> 07:46.280]  удивлением выясняю. Да, поэтому, да, хорошо. Но хотя ладно, это еще не самый мощный Вандермонд,
[07:46.280 --> 07:52.880]  который вообще есть. Да, потому что фишка, что можно записать такую штуку и основное
[07:52.880 --> 08:00.360]  мистическое утверждение заключается в том, что это матрица обратима. Более того, оказывается,
[08:00.360 --> 08:06.920]  это нам сильно поможет, что на самом деле, в общем-то, это не потому, что я тут выбрал числа 0, 1, 2, 3 и так
[08:06.920 --> 08:12.520]  далее. На самом деле, я здесь могу выбрать абсолютно любые n попарно различных, вот единственная
[08:12.520 --> 08:21.560]  оговорка чисел. То есть, могу вообще вот так вот обнаглеть. Вот. То есть, главное число зафиксировать.
[08:21.560 --> 08:34.120]  Tn-1. Вот. И остается только да. Что-то тут еще остается. Вот. Остается написать, соответственно,
[08:34.120 --> 08:40.920]  там 1, там T0, T0 квадрат. Да, тут, наверное, тоже надо T0 в нулевой лучше написать тогда уже.
[08:40.920 --> 08:52.600]  Т0. Чего? Ах, да, да, да, да. Вот. То есть, получается вот такая красота. Не такая. Вот такая красота.
[08:52.600 --> 09:05.960]  Так. 1 в квадрате. Бум-бум-бум. T1 в степени минус 1. В общем, красота. T2, 1. T2. Так.
[09:05.960 --> 09:27.360]  Вот. Вот. Ну вот. И оказывается, что действительно у нас эта матрица, оказывается, обратима тогда
[09:27.360 --> 09:34.120]  и только тогда, когда все т-шки попарно различные и определитель у нее оказывается равен там. То есть,
[09:34.120 --> 09:43.920]  определитель вот этого вот равен, оказывается, там, чему-то. Ну, там, да, что-то типа Tg-T-Ti,
[09:43.920 --> 10:02.440]  где 0 меньше либо равно и меньше g. Вот. Или наоборот. Не, ну да. Как спрашивать,
[10:03.400 --> 10:17.040]  так. Нет, неправильно. А нет. А нет, правильно. Ну, можно так. Не, ну да. В принципе,
[10:17.040 --> 10:22.000]  нет. Самое смешное, что в курсе линала иногда это опускается, но, на самом деле, неплохое
[10:22.000 --> 10:27.000]  упражнение, собственно, там этот определитель в явном виде вывести. Это оказывается даже
[10:27.000 --> 10:34.080]  легче, чем кажется. На самом деле. Как-то там. Ну, там, при желании, да, когда три года назад мы
[10:34.080 --> 10:40.400]  с этим даже развлекались. Вот. Но сейчас время тратить не будем. Вот. То есть, просто поверьте,
[10:40.400 --> 10:44.920]  об этом практически обычный гаусс тут, на самом деле, и немножко там, и немножко алгебры 9 класса
[10:44.920 --> 11:02.320]  тут прекрасно работает. А даже так. Ой, отлично. Ой, вы. Да. И что получилось? Нет, ну, нет. Ну,
[11:02.320 --> 11:09.840]  это есть комплексные корни из единицы, а если произвольные числа. А, окей, слушайте. Ой, слушайте,
[11:10.720 --> 11:22.520]  как хорошо. Да. Ой, придется сервент-ребиц изучать точно. Сервент-ребиц там. Не изучали. Все. Нет,
[11:22.520 --> 11:28.480]  то я понимаю, что вы там не изучали на семинарах софт-хип. Это да. Вот. Ладно. Значит, восхитительно.
[11:28.480 --> 11:33.480]  Значит, что тогда нам это помогает? Пока, конечно, алгебрически нам это не сильно помогает,
[11:33.480 --> 11:43.160]  потому что конкретное обращение у нас работает за куб. Но зачем нам вообще это надо? Ну, идея
[11:43.160 --> 11:51.040]  заключается в том, что в таком виде, кажется, произведение многочленов искать чуть-чуть
[11:51.040 --> 11:57.920]  проще. Почему? Потому что если брать произведение многочленов в виде коэффициентов, то там
[11:57.920 --> 12:10.240]  определение будет квадрат. Вот. Что делать здесь? А здесь, оказывается, вроде и хорошо. Потому что
[12:10.240 --> 12:16.080]  если у вас есть многочлен А, многочлен В, и вам очень хочется, чтобы тут был еще и многочлен С,
[12:16.080 --> 12:25.600]  который равен А умножить на В, то конкретно вот в таком виде, то есть если вот у нас есть, допустим,
[12:25.600 --> 12:39.720]  вот. Значит, есть у нас паранот. То есть записан такая штука и еще такая же для В. В от Т1,
[12:39.720 --> 12:51.200]  там В от Т2 и так далее. В от Тn-1. То, что у нас получается. То тогда у многочлена С тоже
[12:51.200 --> 13:04.120]  очень легко можно найти значение многочлена С в точках Т0, Т1, Т2 и так далее. Тн-1. Очень легко.
[13:04.120 --> 13:10.560]  Как конкретно? Ну, очень просто. Потому что значение многочленов в точке Т2 это,
[13:10.560 --> 13:16.520]  очевидно, А от Т2 умножено Т от Т2. Тут, просто честно, поточечное умножение. Прям предельно.
[13:17.000 --> 13:23.480]  Вот. Ну, единственная, конечно, подлянка, что, да, эти значения в n-точках мы, конечно,
[13:23.480 --> 13:28.440]  вычислим, но есть маленькая оговорка. Оговорка будет заключаться, что, конечно же,
[13:28.440 --> 13:34.640]  произведением многочленов размера n не обязана быть размера n. Точнее, формально,
[13:34.640 --> 13:40.800]  не обязана укладываться в размер n. Оно укладывает сток в размер 2n. Ну, точнее,
[13:40.800 --> 13:47.280]  2n-1, если быть точнее. Вот. Но, с другой стороны, как мы уже и сказали, любое
[13:47.280 --> 13:56.560]  многочлен размера n мы при желании всегда можем представить себе, как многочлен размера 2n. Вот.
[13:56.560 --> 14:08.760]  Ну, если значение в точках, да. А вот если коэффициенты легко. В результате у нас
[14:08.760 --> 14:23.760]  появляется такая классическая схема. Вот. То есть у нас задан многочлен А, в виде А0,
[14:23.760 --> 14:37.560]  А1 и так далее. Аn-1. И, допустим, многочлен B. В виде B0, B1 и так далее Bn-1.
[14:37.560 --> 14:47.840]  Значит, мы должны изобрести какой-то черный ящик, который умеет по этим n-коэффициентам,
[14:47.840 --> 14:55.720]  ну, там, дописав мысли на несколько ноликов. Вот. Соответственно, вычислить значение этого
[14:55.720 --> 15:08.520]  многочлена в числах t0, t1 и так далее. Там t, n-, там t, даже 2n-1. Давайте сразу
[15:08.520 --> 15:16.200]  запишем. Да. Получается вот такая вот идея. Да, здесь тоже мы мысленно записываем нолики. И
[15:16.200 --> 15:30.000]  получается, значит, тут что получается? B от t0, там B от t1 и так далее. B от t2n-1. Вот.
[15:30.000 --> 15:38.960]  Значит, это, значит, если какой-то мистический черный ящик, значит, это сделал тут и там,
[15:38.960 --> 15:52.120]  то за линию мы получаем c от t0, c от t1 и так далее, c от 2, точнее t2n-1. И, собственно,
[15:52.120 --> 15:57.840]  все. Вот. Ну как все? То есть теперь надо по этим коэффициентам, то есть по этой штуке мы
[15:57.840 --> 16:08.840]  восстанавливаем теперь многочлен c в виде уже коэффициентов c0, c1, c2 и так далее, c2n-1. То
[16:08.840 --> 16:17.560]  есть вот такая вот идея неожиданно у нас возникает. Вот. Но осталось только самое малость придумать
[16:17.560 --> 16:24.360]  черный ящик. Ну нет, ну можно сказать черный, можно два, а можно сказать такой один черный
[16:24.360 --> 16:32.560]  ящик, но только придумать его так, чтобы все действия в нем можно было обратить. То есть
[16:32.560 --> 16:36.440]  потому что здесь надо сделать буквально то же самое, что здесь, только в обратную сторону.
[16:39.440 --> 16:49.880]  Ну потому что здесь надо по многочлену получить его значение в точках. Тут по значениям в точках
[16:49.880 --> 16:56.520]  надо восстановить коэффициенты. То есть нет, ну формально, да, это черный ящик, это черный ящик.
[16:56.520 --> 17:03.760]  Просто говорим, что это там. Ну вот. То есть в принципе, то есть как повезет с алгоритмом.
[17:03.760 --> 17:08.280]  Может там скорее желать, потому что алгоритм был устроен так, что все шаги, которые мы тут делаем,
[17:08.280 --> 17:13.800]  можно просто сделать в обратном порядке и собственно получить такую счастье. Вот. Ну,
[17:13.800 --> 17:18.720]  по крайней мере, мы знаем, что эти два вида многочленов восстанавливаются друг из друга,
[17:18.720 --> 17:24.720]  поэтому есть надежда, что такое получится. Вот. Хочется, конечно, как-то это делать и желательно
[17:24.720 --> 17:31.840]  не за квадрат. Или, а то в этом случае вообще за куб. Ну или там, за сколько вы там умеете
[17:31.840 --> 17:57.720]  кауса писать. Не, ну. Да, мечта мечта. Ну, по-разному вычислить, а тут можно. Ну вот,
[17:57.720 --> 18:04.280]  но в нашем случае и так, значит, сосредоточимся сейчас на подзадачу, которую мы решаем.
[18:04.280 --> 18:12.800]  Итак, то есть мы хотим, значит, давайте сейчас вот, значит, удобно делать так. То есть у нас есть
[18:12.800 --> 18:22.680]  наращен АТ, который, у которого размера все-таки n. Вот. А2t квадрат плюс и так далее плюс Аn минус
[18:22.680 --> 18:29.880]  1 на t в степени n минус 1. Вот. Да, там было 2, но как бы мы считаем, что если нам надо было добить
[18:29.880 --> 18:38.020]  нулями, мы это уже сделали. Вот. И нам хочется восстановить, уметь по нему восстановить значения
[18:38.020 --> 18:45.160]  в заданных, в каких-то вот n точках. И желать, и хочется делать это быстро. Как же это делать
[18:45.160 --> 18:54.440]  быстро? Ну, тут мы замечаем, что у нас пока в алгоритме есть большая степень свободы, связанная
[18:54.440 --> 19:00.680]  с тем, что мы пока не фиксировали, а в каких конкретно t-шках мы это будем делать. А ведь, в общем-то,
[19:00.680 --> 19:06.200]  никто нам не мешает действительно выбрать какие-нибудь хорошие t-шки так, чтобы конкретно в этих
[19:06.200 --> 19:16.400]  числах все вычисляло хорошо. Ну, мы на самом деле выберем, но мы немножко обнаглеем. Ну, собственно,
[19:16.400 --> 19:25.560]  что нередко у нас наблюдается. Значит, во-первых, мы скажем, что n это степень двойки. Вот. Ну, в общем,
[19:25.560 --> 19:33.360]  понятно, симпатически нам это походу не сделает. А во-вторых, мы теперь скажем, что, значит,
[19:33.360 --> 19:45.640]  мы введем такое мистическое число. Как бы его назвать? Мнимо единица? Эпсилон. Нет,
[19:45.640 --> 20:01.080]  Wn. Значит, смотрите, мы введем такое читерское число, что, во-первых, Wn в степени n равно единице.
[20:01.080 --> 20:21.520]  И второе. Да, ну вот. Значит, все его степени до n попарно различные числа.
[20:31.080 --> 20:46.360]  Да, я немножко обобщаю. Да, и в нулевую тоже. Вот, попарно. Ну, просто такое вот удобство.
[20:46.360 --> 21:00.120]  Ну, на самом деле, в принципе, заметим, что, наверное, в принципе, легко показать,
[21:00.120 --> 21:05.560]  пока если мы верим, что Wn у нас вообще находится в каком-то поле. Ну, или что то же самое. То есть,
[21:05.560 --> 21:14.000]  можно как-то адекватно делить. Вот. То тогда, в принципе, это равносильно условиям, что Wn в
[21:14.000 --> 21:22.680]  степени n равно 1, а Wn в степени n пополам, ну, учитывая, что это степень двойки, не равно единиц.
[21:22.680 --> 21:34.720]  Ну, потому что есть мистическое свойство. Какое у нас мистическое свойство? Что если кто-то в
[21:34.720 --> 21:39.320]  какой-то степени меньше n будет единицей, то есть, если у Wn n на степень будет меньше единицы и
[21:39.320 --> 21:45.720]  какая-то еще степень меньше n будет единицей, то тогда, значит, утверждается, что n пополам той
[21:45.720 --> 21:53.920]  степени обязательно будет единицей. Да, можно, собственно, можно оперировать, например, вот
[21:53.920 --> 22:01.080]  такими терминами. Да, совершенно верно. Да. Вот. Но там, на более простом уровне, можно там показать,
[22:01.080 --> 22:05.960]  например, что если у вас p-тая степень равна единице и q-тая степень равна единице, то gcd от
[22:05.960 --> 22:16.840]  q-тая степень тоже равна единице. Да, доказывается просто обычным алгоритмом. Вот. Тут, соответственно,
[22:16.840 --> 22:22.320]  тоже все понятно. Да. Вот. Но в нашем случае, да, когда у нас все делители это степень двойки,
[22:22.320 --> 22:28.040]  то получается так. Так, спрашивается, где же нам такое число найти? В действительных числах,
[22:28.040 --> 22:38.920]  ну, если n больше двойки, то как-то, ну, не существует. Вот. Ну, значит, действительно, основное, где мы это
[22:38.920 --> 22:47.680]  находим, это, конечно, в комплексных числах, потому что выясняется, что wn, оказывается, очень удобно
[22:47.680 --> 22:58.080]  ввести как cos 2p делить на n плюс i на sin 2p делить на n. Ну, или что то же самое,
[22:58.080 --> 23:14.920]  e в степени 2p делить на n и. Ну, можете считать, что это определение. Вот. Так. Хотя есть подозрение,
[23:14.920 --> 23:25.600]  что комплексных чисел у вас пока еще не было. Да. Нет. Ну, так. Я не верю, что в комплексных числах
[23:25.600 --> 23:35.080]  вводится понятие первообразной корень. Матрица. Нет. Ну, давайте так. Ну, давайте так. То есть,
[23:35.080 --> 23:42.360]  некоторые... Ну, про комплексные числа придется немножко поговорить. Нет. Что это такое? Вот.
[23:42.360 --> 23:53.400]  Ну, давайте просто там, некоторую такую базу скажу. Просто чтобы... Вот. То есть, понятно,
[23:53.400 --> 23:58.120]  что да. Там кто-то из вас, в принципе, с этим сталкивается. Что вообще такое комплексные числа?
[23:58.120 --> 24:02.840]  Ну, надо. Как известно, у нас в обычных числах есть такая проблема, что не всех чисел можно
[24:02.840 --> 24:07.640]  извлечь, например, квадратный корень. И там не во всех многочленах можно вообще корень найти.
[24:07.720 --> 24:17.120]  Как решить эту проблему? Ну, идея очень простая. Мы вводим новые числа. Мы, значит, объявляем
[24:17.120 --> 24:25.880]  комплексным числом число вида A плюс запись. Пока. Или, как в колбаклассе, картинка вида A плюс B.
[24:25.880 --> 24:36.920]  А вы говорите, нет. Как матрицы.
[24:36.920 --> 24:57.320]  Так, давайте. Господи, я простой рабочий христианский человек. Давайте сейчас попроще введем.
[24:57.320 --> 25:06.240]  А то матрица, господи. Нет, я понимаю, что комплексные числа отражают выше смысл
[25:06.240 --> 25:13.560]  супрематизма бытия и все такое, но давайте попроще, пожалуйста. Нет, я понимаю, что все это у вас на алгеме было,
[25:13.560 --> 25:20.720]  да. Кроме, может быть, супрематизма и то вряд ли. Значит, смотрите. Все у нас определяется попроще.
[25:20.720 --> 25:27.400]  Значит, мы вводим мистическое число и, которое объявляем, что оно не равно никому действительному числу,
[25:27.400 --> 25:33.840]  и заявляем, что и в квадрате, вот такое правило умножения, и в квадрате равно минус единиц.
[25:33.840 --> 25:43.720]  Да, это число называется теперь мнимой единицей. И теперь мы объявляем, что у нас теперь есть числа
[25:43.720 --> 25:48.960]  А плюс БИ, для которых мы должны ввести как-то адекватно правила сложения и умножения.
[25:48.960 --> 25:55.120]  Ну, мы их вводим так, чтобы у нас там все коммутативности, всякие коммутативности, ассоциативности
[25:55.320 --> 26:04.480]  выполнялись. Поэтому понятно пишем, что А плюс БИ плюс С плюс ДИ это равно у нас там А плюс С плюс
[26:04.480 --> 26:17.360]  В плюс Д на И. Ну, с минусом получается автоматически. Ну, а перемножение мы просто вводим так,
[26:17.360 --> 26:24.240]  что хочется верить в дистрибутивность. В результате получается там прямо по определению, то есть,
[26:24.400 --> 26:29.520]  по раскрывать скобочки, то получается там АС минус БД. Ну, потому что БИ на ДИ получается
[26:29.520 --> 26:37.960]  минус БД. Плюс там, соответственно, АД плюс БС на И. Тут пока все просто. Правда, отдельная песня,
[26:37.960 --> 26:47.800]  а как нам теперь делить? Вот, можно ли у нас, оказывается, поделить на комплекс три числа?
[26:47.800 --> 26:55.880]  Ну, вот. Ну, основная идея, может, я не буду сейчас дописывать до формулы, но такая. Это называется
[26:55.880 --> 27:06.200]  домножим на сопряженное. Да, определение. Сопряженное число С плюс ДИ это равно С минус ДИ. Вот.
[27:06.200 --> 27:12.600]  Значит, зачем так домножать? Ну, потому что оказывается, что если С плюс ДИ умножить на С
[27:12.600 --> 27:22.040]  и минус ДИ равно банально С квадрат плюс, обратите внимание, Д квадрат. Да, это мы так вычли ДИ в квадрате.
[27:22.040 --> 27:27.400]  Вот. Поэтому, ну вот. Ну, и соответственно, да, здесь это уже действительное число,
[27:27.400 --> 27:32.960]  поэтому дальше что понятно, дальше формулы расписывать не буду. То есть, приятно то,
[27:32.960 --> 27:38.080]  что действительно на любое не нулевое число поделить вполне можно, вполне себе однозначно.
[27:38.080 --> 27:44.760]  Очень удобно. Вот. Но, конечно, основное, что тут нужно понимать, даже не здесь. То есть,
[27:44.760 --> 27:50.560]  пока это просто так веселые картинки на уровне алгебры. Значит, на уровне геометрии у нас
[27:50.560 --> 27:55.360]  выглядеть будет следующим образом. Смотрите. То есть, обычно комплексная плоскость рисуется
[27:55.360 --> 28:05.000]  вот в виде вот такого единичного круга. Вот. И каждое число там, допустим, А плюс БИ. Вот,
[28:05.000 --> 28:12.200]  допустим, какой-нибудь А плюс БИ можно нарисовать. То есть, вот, в виде вот такого вектора. То есть,
[28:12.200 --> 28:16.000]  такая вот связь с геометрией. То есть, заметим, что сложение-вычитание тогда выполняется просто
[28:16.000 --> 28:29.800]  абсолютно как сложение, ну, сложение векторов, ну, и вычитание. А вот что такое произведение? Да. Ну,
[28:29.800 --> 28:35.880]  вот тут оказывается, что комплексных числа можно, на самом деле, оказывается, представлять не только
[28:35.880 --> 28:49.760]  в виде вот А плюс БИ, а можно сказать, что это равно РО, ну, вот, да, на Е в степени И альфа. Или что
[28:49.760 --> 28:58.640]  тоже самое. Можно сказать, что это РО на Косинус альфа плюс и Синус альфа. Вот. Где оказывается,
[28:58.640 --> 29:06.200]  что РО это длина этого числа, но длина этого вектора в смысле, а альфа это полярный угол этого вектора.
[29:06.200 --> 29:13.360]  То есть, тогда можно число записать буквально в такого виде. Вот. То есть, вот опять два вида.
[29:13.360 --> 29:24.320]  Есть вид АБ, то есть, ну, вот, а есть вид РО альфа. Вот. И вот, оказывается, вызекает мистический факт.
[29:24.320 --> 29:35.360]  То есть, оказывается, что если я сейчас перемножу там два числа в таком виде,
[29:35.360 --> 29:46.800]  то у нас появится число, у которого модуль равен произведению модулей исходных чисел. Ну, тут пока,
[29:46.800 --> 30:00.920]  ну, вот. А углы надо, оказывается, сложить. Вот такое неожиданное мистическое свойство. Ну,
[30:00.920 --> 30:05.800]  то, что модули надо сложить, наверное, тут, то есть, перемножить тут нерлогично. Если вы вот это
[30:05.800 --> 30:12.960]  будете перемножать там две картинки такого вида, то РО1, РО2 будет. Да. Вот. Но с альфами тоже не
[30:12.960 --> 30:18.640]  сильно сложно, потому что если вы тут две скобочки с Косинусом и Синусом и перемножите, то там то,
[30:18.640 --> 30:24.800]  что вы увидите, будет как раз там Косинус-сумма или Косинус-разность. Да-да-да, Косинус-сумма и
[30:24.800 --> 30:29.960]  Синус-сумма. Да. Правда, единственная, конечно, подлянка заключается в том, что, возможно,
[30:29.960 --> 30:37.480]  именно через комплексные числа, в общем-то, эти формулы и доказываются обычно. Нет. Ну,
[30:37.480 --> 30:41.400]  я не знаю, просто я вот, что-то никогда не понял его. А вот, допустим, есть вот эта вот формула
[30:41.400 --> 30:48.720]  мистическая, да? Косинус альфа-1 плюс альфа-2 равно, там, чимон там равна Косинус альфа-1, Косинус альфа-2,
[30:48.720 --> 30:59.760]  минус там Синус альфа-1, Синус альфа-2. Чего повороты?
[30:59.760 --> 31:07.760]  Скалярное произведение.
[31:07.760 --> 31:23.120]  Нет, ну тут поразу, да, можно определять Косинус именно так, а можно определять Косинус,
[31:23.120 --> 31:30.480]  как он определяется обычно. Ну вот, ну ладно, действительно ладно, потому что нет, это отдельная
[31:30.480 --> 31:36.960]  песня, потому что, да, как это тогда доказывать, ну вот, хорошо, да, можно по-разному это делать,
[31:36.960 --> 31:41.480]  действительно ладно. Действительно, вкапываться в такие детали, действительно, уже тоже не хочется,
[31:41.480 --> 31:49.280]  это уже действительно не совсем наш предмет, это да. Так, но, соответственно, как, ну вот,
[31:49.280 --> 31:56.600]  но для нас главное, да, что, да, ну автоматически, конечно, что если я хочу поделить число на число,
[31:56.600 --> 32:05.120]  то здесь получается понятно, модули делим, углы вычитаем, да, с оголокой, что углы мы, естественно,
[32:05.120 --> 32:12.200]  да, вычитаем по модулю 2p, потому что если я к углу прибавлю 2p, то, собственно, это называется,
[32:12.200 --> 32:19.880]  мы развернулись на 360 градусов. Ну, собственно, как политика периодически так делает. Вот,
[32:19.880 --> 32:32.000]  соответственно, вот, итак, значит, чем это помогает нам? А помогает нам это вот чем? Потому что нам
[32:32.000 --> 32:38.800]  жутко хочется в комплексных числах решить мистическое уравнение z в степени n равно 1.
[32:38.800 --> 32:50.000]  Так, но начнем, на самом деле, с того, что, ну, как вот из этой формулы автоматически следует,
[32:50.000 --> 32:58.680]  то, как бы, если мы возведем число ρα в степени n, то это будет равно там ρ в степени n и альфа n.
[32:58.680 --> 33:02.000]  Да.
[33:02.000 --> 33:17.800]  Классно, да. Нет, это больше похоже на авторские отчисления, да, скорее, да, то мало ли там. Вот.
[33:17.800 --> 33:30.800]  Ну, вот, еще 12, да, 16, да, 16 цифр, да, да, да, название банка, там вот это. Вот, да, есть у нас
[33:30.800 --> 33:37.560]  такая действительно приятная формула, действительно, именуемая формула Муавра. Так, иначе,
[33:37.560 --> 33:41.960]  мы хотим найти, чтобы эта штука была равна единице, но чтобы она была равна единице,
[33:41.960 --> 33:47.240]  получается, мы вынуждены отметить, что ρ должно быть равно 1, ну, тут без вариантов,
[33:47.240 --> 33:55.120]  в действительных числах, вот, а альфа n равно, как бы, у нас в школе привыкли писать 2, там,
[33:55.120 --> 34:03.920]  2p, ладно, l, ну-ка, у нас там занято просто, вот, где там l, это какое-то целое число.
[34:03.920 --> 34:14.120]  Да, да, это не обязательно, альфа n не обязательно быть равно 0, оно обязательно быть равно 0 по
[34:14.120 --> 34:22.520]  модулю 2p, а это, собственно, вот это, или что то же самое, вот. Вот, значит, то что же это
[34:22.520 --> 34:27.960]  за мистические числа? Ну, оказывается, действительно, таких альф, ну, по модулю 2p,
[34:27.960 --> 34:35.920]  я могу подобрать, оказывается, ровно n. Чтобы мне подобрать ровно n чисел, то есть я, оказывается,
[34:35.920 --> 34:47.240]  беру просто эту окружность и делю ее на n частей. Вот, допустим, для n равно 16, я сейчас рисую. Вот.
[34:47.240 --> 34:57.000]  Вот. То есть вот такая вот получается красота.
[35:05.920 --> 35:15.720]  Вот. То есть вот как-то так действительно это выглядит. И так у нас выглядят действительно эти корни.
[35:15.720 --> 35:21.520]  Но фишка заключается в следующем, что если я возьму вот этот самый первый wn, вот который мы
[35:21.520 --> 35:28.120]  вот там и написали, то оказывается, что все эти корни являются степенями этого, то есть вот
[35:28.120 --> 35:34.880]  нулевая степень, первая степень, вторая степень, третья и так далее до n-1. Вот.
[35:34.880 --> 35:40.960]  Ну, в принципе, неудивительно, да, то есть частости оказывается, что wn в степени n пополам равно,
[35:40.960 --> 35:48.400]  получается, минус 1 и получается, что, кстати, вот этим свойством у нас это wn удовлетворяет.
[35:48.400 --> 35:57.320]  Вот. Чаще всего будем пользоваться именно этими числами. Хотя, значит, почему я тут ввожу именно
[35:57.320 --> 36:05.040]  в таком, в общем, случае есть там бывает и другая ситуация. Такая тоже, на самом деле, популярная
[36:05.040 --> 36:17.760]  в некоторых областях науки. Например, спортивном программировании. Вот. Ну, потому что выясняется,
[36:17.760 --> 36:32.160]  так, так вот же. А сейчас у вас окоточки есть? Не у всех. Да, у некоторых, да, особо
[36:32.160 --> 36:41.000]  информатических людей, да, нету, понятно, да. Вот. Ну, значит, смотрите. Ну, значит, ладно,
[36:41.000 --> 36:45.240]  скажем таки, значит, пару общих, вот, сведений из теории полей. Ну, потому что нам хочется,
[36:45.560 --> 36:50.160]  потому что иногда оказывается очень удобно отправиться вместо этого в поле покормить
[36:50.160 --> 36:58.360]  простому модулю. Какому? Ну, например, да, сейчас, например, завирусилось такое,
[36:58.360 --> 37:04.600]  там спортивном программировании завирусился такой модуль последние там лет там, ну, сколько там,
[37:04.600 --> 37:13.160]  пять, десять. Нет, десять многовато. Вот. Ты где вот хочешь рассматривать вот такое простое число? Да,
[37:13.160 --> 37:19.040]  оно вытесило таких казалось бы корифеев, как там десять девятый плюс семь и десять девятый
[37:19.040 --> 37:25.240]  плюс девять. Нет, оно, конечно, еще, эти модули еще не потеряли своего влияния, но все-таки как-то
[37:25.240 --> 37:33.360]  с большой скоростью этот модуль захватывает, ну, собственно, свою аудиторию. Почему? Ну,
[37:33.360 --> 37:46.120]  идея оказывается следующим. Дело в том, что этот модуль равен 119 на два в 23 плюс один. Вот.
[37:46.120 --> 37:54.960]  Казалось бы, и что? Да, просто факт. А, ну, может, я еще и нагнал, я не знаю масштаб. Ну, вы можете
[37:54.960 --> 38:05.280]  загуглить, проверит. Ну, я не знаю, гугл, наверное, умеет вот такие вычисления делать. Вот. Ну,
[38:05.280 --> 38:13.280]  вот. Ну, значит, чем нам это помогает? Ну, значит, ну, дело в следующем. Дело в том, что это число
[38:13.280 --> 38:22.240]  простое, а у нас есть мистический факт. Мистический факт более известный, как теорема о первообразном
[38:22.240 --> 38:33.760]  корне. Говорит он следующее, то есть теорема, то есть, допустим, пусть у меня мод, допустим,
[38:33.760 --> 38:57.280]  простое число. Тогда, оказывается, существует такой х, не нулевой остаток, что, действительно,
[38:57.440 --> 39:04.540]  оказывается. Так, ну, во-первых, да. Так, ну, во-первых, ладно, давайте упомянем более популярную
[39:04.540 --> 39:15.720]  теорему. Называется более именную, более известную, как малая теорема фирма. Она заключается в том,
[39:15.720 --> 39:27.320]  что, действительно, пусть там мод, простое число, и х у нас какой-нибудь произвольный,
[39:27.320 --> 39:37.760]  не нулевой. Тогда, оказывается, что х в степени мод минус один, да, не тут минус один, вот тут
[39:38.240 --> 39:48.200]  сравним по модулю мод с единицей. То есть, вот, оказывается, есть вот такой мистический факт.
[39:48.200 --> 39:58.360]  Вот. Но еще более мистический факт, оказывается, что, если это верно для любого числа, то здесь,
[39:58.360 --> 40:04.840]  оказывается, верно, что уже не для любого числа, но, оказывается, существует такой х,
[40:04.840 --> 40:14.200]  что числа х в нулевой, х в первой, там, х в квадрате и так далее, х в степени мод минус два,
[40:14.200 --> 40:31.240]  там различны, попарно различны, я бы даже сказал, попарно различны в, соответственно, z-мод.
[40:31.240 --> 40:43.880]  Вот. То есть, это тоже такой неожиданный факт, такое всегда существует. Называется
[40:43.880 --> 41:03.800]  этот х в первообразной корень. Вот. Чем нам это помогает? Это помогает нам тем,
[41:03.800 --> 41:09.540]  что, например, если у нас вот, у нас мод равен вот этому числу, допустим, то у нас, оказывается,
[41:09.540 --> 41:15.380]  найдется такой мистический, ноут. То есть, найдется какой-то такой остаток, то есть,
[41:15.380 --> 41:22.660]  найдется вот этот вот х, ноут, но заметим, что вот, мод минус один равен 119 на два в 23.
[41:22.660 --> 41:29.800]  И так вот, и тут получается, что для этого мод, что если вот, мод равен, допустим, вот это вот 119
[41:29.800 --> 41:37.500]  на два в 23 плюс один, то, оказывается, что, ноут, то пусть, действительно, х это какой-то
[41:37.500 --> 41:51.500]  первообразный корень. Вот какой-то. Почему какой-то? Потому что достаточно очевидно,
[41:51.500 --> 41:59.580]  что их на самом деле будет несколько. Несколько – это, соответственно, phi от mod-1 на самом деле.
[41:59.580 --> 42:05.780]  Вот. Так что при большом желании тоже, на самом деле, это такая теоремочка,
[42:05.780 --> 42:16.980]  которую несложно доказать. Чего? Ну, конечно, логично. Вот. Итак, значит,
[42:16.980 --> 42:23.900]  если у нас х-первообразный корень, то тогда у меня неожиданно возникает такая идея.
[42:23.900 --> 42:36.060]  То есть, если, допустим, у меня n не превосходит 2 в 23, то я могу сказать,
[42:36.060 --> 42:56.340]  что пусть у меня будет Wn будет равно х в степени mod-1 делить на n. Вот. То есть,
[42:56.340 --> 43:03.140]  действительно, легко убедиться, что просто… Ну, допустим, если у меня n 2 в 23, то у меня тогда
[43:03.140 --> 43:11.940]  получается, что в этом ряду ровно 119 на 2 в 23 чисел. Правда? А если я возьму вот этот х в
[43:11.940 --> 43:16.620]  степени 119 и буду возводить его в степени, то у меня в этом ряду будет получаться просто каждое
[43:16.620 --> 43:24.820]  119 число. Вот. И получается ровно те самые степени. То есть там в 2 в 23 степени получится единица,
[43:24.820 --> 43:34.100]  а до этого момента не раз. То есть, то, что нам надо. Вот. То есть, в принципе, то есть,
[43:34.100 --> 43:39.580]  та схема, которую мы изучим, она на самом деле может работать без комплексных чисел. Но у комплексных
[43:39.580 --> 43:45.540]  чисел есть, естественно, недостаток. Нам придется как-то возиться с точностью. Вот. Имейте ее в
[43:45.540 --> 43:53.660]  виду, если быть точнее. Вот. Но на самом деле можно этого избежать, если оказывается, что вы
[43:53.660 --> 43:59.540]  хотите поперемножать многочлены по какому-то простому модулю достаточно хорошего вида,
[43:59.540 --> 44:06.460]  то оказывается, что вы это можете просто делать все, там, делать все умножения просто уже сразу в
[44:06.460 --> 44:15.380]  этом поле и не заморачиваться. Вот. Вот. Ну, в принципе, это на самом деле может быть способ
[44:15.380 --> 44:22.940]  перемножать числа, там, перемножать многочлены и просто. Ну, потому что, например, ну, например,
[44:22.940 --> 44:28.660]  если вы... Вот. Допустим, если у вас... Ну, потому что часто бывает, например, что когда вам нужно
[44:28.660 --> 44:34.220]  перемножить многочлены, вы знаете, что тут чиселки целые и, самое главное, маленькие. Что такое
[44:34.220 --> 44:38.060]  маленькие? Значит, настолько, что у вас даже в произведении, вы знаете, числа будет меньше
[44:38.060 --> 44:43.620]  этого. Тогда, в принципе, все, что вам надо, это забабахать произведение по этому модулю. И все. И
[44:44.500 --> 44:54.380]  не заморачиваться. Но если совершенно случайно выяснится, допустим, что... Если случайно выяснится,
[44:54.380 --> 45:04.620]  что оказывается, что в произведении коэффициенты могут и выйти, в принципе, за пределы
[45:05.620 --> 45:16.300]  многочлена. Что тогда можно сделать? Ну вот. Вопрос, кто звучит, кто. Да. Но если воспринимать
[45:16.300 --> 45:33.620]  слово никто, а КТО. Ух ты. Да. Да. Не, я не знаю. Я не вводил, я не знаю. Да. Так. Нет, я точно не
[45:33.620 --> 45:39.980]  вводил. Вот. Обычно, да. Но оказывается, да, действительно, у нас там есть и возникает,
[45:39.980 --> 45:45.420]  действительно, мистическая китайская тиремма об остатках, которая говорит о том, что если у
[45:45.420 --> 45:54.620]  нам известно, что там х по модулю P1 равно A1, по модулю P2 равно A2, ну может даже в более
[45:54.620 --> 46:03.860]  общем виде, по модулю P3 равно A3 и так далее. То есть, допустим, у нас там целых инцит модулей,
[46:03.860 --> 46:13.020]  да, различных, попарно различных и простых. То, в принципе, утверждается, что эта система,
[46:13.020 --> 46:25.900]  т.е. это равносильно тому, что х, значит, по модулю P1, P2 и так далее PL, сравнимо с каким-то
[46:25.900 --> 46:34.260]  мистическим числом A, значит, действительно, вот A лежит на полуинтервале от нуля до там P1,
[46:34.260 --> 46:42.340]  P2 и так далее PL. И, причем, тиремма заключается в том, что А такое существует и единственное.
[46:42.340 --> 46:52.900]  Вот. То есть, более того, если у вас всего два модуля, то эту систему из двух уравнений по модулю
[46:52.900 --> 46:59.820]  можно даже и решить. Вот. Ну, тут, конечно, да, по-хорошему надо отдельно, конечно. То есть,
[46:59.820 --> 47:09.980]  по текешке, конечно, надо отдельную, видимо, лекцию забабахивать тоже. Вот. Чего? Да, да, да, да,
[47:09.980 --> 47:16.460]  да. Ой, или просто отослать на Emax, да, среди конспектов. Что, как бы, да, штука решается.
[47:16.460 --> 47:21.940]  То есть, да, штука решается, потому что сводится к диафантовым уравнениям. Диафантовые уравнения,
[47:21.940 --> 47:30.940]  естественно, все за логарифом решать умеют, ну, очевидно. Чего? Нет, у нас пока проблема,
[47:30.940 --> 47:39.980]  что да. Да, форма. Хорошо, да. Вот. Ладно. Нет, ну, отдельная песня, что вас там наукотеки заставляли
[47:39.980 --> 47:49.500]  это кудить. Нет, ну, ладно. Нет, ну, не важно. Ладно. Нет, понятно. Ладно, конечно, психовать уже
[47:49.500 --> 47:56.100]  по этому поводу мы не будем. Вот. Но просто фишка заключается в том, что на самом деле просто
[47:56.100 --> 48:02.500]  по произведениям можно попытаться найти по нескольким модулям вот такого вида на самом деле.
[48:02.500 --> 48:12.020]  Почему? По этому модулю, пожалуйста.
[48:26.100 --> 48:33.180]  Ну, не совсем. Нет, ну, как? Перемножим их по паре или тройке таких модулей теоретически,
[48:33.180 --> 48:50.100]  а потом скомпонуем по КТО. Да. Ну, теоретически, да, другой вопрос, что вам уже придется научиться
[48:50.100 --> 48:55.660]  умножать по этому модулю? А это, ну, все плюс-плюс, это как бы придется отдельная песня. Ну, там
[48:55.660 --> 49:01.420]  либо IN-128 вытаскивать, либо там вот эти ваши лайфхаки в доблах. Так что тут. Ну, теоретически
[49:01.420 --> 49:05.660]  может. Нет, на практике на самом деле так. Нет, на практике, конечно, по камере Олимпиады пишут,
[49:05.660 --> 49:10.860]  конечно, через комплексные числа, да. То есть это как бы максимально просто, максимально общу и
[49:10.860 --> 49:17.660]  так далее. Вот. Но с оговорочками. То есть, как бы, знаете, то есть, то есть, то есть, практическая
[49:17.660 --> 49:24.460]  константа считается, что если у вас результирующие коэффициенты получатся порядка 10-12, ну, там,
[49:24.460 --> 49:31.500]  где-то 11-12, то, скорее всего, там радикальных потерь точности не произойдет. То есть, да,
[49:31.500 --> 49:35.180]  понятно вам, когда вы получите коэффициенты, потом в конце их нужно будет правильно округлить,
[49:35.180 --> 49:41.740]  это да. Но как бы там не будет такой радикальной потери точности, что там уже просто даже округление
[49:41.740 --> 49:47.260]  вам уже не поможет. Вот. То есть, где-то так. Здесь 11, здесь 12. А если больше, то надо уже
[49:47.780 --> 49:52.780]  выкручиваться. Выкручиваться можно разными способами. Можно, ну, можно пробовать в ao
[49:52.780 --> 49:56.980]  таким способом. Можно там водить, что есть у вас коэффициенты по миллиону, то говорить,
[49:56.980 --> 50:01.380]  что миллион этот, эээта там коэффициент не больше тысячи умножить на тысячу плюс
[50:01.380 --> 50:07.500]  что-то не больше тысячи. Там, это сведет來 нот. То есть это приведет, то есть там тогда inhabitants
[50:07.500 --> 50:13.500]  расписываются, как там, то есть а равно там а1 плюс тысячи, там, что-то типа, а1 плюс 1000 на
[50:13.500 --> 50:18.100]  на два и тогда у вас тогда произведение сведется, видимо, к четырем произведениям, но ничего странного,
[50:18.100 --> 50:30.340]  но зато все произведения будут мелкими, но там вот разные. Ну, кстати, да. Так что такие вещи есть,
[50:30.340 --> 50:34.820]  то есть вот тут практически рекомендации такие, но вот полезно вот иметь в виду, что соответственно,
[50:34.820 --> 50:38.900]  мы сейчас не об комплексной число сейчас заморачиваться не будем, то есть когда сейчас будем
[50:38.900 --> 50:43.940]  изучать конкретно этот перевод, мы будем просто говорить, что у нас есть мистическая WN с вот
[50:43.940 --> 50:53.220]  такими свойствами. Вот я рассказал основные два способа, из которых это WN выкапывается.
[51:08.900 --> 51:18.500]  Ну, в принципе, да. Нет, мы хотим потребовать, чтобы коэффициенты вашего многочлена можно было
[51:18.500 --> 51:24.060]  как бы с этой вашей группы померить как-то, то есть желательно, чтобы действительно числа туда
[51:24.060 --> 51:32.420]  как бы как-то включились. Вот, поэтому так. То есть хоть с какой-нибудь оговоркой, потому что
[51:32.420 --> 51:37.260]  так-то, конечно, да, любая, действительно, любая циклическая группа порядка N вам вполне себе
[51:37.260 --> 51:48.380]  подойдет на самом деле. Но, правда, нам для алгоритма потребуется степень двойки.
[51:48.380 --> 51:59.900]  О боже, ой. Ну, сейчас давайте подумаем, да. Нет, да. Отдельно просто сколько нам это поможет.
[51:59.900 --> 52:15.260]  Наверное, да. Вот, значит, поехали. Итак, что же нам предлагается? Итак, значит, мы заявляем,
[52:15.260 --> 52:25.100]  что TGT у нас теперь WN в степени G. Значит, вот с такими свойствами W,
[52:25.100 --> 52:30.540]  значит, оказывается, прекрасно работает метод разделяй и властвуй. Ну, как работает? Ну,
[52:30.540 --> 52:37.140]  при этом давайте база индукции. Если N равно 1, как сделать вот это преобразование, когда N равно 1?
[52:37.140 --> 52:43.260]  И как же посчитать?
[52:43.260 --> 52:50.260]  При N равно 1 сложить коэффициенты?
[52:50.260 --> 53:00.980]  Ой, слишком, слишком сложно. Так. Нет, при N равно 1 коэффициент 1.
[53:00.980 --> 53:09.260]  Да, поэтому все еще умнее. Да, на самом деле, то есть, как бы при N равно 1 выглядит так,
[53:09.260 --> 53:19.740]  АТ равно А0, и вам нужно восстановить АТ0, которое равно А0. Поэтому все медли,
[53:19.740 --> 53:22.740]  что надо что-то сложить, какие-то коэффициенты вычислить, это слишком сложно.
[53:22.740 --> 53:33.500]  Потому что надо тупо вернуть обратный вектор, который вам подсунули. Вот. Да, но это база.
[53:33.500 --> 53:40.620]  Если у нас N больше 1, то неожиданно работает следующий приятный метод.
[53:40.620 --> 53:52.420]  Мы объявляем, что А от Т это у нас, оказывается, А0 от Т плюс Т на А1 от Т.
[53:52.420 --> 54:02.780]  Где? Мы уже в коротцубе разделяли нарочлен на два порядка пополам, здесь мы будем делать то же самое,
[54:02.780 --> 54:12.860]  только разделять будем по-другому. А0 от Т заявим мы, он будет, смотрите, чему равен, А0 плюс А2Т
[54:12.860 --> 54:22.900]  плюс А4Т квадрат, плюс и так далее, плюс АН минус 2 на Т в степени, сколько там, Н пополам минус 1.
[54:22.900 --> 54:35.100]  Знаете, я в этом месте люблю так это написать, а потом сказать, добавьте два символа, чтобы утверждение стало верным.
[54:35.100 --> 54:40.580]  Да, но вас не проведешь. Да, да, да, тут квадраты, конечно, да.
[54:40.580 --> 54:59.780]  Вот, Т в степени пополам минус 1. Да, вот такая, оказывается, штука. Вот, чем приятны эти квадраты?
[54:59.780 --> 55:08.860]  Квадраты приятны тем, что если я все комплексные корни порядка N возведу в квадрат, то я получу в
[55:08.860 --> 55:21.940]  точности корни порядка N пополам, только выписанные два раза. Вот, в результате, ну вот, ну тогда,
[55:21.940 --> 55:28.620]  оказывается, что, то есть получается следующее, что действительно, то есть, казалось бы, нам тут
[55:28.620 --> 55:32.780]  нужно подставить N значение, но по факту нам нужно подставить только N пополам значение,
[55:32.780 --> 55:39.620]  штука, только N пополам различных квадратов у нас будут. В результате у нас получается просто,
[55:39.620 --> 55:47.580]  в результате у нас получается, что мы можем просто запуститься рекурсивно для многочлена а0,
[55:47.580 --> 55:56.780]  многочлена а1, а потом за линейное время, собственно, восстановить значение а. То есть,
[55:56.780 --> 56:01.900]  получается такая вот классическая разделяйка. Причем, с классической конкурентой,
[56:01.900 --> 56:13.700]  T от N равно 2T от N пополам плюс O от N. Но отсюда выясняется, что T от N равно O от N лог N.
[56:13.700 --> 56:31.460]  Вот, пока вроде, вот, пока вроде все просто. Вот тут бы нам вторая доска,
