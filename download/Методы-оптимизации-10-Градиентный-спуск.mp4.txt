[00:00.000 --> 00:16.000]  Ну, не помню точно, чем мы закончили, но в целом идея была в том, что мы смотрели на то, как в целом записывается это невозможно так сейчас секунду, то есть решить вопрос по так тут эта штука и тут появился ра.
[00:17.000 --> 00:29.000]  Да, мы закончили на том, как учитывать следующая точка в нашем стандартном методе, то есть у нас есть текущее приближение так и вот так, наверное, сейчас правильно будет сделать.
[00:29.000 --> 00:38.000]  Да, у нас есть текущее приближение, и мы его обновляем с помощью найденного направления ашкатова и шага альфа.
[00:38.000 --> 00:43.000]  Посмотрели два разных способа. Линейный поиск и методовитных областей.
[00:43.000 --> 00:50.000]  Обсудили то, чем они похожи, чем отличаются. Вот и дальше перешли к тому, что мы закончили.
[00:51.000 --> 00:55.000]  Вот и на этом, кажется, остановились. Я правильно помню?
[00:55.000 --> 00:59.000]  Кто-нибудь вообще помнит? Отлично, спасибо.
[00:59.000 --> 01:04.000]  Вот так надо сейчас заранее подготовить доску.
[01:04.000 --> 01:11.000]  Значит, обычно используются три таких основных методовитных областей.
[01:11.000 --> 01:14.000]  Ну, основные как бы критерии сравнения можно так назвать.
[01:14.000 --> 01:17.000]  Вот можно сравнивать их по сложностям.
[01:17.000 --> 01:22.000]  Тут есть две взаимозависимые и связанные истории.
[01:22.000 --> 01:25.000]  Первая называется аналитической сложной, вторая называется ажематической.
[01:25.000 --> 01:32.000]  То есть под аналитической сложностью подразумевается, что мы просто считаем число областей, а не областей.
[01:32.000 --> 01:37.000]  И считаем, что, условно, вызов оракула это константное время занимает.
[01:37.000 --> 01:41.000]  Поэтому мы не будем особо напрягаться, если там...
[01:41.000 --> 01:46.000]  Ну, в общем, все это делается по модулю того, что...
[01:46.000 --> 01:49.000]  Так, какая у нас лекция? Десять. Отлично.
[01:49.000 --> 01:56.000]  По модуле того, что посчитать оракулу, мы не будем напрягаться.
[01:56.000 --> 02:04.000]  По модуле того, что вычислить ответ оракулы — это просто.
[02:04.000 --> 02:06.000]  Это, конечно, не всегда так.
[02:06.000 --> 02:09.000]  И мы увидим, когда это не так и к чему это может приводить.
[02:09.000 --> 02:15.000]  Но в нашей текущей концепции черного ящика и вот этой оракуленной абстракции
[02:15.000 --> 02:21.000]  мы вполне себе можем предположить, что нам важно только то, сколько раз мы должны посчитать оракулы.
[02:21.000 --> 02:26.120]  вполне себе можем предположить, что нам важно только то, сколько раз мы должны посчитать
[02:26.120 --> 02:33.440]  амусол на градиен. Ну и арифметическое, это почти то же самое, только считаем не количество вызова
[02:33.440 --> 02:38.840]  аракулы, а общий число вычислений, в смысле, сколько там флопсов надо сделать. То есть понятно,
[02:38.840 --> 02:44.200]  что они друг с другом связаны в виде того, что арифметическая сложность просто аналитическая
[02:44.200 --> 02:49.600]  умножить на стоимость одной итерации, на стоимость вызова аракулы. Поэтому тут зависимость
[02:49.600 --> 02:57.440]  от контекста удобнее либо одно, либо другое определение сложности использовать. Второй способ
[02:57.440 --> 03:03.600]  это сравнить скорость сходимости. Обычно вот здесь всякий термин доказан. Вот про то, какой
[03:03.600 --> 03:12.120]  метод как сходится, в смысле какого из критериев, которые мы перечисляли, вот здесь вот. То есть
[03:12.120 --> 03:22.680]  что на каждой следующей итерации меньше? Норма ошибки, модуль разности между f и f
[03:22.680 --> 03:28.040]  со звездочкой. Или же там как-то градиент правильно образом уменьшается. Это все можно
[03:28.040 --> 03:34.480]  как бы оценить в зависимости от числа k, то есть какой будет прогресс на каждой итерации. Отсюда
[03:34.480 --> 03:38.840]  получаем скорость сходимости. Сейчас будут примеры того, что это скорость сходимости у тебя не
[03:38.840 --> 03:52.720]  бывает. И что и как оно соотносится друг с другом. Ну и третий путь, самый такой дуболомный,
[03:52.720 --> 03:58.640]  это просто эксперименты. То есть просто можно запустить на вашей конкретной задачи набор методов,
[03:58.640 --> 04:04.560]  посмотреть какой из них работает лучше, какой хуже. Понятно, что вот это наиболее трудозатратная,
[04:04.560 --> 04:09.440]  наверное, вычислительная трудозатратная операция, потому что надо, ну, во-первых,
[04:09.440 --> 04:14.640]  надо что-то запускать и кодить, возможно. Вот, не всегда это просто. Во-вторых, надо,
[04:14.640 --> 04:19.800]  возможно, если очень большая, то довольно вычислительно затратно и много времени надо
[04:19.800 --> 04:25.760]  ждать, когда же у вас что-то считается, чтобы сравнить порядок сходимости. Почему надо дожидать
[04:25.760 --> 04:44.360]  достаточно долго, будет понятно уже скоро. Какие скорости сходимости бывают? Я, кажется,
[04:44.360 --> 04:50.440]  на этом не стал сильно торопиться и решил начать именно с того, какие бывают скорости сходимости.
[04:50.600 --> 05:02.160]  Первый, это сублиней, имеет вот такой замечательный вид, имеет вот такой вот вид, то есть мы нашу норму
[05:02.160 --> 05:13.120]  х на каждой итерации следующей приближаем к х со звездочкой, как вот такая вот оценка сверху.
[05:13.120 --> 05:20.520]  Вот, то есть тут, заметьте, стоит к, это тоже самое число, которое здесь, вот, и альф меньше единицы.
[05:20.520 --> 05:26.000]  Вот, то есть это c делить на к, c делить на к квадрат, c делить на корень, с к, все вот это вот
[05:26.000 --> 05:32.000]  подходит под сублинею сходить. Следующий, это линейная или еще называют геометрической прогрессией.
[05:32.000 --> 05:41.760]  В этом типе сходимости зависимость уже другая, то есть левая часть остается такой же, вот, а правая
[05:41.760 --> 05:48.560]  оценивать сверху, как c умножить на q в степени k, то есть q это число от нуля до единицы, вот, и, соответственно,
[05:48.560 --> 05:54.960]  k это тоже самое, это к, которое здесь по аналогии с тем, что было. То есть, видите, правая часть существенно образом изменилась.
[05:54.960 --> 06:05.040]  Значит, сверх линейная, это все то же самое, только здесь было к, просто к, ну и тут, возможно, какая-то линейная функция от k, вот,
[06:05.040 --> 06:15.280]  а здесь у нас стоит k в степени p, то есть некоторая полиномиальная зависимость от номера итерации, вот, и самая, наверное,
[06:15.280 --> 06:23.360]  быстрая, с которой мы будем иметь дело, это квадратичная, вот, в которой вот этот вот полином изменяется на экспоненциальную зависимость,
[06:23.360 --> 06:32.000]  ну и в частности два в степени k, вот. Альтернатива к такой формулировке есть не что иное, как вот такая вот формулировка,
[06:32.080 --> 06:41.840]  то есть мы, наша норма в квадрат раз, ну, то есть вы умножаете текущую норму в квадрат и получается, ну, у нас следующая норма, вот.
[06:41.840 --> 06:51.280]  То есть каждый раз число значих цифр, по сути дела, удваивается, удваивается или возводится в квадрат? Возводится в квадрат, да.
[06:51.280 --> 07:01.200]  То есть было две значих цифры, стало четыре, было четыре, стало шестнадцать, ну, в общем, и так далее, вот. То есть все оно, это все довольно быстро сходится.
[07:02.320 --> 07:26.720]  Ну и картинка, которая это все дело иллюстрирует, значит, синий это сублинейная сходимость, и тут видно, что, видно, что для нескольких первых итераций сублинейная сходимость может оказаться быстрее, ну, как бы давайте ошибку меньше, чем линейная, вот.
[07:26.720 --> 07:46.960]  Но в дальнейшем, если мы как бы тут немножко продолжим, тогда вот эта штука улетит в десять минус, там, условно, двадцатый какой-нибудь, вот, да, а вот эта штука как раз-таки сублинейная останется вот примерно на таком же уровне, а линейная будет идти, прямой будет график вниз.
[07:46.960 --> 08:07.200]  Ну, сверхлинейная, понятно, идет поначалу сильно быстрее, но потом все равно разница между вот этим квадратиками, вот этим треугольничками, вот этим квадратиками, вот этим треугольничками, она уже достаточно существенна для того, чтобы, ну, сверхлинейная сильно существенно симпатически медленнее, чем квадратичная.
[08:07.200 --> 08:19.440]  Понятно ли, что это за график, за понятия, как они отсортированы и почему, условно говоря, они так называют?
[08:19.440 --> 08:25.440]  Вроде да.
[08:25.680 --> 08:53.680]  Значит, важный момент про тярем исходимости. Вот сейчас на этих двух слайдах будет приведено некоторое summary вот этого вот параграфа из книжки, в общем, рекомендую с ней ознакомиться, вот, она довольно, но она не очень новая, то есть это, наверное, из самых первых книжек, вот, но, кстати, может быть, я даже показать могу сейчас, секунду, ой, да, плюсы, ну, я не знаю, видно, не видно, вот она вот так вот выглядит, сейчас.
[08:53.680 --> 08:54.640]  Да, вот заблюдивается, да, окей, в общем, такая вот зеленая книжка, вот, вот такой вот толщины издана в 83 году, вот, ну, это, по-моему, переиздание уже, наверное, не написано, ну, ладно, не так это важно, вот, идея в том, что рекомендую с ней ознакомиться, в ней содержится, наверное, все основополагающие идеи, которые мы будем
[09:23.680 --> 09:53.680]  использовать и развивать в рамках наших дальнейших лекций, вот, и вот там в самом начале как раз-таки автор рассуждает о том и приводит аргументы о том, что какую роль, значит, играют теоремы сходимости, что из них можно, как их можно использовать в положительном ключе и как их не нужно использовать, чтобы не случайно не нарваться на какую-то неэффективность при решении каких-то прикладных задач. Вот, значит, сначала начнем с хороших новостей, что эти самые теоремы нам дают.
[09:53.680 --> 10:23.680]  Во-первых, они нам дают класс задач, для которых применяется мета. Вот, то есть чаще всего в подобного рода теоремах фигурируют условия на то, какой должна быть функция, например, то есть должна быть, должна быть, должна ли она быть там дифференцируемой или необязательной, должна ли она быть дваждиференцируемой, должен ли быть кисян или не должен быть. В общем, все эти вопросы, они здесь обсуждаются обычно в теоремах сходимости.
[10:23.680 --> 10:35.680]  И поэтому просто глядя на них, вы можете сразу понять, ага, у меня вот задача такая-то, поэтому металл такой использовать не надо, потому что он для нее, например, неприбеги, или его поведение для такого рода задач неизвестно.
[10:35.680 --> 10:39.680]  Это довольно полезно.
[10:39.680 --> 11:01.680]  В общем, да, какие бывают классы задач? Бывают выпуклые, гладкие, например, стандартные. То есть нужна ли выпуклость или не нужна. Если нужна, то если, условно говоря, если нужна то, что она дает хорошего, в общем, ты уже знаешь, что она хорошего дает, вот, если она не нужна, то насколько будет результат хуже, например, и будет ли, в общем, этот работать и куда он будет сходиться.
[11:01.680 --> 11:16.680]  А теория могут дать качественное поведение методов. То есть они могут дать информацию о том, существенно ли та точка, с которой вы начинаете, и, собственно, по какому функционалу есть сходимость. То есть сходится ли она по функции, сходится ли она по аргументу или еще как-то.
[11:16.680 --> 11:24.680]  Понятно, что несложно привести, наверное, пример функции, которая сходимость по функции, грубо говоря, будет, а по аргументу не будет.
[11:24.680 --> 11:34.680]  Это там, не знаю, сейчас показать. Простой пример, типа, даже не буду, наверное, рисовать, такой гипер, который вот и бывает.
[11:34.680 --> 11:41.680]  Вы запускаете метод, он там по f сходится, по x не сходится, потому что разница по f маленькая, а по x может быть достаточно большой.
[11:41.680 --> 12:00.680]  Поэтому тут вот такие вот всякие странные функции. Ну, если вас смущает то, что он там неограничен, ну, то есть если что-то безкачное бывает, можно как бы делать то же самое, потом по выпустости определить, чтобы было, ну, короче, такое парабола с очень маленьким коэффициентом.
[12:01.680 --> 12:16.680]  Вот, когда по f с каждым шагом разница мала, а по f мала, а по x большая. Вот, это тоже может сообщить вам теорию сходимости.
[12:16.680 --> 12:25.680]  Значит, скорость сходимости тоже можно получить некоторую оценку. Вот, значит, что эта штука вам дает?
[12:25.680 --> 12:30.680]  Она дает некоторую теоретическую оценку на то, сколько это раз потребуется, чтобы получить одной точность.
[12:30.680 --> 12:38.680]  Ну, вот мы сегодня уже, наверное, посмотрим, как это может работать. Вот, она может дать определение факторов, которые влияют на сходимость.
[12:38.680 --> 12:43.680]  То есть отчего, например, вот здесь вот, да, давайте посмотрим.
[12:43.680 --> 12:54.680]  Например, если вот этот q, вот отчего зависит q? Вот q может быть 0,99999 и будет безумно долго, или q может быть там 0,1 и будет достаточно быстро.
[12:54.680 --> 13:02.680]  То же самое здесь. Вот здесь, в принципе, это не так важно, потому что два степеника достаточно быстро сбивает любую там, наверное.
[13:02.680 --> 13:08.680]  Гораздо быстрее, в общем, сбивает любую, достаточно близко к единице q, но тем не менее.
[13:08.680 --> 13:16.680]  Вот так, факторы. Да, ну и еще иногда можно заранее вручить твой итераций, может быть оно будет немного завышенным.
[13:16.680 --> 13:24.680]  Вот, но используя оценку из теоремы, можно прийти к выводу и получить результат того, насколько.
[13:24.680 --> 13:32.680]  Сколько надо в общем запускать итерации, чтобы получить оценку за одной точности по заранее определенному функционалу, что важно.
[13:32.680 --> 13:42.680]  Понятны ли плюсы? И то, что из теоремы сходимости можно выводить?
[13:42.680 --> 13:48.680]  Да, понятно. Окей. Значит, теперь чего нельзя выводить?
[13:48.680 --> 13:58.680]  Значит, если теорема говорит о том, что метод сходится, это еще ничего не говорит о том, что надо его применять или не надо, потому что он может сходиться бесконечно долго.
[13:58.680 --> 14:11.680]  Об этом важно помнить. Оценки сходимости, которые с одной стороны вот здесь упоминались, чаще всего зависит от некоторых констант, которые определяются из самой функции.
[14:11.680 --> 14:15.680]  И вот определение самых констант, это не самая простая задача.
[14:15.680 --> 14:23.680]  Поэтому вы можете примерно оценить порядок, но дойти до абсолютных точных значений не всегда возможно.
[14:23.680 --> 14:31.680]  Ну и все теоремы, они, понятное дело, работают в точной арифметике, когда у вас действительное число, все в порядке.
[14:31.680 --> 14:35.680]  Но на компьютере у вас там не действительное число, у вас там плавающая точка.
[14:35.680 --> 14:49.680]  Поэтому ошибки округления они зачастую не учитывают, и это может приводить к некоторым более не таким оптимистичным результатам, о которых могут говорить теоремы.
[14:49.680 --> 14:59.680]  Но надо иметь в виду, что всегда есть некоторый эпсилон, который дает некоторую погрешность, который, в свою очередь, может некоторым образом портить сам процесс вычисления.
[14:59.680 --> 15:09.680]  Понятно ли о чем теоремы сходимости, о чем надо помнить и беспокоиться в процессе их использования?
[15:09.680 --> 15:11.680]  Да.
[15:11.680 --> 15:13.680]  Окей.
[15:13.680 --> 15:31.680]  Значит, теперь некоторый зоопарк методов, которые будем как-то каким-то образом классифицировать на более понятные классы, чтобы сравнивать, не сравнивать, короче говоря, там, методы из разных классов, чтобы не получилось так, что вы сравниваетесь с заранее плохим методом просто потому, что он использует меньшую информацию.
[15:31.680 --> 15:43.680]  Значит, первое. У нас есть порядок метода. Нулевой порядок – это аракул возвращения только функцию. Первый порядок возвращает функцию градиан. Второй порядок возвращает еще и гися на 32-х перегонах.
[15:43.680 --> 15:51.680]  Вопрос, существуют ли методы более высокого порядка, был довольно достаточно длительное время открытым.
[15:51.680 --> 16:03.680]  Ну, в общем, не так давно, 2019 год, статья Юрия Евгеньевича Нестерова про то, как сделать реализуемыми. Можете знакомиться с математикой программинг, один из самых классных журналов по оптимизации.
[16:03.680 --> 16:10.680]  Ну, там, правда, снова, наверное, акцент на всякую теорию про оптимизацию, но тем не менее.
[16:10.680 --> 16:19.680]  В общем, это пока все в стадии разработки, то есть нет какого-то пакета, который, вроде, пока еще нет, который можно было бы запустить, как CVXPy, вот в прошлый раз мы смотрели.
[16:19.680 --> 16:27.680]  Раз он бы вам все решил, не думал с какого порядка. Пока это все некоторая наука, которая еще не дошла до стадии технологии.
[16:27.680 --> 16:36.680]  Вот, значит, второй аспект, по которому можно классифицировать методы, это то, сколько точек и как именно они используют историю.
[16:36.680 --> 16:49.680]  То есть есть одношаговые методы, которые, ну, там, подавляющее большинство, наверное, одношаговых, вот, которые берут некоторую начальную точку, ой, не начальную, некоторую текущую точку и генерируют по ней следующую точку.
[16:49.680 --> 16:55.680]  Вот есть многошаговые методы, которые генерируют следующую точку по не текущей, а еще и предыдущей.
[16:55.680 --> 17:09.680]  Вот они зачастую работают лучше, чем вот такие методы, потому что просто у них больше информации о том, о том, какой была траектория и, соответственно, больше информации локальной в разных точках.
[17:09.680 --> 17:17.680]  И из этой локальной информации они могут более качественным образом генерируют некоторую глобальную информацию, собственно, то, о чем я говорил в прошлый раз.
[17:17.680 --> 17:31.680]  Ну и, собственно, главные выводы про это самое введение, это то, что какая у нас общая схема работы, как мы сравниваем и какие у нас есть методы и задачи, для которых мы в той или иной степени можем эти самые методы применить.
[17:31.680 --> 17:38.680]  Вот сейчас потихоньку, так, есть какие-нибудь вопросы, может быть, по этой самой первой части, чтобы не сильно торопиться.
[17:38.680 --> 17:41.680]  Вот если что-то непонятно, то спросите.
[17:47.680 --> 18:12.680]  Так, вроде все понятно, я надеюсь, переходим тогда к градиентному, к методу спуска, в частности, градиентному спуску.
[18:12.680 --> 18:15.680]  Я надеюсь, что мы сегодня благополучно закончим.
[18:15.680 --> 18:18.680]  Значит, методы спуска так и методы, которые на каждую
[18:18.680 --> 18:21.680]  итерацию уменьшают значение функций. Довольно очевидное
[18:21.680 --> 18:25.680]  определение, исходя из названия. Спускаемся к минимуму.
[18:25.680 --> 18:28.680]  Значит, если это выполнено, то направление шката
[18:28.680 --> 18:31.680]  называется направлением убывания, и поначалу мы будем
[18:31.680 --> 18:34.680]  как раз стремиться получать направление убывания.
[18:34.680 --> 18:37.680]  Чуть позже мы от этого условия откажемся
[18:37.680 --> 18:40.680]  и получим более быструю сходимость.
[18:40.680 --> 18:43.680]  Как бы странным это не казалось.
[18:43.680 --> 18:46.680]  Методы, которые не требуют монотонности,
[18:46.680 --> 18:49.680]  оказывается, могут сходиться
[18:49.680 --> 18:52.680]  более быстро.
[18:52.680 --> 18:55.680]  Выглядит обычно это вот так.
[18:56.680 --> 18:59.680]  Так.
[18:59.680 --> 19:02.680]  Раз.
[19:02.680 --> 19:05.680]  Два.
[19:05.680 --> 19:08.680]  Вот.
[19:08.680 --> 19:11.680]  Ну и картинка обычно выглядит вот так.
[19:11.680 --> 19:14.680]  Что вот тут у вас
[19:14.680 --> 19:17.680]  число итераций. Ой.
[19:17.680 --> 19:20.680]  Здесь
[19:20.680 --> 19:23.680]  какой-то там ошибка, например,
[19:23.680 --> 19:26.680]  по функции.
[19:26.680 --> 19:29.680]  И у вас один метод сходится как-нибудь вот так.
[19:29.680 --> 19:32.680]  Монотонно.
[19:32.680 --> 19:35.680]  А другой метод сходится как-нибудь вот так.
[19:35.680 --> 19:38.680]  Не монотонно, но быстрее.
[19:38.680 --> 19:41.680]  И, наверное, уже в следующий раз мы с таким методом познакомимся.
[19:41.680 --> 19:44.680]  Понятно ли в чем
[19:44.680 --> 19:47.680]  разница?
[19:47.680 --> 19:50.680]  У красного метода мы не требуем того, чтобы накажется
[19:50.680 --> 19:53.680]  итерация.
[19:53.680 --> 19:56.680]  То есть разрешается некоторые подъемы, но они в итоге
[19:56.680 --> 19:59.680]  оказываются.
[19:59.680 --> 20:02.680]  Некоторые позитивные эффекты оказываются.
[20:02.680 --> 20:05.680]  Локально мы их возрастаем, но глобально мы сходимся быстрее.
[20:05.680 --> 20:08.680]  Понятно.
[20:08.680 --> 20:11.680]  Окей.
[20:11.680 --> 20:14.680]  Так. Возвращаемся.
[20:14.680 --> 20:17.680]  Да.
[20:17.680 --> 20:20.680]  И переходим, собственно, к... Да, еще пара определений.
[20:20.680 --> 20:23.680]  Мы будем чаще всего использовать L-гладкие функции.
[20:23.680 --> 20:26.680]  Собственно, L-гладкость нам нужна будет для того, чтобы
[20:26.680 --> 20:29.680]  там некоторые оценки получать.
[20:29.680 --> 20:32.680]  Значит, L-гладкая функция — функция, у которой градиент лепшится.
[20:32.680 --> 20:35.680]  Тут вот дано достаточно общее определение
[20:35.680 --> 20:38.680]  с сопряженной нормой. Чаще будем жить в мире,
[20:38.680 --> 20:41.680]  где у нас будет есть... Есть будет вторая норма, и соответственно,
[20:41.680 --> 20:44.680]  сопряженная ей тоже будет вторая норма.
[20:44.680 --> 20:47.680]  Вот.
[20:47.680 --> 20:50.680]  Вот.
[20:50.680 --> 20:53.680]  Вот.
[20:53.680 --> 20:56.680]  Вот.
[20:56.680 --> 20:59.680]  Вот.
[20:59.680 --> 21:02.680]  Вот.
[21:02.680 --> 21:05.680]  Вот.
[21:05.680 --> 21:08.680]  Вот.
[21:08.680 --> 21:11.680]  Вот.
[21:11.680 --> 21:14.680]  Т.е., что L-гладкое — то для любых двух точек x, y выполнено все еще неравесно.
[21:14.680 --> 21:17.680]  Вот.
[21:17.680 --> 21:20.680]  Т.е., мы функцию в некоторые точки q можем оценить сверх
[21:20.680 --> 21:23.680]  в некоторые квадратические функции для...
[21:23.680 --> 21:26.680]  Ну, т.е. просто квадратичная функция,
[21:26.680 --> 21:29.680]  которая в некотором смысле напоминает разложения
[21:29.680 --> 21:32.680]  в ряд Тейлера до 2-го члена.
[21:32.680 --> 21:35.680]  Только здесь вместо Gisiano фигурируются, собственно,
[21:35.680 --> 21:38.680]  константы лепшицы. Вот. Щас потом покажем, почему это работает.
[21:38.680 --> 21:48.680]  У нас есть формула унитоналибинца, может быть, не совсем привычным во виде, но я надеюсь, что ее не сложно здесь распознать.
[21:48.680 --> 21:57.680]  То есть что такое? Скалярное произведение y на x это константа, а t это от 0 до 1.
[21:57.680 --> 22:04.680]  То есть мы интегрируем грубо говоря градиент от x до y на самом деле.
[22:04.680 --> 22:13.680]  Ну то есть замена переменной можно привести это все к интегрированию градиента от x до y, получить соответственно f от y минус f от x.
[22:13.680 --> 22:19.680]  Понятно ли как это делается и почему это работает?
[22:19.680 --> 22:27.680]  Или не очень? Не очень привычная запись.
[22:28.680 --> 22:37.680]  Смотрите, обозначим вот эту штуку за что-нибудь, за z, например.
[22:37.680 --> 22:49.680]  Тогда dz это y минус x на dt.
[22:49.680 --> 22:58.680]  А это ровно то, что зайдут здесь.
[22:58.680 --> 23:04.680]  Стало ли получше сейчас?
[23:04.680 --> 23:08.680]  Наверное, да, понятно.
[23:08.680 --> 23:18.680]  Пока не буду устраивать опрос, понятно нет, но пожалуйста более активно проявляйте себе, если есть какие-то вопросы.
[23:18.680 --> 23:24.680]  Тогда можно расписать таким вот образом.
[23:24.680 --> 23:27.680]  Это самая разность.
[23:27.680 --> 23:35.680]  Прибавить и вычесть скалярное произведение градиента в точке x на y минус x.
[23:35.680 --> 23:39.680]  Получим, то есть тут эта штука от t не зависит, можно вынести.
[23:39.680 --> 23:47.680]  А эта штука тоже не зависит, но мы тем не менее оставим внутри и внесем в скалярное произведение.
[23:47.680 --> 23:54.680]  Далее пользуемся тем, что у нас определение есть.
[23:55.680 --> 24:04.680]  Поэтому вся эта история, которая есть f от y минус f от x минус вот это вот скалярное произведение,
[24:04.680 --> 24:08.680]  оцениваем сверху как интеграл от нормы.
[24:08.680 --> 24:13.680]  Интеграл от нормы меньше либо равен, ну то есть норма от скалярного произведения,
[24:13.680 --> 24:17.680]  пониравясь к Шубоняковскому, меньше либо равно, чем произведение норм.
[24:17.680 --> 24:26.680]  Норма разности градиентов и норма разности аргументов, то есть y, y и x.
[24:26.680 --> 24:33.680]  Далее вот эта штука заменяется на l умножить на разность аргументов.
[24:33.680 --> 24:39.680]  То есть аргумент здесь какие x, t на y минус x, а тут x. То есть остается только норма,
[24:39.680 --> 24:50.680]  ну то есть l на норму t минус норма, еще раз, l умножить на норму t на y минус x.
[24:50.680 --> 24:59.680]  Вот t выносится, вот y минус x тут еще один, поэтому появляется квадрат.
[24:59.680 --> 25:04.680]  Но это все дело выносится, остается только интеграл от t по dt, что есть 1 вторая,
[25:04.680 --> 25:10.680]  поэтому получаем здесь l по 1. Вот, собственно, доказательства.
[25:10.680 --> 25:16.680]  Все ли шаги были понятны, что откуда берется.
[25:16.680 --> 25:19.680]  Сейчас можно еще раз последнюю часть просто...
[25:19.680 --> 25:24.680]  Да, давайте, смотрите. Вот есть понятно, откуда это взялось?
[25:24.680 --> 25:25.680]  Да, вот до этого момента, да.
[25:25.680 --> 25:30.680]  Шикарно. Вот теперь у нас, видите, здесь есть разность градиентов.
[25:30.680 --> 25:32.680]  Да.
[25:32.680 --> 25:36.680]  Вот она.
[25:36.680 --> 25:41.680]  И мы ее сверху ограничим вот так.
[25:41.680 --> 25:50.680]  То есть у нас l, дальше вот из этой штуки вычитаем x.
[25:50.680 --> 25:53.680]  Получаем t на y минус x по норме.
[25:53.680 --> 25:57.680]  И еще умножаем на y минус x.
[25:57.680 --> 26:02.680]  Получаем t на y минус x в квадрате.
[26:02.680 --> 26:06.680]  И все константы выносим, вот эти вот, которые тут подсвечены.
[26:06.680 --> 26:13.680]  Остается интеграл от t по dt, понятно, на вторая.
[26:13.680 --> 26:15.680]  Так, стало получше.
[26:15.680 --> 26:16.680]  Да, все понятно.
[26:16.680 --> 26:18.680]  Ага, шикарно.
[26:18.680 --> 26:25.680]  Ну, собственно, один из критерий для l-гладкости следующий.
[26:25.680 --> 26:30.680]  Функция l-гладкая, если она дважды пред дифференцируемая,
[26:30.680 --> 26:36.680]  тогда для l выполнено одновременно, что функция является l-гладкой,
[26:36.680 --> 26:42.680]  и норма DC на сверху ограничена самой константой для всех x.
[26:42.680 --> 26:46.680]  Доказательство довольно, кажется, прямолинейное.
[26:46.680 --> 26:49.680]  Пустель, гладкая функция.
[26:49.680 --> 26:55.680]  Тогда для любого направления d и альфа больше нуля у нас есть вот наше определение.
[26:55.680 --> 26:57.680]  Что сделаем дальше?
[26:57.680 --> 27:06.680]  Дальше мы, тут хитрый предельный переход, смотрите, делим на альфу.
[27:06.680 --> 27:10.680]  Да, то есть рассматриваем вот такую штуку,
[27:10.680 --> 27:15.680]  которая есть не что иное, как эта штука называется.
[27:21.680 --> 27:23.680]  У меня есть специальное название.
[27:25.680 --> 27:28.680]  Кто помнит что-нибудь?
[27:34.680 --> 27:36.680]  Хорошо, на что она похожа?
[27:37.680 --> 27:40.680]  Призводной по направлению?
[27:40.680 --> 27:42.680]  Вот, производной по направлению, конечно.
[27:42.680 --> 27:46.680]  Значит эта штука производной по направлению d.
[27:46.680 --> 27:50.680]  Мы знаем, что производной по направлению равна 무엇у скалярному произведению
[27:50.680 --> 27:55.680]  градиента функции на это самое направление.
[27:55.680 --> 28:02.680]  Поскольку у нас тут сама функция, то градиент и градиент это гисян,
[28:02.680 --> 28:06.180]  И скалянное произведение – просто умножение гессиана на это самое направление.
[28:06.180 --> 28:08.180]  Ну и вторая норма остается.
[28:08.180 --> 28:10.180]  В силу непрерывности, наверное.
[28:10.180 --> 28:12.180]  Да.
[28:12.180 --> 28:14.180]  Понятно ли это равенство теперь?
[28:22.180 --> 28:24.180]  То есть мы помним этот факт, да?
[28:25.180 --> 28:27.180]  Прекрасно.
[28:27.680 --> 28:29.680]  Ну вот.
[28:29.680 --> 28:31.680]  А то, что мы получили здесь –
[28:31.680 --> 28:33.680]  это ровно то же самое.
[28:33.680 --> 28:35.680]  Следовательно, в силу вот этого
[28:35.680 --> 28:37.680]  у нас выполнено, что эта штука
[28:37.680 --> 28:39.680]  меньше, чем L на норму D.
[28:43.680 --> 28:45.680]  Ну и поскольку это выполнено для любого D,
[28:47.680 --> 28:49.680]  то по определению матричной нормы
[28:49.680 --> 28:51.680]  как супревому отношению
[28:53.680 --> 28:55.680]  действия матрицы на вектор делить
[28:55.680 --> 28:57.680]  на норму вектора,
[28:57.680 --> 28:59.680]  мы получаем, что вторая норма F
[28:59.680 --> 29:01.680]  ограничена сверху от самой L.
[29:03.680 --> 29:05.680]  Вторая норма
[29:05.680 --> 29:07.680]  гессиана F.
[29:09.680 --> 29:11.680]  Понятен ли переход?
[29:19.680 --> 29:21.680]  То есть получается вы делите на норму D
[29:21.680 --> 29:23.680]  и делите супревому?
[29:23.680 --> 29:25.680]  Да, вот здесь.
[29:29.680 --> 29:31.680]  Окей, теперь наоборот.
[29:31.680 --> 29:33.680]  Пусть вторая норма гессиана меньше любого L
[29:33.680 --> 29:35.680]  или любого X.
[29:35.680 --> 29:37.680]  Опять с помощью формулы Newton-Levenson
[29:37.680 --> 29:39.680]  в том же самом виде практически.
[29:39.680 --> 29:41.680]  Только теперь у нас она применяется
[29:41.680 --> 29:43.680]  для градиентов.
[29:43.680 --> 29:45.680]  Разность градиентов – это интеграл
[29:45.680 --> 29:47.680]  от гессиана, умноженного на Y-X.
[29:47.680 --> 29:49.680]  При этом гессиан считается
[29:49.680 --> 29:51.680]  на отрезке от 0 до 1 по T.
[29:51.680 --> 29:53.680]  То же самое, что у нас было здесь.
[29:55.680 --> 29:57.680]  Только теперь у нас не скалярное произведение,
[29:57.680 --> 29:59.680]  потому что у нас не функция
[29:59.680 --> 30:01.680]  а стоит градиент, а просто умножение
[30:01.680 --> 30:03.680]  гессиана на вектор.
[30:05.680 --> 30:07.680]  Ограничиваем эту штуку сверху,
[30:07.680 --> 30:09.680]  берем норму.
[30:11.680 --> 30:13.680]  И что произошло?
[30:13.680 --> 30:15.680]  У нас норма здесь
[30:17.680 --> 30:19.680]  меньше либо не интеграл от нормы.
[30:19.680 --> 30:21.680]  Интеграл от нормы
[30:23.680 --> 30:25.680]  почему стоит?
[30:25.680 --> 30:27.680]  Произведение матрицы на вектор.
[30:27.680 --> 30:29.680]  Соответственно,
[30:29.680 --> 30:31.680]  норма этого произведения меньше
[30:31.680 --> 30:33.680]  либо она, чем произведение норм.
[30:33.680 --> 30:35.680]  Норма Y-X выносится.
[30:35.680 --> 30:37.680]  Под интегралом остается
[30:37.680 --> 30:39.680]  норма гессиана.
[30:41.680 --> 30:43.680]  Поскольку гессиана в любой точке меньше
[30:43.680 --> 30:45.680]  либо на L,
[30:45.680 --> 30:47.680]  мы получаем единицу,
[30:47.680 --> 30:49.680]  получаем L на норму
[30:49.680 --> 30:51.680]  разности Y-X.
[30:51.680 --> 30:53.680]  Получаем определение
[30:53.680 --> 30:55.680]  L гладкой функции.
[30:57.680 --> 30:59.680]  Тут даже попроще вот в эту сторону.
[31:05.680 --> 31:07.680]  То есть тут три хода,
[31:07.680 --> 31:09.680]  тут всего два.
[31:09.680 --> 31:11.680]  Но этот вход, наверное, не самый очевидный.
[31:11.680 --> 31:13.680]  Вот дальше уже попроще.
[31:13.680 --> 31:15.680]  Все ли понятно?
[31:17.680 --> 31:19.680]  Да.
[31:19.680 --> 31:21.680]  Шикарно.
[31:21.680 --> 31:23.680]  Да, ну и, собственно, гридентный спуск
[31:23.680 --> 31:25.680]  очень легко ему получить,
[31:25.680 --> 31:27.680]  используя нашу лему о спуске.
[31:27.680 --> 31:29.680]  Не зря же она так называется.
[31:29.680 --> 31:31.680]  Значит, у нас была F от Y,
[31:31.680 --> 31:33.680]  мы ее оценили сверху.
[31:33.680 --> 31:35.680]  И эта функция же от Y.
[31:35.680 --> 31:37.680]  Мы можем взять,
[31:37.680 --> 31:39.680]  ну да, и, собственно, вот это работа,
[31:39.680 --> 31:41.680]  то, что было следствием
[31:41.680 --> 31:43.680]  следствия того,
[31:43.680 --> 31:45.680]  что было казна ранее,
[31:45.680 --> 31:47.680]  того, что максимальное значение
[31:47.680 --> 31:49.680]  для гессиана меньше уровня L,
[31:49.680 --> 31:51.680]  потому что, собственно, вот это, по сути, определение.
[31:51.680 --> 31:53.680]  Ну, для симметричной матрицы, конечно,
[31:53.680 --> 31:55.680]  поэтому будет лямбда максимальная.
[31:55.680 --> 31:57.680]  Не симметричная у меня немножко другая история,
[31:57.680 --> 31:59.680]  но у нас для гессиана все симметрично.
[31:59.680 --> 32:01.680]  Поэтому берем, просто минимизируем
[32:01.680 --> 32:03.680]  вот эту квадратичную оценку
[32:03.680 --> 32:05.680]  сверху по Y.
[32:05.680 --> 32:07.680]  То есть минимизируем просто оценку
[32:07.680 --> 32:09.680]  сверху на нашу функцию.
[32:11.680 --> 32:13.680]  Поскольку эта штука выпукла,
[32:13.680 --> 32:15.680]  то достаточно общать градиент.
[32:15.680 --> 32:17.680]  Считаем градиент в точке Y со звездочкой.
[32:17.680 --> 32:19.680]  Остается,
[32:19.680 --> 32:21.680]  из линейного члена остается
[32:21.680 --> 32:23.680]  градиент.
[32:23.680 --> 32:25.680]  Отсюда остается L на Y минус
[32:25.680 --> 32:27.680]  XК.
[32:27.680 --> 32:29.680]  Отсюда получаем, что Y со звездочкой
[32:29.680 --> 32:31.680]  это XК минус единица на L
[32:31.680 --> 32:33.680]  F штрих на XК.
[32:33.680 --> 32:35.680]  Это наша новая точка XК плюс 1.
[32:35.680 --> 32:37.680]  Отсюда получили градиентный спуск
[32:37.680 --> 32:39.680]  с шагом единицы на L.
[32:39.680 --> 32:41.680]  Сейчас еще будем понимать,
[32:41.680 --> 32:43.680]  почему этот шаг так хорош
[32:43.680 --> 32:45.680]  и что будет, если его пытаться изменить.
[32:47.680 --> 32:49.680]  Понятен ли вывод?
[32:49.680 --> 32:51.680]  Он очень простой, опираясь на то,
[32:51.680 --> 32:53.680]  что мы минимизируем не саму функцию,
[32:53.680 --> 32:55.680]  а квадратичную оценку сверху на нее.
[33:05.680 --> 33:07.680]  Градиент, почему такой? Понятно, да?
[33:07.680 --> 33:09.680]  Почему у нас что-то со знаком,
[33:09.680 --> 33:11.680]  где это нет?
[33:11.680 --> 33:13.680]  У нас Y штрих минус XК
[33:13.680 --> 33:15.680]  со знаком...
[33:17.680 --> 33:19.680]  А, нет, все правильно.
[33:21.680 --> 33:23.680]  Это хорошо, что все правильно.
[33:23.680 --> 33:25.680]  Я расстроился, что
[33:25.680 --> 33:27.680]  градиентный спуск сломался.
[33:29.680 --> 33:31.680]  Как шаг выбирать?
[33:31.680 --> 33:33.680]  Еще пока мы не пришли к тому,
[33:33.680 --> 33:35.680]  что его надо выбирать.
[33:35.680 --> 33:37.680]  Эта штука единицы на L
[33:37.680 --> 33:39.680]  это некоторый шаг,
[33:39.680 --> 33:41.680]  который соответствует...
[33:41.680 --> 33:43.680]  Хороший важный момент.
[33:43.680 --> 33:45.680]  Эта штука в точности,
[33:45.680 --> 33:47.680]  то, что у нас было в самом начале,
[33:47.680 --> 33:49.680]  направление минус градиент,
[33:49.680 --> 33:51.680]  шаг альфа К равен единиц на L.
[33:51.680 --> 33:53.680]  В точности подпадает
[33:53.680 --> 33:55.680]  под все наши изначальные построения.
[33:57.680 --> 33:59.680]  Как шаг выбирать?
[33:59.680 --> 34:01.680]  Можно взять постоянно меньше, чем 2 на L.
[34:01.680 --> 34:03.680]  Почему надо брать меньше, чем 2 на L,
[34:03.680 --> 34:05.680]  через несколько слайдов.
[34:05.680 --> 34:07.680]  Можно брать убывающую последовательность,
[34:07.680 --> 34:09.680]  расходящуюся, 1 на K и так далее.
[34:11.680 --> 34:13.680]  Есть куча разных способов адаптивного подбора
[34:13.680 --> 34:15.680]  для того, чтобы функция убывала.
[34:15.680 --> 34:17.680]  Но есть нескорейший спуск,
[34:17.680 --> 34:19.680]  который решает дополнительную задачу
[34:19.680 --> 34:21.680]  по минимизации функции
[34:21.680 --> 34:23.680]  в новой точке, которая зависит от альфы.
[34:25.680 --> 34:27.680]  Тут надо будет мне добавить что-то такое.
[34:29.680 --> 34:31.680]  Это простая формула, которую несложно добавить.
[34:31.680 --> 34:33.680]  Сейчас я ее напишу.
[34:33.680 --> 34:35.680]  Я думаю, что из названия
[34:35.680 --> 34:37.680]  она плюс-минус очевидна.
[34:43.680 --> 34:45.680]  Мы выбрали уже направление.
[34:45.680 --> 34:47.680]  Наше направление hk это минус
[34:47.680 --> 34:49.680]  f' от xk.
[34:51.680 --> 34:53.680]  Нам нужно найти альфа со звездочки.
[34:53.680 --> 34:55.680]  Такой что функция
[34:55.680 --> 34:57.680]  в новой точке.
[34:57.680 --> 34:59.680]  А новая точка это что такое?
[34:59.680 --> 35:01.680]  Минус альфа
[35:01.680 --> 35:03.680]  на f'
[35:03.680 --> 35:05.680]  от xk.
[35:05.680 --> 35:07.680]  Будет минимально при не отрицательном альфе.
[35:07.680 --> 35:09.680]  Эта функция
[35:09.680 --> 35:11.680]  это уже скалярная функция.
[35:11.680 --> 35:13.680]  Это некоторые же от альфы,
[35:13.680 --> 35:15.680]  которые из rvr.
[35:17.680 --> 35:19.680]  Потому что все остальные компоненты уже заданы.
[35:19.680 --> 35:21.680]  Поэтому
[35:21.680 --> 35:23.680]  можно одномерно минимизации какую-то
[35:23.680 --> 35:25.680]  пытаться искать этот минимум.
[35:25.680 --> 35:27.680]  В общем,
[35:27.680 --> 35:29.680]  печальная новость заключается в том,
[35:29.680 --> 35:31.680]  что, во-первых, вы тратите кучу времени
[35:31.680 --> 35:33.680]  на то, чтобы найти эту альфу,
[35:33.680 --> 35:35.680]  и вторая печальная новость в том,
[35:35.680 --> 35:37.680]  что с синтетической скорой сходимости у вас не улучшится.
[35:37.680 --> 35:39.680]  Там еще про это будут некоторые комментарии.
[35:39.680 --> 35:41.680]  То есть по времени, может быть, вы что-то и выиграете,
[35:41.680 --> 35:43.680]  но, условно, из линейности
[35:43.680 --> 35:45.680]  получить какую-то тратичную сходимость
[35:45.680 --> 35:47.680]  у вас не получится.
[35:47.680 --> 35:49.680]  Понятно ли, что такое нескорейший спуск?
[35:49.680 --> 35:51.680]  То есть правило выбора шага
[35:51.680 --> 35:53.680]  под названием наискорейший спуск?
[35:53.680 --> 35:55.680]  Да.
[35:55.680 --> 35:57.680]  Окей.
[35:57.680 --> 35:59.680]  Хорошо.
[35:59.680 --> 36:01.680]  Да.
[36:01.680 --> 36:03.680]  В общем, это я уже поговорил.
[36:03.680 --> 36:05.680]  Теперь по сходимости.
[36:05.680 --> 36:07.680]  Посмотрим
[36:07.680 --> 36:09.680]  на то, как
[36:09.680 --> 36:11.680]  наш метод
[36:11.680 --> 36:13.680]  будет сходиться.
[36:13.680 --> 36:15.680]  Как это сделать?
[36:15.680 --> 36:17.680]  Посмотрим, что происходит
[36:17.680 --> 36:19.680]  в точке xk плюс 1.
[36:19.680 --> 36:21.680]  f от xk,
[36:21.680 --> 36:23.680]  f'
[36:23.680 --> 36:25.680]  xk плюс 1 минус xk
[36:25.680 --> 36:27.680]  просто подставили вот сюда.
[36:27.680 --> 36:29.680]  Подставили сюда
[36:29.680 --> 36:31.680]  xk плюс 1.
[36:31.680 --> 36:33.680]  Мы знаем, что у нас xk плюс 1
[36:33.680 --> 36:35.680]  было получено с помощью градиентного спуска,
[36:35.680 --> 36:37.680]  поэтому разница
[36:37.680 --> 36:39.680]  xk плюс 1 минус xk, это что такое?
[36:39.680 --> 36:41.680]  xk минус 1 минус xk
[36:41.680 --> 36:43.680]  это минус
[36:43.680 --> 36:45.680]  альфа на градиент.
[36:45.680 --> 36:47.680]  Подставляем,
[36:47.680 --> 36:49.680]  получаем здесь минус альфа
[36:49.680 --> 36:51.680]  на норму градиента в квадрате.
[36:51.680 --> 36:53.680]  Здесь получается
[36:53.680 --> 36:55.680]  l альфа в квадрат нормы градиента в квадрате.
[36:57.680 --> 36:59.680]  Понятно,
[36:59.680 --> 37:01.680]  вот это равенство.
[37:01.680 --> 37:03.680]  Да.
[37:03.680 --> 37:05.680]  Шикарно.
[37:05.680 --> 37:07.680]  Вносим благополучно
[37:07.680 --> 37:09.680]  квадрат нормы градиента из вот этого
[37:09.680 --> 37:11.680]  слагаемого и вот этого слагаемого.
[37:11.680 --> 37:13.680]  Получаем вот такое выражение.
[37:13.680 --> 37:15.680]  Теперь смотрим,
[37:15.680 --> 37:17.680]  что произошло.
[37:17.680 --> 37:19.680]  Произошло то, что мы из
[37:19.680 --> 37:21.680]  некоторого нашего значения текущего функции f от xk
[37:21.680 --> 37:23.680]  вычитаем что-то,
[37:23.680 --> 37:25.680]  некоторый коэффициент, умножить на строго
[37:25.680 --> 37:27.680]  отрицательное число, ну положительно,
[37:27.680 --> 37:29.680]  потому что если эта штука ноль, мы уже в решении.
[37:29.680 --> 37:31.680]  Ну, в решении или там,
[37:31.680 --> 37:33.680]  где-то в сценарной точке, например.
[37:33.680 --> 37:35.680]  Поэтому чтобы у нас было убывание,
[37:35.680 --> 37:37.680]  надо потребовать, чтобы вот этот коэффициент был больше 0,
[37:37.680 --> 37:39.680]  чтобы мы что-то вычитали,
[37:39.680 --> 37:41.680]  чтобы наш значение функции уменьшалось.
[37:41.680 --> 37:43.680]  Ну, из вот этого неравенства очевидно следует,
[37:43.680 --> 37:45.680]  что alpha k
[37:45.680 --> 37:47.680]  не должен превышать 2,2
[37:47.680 --> 37:49.680]  делит на это.
[37:49.680 --> 37:51.680]  Если она эту штуку превышает,
[37:51.680 --> 37:53.680]  то у нас условие убывания нарушается.
[37:53.680 --> 37:55.680]  Поэтому у нас есть вот такая вот оценка
[37:55.680 --> 37:57.680]  на постоянный шаг.
[37:57.680 --> 37:59.680]  Далее.
[37:59.680 --> 38:01.680]  Если мы промаксимизируем эту штуку,
[38:01.680 --> 38:03.680]  то есть мы пытаемся найти такой коэффициент,
[38:03.680 --> 38:05.680]  такой шаг, чтобы убывание
[38:05.680 --> 38:07.680]  было как можно более сильным,
[38:07.680 --> 38:09.680]  то мы получим в точность
[38:09.680 --> 38:11.680]  единицу на l, вы не поверите.
[38:11.680 --> 38:13.680]  То есть ровно то, что у нас было вот здесь.
[38:17.680 --> 38:19.680]  Ну и после
[38:19.680 --> 38:21.680]  подстановки единицы на l вот сюда,
[38:21.680 --> 38:23.680]  мы что получим?
[38:23.680 --> 38:25.680]  Мы получим вот такую вот оценку
[38:25.680 --> 38:27.680]  на f от x
[38:27.680 --> 38:29.680]  минус f от x k плюс 1,
[38:29.680 --> 38:31.680]  как единица на 2 l
[38:31.680 --> 38:33.680]  на вторую норму градиента в текущей точке.
[38:33.680 --> 38:35.680]  Это нам еще сейчас понадобится,
[38:35.680 --> 38:37.680]  для того чтобы вывести некоторые дополнительные факты.
[38:37.680 --> 38:39.680]  Соответственно, если мы теперь
[38:39.680 --> 38:41.680]  вот в этом неразе
[38:41.680 --> 38:43.680]  просуммируем слева и справа
[38:43.680 --> 38:45.680]  по k от 0 до t,
[38:45.680 --> 38:47.680]  то здесь будет телескопическая сумма,
[38:47.680 --> 38:49.680]  из которой останется только
[38:49.680 --> 38:51.680]  f от x 0 и f от x
[38:51.680 --> 38:53.680]  на t плюс первой
[38:53.680 --> 38:55.680]  итерации, а здесь останется
[38:55.680 --> 38:57.680]  единица на 2 l сумма всех норм.
[38:57.680 --> 38:59.680]  Ну как бы,
[38:59.680 --> 39:01.680]  если функция ограничена снизу,
[39:01.680 --> 39:03.680]  то вот эта штука меньше,
[39:03.680 --> 39:05.680]  больше, чем f со звездочкой.
[39:05.680 --> 39:07.680]  Поэтому это все меньше, чем
[39:07.680 --> 39:09.680]  f от x 0 минус f со звездочкой.
[39:09.680 --> 39:11.680]  Это значит, что
[39:11.680 --> 39:13.680]  при тесте стремящейся к бесконечности
[39:13.680 --> 39:15.680]  эта штука сходится.
[39:15.680 --> 39:17.680]  Да, ряд сходится.
[39:17.680 --> 39:19.680]  Если ряд сходится, значит
[39:19.680 --> 39:21.680]  его n-ый член
[39:21.680 --> 39:23.680]  стремится к нулю.
[39:23.680 --> 39:25.680]  Необходимые условия сходимости рядов.
[39:25.680 --> 39:27.680]  Поэтому
[39:27.680 --> 39:29.680]  норма градиента будет стремиться к нулю
[39:29.680 --> 39:31.680]  при
[39:31.680 --> 39:33.680]  номере
[39:33.680 --> 39:35.680]  в номере...
[39:35.680 --> 39:37.680]  Короче, приказ стремиться
[39:37.680 --> 39:39.680]  к плюс бесконечности текает номер итерации.
[39:39.680 --> 39:41.680]  Да. Отсюда
[39:41.680 --> 39:43.680]  мы получаем, что градиентный спуск
[39:43.680 --> 39:45.680]  всегда сойдется к сценарной точке.
[39:45.680 --> 39:47.680]  Причем сценарная точка
[39:47.680 --> 39:49.680]  будет еще и той, в которой
[39:49.680 --> 39:51.680]  последовательно мы будем уменьшать значение
[39:51.680 --> 39:53.680]  функции при стремлении к ней.
[39:53.680 --> 39:55.680]  Понятен ли вывод?
[39:55.680 --> 39:57.680]  Понятен ли вывод
[39:57.680 --> 39:59.680]  как вывод и как процедура его получения?
[40:03.680 --> 40:05.680]  Вроде да.
[40:05.680 --> 40:07.680]  Хорошо.
[40:07.680 --> 40:09.680]  Вот.
[40:09.680 --> 40:11.680]  Это первый результат.
[40:11.680 --> 40:13.680]  Если вы запустите метод
[40:13.680 --> 40:15.680]  для функций x-куб,
[40:15.680 --> 40:17.680]  то он сойдется к нулю благополучно.
[40:17.680 --> 40:19.680]  При этом
[40:19.680 --> 40:21.680]  в нуле не минимум.
[40:21.680 --> 40:23.680]  Теперь
[40:23.680 --> 40:25.680]  более
[40:25.680 --> 40:27.680]  интересная
[40:27.680 --> 40:29.680]  и информативная теорема
[40:29.680 --> 40:31.680]  говорит нам о том, что...
[40:31.680 --> 40:33.680]  Сейчас я посмотрю на план.
[40:33.680 --> 40:35.680]  Сейчас я про теоремы проговорю,
[40:35.680 --> 40:37.680]  будет 5 минут вперед.
[40:37.680 --> 40:39.680]  О том, что
[40:39.680 --> 40:41.680]  если функция выпукла,
[40:41.680 --> 40:43.680]  градиент липшицов и шаг 1 на L,
[40:43.680 --> 40:45.680]  то сходимость градиентного спуска
[40:45.680 --> 40:47.680]  она сублинейная.
[40:47.680 --> 40:49.680]  То есть сходится довольно медленно
[40:49.680 --> 40:51.680]  для просто выпуклой функции
[40:51.680 --> 40:53.680]  с липшицем градиента.
[40:53.680 --> 40:55.680]  Доказательств этой теоремы, к сожалению,
[40:55.680 --> 40:57.680]  я здесь не привожу,
[40:57.680 --> 40:59.680]  потому что оно довольно неприятное.
[40:59.680 --> 41:01.680]  И обозначений довольно много.
[41:01.680 --> 41:03.680]  Я понял, что в процессе подготовки
[41:03.680 --> 41:05.680]  лучше показать результат,
[41:05.680 --> 41:07.680]  чем утопить вас в процедуре
[41:07.680 --> 41:09.680]  его получения.
[41:11.680 --> 41:13.680]  Для просто выпуклых функций такая история.
[41:13.680 --> 41:15.680]  Для сильного выпуклых функций история
[41:15.680 --> 41:17.680]  более простая
[41:17.680 --> 41:19.680]  и более быстрая.
[41:19.680 --> 41:21.680]  Через 5 минут давайте там...
[41:21.680 --> 41:23.680]  В 37 давайте продолжим.
[41:23.680 --> 41:25.680]  Посмотрим, что будет происходить
[41:25.680 --> 41:27.680]  для сильно выпуклых функций.
[41:29.680 --> 41:31.680]  Все, опять наперев.
[41:35.680 --> 41:37.680]  Продолжаем разговор.
[41:37.680 --> 41:39.680]  Сильная выпуклая функция.
[41:39.680 --> 41:41.680]  Напоминаю, что у нас было
[41:41.680 --> 41:43.680]  следствие сильной выпуклости
[41:43.680 --> 41:45.680]  о том, что
[41:45.680 --> 41:47.680]  если функция сильной выпуклой,
[41:47.680 --> 41:49.680]  то ее можно снизу оценить тоже параболой.
[41:49.680 --> 41:51.680]  То есть тут мы
[41:51.680 --> 41:53.680]  в случае просто L-гладкой
[41:53.680 --> 41:55.680]  оценивали сверху параболой.
[41:55.680 --> 41:57.680]  В случае сильной выпуклой можем оценить снизу параболой.
[41:57.680 --> 41:59.680]  Причем коэффициент
[41:59.680 --> 42:01.680]  у этой параболы будет
[42:01.680 --> 42:03.680]  постоянно сильной выпуклости mu.
[42:05.680 --> 42:07.680]  Тогда
[42:07.680 --> 42:09.680]  мы можем минимизировать
[42:09.680 --> 42:11.680]  в обе части позад.
[42:11.680 --> 42:13.680]  То есть до этого мы минимизировали
[42:13.680 --> 42:15.680]  оценку сверху,
[42:15.680 --> 42:17.680]  получили градиентный спуск,
[42:17.680 --> 42:19.680]  а сейчас будем минимизировать
[42:19.680 --> 42:21.680]  одновременно и левую правую часть,
[42:21.680 --> 42:23.680]  то есть оценку снизу.
[42:23.680 --> 42:25.680]  Что мы получим?
[42:25.680 --> 42:27.680]  Здесь мы получим f-адыка со звездочкой,
[42:27.680 --> 42:29.680]  понятное дело.
[42:29.680 --> 42:31.680]  А здесь, проделав все те же
[42:31.680 --> 42:33.680]  самыми манипуляциями,
[42:33.680 --> 42:35.680]  мы получим
[42:35.680 --> 42:37.680]  вот такое выражение.
[42:37.680 --> 42:39.680]  То есть у нас было вот здесь
[42:39.680 --> 42:41.680]  единица на 2L,
[42:41.680 --> 42:43.680]  а тут станет единица на 2 mu.
[42:45.680 --> 42:47.680]  Тогда норма градиента
[42:47.680 --> 42:49.680]  оценивается сверху как
[42:49.680 --> 42:51.680]  2 mu умножить на
[42:51.680 --> 42:53.680]  разность между f-адыка
[42:53.680 --> 42:55.680]  и f со звездочкой.
[42:57.680 --> 42:59.680]  Понятен ли первый шаг
[42:59.680 --> 43:01.680]  к тому, чтобы получить нужный нам результат?
[43:07.680 --> 43:09.680]  Вообще не очень понятна
[43:09.680 --> 43:11.680]  минимизация.
[43:11.680 --> 43:13.680]  Не очень понятна минимизация.
[43:13.680 --> 43:15.680]  Ну, смотрите, мы до
[43:15.680 --> 43:17.680]  этого
[43:17.680 --> 43:19.680]  смотрели на то... То есть мы хотели
[43:19.680 --> 43:21.680]  получить, найти
[43:21.680 --> 43:23.680]  минимум этой функции,
[43:23.680 --> 43:25.680]  и мы ее сверху оцениваем,
[43:25.680 --> 43:27.680]  находясь в текущей
[43:27.680 --> 43:29.680]  точке.
[43:29.680 --> 43:31.680]  Давайте лучше я нарисую картинку.
[43:31.680 --> 43:33.680]  Наверное, это будет полегче.
[43:43.680 --> 43:45.680]  Ну, то есть
[43:45.680 --> 43:47.680]  было что-то,
[43:47.680 --> 43:49.680]  ну, какая-то график там,
[43:49.680 --> 43:51.680]  была какая-то там
[43:51.680 --> 43:53.680]  странная выпуклая
[43:53.680 --> 43:55.680]  функция.
[43:55.680 --> 43:57.680]  Давайте кривовато получилось.
[43:57.680 --> 43:59.680]  Несимметрично
[43:59.680 --> 44:01.680]  я нарисовал.
[44:01.680 --> 44:03.680]  И вот мы находимся
[44:03.680 --> 44:05.680]  в текущей точке.
[44:05.680 --> 44:07.680]  Вот наш xk.
[44:07.680 --> 44:09.680]  И мы вот,
[44:09.680 --> 44:11.680]  будучи в этой точке, вот эту красную
[44:11.680 --> 44:13.680]  функцию можем оценить
[44:13.680 --> 44:15.680]  глобально сверху некоторые параболы.
[44:17.680 --> 44:19.680]  Вот так.
[44:21.680 --> 44:23.680]  Это в одном случае.
[44:23.680 --> 44:25.680]  Это если просто была l
[44:25.680 --> 44:27.680]  гладкая.
[44:27.680 --> 44:29.680]  Если же она у нас
[44:29.680 --> 44:31.680]  не сильно выпукла,
[44:31.680 --> 44:33.680]  то мы в этой же точке можем оценить ее
[44:33.680 --> 44:35.680]  другой параболой.
[44:35.680 --> 44:37.680]  Ну, какой-нибудь вот такой.
[44:39.680 --> 44:41.680]  Ну, как-то вот так.
[44:41.680 --> 44:43.680]  Не очень
[44:43.680 --> 44:45.680]  художеством.
[44:45.680 --> 44:47.680]  Важно следующее, что
[44:47.680 --> 44:49.680]  в случае просто
[44:49.680 --> 44:51.680]  l гладкости мы находим минимум
[44:51.680 --> 44:53.680]  вот этой вот синенькой
[44:53.680 --> 44:55.680]  штуки и получаем вот здесь вот условно xk
[44:55.680 --> 44:57.680]  плюс один.
[44:59.680 --> 45:01.680]  Вот. А в случае
[45:01.680 --> 45:03.680]  нет, собственно, даже гридентной спуск.
[45:05.680 --> 45:07.680]  А в случае зеленой мы просто
[45:07.680 --> 45:09.680]  ищем минимум и смотрим,
[45:09.680 --> 45:11.680]  насколько мы долетим
[45:11.680 --> 45:13.680]  в данной точке
[45:13.680 --> 45:15.680]  от минимума.
[45:15.680 --> 45:17.680]  Насколько минимум нашей исходной функции больше,
[45:17.680 --> 45:19.680]  чем минимум ее оценки снизу.
[45:23.680 --> 45:25.680]  То есть, грубо говоря, минимум
[45:29.680 --> 45:31.680]  у зеленой условно где-нибудь здесь,
[45:31.680 --> 45:33.680]  а минимум у красной он
[45:33.680 --> 45:35.680]  где-то тут.
[45:35.680 --> 45:37.680]  И мы смотрим вот этот вот зазор.
[45:39.680 --> 45:41.680]  Сейчас. И пытаемся оценить,
[45:41.680 --> 45:43.680]  насколько зазор велик
[45:43.680 --> 45:45.680]  с помощью знания нормы гридиента
[45:45.680 --> 45:47.680]  в текущей точке.
[45:49.680 --> 45:51.680]  Вот. Это нужно будет нам
[45:51.680 --> 45:53.680]  сейчас увидеть, зачем.
[45:53.680 --> 45:55.680]  То есть умение оценивать
[45:55.680 --> 45:57.680]  и сверху, и снизу является ключевым
[45:57.680 --> 45:59.680]  для получения оценок исходимости
[45:59.680 --> 46:01.680]  для синевых функций.
[46:05.680 --> 46:07.680]  Да. Получили норму гридиента.
[46:07.680 --> 46:09.680]  Насколько она велика.
[46:11.680 --> 46:13.680]  Окей. Теперь у нас есть информация
[46:13.680 --> 46:15.680]  о том, что наш шаг
[46:15.680 --> 46:17.680]  это единица на L.
[46:17.680 --> 46:19.680]  Поэтому у нас есть оценка сверху.
[46:19.680 --> 46:21.680]  Ну, собственно, вот это
[46:21.680 --> 46:23.680]  переписано то, что мы получили
[46:23.680 --> 46:25.680]  вот здесь.
[46:29.680 --> 46:31.680]  Только на минус один умножили,
[46:31.680 --> 46:33.680]  короче, преобразовали.
[46:33.680 --> 46:35.680]  Что f со звездочкой меньше
[46:35.680 --> 46:37.680]  лимбровной, чем f от x ка плюс один,
[46:37.680 --> 46:39.680]  меньше, чем f от x минус в общем.
[46:39.680 --> 46:41.680]  Вот.
[46:41.680 --> 46:43.680]  То есть это просто по определению.
[46:43.680 --> 46:45.680]  Далее. Получаем
[46:45.680 --> 46:47.680]  линию исходимости. Каким образом мы это будем делать?
[46:47.680 --> 46:49.680]  Тут вот, да,
[46:49.680 --> 46:51.680]  надо будет что-то дописать еще, чтобы было совсем очевидно.
[46:51.680 --> 46:53.680]  Смотрите.
[46:53.680 --> 46:55.680]  Нам нужно оценить сверху f от x
[46:55.680 --> 46:57.680]  ка плюс один минус f со звездочкой.
[46:57.680 --> 46:59.680]  Значит, f от x ка плюс один
[46:59.680 --> 47:01.680]  минус f со звездочкой, это
[47:01.680 --> 47:03.680]  что это есть такое?
[47:03.680 --> 47:05.680]  Это в точности вот то, что у нас
[47:05.680 --> 47:07.680]  стоит вот здесь.
[47:07.680 --> 47:09.680]  В общем,
[47:09.680 --> 47:11.680]  из этого неравенства
[47:11.680 --> 47:13.680]  вычли f от x
[47:13.680 --> 47:15.680]  со звездочкой.
[47:15.680 --> 47:17.680]  Получили слева f от x ка плюс один
[47:17.680 --> 47:19.680]  минус f со звездочкой,
[47:19.680 --> 47:21.680]  а тут у нас f от x ка минус f со звездочкой.
[47:21.680 --> 47:23.680]  А мы знаем, что у нас f от x
[47:23.680 --> 47:25.680]  минус f со звездочкой
[47:25.680 --> 47:27.680]  меньше, чем норма градиента
[47:27.680 --> 47:29.680]  делить на 2 на мил.
[47:29.680 --> 47:31.680]  Вот.
[47:31.680 --> 47:33.680]  Таким образом,
[47:33.680 --> 47:35.680]  мы получили
[47:35.680 --> 47:37.680]  вот.
[47:37.680 --> 47:39.680]  Таким образом, с одной стороны...
[47:39.680 --> 47:41.680]  А, это же не так.
[47:41.680 --> 47:43.680]  Тут у нас f от x минус f со звездочкой остается,
[47:43.680 --> 47:45.680]  а норма градиента заменяется
[47:45.680 --> 47:47.680]  на выражение, связанное с
[47:47.680 --> 47:49.680]  вот этим вот множителем.
[47:49.680 --> 47:51.680]  И получается, что
[47:51.680 --> 47:53.680]  если вынести вот этот общий множитель,
[47:53.680 --> 47:55.680]  то получится коэффициент равный
[47:55.680 --> 47:57.680]  едице минус едице на каппо,
[47:57.680 --> 47:59.680]  где каппо это l на мю.
[47:59.680 --> 48:01.680]  Вот 2х кратятся,
[48:01.680 --> 48:03.680]  которые здесь.
[48:03.680 --> 48:05.680]  Понятно ли, что произошло,
[48:05.680 --> 48:07.680]  или лучше расписать более подробно?
[48:11.680 --> 48:13.680]  Честно говоря, получается, вы
[48:13.680 --> 48:15.680]  действительно... Ну да, правильно ли,
[48:15.680 --> 48:17.680]  что вы просто вычислили f со звездочкой,
[48:17.680 --> 48:19.680]  а потом как бы вы читаете
[48:19.680 --> 48:21.680]  меньше, потому что неравенство
[48:21.680 --> 48:23.680]  то, что норма градиента
[48:23.680 --> 48:25.680]  больше, чем вот это.
[48:25.680 --> 48:27.680]  Так, я понял, что сейчас надо лучше все это
[48:27.680 --> 48:29.680]  переписать. Сейчас секундочку, я это покажу
[48:29.680 --> 48:31.680]  на доске. Да, тут я
[48:31.680 --> 48:33.680]  не докрутил чуть-чуть слайд,
[48:33.680 --> 48:35.680]  но, в общем, сейчас все будет.
[48:35.680 --> 48:37.680]  Так, минус единица
[48:37.680 --> 48:39.680]  на 2l, норма градиента,
[48:39.680 --> 48:41.680]  да.
[48:41.680 --> 48:43.680]  Так, норма градиента
[48:43.680 --> 48:45.680]  у нас больше, поэтому
[48:49.680 --> 48:51.680]  сейчас у нас есть 1 и 2.
[48:51.680 --> 48:53.680]  Значит, чтобы получиться
[48:53.680 --> 48:55.680]  нку сверху,
[48:55.680 --> 48:57.680]  нам надо вычитать
[48:57.680 --> 48:59.680]  нам надо вычитать
[49:01.680 --> 49:03.680]  что-то меньшее, да?
[49:07.680 --> 49:09.680]  Да, у вас как раз неравенство,
[49:09.680 --> 49:11.680]  что эта штука меньше.
[49:15.680 --> 49:17.680]  Так, сейчас я пойму, секунду.
[49:23.680 --> 49:25.680]  Что сломалось?
[49:25.680 --> 49:27.680]  Ага.
[49:29.680 --> 49:31.680]  Так, а что у меня есть? У меня есть то, что
[49:31.680 --> 49:33.680]  норма градиента
[49:37.680 --> 49:39.680]  больше, чем 2μ
[49:39.680 --> 49:41.680]  на f от xk,
[49:41.680 --> 49:43.680]  fk, минусов со звездочкой, да?
[49:43.680 --> 49:45.680]  И мне нужно
[49:45.680 --> 49:47.680]  теперь получить
[49:47.680 --> 49:49.680]  нку сверху на эту самую разность.
[49:49.680 --> 49:51.680]  Так, чтобы у нее получить,
[49:51.680 --> 49:53.680]  надо сделать так, чтобы там был
[49:55.680 --> 49:57.680]  чтобы там был минус.
[49:59.680 --> 50:01.680]  Чтобы там был минус.
[50:25.680 --> 50:27.680]  Да, возможно, здесь какие-то проблемы
[50:27.680 --> 50:29.680]  со знакомыми в некотором месте возникли.
[50:29.680 --> 50:31.680]  Все же нормально, у вас
[50:31.680 --> 50:33.680]  норма градиента больше, чем какое-то
[50:33.680 --> 50:35.680]  число. А вы норму
[50:35.680 --> 50:37.680]  как бы вычитаете. Значит, если вы будете
[50:37.680 --> 50:39.680]  вычитать меньшее число, вы получите
[50:39.680 --> 50:41.680]  оценку сверху.
[50:41.680 --> 50:43.680]  Да, но я же вроде как больше вычитаю,
[50:43.680 --> 50:45.680]  или нет? Нет, вы наоборот, ну как бы
[50:45.680 --> 50:47.680]  здесь вы читаете больше, да?
[50:47.680 --> 50:49.680]  А, я вычитаю меньшее, да-да-да-да, я вычитаю уже
[50:49.680 --> 50:51.680]  2μ. Все, спасибо.
[50:51.680 --> 50:53.680]  Да, что-то я запутался. Да, то есть
[50:53.680 --> 50:55.680]  что-то получается, что...
[50:55.680 --> 50:57.680]  Да, сейчас надо показать картинку.
[50:57.680 --> 50:59.680]  Да, я градиента же
[50:59.680 --> 51:01.680]  отказываюсь, наоборот.
[51:01.680 --> 51:03.680]  Поэтому все в порядке.
[51:05.680 --> 51:07.680]  Да, то есть было вот так
[51:07.680 --> 51:09.680]  вычли, а потом
[51:09.680 --> 51:11.680]  вычитаем меньшее
[51:11.680 --> 51:13.680]  вот это вот равное 2μ на разность
[51:13.680 --> 51:15.680]  f. И получаем, что
[51:15.680 --> 51:17.680]  давайте я вот это вот перенесу лучше вот
[51:17.680 --> 51:19.680]  сюда, так эту рамочку надо ввести.
[51:19.680 --> 51:21.680]  Вот, а тут
[51:21.680 --> 51:23.680]  меньше либо равно, чем
[51:23.680 --> 51:25.680]  fk-то минус f со звездочкой,
[51:25.680 --> 51:27.680]  минус
[51:27.680 --> 51:29.680]  2μ на 2l
[51:29.680 --> 51:31.680]  на fk
[51:31.680 --> 51:33.680]  минус f со звездочкой.
[51:33.680 --> 51:35.680]  Да, ну вот оно и получается.
[51:35.680 --> 51:37.680]  1 минус 1
[51:37.680 --> 51:39.680]  на kappa на
[51:39.680 --> 51:41.680]  fk-то минус f со звездочкой.
[51:41.680 --> 51:43.680]  Вот, kappa чудо
[51:43.680 --> 51:45.680]  l на μ.
[51:45.680 --> 51:47.680]  Вот, понятно, наверное, что
[51:47.680 --> 51:49.680]  kappa это
[51:49.680 --> 51:51.680]  то есть kappa это
[51:51.680 --> 51:53.680]  некоторое число, которое лежит в интервале
[51:53.680 --> 51:55.680]  от 1 до плюс бесконечности.
[51:55.680 --> 51:57.680]  Вот, если плюс бесконечности, если оно
[51:57.680 --> 51:59.680]  очень большое,
[51:59.680 --> 52:01.680]  kappa растет.
[52:01.680 --> 52:03.680]  В общем,
[52:03.680 --> 52:05.680]  чем больше kappa,
[52:05.680 --> 52:07.680]  я неправильно говорю,
[52:07.680 --> 52:09.680]  чем меньше
[52:09.680 --> 52:11.680]  μ, то есть μ меньше,
[52:11.680 --> 52:13.680]  следовательно, kappa больше.
[52:13.680 --> 52:15.680]  Поэтому чем наша функция
[52:15.680 --> 52:17.680]  будет сказать,
[52:17.680 --> 52:19.680]  все хуже
[52:19.680 --> 52:21.680]  и хуже,
[52:21.680 --> 52:23.680]  то есть это значит, что у нее константа
[52:23.680 --> 52:25.680]  7,5, чем меньше и меньше,
[52:25.680 --> 52:27.680]  тем обусловленность выше
[52:27.680 --> 52:29.680]  и тем медленнее будет
[52:29.680 --> 52:31.680]  сходимость. То есть
[52:31.680 --> 52:33.680]  отсюда же что следует, что
[52:33.680 --> 52:35.680]  fk-то минус f со звездочкой
[52:35.680 --> 52:37.680]  поможет, да,
[52:37.680 --> 52:39.680]  меньше либо равно, чем 1
[52:39.680 --> 52:41.680]  минус 1 на k по степени k
[52:41.680 --> 52:43.680]  на f0
[52:43.680 --> 52:45.680]  минус 0 минус f со звездочкой.
[52:47.680 --> 52:49.680]  То есть вот мы получили
[52:49.680 --> 52:51.680]  линейную сходимость
[52:51.680 --> 52:53.680]  с коэффициентом, который равен
[52:53.680 --> 52:55.680]  единице минус единице
[52:55.680 --> 52:57.680]  на k. Отсюда
[52:57.680 --> 52:59.680]  если kappa очень большое,
[52:59.680 --> 53:01.680]  то эта штука стремится к единице,
[53:01.680 --> 53:03.680]  что очень грустно.
[53:03.680 --> 53:05.680]  При этом, если kappa
[53:05.680 --> 53:07.680]  равно единице,
[53:07.680 --> 53:09.680]  то мы сойдем из одной итерации.
[53:13.680 --> 53:15.680]  Понятен ли этот пример?
[53:15.680 --> 53:17.680]  Ну, не пример, а как бы интерпретация.
[53:19.680 --> 53:21.680]  Очень хорошо.
[53:21.680 --> 53:23.680]  Так.
[53:25.680 --> 53:27.680]  Да, линейную сходимость получили. Отлично.
[53:27.680 --> 53:29.680]  Теперь
[53:29.680 --> 53:31.680]  некоторая теорема
[53:31.680 --> 53:33.680]  тоже про сильную клей-функцию,
[53:33.680 --> 53:35.680]  которая может быть чуть более общей
[53:35.680 --> 53:37.680]  связывать как раз таки
[53:37.680 --> 53:39.680]  по функции с...
[53:39.680 --> 53:41.680]  А, тут уже все аккуратно. Видите, тут со звездочкой стоит.
[53:41.680 --> 53:43.680]  То есть, по сути,
[53:43.680 --> 53:45.680]  некоторая переформулировка того, что мы
[53:45.680 --> 53:47.680]  уже использовали, только с учетом того,
[53:47.680 --> 53:49.680]  что шаг еще дополнительно подбирается так,
[53:49.680 --> 53:51.680]  чтобы с учетом константа есть сильный выпуск.
[53:51.680 --> 53:53.680]  Мы пока что подбирали шаг
[53:53.680 --> 53:55.680]  равный единице на l, никак не
[53:55.680 --> 53:57.680]  использовали mu. А тут mu используют,
[53:57.680 --> 53:59.680]  получают немножко другой коэффициент,
[53:59.680 --> 54:01.680]  но зависимость от kappa
[54:01.680 --> 54:03.680]  остается прежней.
[54:03.680 --> 54:05.680]  То есть здесь, по сути, kappa минус 1 на kappa плюс 1.
[54:07.680 --> 54:09.680]  И это все работает.
[54:09.680 --> 54:11.680]  Значит, теперь
[54:11.680 --> 54:13.680]  самое интересное, что
[54:13.680 --> 54:15.680]  на эту самую линию сходимость влияет.
[54:15.680 --> 54:17.680]  На нее влияет
[54:17.680 --> 54:19.680]  значение для куса звездочки,
[54:19.680 --> 54:21.680]  который мы...
[54:21.680 --> 54:23.680]  Вот это куса звездочки у нас.
[54:23.680 --> 54:25.680]  Или вот здесь, это просто вот эта величина.
[54:27.680 --> 54:29.680]  Выражаясь через kappa,
[54:29.680 --> 54:31.680]  числа бусловности для матрицы
[54:31.680 --> 54:33.680]  это отношение максимального
[54:33.680 --> 54:35.680]  к минимальному симметричному,
[54:35.680 --> 54:37.680]  то это отношение максимального
[54:37.680 --> 54:39.680]  к минимальному собственному значению,
[54:39.680 --> 54:41.680]  поэтому здесь очень прямая аналогия
[54:41.680 --> 54:43.680]  с
[54:43.680 --> 54:45.680]  в общем,
[54:45.680 --> 54:47.680]  с бусловностью
[54:47.680 --> 54:49.680]  гисианы и константами
[54:49.680 --> 54:51.680]  сильной выпусти и липшести градиента,
[54:51.680 --> 54:53.680]  которые у нас есть в функции.
[54:53.680 --> 54:55.680]  Соответственно, при kappa очень больших,
[54:55.680 --> 54:57.680]  да, в общем, я это уже в сути показал,
[54:57.680 --> 54:59.680]  у нас есть тремление к единице и очень медленно сходим.
[54:59.680 --> 55:01.680]  То есть если взять kappa равное 100,
[55:01.680 --> 55:03.680]  то мы получим уже q равное
[55:03.680 --> 55:05.680]  0.98, что будет
[55:05.680 --> 55:07.680]  безумно долго сходить. Если там kappa порядка единицы,
[55:07.680 --> 55:09.680]  ну, например,
[55:09.680 --> 55:11.680]  для 0.6,
[55:11.680 --> 55:13.680]  для 4 получим q равное 0.6,
[55:13.680 --> 55:15.680]  что достаточно быстро
[55:15.680 --> 55:17.680]  приведет нас к
[55:17.680 --> 55:19.680]  достаточно маленькому значению.
[55:19.680 --> 55:21.680]  Геометрию этого требования,
[55:21.680 --> 55:23.680]  тут я, да, тут я, наверное,
[55:23.680 --> 55:25.680]  надо написать картинку,
[55:25.680 --> 55:27.680]  геометрию этого требования очень простая,
[55:27.680 --> 55:29.680]  мы просто хотим, чтобы,
[55:31.680 --> 55:33.680]  да, можно сейчас, например,
[55:33.680 --> 55:35.680]  быстренько нарисовать
[55:35.680 --> 55:37.680]  довольно простой.
[55:37.680 --> 55:39.680]  Мы хотим, чтобы наша функция,
[55:39.680 --> 55:41.680]  например, если в 2D мы живем,
[55:41.680 --> 55:43.680]  она была, как можно более,
[55:43.680 --> 55:45.680]  ее линии и уровни были как можно более сферическими.
[55:45.680 --> 55:47.680]  То есть
[55:47.680 --> 55:49.680]  в условиях близка к единице
[55:49.680 --> 55:51.680]  линии и уровня вот так выглядит,
[55:51.680 --> 55:53.680]  kappa порядка единицы,
[55:53.680 --> 55:55.680]  kappa существенно больше
[55:55.680 --> 55:57.680]  единицы линии и уровня выглядит вот так.
[55:59.680 --> 56:01.680]  Вот, и поэтому если мы, например,
[56:01.680 --> 56:03.680]  стартуем отсюда, то мы,
[56:03.680 --> 56:05.680]  давайте я нарисую, будем вот так вот
[56:05.680 --> 56:07.680]  зигзагообразно сходиться очень-очень
[56:07.680 --> 56:09.680]  долго. Вот, а здесь мы за одну
[56:09.680 --> 56:11.680]  итерацию придем к решению.
[56:11.680 --> 56:13.680]  Ну и простой пример, когда
[56:13.680 --> 56:15.680]  это легко увидеть, это функция там, не знаю,
[56:15.680 --> 56:17.680]  x-транспонированная x,
[56:17.680 --> 56:19.680]  то есть если у нас функция f от
[56:19.680 --> 56:21.680]  x,
[56:21.680 --> 56:23.680]  одна вторая x-транспонированная
[56:23.680 --> 56:25.680]  x,
[56:25.680 --> 56:27.680]  давайте без одной и второй даже.
[56:27.680 --> 56:29.680]  Вот.
[56:29.680 --> 56:31.680]  Тогда градиент
[56:31.680 --> 56:33.680]  f от x это 2x,
[56:33.680 --> 56:35.680]  гисиан,
[56:35.680 --> 56:37.680]  ой,
[56:37.680 --> 56:39.680]  гисиан
[56:39.680 --> 56:41.680]  f2 штиха от
[56:41.680 --> 56:43.680]  x это
[56:43.680 --> 56:45.680]  две единичные матрицы,
[56:45.680 --> 56:47.680]  отсюда
[56:47.680 --> 56:49.680]  кастанта липшица равна 2.
[56:49.680 --> 56:51.680]  Вот.
[56:51.680 --> 56:53.680]  И тогда возьмем у них 3x0,
[56:53.680 --> 56:55.680]  тогда x1 у нас, ну понятно,
[56:55.680 --> 56:57.680]  что f2 штиха равна 0.
[56:57.680 --> 56:59.680]  Вот.
[56:59.680 --> 57:01.680]  Тогда x1 это x0 минус
[57:01.680 --> 57:03.680]  единица на l
[57:03.680 --> 57:05.680]  умножить на 2x0
[57:07.680 --> 57:09.680]  равно 0.
[57:13.680 --> 57:15.680]  Что не так?
[57:19.680 --> 57:21.680]  А, да, mu тоже
[57:21.680 --> 57:23.680]  равно 2. Вот.
[57:23.680 --> 57:25.680]  Все-таки kappa равно единицу.
[57:25.680 --> 57:27.680]  Понятно, почему все это работает
[57:27.680 --> 57:29.680]  в этом примере или не очень?
[57:29.680 --> 57:31.680]  Или я слишком быстро все
[57:31.680 --> 57:33.680]  рассказал?
[57:35.680 --> 57:37.680]  Да, можно еще раз как вы определили
[57:37.680 --> 57:39.680]  l, mu?
[57:39.680 --> 57:41.680]  Да, смотрите. Ну, l как определим l?
[57:41.680 --> 57:43.680]  Мы уже знаем, что у нас l это
[57:43.680 --> 57:45.680]  константа липшица для градиента,
[57:45.680 --> 57:47.680]  слишком долго не буду писать,
[57:47.680 --> 57:49.680]  это равносильно тому, что у нас
[57:49.680 --> 57:51.680]  норма ограничена
[57:51.680 --> 57:53.680]  сверху.
[57:53.680 --> 57:55.680]  Это у нас был такой критерий, помните?
[57:55.680 --> 57:57.680]  Оказывали?
[57:57.680 --> 57:59.680]  Да.
[57:59.680 --> 58:01.680]  Вот. Наш
[58:01.680 --> 58:03.680]  десиан в этом случае это 2 и 2 единичные матрицы.
[58:05.680 --> 58:07.680]  Норма равна 2.
[58:13.680 --> 58:15.680]  Понятно, почему?
[58:15.680 --> 58:17.680]  Да. Прекрасно.
[58:17.680 --> 58:19.680]  Вот константа l равно 2.
[58:19.680 --> 58:21.680]  Да, хорошо, а mu?
[58:21.680 --> 58:23.680]  Вот. Теперь про mu давайте.
[58:23.680 --> 58:25.680]  Mu это...
[58:27.680 --> 58:29.680]  То есть, поскольку у нас про mu есть
[58:29.680 --> 58:31.680]  оценка снизу,
[58:31.680 --> 58:33.680]  я, конечно, это сегодня не доказываю, но
[58:33.680 --> 58:35.680]  давайте сейчас я на пальцах объясню.
[58:35.680 --> 58:37.680]  Про mu у нас есть вот это.
[58:39.680 --> 58:41.680]  Вот. А это значит,
[58:41.680 --> 58:43.680]  что, короче говоря,
[58:43.680 --> 58:45.680]  проводя все те же самые
[58:45.680 --> 58:47.680]  рассуждения, которые были проведены вот здесь,
[58:47.680 --> 58:49.680]  можно показать,
[58:49.680 --> 58:51.680]  что
[58:51.680 --> 58:53.680]  константа mu будет...
[58:53.680 --> 58:55.680]  Константа сильной выпуски для дважды и дни
[58:55.680 --> 58:57.680]  дифференцируемой функции,
[58:57.680 --> 58:59.680]  это равносильно тому, что вторая норма снизу
[58:59.680 --> 59:01.680]  ограничена mu.
[59:03.680 --> 59:05.680]  То есть, вот тут те же самые
[59:05.680 --> 59:07.680]  рассуждения будут работать.
[59:07.680 --> 59:09.680]  Про оценку сверху квадратичную.
[59:13.680 --> 59:15.680]  Ой, сори, не так.
[59:15.680 --> 59:17.680]  Ну, в общем...
[59:17.680 --> 59:19.680]  Сейчас я неправильно
[59:19.680 --> 59:21.680]  объясняю, секунду.
[59:21.680 --> 59:23.680]  Короче говоря, вот
[59:23.680 --> 59:25.680]  поскольку у нас
[59:25.680 --> 59:27.680]  есть вот это,
[59:27.680 --> 59:29.680]  тут надо поаккуратнее, то это значит,
[59:29.680 --> 59:31.680]  что мы в каком-то смысле взяли
[59:31.680 --> 59:33.680]  и оценили
[59:33.680 --> 59:35.680]  норму нашего
[59:35.680 --> 59:37.680]  гисяна, который стоял бы...
[59:37.680 --> 59:39.680]  квадратичная форма, с которым стояла бы тут,
[59:39.680 --> 59:41.680]  она
[59:41.680 --> 59:43.680]  заменили mu умножить на единичную матрицу.
[59:43.680 --> 59:45.680]  А раз мы это сделали,
[59:45.680 --> 59:47.680]  то мы и подразумеваем, что
[59:47.680 --> 59:49.680]  норма нашего гисяна больше
[59:49.680 --> 59:51.680]  либо равна mu.
[59:51.680 --> 59:53.680]  То есть, мы как бы снизу подперли
[59:53.680 --> 59:55.680]  эту норму.
[59:55.680 --> 59:57.680]  Ну, а мы уже получили,
[59:57.680 --> 59:59.680]  что у нас норма просто равна 2.
[59:59.680 --> 01:00:01.680]  То есть, там для любого х на 1 этаже.
[01:00:03.680 --> 01:00:05.680]  Поэтому mu тоже будет
[01:00:05.680 --> 01:00:07.680]  равно 2.
[01:00:13.680 --> 01:00:15.680]  Вот.
[01:00:15.680 --> 01:00:17.680]  Ну, то есть, как бы
[01:00:17.680 --> 01:00:19.680]  вот эта вот картинка,
[01:00:19.680 --> 01:00:21.680]  она по сути говорит
[01:00:21.680 --> 01:00:23.680]  о том, в каких пределах
[01:00:23.680 --> 01:00:25.680]  может варьироваться
[01:00:25.680 --> 01:00:27.680]  кривизна нашей функции
[01:00:27.680 --> 01:00:29.680]  исходной. То есть, она ограничена
[01:00:29.680 --> 01:00:31.680]  сверху l и ограничена
[01:00:31.680 --> 01:00:33.680]  снизу mu, если
[01:00:33.680 --> 01:00:35.680]  функция является сильной
[01:00:35.680 --> 01:00:37.680]  выпухой.
[01:00:37.680 --> 01:00:39.680]  Насколько убедителен
[01:00:39.680 --> 01:00:41.680]  такие объяснения?
[01:00:41.680 --> 01:00:43.680]  Я в следующий раз
[01:00:43.680 --> 01:00:45.680]  что-то поподробнее расскажу.
[01:00:45.680 --> 01:00:47.680]  Наверное, то, что
[01:00:47.680 --> 01:00:49.680]  вы просто ограничиваете кривизну,
[01:00:49.680 --> 01:00:51.680]  это нормально.
[01:00:51.680 --> 01:00:53.680]  Нормально, да? Ну, хорошо, да.
[01:00:53.680 --> 01:00:55.680]  Просто можно все это формально
[01:00:55.680 --> 01:00:57.680]  расписывать аккуратно и
[01:00:57.680 --> 01:00:59.680]  строже, но это типа еще там
[01:00:59.680 --> 01:01:01.680]  15. Вот. Поэтому
[01:01:01.680 --> 01:01:03.680]  mu равно тоже 2.
[01:01:03.680 --> 01:01:05.680]  Консонта липчется равна 1,
[01:01:05.680 --> 01:01:07.680]  и мы за одну литерацию сходимся.
[01:01:07.680 --> 01:01:09.680]  Вот. Теперь
[01:01:09.680 --> 01:01:11.680]  если, например,
[01:01:11.680 --> 01:01:13.680]  рассмотрим функцию вида
[01:01:15.680 --> 01:01:17.680]  x-транспонированная qx,
[01:01:21.680 --> 01:01:23.680]  то и, например, в случае
[01:01:23.680 --> 01:01:25.680]  если n равно 2,
[01:01:25.680 --> 01:01:27.680]  матрица q, например, будет иметь
[01:01:27.680 --> 01:01:29.680]  диагональный вид 1,100.
[01:01:29.680 --> 01:01:31.680]  Все будет гораздо
[01:01:31.680 --> 01:01:33.680]  хуже.
[01:01:33.680 --> 01:01:35.680]  Понятно, что
[01:01:35.680 --> 01:01:37.680]  ответ все еще в 0.
[01:01:37.680 --> 01:01:39.680]  Понятно, я надеюсь, да?
[01:01:39.680 --> 01:01:41.680]  Да.
[01:01:41.680 --> 01:01:43.680]  Да. Хорошо.
[01:01:43.680 --> 01:01:45.680]  Вот. Но тут уже так
[01:01:45.680 --> 01:01:47.680]  еще дело не пройдет.
[01:01:47.680 --> 01:01:49.680]  l у нас здесь какой будет?
[01:01:49.680 --> 01:01:51.680]  l будет равно 100,
[01:01:51.680 --> 01:01:53.680]  по-моему, да?
[01:01:53.680 --> 01:01:55.680]  Ну да,
[01:01:55.680 --> 01:01:57.680]  lambda max для q
[01:01:57.680 --> 01:01:59.680]  это 100.
[01:01:59.680 --> 01:02:01.680]  Ну а lambda min
[01:02:01.680 --> 01:02:03.680]  равно 1.
[01:02:03.680 --> 01:02:05.680]  Поэтому, когда мы будем делать
[01:02:05.680 --> 01:02:07.680]  1 на l, у нас будет
[01:02:07.680 --> 01:02:09.680]  1,100.
[01:02:09.680 --> 01:02:11.680]  Вот.
[01:02:11.680 --> 01:02:13.680]  Ну и наш
[01:02:13.680 --> 01:02:15.680]  благополучный x1 будет равен
[01:02:15.680 --> 01:02:17.680]  x0 минус
[01:02:17.680 --> 01:02:19.680]  две
[01:02:19.680 --> 01:02:21.680]  ой, две
[01:02:21.680 --> 01:02:23.680]  там градиент
[01:02:23.680 --> 01:02:25.680]  два qx.
[01:02:27.680 --> 01:02:29.680]  Две сотых
[01:02:29.680 --> 01:02:31.680]  qx 0.
[01:02:31.680 --> 01:02:33.680]  Соответственно,
[01:02:33.680 --> 01:02:35.680]  это равно
[01:02:35.680 --> 01:02:37.680]  денечной матрице
[01:02:37.680 --> 01:02:39.680]  минус две сотых q
[01:02:39.680 --> 01:02:41.680]  на x 0.
[01:02:41.680 --> 01:02:43.680]  Вот.
[01:02:43.680 --> 01:02:45.680]  Ну и понятно, что тут довольно долго
[01:02:45.680 --> 01:02:47.680]  надо будет страдать
[01:02:47.680 --> 01:02:49.680]  тем, чтобы прийти к 0.
[01:02:49.680 --> 01:02:51.680]  Потому что
[01:02:51.680 --> 01:02:53.680]  можно оценить, как это будет выглядеть,
[01:02:53.680 --> 01:02:55.680]  на самом деле, что
[01:02:55.680 --> 01:02:57.680]  1 минус
[01:02:57.680 --> 01:02:59.680]  две сотых
[01:02:59.680 --> 01:03:01.680]  и что?
[01:03:01.680 --> 01:03:03.680]  Минус 1 на x 0.
[01:03:03.680 --> 01:03:05.680]  Минус 1, что ли?
[01:03:05.680 --> 01:03:07.680]  Да.
[01:03:07.680 --> 01:03:09.680]  Тут уже что-то странное происходит.
[01:03:11.680 --> 01:03:13.680]  Точно две сотых?
[01:03:13.680 --> 01:03:15.680]  Да, вроде две сотых.
[01:03:17.680 --> 01:03:19.680]  А, нет.
[01:03:19.680 --> 01:03:21.680]  И правильно.
[01:03:21.680 --> 01:03:23.680]  Два q же, поэтому
[01:03:23.680 --> 01:03:25.680]  200 и 2.
[01:03:25.680 --> 01:03:27.680]  Да, поэтому
[01:03:27.680 --> 01:03:29.680]  будет 1 2 сотый,
[01:03:29.680 --> 01:03:31.680]  тут будет 1 сотый. Да, все правильно было.
[01:03:31.680 --> 01:03:33.680]  1 сотый, тут 1 сотый
[01:03:33.680 --> 01:03:35.680]  и
[01:03:35.680 --> 01:03:37.680]  единичный минус
[01:03:37.680 --> 01:03:39.680]  ноль.
[01:03:43.680 --> 01:03:45.680]  Окей.
[01:03:45.680 --> 01:03:47.680]  Пусть будет...
[01:03:47.680 --> 01:03:49.680]  Пусть будет...
[01:03:51.680 --> 01:03:53.680]  Тут пусть будет ноль, да,
[01:03:53.680 --> 01:03:55.680]  а тут будет что-то странное.
[01:03:55.680 --> 01:03:57.680]  И это что-то странное будет.
[01:03:57.680 --> 01:03:59.680]  То есть, по одной компоненте мы к 0 сойдемся,
[01:03:59.680 --> 01:04:01.680]  а по другой не сойдемся.
[01:04:01.680 --> 01:04:03.680]  И дальше будут
[01:04:03.680 --> 01:04:05.680]  мучительные попытки сойтись
[01:04:05.680 --> 01:04:07.680]  и по первой компоненте тоже.
[01:04:09.680 --> 01:04:11.680]  Эта штука будет довольно долго сходиться,
[01:04:11.680 --> 01:04:13.680]  сценировать к 0.
[01:04:15.680 --> 01:04:17.680]  Это к тому, что большая обусловенность
[01:04:17.680 --> 01:04:19.680]  приводит к очень медленной сходимости.
[01:04:21.680 --> 01:04:23.680]  Что я дальше хотел сказать?
[01:04:25.680 --> 01:04:27.680]  Дальше важный момент.
[01:04:27.680 --> 01:04:29.680]  Про геометрию я рассказал.
[01:04:29.680 --> 01:04:31.680]  Понятно про картинки,
[01:04:31.680 --> 01:04:33.680]  что это было?
[01:04:33.680 --> 01:04:35.680]  Почему что ломается?
[01:04:35.680 --> 01:04:37.680]  Вроде да.
[01:04:37.680 --> 01:04:39.680]  Хорошо.
[01:04:43.680 --> 01:04:45.680]  Дальше возникает вопрос,
[01:04:45.680 --> 01:04:47.680]  можно ли мы
[01:04:47.680 --> 01:04:49.680]  сходиться лучше?
[01:04:49.680 --> 01:04:51.680]  Мы знаем, что для уплакывающих функций
[01:04:51.680 --> 01:04:53.680]  липшим и градиентам, градиенты спускаются
[01:04:53.680 --> 01:04:55.680]  как единица нога,
[01:04:55.680 --> 01:04:57.680]  а для сильных функций с липшим и градиентам
[01:04:57.680 --> 01:04:59.680]  сходит слияние скорости сходимости
[01:04:59.680 --> 01:05:01.680]  такого вида.
[01:05:01.680 --> 01:05:03.680]  Вопрос не праздный.
[01:05:03.680 --> 01:05:05.680]  Можно ли сходиться быстрее?
[01:05:05.680 --> 01:05:07.680]  И что значит быстрее?
[01:05:07.680 --> 01:05:09.680]  И как это определить?
[01:05:11.680 --> 01:05:13.680]  Допустим, мы предъявим метод,
[01:05:13.680 --> 01:05:15.680]  который сходится быстрее.
[01:05:15.680 --> 01:05:17.680]  Вопрос, как понять, что лучше сойтись
[01:05:17.680 --> 01:05:19.680]  для данного класса функций нельзя?
[01:05:19.680 --> 01:05:21.680]  Но этот вопрос отвечает
[01:05:21.680 --> 01:05:23.680]  на такая история, концепция некоторая,
[01:05:23.680 --> 01:05:25.680]  название в нижней оценке сходимости.
[01:05:29.680 --> 01:05:31.680]  Ее с первого раза, мне кажется,
[01:05:31.680 --> 01:05:33.680]  понять не очень просто.
[01:05:33.680 --> 01:05:35.680]  Давайте я попробую объяснить так,
[01:05:35.680 --> 01:05:37.680]  чтобы было
[01:05:37.680 --> 01:05:39.680]  плюс-минус
[01:05:39.680 --> 01:05:41.680]  ясно, зачем это надо,
[01:05:41.680 --> 01:05:43.680]  и какая конструкция для этого строится.
[01:05:45.680 --> 01:05:47.680]  У нас есть два класса
[01:05:47.680 --> 01:05:49.680]  функций,
[01:05:49.680 --> 01:05:51.680]  и в каждом из них
[01:05:51.680 --> 01:05:53.680]  мы можем найти
[01:05:53.680 --> 01:05:55.680]  такие функции,
[01:05:55.680 --> 01:05:57.680]  что выполнены следующей оценке снизу.
[01:05:57.680 --> 01:05:59.680]  Для выпуклых функций
[01:05:59.680 --> 01:06:01.680]  с липшим и градиентом вот так вот,
[01:06:01.680 --> 01:06:03.680]  а для сильно выпуклых функций вот так вот.
[01:06:07.680 --> 01:06:09.680]  При ограничении
[01:06:09.680 --> 01:06:11.680]  на класс методов такой,
[01:06:11.680 --> 01:06:13.680]  что каждая следующая точка
[01:06:13.680 --> 01:06:15.680]  это x0 плюс некоторые
[01:06:15.680 --> 01:06:17.680]  линии и комбинации градиентов,
[01:06:17.680 --> 01:06:19.680]  полученных во всех предыдущих точках.
[01:06:23.680 --> 01:06:25.680]  Что предлагается сделать?
[01:06:25.680 --> 01:06:27.680]  У нас есть семейство методов,
[01:06:27.680 --> 01:06:29.680]  и у нас есть класс функций.
[01:06:29.680 --> 01:06:31.680]  Мы в каждом из этих классов
[01:06:31.680 --> 01:06:33.680]  функций строим некоторым
[01:06:33.680 --> 01:06:35.680]  хитрым образом такую функцию,
[01:06:35.680 --> 01:06:37.680]  что какой бы метод
[01:06:37.680 --> 01:06:39.680]  из вот этого семейства
[01:06:39.680 --> 01:06:41.680]  мы не взяли,
[01:06:41.680 --> 01:06:43.680]  у нас получится, что
[01:06:43.680 --> 01:06:45.680]  любой метод из этого семейства
[01:06:45.680 --> 01:06:47.680]  на этой функции
[01:06:47.680 --> 01:06:49.680]  будет сходиться не лучше,
[01:06:49.680 --> 01:06:51.680]  чем вот так.
[01:06:53.680 --> 01:06:55.680]  То есть если, например,
[01:06:55.680 --> 01:06:57.680]  для градиентного спуска мы находили
[01:06:57.680 --> 01:06:59.680]  оценки сверху,
[01:06:59.680 --> 01:07:01.680]  то тут мы наоборот находим оценку снизу,
[01:07:01.680 --> 01:07:03.680]  чтобы показать, что
[01:07:03.680 --> 01:07:05.680]  лучше, чем вот так,
[01:07:05.680 --> 01:07:07.680]  живя в данном классе методов,
[01:07:07.680 --> 01:07:09.680]  сойтись на данном классе функций нельзя.
[01:07:11.680 --> 01:07:13.680]  Соответственно, методы,
[01:07:13.680 --> 01:07:15.680]  которые достигают этих нижних оценок,
[01:07:15.680 --> 01:07:17.680]  называются оптимальными.
[01:07:17.680 --> 01:07:19.680]  В том плане, что
[01:07:19.680 --> 01:07:21.680]  в смысле теоретических оценок
[01:07:21.680 --> 01:07:23.680]  сойтись быстрее
[01:07:23.680 --> 01:07:25.680]  на заданном классе задач
[01:07:25.680 --> 01:07:27.680]  в заданном классе методов
[01:07:27.680 --> 01:07:29.680]  нельзя, потому что вот оценка.
[01:07:29.680 --> 01:07:31.680]  Понятно ли,
[01:07:31.680 --> 01:07:33.680]  что произошло?
[01:07:37.680 --> 01:07:39.680]  Нет, не очень.
[01:07:39.680 --> 01:07:41.680]  Давайте я тогда попробую еще картинку нарисовать.
[01:07:41.680 --> 01:07:43.680]  Может быть, после картинки станет полегче.
[01:07:45.680 --> 01:07:47.680]  Вот, смотрите.
[01:07:47.680 --> 01:07:49.680]  Так.
[01:07:55.680 --> 01:07:57.680]  Сейчас, погоди, давайте я нарисую картинку сначала.
[01:07:57.680 --> 01:07:59.680]  Сначала нарисую картинку,
[01:07:59.680 --> 01:08:01.680]  потом покажу еще раз формулу.
[01:08:01.680 --> 01:08:03.680]  Значит, вот у нас есть
[01:08:03.680 --> 01:08:05.680]  некоторый класс функций.
[01:08:05.680 --> 01:08:07.680]  Назовем его...
[01:08:07.680 --> 01:08:09.680]  Зовем его f,
[01:08:09.680 --> 01:08:11.680]  фигурной такой вот.
[01:08:11.680 --> 01:08:13.680]  И есть класс методов m,
[01:08:13.680 --> 01:08:15.680]  фигурной.
[01:08:17.680 --> 01:08:19.680]  Это функция.
[01:08:19.680 --> 01:08:21.680]  Это метод.
[01:08:25.680 --> 01:08:27.680]  И это наш типичный график
[01:08:27.680 --> 01:08:29.680]  в зависимости
[01:08:29.680 --> 01:08:31.680]  некоторой метрики от числа и террации.
[01:08:33.680 --> 01:08:35.680]  Так, модуля
[01:08:35.680 --> 01:08:37.680]  вообще тут не нужна.
[01:08:39.680 --> 01:08:41.680]  Вот.
[01:08:41.680 --> 01:08:43.680]  Что мы только что
[01:08:43.680 --> 01:08:45.680]  получили для градиентного спуска?
[01:08:45.680 --> 01:08:47.680]  Ну, например, мы получили, что
[01:08:47.680 --> 01:08:49.680]  взяли какую-то функцию
[01:08:49.680 --> 01:08:51.680]  из...
[01:08:51.680 --> 01:08:53.680]  допустим, рассматривали
[01:08:53.680 --> 01:08:55.680]  класс выпуклых функций.
[01:08:55.680 --> 01:08:57.680]  И мы получили, что вот
[01:08:57.680 --> 01:08:59.680]  так сходится.
[01:08:59.680 --> 01:09:01.680]  Вот.
[01:09:01.680 --> 01:09:03.680]  Значит, вопрос. Почему
[01:09:03.680 --> 01:09:05.680]  нельзя сходить, например, вот так?
[01:09:05.680 --> 01:09:07.680]  Или как-нибудь вот так?
[01:09:07.680 --> 01:09:09.680]  Или
[01:09:09.680 --> 01:09:11.680]  как-нибудь...
[01:09:11.680 --> 01:09:13.680]  Так, сейчас я другой цвет выберу, секунду.
[01:09:13.680 --> 01:09:15.680]  Или как-нибудь, может быть, вот так.
[01:09:17.680 --> 01:09:19.680]  Может быть, существуют методы
[01:09:19.680 --> 01:09:21.680]  каждой из этих линий.
[01:09:21.680 --> 01:09:23.680]  То есть,
[01:09:23.680 --> 01:09:25.680]  вот это,
[01:09:25.680 --> 01:09:27.680]  вот это
[01:09:27.680 --> 01:09:29.680]  и
[01:09:29.680 --> 01:09:31.680]  вот это.
[01:09:31.680 --> 01:09:33.680]  Это все.
[01:09:33.680 --> 01:09:35.680]  Так, нужно еще один цвет.
[01:09:37.680 --> 01:09:39.680]  Вот так.
[01:09:39.680 --> 01:09:41.680]  Это все разные методы.
[01:09:43.680 --> 01:09:45.680]  Возможные.
[01:09:45.680 --> 01:09:47.680]  Или невозможные. Не знаю пока.
[01:09:51.680 --> 01:09:53.680]  Так, понятна гипотеза?
[01:09:53.680 --> 01:09:55.680]  Дайте по кусочкам двигаться.
[01:09:55.680 --> 01:09:57.680]  Да.
[01:09:57.680 --> 01:09:59.680]  Да, хорошо. Значит, что предлагается
[01:09:59.680 --> 01:10:01.680]  сделать? Давайте теперь найдем
[01:10:01.680 --> 01:10:03.680]  некоторую функцию.
[01:10:03.680 --> 01:10:05.680]  Пусть существует некоторая функция
[01:10:05.680 --> 01:10:07.680]  там G со звездочкой,
[01:10:07.680 --> 01:10:09.680]  которая лежит в нашем классе.
[01:10:11.680 --> 01:10:13.680]  Вот. И для этой функции
[01:10:13.680 --> 01:10:15.680]  мы получим, что
[01:10:15.680 --> 01:10:17.680]  вот на этом же графике, который я, видимо,
[01:10:17.680 --> 01:10:19.680]  заново перепишу...
[01:10:23.680 --> 01:10:25.680]  А, давайте не заново. Давайте просто
[01:10:25.680 --> 01:10:27.680]  еще один цвет
[01:10:27.680 --> 01:10:29.680]  какой-нибудь. Давайте вот такой.
[01:10:29.680 --> 01:10:31.680]  Вот для этой функции.
[01:10:31.680 --> 01:10:33.680]  Сейчас ее надо как-нибудь... Вот пусть она будет
[01:10:33.680 --> 01:10:35.680]  вот такой вот.
[01:10:35.680 --> 01:10:37.680]  Да. Вот для нее вот этот
[01:10:37.680 --> 01:10:39.680]  цвет.
[01:10:39.680 --> 01:10:41.680]  Там как-то можно
[01:10:41.680 --> 01:10:43.680]  красиво его заштриховать,
[01:10:43.680 --> 01:10:45.680]  но я не умею.
[01:10:45.680 --> 01:10:47.680]  Ладно.
[01:10:47.680 --> 01:10:49.680]  Вот.
[01:10:49.680 --> 01:10:51.680]  Для этой функции мы знаем, что
[01:10:51.680 --> 01:10:53.680]  оценка снизу имеет вот такой вид.
[01:10:55.680 --> 01:10:57.680]  То есть,
[01:10:59.680 --> 01:11:01.680]  надо... То есть, еще раз.
[01:11:01.680 --> 01:11:03.680]  Мы зафиксировали функцию
[01:11:03.680 --> 01:11:05.680]  и взяли
[01:11:05.680 --> 01:11:07.680]  любой m
[01:11:07.680 --> 01:11:09.680]  из методов.
[01:11:09.680 --> 01:11:11.680]  И любой метод взяли.
[01:11:11.680 --> 01:11:13.680]  Вот. И показали, что
[01:11:13.680 --> 01:11:15.680]  все, что мы можем добиться, лежит только вот здесь.
[01:11:17.680 --> 01:11:19.680]  То есть, линии могут идти
[01:11:19.680 --> 01:11:21.680]  где-то выше. Быстрее
[01:11:21.680 --> 01:11:23.680]  нельзя.
[01:11:25.680 --> 01:11:27.680]  То есть, чтобы это показать, надо было
[01:11:27.680 --> 01:11:29.680]  ровно показать, что уже со звездочки там
[01:11:29.680 --> 01:11:31.680]  x, k-t-g,
[01:11:31.680 --> 01:11:33.680]  ой, звездочка
[01:11:33.680 --> 01:11:35.680]  плохое название тут, да, наверное.
[01:11:35.680 --> 01:11:37.680]  Давайте g с волной.
[01:11:39.680 --> 01:11:41.680]  Минус g со звездочки больше
[01:11:41.680 --> 01:11:43.680]  либо равно, блаблабла. Чего-то так.
[01:11:43.680 --> 01:11:45.680]  Для любого метода.
[01:11:45.680 --> 01:11:47.680]  Какой бы
[01:11:47.680 --> 01:11:49.680]  мы ни взяли из этого семейства.
[01:11:51.680 --> 01:11:53.680]  Стало ли
[01:11:53.680 --> 01:11:55.680]  полегче?
[01:11:55.680 --> 01:11:57.680]  В общем, да. Плюс непонятно,
[01:11:57.680 --> 01:11:59.680]  как вы эти оценки берете.
[01:11:59.680 --> 01:12:01.680]  Да, это
[01:12:01.680 --> 01:12:03.680]  хороший вопрос.
[01:12:05.680 --> 01:12:07.680]  Там просто
[01:12:07.680 --> 01:12:09.680]  эти функции строятся
[01:12:09.680 --> 01:12:11.680]  и показываются
[01:12:11.680 --> 01:12:13.680]  две страницы выкладок.
[01:12:13.680 --> 01:12:15.680]  Ну хорошо, давайте
[01:12:15.680 --> 01:12:17.680]  я в следующий раз, когда сейчас уже конец должен
[01:12:17.680 --> 01:12:19.680]  пройти лекции, попробую
[01:12:19.680 --> 01:12:21.680]  вкратце хотя бы объяснить, откуда они берутся
[01:12:21.680 --> 01:12:23.680]  и каким образом строятся эти самые оценки.
[01:12:23.680 --> 01:12:25.680]  Возможно, тогда
[01:12:25.680 --> 01:12:27.680]  сейчас есть вопрос, то надо его обязательно
[01:12:27.680 --> 01:12:29.680]  удовлетворить.
[01:12:29.680 --> 01:12:31.680]  Про то, почему вот этот знак
[01:12:31.680 --> 01:12:33.680]  начинает работать.
[01:12:33.680 --> 01:12:35.680]  Почему больше либо равно, почему не меньше.
[01:12:35.680 --> 01:12:37.680]  Значит,
[01:12:37.680 --> 01:12:39.680]  в итоге мы имеем
[01:12:39.680 --> 01:12:41.680]  пока что
[01:12:41.680 --> 01:12:43.680]  умозрительные некоторые величины.
[01:12:43.680 --> 01:12:45.680]  1 на k квадрат и
[01:12:45.680 --> 01:12:47.680]  линейную сходимость вида
[01:12:47.680 --> 01:12:49.680]  с коэффициентом, в котором
[01:12:49.680 --> 01:12:51.680]  входит корень искапа.
[01:12:51.680 --> 01:12:53.680]  И в следующий раз мы, во-первых,
[01:12:53.680 --> 01:12:55.680]  начнем с того, что посмотрим, собственно, откуда
[01:12:55.680 --> 01:12:57.680]  это взялось.
[01:12:57.680 --> 01:12:59.680]  На самом деле, самое
[01:12:59.680 --> 01:13:01.680]  неприятное вот здесь,
[01:13:01.680 --> 01:13:03.680]  а вот получить вот это уже не так сложно
[01:13:03.680 --> 01:13:05.680]  из вот этого. Там они плюс-минус
[01:13:05.680 --> 01:13:07.680]  похожи функции.
[01:13:07.680 --> 01:13:09.680]  И предъявим методы, которые
[01:13:09.680 --> 01:13:11.680]  эти нижние оценки достигают.
[01:13:11.680 --> 01:13:13.680]  После чего мы скажем, окей, вот методы,
[01:13:13.680 --> 01:13:15.680]  которые в теории, согласно
[01:13:15.680 --> 01:13:17.680]  теорооценкам, быстрее них сходиться
[01:13:17.680 --> 01:13:19.680]  нельзя на данном классе задач.
[01:13:19.680 --> 01:13:21.680]  Это метод спрошен ингредиентов
[01:13:21.680 --> 01:13:23.680]  с кратичной положительно определенной матрицы.
[01:13:23.680 --> 01:13:25.680]  Метод тяжелого шарика
[01:13:25.680 --> 01:13:27.680]  для сильного пылы функции,
[01:13:27.680 --> 01:13:29.680]  и, собственно, градиентный метод кестерова, который
[01:13:29.680 --> 01:13:31.680]  для призвольного пылы функции достигает
[01:13:31.680 --> 01:13:33.680]  вот этой оценки.
[01:13:33.680 --> 01:13:35.680]  Вот это план на следующий раз, плюс
[01:13:35.680 --> 01:13:37.680]  то, что я сказал про вывод.
[01:13:37.680 --> 01:13:39.680]  В итоге
[01:13:39.680 --> 01:13:41.680]  19.09, идеальный тайминг.
[01:13:41.680 --> 01:13:43.680]  Мы сегодня
[01:13:43.680 --> 01:13:45.680]  обсудили скорость сходимости,
[01:13:45.680 --> 01:13:47.680]  градиентный спуск, его
[01:13:47.680 --> 01:13:49.680]  свойства и сходимость.
[01:13:49.680 --> 01:13:51.680]  Немножко начали обсуждать нижние оценки
[01:13:51.680 --> 01:13:53.680]  и то, какой вывод
[01:13:53.680 --> 01:13:55.680]  и какой посыл
[01:13:55.680 --> 01:13:57.680]  они могут, они несут
[01:13:57.680 --> 01:13:59.680]  и какой профит могут дать
[01:13:59.680 --> 01:14:01.680]  для
[01:14:01.680 --> 01:14:03.680]  анализа и сравнения метод.
[01:14:03.680 --> 01:14:05.680]  Есть еще какие-то вопросы, кроме того,
[01:14:05.680 --> 01:14:07.680]  откуда взялись вот эти
[01:14:07.680 --> 01:14:09.680]  вот странные штуки.
[01:14:09.680 --> 01:14:11.680]  Про него поговорим в следующий раз.
[01:14:13.680 --> 01:14:15.680]  Так, ну, тишина.
[01:14:15.680 --> 01:14:17.680]  Надеюсь, что всем все понятно.
[01:14:17.680 --> 01:14:19.680]  Давайте закончим.
[01:14:19.680 --> 01:14:21.680]  И в следующий раз, видимо, снова будет все в зуме,
[01:14:21.680 --> 01:14:23.680]  я так понимаю.
[01:14:23.680 --> 01:14:25.680]  На более-менее постоянном режиме.
[01:14:25.680 --> 01:14:27.680]  Так что ссылку я пришлю,
[01:14:27.680 --> 01:14:29.680]  как обычно.
[01:14:29.680 --> 01:14:31.680]  Надеюсь, что
[01:14:31.680 --> 01:14:33.680]  пояснение про вывод
[01:14:33.680 --> 01:14:35.680]  этих оценок будет
[01:14:35.680 --> 01:14:37.680]  данным.
[01:14:37.680 --> 01:14:39.680]  Все тогда. Спасибо за внимание.
[01:14:39.680 --> 01:14:41.680]  До следующего раза.
[01:14:41.680 --> 01:14:43.680]  Ссылочку на видео я, наверное,
[01:14:43.680 --> 01:14:45.680]  пришлю заинтересованным.
[01:14:45.680 --> 01:14:47.680]  Уже спрашиваю про запись.
[01:14:47.680 --> 01:14:49.680]  Я выложен, наверное, просто в чат.
[01:14:49.680 --> 01:14:51.680]  И
[01:14:51.680 --> 01:14:53.680]  будет возможность у ваших
[01:14:53.680 --> 01:14:55.680]  коллег посмотреть.
[01:14:55.680 --> 01:14:57.680]  Все. Все спасибо.
[01:14:57.680 --> 01:14:59.680]  И до следующего раза. До свидания.
