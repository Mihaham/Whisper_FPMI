[00:00.000 --> 00:13.960]  ...в момент времени, но не его прошло. Вот. И Марковские процессы, мы с вами выяснили,
[00:13.960 --> 00:20.960]  они могут быть классифицированы по тому, каково пространство состояния и времени,
[00:20.960 --> 00:25.920]  ну, дискретно или непрерывно. Четыре ситуации у нас, получается, да? И мы начали с простейшей
[00:25.920 --> 00:32.840]  из этих ситуаций, когда множество состояний и множество времени дискретное. Такие Марковские
[00:32.840 --> 00:42.320]  процессы мы называем дискретными цепями Маркова. Вот. И что мы дальше начали? Изучать дискретные
[00:42.320 --> 00:49.120]  цепи Маркова. Выяснили, что конечномерные распределения полностью определяются двумя вещами,
[00:49.480 --> 00:57.680]  одномерными распределениями и вероятностями переходов. Вот. Построили там некую самую-самую
[00:57.680 --> 01:07.560]  общую науку и затем мы поняли, что Марковские цепи удобно представлять в виде графов,
[01:07.560 --> 01:15.520]  когда вершины это состояние. Вот. А стрелочки между ними означают переходы между ними,
[01:16.040 --> 01:21.420]  а число над стрелочкой – это вероятность перехода. Ну. Так вот, в общем случае,
[01:21.420 --> 01:25.640]  вот эти вероятности перехода стрелочки, они могут зависеть от времени, от n. Ну, сегодня перейти,
[01:25.660 --> 01:33.020]  значит, из состояния ноль в состояние один, какая-то вероятность, завтра это другая вероятность. Вот
[01:33.020 --> 01:36.620]  если эта вероятность не зависит от времени, вероятность переходов от времени не зависит,
[01:36.620 --> 01:43.160]  то тогда, такая цепь называется однородной. И мы будем с вами изучать только однородные цепи
[01:43.160 --> 01:49.080]  цепи дальше, мы с вами выяснили, как происходит эволюция в однородной цепи Маркова, то есть
[01:49.080 --> 01:57.520]  распределение над состояниями в момент n выражается вот по такой формуле, связанной с распределением в
[01:57.520 --> 02:06.440]  предыдущем момент времени, вот по такой формуле, где P – это матрица переходов за один шаг. Она от
[02:06.440 --> 02:13.280]  времени не зависит для однородной цепи, внеоднородной она зависит, вообще говоря, от времени, а внеоднородной
[02:13.280 --> 02:18.760]  может зависеть, а в однородной она от времени от n не зависит, это просто какая-то матрица с числами,
[02:18.760 --> 02:30.400]  которые не меняются. Вот, и поведение вообще этой динамики P от n можно иногда в виде конечных
[02:30.400 --> 02:38.680]  формул выражать. Нас будет интересовать поведение P от n или, что равносильно, поведение матрицы
[02:38.680 --> 02:44.560]  вероятности перехода за n шагов, это есть P транспонированная в степени n. Нас будет
[02:44.560 --> 02:51.480]  интересовать их поведение асимпатическое при n стремящемся к бесконечности. И я сказал о том,
[02:51.480 --> 02:58.000]  что это поведение, оно может быть выражено в терминах собственных значений, собственных векторов
[02:58.000 --> 03:07.480]  матрицы P. И в принципе, этот подход имеет право на жизнь, он уже давал известные содержательные
[03:07.480 --> 03:14.600]  результаты такой науке, но гораздо нагляднее для нас будет пойти по другому пути, который я
[03:14.600 --> 03:21.680]  анонсировал в прошлый раз, это классификация состояний дискретной цепи Маркова. То есть,
[03:21.680 --> 03:28.800]  оказывается, мы можем классифицировать состояние и, посмотрев просто на цепь,
[03:28.800 --> 03:33.120]  сказать, что в ней будет происходить, ну по крайней мере качественно, по крайней мере качественно
[03:33.120 --> 03:37.920]  мы можем сказать, что в ней будет происходить. Вот сегодня на этой лекции мы с вами и займемся вот
[03:37.920 --> 03:47.760]  этой подготовкой к науке, значит, об симпатическом поведении цепей, займемся классификацией
[03:47.760 --> 03:59.400]  состояния. Итак, я вам напомню, что мы P, I, J, A, N обозначаем вероятность цепи попасть в
[03:59.400 --> 04:08.960]  N-тый момент времени в состояние J при условии, что мы вышли из I. Вот такая вероятность перехода.
[04:08.960 --> 04:16.880]  Цепь однородная, мы можем вот к этим индексам прибавлять одно и то же число,
[04:17.040 --> 04:22.080]  то есть N плюс один, здесь один, это будет та же самая вероятность, там N плюс два,
[04:22.080 --> 04:30.080]  здесь X2 равно I, это все будет одна и та же вероятность. Вот, ну мы будем вот условно от нуля начинать всегда.
[04:30.080 --> 04:42.760]  Мы будем говорить, что из состояния I следует, и будем обозначить это вот так вот, состояние J,
[04:42.760 --> 04:53.960]  если существует N больше либо равный один, такой, что P, I, J от N больше нуля, то есть если есть
[04:53.960 --> 05:01.400]  не нулевая вероятность попасть из I в J, то тогда мы будем говорить, что из I следует J. Ну из I
[05:01.400 --> 05:07.720]  может быть много куда следует, потому что из I может быть много куда можно попасть, ну во все такие
[05:07.720 --> 05:14.440]  состоянии из I мы попадем, следует. Вот, значит из I следует J, значит в общих цепях не обязательно
[05:14.440 --> 05:20.280]  из I следует I. Вообще давайте мы вот такой пример нарисуем, очень-очень хороший, вот такой вот
[05:20.280 --> 05:29.200]  примерчик нарисуем, два, три, так, так, так и как-нибудь знаете, вот так вот, не важно какие там
[05:29.200 --> 05:33.880]  вероятности, ну здесь вот единица обязательно, там здесь единица, здесь единица, здесь какие-нибудь
[05:34.800 --> 05:40.320]  но не важно. Вот такую вот марковскую цепь рассмотрим, с такими вот состояниями, такими переходами,
[05:40.320 --> 05:52.240]  тогда смотрите, из 0 следует 1, из 0 следует 2, из 0 следует 3, так, из 1 следует 2, из 1 следует 3,
[05:52.240 --> 05:59.400]  но из 1 не следует 0, понятно? Интуитина понятно, да? Ну и формально интуитина, все здесь понятно.
[05:59.400 --> 06:06.800]  Вот, но, например, из 0 не следует 0, мы из 0 можем попасть в 1, из 1 никак не попадем в 0,
[06:06.800 --> 06:15.720]  все, значит из 0 не следует 0, вот, значит не обязательно, что из I следует I, не обязательно,
[06:15.720 --> 06:22.200]  что если из I следует J, то из J следует I, да, вот опять же пример, пример это показывает как раз,
[06:22.200 --> 06:34.000]  кстати, здесь вот из 2 следует 2, из 1 следует 1, из 3 следует 3, понятно? Вот, так, ну хорошо,
[06:34.000 --> 06:41.560]  но, кстати говоря, если из I следует J, а из J следует K, то обязательно из I следует K, то есть
[06:41.560 --> 06:47.200]  транзитивность, нет рефлексивности, симметричности, но есть транзитивность,
[06:47.200 --> 07:02.640]  из I следует J, из J следует K, влечет и следует K, вот, хорошо, теперь рассмотрим, мы будем говорить,
[07:02.640 --> 07:12.800]  что состояние I и J сообщаются, если из I следует J, из J следует I, то есть I и J сообщаются,
[07:12.800 --> 07:24.720]  если I следует J, и J следует I, давайте мы это в кванторах распишем, то есть, это важно для
[07:24.720 --> 07:34.800]  понимания, то есть, существует N больше либо равный 1, такое, что P из I, J от N больше 0,
[07:34.800 --> 07:47.960]  и существует M, оно может отличаться от вот этого N, такое, что P J I от M больше 0, вот,
[07:47.960 --> 07:54.480]  что означает, что они сообщаются, то есть, это N, которое существует здесь и здесь, они могут быть
[07:54.480 --> 08:02.600]  разными, но они существуют, так, вот это сообщаемость, значит, на этой картинке кто? 0 с 1 не сообщаются,
[08:02.760 --> 08:10.840]  из 0 в 1, но из 1 в 0 нет, так, 1 с 2 сообщаются, мы можем из 1 попасть в 2, из 2 попасть в 1,
[08:10.840 --> 08:18.200]  вот, по такому пути длинному, вот, значит, 0 ни с кем не сообщается, а эти все друг с другом
[08:18.200 --> 08:26.840]  сообщаются, так, значит, вот это отношение сообщаемости мы будем обозначать вот так,
[08:26.840 --> 08:33.400]  ну, логично, да, такое обозначение вести, это соотношение не обязательно рефлексивно,
[08:33.400 --> 08:38.960]  то есть, не обязательно I сообщается с I, вот, например, для нуля это не так, хотя для всех вот этих
[08:38.960 --> 08:46.960]  это так, но смотрите, что интересно, ну, транзитивность у нас сохраняется, но появляется
[08:46.960 --> 09:00.040]  также, что если I сообщается с J, то J сообщается с I, вот, если I сообщается с J, то тоже самое,
[09:00.040 --> 09:07.680]  что J сообщается с I, вот, так что есть симметрия, нет рефлексии, и сообщаемости есть транзитивность,
[09:07.680 --> 09:15.440]  так вот, зачем это надо? Вот это отношение сообщаемости, оно делит все состояния на классы,
[09:15.440 --> 09:25.800]  классы сообщающихся состояний, можно в цепях выделять классы в состоянии, которые можно выделять
[09:25.800 --> 09:32.400]  классы состояния, которые друг с другом сообщаются, все-таки множество состоянии, которые друг с другом
[09:32.400 --> 09:39.860]  сообщаются, мы будем называть классами, то есть класс для нас, такое зарезервированное слово, это
[09:39.860 --> 09:47.220]  именно множество сообщающихся состояний. Вот один, два, три. Это здесь все они
[09:47.220 --> 09:57.420]  сообщаются. Значит, они образуют класс. Вот он, класс сообщающихся состояний. Вот
[09:57.420 --> 10:02.020]  это не принадлежит классу сообщающихся состояний. Он принадлежит, можно просто
[10:02.020 --> 10:10.900]  говорить, множество несообщающихся состояний. Это класс сообщающихся состояний.
[10:10.900 --> 10:21.220]  Окей, дальше едем. Ведем новое определение. Еще одно. Существенности.
[10:21.380 --> 10:44.500]  Определение состояния И назовем существенным, если оно сообщается со всеми состояниями,
[10:44.500 --> 10:55.300]  которые из него следуют. Если сообщается со всеми состояниями, которые из него следуют.
[10:55.300 --> 11:11.780]  И несущественное, если это не выполнено. На данном примере ноль. Это несущественное
[11:12.340 --> 11:15.780]  состояние. Потому что нашлось состояние, которое из него следует,
[11:15.780 --> 11:23.060]  но обратной стрелочки нет. Из ноль следует один, но из один не следует ноль. Ноль не существенное
[11:23.060 --> 11:33.920]  состояние. Здесь из 1 следует 2, ну и из 2 следует 1. 1 существенное состояние,
[11:33.920 --> 11:42.160]  существенное. Существенное. Из 2, а нет, смотрите, из 1 следует 2, из 2 следует 1,
[11:42.160 --> 11:48.000]  и из 1 следует 3, из 3 следует 1. 1 сообщается со всеми, кто из него следует,
[11:48.000 --> 11:52.200]  поэтому он существенный. Когда мы существенность показываем, мы должны все
[11:52.200 --> 11:58.760]  следствие посмотреть. 2, из 2 следует 3, 3 следует 2, из 2 следует 1, из 1 следует 2.
[11:58.760 --> 12:06.220]  Все, 2 тоже существенное. Тоже самое 3, из 3 следует 1, из 1 следует 3, из 3 следует 2,
[12:06.220 --> 12:10.960]  из 2 следует 3. Все, он сообщается со всеми, кто из него следует. По определению,
[12:11.040 --> 12:16.240]  существенное состояние. Вот так мы немножечко проклассифицировали.
[12:16.240 --> 12:32.280]  Хорошо, теперь сразу же можно будет доказать арему, что из существенного состояния может
[12:32.280 --> 12:51.560]  следовать только существенное. Может следовать только существенное.
[12:51.560 --> 13:08.360]  Доказательство очень простое. Значит, пусть из И следует Ж и И существенное. Мы должны что
[13:08.360 --> 13:12.880]  проверить? Что Ж тоже существенное, так? Что из существенного следует только существенное.
[13:12.880 --> 13:19.720]  Вот, докажем, что Ж существенное. Ну, у нас все, что есть, это определение,
[13:19.720 --> 13:26.440]  поэтому что-то делать. Мы берем, пусть К такое, что из Ж следует К. Если мы хотим доказать
[13:26.440 --> 13:34.000]  существенность, мы должны доказать, что из К следует Ж. Вот, пусть какое-то есть К, что из Ж
[13:34.000 --> 13:40.240]  следует К. Ну, К может в принципе совпадать с Ж. Мы обязательно куда-то должны уйти. Либо мы
[13:40.240 --> 13:44.680]  оставимся на месте, либо мы куда-то уходим. Здесь К в принципе может совпадать с Ж. Просто К какое-то
[13:44.680 --> 13:51.520]  состояние такое, что из Ж следует К. Вот, такое всегда есть. По крайней мере, совпадающие Ж. Вот,
[13:51.520 --> 14:00.640]  если никакого другого отличного Ж нет. Итак, пусть К вот такое. Значит, из И следует Ж и из Ж следует К.
[14:00.640 --> 14:11.680]  Значит, из И следует К. Вот, следовательно, из И следует К по транзитивности. Но И существенное
[14:11.680 --> 14:27.840]  значит из К следует И. Потому что существенные состояния, они сообщаются с теми, кто из них
[14:27.840 --> 14:41.760]  следует. Из К следует из И. Значит, они обязаны сообщаться. Ну вот, из К следует И. Но из И следует Ж.
[14:41.760 --> 14:54.120]  Получается, что из К следует Ж. Мы взяли и К, такой, что К следует, влечет Ж. И мы доказали,
[14:54.120 --> 15:07.080]  что из К следует Ж. Все, конец. Вот все доказательства. Значит, из существенного может следовать только
[15:07.080 --> 15:11.760]  существенное. Значит, если мы посмотрим на эту картинку, то мы что понимаем? Что эти
[15:11.760 --> 15:16.920]  состояния сообщаются, что это существенное. Значит, тот, кто из него следует, обязательно
[15:16.920 --> 15:22.480]  существенен. Можем даже ничего больше не проверять. Два следует из один, один существенный. Отлично,
[15:22.520 --> 15:27.720]  значит два существенные. И так далее. Вот. Пользоваться этой теоремы же очень легко. Ну,
[15:27.720 --> 15:40.440]  она в принципе легко выводится. Вот. И вот этот факт мы простой получаем. Так, хорошо. Значит,
[15:40.440 --> 15:47.200]  из этой теоремы сразу следует, что существенность – это свойство класса. То есть, если вы
[15:47.800 --> 15:58.720]  выбираете класс состояний, сообщающихся между собой, и там нашелся кто-то один существенный,
[15:58.720 --> 16:08.680]  то все остальные мгновенно существенные, потому что они с ним сообщаются. Итак, еще раз. Вы,
[16:08.680 --> 16:16.680]  если выделили множество сообщающихся состояний и среди них кто-то оказался существенным,
[16:16.680 --> 16:23.440]  то все остальные мгновенно существенные, потому что из существенных может следовать только
[16:23.440 --> 16:29.800]  существенное. А они все сообщаются, они все друг из друга следуют. Вот. То есть, существенность –
[16:29.800 --> 16:35.560]  это свойство класса. Один существенный – все существенные. Хоть их тут бесконечное множество.
[16:35.560 --> 16:42.320]  Если вы нашли одно состояние, про которое легко доказать, что оно существенное, а это вообще легко,
[16:43.120 --> 16:49.720]  вообще определение тривиальное, то мгновенно все остальные существенные. Вот. Вот это очень
[16:49.720 --> 16:56.400]  здоровское свойство. И дальше мы ведем другие понятия, другие типы состояний, которые тоже
[16:56.400 --> 17:02.000]  являются свойствами класса. Доказали что-то про одного – это мгновенно распространяется на все
[17:02.000 --> 17:09.880]  остальные. Вот почему это свойство сообщаемости важно. Значит, в цепях все множество состояний
[17:09.880 --> 17:29.320]  можно представить как объединение множества несущественных состояний и объединение классов
[17:29.320 --> 17:45.520]  существенных состояний. S1, S2 и так далее, которых может быть счетно. Классы – это означает,
[17:45.520 --> 17:52.680]  что это множество сообщающихся состояний. При этом вот эти множества не пересекаются.
[17:52.680 --> 18:04.360]  То есть S1, S2 не поустану и так далее. Это всегда можно сделать. Вот. И единственное,
[18:04.360 --> 18:13.680]  что классов таких может быть счетная, если цепь счетная. И состояний в этих классах тоже может
[18:13.680 --> 18:19.280]  быть счетная, если цепь счетная. То есть всякое тут возможно. Если цепь конечна, то и конечно ни о
[18:19.280 --> 18:28.360]  какой счетности нет. Если цепь конечна, то тогда таких вот классов их конечное число, то есть множество
[18:28.360 --> 18:35.200]  несущественных состояний, оно из конечного числа элементов стоит. Число таких классов конечное,
[18:35.200 --> 18:43.440]  и число элементов в каждой в этом классе тоже конечное. И самое главное здесь то, что изучать
[18:43.440 --> 18:52.120]  поведение всей цепи можно, изучив отдельно, что происходит здесь и что происходит в каждом классе.
[18:52.120 --> 19:06.760]  Вот. В каждом классе существенных состояний. Да. Ой, пусто, пусто, да-да, спасибо. Равно пусто, да.
[19:06.760 --> 19:21.680]  Равно пусто. Вот. Так что изучение поведения всей цепи можно свести к изучению поведения того,
[19:21.680 --> 19:26.680]  что происходит в множестве несущественных состояний. Как распределение меняется здесь и там. Ну,
[19:26.680 --> 19:32.520]  сейчас это утверждение, оно может быть пока не очевидным на самом деле, но потом вы увидите,
[19:32.520 --> 19:38.200]  что действительно так. А сейчас просто я как бы общий скетч даю на будущее. Зачем мы все это
[19:38.200 --> 19:45.960]  делаем? Мы вели понятие сообщаемых состояний, вели существенность, поняли, что существенность это
[19:45.960 --> 19:51.840]  свойство классов и поняли, что можно всю цепь разделить вот на такие вот множества классов.
[19:51.840 --> 20:01.160]  И теперь мы свое внимание устремим к изучению этих классов и построим по ним уже науку для всей цепи.
[20:01.160 --> 20:11.640]  Так. Ну, тут еще одно есть определение, значит, если в цепи Маркова все состояния
[20:11.640 --> 20:22.760]  сообщаются, такая цепь называется неразложимой. Давайте еще так напишем, что если в цепи все
[20:22.760 --> 20:43.520]  состояния сообщаются, то она называется неразложимой. Внизу тяжело описать. Ну, или неприводимой.
[20:43.520 --> 21:03.040]  Вот. Неразложимой или неприводимой. Вот эта цепь не является неразложимой, она разложимая,
[21:03.040 --> 21:08.960]  потому что есть несущественное состояние. Не все состояния здесь сообщаются друг с другом,
[21:08.960 --> 21:18.880]  ноль не сообщается с единицей. Вот. Но обратите внимание, что вот это подцепь. Из нее нет выхода
[21:18.880 --> 21:26.800]  сюда, она как бы замкнута получается. Это подцепь неразложимая, 1, 2, 3 неразложимая. И так как мы
[21:26.800 --> 21:34.120]  любую цепь можем представить в виде объединения вот таких вот цепей неразложимых и множество
[21:34.120 --> 21:39.600]  несущественных состояний, то получается, что мы можем наше внимание устремить на изучение
[21:39.600 --> 21:44.960]  поведения сначала в неразложимых цепях. Потому что, например, какая могла бы быть еще ситуация? Вот
[21:44.960 --> 21:56.680]  такая, например. Значит там 4, 5, там скажем 6, 4. Вот. В такой цепи вот это множество несущественных
[21:56.920 --> 22:03.240]  состояний. Вот это один класс сообщающих состояний. Вот этот другой класс сообщающих состояний.
[22:03.240 --> 22:11.960]  Вот это наша S0. Вот это наша S1. Вот это наша S2. Если цепь попадает сюда, она никак не попадет туда
[22:11.960 --> 22:18.720]  и туда. Это как бы замкнутая подцепь в себе. Вот. Если цепь попалась сюда, она никак отсюда не
[22:18.720 --> 22:24.840]  выберется. Вот. Так что изучать всю цепь. Изучим. Мы всю цепь изучим, если мы поймем,
[22:24.840 --> 22:34.160]  как происходит перехода отсюда и что происходит в неразложимых цепях. Вот так. Так, ну хорошо,
[22:34.160 --> 22:41.600]  движемся дальше. Ведем еще полезные понятия, которые нам дальше пригодятся. Еще одну вероятность
[22:41.600 --> 22:59.920]  ведем. Которая похожа на p и t житая, но хитрее. Вот такую вероятность ведем. f и t житая от n равняется
[22:59.920 --> 23:16.800]  p того, что xn равно j, но xn-1 не равно j. xn-2 не равно j. И вообще они никакие до этого не равны
[23:16.800 --> 23:28.480]  j, а в начальном момент равно i. То есть это вероятность первого попадания в j на n-ом шаге.
[23:28.480 --> 23:38.200]  Видите, мы вышли с i, но вычисляем вероятность, что на 1, 2 и так далее до n-1 шага мы не в j,
[23:38.200 --> 23:45.720]  а вот именно на n-ом шаге мы в j. Вот такую вероятность ведем. Значит, если i равно j,
[23:45.720 --> 23:59.640]  f и t и t от n, мы введем вот такое обозначение. Вот. И введем также еще f и t. Это сумма по n
[23:59.640 --> 24:11.760]  равном от единицы. Значит, здесь n больше либо равно единице. Это вероятность первого
[24:11.760 --> 24:23.680]  возвращения из i в i за n шагов. Да. Значит, здесь вот так вот f и t и t от n. Что это такое? Это
[24:23.680 --> 24:30.560]  вероятность, то, что тут написано. Это вероятность вернуться из i в i за конечное число шагов.
[24:30.560 --> 24:54.840]  Здесь складывается вероятность вернуться за 1 шаг, плюс вероятность вернуться ровно за 2 шага,
[24:54.840 --> 25:01.720]  плюс вероятность вернуться ровно за 3 шага и так далее. В сумме это вероятность возвращения за
[25:01.720 --> 25:07.800]  конечное число шагов. Это может показаться, что здесь ряд какой-то там, но на самом деле это как
[25:07.800 --> 25:14.040]  сумма обычная, потому что вот эта вещь, она всегда меньше либо равна единице, потому что это вероятность.
[25:14.040 --> 25:27.200]  Это вероятность. Она всегда меньше либо равна единице. Вот. Хорошо. Вот такую вот f ведем. Значит,
[25:27.200 --> 25:32.560]  f и p это разные вещи. Сейчас мы установим с вами связь между ними.
[25:44.800 --> 26:00.960]  Значит, вот у нас есть p и g от n. Они похожи, но это разные вещи, потому что, смотрите, вот эта вещь,
[26:00.960 --> 26:10.440]  это вероятность попасть из i в g за n шагов. При этом на пути из i в g за n шагов мы в какие-то
[26:10.440 --> 26:16.760]  моменты можем проходить через g. Нам главное в конце быть в g. На промежуточных шагах мы тоже
[26:16.760 --> 26:23.680]  можем быть в g. Здесь это запрещено. Здесь только в n-й момент времени мы в g. Поэтому очевидно,
[26:23.680 --> 26:35.560]  что p и g от n больше либо равна, чем f и g от n. Но сейчас мы установим формулу полную, через
[26:35.560 --> 26:43.360]  равенство. Значит, как мы это сделаем? Ну, давайте мы возьмем p и g от n и попробуем выразить эту
[26:43.360 --> 26:54.560]  p и g в терминах f и g. Это есть вероятность того, что xn равняется g при условии, что x0 равно i. Вот.
[26:54.560 --> 27:08.200]  Что это такое? Смотрите, как мы поступим. Либо мы в первый момент были в g,
[27:08.200 --> 27:22.720]  либо мы во второй момент попали в g, но в первый не были в g. Не пересекающее событие,
[27:22.720 --> 27:30.160]  поэтому мы складываем вероятности. Давайте еще напишу дальше. Либо мы в третий момент в g,
[27:30.160 --> 27:49.000]  но x2 не в g, x1 не в g и так далее. xn равно g. Доберемся до xn равно g. Я специально здесь это оставлю,
[27:49.000 --> 28:00.280]  мне потом будет так удобнее. Но xn-1 не равно g, x1 не равно g, x0 равно i. Вот разложил по
[28:00.280 --> 28:06.320]  системе, по полной системе событий. Это не формула полной вероятности, это просто как бы вероятность
[28:06.320 --> 28:16.280]  объединения не пересекающихся множеств равна сумме вероятностей, а внутри стоят не пересекающиеся.
[28:16.280 --> 28:25.640]  Множество, которые полностью покрывают событие xn равно g. Не все пространства,
[28:25.640 --> 28:40.200]  но xn равно g, по крайней мере, покрывают. Хорошо, едем дальше. Что мы сделаем? Теперь я хочу записать
[28:40.200 --> 28:45.280]  формулу условной вероятности для всех этих вероятностей, а именно посчитать вероятность того,
[28:45.280 --> 28:56.960]  что xn равно g, а все остальное загнать под вот эту черту. Вот здесь? Я говорю, я специально так
[28:56.960 --> 29:03.640]  сделал. Да, его можно убрать, но я хочу его загнать туда, под черту тоже, поэтому я его здесь написал,
[29:03.640 --> 29:11.080]  а тогда его можно не писать, но чисто визуально оно мне сейчас пригодится. Значит первое слагаемое,
[29:11.080 --> 29:22.960]  xn равно g при условии, что x1 равно g, x0 равно i умножить на вероятность того, что x1 равно g при
[29:22.960 --> 29:33.040]  условии, что x0 равно i, плюс вероятность, давайте я все не буду писать, вот вторую напишу, xn равно g при
[29:33.040 --> 29:48.480]  условии, что x2 равно g, x1 не равно g, x0 равно i умножить на вероятность того, что x2 равно g,
[29:48.480 --> 29:57.240]  x1 не равно g при условии, что x0 равно i, плюс и так далее, и последнюю давайте напишем,
[29:57.240 --> 30:12.720]  последнюю напишем вероятность xn равно g при условии, что xn равно g, xn-1 не равно g и так далее,
[30:12.720 --> 30:24.080]  x1 не равно g, x0 равно i на вероятность того, что xn равно g, xn-1 не равно g, ну и так далее,
[30:24.080 --> 30:33.160]  все они не равны g, а x0 равно i, вот это просто формула условной вероятности или полной, а ну можно
[30:33.160 --> 30:40.200]  и полной, ну да, либо так, либо так, пусть будет формула полной вероятности допустим, но цепь-то
[30:40.200 --> 30:46.760]  Марковская, поэтому смотрите, мы оставляем здесь в условии только момент времени ближайшей к n,
[30:46.760 --> 30:56.320]  это для нас прошлое, выкидываем, здесь это все прошлое, вот это оставляем, там ничего не можем
[30:56.320 --> 31:02.760]  пока выкинуть, мы выкидываем только из условных вероятностей, вот это все прошлое, выкидываем,
[31:02.760 --> 31:11.640]  и что получается, смотрите, вероятность попасть из g в g от первого момента к n-тому моменту,
[31:11.640 --> 31:20.280]  что это такое, это есть p gt gt от n-1, помните, я в самом начале говорил, что мы можем вот эти
[31:20.280 --> 31:25.240]  индексы как угодно на одну и ту же величину поднимать и пускать, давайте на минус единичку
[31:25.240 --> 31:38.800]  увеличим, ну или уменьшим на единичку, n-1-0, p gt gt и n-1, вот, это есть что такое, ну это кстати равно,
[31:38.800 --> 31:56.760]  получается f it gt от единицы, плюс здесь что у нас, p gt gt от n-2, и умножается на что,
[31:56.760 --> 32:05.880]  вот вспоминаем формулу для f, это ровно формула f it gt от 2, ну и так далее,
[32:05.880 --> 32:16.080]  теперь видите зачем я сохранил 2xn равняется g, вот она, вот она, чтобы увидеть формулу для f
[32:16.080 --> 32:26.760]  it gt, значит здесь у нас n, n, это что такое, это p gt gt от 0, ну можно на единицу заменить в принципе,
[32:26.760 --> 32:41.080]  и умножаем на f it gt от n, вот, ну давайте запишем уже в замкнутой какой-то форме всю эту формулу,
[32:41.080 --> 32:58.920]  что мы получили, итак, p it gt от n, это сумма по k от единицы до n,
[32:58.920 --> 33:20.320]  значит, ну давайте так, f it gt от k на p gt gt n-k, это для n больше либо равных единиц только,
[33:20.320 --> 33:31.080]  справедливо, вот какая формула, для любых и g, в том числе равных между собой, но n больше
[33:31.080 --> 33:42.600]  либо равных единиц, вот, вот такая формула, она нам пригодится сейчас, ну в принципе даже
[33:42.600 --> 33:48.280]  интуитивно, понятно, смотрите, попасть язык в g за n шагов с учетом того, что ты промежуточно
[33:48.280 --> 33:54.960]  можешь проходить через g, это что такое, это вероятность попасть из i в g за один шаг без
[33:54.960 --> 34:00.080]  дополнительных проходов и умноженная вероятность из g в g на n-1 шаг и дальше хоть трава не расти,
[34:00.080 --> 34:05.240]  хоть там пересекать, хоть не пересекать, плюс вероятность попасть из i в g ровно за два шага,
[34:05.240 --> 34:10.800]  а потом из g в g за оставшееся число шагов и там тоже как угодно, ну и так далее, то есть интуитивно
[34:10.800 --> 34:17.960]  тоже формула, и так можно и понять, но вот это вот это строго доказательство, хорошо, теперь
[34:17.960 --> 34:26.520]  ведем еще одно определение, вот я ввел там f и t как сумму f и t от n, значит f и t равно 1 до
[34:26.520 --> 34:36.520]  бесконечности, значит это вероятность вероятность вернуться из i в i за конечное число шагов, значит
[34:36.520 --> 34:43.720]  я сказал, что это не превосходит единице, значит если f и t равно единице, то тогда и называется
[34:43.720 --> 34:57.720]  возвратным состоянием, если f и строго меньше единицы, то оно называется невозвратное состояние,
[34:57.720 --> 35:14.640]  ну оно же f и t просто, я там их не различаю, f и t равняется f и t. То есть что такое возвратное
[35:14.640 --> 35:21.120]  состояние? Стояние возвратно, если вероятность возвращения в него за конечное число шагов
[35:21.120 --> 35:29.000]  равно 1, вот в этом определении много всего на самом деле, это не просто вероятность вернуться,
[35:29.000 --> 35:37.360]  как вот многие себе представляют интуитивно, ну типа f и t от n, типа существует n, что f и t больше
[35:37.360 --> 35:48.160]  нет, возвратность она не про это, возвратность это вероятность, это когда вероятность вернуться
[35:48.160 --> 35:54.640]  за конечное число шагов, это важно, равна единице, это тоже важно, то есть два сразу момента,
[35:54.640 --> 36:02.080]  вероятность вернуться за конечное число шагов, это вероятность равна единице, вот, если меньше единицы,
[36:02.080 --> 36:14.680]  то это называется невозвратным. Ну я говорю, почему за конечное, что здесь суммируется, вероятность
[36:14.680 --> 36:20.440]  вернуться за один шаг, за два шага, за три шага и так далее, все это есть вероятность,
[36:20.440 --> 36:42.640]  он всегда сходится. Ну и что? Почему? Ну подождите, что это здесь значит? Здесь стоит
[36:42.840 --> 36:46.360]  вероятность того, что мы вернемся за конечное число шагов, то есть это вероятность объединения,
[36:46.360 --> 36:51.200]  если элемент принадлежит объединению, значит он принадлежит кому-то из этого объединения,
[36:51.200 --> 36:58.000]  правильно? Как вы можете что-то объединить и получить что-то, что не принадлежит множеству,
[36:58.000 --> 37:06.000]  которые вы объединяете. Вы чего? Ну вот, хорошо. И теперь критерии, критерии возвратности.
[37:06.000 --> 37:26.800]  Теорема.
[37:26.800 --> 37:46.240]  Ну это такой жаргон, но он как-то свободный владеем. И возвратно тогда и только тогда,
[37:46.240 --> 37:58.200]  когда сумма N равно от единицы до бесконечности P, это P, не F, а P, от N равно бесконечности. То есть
[37:58.200 --> 38:05.200]  если этот ряд расходится, если ряд разошелся, значит возвратная. Возвратная, значит ряд
[38:05.200 --> 38:14.960]  разошелся. Если ряд сошелся, не бесконечность, а число какое-то, то и невозвратная. Вот, вот
[38:15.320 --> 38:22.080]  то есть ты можешь как бы возвратность определять по определению, по тому, что вот эта сумма равна
[38:22.080 --> 38:27.840]  единице, либо потому, что вот эта сумма равна бесконечности. Смотря, что тебе удобно вычислять.
[38:27.840 --> 38:35.040]  Иногда вот это вычисляется мгновенно, но с этим большие проблемы. Иногда наоборот. Когда вы
[38:35.040 --> 38:40.640]  решаете задачу, вы должны помнить и об определении, и о критерии. Иногда это удобно, то неудобно,
[38:40.640 --> 38:49.400]  и наоборот. Всякие примеры можно построить. Значит, доказательства. Я начну с того, что,
[38:49.400 --> 38:58.900]  напомню еще раз эту формулу полезную, что, ну я ее запишу для i равно i. P i t i t от N равняется
[38:58.900 --> 39:14.660]  сумма k равным от единицы до N, f i t от k на P i t i t N-k. Мы ее доказали в общем случае,
[39:14.660 --> 39:21.700]  когда i и g произвольные. Ну вот здесь мы взяли, когда они равны. Ну нам же нужна какая-то связь
[39:21.700 --> 39:30.580]  между P и F, да, чтобы ответ какой-то получать. Значит, давайте мы ведем обозначения вспомогательные.
[39:30.580 --> 39:47.660]  Вот какие. Значит, за V N мы обозначим P i t i t от N, а за U, скажем, k мы обозначим f i t k. Ну и мы будем
[39:47.660 --> 39:58.380]  считать, что V 0 равняется единице, у 0 равняется нулю. Вот. Ведем вот такие обозначения. Тогда вот на это
[39:58.380 --> 40:09.740]  равенство можно посмотреть вот как. Смотрите, V N это есть сумма пука от единицы до N, от чего
[40:09.740 --> 40:30.740]  U kt на V N-k. Вот скажите мне, вам вот это ничего не напоминает? Во, вот он шарит. Вот-вот-вот-вот-вот.
[40:30.740 --> 40:37.580]  Вот про это все. Вот мы сейчас будем к этому всему сводить. Так, смотрите, ведем функции, ряды,
[40:37.580 --> 40:49.780]  вот такие. Значит, V z равно сумма k, или N у него, сейчас. А то вдруг важно. Не, не важно. k
[40:49.780 --> 40:59.300]  равно нулю до бесконечности V k z в степени k. И вот такую функцию ведем, не знаю где писать,
[40:59.300 --> 41:11.620]  давайте здесь. U z равна сумма k равно нулю до бесконечности U k z в степени k. Вот. Ну,
[41:11.620 --> 41:16.900]  пусть вас не пугают, что это ряды. На самом деле, если модуль z меньше единицы, а нас будет только
[41:16.900 --> 41:22.500]  такой случай интересовать, ряды сходятся, потому что эти штуки, они не отрицательные, от нуля до единицы.
[41:22.500 --> 41:28.660]  Ну, если вы сделаете z по модулю меньше единицы, то все сойдется, да? Тут все хорошо. Ряды сходятся,
[41:28.660 --> 41:34.380]  все хорошо. По модулю z меньше единицы. Вот этот ряд, кстати, он даже при модуле z равно единицы
[41:34.380 --> 41:39.740]  сходится, потому что это U, которые F. Мы знаем, что там на самом деле не ряд, да? Он как бы всегда
[41:39.740 --> 41:47.020]  сходится, по крайней мере к единице. Но тем не менее. Ведем вот такие функции z. И теперь давайте
[41:47.020 --> 41:54.660]  мы рассмотрим, что получается надо рассмотреть. U на V. Я вот здесь буду писать побольше места. Значит,
[41:54.660 --> 42:04.500]  у от z. Давайте мы умножим на V от z. Чем получим? Вот этот ряд умножится на этот ряд. Так? Суммы
[42:04.500 --> 42:15.540]  такие получаются. И как мы это себе представим? Мы закрупируем слагаемые перед z. Получится n,
[42:15.540 --> 42:24.220]  давайте так писать, от нуля на плюс бесконечности будет что-то умножаться на z в степени n. И как мы
[42:24.220 --> 42:33.100]  получим слагаемое, которое стоит перед z в степени n? Значит, это что такое будет? Это будет сумма
[42:33.100 --> 42:43.820]  k равная от нуля до n. Отсюда мы должны взять u-k, а оттуда мы должны взять как раз v-n-k. Потому что
[42:43.820 --> 42:49.660]  перед u-k будет стоять z в степени k, а перед этим будет стоять z в степени n-k. И когда умножатся,
[42:49.660 --> 42:56.500]  они дадут z в степени n. Вот. И здесь я суммирую все такие случаи, которые дают мне z в степени n.
[42:56.500 --> 43:05.660]  Вот. Для каждого из n. Вот. n меняется от нуля до плюс бесконечности. Вот так. Но тут очень такая
[43:05.660 --> 43:12.980]  хитрая вещь. Вот это не то же самое, что вот это. Потому что здесь мы начинаем k равно 0,
[43:12.980 --> 43:19.860]  здесь k равно 1. Поэтому давайте мы сначала с этим разберемся. Ну, вернее, это будет то же самое,
[43:19.860 --> 43:33.900]  но надо здесь аккуратно быть. Там не получится, потому что если ты начинаешь k равно 0 и n равно...
[43:33.900 --> 43:42.780]  Вот этот? Ну, можно, но там в другом будет проблема. Короче говоря, все подходы эквивалентные.
[43:42.780 --> 43:51.060]  Давайте мы не будем торопиться. Значит, допустим n равно 0. Значит, здесь будет n равно 0, будет u0 vn-0.
[43:51.060 --> 44:05.540]  Нет, 0-0, это 0. Вот. Плюс сумма n равно 1 до бесконечности. Вот. И здесь мы тоже выделим u0 vn плюс
[44:05.540 --> 44:15.140]  сумма k равно 1 до плюс бесконечности. uk vn-k. Вы знаете, мне эта теорема, это доказательство столько
[44:15.140 --> 44:25.740]  раз мозг выносило, что я вот дошел до ксиоматики практически. Чего? А, n. Поэтому я здесь расписываю
[44:25.740 --> 44:30.580]  очень подробно. Потому что поверьте мне, когда вы будете учить эту теорему, вы мне скажете спасибо,
[44:30.580 --> 44:37.980]  что я так все подробно расписал. Так, вот это будет 0. Это будет 0, потому что 0 равно 0. Значит,
[44:37.980 --> 44:50.260]  это есть сумма n равно от единицы до бесконечности, сумма k равно от единицы до n, uk vn-k. Вот. Теперь.
[44:50.260 --> 45:01.500]  Вот эта вещь. Это есть vn. Так? Значит, это будет сумма n равно от единицы до бесконечности vn z
[45:01.500 --> 45:14.700]  в степени n. Но это не то же самое, что v. Это есть v от z минус, когда n равно 0. То есть v0 на единицу,
[45:14.700 --> 45:34.300]  а v0 это единица равна. Минус 1. Вот. Чего? Чего не так? v0 равно единице. Вот. Ну, это p и t от нуля.
[45:34.300 --> 45:43.780]  Ну, вероятность, если расписать, получается, что вероятность условия, условия совпадают с тем,
[45:43.780 --> 45:50.740]  от чего мы считаем вероятность. Поэтому вероятность равна единице. Вот. Так что на самом деле у нас
[45:50.740 --> 46:02.620]  вот какая связь. Уz vz равняется vz-1. Так. И нам надо что-то отсюда выделить. Сейчас я вспомню,
[46:02.620 --> 46:11.820]  что. v. Давайте мы v выделим. Это очень сложно. Но v от z равно. Так. Это если мы перенесем туда,
[46:11.820 --> 46:20.780]  получится 1 минус o. Это туда значит 1 разделить на 1 минус o от z. Вот. Вот так связаны между собой v и u.
[46:20.780 --> 46:41.980]  Всё. Едем дальше. Измотана по тереме Абеля. Сумма окатых диакат и не отрицательная. Значит.
[46:41.980 --> 46:59.740]  Сейчас. Как там. Как это аккуратнее сформулировать-то. А, ну да. Сходится к А меньше либо равно
[46:59.740 --> 47:09.100]  бесконечности. Тогда и только тогда, когда предел при z, стремящемся к единице, с этой стороны,
[47:09.100 --> 47:19.380]  сумма окатых z в степени k. Ну, k равно от нуля, допустим, до бесконечности. Когда этот предел равен
[47:19.380 --> 47:28.220]  А. Вот. То есть, эта теорема говорит о том, что мы можем перейти к пределу по z к единице. И тогда
[47:28.220 --> 47:35.860]  мы получим ряд из окатых. Вот. Это теорема, которая устанавливает вот эту вот связь. Что мы можем
[47:35.860 --> 47:41.340]  перейти к пределу по z. То, что мы получим, это будет суммой окатых. То есть, что здесь никаких
[47:41.340 --> 47:46.500]  сюрпризов нет. Для этого достаточно, чтобы окаты были не отрицательными. Но у нас оно так и есть,
[47:46.500 --> 47:54.580]  потому что всё это ряды. Так. Вот это пока сотру. Вот этой теоремой мы сейчас и воспользуемся.
[47:54.580 --> 48:14.180]  Так. Воспользуемся этой теоремой. В какую нам сторону проще начать-то будет? Ну, смотрите,
[48:14.180 --> 48:25.340]  у от единицы. Что это такое? Это сумма окатых. То есть, сумма f. А это если f и t. То есть, пусть эта
[48:25.340 --> 48:39.380]  вещь равна единице. У от единицы равно 1. Тогда предел при z, стремящемся к единице, от v от z,
[48:39.380 --> 48:49.340]  будет равен пределу при z, стремящемся к единице слева. От 1 разделить на 1 минус у от z. Но у от z
[48:49.340 --> 48:56.260]  стремится к единице. Значит, это весь предел равен бесконечности. Вот. И по теореме Абеля мы
[48:56.260 --> 49:07.820]  получаем, что это означает, следовательно, по теореме Абеля, сумма. Вот это, когда мы вместо z
[49:07.820 --> 49:17.580]  подставили единицу, сумма в окатых. Она равна бесконечности. А вспоминаем, что такое окатая.
[49:17.580 --> 49:32.060]  Ну, от нуля тут начинать или от бесконечности неважно. Вот. Ну и наоборот можно. Только для этого
[49:32.060 --> 49:51.460]  придется выразить у от z. Значит, у от z это v от z минус 1. Разделить на v от z тоже получается.
[49:51.460 --> 49:57.460]  Значит, итак, если вот это, то вот это. То есть, из возвратности следует вот это. Видите, что мы
[49:57.460 --> 50:10.140]  получаем? Вот. Вот. То есть, возвратность влечет сумма равно бесконечности. Это то, что мы показали.
[50:10.140 --> 50:23.300]  Теперь наоборот. То есть, теперь допустим, что предел vz равен бесконечности. Но тогда здесь
[50:23.300 --> 50:32.420]  связь очень простая. Мы получаем, что предел при z, стремящемся к 1 минус 0 от u от z. То есть,
[50:32.420 --> 50:37.260]  можно поделить. Это 1 минус 1 делить на v от z. v от z стремится к бесконечности. Значит,
[50:37.260 --> 50:47.780]  все это стремится к единице. Вот. А это означает, что сумма у катых равна 1. То есть, что сумма
[50:47.780 --> 51:00.820]  f' к по к равна 1. Вот. Итак, мы предположили вот это. То есть, вот это мы предположили. И мы
[51:00.820 --> 51:06.500]  выявили отсюда, что f' большое равно единице. Ну все. То есть, мы связали просто вот эти ряды
[51:06.500 --> 51:10.820]  между собой. Вот таким соотношением. Поэтому одно бесконечность, другое единица и наоборот.
[51:10.820 --> 51:16.300]  Просто потому, что они так связаны. Здесь ключевое это вот замечание, что вот эта вещь,
[51:16.300 --> 51:22.100]  она связана с произведением некоторых функций. Вообще, вот эта вот техника,
[51:22.100 --> 51:27.300]  которую я здесь привел, это техника производящих функций. У меня там в лекциях даже небольшое
[51:27.300 --> 51:34.180]  приложение по этому поводу есть. Вот. Но на самом деле, мы не то чтобы очень сильно это используем,
[51:34.180 --> 51:40.260]  вот эту технику. Но конкретно здесь в этом доказательстве что-то такое применяется. Вот.
[51:40.260 --> 51:46.300]  Ну еще я могу сказать, что в технике производящей функции там часто не заботится о том, что ряды
[51:46.300 --> 51:52.820]  сходятся для каких-то z. Хотя здесь нам это было важно, на мой взгляд. Потому что все-таки мы здесь
[51:52.820 --> 51:57.700]  работаем с полноценными функциями. Нам нужна теория мабеля, сходимости z к чему-то. Поэтому,
[51:57.700 --> 52:02.940]  если мы хотим, чтобы функция по z куда-то сходилась, нам нужно, чтобы это была функция, как минимум.
[52:02.940 --> 52:07.860]  Чтобы для каждого z это было какое-то число. Для этого нам нужна сходимость этих рядов. Поэтому
[52:07.860 --> 52:14.220]  я ее здесь упоминаю. Ну благо она есть, потому что эти ограничены. Вот. А так вообще в общей технике
[52:14.220 --> 52:18.900]  производящей функции там сходимости рядов не заботится. Там главное это порождать последовательности
[52:18.900 --> 52:27.540]  через функции, через формальные взаимодействия функций. Вот. Ну здесь вот нам было принципиально,
[52:27.540 --> 52:34.100]  то что это все-таки функции и сходятся ряды. Вот такая тярема. Вот какие следствия мы из нее
[52:34.100 --> 52:50.380]  получаем? Что возвратность равносильна расходимости вот этого ряда. Я, прежде чем говорить о следствии,
[52:50.380 --> 53:01.420]  скажу, новое определение дам. И называется нулевым состоянием, нулевое состояние, если p,
[53:01.420 --> 53:10.780]  i, t, i, t от n сходятся к нулю при n, стремящемся к бесконечности. Вот. Состояние нулевое если.
[53:10.780 --> 53:19.260]  В этом определении два утверждения. Ну как мы любим, да? Предел существует и он равен нулю.
[53:19.340 --> 53:23.980]  Никто не сказал, что предел должен обязательно существовать. То есть нулевое состояние,
[53:23.980 --> 53:30.460]  если предел существует, то он равен нулю. Если предел не существует или он существует,
[53:30.460 --> 53:42.460]  но не равен нулю, то тогда состояние называется не нулевым. Вот. И что мы получаем? Смотрите,
[53:42.460 --> 53:53.340]  что если и невозвратно, следовательно, по критерию вот эта штука сходится, а мы знаем,
[53:53.340 --> 53:59.220]  что есть необходимые условия сходимости, стремление к нулю в общем свете. Вот. Следовательно,
[53:59.220 --> 54:06.300]  p, i, t, i, t от n сходится к нулю. Предел существует и равен нулю. Вот. А это есть нулевое состояние,
[54:06.940 --> 54:18.900]  определение нулевое состояние. Значит, если состояние невозвратно, то оно нулевое. Вот.
[54:18.900 --> 54:29.380]  Установили с вами. Если оно не нулевое, будет не выполнено необходимое условие сходимости ряда,
[54:29.380 --> 54:33.580]  ряд обязательно разойдется. А так как здесь не отрицательные числа, он обязательно разойдется
[54:33.580 --> 54:47.140]  к бесконечности, тогда по теореме это будет означать, что это состояние возвратное. Вот. Вот
[54:47.140 --> 55:01.940]  это выделяйте в табличку. Если предела нет, так как они не отрицательные, это значит,
[55:01.940 --> 55:08.300]  что ряд разойдется к бесконечности. Вот. Всякие сюрпризы, возможно, когда там отрицательные и
[55:08.300 --> 55:13.420]  предела нет, тогда он не обязательно к бесконечности, то есть тогда, ну предела нет просто. А для не
[55:13.420 --> 55:23.860]  отрицательных предела нет означает, что предел в сумм бесконечности. Вот. Значит, обратные стрелочки
[55:23.860 --> 55:37.220]  не всегда есть. Ну, можно привести примеры цепей, когда из нулевости не следует невозвратность. То есть
[55:37.220 --> 55:42.260]  бывают нулевые возвратные состояния. Всякие примеры можно придумать. Ну, я надеюсь, что на
[55:42.260 --> 55:51.860]  семинарах вы разные примеры рассмотрите. Вот. А в общих цепях у нас вот только такие следствия есть.
[55:51.860 --> 56:01.540]  Так, едем дальше. Еще одно определение
[56:01.540 --> 56:09.540]  периодического состояния.
[56:09.540 --> 56:35.220]  Так. Определение. Пусть и следует и. Из и следует и. То есть и сообщается сам с собой. Тогда наибольший
[56:35.220 --> 56:48.220]  общий делитель положительных n, для которых P i t i t от n больше нуля, вот это называется периодом
[56:48.220 --> 57:07.180]  i. Называется периодом состояния i. И если d i больше единицы, то i называется периодическим с периодом
[57:07.180 --> 57:24.540]  1. А если d i равен единице, то i называется непериодическим. Ну или как бы периодическим с периодом
[57:24.540 --> 57:35.340]  1. Ну так не говорят. Говорят не периодическим. Вот. Ну откуда это? Давайте такой пример рассмотрим. 0, 1, 2.
[57:35.340 --> 57:53.260]  И здесь вероятность переходов единицы. Вот. Тогда из 0 следует 0. Но когда мы будем бывать в 0? P00 единица
[57:53.260 --> 58:13.180]  это 0. P00 за 2 шага, раз 2, это 0. А P00 за 3 шага, это 1. Потом за 4 шага снова 0. За 5 шагов 0. За 6 шагов снова 1.
[58:13.180 --> 58:25.100]  И так далее. То есть мы бываем здесь только, видите, в 3, 6, 9 и так далее. У 0 период 3. Понятно? Вот. У 0 период 3. И у этого период 3. И у этого период 3.
[58:25.100 --> 58:48.460]  Вот. Но если мы рассмотрим какую-нибудь вот такую ситуацию, скажем так. Вот. То тогда мы в 0 и за 1 шаг, и за 2 шага, и как угодно.
[58:48.460 --> 58:58.860]  Поэтому вот это множество, оно содержит в себе n. Какие? И 1, и 2, и 3 и так далее. То есть весь натуральный ряд содержит. А их наибольший обществилитель единица.
[58:58.860 --> 59:14.860]  То есть здесь 0 не периодическое состояние. Единица тоже не периодическое состояние. Хотя за 1 шаг здесь будет 0.
[59:15.020 --> 59:28.300]  Но за 2 шага уже будет 1. Вероятно. А нет. За 2 шага. Нет. Если здесь скажем 1, 2, 1, 2, здесь будет 1, 2. Ну больше 0, короче говоря. Вот.
[59:28.300 --> 59:47.660]  Дальше. За 3 шага. Значит здесь, здесь, сюда. Значит 1, 1, 2, 1, 2. 1, 4. Ну и получается, что неважно как там дальше, здесь в этом множестве содержится и 2, и 3. Взаимнопростые числа. Их нод единица.
[59:47.660 --> 59:57.020]  Все. Значит это тоже не периодическое состояние. Ну для нуля мы как-то быстро сказали. Для единиц мы немножко напряглись.
[59:57.020 --> 01:00:08.540]  Но на самом деле и возвратность, нулевость и периодичность это все свойство класса. И смотря сюда, если мы видим, что 0 не периодическое, значит все не периодические с кем он сообщается на самом деле.
[01:00:08.620 --> 01:00:20.780]  Вот сейчас эту теорему мы докажем с вами. Последнюю теорему на сегодня. Теорема о солидарности называется. Теорема о солидарности.
[01:00:24.780 --> 01:00:33.740]  То есть состояние, сообщающееся состояние расшаривают свои свойства. Нулевость, возвратность, периодичность. И период даже сохраняется. Один и тот же у них.
[01:00:38.540 --> 01:01:01.740]  Значит теорема о солидарности мы ее называем. Значит пусть и сообщается с ж. Все. Тогда первое.
[01:01:02.700 --> 01:01:22.940]  Если и нулевое, следовательно жи. Нулевое. Второе. Если и возвратное, следовательно жи. Возвратное.
[01:01:23.740 --> 01:01:44.140]  Три. Если и имеет период d, он может быть равный единице, то и ж имеет период d. Вот.
[01:01:44.540 --> 01:01:52.540]  Ну и кстати следствие самой первой теоремы, которую сегодня доказал. Если и существенное, то и ж тоже существенное. В принципе можно добавить сюда.
[01:01:52.540 --> 01:02:02.540]  Вот. Ну это немножко другое. Хотя в принципе тоже можно сказать солидарность. Вот будем сейчас доказывать. Это простая теорема.
[01:02:03.340 --> 01:02:06.940]  Сейчас мы ее с вами докажем. Лишняя всестату.
[01:02:06.940 --> 01:02:29.340]  Так. Ну во-первых давайте я здесь даже пока напишу. Воспользуемся тем, что они сообщаются.
[01:02:29.340 --> 01:02:55.740]  Это означает, что и сообщается с ж. Это означает по определению, что найдется m больше либо равной единице, найдется n больше либо равной единице такие, что p и j m больше нуля и p, j и n больше нуля.
[01:02:55.740 --> 01:03:08.140]  Вот это давайте мы обозначим за айфу, эту за бету. Ну в принципе это не важно. Вот. Нам будет важно то, что эти числа строго больше нуля.
[01:03:08.140 --> 01:03:22.140]  И давайте мы с прошлой лекции вспомним еще одну формулу. p и t. Давайте запишем от m плюс n плюс n. Там у нас были n1 плюс n2 плюс n3 и так далее.
[01:03:22.140 --> 01:03:41.340]  Вот эта вещь, она больше либо равна, чем p и t, j и t, m, p и j и t, n, p и j и t, n. Помните, я вам говорил выделить в рамочку.
[01:03:41.340 --> 01:03:49.740]  Вот это много где используется. Это очень классная вещь. Причем здесь нет j, а здесь мы сделали. Мы могли есть сюда любое состояние, любое другое.
[01:03:49.740 --> 01:04:00.540]  Не обязательно вот это j из нашей теоремы, но мы возьмем именно j из нашей теоремы, потому что про него мы знаем какие-то свойства. А так произвольные здесь могут быть.
[01:04:01.340 --> 01:04:19.740]  Вот так вот. Теперь смотрите. Вот это у нас альфа больше нуля и вот это у нас бета больше нуля. Значит это есть альфа бета на p и j и t от n. И вот это больше нуля.
[01:04:20.540 --> 01:04:28.140]  Вот этим вот неравенством мы сейчас и воспользуемся, как минимум, а может даже и везде во всех случаях.
[01:04:28.540 --> 01:04:44.940]  Значит первое. С нулевостью. Значит если и нулевое, пусть и нулевое, тогда p и j и t стремится к нулю. Значит вот эта вещь будет стремиться к нулю.
[01:04:44.940 --> 01:04:53.740]  М и n мы фиксируем, мы их не трогаем, а n вот это устремляем к бесконечности. Значит вот эта вещь должна стремиться к нулю.
[01:04:53.740 --> 01:05:12.540]  p и i, m, n, n стремится к нулю при n, стремящемся к бесконечности. Но вот эта вещь, вот это p, она меньше либо равна, чем вот эта вещь разделить на альфа бета, которая больше нуля.
[01:05:12.540 --> 01:05:27.340]  Это принципиально важно, что эта вещь больше нуля. А это означает, что p, j, t, j, t от n стремится к нулю. Вот из этого неравенства. Понятно?
[01:05:27.340 --> 01:05:37.340]  Мы воспользовались тем, что они сообщаются, то что вот эта вещь больше нуля. Если здесь был бы ноль, это считай, не оценка никакая. Вероятость больше нуля. Ну что?
[01:05:37.340 --> 01:05:46.940]  Вот. А так мы выразили p, j, t, j, t как вот ту вероятность разделить на альфу бету. А эта вещь стремится к нулю. Все, значит она стремится к нулю.
[01:05:46.940 --> 01:06:04.540]  Вот. Так что мы получили, что если i нулевой, значит j нулевой. Отлично. Первый пункт теории выполнен. Теперь второй пункт.
[01:06:04.540 --> 01:06:24.140]  Пусть и возвратная. Но это означает, что вот эта штука, ряд такой штуки расходится.
[01:06:24.140 --> 01:06:47.740]  Вот эта вещь расходится. То есть эта сумма равна бесконечности. Но эта вещь больше либо равна той вещи. Значит этот ряд больше либо равен, чем сумма альфа бета на p, j, t, j от n. Альфа бета больше нуля причем.
[01:06:47.740 --> 01:07:01.340]  Нет, что-то не так. А, да. Не-не, это плохая оценка, подождите. Получается ряд сверху меньше либо равен плюс бесконечности. Не надо так делать тогда. Давайте мы вот как сделаем.
[01:07:01.340 --> 01:07:24.940]  Давайте мы построим ряд на житый-житый. Ну какая разница? Это справедливо. То есть мы здесь возьмем житый-житый. Вот так сделаем. Он больше либо равен, чем p, j, t, i, t. Ну там кто-то из них, m или n.
[01:07:24.940 --> 01:07:46.540]  Плюс i, i, n и i, j от m. А это альфа и бета. Вот так. Вот так давайте сделаем. Так что, если i возвратное, значит вот этот ряд расходится, а этот больше либо равен его. Значит он тоже расходится.
[01:07:46.540 --> 01:08:04.140]  Все. Следовательно, жи тоже возвратные. По критерию возвратности. Здесь мы воспользовались критерием возвратности. Отлично. Теперь третий пункт о сохранении периода.
[01:08:04.740 --> 01:08:28.740]  Это тоже очень просто. Как мы будем это доказывать? Давайте мы ведем в рассмотрение вот такие множества чисел. Ну от которых нам нужно как бы считать.
[01:08:28.740 --> 01:08:48.340]  Н больше нуля такие, что p, j, t, i, t от n больше нуля. Вот нод этих чисел, это есть период для i. Вот. И в ж рассмотрим. Н больше нуля такие, что p, j, t, j от n больше нуля.
[01:08:48.940 --> 01:09:05.940]  Вот. И пусть наибольший общий делитель здесь d i, а здесь наибольший общий делитель d j. Вот. Попробуем установить, что они равны на самом деле. Значит смотрите, пусть n принадлежит v i.
[01:09:06.540 --> 01:09:18.540]  Ну вообще, что такое наибольший общий делитель d i? Это означает, что он делит все числа, которые здесь находятся. И больше него никого нет, кто поделит все эти числа. То есть он делит все числа здесь.
[01:09:19.140 --> 01:09:46.140]  Это делит все числа здесь. Пусть n отсюда. Вот. Пусть n принадлежит вот этому. Вот. Тогда, раз i, t, i, t для этого n больше нуля, то тогда p, j, t, j, t, m plus n plus n больше либо равно, чем альфа, бета умножить на p, i, t, i, t от n.
[01:09:46.140 --> 01:10:03.740]  И так как n содержится в этом множестве, то есть p больше нуля, это больше нуля, значит это больше нуля. И это означает, что для вот этого числа получаем больше нуля. То есть m plus n plus n принадлежит v j.
[01:10:04.340 --> 01:10:17.340]  Вон тому. Потому что это один из тех номеров, на которых вероятность p, j, j больше нуля. Видите, какая хитрая получается связь. Мы взяли n отсюда, а доказали что-то про это множество.
[01:10:17.340 --> 01:10:35.940]  Вот. Тут хитро, хитро. Вот. Вот так. А теперь смотрите, финт какой ушами. Если n лежит здесь, то и 2n лежит здесь. Потому что p и i 2n больше либо равно, чем произведение p и n на p и n.
[01:10:35.940 --> 01:10:40.540]  Опять же, все по той вот самой вот формуле замечательной из рамочки.
[01:10:40.540 --> 01:11:01.540]  Если n лежит следовательно и 2n принадлежит v i, тогда по доказанному m plus 2n plus n лежит v j. То есть и этот лежит v j, и этот лежит v j. Значит их разность лежит v j.
[01:11:02.540 --> 01:11:20.540]  Вот. Ну, а вернее как? Смотрите, даже так. Нет, не разность. Не надо разности. Не разность. Они оба лежат v j, а вот этот их наибольший общеделитель. То есть он делит и это число, и это число.
[01:11:20.540 --> 01:11:43.540]  Значит он делит их разность. Вот так. Следовательно, d j делит разность, но разность равна n. Значит d j делит n. Вот.
[01:11:44.540 --> 01:12:01.540]  А n произвольно. А n произвольно. Значит получается, что вот это d j делит все здесь. Этот делит все здесь, и этот делит все здесь. Это какой-то общеделитель. Мы не знаем, наибольший или нет, но общеделитель, правильно?
[01:12:01.540 --> 01:12:15.540]  Раз он делит все числа здесь. Мы взяли n произвольное, n произвольное. Взяли произвольное число отсюда и доказали, что эта штука делит это число. Значит это общеделитель, а это наибольший общеделитель.
[01:12:15.540 --> 01:12:33.540]  Значит d j меньше либо равно d i. Переставьте j местами. Мы рассмотрели, может переставьте местами. Точно так же мы доказываем, что d j меньше либо равен d j. Взяв произвольное, n отсюда и повтори все эти рассуждения.
[01:12:33.540 --> 01:12:43.540]  Так что на самом деле мы получаем, что d j равно d i. Вот такая вот интересная теорема.
[01:12:43.540 --> 01:13:07.540]  Мы просто записали другое выражение только для j. P, j, j, m, n, n. Другое неравенство записали, потому что оно справедливо для любых и j, k, всего чего угодно.
[01:13:07.540 --> 01:13:20.540]  Здесь я записал для i, потому что мне вот здесь это пригодилось. Ну да, для возвратности можно сделать то же самое, только здесь j, j, j, i и j. Ну и m, n тоже переставить местами.
[01:13:20.540 --> 01:13:33.540]  Мы пользуемся вот этим вот неравенством в рамочке из той лекции. Просто другие взяли. Здесь i, j, j. Какая разница?
[01:13:33.540 --> 01:13:47.540]  Теперь следствие из нее. Если состояния сообщаются, они расшаривают свои свойства. Существенность, нулевость, возвратность, периодичность.
[01:13:47.540 --> 01:14:09.540]  Значит, мгновенное следствие отсюда. Если цепь неразложима, то есть все состояния у нее сообщаются, то если одно состояние нулевое, все нулевые, одно возвратное, все возвратные, одно периодическое с периодом d, все периодические с тем же самым периодом d. Понятно?
[01:14:09.540 --> 01:14:35.540]  Мгновенное следствие вот этой теоремы. Вот. Что в неразложимых цепях. Так что если вы знаете, что ваша цепь неразложима, вы хотите доказать, что проверить на нулевость, возвратность и состояние, то вам достаточно проверить только для одного состояния что-то.
[01:14:35.540 --> 01:14:44.540]  Допустим, вы нашли какое-то одно состояние, для которого очень легко проверить нулевость. Доказали, что оно нулевое? Все нулевые. Все. Его уже голову не ломайте для остальных.
[01:14:44.540 --> 01:14:56.540]  Потому что реально может так быть, что для каких-то состояний очень тяжело проверить нулевость. Но есть другое состояние, с которым оно сообщается, и там нулевость просто очевидна. Вот.
[01:14:56.540 --> 01:15:14.540]  То есть вот этим надо пользоваться. Вот. Так что вот эти свойства, это все свойства классов. Все свойства классов. Ну хорошо. И последнее, что я здесь хочу сказать, как бы резюмировать вот эти свойства и взаимосвязи между ними.
[01:15:14.540 --> 01:15:33.540]  Значит, смотрите. Мы с вами до этого выяснили, что если состояние не возвратное, оно нулевое. Так? Если оно не нулевое, оно возвратное. Это в любых цепях. И счетных и конечных. Разложимых, неразложимых. Это всегда так.
[01:15:33.540 --> 01:15:59.540]  Теперь. Есть еще одно свойство, которое нам может помочь делать разные утверждения. Я это даю без доказательства. Несущественное состояние является всегда невозвратным.
[01:15:59.540 --> 01:16:14.540]  Вот. Ну и то же самое получается возвратное, обязательно существенное. Это в любых цепях. И в счетных тоже. Из несущественности всегда следует невозвратность. Вот.
[01:16:14.540 --> 01:16:24.540]  Это теорема без доказательства, но ей можно и нужно пользоваться, потому что это помогает делать утверждения разные.
[01:16:24.540 --> 01:16:38.540]  Вот. И еще одна теорема без доказательства. Но если вот эта теорема сложная, ее можно найти, знаете, в замечательной книжке Кайла и Джон.
[01:16:38.540 --> 01:16:48.540]  Однородные цепи Маркова. Очень рекомендую эту книгу. Очень хорошая. Вот как раз одна из тех книг, по которым можно учиться писать книги.
[01:16:48.540 --> 01:16:56.540]  Мне она очень нравится. И даже вот отдельные теоремы. Например, пункт 3 теоремы солидарности я взял из этой книжки тоже.
[01:16:56.540 --> 01:17:01.540]  А вот другая теорема. Это сложная теорема. Там много лем доказывается, прежде чем ее доказать. Не тривиальная вещь.
[01:17:01.540 --> 01:17:27.540]  Вот. А вот эта теорема, значит, в неразложимой конечной цепи Маркова все состояния не нулевые.
[01:17:27.540 --> 01:17:35.540]  Вот. И это простая теорема. Я вам ее предлагаю доказывать. Как упражнения на экзамене могут тогда дать. Ну, это легко доказывается.
[01:17:35.540 --> 01:17:42.540]  На самом деле, просто надо знать все критерии, вот эти свойства. Вот. Это вещь, в принципе, простая. Вот. Это сложная.
[01:17:42.540 --> 01:17:51.540]  Но можем использовать всегда и то, и другое. Ну вот. А теперь, собственно, резюме. Вот. С учетом всего, что мы сейчас узнали.
[01:17:52.540 --> 01:18:03.540]  Чтобы у вас это всегда было перед глазами, когда вы решаете задачи, чтобы вы этим пользовались.
[01:18:03.540 --> 01:18:13.540]  Потому что я понимаю, свойства много, связи между ними запутанные. Давайте это мы все выделим отдельно.
[01:18:13.540 --> 01:18:18.540]  Значит, в конечных и счетных цепях.
[01:18:24.540 --> 01:18:34.540]  Но я все-таки допишу. Это важно. Несущественное, невозвратное.
[01:18:34.540 --> 01:18:48.540]  Точно. Третье. Ненулевое. Возвратное. Вот. Вот это критерий, а вот это теорема, которую я там привел из Кайла Джуна.
[01:18:48.540 --> 01:18:53.540]  Вот. Теперь в конечных цепях.
[01:18:53.540 --> 01:18:55.540]  В конечных цепях.
[01:19:00.540 --> 01:19:07.540]  Вот. Вот это критерий, а вот это теорема, которую я там привел из Кайла Джуна.
[01:19:08.540 --> 01:19:12.540]  В конечных цепях.
[01:19:18.540 --> 01:19:21.540]  В конечных цепях.
[01:19:26.540 --> 01:19:31.540]  Существенность равносильна возвратности.
[01:19:31.540 --> 01:19:40.540]  Кстати говоря, когда только эти свойства начали изучать в середине прошлого века, то даже их вообще не различали.
[01:19:40.540 --> 01:19:48.540]  Когда изучали сначала только конечные цепи, назовем там что-то существенным, если дальше идет определение возвратности или наоборот.
[01:19:48.540 --> 01:19:52.540]  Не различали их, а потом теорема такая появилась, что на самом деле они равносильны.
[01:19:52.540 --> 01:20:00.540]  Но если вот это все соединить вместе, то вы обнаружите, что существенность и возвратность в конечных цепях – это равносильные вещи.
[01:20:00.540 --> 01:20:03.540]  Вот. Так.
[01:20:06.540 --> 01:20:10.540]  Возвратность равносильна ненулевости.
[01:20:12.540 --> 01:20:15.540]  Такой жаргон себе позволю применить.
[01:20:15.540 --> 01:20:26.540]  И третье еще, что можно тоже легко доказать, всегда существует существенное состояние.
[01:20:27.540 --> 01:20:29.540]  Вот.
[01:20:30.540 --> 01:20:36.540]  Так что так.
[01:20:41.540 --> 01:20:43.540]  В конечных цепях.
[01:20:43.540 --> 01:20:57.540]  Ну, откуда следует это-то первое.
[01:20:57.540 --> 01:21:05.540]  Значит, если цепь конечна, в ней есть множество несущественных состояний, несущественных, несущественные и невозвратные.
[01:21:05.540 --> 01:21:10.540]  А вот существенные состояния, они все принадлежат конечным неразложимым цепям.
[01:21:10.540 --> 01:21:13.540]  Там все состояния ненулевые, соответственно возвратные.
[01:21:13.540 --> 01:21:18.540]  Не существенность, невозвратность, существенность – возвратность.
[01:21:18.540 --> 01:21:21.540]  Поэтому вот получается этот пункт.
[01:21:21.540 --> 01:21:23.540]  Ну, там можно и с этим тоже.
[01:21:23.540 --> 01:21:28.540]  Опять же, существенные, возвратные, ненулевые, значит, возвратность, ненулевость.
[01:21:28.540 --> 01:21:31.540]  Из ненулевости – возвратность по критерию.
[01:21:31.540 --> 01:21:33.540]  Всегда существует существенное состояние.
[01:21:33.540 --> 01:21:36.540]  Но это от противного, оказывается, допустим, нет.
[01:21:36.540 --> 01:21:41.700]  ну и там очень легко прийти к противоречию и существенно используется конечность.
[01:21:41.700 --> 01:21:48.820]  В счетных цепях может оказаться так, что все состояния несущественные. Надо какой-нибудь вот
[01:21:48.820 --> 01:21:58.380]  такой пример. Все они несущественные, невозвратные, нулевые. В счетных цепях может быть так же,
[01:21:58.380 --> 01:22:05.020]  что все состояния возвратные нулевые. Вот. То есть такое тоже может быть.
[01:22:05.020 --> 01:22:09.740]  Ну все. Думаю, на этом закончим.
