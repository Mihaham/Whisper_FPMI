[00:00.000 --> 00:07.600]  Волочка неинтересна, при положительных B нужна только
[00:07.600 --> 00:08.600]  верхняя.
[00:08.600 --> 00:11.880]  Вот при положительных B нужна только верхняя.
[00:11.880 --> 00:12.880]  Хорошо.
[00:12.880 --> 00:15.960]  Значит, ну тогда давайте считать, что B положительно
[00:15.960 --> 00:17.800]  рассматриваем только верхнюю оболочку.
[00:17.800 --> 00:22.840]  Вот как-то так она выглядит.
[00:22.840 --> 00:26.320]  И теперь, если я рассмотрю все стороны как векторы,
[00:26.320 --> 00:28.480]  то мы как бы помним, что они у нас все вот так вот
[00:28.480 --> 00:31.000]  заворачиваются по часовой стрелке.
[00:31.000 --> 00:33.680]  Каждый последующий вектор по сравнению с предыдущим
[00:33.680 --> 00:36.600]  вращается на некоторый отрицательный угол, потому
[00:36.600 --> 00:38.880]  что направление у нас по часовой стрелке это отрицательно.
[00:38.880 --> 00:46.800]  Ну и тогда дальше смотрите, если я посчитаю чему равно
[00:46.800 --> 00:48.680]  скалярным произведением вот этой точки с вектором
[00:48.680 --> 00:51.120]  A-B, чему равно скалярным произведением этой точки
[00:51.120 --> 00:53.760]  с вектором A-B и так далее, то у меня отверстие сначала
[00:53.760 --> 00:56.560]  будет увеличиться, а потом уменьшаться.
[00:56.560 --> 00:58.520]  Потому что из-за того, что эти векторы у меня как
[00:58.520 --> 01:01.200]  бы строго упорядочены, они идут в таком порядке
[01:01.200 --> 01:05.300]  заворачивания, у меня сначала векторы будут как бы
[01:05.300 --> 01:06.880]  сначала, грубо говоря, сонаправлены с вектором
[01:06.880 --> 01:10.800]  A-B до какого-то вот этого момента, а дальше каждый
[01:10.800 --> 01:13.160]  этот вектор будет нас только отдалять от вектора A-B
[01:13.160 --> 01:16.200]  и будет тем самым нам уменьшать скалярное произведение.
[01:16.200 --> 01:18.320]  Более формально у меня скалярное произведение
[01:18.320 --> 01:21.680]  вот этих вот всех векторов сторон с вектором A-B сначала
[01:21.680 --> 01:23.200]  положительное, потом отрицательно.
[01:23.200 --> 01:29.240]  Давайте я нарисую, пусть это будет V1, V2 и так далее,
[01:29.320 --> 01:32.960]  и V1, V2 и так далее, за какой-нибудь K.
[01:32.960 --> 01:35.960]  Это вектор AB, пусть я его назову U.
[01:35.960 --> 01:40.960]  Тогда все скалярные произведения вначале положительны, вплоть
[01:40.960 --> 01:43.960]  до какого-то VI.
[01:43.960 --> 01:55.080]  А потом начиная с I-1 отрицательно, вплоть до K.
[01:55.080 --> 01:57.980]  Сначала скалярные произведения возрастают, потому что
[01:57.980 --> 02:00.900]  значок больше нуля, потом он начинает убывать, потому
[02:00.900 --> 02:06.220]  что значок будет меньше нуля в скалярном произведении.
[02:06.220 --> 02:07.220]  Так.
[02:07.220 --> 02:20.320]  Ну почему это верно?
[02:20.320 --> 02:23.860]  Потому что если у меня где-то нашелся значок больше нуля,
[02:23.860 --> 02:27.740]  то значит угол между ними тупой, между этими векторами,
[02:27.740 --> 02:33.100]  а значит угол между вектором U и следующим еще более тупой,
[02:33.100 --> 02:34.940]  потому что они все отклоняются друг от друга по часовой
[02:34.940 --> 02:36.900]  стрелке, поэтому этот угол будет только увеличиваться.
[02:36.900 --> 02:39.780]  То есть если вот здесь вот у меня уголок острый,
[02:39.780 --> 02:42.780]  какой-нибудь, вот такой маленький, небольшой, здесь не маленький-маленький,
[02:42.780 --> 02:44.920]  то если оно с какой-то моментом начинается тупым, то дальше
[02:44.920 --> 02:47.060]  будет со времен тупой угол.
[02:47.060 --> 02:49.260]  Поэтому действительно у меня сначала вот эти вот
[02:49.260 --> 02:51.860]  векторы с вектором U дают положительное в скалярном
[02:51.860 --> 02:52.860]  произведении, потом отрицательное.
[02:52.860 --> 02:56.020]  Ну и из-за линейности в скалярном произведении я понимаю,
[02:56.100 --> 02:58.860]  что при движении по вот этим векторам у меня скалярное
[02:58.860 --> 03:00.620]  произведение с текущей точкой только увеличивается,
[03:00.620 --> 03:01.960]  да, то есть у меня было какое-то изначальное скаллярное
[03:01.960 --> 03:03.260]  произведение в этой точке,
[03:03.260 --> 03:06.240]  потом я прошелся вдоль вектора, которое мне увеличило
[03:06.240 --> 03:08.220]  скалярное произведение, значит стало больше, потом
[03:08.220 --> 03:09.720]  еще больше, еще больше, еще больше и еще больше.
[03:09.720 --> 03:12.880]  Вот здесь максимум, а дальше она начинает падать,
[03:12.880 --> 03:15.900]  а поэтому что бы найти вот эту точку, где достигается
[03:15.900 --> 03:18.480]  максимум мне нужно понять в какой момент у меня
[03:18.480 --> 03:20.960]  происходит перелом от положительных скалярных
[03:20.960 --> 03:22.940]  произведений к отрицательным, и это может сделать например
[03:22.940 --> 03:24.200]  бенпоиск consistency image.
[03:24.200 --> 03:37.760]  чтобы найти i такое, что v i на u положительно, а следующее уже отрицательно,
[03:37.760 --> 03:41.760]  можно использовать бинарный поиск.
[03:41.760 --> 04:00.060]  То есть мы встаем l сюда, r сюда, взяли полусумму и посмотрели на вектор v м-тый. Скалярно его
[04:00.060 --> 04:04.200]  умножили на u. Если получилось положительно, значит точка перелома где-то правее. Значит
[04:04.200 --> 04:10.400]  надо взять l равно m. Если отрицательно, то точка перелома где-то левее, r равно m. Ну все,
[04:10.400 --> 04:15.000]  у нас в конце получится, что в какой-то конкретной точке происходит перелом, а значит ответ
[04:15.000 --> 04:21.560]  достигается ровно в этой точке. Мы понимаем точку, в которой происходит перелом от положительных
[04:21.560 --> 04:25.280]  скалярных произведений к отрицателям, в ней и будет максимальная скалярная произведение,
[04:25.280 --> 04:30.160]  потому что сумма всех этих векторов увеличивает скалярное произведение, а любое другое уменьшает.
[04:30.160 --> 04:38.200]  Итого, если у нас построена выпуклая оболочка, то для конкретного вектора a-b мы можем найти
[04:38.200 --> 04:45.320]  ответ за логарифмическое время. Вот луген, если конс в s уже построен.
[04:55.320 --> 04:59.220]  Ну и то же самое, если b меньше нуля. Если b меньше нуля, то мне нужна, наоборот,
[04:59.220 --> 05:07.340]  нижняя выпуклая оболочка. Значит, тогда рассматриваем нижнюю выпуклую оболочку.
[05:07.340 --> 05:18.100]  Там все аналогично. Если здесь мне нужна была верхняя, потому что у меня вектор как бы смотрит
[05:18.100 --> 05:23.340]  вверх, то теперь нужна нижняя. Ну, собственно, аналогично. И там тоже работает бин поиск,
[05:23.340 --> 05:31.140]  что сначала у меня скалярное произведение увеличивается, потому что я ищу экстремальную точку
[05:31.140 --> 05:36.860]  в таком направлении. У меня сначала угол увеличивается, потом начинает уменьшаться,
[05:36.860 --> 05:41.540]  потому что здесь скалярное произведение больше, а потом меньше. Соответственно,
[05:41.540 --> 05:46.380]  мне нужна точка, где происходит взлом. Ну, если где-то равенство, то получается у
[05:46.380 --> 05:51.120]  меня сторона перпендикулярная моему вектору, значит максим достигается вот на этой стороне,
[05:51.120 --> 05:58.880]  можно в качестве это взять любую из этих двух точек, вот, ну вроде все опять за
[05:58.880 --> 06:04.720]  логарифом, да, то просто бинпоиск на нижней выпуклоболочке. Значит, если же у меня
[06:04.720 --> 06:10.120]  множество точек S было динамическим и оно как-то там изменялось, расширялось, то
[06:10.120 --> 06:13.920]  мы можем хранить отдельно верхнюю, отдельно нижнюю в каких-нибудь структурах,
[06:13.920 --> 06:26.040]  а мы это с вами уже в прошлый раз делали. Если S динамическая, то верхнюю и нижнюю
[06:26.040 --> 06:40.840]  выпуклоболочки мы с вами хранили в сытах. Ну вот, значит, можно хранить в каких-то там
[06:40.840 --> 06:49.800]  деревьях поиска. Мы говорили, как тогда уметь вставлять куда-то выпуклоболочку,
[06:49.800 --> 06:53.960]  то есть если у меня есть какая-то текущая верхняя выпуклоболочка, пришла новая точка,
[06:53.960 --> 07:00.920]  мне нужно найти бинпоиском в этом дереве поиска, где она входит, ну и соответственно,
[07:00.920 --> 07:09.200]  как бы провести вот такие касательные и удалить все точки, которые нарушают выпуклость. Вот, ну и
[07:09.200 --> 07:14.200]  соответственно, а если у меня моя верхняя выпуклоболочка хранится в каком-нибудь дереве
[07:14.200 --> 07:20.200]  поиска, то в ней же, в нем же можно использовать вот этот трюк с бинарным поиском. Если у вас все
[07:20.200 --> 07:24.240]  хранится, ну скажем, в Декартовом дереве каком-нибудь, то вы можете искать в Макисовом склярном
[07:24.240 --> 07:30.000]  произведении по сути с куском по дереву. То есть если здесь вам нужно был бинарный поиск по массиву,
[07:30.000 --> 07:34.840]  теперь представьте, что это не массив, а дерево поиска какой-нибудь, там АВЛ, Декартово,
[07:34.840 --> 07:41.440]  что-нибудь такое. Тогда, ну по сути, вам нужно сделать бинпоиск, но бинпоиск в дереве поиска мы тоже
[07:41.440 --> 07:46.080]  умеем делать. Для этого надо идти по дереву сверху вниз, брать какие-то два соседние элемента,
[07:46.080 --> 07:53.160]  сравнивать склярное произведение с данным вектором у с нулем, если больше ноль нужно идти вправо,
[07:53.160 --> 08:12.040]  если меньше, то влево. Бинарный поиск превращается в спуск по дереву, а симптомика остается
[08:12.040 --> 08:33.120]  алгоритмическая. Итого задача, которую мы начали решать такая, мы можем поддерживать множество С,
[08:33.120 --> 08:39.280]  в которые можно вставлять точки, а еще для произвольного вектора АВ, мы умеем находить
[08:39.280 --> 08:44.400]  максимум склярного произведения по всем точкам из С. И все запросы мы обрабатываем за логарифм.
[08:44.400 --> 08:49.320]  Ставка за амортизированный логарифм, максимум склярного произведения за чистый логарифм.
[08:49.320 --> 09:16.560]  Хорошо. Я не умею, по крайней мере. Единственное, что я умею, это свое дерево писать. Я когда-то спрашивал,
[09:16.560 --> 09:24.320]  можно ли это сделать? Мне говорили, что вроде можно, но это что-то убийство, поэтому я не пытался понять даже.
[09:24.320 --> 09:47.760]  Так. Хорошо. Идем дальше. Следующая важная задача. Давайте я его назову. Вращающийся
[09:47.760 --> 09:56.000]  калиппера. Гуглиться по такому запросу. Значит, формулируется очень просто. Дано
[09:56.000 --> 10:08.520]  конечную множество точек, надо найти в нем диаметр. Найти диаметр конечного множества точек С.
[10:08.520 --> 10:14.760]  Диаметр это две точки, расстояние между парами максимально возможное.
[10:14.760 --> 10:34.120]  П и Ку из С. Дистанция между П и Ку. Надо найти диаметр, то есть максимальное расстояние между всеми
[10:34.120 --> 10:43.240]  парами точек внутри множества. Первое замечание, что П и Ку имеет смысл брать только в качестве
[10:43.240 --> 10:55.920]  вершин выпуклооболочки. Диаметр достигается на вершинах выпуклооболочки. На вершинах он в С.
[10:55.920 --> 11:08.480]  Ну опять, здесь не очень хитро все. Почему это верно? Ну пусть где-то диаметр достигается,
[11:08.480 --> 11:14.040]  пусть есть какой-то там П и Ку. Какое-то максимально возможное расстояние. Ну давайте
[11:14.040 --> 11:19.160]  этот отрезок продлим. Да, и при этом там П и Ку внутренние точки какие-нибудь. Тогда давайте
[11:19.160 --> 11:25.480]  этот отрезок просто продлим до пересечения с границей. Тогда мы попали либо на сторону,
[11:25.480 --> 11:30.600]  либо уже сразу в вершину. Если в вершину, то уже победа. Мы увеличили ответ и встали в вершину,
[11:30.600 --> 11:37.160]  поэтому как бы там противоречие, грубо говоря. Иначе мы пришли куда-то на сторону, но тогда я
[11:37.160 --> 11:43.520]  утверждаю, что опять-таки движение в одну из двух сторон обязательно не уменьшает ответ. То есть,
[11:43.520 --> 11:48.840]  если я буду двигать, то есть если я сдвину Ку вот сюда и буду двигать его вдоль этой стороны,
[11:48.840 --> 11:54.720]  то по крайней мере одна из этих двух точек даст только лучший ответ. Потому что, значит,
[11:54.760 --> 11:59.040]  что такое расстояние от точки до отрезка? Как оно выглядит? Вот есть некий отрезок, есть какая-то
[11:59.040 --> 12:04.160]  точка. Если я пущу перпендикуляр, то расстояние будет минимально, а любое движение в сторону от
[12:04.160 --> 12:09.960]  перпендикуляра, неважно в какое, дает мне увеличение. Значит, понятно, что одно из этих двух направлений
[12:09.960 --> 12:13.360]  как раз-таки идет в сторону от перпендикуляра. То есть, если скажем, перпендикуляр это здесь,
[12:13.360 --> 12:20.400]  то у меня вот это увеличивает. Если перпендикуляр это вот здесь, то в любом случае хотя бы одно из
[12:20.400 --> 12:26.240]  них строго увеличивает расстояние. Поэтому движение по стороне в одну из двух сторон до вершины
[12:26.240 --> 12:30.560]  обязательно расстояние только увеличит. Поэтому можно вместо вот этой Ку взять одну из вот этих
[12:30.560 --> 12:34.880]  и расстояние увеличится. То же самое с П. П можно вот так вот подвинуть, так чтобы он попал в какую-то
[12:34.880 --> 12:42.000]  вершинку. Значит, в качестве вот этих П и Ку можно брать не все точки, а только вершины выпуклооблочки.
[12:50.400 --> 13:02.800]  Лемма. Лемма о диаметре. Пусть ПКу это диаметр С,
[13:07.480 --> 13:17.680]  пусть L1, L2 это прямые перпендикулярные вот этому отрезку ПКу, проходящие через П и через Ку соответственно.
[13:20.400 --> 13:35.840]  Прямые перпендикулярные отрезку ПКу, проходящие через П и Ку соответственно.
[13:35.840 --> 13:50.640]  Тогда я утверждаю С целиком лежит в полосе между L1 и L2.
[14:05.840 --> 14:20.720]  Доказательства. Вот пусть П, вот пусть Ку. Я рисую отрезок перпендикулярной прямые, проходящие через
[14:20.720 --> 14:26.960]  конце этого отрезка. Хочу сказать, что здесь нет никого и здесь нет никого. Что вне вот этих вот,
[14:26.960 --> 14:33.040]  вне полосы нет точек многоугольника, нет точек из С. Ну, это очень просто. Если что-то есть,
[14:33.440 --> 14:38.160]  вот здесь есть какая-то точка, то я симпенду ви что РП Maria больше, чем расстояние от П до Ку,
[14:38.160 --> 14:43.920]  а потому что ПКу это расстояние от П до этой прямой, а если точка лежит за прямой,
[14:43.920 --> 14:49.380]  то соответственно расстояние от ее до… от П до нее будет только строго больше. потому что от П
[14:49.380 --> 14:54.200]  до Ку минимальное расстояние до этой прямой. А от П до нее это расстояние для какой-то другой прямой,
[14:54.200 --> 14:58.320]  при этом еще не обязательно перпендикулярно. Поэтому наличие точки за пределами прямой� vere
[14:58.320 --> 15:04.780]  прямой, нарушая то, что ПК — это диаметр, потому что
[15:04.780 --> 15:06.800]  у нас есть тогда две точки, между которыми расстояние
[15:06.800 --> 15:07.800]  больше, чем ПК.
[15:07.800 --> 15:10.640]  То же самое, если есть точка здесь, то расстояние откуда
[15:10.640 --> 15:14.160]  нее больше, чем расстояние ПК.
[15:14.160 --> 15:15.160]  Доказательства от противного.
[15:15.160 --> 15:19.520]  Тогда ПК не может быть диаметром.
[15:45.160 --> 16:01.920]  Тогда, соответственно, алгоритм.
[16:01.920 --> 16:09.440]  Давайте мы возьмем две параллельные прямые L1 и L2, между которыми
[16:09.440 --> 16:11.240]  заключен целиком наш ногоугольник.
[16:11.240 --> 16:13.520]  То есть понятно, что вначале мы построили выпуклую оболочку,
[16:13.520 --> 16:14.960]  потому что нет смысла рассматривать внутренние
[16:14.960 --> 16:15.960]  какие-то точки.
[16:15.960 --> 16:18.840]  Построили выпуклую оболочку, заключили его между какими-то
[16:18.840 --> 16:19.840]  двумя прямыми.
[16:19.840 --> 16:23.840]  А теперь давайте их вот так синхронно вращать одновременно.
[16:23.840 --> 16:26.960]  То есть у меня есть две вертикальные прямые изначально, и я начинаю
[16:26.960 --> 16:29.440]  их одновременно вращать так, чтобы они упирались
[16:29.440 --> 16:30.440]  об наш ногоугольник.
[16:30.440 --> 16:32.960]  То есть вначале кратенька така, потом немножко будет
[16:32.960 --> 16:33.960]  вот так вот.
[16:33.960 --> 16:37.360]  Ну то есть, не знаю, как-нибудь вот так вот я это нарисую.
[16:37.360 --> 16:40.520]  И потом в какой-то момент происходит переключение
[16:40.520 --> 16:42.440]  относительно какой точки происходит вращение.
[16:42.440 --> 16:44.120]  То есть здесь вот у меня вращение относительно вот
[16:44.120 --> 16:45.120]  этих двух точек.
[16:45.120 --> 16:49.760]  Потом, когда у меня очередная прямая будет совпадать
[16:49.760 --> 16:53.360]  по направлению со стороной, у меня поменяется и дальше
[16:53.360 --> 16:55.320]  вращение будет не вокруг этой, а вокруг этой точки.
[16:55.320 --> 16:56.320]  Вот.
[16:56.320 --> 16:58.920]  Ну и тогда, соответственно, я могу полностью проворощать
[16:58.920 --> 17:01.000]  вот эти вот две прямые ледяные льдва относительно моего
[17:01.000 --> 17:02.000]  многоугольника.
[17:02.000 --> 17:06.760]  Полностью замести там весь круг Родианной Миры
[17:06.760 --> 17:07.760]  2P.
[17:07.760 --> 17:10.960]  И, по сути, тогда я переберу все возможные вот эти вот
[17:10.960 --> 17:12.840]  положения для ледяной льдва.
[17:12.840 --> 17:15.600]  То есть я не знаю, где находится диаметр, но я переберу все
[17:15.600 --> 17:18.440]  возможные положения вот этой пары параллельных
[17:18.440 --> 17:23.640]  прямых ледяных льдва, которые ограничивают мой многоугольник.
[17:23.640 --> 17:24.640]  Вот.
[17:24.640 --> 17:28.160]  Ну и для всех таких положений я найду расстояние между
[17:28.160 --> 17:30.960]  этими точками, о которой опирается собственно наша
[17:30.960 --> 17:33.200]  ледяная льдва, и максимум из них будет диаметром.
[17:33.200 --> 17:36.720]  То есть я все возможные положения ледяной льдва
[17:36.720 --> 17:37.720]  разберу.
[17:37.720 --> 17:39.600]  Одно из них точно будет соответствовать вот этому
[17:39.600 --> 17:42.400]  случаю, когда это все перпендикулярно диаметру.
[17:42.400 --> 17:44.600]  Значит, просто если я возьму максимально возможное
[17:44.600 --> 17:47.160]  расстояние между прямыми во всем моменте времени,
[17:47.160 --> 17:48.160]  то это будет ответ.
[17:48.160 --> 17:49.160]  С алгоритмом.
[17:49.160 --> 17:55.060]  Ну и, собственно, вот эти вот прямые будут называться
[17:55.060 --> 17:56.060]  калиперами.
[17:56.060 --> 17:58.000]  Просто как-то так называется.
[17:58.000 --> 18:07.240]  С алгоритмом пусть L1, L2, начально давайте вот эти вот
[18:07.240 --> 18:16.640]  вертикальные прямые, вертикальные прямые, прямые, обрамляющие
[18:16.640 --> 18:26.200]  наш многоугольник, обрамляющие S, вращаем их синхронно.
[18:26.200 --> 18:34.680]  Ну и, собственно, поддерживаем точки, относительно которых
[18:34.680 --> 18:35.680]  происходит вращение.
[18:35.680 --> 19:00.120]  Ну и по всем состояниям берем максимум вот между
[19:00.120 --> 19:15.080]  этими двумя точками.
[19:15.080 --> 19:21.640]  Берем максимум расстояния между этими точками.
[19:21.640 --> 19:39.360]  Так, идея понятна?
[19:39.360 --> 19:43.800]  Хорошо, значит, теперь как это реализовать?
[19:43.800 --> 19:47.880]  Ну, начало я уже сказал, да, мы начинаем с вертикального
[19:47.880 --> 19:48.880]  положения.
[19:48.880 --> 19:50.960]  Их легко определить, нужно просто взять точку с минимальным
[19:50.960 --> 19:53.880]  х, с максимальным х, ну или давайте я вот сразу
[19:53.880 --> 19:54.880]  такую картинку нарисую.
[19:54.880 --> 20:01.120]  Вот, у меня будет вот это L1, вот это будет L2.
[20:01.120 --> 20:07.000]  Просто нужны точки с минимальным х и с максимальным х.
[20:07.000 --> 20:12.780]  Значит, поддерживаем два индекса И и Ж, вокруг каких
[20:12.780 --> 20:14.320]  точек сейчас будет вращение.
[20:14.320 --> 20:16.640]  И давайте вращаться против часовой стрелки.
[20:16.640 --> 20:19.880]  Вот так у нас будет происходить вращение.
[20:20.360 --> 20:23.200]  Значит, понятно, что если я буду, если я все превращаю
[20:23.200 --> 20:25.760]  на очень маленький угол, на угол там какой-нибудь
[20:25.760 --> 20:29.280]  Эпсилон, да, вот так вот сделаю, то у меня понятное
[20:29.280 --> 20:31.400]  дело, точки, относительно которых происходит вращение,
[20:31.400 --> 20:32.400]  не поменяются.
[20:32.400 --> 20:39.600]  Ну а вот я буду так потихонечку вращать, вращать, вращать.
[20:39.600 --> 20:44.240]  Поменяется что-то только когда направление прямых,
[20:44.240 --> 20:46.640]  направление вот этих калиперов, обрамляющих наш многоугольник,
[20:46.640 --> 20:48.360]  совпадет с одной из сторон.
[20:48.360 --> 20:53.120]  В любом случае, ну давайте я вот так вот нарисую.
[20:53.120 --> 20:58.360]  Вот в этот момент, когда направление одного из калиперов
[20:58.360 --> 21:00.720]  совпадет со стороной, в этот момент у меня как
[21:00.720 --> 21:04.600]  бы будет сейчас опираться целиком на вот эту сторону,
[21:04.600 --> 21:06.520]  а если я продолжу вращать дальше, у меня вращение
[21:06.520 --> 21:07.760]  начнется вокруг вот этой точки.
[21:07.760 --> 21:11.560]  Ну и соответственно тогда мне нужно сделать следующее.
[21:11.560 --> 21:14.680]  Мне нужно понять, вот у меня есть две стороны, нужно
[21:14.680 --> 21:18.280]  понять какая из них находится ближе по углу, то есть в
[21:18.280 --> 21:19.480]  какую мы упремся раньше.
[21:19.480 --> 21:23.200]  И скажем, если мы понимаем, что это вот эта сторона,
[21:23.200 --> 21:25.680]  то мне нужно переключить g на единичку, ну на единичку
[21:25.680 --> 21:26.680]  увеличить.
[21:26.680 --> 21:29.680]  А если я понимаю, что сначала у меня начинают упираться
[21:29.680 --> 21:32.840]  вот сюда, то в этот момент времени, когда начнут упираться,
[21:32.840 --> 21:34.440]  у меня вращение начнет происходить вокруг точки g
[21:34.440 --> 21:35.440]  плюс один.
[21:35.440 --> 21:37.680]  Если у меня вот так вот занумерованы в том же порядке,
[21:37.680 --> 21:40.080]  против часовой, то мне нужно будет сделать g плюс один.
[21:40.080 --> 21:42.880]  И каждый раз, когда происходит переключение, значит я
[21:42.880 --> 21:46.360]  рассматриваю как бы новую пару калиперов, новое состояние,
[21:46.400 --> 21:49.600]  и текущую пару там, то есть и g плюс один, я проверяю
[21:49.600 --> 21:52.400]  на, ну то есть считаю расстояние и обновляю диаметр через
[21:52.400 --> 21:53.400]  текущее расстояние.
[21:53.400 --> 22:00.600]  Значит, ну, старт, давайте пропишем, я уже проговорил,
[22:00.600 --> 22:05.160]  это вертикальные прямые, вертикальные прямые.
[22:05.160 --> 22:13.080]  Дальше, вот пусть есть точка i, вокруг которой происходит
[22:13.080 --> 22:16.080]  вращение, и точка g, вокруг которой происходит вращение.
[22:16.800 --> 22:20.480]  Во-первых, не забываем сделать, что ans равно максимум из
[22:20.480 --> 22:28.560]  ans и dist p, i, t, p, g, t, то есть всегда, если i, g это те точки,
[22:28.560 --> 22:31.040]  вокруг которых сейчас происходит вращение, не забываем, что
[22:31.040 --> 22:34.200]  это один из кандидат, как бы, это пара, одна из кандидаток
[22:34.200 --> 22:35.200]  на ответ.
[22:35.200 --> 22:41.200]  Значит, дальше строим вот эти два вектора, две стороны,
[22:41.200 --> 22:45.320]  пусть это будет i плюс первая, это g плюс первая точка,
[22:45.560 --> 22:49.560]  значит, ну и вот надо понять, в какую из них мы раньше упремся,
[22:49.560 --> 22:52.560]  если я вот так буду продолжать вращаться, в какую из них
[22:52.560 --> 22:53.560]  я раньше упрусь.
[22:53.560 --> 23:01.560]  Ну, давайте напишем, значит, если здесь, как обычно,
[23:01.560 --> 23:07.560]  хватит векторного произведения, давайте попробуем, значит,
[23:07.800 --> 23:10.800]  то i, i плюс 1 и p, g, p, g плюс 1.
[23:18.800 --> 23:23.520]  Значит, вот сейчас оно положительно, тогда давайте
[23:23.520 --> 23:27.000]  будем делать plus plus g, иначе plus plus i.
[23:32.000 --> 23:35.000]  Ну, потому что, по сути, мне что нужно, мне нужно,
[23:35.440 --> 23:39.440]  вот как у меня есть предыдущее положение прямых l1, l2,
[23:39.440 --> 23:42.440]  мне нужно, по сути, померить вот эти вот уголочки и понять,
[23:42.440 --> 23:43.440]  кто из них меньше.
[23:43.440 --> 23:46.440]  И кто меньше, там и сделать переход.
[23:46.440 --> 23:49.440]  Если здесь угол меньше, то нужно сделать plus plus g.
[23:49.440 --> 23:53.440]  Ну, а если же я их просто приложу к одной точке,
[23:53.440 --> 23:57.440]  вот этот пусть будет вектор pi, pi плюс 1, вот это вот вектор
[23:57.440 --> 24:02.440]  p, g, p, g плюс 1.
[24:02.880 --> 24:04.880]  Ну, видим, что здесь, в этом случае, у меня поворот
[24:04.880 --> 24:07.880]  идет против всего стрелки положительной, это как-то
[24:07.880 --> 24:10.880]  значит, что вот этот вот угол маленький, тогда мне
[24:10.880 --> 24:11.880]  нужно как раз увеличивать g.
[24:11.880 --> 24:15.380]  А если бы угол был большой, то есть, картинка была какая-нибудь
[24:15.380 --> 24:20.380]  вот такая, так, сейчас я нарисую, вот что-нибудь
[24:20.380 --> 24:27.380]  вот такое, тогда вращение было бы вот таким, а значит,
[24:27.380 --> 24:30.380]  вектор p, g, p, g плюс 1 более крутой, чем вектор p, i, p,
[24:30.820 --> 24:34.820]  g, p, g плюс 1, а значит, сначала я затрону p, i, p, plus 1,
[24:34.820 --> 24:35.820]  то есть, нужно увеличить i.
[24:35.820 --> 24:39.320]  И только потом, уже только после этого, у меня направление
[24:39.320 --> 24:41.320]  совпадет с вектором p, g, p, g плюс 1.
[24:41.320 --> 24:44.320]  То есть, я выбираю, какой из векторов менее крутой,
[24:44.320 --> 24:48.320]  то есть, какое направление ближе к текущему, с помощью
[24:48.320 --> 24:49.320]  просто векторного произведения.
[24:49.320 --> 24:51.320]  Если оно больше 0, то значит, соответственно, вот здесь
[24:51.320 --> 24:52.320]  вот переход, иначе здесь.
[24:52.320 --> 24:56.320]  Ну и все, я вот так вот делаю, пока не пройду там целиком,
[24:56.320 --> 24:59.320]  не знаю, пока i не вернется в стартовую точку, то есть,
[25:00.260 --> 25:02.260]  я вот так вот целиком все обойду,
[25:02.260 --> 25:04.260]  пока i не вернется в стартовую точку,
[25:04.260 --> 25:07.260]  я делаю вот это вот свое преобразование.
[25:07.260 --> 25:09.260]  Переключаю текущую пару точек i, g,
[25:09.260 --> 25:12.260]  либо i, g плюс 1, либо i, plus 1, g.
[25:14.260 --> 25:16.260]  И в каждый момент времени я релаксирую ответ
[25:16.260 --> 25:18.260]  через текущее расстояние, рано или поздно,
[25:18.260 --> 25:20.260]  и найду максимум диаметра.
[25:24.260 --> 25:26.260]  А тут надо еще аккуратненько разобраться со случаем,
[25:26.260 --> 25:29.260]  что бывает, когда у меня нулевое векторное произведение,
[25:30.200 --> 25:32.200]  то есть, когда у меня переключение одновременно происходит.
[25:35.200 --> 25:36.200]  Еще раз?
[25:37.200 --> 25:39.200]  Нет, не поддерживаем, да.
[25:47.200 --> 25:49.200]  Сами прямые нам не нужны.
[25:49.200 --> 25:51.200]  Нам нужно только понимать, кто следующая сторона,
[25:51.200 --> 25:53.200]  а для этого сами прямые не нужны.
[25:53.200 --> 25:55.200]  Значит, итак, единственное, то есть,
[25:55.200 --> 25:57.200]  понятно, что я всегда поддерживаю
[25:58.140 --> 26:00.140]  две точки, находящиеся на наших прямых.
[26:01.140 --> 26:03.140]  И если эти две точки однозначно определены,
[26:03.140 --> 26:05.140]  то есть, у меня касание не по сторонам,
[26:05.140 --> 26:07.140]  а по вершинам, тогда все нормально,
[26:07.140 --> 26:09.140]  тогда я точно иду максимум.
[26:09.140 --> 26:11.140]  Единственная небольшая проблема может быть,
[26:11.140 --> 26:13.140]  если у меня текущая картинка вот такая.
[26:22.140 --> 26:24.140]  Что на прямых лежат по две точки,
[26:25.080 --> 26:27.080]  соответственно, непонятно, кто из них диаметр.
[26:28.080 --> 26:30.080]  На, я проверю.
[26:30.080 --> 26:32.080]  Ну, я как минимум не все пары здесь переберу.
[26:32.080 --> 26:34.080]  То есть, если вот это i и plus 1,
[26:35.080 --> 26:37.080]  g и g plus 1,
[26:37.080 --> 26:39.080]  то я, скажем, сначала учту пару i и g.
[26:40.080 --> 26:42.080]  Так, давайте какой-нибудь цвет возьму.
[26:42.080 --> 26:44.080]  Тут вроде бы бывают м подмилки.
[26:50.080 --> 26:52.080]  Я учту изначально i и g.
[26:53.020 --> 26:55.020]  Потом я вижу, что вектор на произведение
[26:55.020 --> 26:57.020]  вот этих двух векторов...
[26:57.020 --> 26:59.020]  Так, неплохая, sorry.
[27:03.020 --> 27:05.020]  Я учту вот это.
[27:05.020 --> 27:07.020]  Дальше. Я сначала
[27:07.020 --> 27:09.020]  увеличу g,
[27:09.020 --> 27:11.020]  соответственно, учту вот этот вот
[27:11.020 --> 27:13.020]  отрезок, потом
[27:13.020 --> 27:15.020]  увеличу i, соответственно, учту вот этот отрезок.
[27:15.020 --> 27:17.020]  Но в частности, не учту вот это.
[27:17.020 --> 27:19.020]  Из g в i plus 1.
[27:19.020 --> 27:21.020]  Но вот надо показать, что тогда это точно не может
[27:21.960 --> 27:23.960]  Значит, для этого
[27:23.960 --> 27:25.960]  нужна следующая лемма.
[27:27.960 --> 27:29.960]  Пусть
[27:29.960 --> 27:31.960]  a, b, c, d
[27:31.960 --> 27:33.960]  эти четырехугольник
[27:37.960 --> 27:39.960]  с параллельными основаниями a, b, c, d.
[27:43.960 --> 27:45.960]  Причем a, b параллельно c, d. То есть, это либо трапец,
[27:45.960 --> 27:47.960]  либо параллелограмм.
[27:48.960 --> 27:50.960]  Ну, вот тогда я утверждаю,
[27:51.900 --> 27:53.900]  что максимум из диагоналей
[27:53.900 --> 27:55.900]  больше чем максимум из боковых сторон,
[27:55.900 --> 27:57.900]  а значит, я точно иду диаметр.
[27:57.900 --> 27:59.900]  То есть, смотрите, вот у меня как бы
[27:59.900 --> 28:01.900]  считать, что это трапеция, у меня вот
[28:01.900 --> 28:03.900]  основание, вот основание.
[28:03.900 --> 28:05.900]  Я точно учел обе диагонали,
[28:05.900 --> 28:07.900]  но мог не учесть одну из боковых сторон.
[28:07.900 --> 28:09.900]  Если я покажу, что максимум из диагоналейchu Xia
[28:09.900 --> 28:18.060]  больше, чем максимум из боковых сторон,
[28:18.060 --> 28:20.060]  то значит, я ответ translation все равно нашел.
[28:20.060 --> 28:27.840]  Так вот, тогда максимум из диагоналей, то есть, видимо, АС и БД, больше максимум из боковых сторон.
[28:28.920 --> 28:31.800]  То есть, БС и АД.
[28:35.960 --> 28:37.960]  Давайте, трапезу нарисую.
[28:43.800 --> 28:45.800]  Да, АС и БД это диагонали.
[28:46.640 --> 28:50.640]  БС и АД это боковые стороны.
[29:04.400 --> 29:09.420]  Ну, давайте посмотрим на, скажем, боковую сторону АД. Что при ней происходит?
[29:12.080 --> 29:14.740]  Что при ней происходит? Тут есть два кифта угла.
[29:16.460 --> 29:22.020]  Которые в сумме дают 180 градусов, потому что это углы между параллельными прямыми.
[29:22.960 --> 29:27.960]  Вот, значит, один из них точно больше равен 90 градусов. Но давайте скажем тупой. Вот этот угол тупой.
[29:28.480 --> 29:30.480]  Значит, с треугольники АДС
[29:31.560 --> 29:34.800]  сторона АС лежит напротив тупого угла, значит, она точно больше, чем АД.
[29:35.480 --> 29:38.280]  Значит, боковая сторона точно меньше, чем какая-то из диагоналей.
[29:38.920 --> 29:42.000]  Если бы угол был прямой, то то же самое катит меньше, чем гипотенуз.
[29:42.760 --> 29:48.760]  Ну, все, значит, боковая сторона меньше, чем одна из диагоналей, которые соответствуют тупому или прямому углу при
[29:49.800 --> 29:53.640]  одной из вершин концов этой боковой стороны.
[29:56.760 --> 29:58.760]  Один из углов
[30:00.480 --> 30:02.480]  при боковой стороне
[30:02.480 --> 30:12.200]  АД. Тупой или прямой?
[30:15.800 --> 30:18.400]  Следовательно, напротив него в треугольнике лежит наибольшая сторона.
[30:33.240 --> 30:42.000]  Ну, следовательно, АД меньше, чем максимальные из диагоналей АС и БД.
[30:42.000 --> 31:11.680]  Ну, вот, значит, даже вот в этом случае, когда у меня получается трапец или параллелограмм, я все равно,
[31:12.000 --> 31:20.400]  да, то есть у меня как бы опорные прямые вот эти калипперы L1 и L2 я нашел, я перебираю, достаточно перебирать не все пары точек, а только те, которые переведут наш алгоритм.
[31:20.760 --> 31:25.880]  Ну, поэтому как бы диаметр все равно всегда найдется. То есть из этих как бы четырех пар и
[31:26.400 --> 31:31.920]  одна из этих двух, и плюс один, и одна из этих двух, я точно перебираю две, одна из которых точно диаметр.
[31:32.240 --> 31:37.920]  Поэтому можно не париться и никаких дополнительных проверок не делать. То есть можно было бы написать, что если у меня прямые
[31:38.400 --> 31:46.760]  стороны параллельные, то давайте там все четыре отрезка переберем. Можно этого не делать, алгоритм оставить как есть, вот прям вот как там написано без изменений,
[31:46.760 --> 31:50.920]  потому что все равно обе диагонали рассмотрятся, а значит диаметр тоже рассмотрится.
[32:07.920 --> 32:11.920]  Да, чудесно.
[32:21.520 --> 32:23.520]  Значит диаметр оно что нашли.
[32:28.640 --> 32:34.520]  Поедем дальше, давайте нужно будет такое утверждение, давайте даже теоремы сформулирую, нечего делать.
[32:34.520 --> 32:43.480]  Пусть с конечным множеством, со сетой с точек P1 и так далее Pn.
[32:47.840 --> 32:53.360]  Тогда выпуклая комбинация этого множество точек, выпуклая комбинация
[32:57.880 --> 33:03.040]  этого множество точек, это сумма лямбда 1P1 плюс так далее лямбда nPn,
[33:03.960 --> 33:05.960]  где все лямбды не отрицательные, а их сумма единица.
[33:17.200 --> 33:24.560]  То есть это линейная комбинация, где все коэффициенты не отрицательные и при этом сумма равна единице. Так вот тогда я утверждаю,
[33:24.560 --> 33:34.240]  что CONF S, выпуклая блочка множества S, это в точности множество всех возможных выпуклых комбинаций.
[33:35.560 --> 33:41.240]  CONF ADS это то же самое, что все возможные выпуклые комбинации.
[33:45.120 --> 33:49.040]  Выпуклые комбинации точек из S.
[33:55.560 --> 33:57.560]  S конечный множество точек.
[34:04.320 --> 34:07.520]  Выпуклая комбинация, почему? Ну вот
[34:11.720 --> 34:13.720]  все.
[34:17.000 --> 34:24.000]  То есть в каком-то смысле, да, это как бы такая линейная оболочка множества точек, но только с такими хорошими коэффициентами.
[34:25.400 --> 34:27.400]  Ну доказательства.
[34:29.040 --> 34:31.560]  Доказательства. Значит в какую-то сторону вроде бы просто.
[34:33.920 --> 34:37.000]  Вот в такую сторону. Не очень сложно.
[34:38.520 --> 34:40.520]  Значит давайте мы
[34:41.720 --> 34:47.480]  это докажем. Давайте рассмотрим какую-то конкретную выпуклую комбинацию и покажем, почему она лежит в CONF ADS.
[34:48.480 --> 34:55.960]  Значит из этой всей штуки давайте оставим только те, где строго положительные коэффициенты. Те, которые нулевые, все равно не влияют. Давайте их выкинем.
[34:56.320 --> 34:58.320]  Значит так вот. Рассмотрим
[34:59.840 --> 35:02.280]  точку какую-нибудь Q
[35:03.200 --> 35:04.400]  равную
[35:04.400 --> 35:06.400]  лямбда и1 п и1
[35:07.000 --> 35:09.000]  плюс и так далее, плюс лямбда ик
[35:09.680 --> 35:13.680]  п ик. Ну где выполняется, что все лямбды положительные.
[35:14.600 --> 35:17.200]  Все лямбда больше нуля, сумма как обычный единиц.
[35:18.360 --> 35:21.680]  Рассматриваем конкретную выпуклую комбинацию, только выбрасываем из нее нулевые слагаемые.
[35:23.800 --> 35:31.040]  Вот. Ну и давайте индукции пока докажем, то есть индукции по числу слагаемых, докажем, что точка Q лежит в выпуклой оболочке.
[35:33.920 --> 35:40.440]  Индукции пока докажем, что Q лежит в CONF ADS.
[35:44.160 --> 35:46.160]  Ну база Q равную единице тривиально.
[35:47.640 --> 35:48.880]  База
[35:48.880 --> 35:55.120]  Q равную единице. Значит у меня есть только одно слагаемое и поскольку сумма коэффициентов единица, то значит Q просто равно
[35:55.640 --> 35:57.640]  P там и какое-то.
[35:57.640 --> 36:00.360]  P и первое. Это конечно элемент CONF S.
[36:04.640 --> 36:08.720]  Конечно точка множества это элемент в оболочке, ну лежит там.
[36:11.120 --> 36:16.040]  Нет, S это просто множество точек. С это какие-то точки.
[36:18.480 --> 36:26.680]  CONF S это вот это. То есть вот это вот все это CONF S, а S это просто сами точки.
[36:32.160 --> 36:34.520]  Итак, база у нас есть, теперь переход.
[36:35.640 --> 36:37.640]  Переход.
[36:37.800 --> 36:39.800]  Вот рассматриваем какое-то такое Q.
[36:40.360 --> 36:44.600]  Давайте оставим все слагаемые кроме последнего и нормируем эту точку. Давайте рассмотрим,
[36:45.600 --> 36:49.520]  давайте я введу какую-нибудь просто лямбду, как сумму первых
[36:50.920 --> 36:52.920]  k-1 коэффициентов.
[36:53.840 --> 36:55.840]  Вот введем такую лямбду.
[36:57.080 --> 37:03.320]  Дальше введем лямбды штрих. Это исходные лямбды, деленные на лямбду.
[37:11.360 --> 37:13.360]  Ну и давайте точку Q штрих.
[37:14.600 --> 37:18.920]  Введем как сумма штрихованных лямбд на те же самые P.
[37:28.560 --> 37:35.040]  Ну то есть по сути я просто отбросил последнее слагаемое, а первое k-1 так нормировал, чтобы сумма стала единицей.
[37:35.560 --> 37:38.640]  То есть теперь вот эти вот все лямбдочки, они положительны.
[37:39.480 --> 37:43.200]  Их сумма равна единице из-за нормировки на лямбду. Для лямбды как раз их сумма.
[37:44.120 --> 37:47.760]  Ну тогда я знаю, что эта точка лежит в CONVAT-S
[37:48.880 --> 37:54.440]  по предположению индукции, потому что это выпухлая комбинация камень с одной точки. По предположению индукции это лежит в CONVAT-S.
[37:56.240 --> 37:58.320]  Ну и теперь остается сказать, что Q
[37:59.440 --> 38:05.760]  это выпухлая комбинация Q штриха и точки P и K-T. Ну причем видимо с понятными коэффициентами.
[38:05.760 --> 38:07.760]  Сейчас? Нет.
[38:28.120 --> 38:32.600]  Плюс лямбда и K, P и K.
[38:35.880 --> 38:37.880] weise
[38:38.280 --> 38:41.940]  Потому что я еще могу написать, что лямбда это 1-лямбда и K.
[38:42.560 --> 38:46.900]  Потому что это сумма всех кроме последнего. Значит лямбда это вот 1- лямбда и K.
[38:47.900 --> 38:51.920]  Вот. Поэтому то, что здесь написано, это по сути просто лямбда.
[38:53.080 --> 39:01.000]  И когда я q-шнхq, это по сути я просто вот в этой сумме отброшу все знаменатели. То есть я по сути просто получу сумму первых камень с одного слагаемого.
[39:01.000 --> 39:05.500]  Ку штрихом нужно 0.0 лямбда, так а минус 1 первая слагаемая.
[39:05.500 --> 39:08.200]  Ну и добавляю просто последнюю точку, лямбда и ката, и напа и
[39:08.200 --> 39:09.200]  ката.
[39:09.200 --> 39:10.200]  Вот.
[39:10.200 --> 39:12.360]  Ну, смотрите, тогда что у меня есть.
[39:12.360 --> 39:16.760]  У меня есть выпуклая комбинация, поскольку это неотрясательное
[39:16.760 --> 39:20.560]  число суммы 1, выпуклая комбинация двух точек, которые лежат
[39:20.560 --> 39:21.560]  в конватес.
[39:21.560 --> 39:27.800]  То есть, на самом деле, q это какая-то точка на отрезке
[39:27.800 --> 39:29.440]  между двумя точками выпуклой оболочки.
[39:30.420 --> 39:32.620]  Да, но раз эти точки лежат в выпуклой оболочке, то
[39:32.640 --> 39:34.920]  и отрезок между ними целиком лежит внутри выпуклой оболочки,
[39:34.920 --> 39:37.160]  поэтому q тоже лежит в выпуклой оболочке.
[39:39.400 --> 39:44.220]  Давайте напишу, что q штрих запитая по и ката принадлежат
[39:44.220 --> 39:47.280]  конватес, следовательно, отрезок между ними тоже
[39:47.280 --> 39:49.040]  лежит в конватес.
[39:49.040 --> 39:55.600]  Отрезок между ними тоже вложен в конватес.
[39:55.600 --> 40:01.400]  ну и значит q как как раз их выпукла комбинация то есть как некая точка на
[40:01.400 --> 40:08.440]  отрезке тоже лежит в конватес потому что конваты выпуклое множество мы с вами
[40:08.440 --> 40:14.000]  доказывали да что конв как пересечение выпуклых выпукла значит любой отрезок
[40:14.000 --> 40:18.440]  между точками внутри конватес тоже внутри конватес лежит
[40:19.440 --> 40:24.080]  по предпочтению индукции потому что q' является выпуклой комбинацией
[40:24.080 --> 40:27.880]  камень с одной точке исходного множества
[40:29.880 --> 40:34.640]  единица из-за нормировки мы как раз ввели лямбду равную сумме коэффициентов
[40:34.640 --> 40:38.640]  предыдущих поделили их все на лямбду тогда автоматически сумма единицы стала
[40:38.640 --> 40:47.360]  поэтому q' в конватес ok так в одну сторону доказали
[40:48.240 --> 40:51.240]  теперь обратно
[40:59.720 --> 41:06.160]  так обратно почему конвес вложено в множество всех возможных выпуклых
[41:06.160 --> 41:08.680]  комбинаций
[41:18.360 --> 41:22.600]  ну мы с вами более-менее представляем как выглядит конватес это какой-то
[41:22.600 --> 41:29.920]  выпуклый многоугольник вершинами в каких-то точках нашего множества
[41:29.920 --> 41:39.440]  конватес это выпуклый многоугольник выпуклый многоугольник с вершинами в
[41:39.480 --> 41:43.480]  точках множество s
[41:45.720 --> 41:49.720]  но такой выпуклый многоугольник мы можем на самом деле триангулировать
[41:49.720 --> 41:54.240]  триангулировать мы учились две недели назад ну и более того если это выпуклый
[41:54.240 --> 41:56.800]  многоугольник то у него с триангуляцией вообще все просто можно просто взять
[41:56.800 --> 41:59.600]  любую точку провести все диагонали из нее это будет
[42:00.600 --> 42:04.640]  его можно триангулировать
[42:09.640 --> 42:13.580]  его можно триангулировать ну и тогда соответственно если я возьму любую
[42:13.580 --> 42:17.520]  точку из конвес она на самом деле лежит в каком то конкретном
[42:17.520 --> 42:22.620]  треугольнике да вот например она лежит треугольники 아버е она лежит треугольник
[42:22.620 --> 42:25.980]  абc значит если я покажу что точкаежащая в
[42:25.980 --> 42:29.560]  треугольнике получается как выпуклая комбинация его концов его вершин точнее
[42:29.560 --> 42:35.720]  то мы все докажем, потому что любая точка в конвесс лежит автоматически в некотором треугольнике, потому что мы получили
[42:35.840 --> 42:45.120]  треангуляцию, а если это является выпуклой комбинацией вершин abc, то можно просто всем остальным точкам сдать коэффициентную нури и получится выпуклая комбинация всех точек схода множества s.
[42:46.480 --> 42:48.480]  Достаточно доказать,
[42:49.160 --> 42:51.160]  достаточно доказать, что если
[42:51.160 --> 42:53.640]  p лежит в треугольнике abc,
[42:53.800 --> 42:59.480]  то, ну существует, давайте напишем, лямбда 1, лямбда 2, лямбда 3,
[43:01.320 --> 43:06.360]  такие что, это выпуклая комбинация точек abc с такими коэффициентами.
[43:10.360 --> 43:14.560]  Ну понятно, на лямбды требования, как обычно, что они не отрицательные, сумма равна единице.
[43:17.360 --> 43:19.360]  Вот. Ну а это уже
[43:19.440 --> 43:24.960]  можно доказать следующим образом. Значит, пусть с p какая-то точка внутри многоугольника,
[43:26.000 --> 43:29.440]  давайте, например, проведем прямую
[43:30.480 --> 43:32.280]  через c и p.
[43:32.280 --> 43:37.680]  Ну понятно, что если p там, скажем, с c совпадает, то можно просто сказать, что p равно c, а эти коэффициенты нулевые.
[43:37.960 --> 43:42.480]  Иначе можно провести прямую, она где-то пересечет прямую ab в какой-то точке q.
[43:43.240 --> 43:47.680]  Дальше понятно, что q представляется как выпуклая комбинация ab, просто потому что это точка на отрезке.
[43:48.240 --> 43:51.920]  Ну очевидно, что можно просто взять с нужными коэффициентами ah и b, чтобы получить эту точку.
[43:52.220 --> 43:57.200]  Ну и дальше надо сказать, что q это выпуклая комбинация a и b, и нам нужно еще взять точку p
[43:57.880 --> 44:01.180]  на отрезке между q и c. Но если это выпуклая комбинация a и b,
[44:01.200 --> 44:05.160]  то нужно теперь опять с нужными коэффициентами ее взять, и сказать, что п это выпуклая комбинация q и c.
[44:06.280 --> 44:10.820]  Но, давайте не буду подробно писать, я просто напишу, q это выпуклая комбинация
[44:12.160 --> 44:14.160]  и b,
[44:14.240 --> 44:16.160]  а p это выпуклая комбинация
[44:17.680 --> 44:23.400]  Q и C. Ну значит, если я просто вот здесь, в этом представлении
[44:23.400 --> 44:26.680]  Q распишу через A и B, то у меня автоматически получится,
[44:26.680 --> 44:32.800]  что P это выпуклая комбинация A, B и C. Профит.
[44:32.800 --> 44:48.440]  Ну вот, зашибись. То есть у нас есть еще какая-то новая классификация того,
[44:48.440 --> 44:53.680]  что такое выпуклая оболочка. Это все выпуклые комбинации. Довольно полезное понимание.
[44:53.680 --> 45:10.440]  Так, хорошо. Это нам сейчас будет нужно для еще одной задачки. Задача называется
[45:11.440 --> 45:32.400]  Ну, определение. Пусть у нас A и B. Давайте не A и B, давайте M1, M2. Это два многоугольника вместе
[45:32.400 --> 45:38.920]  со внутренностями. То есть это не только граница, но и все, что внутри. Два многоугольника
[45:38.920 --> 45:52.200]  со внутренностями. Значит, тогда их сумма M1 плюс M2, сумма по Минковскому, это просто-напросто
[45:52.200 --> 46:03.800]  все возможные суммы точек П плюс Ку, где П из М1, Ку из М2. То есть взял точку из одного, взял
[46:03.800 --> 46:08.760]  точку из другого, по координатной сложил, то есть по Х, по Y и получил очередную точку из суммы М1
[46:08.760 --> 46:15.800]  плюс М2. То есть, например, если я беру какой-нибудь квадратик и треугольник, складываю, то у меня в
[46:15.800 --> 46:19.840]  результате будет вот эта точка, ну там, например, кого-нибудь перенос будет вот здесь вот, дальше
[46:19.840 --> 46:25.800]  там будет вот это вот все. Ну, короче, не буду рисовать, получится там какая-то фигурка. Вот такая,
[46:25.800 --> 46:30.360]  что, как бы, если я беру любую точку отсюда, любую точку отсюда, то их сумма просто по координатной,
[46:30.360 --> 46:38.760]  это какая-то точка вот этого итогового многоугольника. Ну, соответственно, задача по выпуклым M1, M2 найти их
[46:38.760 --> 46:50.480]  сумму. Найти их сумму Минковского.
[47:08.760 --> 47:22.080]  Так, ну утверждение, что если М1, М2 это выпуклые многоугольники, то эта сумма тоже выпуклые многоугольники.
[47:22.080 --> 47:38.560]  Утверждение, если М1, М2 это выпуклые многоугольники, то М1 плюс М2 тоже выпуклые многоугольники.
[47:38.560 --> 47:52.000]  Причем есть более точно даже классификация, фактиризация точнее, это что М1 плюс М2 это выпуклая
[47:52.000 --> 48:04.360]  оболочка множества сумм всех пар вершин. Значит, я напишу P1 плюс P2, где Pt это вершина
[48:04.360 --> 48:19.040]  этого многоугольника, Pt это вершина Mi. То есть я беру вершину первого многоугольника P1, вершину
[48:19.040 --> 48:24.040]  второго многоугольника P2, складываю их по координатной, ну то есть плюс как обычно у нас там есть оператор
[48:24.040 --> 48:30.160]  плюс, по координатное сложение, все эти точки свалил в кучу множества и взял по этому множеству выпуклая
[48:30.160 --> 48:35.960]  оболочку. Тогда утверждаем, что это в точности сумма М1 плюс М2. Значит, если мы вот это докажем,
[48:35.960 --> 48:40.600]  то мы в частности докажем, что М1 плюс М2 это выпуклый многоугольник, потому что здесь написано
[48:40.600 --> 48:44.400]  выпуклая оболочка конечно множество точек, а выпуклая оболочка конечно множество точек всегда
[48:44.400 --> 48:58.040]  выпуклый многоугольник. Вот, поэтому нам достаточно доказать только это правенство. Так, ну чего? Будем
[48:58.040 --> 49:11.160]  доказывать обе стороны, значит доказываем сразу, доказываем сразу, что М1 плюс М2 равно конв от множества
[49:11.160 --> 49:19.120]  всех пар вершин. Я вот так кратко напишу, да, что все пары вершин складываю и беру вот эту выпуклую оболочку.
[49:19.120 --> 49:35.120]  Так, вложение вот такое сначала, или нет, сейчас, извините, одну секунду. Сображу,
[49:35.120 --> 49:42.000]  что хочу сделать сначала. Наверное, сначала мне надо показать просто выпуклость вот этой штуки,
[49:42.000 --> 49:52.000]  но сначала докажем, что это вот выпукло. Но сначала докажем, что М1 плюс М2 выпукло.
[50:03.280 --> 50:06.240]  Так, может вы мне здесь поможете как доказать, что сумма выпуклых выпуклая?
[50:06.240 --> 50:17.240]  Ну да, давайте я что-нибудь напишу. Что это такое? Это сумма каких-то двух точек,
[50:17.240 --> 50:29.600]  то есть я взял P из М1, Q из М2, беру точку P плюс Q. Сейчас, нет, нет, нет, не совсем, да, не совсем.
[50:29.600 --> 50:45.680]  Я взял P1 из М1, Q1 из М2, P2 из М1 и Q2 из М2. У меня есть точка P1 плюс Q1, у меня есть точка P2
[50:45.680 --> 50:50.440]  плюс Q2, и моя цель доказать, что весь отрезок целиком лежит в М1 плюс М2. То есть я взял
[50:50.440 --> 50:55.280]  конкретные точки, лежащие здесь. Надо показать, что отрезок между ними тоже целиком лежит в М1
[50:55.280 --> 50:59.360]  плюс М2 на определении выпуклости, что если я беру любые две точки отсюда, то отрезок между
[50:59.360 --> 51:08.480]  ними тоже лежит здесь. Вот, ну давайте какую-нибудь точку отсюда возьмем. Что значит, что это точка на
[51:08.480 --> 51:13.240]  отрезке? Это значит, что она является выпуклой комбинацией вот этих двух точек, то есть любая
[51:13.240 --> 51:19.920]  точка отрезка характеризуется как некая лямбда на P1 плюс Q1 плюс 1 минус лямбда на P2 плюс Q2,
[51:19.920 --> 51:30.600]  для не отрицательного лямбда, ну для лямбда от 0 до 1. Мне нужно показать, что вот эта точка
[51:30.600 --> 51:46.320]  лежит в М1 плюс М2. Ну, я точно знаю, что вот такая точка лежит в М1, и вот такая точка лежит в М2.
[51:46.320 --> 51:55.440]  Значит их сумма лежит в М1 плюс М2, и победа. Вот это вот верно, следовательно вот это лежит в М1
[51:55.440 --> 52:00.240]  плюс М2. Просто скобки раскрыли и получили то, что надо.
[52:16.320 --> 52:34.640]  Вопросы есть? Хорошо, тогда продолжаем. Мы доказали, что эта штука выпуклая. Взяли две
[52:34.640 --> 52:38.920]  произволенные точки, отрезок между ними целиком там же лежит. Окей, значит теперь надо показать,
[52:38.920 --> 52:45.560]  что вот здесь равенство. Переходим к равенству, доказываем вот такое вложение слева направо,
[52:45.600 --> 52:54.880]  что любая точка слева лежит справа. Достаточно показать, что любая сумма вершин лежит в М1 плюс М2.
[52:54.880 --> 53:16.960]  Достаточно показать, что если P1 это вершина М1, а P2 это вершина М2, то P1 P2 лежит в М1 плюс М2.
[53:16.960 --> 53:26.760]  Во-первых, это очевидно, что если я беру вершину М1 и вершину М2 и их складываю, то это просто по
[53:26.760 --> 53:32.640]  определению лежит в сумме М1 плюс М2. Это такие точки, что одна из М1, другая из М2, очевидно,
[53:32.640 --> 53:39.880]  ну то есть и их суммы. А если мы это доказали, то получается, смотрите, все элементы вот этого
[53:39.880 --> 53:45.200]  множества, до того как я взял конв, все вот эти суммы лежат в М1 плюс М2. Причем эта штука
[53:45.200 --> 53:49.280]  выпуклая, то есть эта штука это какая-то выпуклая фигура, содержащая все возможные такие суммы.
[53:49.280 --> 53:55.080]  Ну значит в частности она содержит их выпуклую оболочку, потому что если выпуклая фигура содержит
[53:55.080 --> 54:00.160]  все какие-то точки из множества, множество S, пусть это множество S, тогда и выпуклая оболочка
[54:00.160 --> 54:03.160]  она тоже содержит, потому что выпуклая фигура минимальная выпуклая фигура, их все содержащие,
[54:03.160 --> 54:10.840]  а это какая-то их содержащая, да, поэтому это содержит конв. Окей, давайте тоже пропишу.
[54:10.840 --> 54:19.000]  Это само по себе очевидно. Отсюда
[54:19.000 --> 54:38.160]  М1 плюс М2, некая выпуклая фигура, некая выпуклая фигура, содержащая сумму всех вершин, содержащая
[54:38.160 --> 54:47.360]  ну все множество P1 плюс P2, а конв это минимальная выпуклая фигура, поэтому конв вложена в М1 плюс М2,
[54:47.360 --> 55:00.640]  а конв минимальная такая выпуклая фигура. Следовательно конв содержится в М1 плюс М2.
[55:08.160 --> 55:26.840]  Хорошо? Ну в обратную сторону. А почему М1 плюс М2 вложена в окон вот этого безобразия?
[55:26.840 --> 55:40.200]  Так, ну пусть есть какая-то конкретная точка P плюс Q лежащая в М1 плюс М2. В М1 плюс М2 я хочу доказать,
[55:40.200 --> 55:47.360]  что P плюс Q лежит в конв какого-то там безобразия. Смотрите, я сразу написал эту точку в виде суммы
[55:47.360 --> 55:55.240]  двух точек, одна из М1, другая из М2, ну как бы написал ее разбиение в виде суммы, и дальше я
[55:55.240 --> 56:00.520]  могу опять-таки триангулировать оба моих многоугольника М1 и М2 и локализовать точки
[56:00.520 --> 56:05.320]  PQ в каких-то конкретных треугольниках. Сразу могу нарисовать, что P это какая-то точка внутри
[56:05.320 --> 56:11.880]  некоторого многоугольника A1, A2, A3, и это все у меня происходило внутри М1, то есть есть какой-то
[56:11.880 --> 56:17.080]  конкретный треугольник с вершинами в вершинах М1, содержащий точку P, но есть какой-то другой
[56:17.080 --> 56:26.760]  многоугольник с вершинами B1, B2, B3, содержащий Q, и все это происходило в М2. То есть есть некий
[56:26.760 --> 56:37.600]  треугольник с вершинами в вершинах М2, содержащий Q. Дальше я складываю, по плюску складываю.
[56:37.600 --> 56:47.280]  Ну и вот в частности смотрите, у меня вот здесь вот в правой части в конв от безобразия точно
[56:47.280 --> 56:54.960]  лежат все возможные вот эти вот суммы A1 плюс B1, A1 плюс B2, A3 плюс B2 и так далее. Поскольку это
[56:54.960 --> 57:01.080]  были вершины, а в конв как раз лежат всевозможные суммы вершин, суммы паровершин, то здесь точно
[57:01.080 --> 57:11.520]  лежат, тут лежат A1 плюс B1 и так далее, A3 плюс B3. Все возможные попарные суммы вершина слева,
[57:11.520 --> 57:17.200]  вершина справа. Потому что там вообще все пары сумм вершин лежат. Мне надо доказать, что если
[57:17.200 --> 57:26.800]  я складываю два треугольника A1, A2, A3 и B1, B2, B3, так, нет, не так. Я теперь буду показывать,
[57:26.800 --> 57:40.560]  достаточно показать, достаточно показать, что P плюс Q лежит в конв от вот этого множества.
[57:40.560 --> 57:59.960]  Ну потому что вот это, это какое-то подмножество вот этого, ясное дело, то есть я здесь оставил
[57:59.960 --> 58:05.440]  только 9 каких-то точек из всех возможных там NM точек, я оставил только 9 и если я покажу,
[58:05.440 --> 58:09.360]  что P плюс Q лежит в их выпуклой оболочке, то понятное дело, но и в большей выпуклой оболочке
[58:09.360 --> 58:14.200]  тоже лежит. Значит вот осталось показать, что P плюс Q лежит вот в такой вот в этой
[58:14.200 --> 58:23.760]  выпуклой оболочке. Вот, ну а здесь опять вспоминаем наше утверждение про выпуклую комбинации и мы
[58:23.760 --> 58:30.160]  можем расписать P как выпуклую комбинацию A1, A2, A3. Я могу написать, что P это выпуклая комбинация
[58:30.160 --> 58:39.440]  лямбда 1A1, лямбда 2A2, лямбда 3A3, где все лямбды не отрицательные, сумма единица. То же самое с Q.
[58:39.440 --> 58:46.120]  А поскольку Q лежит внутри треугольника, то она представляется в виде выпуклой комбинации точек
[58:46.120 --> 58:52.920]  B1, B2, B3 с коэффициентами мю1, мю2, мю3, в каждых которых не отрицательность, сумма равна единице.
[58:52.920 --> 58:57.840]  А это выпуклая комбинация. Так.
[58:57.840 --> 59:25.040]  Ну да, а дальше давайте рассмотрим такую сумму. Лямбда 1A1, А1 плюс B1,
[59:25.040 --> 59:36.920]  лямбда 1 умножить на mu1, дальше лямбда 1 умножить на mu2, а1 плюс b2, плюс лямбда 1 умножить на mu3,
[59:36.920 --> 59:50.120]  а1 плюс b3, ну плюс и так далее, плюс лямбда 3 умножить на mu3, а3 плюс b3. То есть я вот здесь
[59:50.120 --> 59:58.360]  вот беру точку аи плюс бж и беру ее с коэффициентом лямбда и умножить на muj. Я рассматриваю такую
[59:58.360 --> 01:00:11.520]  штуку, она в точности равна p плюс q, значит еще раз, да, я знаю разложение p и q в выпукловой комбинации
[01:00:11.520 --> 01:00:17.520]  точек а и b, дальше рассматриваю вот такую конкретную выпукловую комбинацию, где вершины, ну как бы
[01:00:17.520 --> 01:00:25.880]  элементы это вершины вот этого множества, элементы этого множества и сумма аи плюс бж берется с коэффициентом
[01:00:25.880 --> 01:00:33.120]  лямбда и умножить на muj. Вот рассматриваю такую конкретную выпукловую комбинацию. Значит, во-первых,
[01:00:33.120 --> 01:00:38.840]  эта сумма в точности равна p плюс q, потому что ну скажем какой коэффициент при аи там, я должен
[01:00:38.840 --> 01:00:44.160]  все это просуммировать по всем ж, да, если я фиксирую аи, то я должен просуммировать это все по всем
[01:00:44.160 --> 01:00:52.920]  ж, у меня будет сумма по muj, сумма по ж muj и получается, что коэффициент при аи как раз будет ровно лямбда и,
[01:00:52.920 --> 01:00:57.400]  потому что если я просуммирую вот эти коэффициенты по всем ж, поскольку у меня сумма muj к этой едице,
[01:00:57.400 --> 01:01:02.000]  то у меня будет коэффициент в точности лямбда и при аи, вот он, то же самое при любом бж, если я
[01:01:02.000 --> 01:01:06.960]  просуммирую все коэффициенты при конкретном бж, то это будет сумма по всем и лямбда и на muj, то есть
[01:01:06.960 --> 01:01:12.360]  просто muj, потому что сумма лямбда единица, значит эта штука в точности по плюс q. С одной стороны, с
[01:01:12.360 --> 01:01:16.960]  другой стороны, это выпуклая комбинация вот этого множества точек, потому что здесь все коэффициенты
[01:01:16.960 --> 01:01:20.400]  очевидно не отрицательные, как произведение отрицательных и сумма у них единица, потому что
[01:01:20.400 --> 01:01:25.160]  это ну и там, я поточечно перемножил два набора суммы единица, можно легко проверить, что сумма,
[01:01:25.160 --> 01:01:33.000]  то есть сумма по и, сумма по ж, лямбда и на muj это единица, значит это выпуклая комбинация. Все,
[01:01:33.000 --> 01:01:38.320]  тем самым мы показали, что p-plus q представляется как выпуклая комбинация вот этих точек, но мы знаем,
[01:01:38.320 --> 01:01:42.480]  что все, что представляется как выблококомминация точек, это в точности элементы выпуклооболочки,
[01:01:42.480 --> 01:02:03.280]  поэтому p-plus-q лежит в конв от этого безобразия. Доказали все. Да, давайте. Вот это, да, все? Ну,
[01:02:03.280 --> 01:02:09.560]  значит, смотрите, нам осталось доказать, что p-plus-q принадлежит какой-то выпуклооболочке a1
[01:02:09.560 --> 01:02:14.440]  плюс b1, a1 плюс b2, короче, все возможные a плюс все возможные b. Но при этом мы знаем,
[01:02:14.440 --> 01:02:19.800]  что p и q это какие-то элементы внутри треугольников. p внутри треугольника a-шек, q внутри
[01:02:19.800 --> 01:02:24.160]  треугольника b-шек. Поэтому точно у них есть некие выпуклые представления вот такие. Дальше
[01:02:24.160 --> 01:02:29.880]  рассматриваем вот такую конкретную сумму, где слагаемое a и plus b-жи взято с коэффициентом
[01:02:29.880 --> 01:02:36.320]  λi умножить на межи. Вот такую сумму по всем i от 1 до 3, по всем g от 1 до 3. Здесь будет 9
[01:02:36.320 --> 01:02:44.000]  слагаемых. Но если мы аккуратно все просуммируем, то мы получим в точности p-plus-q. Почему? Потому
[01:02:44.000 --> 01:02:49.800]  что если я посмотрю на все коэффициенты при a и там, то это будет сумма по всем g лямда и умножить на
[01:02:49.800 --> 01:02:57.160]  межи. А это в точности лямда и, потому что сумма всех межи это единица. Да, значит, коэффициент при
[01:02:57.160 --> 01:03:02.840]  a и это в точности лямда и. Просто я все просуммирую по всем g, у меня получится, что вот эта штука единица
[01:03:02.840 --> 01:03:08.040]  дает. Поэтому коэффициент при a и там ровно такой, какой нужно. Коэффициент при b-жи там тоже такой,
[01:03:08.040 --> 01:03:11.800]  какой нужно, потому что если вы просуммируете вот это по всем i от 1 до 3, то у вас все лямды
[01:03:11.800 --> 01:03:17.680]  сократятся в единицу. Поэтому коэффициент при b-жи будет с точностью межи. Значит, здесь получу
[01:03:17.680 --> 01:03:23.320]  sp-plus-q. С одной стороны. С другой стороны, эта штука это на самом деле выпуклая комбинация вот этих
[01:03:23.320 --> 01:03:28.120]  девяти точек. Потому что здесь все коэффициенты не отрицательны. Все вот эти произведения не
[01:03:28.120 --> 01:03:32.600]  отрицательны, как произведения отрицательных. И более того их сумма единицы, потому что сумма
[01:03:32.600 --> 01:03:38.880]  по всем i, сумма по всем g, лямда и межи это единица. Вот. Ну там, как вы перемножаете поточенно два
[01:03:38.880 --> 01:03:45.360]  набора с суммой 1, получается тоже набор с суммой 1. Итого, мы показали, что sp-plus-q равно некоторой
[01:03:45.360 --> 01:03:51.440]  выпуклой комбинации вот этих девяти точек. А значит, по доказанной теореме она лежит в
[01:03:51.440 --> 01:03:56.960]  выпуклой оболочке. Потому что выпуклая оболочка — это в точности все выпуклые комбинации. Доказали.
[01:04:10.360 --> 01:04:15.520]  Ага. Ну смотрите, что у нас здесь написано. Здесь написано сумма по всем i, сумма по всем g,
[01:04:15.520 --> 01:04:23.640]  лямда i умножить на межи, умножить на аи плюс бж. Да, что такое коэффициент при аи? Ну у нас i тогда
[01:04:23.640 --> 01:04:29.920]  фиксировано получается, а g любой от 1 до 3. Если мы просуммируем по всем g от 1 до 3, то у нас
[01:04:29.920 --> 01:04:35.000]  получится лямда i на сумму межишек. Но мы знаем, что сумма межишек — это единица, потому что это
[01:04:35.000 --> 01:04:46.660]  коэффициент выпуклой комбинации. Так, ну теперь мы доказали, наконец, вот то самое движение,
[01:04:46.660 --> 01:04:53.920]  которое хотели, что сумма — это кон всех возможных сумм вершин. Вершины из одного, вершины из другого.
[01:04:53.920 --> 01:05:06.480]  Так. Ну и теперь мы готовы к тому, чтобы написать алгоритм нахождения суммы Минковского.
[01:05:06.480 --> 01:05:22.160]  Суммы Минковского. Алгоритм такой. Значит, мы поняли, что нам по сути достаточно построить
[01:05:22.160 --> 01:05:26.640]  выпуклооболочку вот такого множества точек. Вершины одного плюс вершины из другого. И по всем
[01:05:26.640 --> 01:05:35.160]  возможным вот таким парам построить выпуклооболочку. Ну смотрите, начало следующее. Вот есть два каких-то
[01:05:35.160 --> 01:05:42.720]  там многоугольника. M1, M2. Начало, наше любимое, мы выбираем точку с минимальным х среди таких
[01:05:42.720 --> 01:05:49.680]  с минимальным y в обоих многоугольниках. Давайте это какой-нибудь не знаю, там p1, p2 напишу. Тогда
[01:05:49.680 --> 01:05:58.280]  понятно, что их сумма — это вершина результатов. p1, p2 — это вершина. Ну потому что, как обычно,
[01:05:58.280 --> 01:06:07.120]  нет точек слева и ниже этих точек. То есть вот здесь ничего нету. И при этом p1, p2 лежит в
[01:06:07.120 --> 01:06:11.600]  сумме Минковского. Ну тогда это обязательно вершина, потому что здесь нет никого левее,
[01:06:11.600 --> 01:06:16.000]  нет никого ниже. Потому что, чтобы получить точку левее, мне нужно, чтобы, по крайней мере,
[01:06:16.000 --> 01:06:21.240]  один из х был меньше. Ну а здесь никого нет, здесь никого нет, поэтому в результате здесь тоже
[01:06:21.240 --> 01:06:25.160]  левее никого не будет. И ниже тоже никого не будет, потому что нужно иметь точку ниже,
[01:06:25.160 --> 01:06:34.680]  чем p1 или p2. Значит, p1, p2 — точка вершины. А дальше мы будем делать следующее. Мы будем
[01:06:34.680 --> 01:06:44.640]  поддерживать опять два указателя. Давайте здесь и здесь g. Строить векторы, совпадающие с очередной
[01:06:44.640 --> 01:06:48.680]  стороной. То есть мы обходим наши оба многоугольника опять, против чего стрелки,
[01:06:48.680 --> 01:06:55.960]  поддерживаем текущую сторону. Вот куда ведет текущая сторона — храним вектор. Из этих двух
[01:06:55.960 --> 01:07:03.000]  векторов выбираем наименее крутой, то есть тот, который меньше всего отклоняется от текущего
[01:07:03.000 --> 01:07:07.880]  направления. Из этих двух я нарисую сначала вот это. То есть, по сути, это как если бы я вращал
[01:07:07.880 --> 01:07:12.160]  калипперы. Вот такие вертикальные калипперы сюда подложил. Дальше начинаю их поворачивать.
[01:07:12.160 --> 01:07:17.840]  Сначала происходит натыкание вот на эту сторону. Значит, я ее сначала рисую. То есть,
[01:07:17.840 --> 01:07:24.240]  я просто беру вот этот вектор, здесь рисую. И теперь этот указатель двигает сюда. Соответственно,
[01:07:24.240 --> 01:07:28.800]  у меня выделяется вот эта сторона. Теперь у меня есть два вектора — этот и этот. Я понимаю,
[01:07:28.800 --> 01:07:33.960]  что из них менее крутой это вот этот. То есть, если я продолжаю вращать наши прямые вот так вот,
[01:07:33.960 --> 01:07:38.240]  то у меня сначала я натыкаюсь на этот горизонтальный вектор. Поэтому я его рисую
[01:07:38.240 --> 01:07:43.880]  следующим. Переключаю здесь на вертикальный. Теперь есть такой вектор и такой. Из них менее
[01:07:43.880 --> 01:07:51.320]  крутой вот этот. Я его рисую. Потом переключаю эту сторону на вот эту. Потом там два вертикальных.
[01:07:51.320 --> 01:07:56.280]  Давайте их как-нибудь одновременно нарисуем вот так. Дальше есть такой вектор, такой вектор. Из
[01:07:56.280 --> 01:08:01.440]  них на менее крутой это вот этот. Я его там нарисую. Ну и так далее. То есть, я просто иду
[01:08:01.440 --> 01:08:08.160]  указателями по обоим многоугольникам и рисую очередную сторону, которая имеет
[01:08:08.160 --> 01:08:25.200]  меньший угол. Ну давайте еще что-нибудь напишем. И это самая левая точка в М1,
[01:08:25.200 --> 01:08:38.880]  G это самая левая точка в М2. Ну и пусть вот здесь у меня, пусть это будут пэшки, это будут кушки.
[01:08:38.880 --> 01:08:48.720]  Значит, тогда я смотрю на очередные вот эти вот векторы. И если кросс,
[01:08:48.720 --> 01:09:03.520]  если векторное произведение P i P i плюс 1 запитаю q j q j плюс 1. Вот здесь у меня,
[01:09:03.520 --> 01:09:09.560]  ну давайте я сделаю так. Больше равно нуля. Тогда я сначала прикладываю вектор P i P i плюс 1.
[01:09:09.560 --> 01:09:21.360]  Тогда прикладываем вектор P i P i плюс 1 и делаем плюс плюс i. А иначе мы, наоборот,
[01:09:21.360 --> 01:09:32.520]  прикладываем вторую сторону и делаем плюс плюс j. Иначе прикладываем q j q j плюс 1 и делаем
[01:09:32.520 --> 01:09:44.280]  плюс плюс j. Ну и все так пока оба многоугольника не обойдем. Значит, очень, ну окей, не очень,
[01:09:44.280 --> 01:09:49.120]  но в общем весьма похожий алгоритм на предыдущий. То есть мы опять идем двумя указателями, только
[01:09:49.120 --> 01:09:54.960]  теперь в нашем случае по двум разным многоугольникам. У нас есть два кандидата, мы выписываем из них,
[01:09:54.960 --> 01:10:00.360]  то есть ну прям кладем, добиваем к текущей точке, кладем в сторону следующую, ту, которая из них
[01:10:00.360 --> 01:10:07.360]  менее-менее крутая, то есть та, которая ближе к текущему направлению вращающейся прямой. Вот было
[01:10:07.360 --> 01:10:13.640]  как-то вот так. Тот, кто наступает раньше, в этом случае вот это, того мы и печатаем и сдвигаемся
[01:10:13.640 --> 01:10:19.400]  указателем на следующий. И так пока все не обойдем. В конце у меня будет там какая-то вот такая вот
[01:10:19.400 --> 01:10:27.160]  фигурка. Мы обязательно замкнемся, ну как минимум потому, что сумма этих векторов 0, поэтому мы рано
[01:10:27.160 --> 01:10:34.880]  или поздно точно попадем туда, откуда начали. Так, ну и теперь осталось понять, почему это корректный алгоритм.
[01:10:57.760 --> 01:11:04.680]  Почему это корректно? Ну скажем так, начало точно корректно, вот эту точку мы точно поставили
[01:11:04.680 --> 01:11:10.680]  правильно, потому что, ну я уже обговорил, да, левее и ниже этой точки никого нет, значит это
[01:11:10.680 --> 01:11:15.160]  гарантированная вершина. Ну вот пусть скажем как-то нам так повезло, что несколько первых сторон мы
[01:11:15.160 --> 01:11:19.600]  поставили правильно. Давайте рассмотрим первое место, когда мы поставили неправильную сторону,
[01:11:19.600 --> 01:11:29.720]  то есть так опять возьму цветные мелки. Давайте рыжие это то, что мы ставим, а зеленое то,
[01:11:29.720 --> 01:11:36.760]  что правильно. Мы вот так вот как-то поставили. Начало было правильным, то есть мы первые
[01:11:36.760 --> 01:11:41.160]  несколько сторон поставили правильно, а дальше пошли неправильно, дальше следующий вектор это
[01:11:41.160 --> 01:11:45.480]  неправильная сторона, вот найдем первую такую неправильную. Ну понятно, что вот такого быть не
[01:11:45.480 --> 01:11:53.480]  могло, потому что если правильная сторона как бы лежит внутри, да, то есть по отношению с той,
[01:11:53.480 --> 01:11:57.800]  которую мы поставили, лежит как бы более внутри, то значит мы как будто нарисовали какие-то точки,
[01:11:57.800 --> 01:12:02.560]  которые на самом деле не лежат в сумме Минковского. Но такого точно быть не могло, потому что мы
[01:12:02.560 --> 01:12:06.680]  рисуем только правильные точки. То, что мы рисуем, гарантированно вложено в сумму Минковского,
[01:12:06.680 --> 01:12:13.280]  потому что то, что мы рисуем, это всегда суммы каких-то вершин. То, что я нарисовал, да, вот граница,
[01:12:13.280 --> 01:12:17.800]  граница это всегда сумма вершин каких-то, потому что, ну то есть как вот это получено, это получено,
[01:12:17.800 --> 01:12:22.040]  как там, ну сумма каких-то точек. Дальше я к этой точке прикладываю еще некий другой вектор,
[01:12:22.040 --> 01:12:26.040]  ну сторону по сути прикладываю, то есть у меня была точка, я к ней прикладываю еще какую-то
[01:12:26.040 --> 01:12:31.920]  сторону. Понятно, что это точно лежит в буквы оболочки, поэтому такого быть не может, такого быть не
[01:12:31.920 --> 01:12:53.040]  может, так как строимый многоугольник точно вложен в сумму Минковского, точно вложен в М1 плюс М2.
[01:12:53.040 --> 01:12:58.320]  То, что мы получаем, всегда это какие-то, ну реально, точки, являющиеся суммами каких-то
[01:12:58.320 --> 01:13:05.480]  точек исходных многоугольников, поэтому лишнего мы ничего построить не могли. Ну теперь, наоборот,
[01:13:05.480 --> 01:13:11.560]  в случае, что мы чего-то не добрали, то есть поначалу у нас было правильное, а дальше в продолжении
[01:13:11.560 --> 01:13:18.840]  какое-то вот такое, то есть мы берем что-то, то есть мы чего-то не берем, мы чего-то не берем,
[01:13:18.840 --> 01:13:28.680]  мы чего-то не берем, что должны были. Ну давайте соображать, значит, вот эта точка это какой-то
[01:13:28.680 --> 01:13:36.280]  П плюс Ку, давайте я их нарисую, П вот Ку, это соответственно было в М1, это было в М2,
[01:13:36.280 --> 01:13:46.160]  1 это было в М2, вот, значит, следующая сторона, которую я взял, это один из этих двух векторов,
[01:13:46.160 --> 01:13:50.840]  мой алгоритм так работает, что если у меня вот этот П плюс Ку, то дальше я смотрю на этих, на эти два
[01:13:50.840 --> 01:13:56.000]  вектора, исходящие из них, беру тот из них, который, ну, менее крутой, то есть более всего наклонен,
[01:13:56.000 --> 01:14:03.960]  вот, и его рисую, то есть, по сути, вот этот оранжевый совпадает вот с этим, а этот завернут по часовой
[01:14:03.960 --> 01:14:08.040]  стоилке по сравнению с тем, который я взял, потому что кросс между ними там какой-то определенки,
[01:14:08.040 --> 01:14:17.760]  вот, хорошо, ну, давайте тогда докажем на самом деле, что локально, значит, у меня весь
[01:14:17.760 --> 01:14:23.600]  наугольник, на самом деле, должен длиться вот здесь вот, то есть, в этом угле, и никак выходить из этого угла он не может.
[01:14:23.600 --> 01:14:42.080]  Так, ну, давайте я скажу, что это пусть какая точка Р1 плюс Р2, там х плюс у, тут х, тут у, то есть,
[01:14:42.080 --> 01:14:47.960]  понятно проблема, что я взял как бы экстремальное продолжение, вот это вот рыженькое, а мне говорят,
[01:14:47.960 --> 01:14:52.600]  что есть какое-то еще более экстремальное, которое откуда-то взялось, ну, откуда-то из космоса, ну,
[01:14:52.600 --> 01:14:58.800]  пусть вот это х плюс у, у, то есть, получается, что, смотрите, у меня вот это вот, это вот,
[01:14:58.800 --> 01:15:05.880]  это оранжевый вектор, а здесь я как бы мог приложить вместо того, чтобы, значит, вместо вот этого оранжевого
[01:15:05.880 --> 01:15:11.640]  вектора я мог взять вот такой вектор и вот такой, и приложить их вот сюда, их сумма получилась бы вот
[01:15:11.640 --> 01:15:17.800]  этот зеленый вектор, вот, но такого быть не может, потому что, смотрите, я могу написать следующее,
[01:15:17.800 --> 01:15:26.120]  так, нужно кинуть еще буквы, пусть это будет п штрих, будет ку штрих, нет, давайте просто я назову
[01:15:26.120 --> 01:15:35.040]  рыжий вектор, вектором у, вот это у, значит, тогда, поскольку х лежит внутри выпуклом
[01:15:35.040 --> 01:15:41.920]  многоугольника, ну или на границе, то я точно могу написать, что векторное произвление пх на у у меня
[01:15:41.920 --> 01:15:50.240]  получается неположительно, потому что здесь вращение по часовой стрелке, да, это, значит,
[01:15:50.240 --> 01:15:56.120]  какая-то, ну, следующая сторона, х какая-то внутренняя точка, вращение от внутренней точки до
[01:15:56.120 --> 01:16:02.160]  следующей стороны у нас идет по часовой стрелке, поэтому здесь значок не больше нуля, более того,
[01:16:02.160 --> 01:16:08.280]  я могу написать то же самое для вектора ку у и вектора у, потому что если бы я нарисовал вектор
[01:16:08.280 --> 01:16:14.000]  вот этот вот оранжевый со стартом в ку, то он был бы еще более крутой, чем сторона многоугольника,
[01:16:14.000 --> 01:16:19.320]  а значит направление поворота опять-таки у меня идет по часовой стрелке, поэтому здесь у меня
[01:16:19.320 --> 01:16:35.960]  вектор напряжения опять неположительный, вот, ну и дальше, дальше, потому что у меня вектор
[01:16:35.960 --> 01:16:47.280]  напряжения линейно, я могу написать, что пх плюс ку у на у неположительно, а значит, на самом деле,
[01:16:47.280 --> 01:16:55.840]  вот этот вот поворот от п плюс ку до х плюс у до вектора у, он идет у нас в направлении по
[01:16:55.840 --> 01:17:01.440]  часовой стрелке, поэтому зеленая стрелочка от п плюс ку до х плюс у не может торчать правее,
[01:17:01.440 --> 01:17:14.240]  чем вектор у, а значит, у меня обязательно, если есть вектор между п плюс ку и х плюс у, то он
[01:17:14.240 --> 01:17:22.080]  находится как бы левее, чем у, потому что вот здесь направление поворота по часовой, ну все,
[01:17:22.080 --> 01:17:27.680]  а значит, он не может вытарчиваться куда-то справа, потому что здесь, наоборот, у меня поворот
[01:17:27.680 --> 01:17:33.640]  по часовой, вот здесь против, то есть по неравенству он может быть по часовой, а здесь, по картинке,
[01:17:33.640 --> 01:17:58.240]  против, значит, такого не бывает, противоречие. Ну как-то так.
[01:18:03.640 --> 01:18:16.680]  Значит, напоследок скажу, зачем это может быть нужно, зачем нужно искать сумму Минковского,
[01:18:16.680 --> 01:18:27.760]  значит, задача один, это проверить, пересекаются ли два многоугольника, проверить, пересекаются ли
[01:18:27.760 --> 01:18:42.400]  два многоугольника. Значит, это решается просто, если есть два многоугольника М и М2, то можем
[01:18:42.400 --> 01:18:50.360]  построить их разность Минковского, то есть, по сути, сумму с отзеркалином относительно нуля вторым,
[01:18:50.360 --> 01:18:57.320]  и проверить, лежит ли там ноль, там лежит ноль, если и только если есть одинаковые точки в М1 и М2,
[01:18:57.320 --> 01:19:13.560]  так, сейчас, один момент.
[01:19:13.560 --> 01:19:29.280]  Да, ну и здесь же, можно научиться находить расстояние между двумя выпуклыми многоугольниками,
[01:19:29.280 --> 01:19:46.520]  расстояние между выпуклыми М1 и М2, ну здесь можно опять построить разность Минковского этих
[01:19:46.520 --> 01:19:51.960]  многоугольников и найти точку, ну что такое расстояние здесь, это как раз эвклидова норма
[01:19:51.960 --> 01:19:57.560]  какой-то точки отсюда, значит, нужно просто в этом многоугольнике найти точку с минимальной
[01:19:57.560 --> 01:20:06.120]  эвкидовой нормой, то есть, ближайшую к нулю просто, здесь ноль, вот есть наш страшный многоугольник равный
[01:20:06.120 --> 01:20:15.040]  разности М1-М2, надо найти ближайшую к нулю точку этого многоугольника, найти ближайшую к нулю
[01:20:15.040 --> 01:20:28.560]  точку М1-М2, но это уже гораздо более простая задача, вот, всего, спасибо.
