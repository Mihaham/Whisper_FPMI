Ну все, теперь 11.15, поэтому я имею полное право начать.
Ну, я не знал, как сложится жизнь, с другой стороны, на меня вы видели, валили какие-то звонки и письма,
поэтому совершенно нормально, что я начну сегодня именно в 11.15, но, как вы, наверное, уже знаете,
хотя не факт, я решил заранее учесть еще некоторые теряющиеся лекции, а именно четвертого у нас
праздничек, но это ладно. А еще 18-го день рождения МФТИ, 75 лет, и по этому случаю всех директоров
вытаскивают на какое-то крупное празднование в центре Москвы, скорее всего, лекций никаких не
будет. Соответственно, если вы еще об этом не знали, то в этот понедельник у нас лекции. Знали,
нет? Но поздравляю вас с этим новым знанием. Вот это, кстати, нехорошо. Да, они что, ждут, что я, что ли,
буду сообщать или они непосредственно перед мероприятием? Спасибо, что сказал. Самому себе
спасибо говорю. Нет, я имею в виду спасибо, что я теперь понимаю, что надо вас известить в официальном
порядке. Вот, ладно, давайте займемся комбинаторикой. Сегодня в нашу комбинаторику немножко проникнет
теория чисел, потому что я начну рассказывать такую замечательную тему, которая называется
обращение мебиуса. Ну, может, кто-то слышал про это дело, кто-то нет, но большинство скорее нет,
чем да. Но фамилию мебиус я уверен, что слышали все. Так вот, мебиус тот самый, который лист,
но только обращение, это не про лист, это про некую комбинаторику с теорией чисел. Вот,
ну давайте я задачу поставлю, совершенно комбинаторную, а дальше уже буду рассказывать те инструменты,
с помощью которых она решается. Вот, а потом будет, в общем, очень интересное обобщение всего этого
дела. Значит, задача такая, у нас есть множество каких-то объектов, давайте в данном контексте я
его буду называть алфавитом, но это просто какое-то множество объектов, скажем, B1 и так далее,
B, R, но в кавычках алфавит. Мы хотим составлять, как обычно, слова из букв этого алфавита.
Раз это называется алфавитом, то, наверное, мы хотим делать какие-то размещения, возможно,
с повторениями. Вот, давайте зафиксируем длину этих слов, длину этих слов. Какое-то натуральное
число N, оно может никак не соотноситься с R, может быть больше, может быть меньше, может быть равно,
как хотите. В общем, есть R букв и есть какое-то число N, никак с их количеством не связано. Нас
интересуют слова, которые можно составить из этих букв, но слова не обычные, а циклические. Сейчас
я скажу, что это такое, не пугайтесь. Что такое слово обычное, это вы понимаете, вот я его написал.
Правда, кого-то может кокнуть, тут вроде буквы B, а тут буквы А, но я надеюсь, что мы здесь находимся
в такой аудитории, что кого-то кого кокает это мало, но буквками А обозначены некоторые
буквки из B. Для любого И АИТ принадлежит X, при этом они могут совпадать, они могут не совпадать,
это размещение с повторениями, это обычное слово. Давайте в этом контексте называть его не
размещением с повторениями, а называть его линейным словом. В очередь выстроены какие-то
буквки, получается линейное слово. Его еще можно так, чисто геометрически для красоты изобразить
следующим образом. Написывали точечку, поставили буковку, дальше взяли стрелочку, снова буковка
и так далее. Вот тут будет АН-1 и тут будет АН. Такое вот линейное слово, упорядоченное, понятно,
здесь это просто подчеркнуто. Циклическим словом называется вот такая вот конструкция,
добавили еще одну стрелочку. То есть циклическое слово это класс эквивалентных линейных слов,
если хотите. Ну давайте, просто на картинке все понятно. Вот так вот я буду это обозначать,
А1, А2 и так далее, АН, добавляя скобочки и подчеркивая, что это слово уже зациклено,
то есть мы его расположили как бы в вершинах такого геометрического цикла, в вершинах такого,
если хотите, многоугольника. Так, дорогие товарищи, темп очень высокий. Так, ну все-таки,
чтобы всем было хорошо, давайте какой-нибудь пример. Я когда-то это рассказывал биологам,
поэтому я решил, что я буду в качестве примера брать буковки, которые похожи на химические
символы. СОХ, это у нас R равняется 3, а N, скажем, равняется 4. Вот может быть такое
слово замечательное, сосн или СОЦХ, как вам больше нравится. Но химию мы давно извели с ФПМИ,
вы даже не знаете, что она когда-то была, и это большое счастье, конечно, что вы этого не знаете,
поэтому можете считать, что это кусочек от слова сосна. Ну не сходится, виноват,
очень виноват. Видите, как вот есть понимающие люди. Вот если мы теперь эти буковки расположим
именно в вершинах такого многоугольника, ну скажем, вот так СОЦХ, то нам совершенно неважно,
как прочесть СОЦХ или ОЦХЦ. Вот такие вот циклические слова одинаковые СОЦХЦО и, соответственно,
СОЦ. Ну вот если такой пример привести, то я надеюсь, уже всем понятно, что происходит. Но при
этом СОЦХ, видите, какое замечательное слово, оно порождает целых четыре одинаковых циклических,
то есть четыре разных линейных слова дают одно и то же циклическое слово. А если вы возьмете вот
такое замечательное СОСО, то оно породит только два совпадающих циклических, и дальше начнут
повторяться по циклу. Понятно? Ну есть еще совсем смешное слово СССС, которое сразу само в себя
переходит, и дальше делать нечего. Вот, ну вопрос сразу следующий. Чему равняется количество всех
возможных циклических слов длины N над алфавитом из R букв? Вот так обозначаем количество всех
циклических слов вот с этими условиями. Ну если кто-то из вас все-таки это знает по каким-то
причинам, конечно, не раскрывайте нам секрет, потому что, скорее всего, мы сегодня даже это не
посчитаем. Там есть разные подходы к этому снаряду, но мы будем заниматься сейчас именно обращением
мебиуса. Так, ну еще раз, мебиус тот самый, и, конечно, не его мы будем обращать в какую-то веру,
а он придумал некую теорему, которая позволяет обращать функции в некотором смысле. Так, дорогие
друзья, давайте я сделаю небольшое лирическое отступление в теорию чисел, потому что мне это
потребуется для решения задачи. Понятно ли поставленная задача? Почему она нетривиально
решается? Давайте я все-таки скажу. Вот обычные линейные слова, их, конечно, R в степени N. Это
совершенно понятно. Это размещение с повторениями, да? Всем понятно. Вот, но проблема заключается в
том, что, видите, CO CH дает четыре разных линейных слова, из которых получается одно и то же циклическое,
CO CH дает два разных линейных слова, из которых получается одно циклическое, а CCCC только одно. То есть
мы не можем вот это R в степени N тупо на что-то разделить. Мы не знаем, на что делить, то ли на 4,
то ли на 2, то ли вообще на 1. То есть надо как-то разбить вот это R в степени N на кусочки, и в каждом
кусочке по-своему как бы разделить. Да, можно подумать как. Но я вам расскажу как. Можно по-разному,
еще раз повторяю, к этому подходить. Но давайте я расскажу вот такую замечательную теорию,
которая называется обращение миобиуса. Так, на звонки не обращаем внимание. Она шире, чем то,
что я расскажу именно сейчас. И в понедельник, когда, о ужас, вам придется собраться и слушать
мои лекции, но виноват. Я постараюсь очень весело. Прям так, чтобы было весело, как никогда.
Вот. Значит, шире теория. То есть я расскажу сейчас теоретику числовую ее составляющую,
а в понедельник я буду рассказывать более общую, очень такую нетривиальную, интересную историю. В общем,
о чем идет речь? Давайте, прежде всего, вспомним, что бывают на свете простые числа. Ну, что такое
п-простое все, конечно, знают, но некоторые и не знают, что п не равно единице. Я очень надеюсь,
что это вас не шокирует. Значит, простое число это двойка, тройка, пятерка, семерка и так далее,
но ни единица ни в коем случае. Почему это ни единица? Потому что есть основная теория
арифметики, которая является вообще действительно таким краеугольным камнем, из которой вырастает теория
чисел. Основная теория арифметики. Я думаю, что среди вас есть люди, которые изучали ее в каких-нибудь
листочках в восьмом классе. Вот. Поэтому я ее сейчас сформулирую и доказывать не буду ни сейчас,
ни потом, когда мы начнем заниматься конкретно теорией чисел, но на семинарах это сделают. На семинарах
это сделают, то есть вы должны будете в итоге знать доказательства. Вот. Но это великое утверждение,
очень, казалось бы, простое. Для любого n больше либо равного двойке, натуральное число, существуют
такие различные простые p1, ps. Различные простые. И существуют такие натуральные а1, аs. Но здесь
Мусатов вас учил, наверное, что ноль это тоже натуральное число. Поэтому чтобы вас обратно отучивать
от этого надо написать минус ноль. Эти натуральные числа не равны нулю, они в школьном смысле натуральные,
конечно, такие, что n представляется в виде p1 в степени а1 умножить-умножить ps в степени аs.
Ну то есть существует такое разложение n в произведение степеней простых чисел. Это первый
как бы пункт теоремы и второй пункт. Такое разложение единственно. Ну с точностью, конечно,
до перестановки сомножителей. Такое разложение единственно. Я, наверное, не буду тратить время,
рассказывая анекдот про ферматиста, будет жалко потерять его сейчас. Но если у вас останется
желание, то в понедельник можно будет, в частности, веселую программу усилить анекдотом про ферматист.
Развлекательную программу. В общем, друзья, поднимите, пожалуйста, руки, кто это утверждение хотя бы
слышал когда-нибудь. Шикарно, шикарно. А кто слышал анекдот? О, да фига. Ну тогда посмотрим,
может я и не буду его рассказывать, но сейчас точно не буду, иначе мы зря потеряем время. Но это
прекрасная была история, я прям не могу, из меня она каждый раз вперед. Ну ладно,
значит, основная теорема арифметики такая, и это нам позвать, да, что я хочу сказать. Вот это
разложение называется каноническим. Каноническое разложение. Каноническое. Ну каноническое,
потому что другого такого нет, оно каноническое. Так вот, наличие канонического разложения,
то есть справедливость основной теоремы арифметики, позволяет определить функцию мебиуса.
Функция мебиуса, она обозначается μ от n, n это натуральный аргумент, опять же без нуля. Так,
и определяется она следующим образом. Это единица, если n равно 1, это вырожденный случай,
когда нет канонического разложения. Ну если n равно 1, теорема, конечно, не верна. Единица
не является простым числом, и, кстати, понятно, почему не является, иначе не было бы единственности,
если бы она являлась. Вот, ну так, просто полагаем равной единице и все. Дальше полагаем равной
минус 1 v, если n это p1 в степени 1, умножить и так далее на ps в степени 1, то есть если в каноническом
разложении все альфы равны единице, тогда вот так. И это ноль во всех остальных случаях. Ну то есть
если в каноническом разложении существует такое и, что альфы и т больше либо равняются двойке,
если число делится на полный квадрат какого-то содержательного числа, то mu равно нулю по
определению. Скорость нормальная? Нормальная. Вот такая вот хитрая функция, зачем она нужна,
это пока совершенно непонятно. А я скоро расскажу. Так. Замечательное свойство этой функции состоит в
следующем. Как ни странно, многие не знают смысл вот этого обозначения. Это обозначение читается,
как d делит n, то есть число d является делителем числа n. Со школы многие выносят вот такое
симметричное обозначение n делится на d. Но это то же самое, только в обратную сторону. Здесь
пишется свойство n, состоящее в том, что оно делится на d, а здесь пишется свойство d,
состоящее в том, что d является делителем n. Ну понятно, что это одно и то же, конечно. Вот я буду
использовать это обозначение. Хорошо? Теперь, если я пишу вот так вот, то я подразумеваю,
что я перебираю все делители числа n, для каждого вычисляю f и складываю. Ну, например, сумма по
делителям числа 12 mu от d, это mu от единицы плюс mu от двойки, плюс mu от тройки, плюс mu от четверки,
плюс mu от шестерки, плюс mu от двенадцати. То есть делители здесь имеются в виду все, не простые,
а вообще все делители. Понимаете, товарищи? Чтобы не путать вот с каноническим разложением. Все
делители перебираются, для каждого вычисляется mu, и давайте посмотрим, чего получится. Здесь
получится 1 по определению, а здесь что по определению? Mu от двойки чему равно? Минус
один, правильно, да. Потому что двойка, это просто двойка в первой степени. s равно единице,
минус один в первый. Это минус один. Здесь тоже минус один, здесь ноль, здесь сколько?
1-минус один в квадрате, потому что это два в первую умножить на три в первой,
Здесь есть делимость на полный квадрат, значит, ноль.
Итого, один минус один ноль, минус один плюс один ноль, ноль.
И мне кто-то звонит.
Сейчас я отвечу, это очень хорошее сообщение. Я просто поблагодарю.
Очень круто. Сейчас оно уйдет, все.
Дорогие товарищи, я утверждаю, что это не случайно.
Я утверждаю, что сумма значений функции мебиуса поделителем какого угодно числа, кроме единицы, равна нулю.
Всегда ноль будет.
Лемма сумма по d, делящим n, мюат d, равняется, конечно, единицей, если n равно одному.
Это тривиально, потому что у единицы только сама она и является делителем, а мюат одного это один.
Это, конечно, так.
А вот во всех остальных случаях, если n имеет каноническое разложение, тогда будет ноль.
Сейчас докажу.
Если что-то непонятно, если все-таки я тороплюсь, переспрашивайте, пожалуйста, не стесняйтесь.
Я очень стараюсь держать всех в тонусе, но если нужно, все-таки спрашивайте.
Так, доказательства.
Ну, давайте представим n больше либо равное двойке в каноническом виде.
Я напоминаю, что s может равняться единице, но я так для общности просто пишу произведение, ничего страшного.
Вот представим в каноническом виде, так можно, вот теорема.
Замечательно, а что значит, что d делит n?
Чему равносильно это утверждение, коль скоро n записано в такой форме?
d имеет какой вид?
В степени бета 1, правильно, вот именно так, да, ps в степени бета s.
Вот только я давайте сразу подчеркну, это не каноническое разложение числа d, а здесь 0 меньше либо равняется b и т.
Меньше либо равняется альфа и т., то есть бета и т. может принимать значение 0 тоже, конечно же.
Вот здесь ни в коем случае нет никакого нуля.
Но если мы хотим просто описать множество всех делителей числа, которые заданы в каноническом виде,
то согласно основной теореме арифметики они, конечно, представляются все вот в таком виде.
Так, друзья, понятно, что здесь теорема арифметики опять нужна единственность разложения, там все это нужно.
Но это как бы очевидно, но доказывать надо.
Но 0 ом, конечно, может равняться, можете взять 12 и посмотреть, как там раскладывается.
Ну, отлично, тогда сумма по d, делящим n, μ от d, это на самом деле сумма по всем последовательностям чисел бета1 и так далее,
бетас таким, что для каждого i 0 меньше либо равняется бета и тому, меньше либо равняется альфа и тому,
μ от p1 в степени бета1, ps в степени бетас.
Сейчас понятно, что значит суммировать вот по такой хрени.
Имеется в виду, что мы перебираем все возможные последовательности вот с этими ограничениями,
и каждую из них подставляем в качестве степеней сюда, потом складываем все.
Не нужно никаких примеров, все понятно, да?
А сколько всего слагаемых, давайте контрольный вопрос к аудитории, сколько слагаемых в этой сумме сейчас?
Альфа1 плюс 1, да, потому что от нуля на альфа2 плюс 1 и так далее на альфас плюс 1, ну просто чтоб точно все понимали, о чем идет речь.
Поскольку от нуля начинается бета, то альфа и т плюс 1 есть вариантов выбора соответствующей беты,
ну а поскольку они выбираются независимо, то по правилам умножения получаем такую штуку.
Ну а теперь смотрите, если у нас хоть одно бета и т больше либо равняется двойке, то будет же ноль?
Понимаете, что μ примет значение нулевое, то есть не даст никакого вклада в общую сумму, если хотя бы одно бета и т больше либо равняется двойке.
Поэтому фактически, давайте я вот это сотру, пояснение, фактически мы не можем сказать, что мы не можем,
давайте я вот это сотру, пояснение, фактически суммировать-то надо просто по всем последовательностям из нулей единиц.
Вот так надо писать сумма по бета1, так далее бетас таким, что для любого и,
ну я, конечно, напишу ноль меньше либо равняется бета и т, меньше либо равняется один, но вот это часто людей смущает.
Имеется в виду, что бета и т может принять только два значения, ноль и единица.
Как только оно принимает значение двойка, мы получаем ноль, и это нас не интересует в общей сумме.
Ну а суммируются, конечно, те же самые величины п1 бета1, пс бетас, но просто вы должны понимать, что тут ставят нолики и единички.
То есть вот в этом суммировании всего два в степени с слагаемых.
Два варианта для каждой беты, поэтому два в степени с последовательностью.
А дальше замечательно, товарищи. Давайте отдельно посмотрим на слагаемое, одно единственное, в котором все беты равняются нулю.
Я смотрю, живы вы или нет. Все беты равняются нулю, да, но это будет μ от единицы.
Потом посмотрим на слагаемые, в которых ровно одна бета равняется единице, а остальные нулю.
Так, друзья, вы поняли, да, ровно одна бета равняется единице, а остальные нулю. Что будет, какое будет значение мю принимать?
Минус один на ц и с по одному, да. Но я хочу, чтобы это все поняли, я не знаю.
Но ц и с по одному это не значение мю, а это количество способов зафиксировать одну единицу.
Но если вы зафиксировали одну единицу, а все остальные беты равны нулю, значит у вас все пропало, кроме какого-то пейитова в первой степени.
Но мю от пейитова в первой степени по определению это минус один, мы сегодня это уже проговариваем.
Поэтому получается, что какую бы последовательность с одной единицей вы не взяли, всего таких ц и с по одному, вы получите минус один мю от простого числа, минус один.
Дальше пишем плюс. Ц и с по два. Это количество всех последовательностей с двумя единицами.
Но если там две единицы, тогда отсюда остается пейитов первый на пжитов первый, и мю от этого равно единице. То есть плюс я написал правильно.
Ну и так далее. В конце будет минус один в эстой на ц и с по с, а это надо интерпретировать как ц и с по нулю.
Мю от единицы это один, это ц и с по нулю. Все, это равно нулю.
Кохнул, да? Не нужно пояснять никому, ничего. Все понятно.
Ну да, можно, наверное, по индукции пояс. Я не знаю, как проще. Мне нравится к этому торжеству свести. По-моему, очень симпатично.
Так, ну вот оно, обращение мебеуса. Здесь написано, что же такое. Сейчас прямо здесь сформулируем теорему.
Теорема, пусть f, некоторая функция, но пускай определенная на натуральных числах,
на самом деле это не очень важно. Ну куда она действует, это совсем не важно. Пусть в r, можно в c даже, комплексные числа.
Ну не хочу пугать, пусть так. Так, пусть теперь g от n, это сумма по делителям числа n значений функции f.
Я специально здесь написал двоеточие, но просто вот я ее так и определил. Задана так функция, что она выражается с помощью f как сумма по делителям числа n.
Ну можно сказать, так оказалось, что какая-то функция может быть выражена через эту f суммированием по всем делителям числа n.
Утверждается, что тогда можно обратно выразить f от n, обратить вот эту вот формулу, выразив f от n через значение функции g.
А именно следующим образом тоже будет сумма по делителям числа n. Здесь mu от d, а здесь g от n поделить на d.
Вот это называется обращение мебельса, формула обращения мебельса. Такая формула.
g выражается с помощью f, тогда f можно наоборот вот так выразить с помощью g, добавив нашу замечательную функцию, которую мы сейчас изучали.
Нет, я не жду от вас, что вы поймете доказательство сходу, хотя кто-то, наверное, поймет. А Бог его знает, а может никто не поймет.
Но я жду понимания того, что случилось. Это действительно обращение.
Знаете, что я еще напишу? Я напишу симметричное равенство и захочу, чтобы вы его осознали. То есть вот то, что это равно тому, что я сейчас напишу, это будет совсем просто.
А именно напишу я вот так. Наоборот, сумма по делителям числа n, mu от n поделить на d, умножить на g от d.
Я очень хочу верить, что вы понимаете, что неважно в каком порядке просуммировать по всем делителям.
То есть вы понимаете, что если число d является делителем n, то и n, деленное на d, это тоже делитель n.
Поэтому таким переобозначением получаем то, что здесь написано.
Зафиксировать какой-то делитель, это все равно, что зафиксировать n, деленное на этот делитель. Ну вот получится такое равенство.
Просто на всякий случай, что можно и так и так написать, в понедельник нам это пригодится.
Ну, доказательства.
Друзья, поскольку мы с вами здесь вроде как очень крутые, то я попробую доказывать, не приводя никаких примеров.
Ну, я так часто привожу пример, чтобы человека убедить в том, что происходит. Но я надеюсь, что вы поймете.
Так, мне кажется, здесь писать в мало места, я не знаю, как это сделать.
Ну, я так часто привожу пример, чтобы человека убедить в том, что происходит. Но я надеюсь, что вы поймете.
Так, мне кажется, здесь писать в мало место, я перейду на среднюю доску.
Но еще и еще раз, я ни в коем случае никуда не тороплюсь. Я очень хочу, чтобы было и весело, и интересно, и понятно.
Если весело, но непонятно, это, конечно, очень весело.
Но совсем нам не нужно.
Значит, смотрите, что я сейчас сделаю. Я возьму и вот сюда вот, вместо g от n поделить на d, подставлю выражение этой функции через вот эту сумму.
Но видите, я вместо аргумента n подставлю аргумент n деленное на d.
Ваша цель – понять, что здесь уже d писать нельзя.
Если справа стоит что-то, обозначенное как n поделить на d, то слева от палочки должен стоять какой-то делитель, который все-таки выражается другой буковкой, нежели d.
Это просто сумма по всем делителям данного числа.
Если вам дано число, которое записывается как n поделить на d, то, наверное, сами делители надо по-другому обозначить.
Короче, пишем, значит, сумма по d делящим n мимо от d.
И вот тут такая скобка, в которой находится сумма по, давайте, d штрих делящим n на d, f от d штрих.
Ой, да, f от d штрих. Все правильно. Никакого ой. Все правильно.
Вот сюда вот подставил d штрих, а d штрих – это произвольный делитель, но уже не n, а n деленного на d.
Вот d штрих – это делитель такого числа. Понятно, почему d штрих, да?
d бессмысленно здесь писать.
Какая моя цель? Моя цель – показать, что вот это все – это на самом деле просто f от n.
Так же?
Ну, тут как-то f от n не видно.
Ну, когда я привожу пример, товарищи, я говорю, ну, смотрите, давайте вот раскроем скобки для конкретного n.
Тут мюшка от какого-то d, дальше сумма каких-то f, потом снова мюшка от какого-то следующего d, опять сумма каких-то f.
Перегруппируем слагаемые, вынося за скобку. На сей раз не мю, а f.
Так я говорю. Вот сейчас я это и сделаю.
Ну, давайте, чтобы это сделать, заметим, что выбрать, я все-таки-то аккуратно напишу, d такое, что d делит n.
А потом d штрих такое, что d штрих делит n на d.
Вот осуществить такой последовательный выбор делителей. Выбрать сначала число, делящее n, а потом число, которое является делителем этой дроби.
Вот осуществить такой выбор – это то же самое, что выбрать пару чисел, которые делятся на дроби.
Дело в том, что выбрать пару чисел сразу d и d штрих такую, что их произведение делит n.
Вот смотрите в то, что я написал, думаете согласны вы или нет? Согласны, да?
Сначала взяли делитель числа, потом взяли делитель дроби, но это то же самое, как выбрать два числа, произведение которых делит исходное.
То есть сумма, которая нас интересует, может быть вот так записана.
По всем парам d и d штрих натуральных чисел, произведение которых делит n.
А здесь просто всевозможные вот такие произведения – μ от d на f от d штрих.
Упорядоченные, да. Упорядоченные, конечно. Да, да, да.
Это правильное замечание, но пары упорядоченные. Спасибо, это важно.
Ну а все, это симметричная совершенно форма, то есть я могу вот так написать. Тут уже вообще ничего не произойдет нового.
Это будет сумма, если хотите наоборот, по d штрих d. Ну какая разница, какую букву как обозначить таким, что d штрих на d делит n.
Здесь будет соответственно μ от d штрих. Именно за счет того, что пары упорядоченные и выбираются все возможные эти пары, суммирование проводится независимо.
И тут получается f от d. Ну какая разница, как обозначить? Это просто тождественно одно и то же.
Но если мы поняли это равенство, то здесь получится такое же, но только уже будет написана сумма по d делящим n f от d умножить на скобку.
И здесь будет сумма по d штрих делящим n деленное на d, μ от d штрих. То есть фактически просто μ и f меняются местами.
Видите, да? То есть в изначальной сумме μ выносилось за скобку, и внутри скобок стояла сумма f.
А мы получили, что это то же самое, как f выносить за скобки, а внутри получать такую же точно сумму μ.
Последили, друзья? Нормально? Точно?
Ну и все. Смотрите, какие тут точно есть слагаемые? Вот тут.
Ну точно есть слагаемое с d равным n, правда? Давайте отдельно на него посмотрим, что такое слагаемое с d равным n.
Тут будет f от n. Вот тут f от n при d равном n. А если сюда подставить d равное n, то будет единичка.
Помните лему? Ну это все, это f от n. Но это не интересная часть леммы.
А интересная часть леммы, вот тут, остаются слагаемые, в которых d делит n, и при этом d уже строго меньше, чем n.
Ну тут, конечно, f от d, а дальше вот эта сумма по d' делящим n на d, μ от d'.
Немножко намешано. Видно чего-нибудь? Могу переписать на этой доске? Переписать, да? Что-то, да, по-моему, накорявил.
Слева, да? Ну хорошо, давайте слева.
Ну, лему, может, не надо было стирать, но по идее вы ее помните.
Но я ее не стер. Ну ладно, все бы уместилось. Красота абсолютная. Смотрите, давайте я еще раз это перепишу, это важно.
Значит, остается вот так. Сумма по d делящим n, d строго меньше, чем n, f от d, и в скобках будет сумма по d' делящим n на d, μ от d'.
Сейчас видно, да? Вы согласны, что такая сумма осталась? Ну а какая? Вот она такая была, такая осталась.
Единственное, что мы отдельно рассмотрели d равное n, поэтому теперь у нас d точно меньше, чем n.
Делитель числа n, он же не может быть больше, чем n, правда? Если он не равен n, то он меньше, чем n.
Но если d меньше, чем n, тогда эта дробь какая? Больше единицы, да? Больше единицы, ну то есть больше либо равна двойке.
Короче, сумма мюшек равна нулю. При любом таком d вот эта вот сумма мюшек равна нулю, согласно Лемме.
n поделить на d больше единицы, но это целое число, значит, больше либо равно двойке, конечно.
То есть это ноль. Мы что-то содержательное каждый раз умножаем на ноль, потом кучу этих нулей складываем, но, понятно дело, получается ноль.
То есть ноль прибавляется к f от n, и все мы доказали нашу теорему.
Спеваете точно? Я вот очень переживаю, мне кажется, могло кокнуть. В принципе, вроде все просто.
Обратили миобиуса. Вернемся к нашей комбинаторике.
Комбинаторике. t от n, помните, считаем?
Ну давайте я введу какие-то обозначения.
v это будет множество всех линейных последовательностей длины n над алфавитом x, который у нас состоит из r различных объектов, из r букв.
Ну то есть мощность v мы знаем от r в степени n.
Это обычные слова, их, конечно, в степени n.
Так это ни у кого не вызывает сомнений.
Если надо замедлиться, давайте, давайте, говорите.
V множество всех линейных последовательностей длины n, то есть просто размещение из повторений, обычных слов.
Их, конечно, r в n степени. А нас-то интересуют циклические слова.
Внимание, мы довольно долго сейчас будем работать только с линейными словами.
Когда появятся циклические, я вам очень аккуратно скажу. Пока работаем только с линейными.
Давайте назовем сдвигом это операция, которая переводит линейное слово,
линейное слово переводит линейное слово, линейную последовательность a1, an, в линейное же слово a2, an, a1.
Ну то есть у нас было слово c, o, c, h, а стало слово o, c, h, c. Мы как бы по циклу сдвинулись.
Ясно выражаюсь? Такой вот сдвиг влево что ли, да? Ну неважно, циклический сдвиг вот такая операция.
Всем понятно, что если совершить над каким угодно словом n сдвигов, то в итоге получится исходное слово, правда же?
Вот, например, с этим словом 1, 2, 3 все время были разные, а потом опять вернулись сюда. Это очевидно.
Но некоторые слова раньше возвращаются, например, sos. Два сдвига сделали, опять sos, правильно?
Вот давайте назовем периодом линейной последовательности или линейного слова как раз минимальное количество сдвигов, переводящих слова в себя.
Сейчас я это напишу. Так, давайте период.
Я все сегодня, конечно, не успею. Линейные последовательности это минимальное число сдвигов, ну какой-нибудь d, которое возвращает слово в себя, ну или переводит слово в себя.
Что, что? Да, да, да, да, да, да, да, именно так, да. Срывайте кайв, катарсис, которое переводит слово в себя, ну слово последовательность в себя.
Последовательность в себя. Конечно, да, конечно, Lemma 1 утверждает, что период всегда является делителем длины последовательности.
Ну это более или менее очевидно, конечно, но хотите, я это формально распишу. Формально это надо предположить противное, что n делится на d с остатком.
Остаток это, конечно, число от единицы до d-1. Ну а дальше мы просто берем наше слово a1an, d раз применяем к нему сдвиг, получаем его же, по определению просто d.
Потом много-много раз так делаем, еще d раз, применяем сдвиг, снова у нас получается a1an, много-много, это k, вот k таких, фигурных скобочек.
Ну то есть сделали уже d умножить на k сдвигов, а потом делаем еще r сдвигов, еще r сдвигов и снова получаем a1an, ну потому что в сумме у нас получился n сдвигов.
Ну и ясно, что здесь противоречие с минимальностью d, потому что за r сдвигов и r меньше, чем d, мы опять попали туда же. Это противоречие от минимальности в определении периода, все.
Нормально? Так, ну у меня мелость сейчас. На самом деле, конечно, можно сказать даже больше о структуре последовательности, это прямо видно из наших примеров.
Вот sosen в нем никакой регулярности нет, но так он и периода 4, а soso в нем регулярность есть, это so-so.
Вот он периода два, два блока, каждый периода два. То есть на самом деле можно даже вот так сказать, лемма два.
Так, любая последовательность, а здесь доказательство, сейчас я его сотру, любая последовательность линейная, конечно, длины n и периода d имеет вид вот такой.
А1, Аd, А1, Аd, А1, Аd.
То есть она состоит из одинаковых кусочков, причем вот эти кусочки, А1 и так далее, Аd, это последовательность не только длины, но и, конечно, периода d тоже.
Это последовательность длины и периода d ввиду минимальности числа d.
Ну, я не знаю, нужно это как-то дополнительно обосновывать или нет, но просто когда вы один раз применяете сдвиг, у вас буковка a2 перемещается на первую позицию,
когда два раза применяете, а3 перемещается на первую, когда вы d раз применяете сдвиг, у вас d плюс первая буковка перемещается на первую позицию.
Ну, значит, они одинаковые. Ну и так же точно с последующими. Здесь все, конечно, совпадает.
Сейчас, друзья, нормально так? Вот, вот, имеет вот такой вид.
Так, что-то я еще успею, да? Ну, у нас осталось пять минут, сейчас я это дело допишу.
Так, что-то мы успеем. Ну, смотрите, давайте наше число n возьмем и рассмотрим все его делители.
Назовем их d1 и так далее ds. Это все вообще делители.
Подчеркиваю, непростые числа в каноническом разложении, а именно просто все делители 1, n, если n непростой, то еще какие-то.
Ну, так, для удобства можно считать, что они упорядочены, например, по возрастанию.
Это все делители, так их обозначили.
Ну, очевидно, что v тогда представляется в виде дизъюнктного объединения v1, vs, где vit это все линейные последовательности глины n и периода dit.
Очевидно, да? Период является делителем числа n, поэтому любая последовательность имеет какой-то период, но он является делителем.
Все последовательности рассованы по вот этим частям. Соответственно, мощность v тогда равняется сумме мощностей.
Ну, собственно, если кто-то внимательно слушал мое рассуждение до появления функции мебиуса, то тот помнит, вот я говорил, r в степени n непонятно на что поделить.
Но можно разбить на кусочки, и в каждом кусочке уже будет понятно на что поделить. Вот ровно это сейчас происходит.
Это r в степени n. Мощность v – это r в степени n. А мощность v мы не знаем отнюдь.
Но мы сейчас к ней сведем мощность того множества, которое мы ищем, множество циклических последовательностей.
К сожалению, не сейчас, а в понедельник, потому что чуть-чуть времени не хватает. Ну ладно, что поделать.
Значит, давайте введем w и t. Это множество линейных слов длины и периода d и t.
Как соотносятся w и t и w и t?
Ровны по мощности, правильно. Конечно, можно вот так написать. Мощность w1 плюс и так далее, плюс мощность w и t.
Почему равны по мощности? Потому что w и t – это как раз множество тех блоков, которые в конечном счете являются строительными для формирования слов из w и t.
Ну вот, со однозначно формирует со-со. Какой-нибудь ch однозначно формирует ch-ch.
Поэтому сколько есть способов сформировать со, ch, там еще что-то, столько же существует и способов сформировать более длинное слово, которое просто вот так однозначно состоит из этих блоков.
Поэтому сколько есть блоков слов длины d и t и периода d и t, столько же есть и слов длины n и периода d и t. Я понятно сказал? Или это место непонятно?
Так, еще раз, w и t – это множество линейных слов, у которых и длина, и период равны d и t.
Ну то есть это вот слова типа такого – c, o, c, h. О, там, не знаю. Нет, о, плохо. Какое еще бывает? О, h, да, конечно, o, h.
О, тоже хорошо, да? Нет, мне хочется брать такие блоки, которые имеют тот же период, что их длина, поэтому о, по-моему, плохо.
У них период 1, у слова o, период 1, а длина 2, поэтому o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o,
о, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o
о, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o, o
