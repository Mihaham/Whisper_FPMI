Сегодняшняя лекция, но, наверное, самая важная про дискретные Марковские цепи,
поговорим про эргодичность. Дискретные цепи Маркова. Лекции, посвященные цепям, до сих пор,
они были как бы инструментальными. Мы с вами разбирали базовые понятия, вводили какие-то
базовые определения, их свойства. Но всё это служит инструментом для чего-то большего. Вот
сегодня мы соприкоснёмся с этим большим. Поговорим об эргодичности и вообще о том,
что происходит в цепях в пределе при стремящемся к бесконечности. Ведём сначала определение такое.
Распределение P0, это вектор или последовательность для счётных цепей. Распределение P0 будем
называть стационарным, если, мы работаем в однородных цепях, если п-транспонированное
P0 равняется P0, где P это матрица перехода за один шаг. Если она переводит это распределение в него,
то есть вот у вас есть какое-то начальное распределение на цепи, вы знаете, что вы
находитесь в этом состоянии с такой-то вероятностью, в этом состоянии с такой-то
вероятностью и так далее. И вообще говоря, когда вы сделаете один шаг, то это распределение изменится.
Помните, у нас было P от n, это есть P-транспонированное на P от n-1. Но вот есть такие распределения,
ну, бывают такие распределения, на которых действует это и P и ничего не меняется. Такие
распределения называются стационарными. Здесь, кстати, очень важное слово распределение, то есть
это не просто какой-то вектор такой, что P-транспонированное P равно P, это именно
распределение, то есть это вектор или последовательность с не отрицательными компонентами,
сумма которых равна единице. Вот, то есть слово распределение, оно здесь важное. Вот так. Значит,
отсюда сразу же следует, что P-транспонированное в степени n P0 равняется P0 для любых n, больше
либо равных единице. Вот. Так, хорошо. Дальше. Ведем еще одно определение основное для сегодняшнего
дня. Это понятие оргодической цепи Маркова. Значит, цепь Маркова называется оргодической,
если для любых i и j из s, то есть для любых состояний существует положительный предел,
значит пишем, предел n стремится к бесконечности P i t j t от n равный P j больше 0, независящий от i.
Что это значит? Что такое P i t j t? Я напоминаю P i t j t от n. Это есть вероятность того,
что мы в этот момент времени находимся в j, если мы стартовали из i. И то, что этот предел равен P j
тому, и он не зависит от i, это означает, что вот эта вероятность, она сходится к какому-то P j,
который зависит только от j, не зависит от i. То есть независимо от того, откуда мы вышли,
это вероятность сходится к некоторому числу, который зависит только от того,
куда мы рассматриваем, какое состояние мы рассматриваем, это j, но не зависит от того,
откуда мы вышли. Вот оказывается, что стационарность связана с оргодичностью в этом смысле. И мы будем
с вами изучать свойства, которые связывают оргодичность и стационарность. И на этот счет
у нас есть теорема. Одна из главных сегодня, у нас сегодня будет три теорема. Это одна из них
главная. Это критерии оргодичности. Кстати говоря, вы уже знаете слово оргодичность. Оно у нас было
в первом задании. Оно у нас связывало среднее по времени и среднее по пространству. Здесь мы
пока не видим, где здесь среднее по времени и среднее по пространству. Это будет потом,
эту связь мы установим. Но нам будет удобно вести оргодичность для цепей. Вот таким
образом, хоть мы и не видим пока, как это связано со средними по времени и по пространству.
цепи могут быть всякими вот этот предел кстати у произвольных цепей он может существовать и
быть равным нулю он может не существовать он может существовать и зависеть от и ж вот но вот
есть такие цепи у которых этот предел существует раз он положительный 2 и он не зависит от и 3
светит тут сколько сразу утверждений вот в этой записи не существует и положительный и не
зависит от и как же понять является цепь эргодической или нет ну не будем же мы в самом
деле вычислять эту п и ту житую от n устремлять н го бесконечности смотреть куда она пришла хотелось
бы как-то это делать похалявнее вот оказывается это возможно и как это делать говорит вот это теорема
критерий эргодичности критерии эргодичности значит конечная цепь я есть критерии и для
бесконечной ну для счетной цепи об этом я скажу потом но мы с вами докажем теорему для конечной
цепи конечная дискретная цепь маркова является эргодической тогда и только тогда
когда она не разложимая то есть все ее состояния сообщаются когда она не разложимая и не периодическая
когда у нее все периоды всех состояний равные единицы вот какая замечательная теорема но
определить не разложимость и не периодичность это чаще всего очень легко просто взглянув на цепь и
не нужно вычислять никакие быты и жито и смотреть к чему-то нам сходится для каждого и и жи вот
будем доказывать эту теорему будем доказывать эту теорему не разложимый не периодическая ну так
сова даже вне этого доказательства сразу должно быть понятно зачем нужна не разложимость потому
что если цепь разложимая значит есть несущественные состояния не все сообщаются есть есть несущественные
состояния раз есть несущественное состояние начало невозвратное у нас было такое свойство
прошлый раз начало невозвратно а раз оно невозвратно значит по критерию возвратности оно
нулевое и значит по это и ты сходится к нулю а здесь должно быть больше нуля вот ну ладно мы
но это как бы вот один из аспектов но на самом деле мы будем доказывать сразу вот это все значит
давайте мы предположим что цепь не разложимая и не периодическая покажем что тогда предел
больше нуля пусть в одну сторону как бы показываем пусть дискретная цепь маркова конечная мы будем
этим существенно пользоваться сегодня в этой теореме пусть дискретная цепь маркова является
а так сейчас или куда нам поручить не подождите нет это будет сложнее давайте мы сначала
предположим что она эргодич да давайте мы сначала предположим что она является эргодической начнем
с более простых вещей является эргодической докажем что она не разложимая не периодическая пусть
эргодическая значит тогда что у нас есть тогда существует такой предел для любых и и ж и с
существует вот такой предел мы просто берем определение равняется пж он больше нуля и не
зависит от и но это означает что начиная с некоторого номера по и т ж и т н будет
отличаться от пожитого на некую эпсилон то есть существует номер он вообще говоря зависит от
и и ж ну и пусть зависит зависит но существует номер какой-то такой что для любых н больше
либо равных этого номера у нас п и т ж и т от н будет больше чем п ж и т минус эпсилон для
любого эпсилона давайте мы самый начало для любого эпсилона больше нуля найдется номер такой что
правильно мы же стремимся к пожитому да значит однажды вот где-то вот мы какую-то
эпсилон окрестность попадем и будем больше чем пожитая минус эпсилон вот для любого
эпсилона но давайте мы возьмем не любой эпсилон а возьмем такой эпсилон малый чтобы вот эти
вещи все были строго больше нуля то есть мы возьмем эпсилон пусть эпсилон это есть минимум по всем
ж из пожитых цепь конечно а все это числа среди них есть минимальное число вот была быть цепь
счетная то никак не понятно было бы как его взять но мы воспользуемся здесь конечности цепи и
возьмем эпсилон который минимум и всех пожитых можем даже взять еще меньше тогда получится что
вот эта штука будет больше нуля для таких эпсилонов и это значит что начиная с номера
н 0 который соответствует такому эпсилону у нас все п и т житые от н будут больше нуля вот
все значит начиная с н 0 от и и ж который зависит от и и ж для такого эпсилон у нас
получается что п и т житые от н больше нуля для всех н начиная с него но это мы доказали для
конкретных и и ж но соответственно давайте мы возьмем н которая больше чем н 0 для и итого
житого для всех и и ж то есть пусть скажем н 0 такой что ну он равен максимуму из н 0 и
ж для всех и и ж опять же цепь конечно мы пройдемся по всем и и ж по всем парам и и ж посмотрим на их
н 0 да возьмем максимальный всех этих н 0 ну их конечное число поэтому всегда такой максимум
можно найти ну и все и тогда отсюда следует что для любых н которые больше либо равны такому
н 0 у нас все для всех и и ж п и т житые от н больше нуля для любых и и ж и для всех вот таких
достаточно больших н и и ж произвольно они могут быть равны друг другу кстати никто не запрещает
их быть равными то есть и п и т житые больше нуля житые ты больше нуля и ты и ты больше все
они больше нуля начиная с некоторого номера то есть есть общий для них для всех номер н 0 начиная
с которого все они больше нуля но это означает что они все сообщаются нашелся номер такой что
п и т житые больше нуля все они сообщаются вот ну и отсюда следует что они все и не периодически
потому что видите они п и т житые от н ну п и т и ты больше нуля начиная с некоторого номера
туда войдут взаимно простые числа правильно там скажем будет 100 следующие 101 потом 102 ну 100 101
там взаимно простые все наверное да да взаимно простые так что сразу же получается что эта цепь
не периодичская все следовательно все состояние сообщаются и не периодически сообщаются потому
что все вероятности больше нуля а не периодичность просто потому что не больше нуля начиная с
некоторого номера для всех и начинает с некоторого номера для любых и сюда взаимно простые н войдут
всё. Так что мы в одну сторону показали. Если она оргодическая, видите, то однажды,
раз они стремятся к положительным пределам, то однажды вот наступит такой момент, когда все
пыта и жита будут отделены от нуля. Вот мы этим пользуемся. Всё, с этим разобрались. Теперь осмотрим
обратную ситуацию. Пусть она не разложимая и не периодическая. Попробуем доказать,
что она является оргодической. Вот это сложнее. Ну, как всегда бывает, да, теорема, критерий. В одну
сторону всегда легко, а вот в другую приходится напрячься. Ну, давайте напрягаться.
Давайте напрягаться. Теперь мы предполагаем, что она, пусть дискретная цепь Маркова,
не разложимая и не периодическая. Пусть она не разложимая и не периодическая.
Давайте мы сначала докажем, что… Сначала. Это сложно будет доказать. Докажем сначала,
что p, i, t, j, t от n больше нуля, начиная с некоторого номера. Вот как там мы это показали,
что они все больше нуля, начиная с некоторого номера, общего для не всех. Вот давайте мы и
здесь докажем, что они все больше нуля, начиная с некоторого номера. Вот. Сначала начнем с этого.
Как мы это сделаем? Как мы это сделаем? Чем мы тут воспользуемся? Ну, начнем, наверное, с того,
что… Сейчас. Чего тут проще начать-то? Неразложимая и не периодическая. Сейчас.
Ну ладно, начнем с того, чтобы посмотрим, что такое не периодическая. Это означает,
что нод n больше нуля таких, что p, i, t, i, t от n больше нуля, что эта штука равна единице.
Но таких чисел равен единице. Вот. На это означает, что найдутся взаимнопростые
n1, и так далее, nr. Ну, их, кстати, два можно тоже взять. Ну, какие-то взаимнопростые найдутся.
Найдутся взаимнопростые такие, что p, i, t, i, t от n, ну, 1 больше нуля, p, i, t, i, t от n2 больше нуля,
ну, и так далее, все вот эти вот p, i, t, i, t от nr больше нуля. Ну, откуда это следует? Ну, смотрите,
если бы этого не было, то тогда у них бы у всех был общий делитель. Вот эта штука говорит о том,
что у них нет общего делителя, кроме единицы. Значит, обязательно найдутся какие-то взаимнопростые
среди них. Если бы таких взаимнопростых не было бы, у них бы у всех был общий делитель. Ну, как бы,
по определению взаимной простоты. Вот. Ну, нам здесь, по-моему, достаточно, чтобы даже два
числа взаимнопростых взять. Не обязательно их брать сколько-то r. Вот. Ну да, достаточно даже
двойки. Ну, допустим, даже в самом общем виде обязательно найдутся какие-то вот, какой-то
набор взаимнопростых чисел. И что мы можем про это сказать? Это то, как мы пользуемся здесь
непериодичностью. Это будет для нас важно. Ну, хорошо, нашлись. Нашлись какие-то. То есть это о чем говорит?
Нашлись какие-то. Нашлись какие-то числа n1, n2, nr, для которых p больше нуля. А что можно сказать про
произвольный n? p и t от n. Для этих он больше нуля, а для этого? И вот на этот счет там приходит на
помощь теорема из теории чисел, которая говорит о том, что любое достаточно большое число может
быть разложено в линейную комбинацию с целыми весами по взаимнопростым числам. Просто осознайте,
это такая нетреальная вещь. Я сейчас напишу эту лему. То есть вот, допустим, у вас есть набор
взаимнопростых, тогда начиная с некоторого номера n можно представить как сумму ну каких-то там,
скажем k и t на n и t от единицы до r. И пусть даже r равноится двойке. Вы можете разложить любое
число по взаимнопростым. Любым. Ну, начиная с некоторого номера. Но самое такое простое,
допустим, 2 и 3. Возьмите 2 и 3. Взаимнопростые числа. Как их линейной комбинации с положительным
мяка, ну не отрицательным мяка, получить любое другое число? Любое четное мы получим с помощью
двойки. Если мы выберем коэффициент перед двойкой, а перед тройкой выберем коэффициент равный ноль,
мы получим любое четное. А как получить любое нечетное с помощью двойки и тройки? Ну, там типа,
если у тебя есть какое-то нечетное, которое ты хочешь получить, ты, умножая двойку на какой-то
коэффициент, всегда можешь добраться до ближайшего четного. Ну, если к нему прибавить 3, ты перешагнешь,
но переместись не к ближайшему четному, а предближайшему четному, а потом прибавь 3. И ты
попадешь ровно вот в него. Ну, понятно, да? То есть вот всегда можно подобрать такие коэффициенты.
Значит, любое четное можем получить, любое нечетное можем получить. Ну, это вот если мы 2 и 3 берем.
Ну, на самом деле, видите, эта теорема, она обобщается. Любые взаимнопростые числа берете 2 и больше,
и вы сможете получить любое достаточно большое число n. Я сейчас формулирую эту лему. Мы ее доказывать
не будем, а просто и воспользуемся. Значит, лемма, которой мы пользуемся. Значит, для любого конечного
набора, значит, а, и, т, и равно от единиц, r больше либо равняется двойке, существует k0 такой,
что... Ну, давайте не k, а давайте n. У нас n где-то тут. n0 такой, что для любых n больше либо равных n0,
существует r неотрицательных чисел. Вот их я обозначу. А как они у меня тут, x? Как-то неудобно,
так x какие-то. Пусть будет k. Чисел k этих, для которых вот эта наша n, вот эта n, есть сумма
по i равном от единицы до r, аи, тх на каи, т. Вот. Любое число, достаточно большое,
можно разложить по вот этим вот взаимнопростым. А, подождите, я не сказал. Сейчас, для любого конечного
набора взаимнопростых. Взаимнопростых. Вот эти мы и воспользуемся. Вот. Так что мы знаем,
что p на вон тех n-итых больше нуля. Как мы получим, что p для произвольного n больше нуля? Мы разложим
эту n по этим n-итым. Любое достаточно большое n мы разложим. Ну, если вы берете r равное двойке,
вот здесь, вы можете любое взять, то тогда просто может получиться так, что вот эта n0,
с которого они начинают раскладываться, она будет большим. Но нам это неважно, потому что мы
сейчас пока не говорим о каких оценках там, просто нам нужен сам факт сходимости. Ну вот. Что
получается? Что вот у нас есть взаимнопростые n1 и nr. Мы теперь возьмем произвольное, достаточно
большое n, разложим по ним. То есть пусть наша n достаточно большая теперь, которая стоит вот здесь,
для которого мы хотим оценить эту по эту и эту. Пусть мы возьмем это n, разложим его по n-итам,
от единицы до r, тем самым взаимнопростым. И по числам каита. Вот. Рассмотрим такой n.
Зафиксируем его, значит каиты для него зафиксируются, они не отрицательные какие-то числа. Вот это
взаимнопростые, тоже положительные. Ну вот. Тогда что такое p-i-t от n? Значит p-i-t от n, она больше
либо равна, так как n является суммой, а мы вспоминаем нашу первую лекцию по цепи Маркова,
помните ту формулу, которую я в рамку обводил? Я говорил, что мы к ней будем постоянно обращаться,
ну вот видите, постоянно к ней обращаемся. То, что p-i-t от n, она больше либо равна, чем произведение,
значит p-i-t от n-i-t, и плохо, да, тут у меня и, тут у меня и. Так, давайте мы j, возьмем j, вот здесь,
чтобы не путать. Вот. Больше либо равна, чем произведение. Вот это. И снова применим ту самую
формулу уже к вот этой вещи, потому что n-житая k-житая, это сумма k-житого числа n-житых. Вот как.
То есть произведение j равны от единицы до r на p-i-t-i-t n-житая в степени k-житая. Вот как. Но вот эти все,
они больше нуля. Здесь мы в степень какую-то возводим. Ну все, значит, больше нуля. Вот мы
взяли произвольное n, достаточно большое, и увидели, что его можно разложить вот так,
написать вот эти оценки, а про эти мы доказали, что они больше нуля. Мы их просто такими взяли,
по определению вот этих n-житых. Все. Значит, мы показали с вами, что p-i-t от n больше нуля.
Начиная с некоторого номера n. То есть для любых n больше либо равных n0, который, вообще говоря,
зависит от i. Вот. Вот от этого i. Выполняется вот это. Дальше едем. Это мы воспользовались только
периодичностью еще. Теперь мы воспользуемся неразложимостью цепи. Значит, цепь неразложима.
Значит, существует номер, который, вообще говоря, зависит от i и j, такой, что p и j от этого l больше
нуля. Я сейчас хочу показать, что не только p-i-t-i-t больше нуля, но и p-i-t-j-t для несовпадающих
i и j. И вот тут нам нужна какая-то связь между i и j, что вероятность перейти с одного в другое,
она не отрицательная. Она больше нуля, вернее. И тут как раз мы воспользуемся свойством
неразложимости. Раз есть неразложимость, значит, существует номер такой, что. Значит,
как вот это теперь все связать? Давайте мы рассмотрим теперь номер. Скажем, как я вот
обозначаю. А, нет, ну я просто пишу. Следовательно, для любых n, которые больше либо равны n0 от вот
этого i, плюс l-i-t-j-t, мы имеем p-i-t-j-t от n. Опять той самой формулой пользуемся больше либо
равно, чем p-i-t-i-t от n минус l на p-i-t-j-t от l. Потому что n это сумма. Это больше либо
равно, чем сумма n0 плюс l. Ну или это n0 плюс l плюс что-то. Значит, вот так. Но n0 минус l больше
либо равно, чем n0. А для таких мы доказали, что p-i-t-i-t будет больше нуля. А здесь стоит l,
и для l мы знаем, что p-i-t-j-t от l больше нуля, потому что они сообщаются. Вот так что вот это следует
из непериодичности, а вот это следует из сообщаемости. Значит, все больше нуля. Все.
Вот. Так что мы показали, что начиная с некоторого номера, все p-i-t-i-j-t и p-i-t-i-t-i-t все
будут больше нуля. Но состояние и конечное число, поэтому понятно, что можно найти общий номер,
самый большой для них всех взять, и тогда все p-i-t-i-j-t, начиная с этого номера общего для них всех,
будут больше нуля. Вот и все. Так. Хорошо. Все. Ну это мы что доказали? Это мы доказали,
что если цепь неразложимая и непериодическая, тогда начиная с некоторого номера p-i-t-i-j-t от n
строго больше нуля. Но нам нужно доказать, что предел существует, который еще от и не зависит,
еще и положительный предел. Но для этого нам придется вести некоторые вспомогательные
обозначения, чтобы показать, почему сходятся это p-i-t-i-j-t. Если мы покажем, что существует
предел, он обязательно положительный. Потому что, видите, они, начиная с некоторого номера,
больше нуля, и они будут отделены от нуля. Сейчас оценки все мы напишем.
Значит, мы введем вот такие вот вещи. m-j-t от n – это минимум по всем i p-i-t-j-t от n.
Введем m-j-t от n как максимум по всем i p-i-t-j-t от n. Ну, понятно, что произвольные p-i-t-j-t
лежит между ними. Так что попробуем изучить свойства вот этих вот последовательностей.
m – малая j-t, m – большая j-t. Посмотреть, что с ними происходит, и тогда мы что-то
поймем про вот эту последовательность – p-i-t-j-t-n-t, потому что она лежит между ними.
Давайте я так прямо напишу – p-i-t-j-t от n. Она лежит между вот этой вещью и вот этой вещью.
И будем изучать вот эти последовательности. Значит, мы с вами что можем сразу же заключить?
Что p-i-t-j-t от n плюс 1 равняется сумме по всем l и z, p-i-t-j-t от p-i-t-l-t на p-l-t-j-t от n.
Но это мы просто с вами знаем. Вот. И напишем теперь оценки на m-j-t. На самом деле окажется,
что m-j-t она не убывает, а вот это не возрастает. Что это будет значить? Как это, вернее, получить?
m-j-t от n. Это есть минимум… А, нет, давайте так. m… Нам вот так проще будет. n плюс 1. Это есть
что такое? Это есть минимум по всем i, p-i-t-j-t от n плюс 1. Теперь вот эту формулу подставляем
сюда. Получаем минимум по всем i, значит, сумма p-i-t-l-t, p-l-t-j-t от n при l из s. Вот. Теперь вот эта
вещь, она больше либо равна, чем минимальная среди них по l, чем минимальная среди них по l,
а минимальная по первому индексу – это m. Значит, она больше либо равна, чем m-j-t от n. А вот эта
вещь не отрицательная. Значит, мы можем записать, что все это больше либо равно, чем минимум по i,
сумма l из s, p-i-t-l-t на m-j-t от n. Но она от l не зависит, мы ее вносим, а вот тут получается,
смотрите, какая сумма, когда мы по второму индексу суммируем все вероятности, мы получаем единицу.
Получается, что единица умножена m-j-t-n. Так что выходит, что m-j-t-n плюс 1 больше либо равно,
чем m-j-t-n. То есть m-j-t не убывает. Абсолютно аналогично можно доказать, что m-j-t от n плюс 1
меньше либо равно, чем m-j-t от n. Значит, это не возрастает. Та не убывает, а это не возрастает.
А p-j-t между ними находится.
Сейчас лишнее затру, нам не приводится.
Итак, что у нас получается? Что есть вот это неравенство, и мы доказали, что вот это не убывает.
Может быть и константа где-то, но она не убывает. Ниже она не может идти, она может идти только вверх.
Вот эта вещь не возрастает. Она может быть тоже где-то константой, но она не возрастает,
она может убывать. Значит, что сразу хочется понять? Что они ее сжимают. Кстати говоря, они от и не
зависят. Поэтому тут что-то чувствуется, что где-то здесь есть предел, не зависящий от и. Но конечно,
мы отсюда не можем сразу заключить, что они обязательно схлопываются в точку. Потому что,
как я уже сказал, мы пока лишь получили вот здесь, видите, больше либо равно. И как бы непонятно,
может быть они там константы, может быть они остаются константами и на самом деле в точку не
схлопываются. Так что здесь нужно аккуратно. Оказывается, конечно, что их разность стремится
к нулю. Вот мы сейчас это покажем. Их разность обязательно стремится к нулю. Вот. Давайте это
показывать. Так, значит, покажем, что m житой от n минус m житой от n стремится к нулю при n,
стремящемся к бесконечности. Вот. Значит, пусть дельта, ведем такое еще обозначение, это минимум
по всем i и j, p и этого житого n ноль, где n ноль это номер, начиная с которого все они строго больше
нуля. Мы с вами выяснили до этого, что такой номер обязательно найдется. Ну, он найдется для каждого
отдельности и и этого житого. А так как их конечное число, то понятно, что это будет, что всегда
существует номер, который общий для всех, когда они все больше нуля. Вот мы этот ноль возьмем вот здесь
и зафиксируем. И ведем вот такую дельту. То есть как бы минимальный из всех поитых житых. То есть
они, начиная с некоторого номера, все строго больше нуля, кто-то среди них есть минимальный
среди этих поитых житых. Вот мы его, этот поитый житый, обозначим за эту дельту. Ну и теперь дальше
идет просто череда некоторых оценок, очень тонких. Значит, p и это житое от n ноль плюс n. Вот давайте
посмотрим, что это такое. Это есть сумма по всем l из s, p и это l t. Чего мне тут нужно взять? n ноль
на p l t, то там житое от n. Вот. Ну и омный ноль сюда добавим. Мы прибавим и вычтем дельту, умноженную
на p. Кого мне тут надо взять-то? Житую l от n. Вот. Ну прибавим и отнимем вот к этой вещи. Прибавим и
отнимем. Просто такой умный ноль. Равно сумма l принадлежит s, p и это l t от n ноль, минус дельта
p житое l t от n, умножить на p l житое от n, плюс сумма по всем l из s на дельту p житое l t от n
на p l t житое от n. Здесь ж или здесь l жи. Вот как. Вот рассмотрим вот эту вещь. Так, что мы теперь про эту вещь скажем?
Вот это, давайте мы сначала заметим, что вот это больше либо равно нуля. Тут странно, да, тут некая
вероятность, минус некая, хрен пойми какое число, умножить на p. И как бы непонятно, почему эта вещь не отрицательна.
На самом деле это так. Вот. Потому что p и t l t от t ноль, сейчас давайте подумаем, сразу это неочевидно.
Значит, вот эта вещь больше либо равна, чем дельта, чем p житое от l от n. Давайте без перерыва сегодня.
Много описанины. Значит, p и t l t ноль больше либо равна. Почему это так?
Ну, сейчас, сейчас, давайте так. p и t l t ноль минус дельта p житое l t от n. Значит, p и t l t ноль,
она больше либо равна, чем дельта. Дельта минимальная среди всех этих житых в ноль. Значит, вот эта вещь, она точно больше либо равна, чем дельта.
Вот это. Дельта минус дельта p житое l t от ноль. Ну вот. Дельта один минус p житое l t от ноль.
Ну а чтобы это не было, это больше либо равно нуля. Потому что вот это не превосходит единицу.
Чего?
А, ну да, да, да, да. Это сути не меняет. Спасибо. Ну вот. Вот так.
Вот так. Вот так. Все хорошо. Ну да, оно может быть в принципе ноль, но нам не важно. Главное, что оно не отрицательно.
Ну и это значит, это значит, это значит, что надо что-то оценить тоже снизу. Наверное, вот эту вещь. Какой-нибудь m-кой, да?
m-кой, m-кой, m-кой. Да. Значит, тогда получается, что p и t житое от ноль плюс n больше либо равна.
И вот эту вещь мы напишем, что она больше либо равна, чем m житое от n. Видите, для этого нам нужна неотрицательность вот этой скобки.
Иначе мы не сможем такую оценку записать. Но слава богу, эта вещь не отрицательна. Это больше либо равна m житому.
Значит, это больше либо равна. Сейчас, ребята, вы не волнуйтесь, сейчас все это схлопнется и будет хорошо.
Тут приходится, видите, напрягаться очень. Но ничего не поделаешь. m житое от n умножить на сумму всего того, что там стоит.
Плюс вот эта вещь. А что вот это такое? Ну, дельта мы можем вынести.
Здесь стоит вероятность из ж в л за n шагов и из л в ж за n шагов. Это в точности p из ж в ж за 2 n шагов.
Плюс дельта на p из ж в ж за 2 n шагов. Вот. А теперь что стоит в этой скобке? И сумма еще по ж берется.
Нет, по л. Сумма по л берется. Что здесь у нас такое? Смотрите, мы суммируем по второму индексу.
Значит, это суммируется в единицу и это суммируется тоже в единицу. Видите? Мы суммируем по второму индексу.
Первый неважно какой. И хоть и, хоть ж, хоть какой. Получается 1 минус дельта. На самом деле вот это все это 1 минус дельта.
Вот. Так, хорошо. Значит, вот это больше либо равно этого для всех и и ж. Значит, и минимум этой штуки по и тоже больше равных всех.
Еще раз. Вот эта вещь, она больше либо равна этого для всех и. И обратите внимание, правая часть от и не зависит.
Значит, и минимум этого по и больше либо равен того всего. Раз по всем и больше либо равно всего. Значит, минимум больше либо равен всего.
А минимум этого, это есть m житая от n 0 плюс n. Мы получаем что-то больше либо равно, чем m житая от n на 1 минус дельта плюс дельта p.
Да, это мы оставляем. Житая житая 2n. Вот. То есть нам нужны какие-то оценки на изменение m, чтобы показать, что их разница m большого и m маленького стремится к нулю.
Ну, здесь вот такими очень тонкими оценками мы получаем это. Что касается m большого, то аналогично можно получить, что это меньше либо равно, чем m житая от n на 1 минус дельта плюс та же самая дельта p житая житая 2n.
Она сейчас нам вообще никакой роли играть не будет. Вот. Так что вычитая одно неравенство из другого, мы приходим к разности между ними.
Видите, у нас там появляется множитель 1 минус дельта. Вот в этом ключ ко всему. Это значит, у нас здесь будет геометрическая прогрессия какая-то.
Ну, не прогрессия даже, а степенная зависимость, стремящаяся к нулю.
Так что мы получаем, что m большое житое от n 0 плюс n минус m маленькое житое от n большое плюс n, что это не превосходит m житое от n
минус m житое от n маленькое на 1 минус дельта.
Вот. Отсюда следует, что если мы возьмем k n 0, повторим даже то же самое, минус m житое k n 0 плюс n, вот это будет не превосходить
Значит, m житое от n минус m житое от n на 1 минус дельта в степени k.
Ну, даже нет, мы не то чтобы повторяем, мы на самом деле пользуемся вот этим неравенством. Мы рассматриваем вот это, вычитаем m 0,
Ну, как бы рассматриваем его для n, которое равняется k минус 1 и 0, лишь такое в этом роде.
Вот, пишем вот эту оценку, потом уже для вот этой разности тоже пишем оценку сверху, и у нас там снова умножается на 1 минус дельта и так далее и так далее.
То есть мы устраняем все вот эти k и 0, но тогда здесь будет уже 1 минус дельта в степени k.
Вот, так что это просто многократное применение вот этой формулы, вот этих оценок сверху, потому что здесь стоит разность, здесь стоит разность.
То есть вот это оценивается, вот это оценивается, все, по цепочке.
Ну вот, то есть получается, формально говоря, что есть некоторая подпоследовательность n-катах, которая стремится к 0,
потому что видите, если k устремим в бесконечности, то вот эта разность будет стремиться к 0.
Значит, есть некая подпоследовательность номеров, что вот эта стремится к 0.
Но дело в том, что вот это монотонно не возрастает, а это монотонно не убывает.
Значит, если по некоторой подпоследовательности вот эта штука стремится к 0, значит, тогда и просто для последовательности mjt от n минус mjt от n сходится к 0.
Просто в силу монотонности, в силу монотонности, в силу монотонности последовательностей mjt от n, mjt от n.
То есть если вы имеете какую-то последовательность, которая не убывает, и по некоторой подпоследовательности она сходится,
то тогда и по всей последовательности она сходится.
Ну вот, мы показали, что эта штука, эта разность стремится к 0.
Значит, p житая, зажата между двумя подпоследовательностями, это возрастает, это убывает, их разность стремится к 0.
Это означает, что у p этого житого существует предел.
А все потому, что начиная с некоторого номера, m маленькая, строго больше 0.
Потому что там минимум p и и житых от p, мы выяснили, что начиная с некоторого номера эти p больше 0,
поэтому начиная с некоторого номера и m житая больше 0, и она не убывает.
Ну все, значит, а у p этого житого, который между ними, есть предел.
Значит, ему некуда деваться, как сходиться к чему-то положительному,
потому что его снизу подпирает m, который начиная с некоторого номера положительный.
И значит, слева и справа вот эти подпоследовательности, они не зависят от i.
Так что то, к чему сойдется, p и t житая тоже от i не зависят.
Вот такая теорема. Да, она очень большая, такая запутанная.
Но доказывается она вот таким вот образом.
В одну сторону практически очевидно, а в другую нужно делать серию вот таких вот нетривиальных оценок.
Но в чем здесь еще раз вот я хочу общий скетч доказательства вам рассказать.
Значит, смотрите. Итак, мы доказываем, что цепь оргодична тогда и только тогда,
когда она неразложимая и непериодическая.
В одну сторону очевидно, практически очевидно, из оргодичности следует неразложимость, непериодичность.
Мы аккуратно показываем, что все p-етые житы от n больше 0.
Ну просто потому, что предел положительный у всех p-етых житых от n существует, и цепь конечная. Отлично.
В обратную сторону, если она неразложимая и непериодическая.
Первый шаг. Мы доказываем, что p-етые житы от n, начиная с некоторого номера общего для всех i и g, строго больше 0.
Вот. И чтобы это доказать, мы опираемся на некую лему из теории чисел.
Просто потому, что цепь непериодическая, значит существуют взаимно простые числа,
а любую номер раскладывается по этим взаимно простым числам.
Мы вспоминаем формулу из первой лекции по цепям Маркова. Пишем эти неравенства.
Ну и все. Получается, что p-етые от n больше 0 для всех n, а они сообщаются, значит и p-етые житы больше 0 для всех n.
Вот. Мы доказываем больше 0. Далее мы рассматриваем нашу p-етую житую от n и ограничиваем ее снизу и сверху
некоторыми вот такими последовательностями. m-малый и m-большой.
Показываем, что они изменяются монотонно. Одна монотона не убывает, другая монотона не возрастает.
Потом доказываем, что их разность стремится к нулю. Все. m отделена снизу нулем.
Вот. Значит, предел существует обязательно не к нулю. Вот. И он не зависит от i. Все.
Ну, такое как бы вот. Все остальное, по сути, это технические детали.
Вот я вам общий скетч сказал. И вообще, когда вы на экзамене будете рассказывать эту теорему,
расскажите сначала вот эти общие идеи, которые за этим стоят.
Потому что все остальное, это просто некоторая техническая возня.
Ну да, какие-то тут оценки надо написать, несколько раз ту формулу хитрую нашу применить,
какой-то умный 0 добавить. Ну понятно, что это уже технические моменты.
Важно очень, чтобы вы понимали именно суть того, что здесь происходит и откуда это все получается.
Вот так. Значит, следующая теорема.
Эта теорема, она попроще, хотя пунктов в ней больше.
Про то, какие же следствия мы получаем из того, что цепь эргодическая.
Потому что я-то начал вообще эту лекцию со стационарного распределения.
А при чем тут вообще стационарное распределение?
При чем тут предельное поведение цепи?
Вот на все эти вопросы отвечает следующая теорема.
А это инструментальная теорема.
Она нам нужна просто, чтобы уметь определять, является ли цепь эргодическая или нет, просто посмотрев на нее.
Видите, что она не разложимая, не периодическая. Все, сразу она эргодическая.
Но что происходит в такой цепи?
Что происходит в эргодических цепях?
Теорема о предельном распределении.
В конечных эргодических цепях
первое.
Существует С больше нуля и РО от нуля до единицы.
Такие, что Pt житые минус P житые, вот эти пределы, к которым сходится Pt житые,
не превосходит С на РО в степень Н.
Просто следует из оценок на М, М маленькое, М большое.
Второе. Числа P житые задают распределение.
Вот эти предельные P, это не просто какие-то числа.
Они задают распределение, они не отрицательные, и в сумме они дают единицу.
Вот это второй пункт про это.
Третье. Мы сейчас все докажем.
Третье.
Это распределение, вот из этих P житых, является стационарным.
Значит, Pt житые сошлись не просто к каким-то числам, а именно к стационарному распределению.
Четвертое.
Это стационарное распределение является единственным для цепи с такой матрицей переходов P.
Больше других стационарных распределений нет.
И пятое. Распределение состояний P житые от N сходится к вот этим P житым.
Вот так вот. Распределение сойдется к вот этим P, о которых речь идет здесь.
Причем независимо от того, какое было начальное распределение в цепи Маркова,
независимость от начального распределения в цепи, оно сойдет сюда.
Не важно, откуда вы стартовали, распределение будет вот таким P,
которое является пределом P итых житых.
Поэтому иногда вот это P называется предельным распределением.
Доказательства.
Давайте докажем.
Первый пункт.
Откуда это следует?
Дело в том, что P ит житая минус P житая не превосходит вот этих вот разниц между M большим и M маленьким,
которые его оценивают.
То есть это не превосходит, чем M житая от N минус M маленькая житая от N.
Вот. А мы выяснили с вами, что вот эта вещь, она не превосходит...
Чего она не превосходит? Она не превосходит...
Как это у нас было?
Как бы это написать-то?
Не превосходит, не превосходит, не превосходит.
1 минус дельта, начиная с некоторого номера.
Это все мы пишем.
Любых N, больше либо равных некоторого N0, которые обязательно существуют.
Так.
Сейчас, как там...
У нас это было N0 плюс N.
Здесь у нас N.
Значит, здесь я должен написать N, разделить на N0.
Какую-нибудь целую часть взять.
Вот. Может быть, плюс один.
Вот так.
Ну, неважно. Разность у нас оценивается сверху,
как некое число, больше 0, 1 минус дельта, в некоторой степени,
возрастающее N.
Вот. Так что отсюда следует, что существуется 0 и ρ от 0 до 1.
По сути, это вот этот наш 1 минус дельта.
Ну, быть может, с каким-то только коэффициентом.
И ρ от 0 до 1 такие, что модуль Питв житого от N минус П житая
нас не превосходит С на ρ уже в степень N.
Вот. Ну, начиная с некоторого N.
Ну, да. Либо начиная с некоторого N,
ну, либо, если С достаточно большим взять,
то вообще даже при N больше либо равных единицы.
Можно и так на это смотреть.
Короче говоря, все это следует просто из вот этой разности.
Она не превосходит, как некая, 1 минус дельта в какой-то степени.
Хорошо. Теперь второе.
Числа П житые задают распределение.
Откуда это следует?
Мы должны взять просто и рассмотреть вот эту сумму.
По всем ж из С Пит житая.
Сумма по всем ж вот этих вещей, она равна единице.
Сумма по второму индексу нам дает всегда единицу.
Здесь конечное число слагаемых.
Давайте мы перейдем к пределу по N.
Здесь мы не по N суммируем, мы суммируем по ж.
N здесь как бы вот просто число.
Но если мы здесь перейдем от N к бесконечности,
то справа, то есть переходим при N к бесконечности,
справа мы должны получить единицу.
А слева в пределе вот эти стремятся к П житам.
Сумма по ж от С П житая.
Здесь конечное число слагаемых.
Каждый слагаемых стремится к П житому своему.
Переходим к пределу.
Равенство сохраняется в пределе.
Так что вот.
И так как П и Т житые не отрицательные,
туда их пределы тоже не отрицательные.
Но они даже положительные.
Получается, что П житые все положительные,
их сумма равна единице.
Это означает, что П житые это некое распределение.
Некое распределение вероятностей.
Так.
Хорошо. Третий пункт.
Это распределение П житых является
стационарным распределением.
Это просто вот откуда-то следует.
Сумма.
Сейчас, нет. Не так, давайте.
Мне нужно, чтобы равенство было.
П и Т житые.
Давайте так.
Н плюс один
равняется сумме
по всем
МЛСС
на П
и Т житые
от Н
на П
а П и Т
л Т
от Н
на П л Т житые.
Вот.
Ну и снова здесь
конечное число слагаемых.
Мы переходим к пределу.
И когда мы перейдем, мы получим
здесь П житые
равно
сумма Л из С.
Здесь мы получаем
П л Т
а здесь П л Т
житые.
Вот.
Но это равенство
в матричном виде как раз записывается
как П, транспонированное
на П, равняется П.
Вот.
Вот видите, мы здесь суммируем
по первому индексу, поэтому эта матрица P
не P умножается
на этот П л Т, а П транспонированно умножается.
Потому что сумма здесь по первому индексу идет.
Так что это распределение
оно стационарное по определению.
Вот так. Четвертое.
Это стационарное распределение
распределение единственное. Допустим, здесь от противного
пусть Q другое, какое-то стационарное, другое стационарное
распределение. Ну тогда мы знаем, что Q – это есть
P транспонированное на Q, P транспонированное в любой
степени на Q, а P транспонированное n – это P от n. Ну да, мы можем
даже так написать. Это равняется P от n Q, где это уже матрица
перехода за n шагов. Ну давайте мы это напишем. Q значит
gt равняется сумма P. Ой, здесь транспонировано. Да,
тогда l на g от n Q g, а сумма по l из s. Вот, это я просто
записал то, что Q равняется P на Q, как бы в покомпонентной
форме. Ну и снова переходим к пределу. Вот эта вещь
сходится к P житому. Вот, от l не зависит. Так что когда
мы перейдем к пределу, у нас получится равенство
Q житое равняется P житое, которое мы вынесем за эту
сумму, потому что она от l не зависит, умножить на
сумму. А, подождите, а почему здесь Q житое? Сейчас. Мы
матрицу умножаем на Q. Здесь у нас пробегается, а, здесь
l должна быть. Я ошибся. Вот, здесь l должна быть. Так,
здесь остается только сумма l от Q лт. А Q лт распределение,
сумма его компонента равна единице. И мы получаем,
что Q житое равно P житому. То есть мы предположили,
что если у нас будет какое-то стационарное распределение
Q, вот тогда мы видим, что оно обязательно должно совпадать
с этими числами P. Так что это распределение единственно
стационарное. Вот. Ну и пятая, пятый пункт, наконец-то
последний. Почему распределение вероятностей сходится
к этому стационарному распределению. Значит, пятый пункт. Значит,
у нас P от n, это есть P транспонированное от n на P от нуля. Вот.
Ну и если это расписать, мы получаем P житый от n равняется
сумма l по s P l на ж от n на P l от нуля. Вот так. Это мы
просто расписали. Снова переходим к пределу. Если
мы перейдем к пределу, мы получаем, что то, что стоит в правой части,
здесь опять конечное число слагаемых, вот это стремится к P житому. Мы его
выносим за эту сумму, и у нас получается P житая умножить на сумму l по l. А эта
сумма равна единице. И неважно, какое P l от нуля. Это все равно распределение,
и сумма всех его компонентов равна единице. Получается, что P житая n сходится к P житому.
И этот предел не зависит от начального распределения. То есть представьте себе
цепь эргодическую, конечную. И какое это начальное распределение? Вы знаете,
с какой вероятностью вы находитесь здесь, с какой вероятностью здесь и запускаете ее.
И долго цепь эволюционирует, n стремится к бесконечности. Тогда распределение на
состояниями устаканится со временем. И это распределение будет определяться вот
этими P, вот к этому распределению, которое определено для P житых. Вот к нему все
сойдется. И неважно, как вы изначально распределили. Ваше распределение изначально
может быть выраженным. То есть вы можете стартовать из какого-то одного
определённого состояния, то есть у вас там вот есть какая-то цепь, да, там какая-то цепь, там
куда-то ещё, там вот так вот, допустим, такая вот хитрая. И вот, допустим, начали отсюда, вы знаете,
что в начальный момент времени вы инициализируете здесь. Ну и потом пошла цепь эволюционировать
какие-то прыжки в какие-то состояния, долго-долго подождёте, и в пределе вы получите какое-то
распределение над этой цепью. С какой-то вероятностью вы в пределе будете находиться здесь,
здесь, здесь и здесь, при большом n. И вот каково это распределение, оно не зависит от того,
где вы инициализировались. И вообще оно не зависит от того, какое было начальное состояние,
не обязательно вырожденное, что вы начинаете с одной точки, а вообще как бы. Вот в этом как бы
состоит здесь эргадичность. И вот это P, к которому всё сходится, предельное вот это распределение,
это есть, смотрите, что такое, так как оно удовлетворяет вот этому равенству, это есть просто
собственный вектор матрицы P-транспонирования, отвечающий собственному числу λ равняется единице.
Так что всё в пределе сводится вот к этому распределению, в конечных эргадических цепях,
всё в пределе сходится к нему. А он есть собственный вектор, ну, нормированный, естественно, на единицу,
сумма его компонента жамает равна единице. Вот, собственно, вектор вот этой вот матрицы
п-транспонирования, всё сходится к нему в конце концов. Вот. Так, вот такая вот эргадичность.
Ну и последняя теорема, которую я приведу, значит, она у вас тоже идёт с доказательством,
это закон больших чисел, но для марковских цепей. Вот эта теорема, она очень важная,
она устанавливает как раз связь между средним по времени и средним по пространству.
Значит, теорема, закон больших чисел для конечных
эргадических цепей маркова. Ну, иногда вот эту теорему называют эргадической теоремой. Значит,
в конечных эргадических цепях маркова единица разделить на n плюс один сумма k равнеется от нуля
до n индикатор x ката равнеется житым. Но я сейчас поясню здесь, сходится по вероятности при n
стремящемся к бесконечности к пожитым, тем самым пожитым, которым предел поитых житых. Вот. Значит,
что здесь вообще написано? Представьте себе снова марковскую цепь, вы её где-то инициализируете,
неважно как и где, и запускаете. И в процессе, пока она работает, вы регистрируете, у вас счётчик
есть, сколько раз она побывала в том или ином состоянии и делите это на общее количество шагов.
Вот эта чистота, она написана здесь, в левой части. Видите, мы взяли какое-то состояние g и смотрим,
сколько раз мы бываем в этом g. И тут эта сумма, сумма индикаторов того, что мы побывали в g. Ну,
и делим на число шагов. И если n стремить к бесконечности, то вы обнаружите, что эта чистота,
она будет сходиться к чему? К пожитому, тому самому предельному распределению, которое там у нас
находится. Это называется среднее по времени, это среднее по пространству. Вот эта связь.
Эта теорема важна для практики. Представьте себе, на основе этого, кстати, работает,
в частности, и гугловский алгоритм ранжирования страниц. Представьте себе, что вот есть сеть,
компьютерная, ну и сайты там состоящие, они как-то взаимосвязаны. Вы моделируете
поведение пользователей в этой цепи как дискретную цепь Маркова. Пользователи попадают в эту сеть,
пользователь попадает в сеть. И как бы прыгают между страницами, по сути,
прыгают между вершинами вот этого графа. И что происходит? Мы можем посчитать,
ну мы можем в принципе определить граф такой цепи. Правильно? Граф будет очень большой. Если мы
хотим посчитать как бы стационарное распределение, то нам бы для этого пришлось решать вот это
уравнение. Потому что мы знаем, что в пределе его поведения и стационарное распределение они вот
этим свойством обладают. Поэтому задача сводится к тому, чтобы найти собственный вектор этой матрицы.
Но вы представьте себе, что компьютерные сети, сколько сайтов всего, их очень много. Так что вот
эта матрица, даже для каких-то там локальных сетей, она очень большая. И найти ее собственный вектор
очень трудно. Что-то реально огромная матрица. Как ты будешь искать у нее собственный вектор. Это
очень тяжелая вычислительная задача. Но благодаря вот этой связи это становится возможным. Что
реально делается? Вы запускаете реальных или виртуальных пользователей и просто смотрите,
на каких сайтах они бывают и сколько раз. И просто долго ждете. Тогда для каждого сайта вот эта
частота, она сойдется к некоторому числу. У этого числа есть не что иное, как в Антапе.
То есть такой имперический подход к вычислению П. Не просто линейная алгебра. Некая матрица,
ищем ее собственный вектор. Матрица-то большая, это тяжело. А имперический подход или метод
Монте-Карло. Зачем нам это читать? Мы запустим пользователей и посмотрим, что будет. Вот этот
результат, он подтверждает, что так можно делать. Что вот эта частота, она действительно сойдется
к компонентам стационарного распределения. Вот так. Доказательства этой теоремы я полностью
писать не буду. Вы его найдете в PDF, оно довольно техническое. Я просто здесь отмечу вам тоже скетч.
Доказательства большое, но на самом деле доказательства этой теоремы проще, чем доказательства
эргодической теоремы, которая была до этого. Потому что та теорема, она одновременно во многом и идейная,
и техническая. И очень тонкие оценки в эргодической теореме приходится производить. Здесь же оценки,
которые приходится производить, они очень грубые. Причем я эту теорему взял изначально из книжки
и там даже оценки они написали более точными, но даже с более грубыми оценками все равно получается
доказывать эту теорему. В PDF вы все эти оценки найдете. А я вам сейчас просто расскажу о том,
как вообще это доказывается. Ну почему, кстати, это называется закон большой числе? Потому что тоже
какая-то частота сходится к вероятности. Вероятность это математическое ожидание вот
такого индикатора. Потому что мат ожидания индикатора это среднее по пространству,
по вероятности по пространству, по пространству исходов. А здесь пренк предельный, это как бы
среднее по времени. Мы кауссимуляем бесконечности, ка это время. Поэтому закон больших чисел. Просто в
законе больших чисел Хинччина, Колмогорова, там нам дают последовательность независимых,
одинаково распределенных величин. Здесь же некое обобщение. У нас вот эти экскаты индикатора,
они не являются независимыми. В обычном законе больших чисел они независимы, а здесь они
независимы. Но они зависимы не произвольным образом. Экскаты они зависимы так, чтобы это
была цепь Маркова. То есть закон больших чисел для цепи Маркова. Но как это доказывается,
нам нужно установить сходимость по вероятности этого к тому. Что это значит? Это значит,
мы должны взять произвольное епсилон больше нуля и доказать, что вероятность того, что вот эта
вещь, давайте мы ее обозначим за, как я ее там обозначаю, за ню житая от n, вероятность модуль
ню житая от n минус p житая больше епсилон, что это сходится к нулю при n, стремящемся в
бесконечности. Нам надо доказать вот это. Как мы докажем это? Я говорю, эта теорема,
она только выглядит очень страшно, если вы посмотрите по дуевку, там действительно какое-то
большое доказательство. Вот если вдуматься, то ничего сложного идейно здесь нет. Мы просто вот
честно выписываем то, что нам нужно, пользуясь только определениями, никакими там теоремами,
мы ничем здесь дополнительным не пользуемся, просто как бы выводим все с нуля. Мы должны доказать вот
это. Значит, мы замечаем, что вот эта вероятность, про которую надо доказать, что она сходится к нулю,
больше епсилона, что она по формуле полной вероятности, это есть вероятность ню житая от n минус
p житая больше епсион. Формула полной вероятности, значит, сумма будет стоять при условии, что x,
что мы стартуем в начальный момент времени из i, на вероятность того, что мы стартуем в начальный
момент времени из i. Значит, по всем i из s. Вот. Это просто формула полной вероятности. Мы можем
докажем, что вот эта вещь стремится к нулю, если докажем, что каждый из вот этих вероятностей
стремится к нулю. А вот эта вещь, она проще, чем вот это. Вот. Так что вот это стремится к нулю.
Почему? Потому что теперь мы наше внимание сводим вот на эту вещь. Вот на эту p. Почему это стремится к
нулю? Видите, здесь конечное число слагаемых, это какие-то числа неотрицательные. Все слагаемые
стремятся к нулю, значит, все это стремится к нулю. Теперь откуда это следует? А здесь надо
применить неравенство Чебышева. Ну, помните, там вероятность того, что кси положительная больше
нуля, она у нас положительная, здесь модуль стоит больше эпсиона, не превосходит, чем мат ожидания кси
разделить на эпсион. Вот этой формулой надо воспользоваться для оценки вот этой вероятности.
Ну а чего у нас тут еще есть? Нужно оценить сверху вероятность, доказать, что она стремится к нулю.
Поэтому возьмем, поэтому возьмем, да и применим, это неравенство. И у нас получится, что вот эта
вероятность при условии, только у нас теперь усованная вероятность, не превосходит математического
ожидания. А, кстати, наверно даже нет и теоремы-то, потому что у меня здесь будет мат ожидания. Может
лучше вторым неравенством Чебышева воспользоваться. Слушайте, а давайте мы вторым неравенством Чебышева
воспользуемся. Это первое неравенство. Второе неравенство такое, вероятность модуль кси
минус мат ожидания кси. Вот давайте вот это, здесь модуль как раз, меньше либо равно, чем дисперсия. Вот кси разделить
на эпсион в квадрате. Вот так, вот так, вот так, вот так, вот так. Вот этим или нет. Сейчас, я вот думаю,
чем тут проще-то воспользоваться? Не, наверное, все-таки первым. Ну, либо этим, либо этим. Давайте так
даже. Вот так будет проще. Дисперсию какую-то считать неохотно. Мат ожидания квадрат пусть будет. Все,
вот этой пользуемся, вот этой пользуемся. Значит, получается, что так, кси квадрат больше эптилон,
все равно, что вот это больше. Сейчас я напишу. Мат ожидания ню житого от н минус п житого в квадрате
при условии x0 равняется и разделить. Давайте здесь я пишу квадрат, здесь квадрат. Туда это
сводится вот к этому. Разделить на эпсион квадрат. Во, вот так. Все, вот так. Так что мы докажем,
что это стремится к нулю, если мы докажем, что вон то стремится к нулю.
Только у меня сумма куда-то пропала. А, нет, все правильно. Сумма стоит в ню житом.
Так, по-моему, так. Я сейчас проверю. Да, все так. Все так. Ну и вот как бы вот в этом вся идея. Вот
всю идею я вам сказал. Мы пишем то, что нам надо по сходимости, по вероятности. Раскладываем это
то, что нам надо по формуле полной вероятности. Сводим задачу к доказательству, что вот эта
вещь сходится к нулю. И пишем для нее вот эту оценку. Неравенство Чебышева. Первое неравенство
Чебышева. Неравенство Маркова называется. Вот. Записали. Значит, мы докажем, что это стремится к
нулю, если вот это стремится к нулю. И дальше нужно просто честно оценить вот это математическое
ожидание. Здесь стоит квадрат чего-то. В этом чего-то ню это сумма. Надо возвести в квадрат
вот это все. Раскрыть скобки. Там, короче говоря, вот это математическое ожидание выразится в сумму
четырех слагаемых. И каждое из этих четырех слагаемых надо оценить сверху. Там просто супер
грубыми оценками. И будет видно там геометрические прогрессии повсюду, что все это стремится к нулю.
Может быть, кто-то из вас, кстати, сможет значительно сократить вот эти выкладки. Попробуйте.
Я там делаю просто супер-грубо, чтобы вообще полностью мозг выключить. Но на самом деле такое
ощущение, что это можно как-то сделать очень коротко. Вот подумайте над этим. Посмотрите в
ПДФ-ках. То есть дальше идет чисто дело техники. Вот эта вещь оценивается сверху. Вот. Четыре
слагаемых оцениваются сверху. Там вполне понятным образом. Ничего больше содержательного там нет.
То есть чисто дело техники. Так что эта штука сходится к нулю. Этой штуки сходится к нулю.
Значит, это сходится к нулю. И мы получаем доказательства этой теоремы. Вот. Вот, собственно, и все.
Теперь. Все вот это обсуждение органичности мы проводили для конечных цепей. Что в счетных
цепях? Значит, в счетных цепях известно следующее. Цепь, счетная цепь Маркова, она является
эргодической тогда и только тогда, когда она неразложимая, непериодическая и не нулевая. Вот
третья. Конечные цепи неразложимые, они все не нулевые. Было у нас на прошлой лекции. А вот
счетные цепи могут быть нулевыми. Но если цепь неразложимая, непериодическая и не нулевая,
то она эргодическая. Так что это критерий для счетных цепей. Цепь эргодическая тогда и только
тогда, когда вот эти три условия выполнены. Значит, свойства, которые я написал, они выполняются для
счетных цепей. Ну, со второго по пятое. Со второго по пятое свойства выполняются для счетных цепей тоже.
Насчет первого, кстати, не уверен. Возможно, тоже, либо при каких-то условиях. Ну, ладно,
по крайней мере, со второго по пятое свойства тоже выполняются и в счетных цепях. Ну, мы для
доказательства их существенно пользовались чем? Помните, у нас там левая часть равняется правой.
Перейдем к пределу. Приделу существует, все хорошо. И мы пользуемся там конечностью. У нас там
конечное число слагаемых. Каждый слагаемый стремится к нулю, все хорошо. В счетных цепях у вас как бы ряд,
каждый слагаемый стремится к нулю. Но как это сказывается на сумме, куда она стремится, непонятно.
Вообще говоря. Так что, ну, это препятствие, оно преодолевается теоремой омажерированной
последовательности. Дело в том, что там, конечно, стоят ряды некоторые, но можно написать оценки
хорошие, потому что там они умножаются на вероятности. Вероятность от нуля до единицы. Сумма
вероятности исходится к единице. Вот этим можно воспользоваться. То есть теоремы омажерированной
последовательности. Так что как бы то, что цепь там конечна-неконечна для этих выкладок,
это вообще не принципиально на самом деле. Вот. Мы хоть и пользуемся, потому что нам это просто,
но даже для рядов там тоже все получается. Вот. Вот так. Так что на счетной цепи, в принципе,
тоже это обобщается. Ну, вот это утверждение критерий для счетных цепей эргодичности,
это выберите как бы без доказательств, со звездочкой, если хотите, теорема. Ну, а вот эту
теорему про конечные цепи, вот ее конечно надо знать. Вот. Доказательства, хоть оно и очень
запутанное. Вот. Неплохо было в нем разобраться. Ну, по крайней мере, вот скетч какой-то иметь в
себе, как это все доказывается. Вот. Ну, вот. Вот. Это, наверное, все, что я хотел вам рассказать про
дискретные цепи. Можно много других еще теорем получать интересных. Например, что в конечных
цепях всегда существует стационарное распределение. Это очень красивая теорема, ее можно по-разному
доказывать. И это есть некое применение теоремы брауэра о неподвижной точке. Оказывается,
там есть некий оператор. И стационарное распределение, это есть неподвижная точка этого оператора.
Это вы можете, например, у меня увидеть в моих семинарах. Это не входит у нас, по-моему, в программу
и в билеты. Но, тем не менее, такая теорема есть. Она очень красиво доказывается. Можете ее посмотреть.
Какие-то там другие тоже теоремы можно найти. Например, что для несущественного состояния,
если есть стационарное распределение, то предельное распределение для несущественного
состояния равно нулю. Так что в этом векторе стационарного распределения компоненты,
которые отвечают несущественным состоянием, они равны нулю. Это тоже можно доказывать. Много
таких мелких утверждений разных можно доказывать. Еще целый семестр на изучение всех этих интересных
вещей может уйти. Ну а мы с вами на этом дискретные марковские цепи заканчиваем. И в следующий раз
переходим к непрерывным марковским цепям. Вот так вот.
