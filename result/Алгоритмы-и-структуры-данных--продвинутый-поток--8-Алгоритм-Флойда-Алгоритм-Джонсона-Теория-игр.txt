Вот. Ладно, поехали. Значит, смотрите. А, ну вот, да. А, ну да, если, да, как называется
бгуир, да, он называется вот так вот, понимаете, да. Вот. Вот. Значит, поехали. Значит, что у нас
сегодня? Так, флойд. Так, ну здесь достаточно коротенько скажем. Да, флойд. А, ой, у нас не
только флойд. Ой, у нас еще Джонсон. Ой, кошмар какой. Ладно, играм придется чуть-чуть подождать.
Значит, смотрите. Значит, какую задачу мы сегодня хотим решить? Ну, в прошлый раз мы активно решали
задачу найдите кратчайший путь от одной вершины до всех остальных. И много в том преуспели. Вот.
Сегодня мы хотим немножко повысить планочку. Сегодня мы хотим найти кратчайшее расстояние
между всеми парами вершин. То есть задача называется АПСП. Потому что all pairs. Там all pairs, там shortest path.
Вот. Ну, значит, смотрим. Ну, посчитать. Вот сейчас мы, сейчас мы на эту тему будем думать. Вот. Значит,
ну раз у нас all pairs и хочется, то есть, ну в первую очередь, хочется найти хотя бы расстояние. Ну,
чтобы найти расстояние между всеми парами, это, то есть, по сути, мы хотим посчитать какую-то
матрицу. Ну, и здесь, наверное, логично может быть, как минимум, поначалу и сказать, что у нас
действительно граф задан в виде матрицы смежности, где там вытяжитое чеки, написан вес, там минимальный
вес ребра, соединяющего эти две вершины. Ну, мог быть кратные ребра, но в контексте кратчайших
путей, там от кратных ребр можем оставить только ребро с минимальным весом. И вот нам очень хочется
найти между любыми двумя вершинами кратчайшие пути. Спрашивается, как же это сделать? Вот. Ну,
это оказывается, здесь можно по-разному к этому делу подходить. Ну, во-первых, давайте начнем с
простого. Первое, что скажем, давайте пока скажем, что циклов отрицательного веса у нас нет. Это мы
говорим, ну, для чего мы это говорим. Да, правильно, мы это говорим для того, чтобы говорить, что кратчайший
путь между любыми двумя вершинами существует, если существует путь хотя бы какой-то. Вот. Как вы
в прошлый раз убеждались, что у нас кратчайший путь между двумя существует только тогда, когда нет
цикла отрицательного веса, через который можно пройти. Вот. Итак, вот у нас есть матрица смешность.
Ну, вот, оказывается, если вы хотите превратить ее в матрицу кратчайших путей, точнее кратчайших
расстояний, то, оказывается, работает предельно простой код. Вот. Ну, тут по-разному можно рассказывать,
но вот, как всегда это называется, да, не помню в свое время, когда-то рассказали так, и это было,
выглядело как магия. Да, да, да, да, да, да. Вот. Я запишу это даже еще в более коротком виде.
Вот. Все. Вот этот мистический код вам всех кратчайшие расстояния найдут. Так, что, нет?
Флойд пишется как-то не так? Мне в свое время это рассказали, как вот здесь перепутаешь циклы местами,
получишь VH62 и будешь долго искать. Не, VH62 это неплохо еще, да. Да, да, да, да, да. Но там нет, это уже
отдельная песня, там есть классическая задача, видно, что тут вставляется еще цикл 4L и там для
каждой перестановки поймите вообще, флойд работает или нет. Там либо приведите контрпример, либо скажите,
что да, это работает. Попытаться профануть каждую. Да, да, да, да, да, но это хорошая математическая
задача, да. Вот. Так, ну а мы как-то сейчас должны сделать более простую вещь, мы должны доказать,
что это работает. Вот спрашивается, как это, как доказать, что это работает? По индукции.
По индукции почему и какое утверждение? Видимо хочется доказывать, что мы когда закончим работать с
некоторым конкретным K, то у нас уже будет ну как бы оптимальное расстояние, если проходить через
вершины K. Да, да, да. Ну давайте так, я вот только аккуратно сформулирую, чтобы было надежно. После K
итерации, ну я думаю понятно о чем речь, да, после K итерации, АИТЖТ не превосходит, давайте будем
аккуратно говорить, кратчайшего пути, кратчай, вот кратчайшего путинот, точнее так даже,
кратчайшего среди всех путей, вот так даже. Сейчас, кратчай среди всех путей, проходящих только
через там 1, 2 и так далее K. Вот, ну можно вот, да, не знаю, может быть, можно доказать,
что доказать и равенство, хотя я в этом честно говоря не уверен. Ну там можно делать что-то такое,
типа давайте между какими-то абстрактными ИИЖ рассмотрим кратчайший путь, рассмотрим через
какие вершины он проходит и возьмем там максимальную среди, по номеру, поймем, что когда мы пытаемся
релаксировать, ну можно и так, ну да, можно и так, да, можно и так, ну вот там, ну да, по всякому,
да, можно и так, можно и так, да, ну тут по всякому в общем пойдет, вот, ну то есть самое простое может
быть вот такое, но здесь доказательства достаточно очевидны, там база индукции, понятно, что после
нуля итерации там кратчайший, как бы тут АИТ и ЖИТ они происходят кратчайшего пути, который не
проходит ни через шо. А шо это за путь, который не проходит ни через шо? Правильно, собственно,
прямое ребро. Ну прямое в смысле, реально прямое, а не в смысле ДФС, естественно. Ну мы не знаем,
слава богу, что это такое, поэтому не сморачиваемся. Вот, соответственно, ну вот, ну а дальше честно по индукции,
да, что если мы хотим кратчайший путь, проходящий через вершины одного ДК, то значит кратчайший путь
либо не проходит через вершину К, и тогда он, собственно, уже был найден ранее, да, на предыдущей
итерации, либо он проходит через К, и, но тогда это должен быть состоять из кратчайшего пути от ИДК и
кратчайшего пути от КДЖ. Вот, меньше либо равно тут стоит, потому что в процессе там КТ итерации
может быть АИТ и КТ и поменялось, ну там на самом деле нет, но зачем нам с этим, в общем-то, заморачиваться.
Вот. Вот, так что получается кратчайшее расстояние, ну вот, кратчайшее расстояние найдено. Правда,
остается такую деталь, которую мы немножко вот, хотя нет, в прошлый раз мы ее как бы не упустили,
даже наоборот мы так сильно заморочились. Вот, а как восстанавливать кратчайшие пути?
Чего? Чего хрень двумерного порядка?
Так, ну правда, как всегда, нам придется при этом тогда доказать, что
если вы там, вот, допустим, у вас, да, то есть, допустим, вы действительно будете хранить,
так сказать, это, как мы это назовем, то есть, допустим, у нас возникнет там ПР и ТЖТ,
которое будет вот там, если тут СМИН равно сработало, будем сюда К записывать, то как
вот тут возникнет такой, действительно, вопрос на тему зацикла. Верно ли, что когда вы, действительно,
разобьете путь на ИК и КЖ, да, то есть, верно ли, что ПР и ТКТ будет меньше, чем ПР и КТЖТ?
Ну, потому что, смотрите, как, если я правильно, значит, понял, восстанавливается ответ. Мы берем
вот этот ПР и ТЖТ, говорим К, значит, как бы между ИЖ будет К. Теперь нам, чтобы восстановить путь
между ИЖ, надо восстановить путь между ИК и восстановить путь между К и Ж. Как мы его будем
восстанавливать? Мы на ИК возьмем ПР от ИК. Ну, там, возьмем и так вот будем восстанавливать.
Теперь у нас есть какая-то вопрос. Вот. Ну, как бы, ну, правда, сразу у нас есть какая-то вопрос,
почему это вообще не зациклится этот процесс? А если трясательные ребра, то оно вполне себе может зациклиться.
Нет, то зациклится по какому параметру? Нет, главное, главное, чтобы у нас уменьшался не А, а ПР,
потому что, да, длина вот этого пути может быть больше, чем длина вот этого пути вполне, да,
потому что, напоминаю, у нас... Ну, философский вопрос.
Ну, смысл, может, нет, ну, может, смысл есть, а смысл его не делать, если там, например, есть цикл длины ноль.
Вот бывает такая подлянка. Может, может, там этот путь, как-нибудь вот найденный путь, вот как-нибудь вот так устроен.
Давайте приоритетировать, когда мы переписываем. Давайте мы тогда будем приоритетировать приоритетировать путь, в котором меньше ребра.
А как вы это будете делать? А мы можем вообще делать так, что мы делаем мин равно, только если штука стала меньше.
Да, но это... Ну, так и есть, да. Понятно, что там ПРС будет обновляться, только если тут получилось строгое обновление. Это да.
А можно все-таки вот этот вопрос? Почему у нас может быть путь от И до К длиннее, чем от И до Ж?
Ну, потому что у нас веса ребер могут быть отрицательными. Может быть, тут 5, 5, 5, и тут минус 3, минус 3, минус 3.
Тогда вот эта длина там больше, чем вот эта длина минус 3, минус 3, минус 3.
Ну, длина по весу, конечно, имеется в виду, да. Да, длина по весу, конечно, тут имеется в виду, а не по количеству ребер, да.
А если вот тут, если по количеству ребер делать индукцию, то у нас не получится?
Так, ну по количеству ребер. Тогда надо доказать, что действительно у того, что нам предложат, действительно тут какая-то длина ребер будет действительно такая.
Ну, правда, тут как бы вопрос, тут уже, это уже как бы тот, как мы начинаем ли мы тут еще хранить какие-то там количество ребер и пытаться их обновить.
Тут как всегда хочется доказать, что вот конкретно эта версия уже будет работать и не выдаст нам никаких проблем.
Ну, мы хотим доказать, что у нас падает количество ребер в качащем пути от И до К и от К.
Да.
Потому что мы качаем все это до К. Ребер меньше, чем в качащем пути от И до Жи.
Но мы знаем, что он проходит, но мы знаем, что качащий путь от И до Жи, это сначала от И до И до К, потом от К до И до Жи.
Так.
Да.
Ну, если К не размножит только, а, ну да, и что?
Ну, и что так, нет, а что, правда, это тогда, а кто сказал, что там вот, а кто сказал, что там в этом пути будет прям меньше ребер, мы будем именно его там восстанавливать.
Пока что не очень понятно.
Кому хорошо, пусть есть несколько ребер.
Мы хотим доказать, что среди нескольких качащих путей от И до К равной длины у нас будет выбран именно путь, в котором...
Нет, ну, что значит выбран? Мы путь... Нет, стоп, давай, тут надо точно формулировать, потому что мы никакой путь вообще не выбираем.
Восстановление нас любит.
Ну, я... Ну, восстановление ничего не выбирает.
То есть, ну, как, что значит восстановление выбирает? Восстановление, как бы, тупой алгоритм, который делает вот то, что тут написано.
Как бы, он пользуется только вот Ашками и ПРешками. Все.
А с какой стороны он пойдет?
Вот. То есть, как бы, он будет, то есть, будет какая-то получаться там вот какая-то последовательность там путей.
Где-то там будет веточка обрубаться, потому что выяснится, что качащий путь между двумя вершинами, это тупо ребро между ними.
Да, и там он тут обрубится. Но вершины будут появляться, появляться, появляться.
Теперь вот возникает вопрос... Ну, то есть, возникает вопрос, а, почему этот процесс закончится?
И, б, почему, если он... Почему, когда он закончится, это будет реально качащий путь, а не там какая-нибудь рандомная бяка?
Ну, можно, например, сделать вот это вот обновление не строгим, не строгим, рассмотреть максимальный путь.
Тогда у нас в последний раз одноидство на самой большой вершине в аппетитах.
Нет шансов нет. Но лучше наоборот строгим как раз. Нет?
Ну, можно и строгим.
Ну, лучше нет. Ну, тут строгим, потому что, да, реально там, потому что если будет не строгая, то тут там как раз эти циклы нулевой длины начнут сильно радовать жизнь.
Вот, так что лучше не надо. Вот.
Нет, ну тут по-разному можно делать, но тут... Ну, тут как?
То есть, вообще, конечно, можно приятную вещь сказать, что, да, у вас в каждый момент времени есть какая-то последовательность вершин, условно, да?
И заметим, что получается... Ну, вот. И если между каждыми двумя соседями брать качащие пути, то сумма будет в точности то, что нам надо.
Вот.
Вот. Но, собственно, останется вопрос, почему это хотя бы не зациклится, не говоря уже о том, что почему не может оказаться так, что там длина этого, там количество вершин на этом пути будет там два в степени чего-нибудь, потому что будет там зацикл нулевой длины какой-нибудь.
Ну, а поп... Не увеличивается в каком плане?
Пока это вершине, у нас получилось два куска, каждым из которых ребер не больше, чем в исходной части.
И как это связано с вот этим вот?
Не знаю, не консуль, а ты такая жесткая, жесткая. Мы всегда с тобой какие-то короткие куска.
Ну, я...
Ну, ты консуль, жесткая. Типа очень длинный такой же.
Хорошо.
Мога ли?
Сейчас, вот.
Вот.
Да, как всегда не все так просто оказалось.
Хотя, на самом деле, не очень понятно, зачем нужна индукция по числу ребер.
На самом деле, более проще будет, если индукция будет по ПРС.
В каком плане?
Потому что я утверждаю следующее.
То есть, вот я вот жутко утверждаю, что пусть у меня, допустим, К равно ПРС и ТЖТ.
Так вот, мистическое утверждение.
Значит, ПРС и ТКТ меньше, чем К.
И ПРС и КТ и ЖТ тоже меньше, чем К.
Потому что, смотрите.
Что означает от ПРС и ТЖТ?
Это означает, что именно на КТ и ТРЦ мы нашли кратчайший путь между ИЖ, правда?
Вот.
То есть, это означает, что, как бы, получается, кратчайший путь может проходить только через вершины от одного до К, но не может проходить только через вершины от одного до К-1, правда?
Значит, тогда мы сказали, что мы в этой ЖТ написали АИТКТ и АТКТЖТ.
Но теперь, обратите внимание, маленький приятный факт.
Тогда я утверждаю, что мы уже на этот момент кратчайшие пути от АИТКТ и АКЖ уже нашли.
Логично, да?
Причем даже не на КТ и ТРЦ, а перед КТ и ТРЦ, потому что КТ и ТРЦ, в общем-то, вот эти величины особо не меняют.
Ну, по крайней мере, пока у нас нет циклов отрицательного веса, конечно.
Если бы у нас там АКТ и КТ уже было меньше нуля, там, конечно, весело, но об этом мы чуть позже поговорим.
Но тогда отсюда следует, действительно, маленькая приятная вещь, что, действительно, кратчайший путь от АКТ и КТ будет в качестве промежуточных использовать только вершины от одного до К-1.
И, следовательно, вот эти поражки получаются такие.
Но более того, это рассуждение можно повторить.
Потому что мы понимаем, что кратчайший путь был найден до КТ и ТРЦ, то есть тут будет какое-то К' и К'-2, которые строго меньше, чем К.
Понимаете, да?
И, то есть, тогда получается, что вот этот путь уже был найден на КТ и ТРЦ, и перед КТ и ТРЦ были уже кратчайшие пути от И до К' и от К' до К.
Почему мы считаем, что мы можем найти ПРЭД раньше, чем КТ и ТРЦ?
Сейчас, чего еще раз?
Вот почему у нас ПРЭД и ТРЦ найден на какой-то ранней итерации?
Почему?
Ну, потому что перед КТ и ТРЦ значение АИТ и КТ уже было равно кратчайшему пути между И и К.
Почему?
Потому что мы АИТ и ЖИТой сказали, что оно равно АИТ и КТ плюс АК и ЖИТой на тот момент, да?
Именно на тот момент.
И обнаружилось, что это реально кратчайший путь.
Но если бы потом выяснилось, что АИТ и КТ не кратчайшие, то тогда, извините, мы просто из того же пути, что было и вот этой лучшей версии, извините, и АИТ и ЖИТой потом обновили бы.
То есть просто нашли бы лучший путь от ИЖИ, а это не так.
Ну, потому что что приятно, что если мы рассматриваем кратчайший путь, то любые две вершины нем соединяются тут именно кратчайшим путем.
Еще раз, почему мы не могли на КТ и ТРЦ сначала АИТ и КТ, а потом АИТ и ЖИТой?
Ну, потому что заметим, что АИТ и КТ на КТ итерации не обновляется.
Потому что АИТ и КТ пытается обновиться только через АИТ и КТ и АИТ и КТ плюс АКТ и КТ.
А циклов отрицательного веса у нас, напоминаю, нету, чтобы АКТ и КТ стало чем-то кроме нуля.
Поэтому вот такая вот маленькая фишечка.
Вот, так что получается, ну вот так, что тут вот получается вполне себе, по крайней мере, зацикла нет.
Сейчас, а почему не могло быть такое, что мы когда-нибудь в будущем обновили АИТ и КТ через какой-нибудь там ну большой АЖИ,
через какой-нибудь большой АК-штрих, и после этого через то же самое АК-штрих обновили АИТ и ЖИТая?
Ну, тогда и у АИТ и ЖИТого, тогда это КА не то КА, которое бы мы рассматривали.
Потому что КА это как бы что-то, то есть КА это сигнал, когда АИТ и ЖИТа обновлялась в последний раз.
Ну типа да, по факту да, то есть КА это не просто рандомное шута.
Вот, но правда тут остается только маленький тонкий такой момент уже симпатический.
Да, то есть получается, что хорошо путь не зациклется, потому что чем дальше, тем меньше кашки.
Но не слишком в том, что они что-то могут между левой и правой половиной повторяться.
Ну, само по себе это нас не особо, а вдруг подумаешь там будет цикл длины ноль.
Но возникнет маленькая проблема, как вы думаете, да.
А не возникнет ли такого, что количество вершин на этом пути будет там два в степени?
А то, видите, у нас каждый раз там на две части разделяется.
И получается не получится ли там, действительно.
Там длина этого пути в ребрах будет там два в степени какой-нибудь неприятный.
Вот, как вы думаете, не будет ли такой подленки?
В каком случае еще раз?
Ну, смотрите, ну, просто теоретически.
Ну, в том плане, смотрите, вот у нас мы тут разделяем путь на два, да.
И хоть у нас все вершины тут меньше к, и тут все вершины меньше к.
Да, но мы разделились там на две рекурсивные ветки.
Тут мы тоже разделимся на две ветки, и тут на две ветки.
Получается что-то типа два в степени к теоретически.
Кто сказал?
Нет, стоп.
Мы типа представляем путь в виде какого-то дерева, в котором все вершины уникальные.
Опа, а кто сказал, что все вершины уникальные?
У нас каждый раз слева меньше, справа меньше.
Ну и что? Да, тут меньше к, и тут меньше к.
Да, они все не равны к, они все меньше к, но вдруг тут кто-то меньше к, и тут кто-то меньше к.
И они совпали.
Ну теоретически да.
Ну да.
Да, ну да, да, браво, да.
То есть смотрите, утверждение, что повторяющихся вершин в таком восстановлении не будет.
Почему?
Потому что предположим, что, ну понятно, что к никому не равен, к уникален, да.
А предположим, что в процессе рекурсии там получилось, что какой-то повтор возник.
Ну тогда получилось следующее, что значит у нас есть и, мы дошли до вершины к, потом, потом, ну вот.
Пото, ну вот.
Ну точнее так, тут два момента, какие повторы появились.
Ну на самом деле да, будем доказывать по индукции, так сказать, по ПРР, что значит там все вершины уникальны, да.
Ну база понятна, что если ПРР равна, там ничему она не равна, потому что АИТ и ЖИТ это прямое ребро, то собственно там все понятно.
Вот, а теперь предположим, что мы восстановили тут путь без повторов и тут путь без повторов.
И предположим, что при этом дубликат возник.
Что это значит? Тогда получается, мы шли, шли, шли до к, а потом бабах и зациклились.
И потом дошли до ЖИТ как-то.
Но тогда заметим, что вот этот цикл можно в принципе выкинуть, потому что он веса не меньше нуля, значит как бы путь от него короче длиннее не станет.
От удаления его длиннее не станет.
Но тогда получается, что мы нашли кратчайший путь между ИИ и ЖИТ, или по крайней мере путь не хуже кратчайшего.
Вот, но который проходит, который не проходит через катую вершину, то есть он проходит только через вершины, которые по номерам строго меньше чем к.
А у нас такое невозможно.
Потому что мы вот уже говорили, что такое невозможно, да, потому что именно на катаэтерацию он вообще появился, до катаэтерации его не было.
Так.
Нет, мы доказали, что при восстановлении пути, то есть на восстановленном пути все вершины будут уникальны.
Нет, мы доказали, что их просто нет.
Да, тут фишка, просто такого не бывает.
Да, то есть мы поставили себе более страшную цель, то есть как бы если бы у нас была цель, там скажем, не заморад сказать, ой, тут какое-то мутное доказательство непонятно, давайте сделаем как-то надежно, то можно сделать вообще по-другому.
Может быть на отрицательный цикл тоже где-то восстанавливается.
Потому что, ну, идея будет такая, будем говорить, вот ищем корчайший путь, а ты дожи.
И говорим, назовем ребро какое-нибудь там, значит, ИЛ хорошим, там если, ну скажем, значит там вот это вот ребро, вот вес ребра от ИЛ плюс А от ИЛЖ оказалось там меньше либо равно, ну или просто равно, ну точнее просто вот равно АИТЖ.
Вот, то есть как бы вот это условие означает, что корчайший путь от ИДЖ может начинаться с этого ребра.
И тогда неправильный алгоритм, давайте найдем такое ребро, оно точно существует и пройдем по нему, потом найдем хорошее ребро из Эля в сторону Жи, тоже по нему пойдем и так далее.
Почему этот алгоритм неправильный? Потому что тут-то в общем-то никто нам не мешает пойти по циклу длины 0.
Логично, да?
То есть вместо того, что вот, то есть может быть такая ситуация, что вот есть корчайший путь от ИДЖ, а есть вот какой-нибудь нулевой цикл.
Там не важно, например, совсем тупо нулевой, и тогда никто нам не мешает вот просто радостно по нему бесконечно ходить.
Вот. Но правильный алгоритм говорит, давайте запустим ДФС. Ой, извините, БФС.
Вот, по хорошим ребрам.
Вот, и собственно все.
Вот, то есть можно так делать, но это как бы требует дополнительного кода какого-то непонятного.
Ну вот, хотя на самом деле он в нем нет необходимости, потому что вот, как вы только что доказали, этот код тоже прекрасно работает.
Вот.
Так, ну вот, это соответственно алгоритм Флойда, но это такой, или как он известен еще в некоторых кругах, это алгоритм Флойда Кубецкого.
Соответственно.
Вот, почему Кубецкого?
Да, потому что работает за О от В в кубе.
Да-да-да, не нужно думать, конечно, что Кубецкий это прям какой-то польский математик.
Да-да-да.
Ну да. Нет, то есть на самом деле у этого алгоритма официально две фамилии, но вторая фамилия Воршелл.
То есть это называется алгоритм Флойда Воршелла на самом деле.
Вот.
Но как бы более известен как алгоритм Флойда Кубецкого.
Да.
Вот так.
Флойд Воршелл алгоритм.
В смысле Кубецкого?
Не-не-не, ну хорошо, давайте, да, прямо скажем, да, это такой, да, это такой прикол в олимпиадной среде.
Да, все.
Кубецкого и Словаку.
Да.
Сейчас, когда у нас одно ребро, мы говорим, что кто предок.
Ну, когда у нас утопус у нас одного ребра стоит.
А никто, тогда в проритом житом мы пишем минус один.
Ну, изначально в проритом житом пишем минус один.
И все.
Вот.
Так что написано минус один, значит рекурсия обрубается, это прямое ребро.
Вот.
Вот.
Но, конечно, ну, в принципе, если в графе реально В квадрат Ребер, то, в общем-то, да, философский вопрос можно ли придумать что-то прям значительно быстрее.
Хотя, теоретически, конечно, за квадрат, наверное, хочется решать задачу.
Так.
Но лично я не умею и не уверен, что, по-моему, наука тоже не умеет.
Так, ну ладно, у нас тут, кстати, две ветки, на самом деле, в этом месте возникают.
В данном случае же квадрат это, по сути, линейное время.
В смысле?
В смысле.
Да.
Ну это да, это да.
Не, ну как сказать, можно сказать, что если вы хотите установить все кратчайшие пути, то по-хорошему там, конечно, ответ у вас может быть до куба.
Ну хотя вряд ли, конечно.
Хотя по-хорошему нет, ответ у вас, скорее всего, будет все равно размера квадрат, почему?
Потому что кратчайшие пути из одной вершины до всех остальных по-любому образуют дерево.
И, в принципе, можно их и задать, как дерево, и получается у вас как бы размер ответа все равно будет квадрат.
Так что чисто теоретически ускорить это можно.
Ну так, по крайней мере, по крайней мере, там фундаментальных проблем этого уровня у нас нету.
Вот так аккуратно скажем.
Кстати, а для каких-нибудь разреженным графов это, наверное, можно тоже сфотоматизировать?
Да.
Не.
Не, зачем?
Потому что, например, смотрите, давайте подумаем.
Потому что если бы все веса ребер, если у вас не только нету отрицательных ребер, то есть отрицательных циклов отрицательного веса, но нет отрицательных ребер,
тогда вместо этого мы могли бы запустить V раз Dx и получить какую симпатику?
Ну, в тупую, если тупого Dx запускать, то V на V квадрат.
Это тот же самый V куб.
Но если граф разреженный, то можно сделать, чтобы это было VElogV.
Ну, давайте.
Хотя, конечно, предполагать, что у нас граф не связан.
Ну, просто что это за граф, в котором E меньше, чем V?
Прям сильно меньше, чем V.
Вот. Прямо симпатически меньше, чем V.
По-моему, это очень-очень-очень-очень сильно не связан.
Не, в бамбуке E как бы это V-1.
Вот.
Палка гороха.
Ну, у нас не связанные, хорошие ноги.
Ну, вот. Не, ну, хорошо, V на...
Ну, хорошо, V на V плюс ElogV.
Ну, правда, да, помним, что этот алгоритм не самый универсальный,
потому что если E порядка V квадрат, то он хуже, чем вот этот, да?
Мы же всегда думали, что E плюс VlogV на самом деле.
Да, на самом деле правильнее.
Это на самом деле V...
Тут на самом деле правильнее писать V умножить на E плюс VlogV.
Потому что мы с вами не олимпиадники, мы с вами знаем, что есть куча фибоначи.
Так, все, теперь это уже асинтетически, хотя бы так.
Да, ну, если мы, конечно, тут избавились от кратных ребер, конечно.
Ну, мы уже говорили об этом, что от кратных ребер мы избавляемся за E плюс V.
А можно и за E плюс V квадрат вообще обнаглеть.
Если уж E больше, чем V квадрат, то можно и не париться.
Вот.
А можно за Elog и не париться.
Можно, но если...
Ну, если E маленькая, опять же говорю.
Потому что вам, в общем-то, ИВ придется писать, что там, как-то, если E там порядка V квадрат,
или хотя бы там порядка V квадрат поделить на log V, то пишем...
И logE мы почти всегда можем себе позволить вот в этой асинтетике еще.
Ну, да, да ладно, классическая, да.
Там бывает там какой-нибудь классический...
Если у нас E, V, чтобы у нас logE был больше, чем V, то нужно постараться.
Е, ну, нет смысла.
Но обычно у нас, так как мы избавляемся от кратных ребер, то logE это не больше, чем 2logV вообще-то.
Так что тут...
Так что тут мы вообще не паримся.
Вот.
Так.
Ну вот, но это, как к сожалению, работает только еще с ребрами неотрицательными.
Мы в прошлый раз жестко пользовались тем, что у нас веса ребр неотрицательная.
А что делать, если не до циклов отрицательного веса?
Нет, но ребра отрицательными бывают.
Вот.
Ну, оказывается, можно скетерить.
Да, чит называется потенциалы.
Ой, нет.
Значит, что такое потенциал?
Вот у нас, допустим, у нас есть граф.
Да.
Значит, да, тут...
Так.
Сейчас этому все убираем, этому все убираем.
Сейчас этому все убираем, этому все убираем, этому все убираем.
Вот.
Значит, действительно, есть у нас какой-то граф.
И там у каждого ребра есть какие-то веса.
5, минус 3, минус 2, там 8, там все что угодно.
Так главное, чтобы тут цикл отрицательного веса нарисовался.
Не нарисовался случайно.
Правда, тут цикла нет вообще.
Так вот.
Значит, что такое потенциал?
Это...
Ну, вот.
Это такая функция, которая каждый в вершине ставит в соответствие
какой-то число.
И это законченное предложение.
Все.
Ну, не важно.
Я про определение вожу, спокойно.
Просто мы на каждой вершине рисуем какое-то мистическое число.
Там 3, 8, 6, там 5, 2, 7.
Минус 7.
Минус 2.
Ноль.
То есть мы просто нарисовали какое-то число.
Пока непонятно зачем.
Ну, теперь у нас вес ребра.
Вот давайте я его буду...
Вес, допустим, W от УВ.
Ну, мы же говорили, что у нас в кратах ребра нету,
но все, добрый день.
Вот.
Значит, вес обычного веса.
Давайте попробуем рассмотреть такую штуку как приведенный вес.
То есть это будет называть приведенный вес относительно потенциала П.
Вес относительно П.
Это равно...
Значит, старый вес плюс потенциал в начале, минус потенциал в конце.
Спрашивается, может ли приведенный вес ребра отличаться от обычного веса?
Приведенный вес ребра отличаться от обычного веса.
Ну, естественно.
Ну, если только потенциалы не все равны.
Обратите внимание, потенциал как в физике.
То есть нам абсолютное значение потенциала не нужно.
Нам интересует на самом деле разность потенциалов.
То есть, видите, вес устроен таким образом, что если мы ко всем потенциалам прибавим 57, то ничего не поменяется.
Ну вот.
Ну, впрочем, если 179, то тоже.
Ну вот.
Действительно, веса, казалось бы, сильно меняются.
Но как меняются пути?
Вот давайте рассмотрим какой-нибудь путь.
Из УВ.
Ну и в процессе тут будет У1, У2, У3, там бла-бла-бла, бла-бла-бла, бла-бла-бла, бла-бла-бла.
И тут УКТ, которым будет равно В, а у нас будет равно У0В.
Теперь давайте посмотрим.
То есть этот путь мы назовем РО.
Да?
И тогда у этого пути РО есть вес, который равен
W от У0, У1, плюс W от У1, У2, плюс W от У2, У3, плюс и так далее, плюс W от УК-1 до УК.
Вот.
А еще у этого W есть приведенный вес.
Который равен.
Вот теперь поехали.
Чему он равен?
То есть то же самое, так еще плюс разность потенциалов.
Да.
Ну пока, ну давайте, если писать формально, плюс куча разностей потенциалов.
Сейчас будет P от У0, плюс W от У0, У1, минус P1.
P от У1.
Это я первое ребро переписал.
Переписываю второе ребро.
P от У1, плюс W от У1, У2, минус P от У2, плюс P от У2, плюс W от У2, У3, минус P от У3.
Значит плюс и так далее.
Плюс П от УК-1, плюс W от УК-1, УК, минус П от УК.
Так.
Ну чего это равно?
Так, ну тут замечаем, конечно у нас в каждой примчутина вершине происходит шлеп-шлеп.
Шлеп-шлеп.
Шлеп.
Шлеп.
Вот.
И в результате что остается?
Остается, ну только вот потенциал в начале, минус потенциал в конце, и все что было в W от П.
То есть я могу написать, что это равно W от РО, плюс П от У0, минус П от УК.
Во.
Вот такая красота.
То есть обратите внимание, то есть получается от того, что мы ввели потенциалы, то есть
вес пути изменился только на разность потенциалов в начале и конце.
То есть обратите внимание, то есть это изменение никак не зависит от того, что это был за путь.
То есть изменение вообще не зависит от промежуточной вершины.
Но что из этого следует?
Что из этого следует?
Следует из этого маленькая приятная вещь, что структура кратчайших путей в графе сохранилась.
То есть относительно этих новых весов она та же самая.
Вот.
То есть они там изменятся только на какую-то разность потенциалов.
И естественно возникает такой чит.
Ой, а может быть надо ввести просто какие-то потенциалы,
которые сделают веса более хорошими относительно их, можно будет кратчайшие пути искать быстрее.
Ну вот именно сам путь как последует с вершин остается тем же.
Просто веса чуть-чуть поменялись.
Давай.
Проблема была с официальной фреброй.
Чего была?
Проблема с официальной фреброй.
Проблема в том, что DXtra с отрезательными ребрами не работает.
Вообще.
Мы доказывали только в предположении, что таких игр нет.
Ну да, а на самом деле очень просто привести куда-то пример, когда алгоритм DXtra просто завалится.
Вот.
Там достаточно просто.
Вот.
Поэтому не случайно мы там фольдом Бэллом какие-то там заморачивались.
Вот.
Так вот.
Но если нам везет и нет циклов отрезательного веса.
Вот.
Ну на самом деле, что нам хочется сделать?
Ну естественно у нас идея в том, что надо подогнать какой-нибудь такой потенциал,
чтобы приведенные веса были не отрицательные.
Потому что если у нас так получится, мы спокойно запускаем WDXtra.
Правда?
Ну там вот.
С нами там со всеми любимой кучей фибоначи.
Вот.
Но как же нот, как бы можно ли такое сделать?
Ну здесь знаете, я так сформулирую еще такое определение и такое утверждение.
Значит, определение.
Значит, потенциал P, значит W, R не отрицательный, будем его называть так.
Если для любых там УВ верно, что приведенный вес ребра, соответственно, между УВ больше либо равен нуля.
Это я просто написал определение.
Вправивается.
А существует ли такой потенциал?
Да.
Ну вот.
Утверждение, просто графовое утверждение такое.
Значит, не отрицательный потенциал существует тогда и только тогда,
когда в графе нет циклов отрицательного веса.
Вот такое мистическое утверждение мы сейчас докажем.
А УВР либо это прочайший путь, да?
Нет, W от РО это просто длина, РО это просто путь.
W от РО это вес этого пути.
Этого не обязательно, это кратчайшее не обязательно.
А так W от УВ это длина ребра между УВ.
Ну либо там, я не знаю, плюс бесконечности, если этого ребра нет.
Вот я утверждаю, что, оказывается, если в графе нет циклов отрицательного веса, то потенциал подогнать можно.
А если цикл отрицательного веса есть, то подогнать нельзя.
Ну действительно, вот в эту сторону, ну тут достаточно легко.
Если потенциал есть, то в графе нет циклов отрицательного веса, почему?
Ну потому что легко заметить, что все пути изменились на одну и ту же константу.
Но заметим, что если бы указ совпадало с 0, то этот путь был бы циклом,
то заметим, что вес цикла не поменяется вообще никак.
То есть веса циклов не меняются никак, поэтому никакой потенциал, то есть никакой потенциал не может сделать отрицательный цикл не отрицательным.
Ну и наоборот.
Не очень-то и хотелось.
Ну да.
Не, ну мало.
В обратную сторону только не трудно.
Вот, ну в обратную сторону да, не столько не трудно, но и конструктивно, что приятно.
Да, просто сказать, что вот он, типа возьмем кратчайшее расстояние.
Ой, к чему?
Если форда Белману не получится.
Ну да.
Подляночка, да.
Ну тут сразу оговоримся, да.
Ну да, хочется конечно так и сказать, что действительно, как найти не отрицательный потенциал.
То есть давайте один раз запустим форда Белмана и скажем действительно, что у нас наш потенциал, который мы хотим рассмотреть.
Так давайте вот эту вот уберу.
К чему он равен?
Расстояние.
Да, так и сказать.
Что давайте возьмем там какую-то стартовую вершину.
Пусть это вот какая-то стартовая вершина.
И сказать, что П от В присвоить расстоянию между от стартовой вершины до В.
Эти расстояния мы прям честным фордом Белману найдем.
Ну потому что асимптотика, на которую мы прицеляемся, позволяет запустить один раз форда Белмана.
Видите, да?
Вот.
То есть если мы докажем, что этот потенциал не отрицательный, то значит тогда мы просто алгоритм простой.
Запускаем один раз форда Белмана, устанавливаем потенциалы и после этого запускаем В дэкстра.
Или даже В-1 дэкстра, потому что искать кратчайшие пути от С до всех остальных уже не надо.
Вот, ну это конечно мелкая оптимизация, конечно, но...
Все еще оптимизация.
Ну так-то да.
Так вот.
Можно один раз запустить потенциал?
Так, да, конечно один.
Но если бы вы запустили В раз, то нам можно было не заворачиваться с потенциалами.
А потом вы...
Нет, потом мы, как бы, да, потенциал нашли, все, да, один вот.
Значит как же мы это делаем?
Таки как же нам доказать, что этот потенциал не отрицательный?
Ну казалось бы все достаточно просто.
Да?
Потому что, смотрите, вот мы пытаемся рассмотреть.
Вот у нас есть какое-то ребро УВ с весом В.
Да, мы хотим доказать, что П от У плюс В минус П от В.
Да?
Мы хотим доказать, что это больше либо равно нуля.
Или что то же самое, что П от У плюс В больше либо равно П от В.
Или что то же самое, расстояние от С до У плюс В больше либо равно, чем расстояние от С до В.
Ну казалось бы это верно.
Потому что Дист от СВ это длина кратчайшего пути между СВ.
А Дист от СУ плюс В это длина какого-то пути от СДВ.
Ну длина какого-то пути больше либо равно длины кратчайшего пути,
по определению слова кратчайший.
Вот.
Вот.
Но, к сожалению, такое доказательство не работает.
А что не так?
Вот к вам вопрос, что не так.
Да, есть одна маленькая подлянка.
Мы глядим, чтобы у нас потенциалы были в хорошем состоянии, что они не делали офицеривные отрицательные.
Не, ну мы казалось бы доказали, что вроде тут все в порядке.
То есть такие потенциалы как раз делают робро не отрицательными.
Ну вот, казалось бы.
Ну вот, есть одна подлянка.
Ну да, как-то странно, да.
Просто, да, практически сразу, но как-то вот это подлянку все проспали.
Ну что, может, посыпнули оба вязи?
Не, не, не, при чем тут?
Какая нам разница?
Мы же не пути сейчас рассматриваем.
Вот, да.
А что делать, если от вершины S до вершины V нет пути?
Тут плюс бесконечность написано.
Ну в ориентированном графе бывает такое, что между двумя вершинами нет пути?
А с помощью этого нет пути?
Нет пути.
Ну бывает такое, что между двумя вершинами нет пути?
Особенно. Да и внеориентированном тоже бывает, но там это как бы решается.
Вот, легко. А тут бывает.
Взять вершину, провести во всех ребра.
Вот, да, поэтому тут, поэтому нужна оговорочка, да.
То есть если вы просто находите, то есть, конечно, это мечта, если у вас есть такая стартовая вершина, из которой все доступно.
Но тогда для таких графов есть специальное название, граф потока управления.
Ну вот, так что мы на таком графе еще дерево доминаторов строить будем.
Вот, соответственно.
Чего?
Да нет, там халявно, господи.
Вот.
Ну вот, но конкретно сейчас мы заметим, что такой стартовый, то есть такой стартовый вершина еще надо поискать.
Я помню, как десятая параллельная куша плевалась от дерева доминаторов.
Что-то не хочется после этого.
Ну я не знаю, к чему она плевалась.
Что?
Кто плевался?
Кто плевался?
Когда плевался?
По-моему, я не плевался.
Я был в этой десятке, никто не плевался.
Все понравилось.
Ну как бы да.
Мне Женя по холмам рассказывал, как он приятный.
Да он от всего плевался.
Ай, господи.
Господи.
Как можно плеваться от дерева доминаторов вообще?
Замечательная вещь.
Как говорится, вон там от софт хипа еще куда не шло, а тут дерево доминаторов, господи.
Ладно.
Нет, ну на самом деле да.
Но, кстати, будет интеллектуальная задача, еще такая упражнение на троечку на экзамене.
Дан граф, существует ли в нем вершина, из которой доступны все?
Да.
Время работы алгоритма, вот В плюс Е.
Вот В плюс Е.
Ага.
Вот как за В плюс Е понять, существует ли вершина, из которой доступны все остальные?
Доступны напрямую или в параллельную?
Ну, в смысле, существует, то есть из этой вершины существуют пути во все остальные.
Можно компоненты пожать.
Ну да, да, да, да.
Но, да, формально говоря, мы не знаем, что это такое, мы же не знаем, что такое ДФС.
Ну да, то есть если, да, если применить компоненты сильной связности, то решение становится халявным, конечно, да.
Потому что в вердали существует только одна компонента сильной связности, в которую не входят ребра, да, по большому счету.
Хотя, как бы, хотя в качестве эксперимента лучше это давать задаче тем, кто не знает, что это такое, потому что, конечно, можно придумать и без этого.
А как без этого?
Ну, смотри, берем первую попавшуюся вершину, там, ну, по-моему, там будет работать, что типа берем первую попавшуюся вершину, запускаем ДФС из нее, помечаем все вершины, да.
И при этом помечаем условный там какой-то источник, а эту исходную вершину помечаем как исток.
Вот, теперь когда берем другую, берем какую-нибудь другую вершину, мы тоже запускаем из нее ДФС, но в то, что раньше не ходим.
Но при этом если попадаем в там вот эту стартовую вершину, то мы снимаем с нее статус истока.
Вот, ну а нашу, ну, эту вершину тоже помечаем. То есть в каждый момент времени у нас есть какие-то истоки, и мы там, если у нас есть новая вершина, мы запускаем ДФС.
мы запускаем DFS. Получается в каждый момент времени мы храним, получается добавляем вершины и храним
истоки или какие-то вершины мы уже объявили, что они не истоки. Ну вот, ну и все.
Чего? Ну то есть, если в конце оказалось, что у нас есть два истока, то мы вынуждены
заключить, что они друг из друга недоступны и до свидания. Вот, ну и хотя, ну хотя, ну да.
Нет, ну да, там легко показать, что такой алгоритм говорит так, что просто мы в какой-то
момент обязательно, если исток есть, то он как бы заведомо существует и тогда, собственно,
мы на этом все закончим. Ладно, не будем заморачиваться, в принципе, выкрутиться
можно. А в нашем случае, но в графе такое может быть, а может и не быть, потому что, мало ли,
там может граф устроен как-нибудь вот с каким-то вот, с таким вот мерзким образом. Вот. Ну как-то
так вот. Но что тогда делать? Как говорится, у нас нет, это, так сказать, общего истока графа,
а мы его заведем. То есть алгоритм предполагает очень простой лайфхак. Так, вот у нас тут был
какой-то там граф, какой-то там, что-то там у него, там ребра какие-то непонятные, там что-то бегают,
кто-то. Вот. А мы просто берем и все. Вот. А мы берем, значит, новую вершину S, то есть она теперь
больше не лежит в вершине V, то есть это новая вершина, из которой мы тупо проводим ребра во все
остальные. Вот. Просто вот это вот самый такой тупой хак. Вес, вес, ну давайте по умолчанию 0,
хотя по факту какие вы там числа нарисуете значения иметь не будет. Ну просто потенциалы
будут немножко другие, но суть от этого не поменяется. Все. Ну и получается, да. Нет,
не больше нуля. Ну если, потому что если тут есть отрицательные ребра, то как бы какие-то
расстояния станут отрицательными. Ну а если нет отрицательных ребр, то могли и не заморачиваться.
Ну тогда в принципе потенциал 0 нас вполне устроит. Вот. То есть это вот классический алгоритм
Джонсона. Ну будем называть это классическим алгоритмом Джонсона. То есть я не могу
гарантировать, там применял ли Джонсон именно этот хак, но что-то мне подсказывает, что там
вряд ли у него там написано что-то более сложное. Вот. Так что вот это вот классический метод потенциалов
Джонсона. То есть мы вот, то есть заметьте, что совсем от Форда Белмана мы не избавились,
но мы его запустили только один раз из вот этой вершины. То есть мы как бы нашли кратчайшее
расстояние. То есть парадокс такой, чтобы найти кратчайшее расстояние, нужно найти кратчайшее
расстояние. Вот. Ну просто их надо один раз найти, записать их как потенциал и после этого остальные
кратчайшие расстояния искать быстро и хорошо. Вот. Так что получается это вот такая у нас классика.
Дальше из каждой вершины мы запускаем DXTRA на вот приведенных весах. Ну в смысле, потому что мы
убедились, что кратчайший путь по приведенным весам это то же самое, что кратчайший путь по
обычным. Почему? Потому что еще раз вот как бы основной утверждение говорит так, что заметим,
что вес любого пути, прям пути изменится, но изменение этого пути зависит только от начальной
вершины и конечной вершины. То есть вывод, если я рассмотрю два пути и первый был длиннее второго,
то и по приведенным весам будет так же. Вот и все. Вот. И таким образом получается, что если в графе
нам повезло нет циклов отрицательного веса, то кратчайшие пути можно найти вот за такую
симпточку, потому что там будет VE плюс VDXTRA. DXTRA мы пишем за E плюс V log V. Ну там всякая мечта
бывает, потому что если окажется, что веса еще и целые, то на самом деле E плюс V log V можно
заменить на E плюс V. Вот. Ну и в принципе такой интересный факт, что если веса ребер целые не
отрицательная и вылезает в вашу разрядность как-то адекватно, то можно найти кратчайший путь от
вершины до всех остальных за E плюс V. Да, это называется алгоритм Торопа. Не знаю, доживем ли мы
до этого расстрела. Я полностью не помню, там просто целый курс можно читать по этому алгоритму.
Ну можно живем, я не знаю. Не, хотя вот в прошлом году в попытке дожить там просто, по-моему,
называется ушло, по-моему, где-то полусеместра, потому что надо с нуля нам начать хотя бы с
разминочки для дерева, с дерева вон Эмдебоса хотя бы. Там потом эти всякие Fusion 3 там начинаются,
ну и так далее. Ну и конечно хит сезона Атомик Хип. Да, Атомик Хип. Да, знаете третий.
В четвертом семестре, как говорится, у вас уже нет алгоритмов. Обвести. Главное, тут, правда,
исторически сложилось, что когда-то в четвертом семестре алгоритмы даже были, но как-то называется
так же исторически сложилось, что они были удалены, потому что, ну там, нет, там была просто идея,
что там начиналась такая тема как параллельный алгоритм. Ну просто там, прости, исторически было,
что когда алгоритм ИСИ, это был один такой взаимосвязанный предмет, то есть когда,
если бы представьте, чтобы сейчас вот на лекциях рассматривали не только алгоритмы, но и С++ еще
изучали. То есть никак вот сейчас вот вы там это на отдельных парах, там с отдельным преподавателем
занимаетесь этим вопросом, да, вот совместно. Ну вот и как бы логично, что как бы в четвертом
семестре висели параллельные алгоритмы. То есть вы там изучали, что там С++ и там, как устроили там
С++ и там ко всяким мьюдексы, там треды и прочее вот обсяраться. И может там покодили что-то на эту
тему. Вот и было тогда в четвертом семестре. В чем это параллельно вот с обычными алгоритмами.
Но было принято, в чем тогда это тогда, тогда там была эта геометрия. Ну вот, но потом что-то
подумали, а может лучше логично, когда в третьем семестре сделать просто плотненько алгоритм,
а потом в четвертом семестре плотненько параллельно, чтобы как бы не переключаться.
Вот, ну то есть, поэтому в районе где-то там 15-16 года это вот примерно так произошло.
Вот. В каком этом году было? Ну да. Вот. Так что соответственно. Поэтому с тех пор у нас там алгоритм
в три семестра. Вот. Так что все, да, все остальное. Ну и тем более, что там изучение этого алгоритма,
логично скорее на какую-нибудь там это техкурс на самом деле поставить. А у вас есть еще техкурсы
вообще? Вот это называется уходит эпоха нам. Просто в наши времена как бы мы должны были еще проходить
там что-то в течение 4 года, мы должны были пройти еще там какие-то два семестровых или один годовой
техкурс и два семестровых и один годовой гумкурс. Ну там типа там историю кино какую-нибудь там,
или там еще что-нибудь в этом роде. Вот это. То есть это все по выбору. Может у вас такого,
что у вас там все? А в чем польза проходить курс по истории кино? Не, ну тут логика исцикла,
что как бы чтобы вы не зациклились только на вот технических вот таких предметах,
чтобы было вот еще хоть что-то. Вот, поэтому у нас такое было. Ну прежде всего история кино
в самом обществе была интересна на самом деле. То есть там интересный достаточно курс такой.
Вот. Так вот, ладно, значит. Так, ну теперь финалочка по Флойду. Если вернуться к Флойду,
то это мы все говорили о том, что делать, если циклов отрицательного веса нет. А что делать,
если они сволочи такие есть? И вот это, и вся вот эта вот технология там Джонсона вылетает с трубу.
Вот. Ну, тут вот остается только выяснить, а они есть или их нет? Как это сделать? Ну,
на самом деле нет. Идея-то в общем-то простая. Тут я даже не буду предлагать там что-то. Ну,
можем пытаться доказывать, что делать простыми средствами, но тут я уже просто скажу надежное.
Ну, во-первых, начнем с того, что? То есть допустим цикл отрицательного веса есть,
и мы запустили Флойда. Вот, возвращаемся к Флойду. Тогда мы можем заметить, что мы можем заметить?
Тогда мы можем заметить, что на самом деле, если у нас есть цикл отрицательного веса,
то скорее всего на диагонали у нас появилось что-то отличное от нулей, правда? Логично, да? Ну,
то есть в принципе утверждение такое. Ну, я тут два скажу такое. Если после Флойда,
значит у нас А от ВВ оказалось меньше нуля, то очевидно через вершину В проходит цикл отрицательного
веса. Ну, доказательство очень простое. Базируется на том, что в каждый момент времени любое АИТЖТ это
длина какого-то пути от ИДЖ, абсолютно какого-то реального. Логично, да? Ну,
просто по индукции убеждаемся, в каждом момент времени это так. Вот. Ну, исходно АИТ, ну,
либо плюс бесконечности из такого пути пока не нашли. Вот. Если А от ВВ меньше нуля, значит через
В проходит цикл отрицательного веса. Но само по себе это, конечно, но с другой стороны, а если А от ВВ
равно нулю? Верно ли, что через В не проходит цикл отрицательного веса?
Ну, не совсем. То есть тут на самом деле что-то из цикла и да и нет.
Ну, типа В. Потому что, если у нас ни в одной вершине нет отрицательного, то цикла отрицательного
веса нет. А если хоть где-то есть, то там надо эту технику с проверкой достижимых видимо.
Ну, типа того. Да, потому что практически, ну, вот. Короче, если у нас есть цикл отрицательного веса,
хотя бы на одной его вершинке мы сделаем отрицательное. Ну, вот тут, а вот тут надо,
тут нужна аккуратность. Потому что вот, на самом деле, вот типичная ситуация, когда через
вершину В проходит цикл отрицательного веса. Ну, хорошо, давайте ставим. Ну, где-то да. То есть,
скажем, утверждение, да, утверждение два. Если В лежит, значит, если через В, давайте уж в этой
терминологии, через В, давайте я так скажу, проходит простой цикл отрицательного веса. То есть,
разница, да, между циклом и простым циклом, да, то после Флойда тогда уже без вариантов. Значит,
от В в меньше нуля. Вот. Ну, догадайтесь, что будет очень простой. Вот как мы будем
пользоваться именно простотой. Ну, потому что вот рассмотрим этот цикл, вот он, и возьмем на
его вершину с максимальным номером. Вот то самое К, да. Это вот К, это вершина с самым большим
номером, а К' это второе повелечение вершины. Тогда я утверждаю следующее, что там, допустим,
перед К' итерации Флойда вот А от К' будет меньше либо равно длине вот этого пути. Согласны? Ну,
это какой-то простой путь, где промежуточные вершины все там меньше К'. Вот. Ну, тогда,
смотрите, то есть тут А будет вот меньше либо равно вот этого, и тут А будет меньше либо равна
этого, да. Тогда получается, на К' итерации мы попытаемся обновить АКТК через вот это плюс
и получится меньше нуля. Понимаете, да? То есть получается, что либо на К' итерации АКТК станет
меньше нуля, либо оно уже было раньше. Ну, короче говоря, не позже, чем на К' итерации будет
идентифицирован. Вот. Вот таким образом мы доказали утверждение. Так. Так. Опять я вас где-то обманул, да?
Ну, в таком виде, да, я вас, конечно, обманул. А то что-то вы спите, что-то вас слишком легко
стало обмануть. Нет, потому что в таком виде я доказал не то, что через любую вершину будет
АВВ больше нуля, а что найдется вершина вот этой максимальной точно будет АКК будет меньше нуля.
Нет, это пока тоже не понятно.
Да. И показали, что на К' итерации АКТК точно станет меньше нуля, если она еще не было раньше.
Перед К' итерации АКК меньше либо равно вот этого пути точно.
Ну, да. Ну, правильно. Нет, ну на самом деле да. Правда, это доказательство придет для всех вершин,
кроме самой К, а вот для самой К мы сейчас рассмотрели. Да. Ну, по большому счету да.
Да. Общая суть такая, ну вот давайте значит еще раз. Значит да. Ну, давайте так. Пусть у нас К
это самая большая вершина, сейчас докажем для нее. Чуть позже докажем для всех остальных. Так. Ну,
опять ладно. Все базируется на таком важном утверждении, да? Смотрите, то есть да, у нас
было утверждение, когда мы искали качественные пути просто в графе без циклов отрицательного веса,
да? Его можно формулировать так. Значит утверждение. Там после какой-то там К' итерации,
К' итерации значит АИТ, меньше либо равно длины, там вес, веса лучше говорить, да, веса любого
простого пути, давайте простого пути, пути между ИЖи, проходящего, проходящего через,
там, точнее не через, а только через. Значит, что там? Тьфу, бро, ой, все, меня уже глючит. Один,
два и так далее. Ну, доказательства тоже, ну, доказательства тоже по индукции там тоже самое.
На этот раз, да, пища точно не превосходит в том, что циклы отрицательного веса могут
свою там, хрен там всегда вставить. Вот, такое вот утверждение. Вот, то есть тогда получается
следующее. Вот рассмотрим наш цикл отрицательного веса, простой, и рассмотрим на нем самую большую
вершину К. А теперь рассмотрим вторую по величине вершину на нем, пусть это К штрих. Тогда заметим,
что перед К штрихтой итерацией, перед К штрихтой итерацией А от К К штрихтой будет, не будет
превосходить длины вот этого пути. Ну, потому что тут все вершины меньше, чем К штрих.
Ну, поэтому утверждение. Вот. Ну и А от К штрихка не будет превосходить длины вот этого пути. Вот.
Тогда это означает, что на К штрихтой операции мы попытаемся обновить А КТ КТ через А от К К
плюс А К штрихка, то есть вот что не происходит, вот это плюс вот это, что меньше нуля. Все. Значит,
получается на К штрихтой итерации это будет, то есть на К штрихтой итерации А от К К уже точно
станет меньше нуля. Вот. Вот это на К штрихтой итерации. Вот. А если мы рассмотрим любую другую
вершину В на этом цикле, то заметим, что аналогичным образом мы можем показать,
что не позже, чем на К штрихтой итерации, то есть не позже, чем уже на К штрихтой итерации,
тоже у нас АВВТ станет меньше нуля. Потому что на А от К К мы точно попытаемся обновиться чем-то
не превосходящим вот это плюс вот это. Да, они точно, они точно, у них это точно сработает. Да,
вот этот пример показывает, что если оно лежит просто на каком-то цикле отрицательном, то есть оно
там, так сказать, лежит в одной компоненте сильной связности с циклом отрицательного веса,
простым, но тем, что мы интуитивно произвиваем под циклом отрицательного веса, то, конечно,
не факт. Потому что здесь вот это вот, то есть, ну как бы, то есть сильно вряд ли тут АВВ будет
что-то отличное от нуля. Хотя на самом деле накрутить тут, накручивается это быстро, чем кажется.
Ну хотя ладно, давайте добьем. То есть хорошо. Вот. То есть как теперь найти миную нодку? Как
-то теперь идентифицировать минус бесконечности. Ну то есть логично, что после того, как мы запустим
Флойда, то есть у движения такое, что если между вершинами есть кратчайший путь, то он будет
найден. Понимаете, да? Но как теперь понять, кратчайший путь существует или может быть там минус бесконечность?
Ну да. Потому что мы же помним, мы в прошлый раз доказывали, что между двумя вершинами путь
минус бесконечность. То есть можно накрутить сколь угодно отрицательный путь тогда и только тогда,
когда существует цикл отрицательного веса, через который можно из ИВЖи пройти. Понимаете, да? Но
как теперь понять, можно ли так сделать? Да очень просто. Надо просто перебрать. Берем ИЖи, у нас же
есть, у АТВ куб у нас есть, раз мы только что Флойд запустили, да? Так давайте для ИЖи переберем все
вершины В, посмотрим все вершины В, у которых АТВ меньше нуля и посмотрим, можно ли пройти от ИДЖи
через вершину В. Вот как заметим, что Флойд нам уже дает возможность хотя бы понять, можно ли пройти
из вершины И в вершину В, правда? Ну просто там написано плюс бесконечности или что-то все-таки мы
нашли. То есть даже ДФС-ов лишь их запускать не надо, тем более, что мы не знаем, что это такое, да? Вот.
Вот, значит просто, значит, перебрали. Если нашлась такая вершина, значит автоматически
минус бесконечность. А если не нашлась, то, ну значит, корчайший путь найден. Вот, понятно?
Вот. Ну и останется только отдельная песенка, конечно, что если корчайший путь есть, то давайте
его восстановим. Но здесь остается в качестве упражнения доказать, что там ничего вроде как
с предыдущего доказательства особо не поменялось. Вот, логично, да? Правда останется, знаете какая,
останется еще, конечно, вот эта веселая задачка. А как бы нам восстановить цикл отрицательного веса?
Ну какой, ну да, ну хотя бы какой-нибудь цикл отрицательного веса, там, допустим,
ну простой не факт, что существует через любую вершину, да? Хотя, да, задача там восстановить.
Ну, если мы восстановим какой-нибудь цикл отрицательного веса, то, наверное, цикл простой мы
тоже восстановим, просто удаляя дубликаты. Ну, то есть, помните, да, у нас уже было...
Просто простой легче восстановить. Да, ой ли.
Парень, ну, чтобы найти просто цикл отрицательного веса, давайте запустим ДФС из произвольной вершины.
Вот, теперь мы идем-идем, если в какой-то момент, и помним текущий вес пути, если мы в какой-то
момент нашли, как бы, обратный ребро кладет вершинку, до которой вес куча пути.
Ну, это супер, только почему найдем?
Парень, подверждается, что раз, если у нас есть простой цикл отрицательного веса, то мы его найдем.
Да, это вот почему?
Ну, хорошо, если у нас есть простой цикл отрицательного веса, значит, то существует обратный ребро из последней вершины первую.
Ну и что? А может, мы до этой вершины ДФС дошел за какой-то более нетривиальный путь, какой-то более положительный?
Ну, я боюсь, так придется как бы ДФС запускать такой, без юзидов, а это будет так себе удовольствие.
Вот, ну, на самом деле, так, ладно. Так, сколько там сейчас времени? Ой-ой-ой, ой-ой-ой.
Нет, ну, на самом деле можно делать так. Лучше тогда, то есть, на самом деле, да, один из красивых методов восстановления такого цикла, это на самом деле такой.
А давайте просто найдем первое К, после которого, на самом деле, вот там всякие вот эти меньше нуля появились.
То есть, на какой-то катаитерации впервые появились какие-то АВВ, которые меньше нуля.
Тогда я утверждаю следующее, что если оставить только первое К минус одну вершину, то там циклов отрицательного веса не было, правда?
Ну, тогда я утверждаю следующее.
Так, ну, тогда я утверждаю следующее, что те пути, которые мы там нашли, то есть, например, за первое К минус одну итерацию мы восстановили какие-то корректные пути, проходящие только через там вершины 1, 2 и так далее, К минус 1.
Их можно даже восстановить там тем механизмом, который у нас был.
Вот, понятно, да?
Вот, и тогда катаитерацию можно делать аккуратно.
То есть, говорить, что если сначала пробежаться и убедиться, что если появляются всякие меньше нуля на какой-то вершине В, значит, тогда у нас А от ВКТ плюс А от КВТ стало меньше нуля.
Ну, так давайте восстановим путь от ВК и восстановим путь от КВ, и вот вам цикл отрицательного веса.
Ну, потому что утверждение такое, перед катаитерацией у нас там написаны корректные кратчайшие пути, которые в качестве промежуточных используют только там первое К минус одну вершины.
Вот, можно попробовать даже прям это усилить, прям так утверждать, что там будет написан кратчайший путь среди тех, которые проходят в качестве промежуточных через вот эту вот.
Понимаете, да?
Вот, да, причем утверждается, что действительно, причем действительно несложно показать, что, да, действительно там кратчайшие пути все реально существуют.
Ну, потому что если существует кратчайший путь, на котором все вершины меньше К, кроме может быть одной, то тогда у этой одной точно, значит, после К минус одной итерации будет АВВ меньше нуля.
Ну, собственно, вот тем же методом доказываем.
Понятно, да?
Вот.
К чему это нас приводит?
Вот.
Ну, тогда это означает, что, ну, вот, ну, а если там пути существуют, найденные прям там, найденные в точности они, то с помощью порешек можно эти пути еще и восстанавливать.
Ну, естественно, порешки на тот момент перед Катой итерации.
То есть фишка будет в том, что просто надо, если вы хотите выстоять цикл отрицательного веса, то надо перед тем, перед тем, как запускать Катую итерацию, надо просто проверить, а появятся ли вот такие спецэффекты.
Это мы таким образом ищем какой-то цикл?
Да.
То есть цикл через заданную вершину мы не можем найти?
Ну, цикл через заданную вершину таким образом, конечно, не найдем, но просто не факт, что он существует.
Я имею в виду, что если мы в конце выяснили, что через эту вершину проходит цикл отрицательного веса, можно ли будет его найти?
Так, ну я бы так сказал, слет у меня, конечно, алгоритм только с компонентами сильной связности.
Ну там идея такая, давайте найдем компоненты сильной связности и выкинем, оставим только их, то есть выкинем все ребра, которые соединяют компоненты сильной связности.
Вот, запустим Флойда, тогда заметим, что по сути в каждой компоненте сильной связности у нас Флойд работает независимо, и в каждой из них мы можем независимо вот указанным ранее образом найти цикл отрицательного веса какой-нибудь, если он есть.
Тогда, если у вас две вершины лежат в одной компоненте сильной связности с таким циклом отрицательного веса, ну если вершина лежит в одной компоненте сильной связности с циклом отрицательного веса, то тогда цикл отрицательного веса, проходящим через нее, будет работать по принципу идем до этого цикла, проходимся по нему, выходим из этого цикла.
То есть вот пообщий алгоритм можно такой придумать, но для этого нужно найти компоненты сильной связности.
Так, хотя ладно, в всякий случай, кто знает, что такое сильная связность?
Ну да, сложно было предполагать что-то иное, да, конечно.
Так, ладно, кто знает алгоритм Косараю?
Ну, кто знает, как искать компоненты сильной связности с помощью двух ДФСов?
Никто не знает, как это называется.
Нет, это алгоритм Косараю называется, хорошо.
А кто знает, как искать компоненты сильной связности одним ДФСом?
Зачем?
Надо.
Ну алгоритм Тарьяна, да.
Нет, там просто фишка заключается в том, что у Тарьяна есть общая технология,
которая просто единым ДФСом ищет и компоненты вершины двух связностей,
и компоненты реберных двух связностей, и компоненты сильной связностей.
Вот, правда там, но мы это все скоро обязательно увидим.
Так что да, это нас еще ждет.
Но там красивый алгоритм, конечно.
Ну, возможно, возможно.
Ну ладно, в любом случае о Флойде я вроде сказал все,
что мы вроде обсудили все, что хотелось обсудить о Флойде.
Вот, ладно, поэтому думаю пришло время устроить перерыв.
Вот, после которого можно будет переходить к перерывам.
Да вот, ладно, итак.
Да, едва ли не четыре дня, и все еще меньше осталось от эпохального события.
Называется начало матча, в результате которого Макнус Карлсон
окончательно перестанет быть чемпионом мира по шахматам.
Вот.
Он отказался в нем участвовать.
Да, он отказался защищать.
Поэтому в этом матче сыграют госмейстер из России Ян Непомнищий
и госмейстер из Китая Дин Лежень.
Вот.
Так что это называется...
Потому что скучно.
Почему еще надо?
Нет, это хуже.
Во-первых, несколько месяцев.
Подготовка к конкретному сопернику, там куча.
Это очень ответственность к этому всему еще.
Играть с тобой в итальянку, ну и ты сидишь и грустишь.
Да.
Вот, ну там условно.
Поэтому, ну нет, там больше была проблема, что да,
это будет с одним и тем же противником, причем самое,
причем если там в остальных партиях можно там пытаться играть на помидоре,
то тут главное не проиграть, вот не проиграть.
Итак, двенадцать раз.
Ну, примерно такие.
Ну, скорее всего, и «Break it», «Mashot».
Ну, как сказать, по-разному.
Ну, почему?
В зависимости от вас в каком матче было.
Потому что в матче с Каруаной вообще закончился с счетом 0-0.
Вот знаете, я не люблю этот шахматный счет, как говорят, что там, типа,
ничья это пол очка, я люблю вот, честно, по победам.
То есть как-то любой ничейный двенадцатий матч в поединках
закончится с счетом 6-6.
Честно говоря, вот матч с Каруаной закончился с 0-0.
А там, матч там, скажем, между Александром Горячиком и Дзюем Вензюем
закончился с счетом 3-3.
Двенадцать?
А, ну сейчас может уже четырнадцать.
Не помню, чем было двенадцать, потому что последние два можно было уже не играть.
Ну да, потому что не помню, проиграл один раз, а потом слился.
Да, это мы помним.
Он чуть не выиграл три раза, по-моему.
Было-было.
Но ладно, сегодня мы убедимся, что на самом деле это все происходит
из-за того, что люди просто очень тупые,
потому что на самом деле в шахматах есть выигрышная стратегия.
И с айDieКОм?
Нет, или ничейная стратегия.
Ну в плане, что шахматы можно свести к игры и посчитать?
Ну потому-что да, потому что на самом деле, да, утверждение такое,
Либо это ничейная игра, что это означает?
Это означает, что каждый из игроков, что белый, что
черный, может играть так, что гарантирует себе не
проигрыш при любой игре противника.
Может выигрыш, может ничья, но уж гарантирует, что
он не проиграет.
Но каждый независим.
То есть верна какая-то из этих трех опций.
Человек, кто проводит турниры по шахматам, потому что
пока она не знает, какая из этих опций верна.
То есть человечество, конечно, сильно подозревает, что
шахма-то игра ничейная.
Наверное.
Все-таки.
Есть такое.
Если бы поняли, то все равно выиграли.
Нет.
Почему нет?
Как сказать?
Если бы была понята выигрышная стратегия, то как бы все.
Каспаров это называют судный день шахмат.
Если шахматы будут решены как математическая задача,
то, естественно, турниры прекратятся.
Шашки же разрешены.
Они не перестанут играть.
Чтобы залучить.
Нет.
А что в шахматах?
Нет.
Вопрос, какие еще шашки?
Шашки решили.
Нет.
Если...
Ну, во-первых, какие шашки?
Шашек много.
Потому что есть русские шашки, в которых дамка ходит
какое-то там произвольное количество полей.
Есть американские шашки, где дамка ходит тоже на
одну клеточку.
Только единственное, что она может ходить назад.
И кушать там назад нельзя.
По-моему, не эти шашки были решены.
Это два.
Не говоря уже о том, что классическими сейчас являются шашками на доске
10 на 10, а не 8 на 8.
Так что тут еще такие оговорчики есть.
Вот.
Так что в этом плане, конечно, вопрос.
Вот.
Ну, собственно, давайте вот сегодня и в следующий
раз будем изучать сейчас основы всего этого.
Вот возникает вопрос.
А что для нас, собственно, игра?
Так, что там за обсуждение?
Вот давайте сразу.
Спросите, что такое игра?
Ну, скорее всего, это какая-нибудь игра в состоянии.
Ну, да.
Ну, по большому счету, да.
Мы будем рассматривать такой предельно простой случай.
Значит, какой?
Что у нас, значит, просто рассматривает просто предельно
такую тупую игру.
Есть граф?
Ориентированный?
Возможно, циклический.
Возможно, нет.
Как повезет.
Вот.
И есть фишка.
Вот фишка стоит в какой-то вершине.
Играют два игрока.
Ход каждого игрока заключается в том, чтобы выбрать ребро.
Ну, ладно, давайте так.
Выбрать, то есть сдвинуть фишку из этой вершины по
какому-то торчащему из этой вершины ребро.
Какому выбирает сам игрок?
Проигрывает тот, кто не может сделать ход.
То есть если вот никакому надо сделать ход, а он находится
в вершине, из которой ребро не торчит, значит он проиграл,
а противник выиграл.
Если противники, но если игроки ходят до бесконечности,
то объявляется ничья.
То есть вот такую базовую игру мы будем рассматривать.
Спокойно.
Вот.
Ну, здесь надо, конечно, оговориться.
То есть насколько всеобъемлющее такое определение?
Нет, то я...
Нет, вопрос не в этом.
Просто тут как бы хочется оговорить.
Да, то есть какие игры мы тем самым покрываем?
Какие нет?
Потому что такая игра называется...
Ну вот, то есть такие игры, кстати, еще называются равноправными.
Ну, в том плане, что какие ходы вы можете сделать,
зависит только от того, в какой вершине вы находитесь,
но не от того...
Но не от того, собственно, какой выиграл.
Честно, ведь если у нас граф удольный, то...
Если у нас игра зависит от того, какой мы игрок,
то это просто можно изобретать такой же игрой.
Ну да.
Заметим, что да, если у нас в каждой вершине сказано,
допустим, еще что, если вы белый, то вы ходите так,
а если к черной, то вы ходите иначе,
то, конечно, это тоже равноправно и легко сводится
просто за удвоение графа.
Так, тут надо подробнее говорить.
Если у нас будет сумма нескольких игр, то это уже...
Нет, ну да, живем, спокойно.
Тут скорее проблема, что полная информация в игре должна быть.
Ну да.
То есть, конечно, тут это еще игра, конечно, еще с полной информацией.
Вот.
Не, почему?
Нет, шахматы вполне себе вписываются.
Просто потому, что в шахматах конечное число позиций.
Да, но есть нюанс.
Какой?
Что это конечное число,
мы не сможем, скорее всего, еще очень-очень долго в компьютере представлять.
Ну да.
Нет, это да.
Но с другой стороны, да, заметьте, что шахматы просто да.
Ну правда, конечно, надо договориться, что тут придется еще в понятие позиций
еще говорить не только позиции фигур на доске,
но это позиция, когда последний раз ходила не пешка там или там,
или сколько раз уже эта позиция встречалась ранее, да?
Ну это уже по сравнению с предыдущим мелочи, но тоже надо, да-да-да.
Чего?
Ну да.
А, ну да, еще правильно.
Еще правильно написать, что такое рокировка.
Потому что, да, рокировка это, как говорят,
когда ладья, когда ни король, ни ладья не сделали еще ни одного хода
и как бы находит там, и когда там король делает…
Не на отрезке между королем и ладьей, нет там ни одного хода.
Ну да, нет, там просто был какой-то итюд, когда-то, по-моему,
когда король не сдвинулся, пешка над королем, значит, дошла,
значит, дошла до восьмой горизонтали и превратилась в ладью,
и после этого сделали рокировку.
Этот ход до недавнего времени был легален.
Да, во-во-во, да.
То есть сейчас в явном виде это запретили, но вообще формально,
так можно, оказывается, было.
Да-да-да.
Ну я не знаю.
Так можно, оказывается, было.
Да-да-да.
Ну я не помню точно.
Так, ладно.
Все, сейчас мы, конечно, сейчас мы о шахматах сейчас заболтаемся.
Как что тут болтать?
И так лучше, как говорится, через три дня лучше включать там любой крест-бук
или там любой фиде-чест и там уже, как бы, смотреть эпическое шоу, да.
Можете повторить какой ход?
Как это сделать?
Ой.
Е-пешка просто проходит до конца.
Ну, смотрите, вот доска.
Е-пешка проходит до ладьи.
Так, где там?
Вот этот король, вот пешка.
Пешка, пешка, пешка пришла, превратилась в ладью.
И, как бы, ладья вроде не сделала хода, король, допустим, тоже не сделал.
Ну и, как бы, все, делай вратировку.
Что там на турнире произошло?
Король двигался.
Нет, там...
Ну я не знаю, проходило, по-моему, не на турнире.
Может, там кто-то в Итюде, по-моему, использовал такой.
Да, вот был какой-то Итюд там с таким приколом, да.
Я решала себе за этого этот Итюд, кстати.
А, да?
Да.
Ну ладно.
Более того.
Окей.
Ну, в любом случае, это было гораздо более красивое решение, чем запланировано.
Да, да.
Да, ну это, конечно, да.
Издевательство, конечно.
Да, ну вот, ладно.
Ой.
Ну ладно, все, в любом случае, да, этот ход зачем-то запретили, хотя...
Хотя зачем?
Такая красота была.
Угу.
Или прям этот...
Или этот ход резко делает игру.
Там, тупо, нечейный, что ли.
Или...
Нет, ну просто правила рокировки нельзя переделать, потому что есть фишеровские шахматы, как минимум.
Ну да.
Ой, ой, так, стоп.
960.
Так, стоп, да, я не знаю, следующая, да.
Это...
Нет, просто нет, если мы сейчас начнем это обсуждать, мы так никогда не закончим.
Вот.
Так что нет.
Шахма, шахма, шахма ты вещь...
Да, мы, конечно, сейчас докажем, что шахма-то игра как бы...
Там, называется, там существующими стратегиями, но...
С известным результатом, но непонятно кому, да.
Ну, как сказать, нет.
Результат существует, но какое непонятно.
Значит, как же мы это будем делать?
Ну, ответим, да, что многие игры там, шахматы, шашки, го, там тоже самое, на самом деле.
То есть, прекрасно вписываются в эту схему.
Ну да.
Нет, это называется игра с полной информацией.
То есть, когда оба игрока полностью весь этот граф знают.
Вот.
Ну потому что бывает, какие игры не подходят, да.
Бывает, когда...
Ну то есть любые карточные игры скорее всего не подходят, если это, конечно, не по сеансного типу игра.
Ну потому что...
Потому что чаще всего, если вы играете в условного дурачка, то вы не знаете, какие карты у противника.
Вот.
То есть поэтому...
То есть там такое...
Если вы играете в дурака, ну даже если вы играете в дурака в открытую, то вам еще желательно надо знать, собственно, какой порядок карты у оставшейся колодья находятся.
Да, но дело в том, что в данном случае мы знаем весь граф
в точности, и противник знает, и более того, как вы убедитесь
в теории информации, важно, что мы знаем, что противник
знает, и более того, мы знаем, что противник знает, что
мы знаем, что он знает, и так далее до бесконечности.
Да, это принципиально оказывается, потому что в теории информации
приводится этот классический пример, знаете, вот такой
просто интеллектуальный, там, я думаю, многие слышали
этот пример, ситуация, двум, гениально, двум интеллектам,
значит их посадили рядом, в чем очень умные люди,
и значит сообщили, им шипнули на ухо два натуральных числа,
и сообщили, что эти натуральные числа отличаются на единицу.
Вот, и дальше между ними стал происходить такой
интеллектуальный диалог.
Слушай, Васян, а ты знаешь, какое у меня число?
Не, слушай, а ты не знаешь, какое у меня число?
Слушай, я тоже не знаю.
А ты точно не знаешь?
Как-то вот нет.
Ну, может, ты знаешь.
Да нет, я как-то все еще не знаю.
Слушай, а я тогда знаю, какое у тебя число.
А, ну тогда я тоже знаю, какое у тебя число.
Вот, ну, длина этого диалога может варьироваться в зависимости от чисел, но вот примерно такая.
Ну, типа да.
Если бы число было порядка миллиарда, то они бы так порядка миллиарда раз спрашивали, но в какой-то момент догадались бы.
Да, то есть это какой-то эпический парадокс абсолютно, я не знаю, я не могу сказать, что я его до конца понимаю.
Ну да, да, да.
Да, то есть, это очень интеллектуально выглядит, я не знаю, и я не знаю, и я не знаю, и я не знаю, и я я не знаю, и ой, а я знаю.
Вот, то есть ну вот оказывается, они к другу сообщают водка, как раз на уровне что да, я точно знаю, что ты знаешь, там длинные цепочки, что ты не знаешь.
Но я не знаю, знаю ты, что я знаю, чьё и цепочка длинная, такое взрыв мозга, так что.
что все знают.
Но в данном случае все знают все, без заморочек.
Мы еще говорим, что мы не говорим о всяких рандомных
играх типа покера, например.
Ну да, ну и дурак, собственно, это, ну дурак тоже можно
считать вероятностной игрой, если вы каждую карту
рандомно достаете, например.
Ну, по сути, да, если вы ее не знаете, то да, по сути
для вас то же самое, что рандом.
Вот, ну тут вот, да, вещь такая, есть в конце концов вообще
рулетка.
То есть, ну это такая просто, то есть это где вообще-то,
то есть это такая предельная точка, типа ноль интеллекта
абсолютный рандом.
То есть, как бы никакой интеллект вам в эту игру, собственно,
играть там более оптимально, чем просто кидать там куда-нибудь
и надеяться, что повезет, не поможет.
Ну просто так устроена рулетка.
Вот, ну то есть, ну естественно, в математической модели
мы подобное не рассматриваем.
Или рассматриваем, ну или тогда рассматриваем конкретный
профит, который нам может этот чит привести.
Нет, дальше там начинается всякие интеллектуальные
игры там на тему того, что на самом деле из рулетки
там есть у вас бесконечное число денег, то вы себе можете
обеспечить стабильный доход, конечно, с нее, ну там удваивая
ставки.
Вот.
Ну да, ну там просто да, если вы в долгу играете,
то рано или поздно, конечно, то есть после любой рецепткотегии,
если у вас конечное количество денег, то рано или поздно
вы, конечно, обвалитесь.
То есть после очень да, будет у него там как бы понятно,
что, например, если у вас там ставка, вы ставите
один при проигрыше, два, потом четыре и так далее.
То есть если у вас там изначально тысяча, то вы там имеете право,
можете поставить так десять раз.
Ну то есть понятно, что вероятность того, что там за десять раз
там, допустим, не выпадет красная, то конечно крайне
мала, но если вы играете долго, то за тысячу раз, то есть
за тысячу итераций один раз такое произойдет.
Скорее всего.
Поэтому и вы обвалитесь.
Ну вот.
Но теорию у вас в следующем семестре, это вы все там будете
подробно обсуждать, все подобного рода вопросы.
Вот.
А у нас вероятностей нет.
У нас все жестко.
Давай.
Что такое равноправность?
Нет, вот равноправность, это когда, как бы, какие
ходы можно, куда можно сдвинуть фишку, зависит только от
вершины.
Вот.
Но как бы мы увидели в этом смысле, равноправность
и неравноправность не сильно принципиальны.
Вот.
Ну разные терминологи там может быть, но мы сейчас
не будем в нее копать.
Вот.
Ну и соответственно, мы попытаемся вот немножко
приблизиться к тому, действительно, какие у нас игры вообще
бывают, а как их можно анализировать.
Ну начнем с самого, ну вот.
Ну с другой стороны, давайте подумаем, да, какие вообще
игры могут быть.
Ну там самая простая игра, ну можно посмотреть в какой-нибудь
веселой телепередаче.
Вот.
Ну в какой телепередаче у нас есть веселые игры.
Ну, Форд Боярк, например.
Ну, как сказать, ну есть там во Франции там Форд,
который построили, он не пригодился, его там переделали
под телепередачу.
Поэтому там прибирают какие-то команды, то есть, знаете, там,
то есть условно потом человека там запускают в комнату там,
а все остальные там смотрят по телевизору, что делает
и получается диалог.
Там что ты там видишь?
Там львы!
Там убей их!
Что дальше?
Ну вот.
Там что такое?
Там какой-то злой охранник.
Там убей его!
Убил!
Что дальше?
Что с твоим голосом?
Дай сюда симпла немного!
Так, что дальше?
Там слон!
Так, ключ под слоном!
Что делать?
Там сдвинь слона!
Сдвинула!
Там бери ключ!
Ну и так далее.
В общем, неважно.
Такая примерная игра.
Ну это пародия, конечно, но суть, может быть, могла
быть примерно такой, да.
Вот.
Но в какой-то момент приходит такое.
Некоторые игроки иногда проигрывают в состязаниях
и создают в тюрьму.
Вот.
Вот.
Вот.
И Александру Домогарову нужно спасти человека.
И ему нужно выиграть в интеллектуальную игру.
Значит, у какого-то мистического метро теней.
А игра такая.
Значит, есть 20 палочек.
Вот.
Ну, версия такая, да.
Ну, значит, описываю версию, да.
Вот.
В первом ходит Александр Домогаров.
Ну, значит, они, игроки ходят по очереди.
Они могут по очереди забрать от одной до трех палочек.
Вот.
Проигрывает тот, кто возьмет последнюю.
Ну, у нас будет такая игра.
Ну да, это не совсем вот эта игра, но вот там была
версия проигрывает тот, кто возьмет последнюю.
Вот.
Ну, там многим это давали, но, кажется, только Александр
Домогаров продемонстрировал, что он умеет в это играть.
Все остальные как-то проиграли.
20.
Ну, начинает Александр Домогаров.
Ну да.
Вот.
Ну, давайте кратенько вспомним технологию.
Ну, ладно.
То есть для нас, на самом деле, лучше сказать, что
палочек не 20 и 19 и лучше сказать, что проигрывает тот,
кому палочек не осталось.
Ну, эквивалентно, по сути.
Вот.
Вот.
Вот.
В чем главное, это были хорошие времена с Ермольником,
когда, по-моему, Метри, там Метри Теней в эту игру
играли честно.
Потому что в недавней версии я видел, что там, по-моему,
Метр очень прям старался, изворачивался, чтобы игрок
победил.
Вот.
Просто он очень старался, явно, прям вот.
Да.
То есть там он оставил просто 7 палочек, чтобы она,
собственно, догадалась, что можно там все-таки взять
две палочки, и тогда он ничего сделать не сможет.
А так сложная игра, видимо, была там с большими перипетиями.
Казалось бы.
А с точки зрения математики, что мы видим?
Давайте, ну, как всегда, зачем нам решать задачу
для 19 палочек, когда у нас есть N палочек?
И давайте честно, значит, будем все честно, значит,
соответственно, решать.
Вот, предположим, есть у нас в игре 0 палочек.
Кто у нас выигрывает?
Второй.
Да.
Второй игрок.
А первый проигрывает.
Значит, мы для удобства будем называть такие игры
проигрышными.
То есть у нас будет такое определение.
Значит, будем писать.
Игра… Нет, неправильно мы написали.
Игра выигрышная.
Да, будем, ну, будем уж цвета вводить.
Тут вот сейчас вот надо аккуратно просто проводить,
тут вот прорвать.
Игра выигрышная, если у первого игрока есть выигрышная
стратегия.
Ну, понятно, что такое выигрышная стратегия, да?
То есть выигрышная стратегия, то есть у нее стратегия,
то есть стратегия, ну, стратегия…
Можно это формально описать, как что в каждой позиции
у него там фиксирована, как он будет ходить.
Это называется стратегия.
Стратегия называется выигрышная, если она позволяет
она позволяет ему выиграть, независимо от того, как
ходит второй игрок.
Выигрышная стратегия.
И, соответственно, сразу определение напарника.
Игра проигрышная.
Вот, будем красненьким писать.
Если что.
Да, если у Витя дайсил второго игрока из выигрышной стратегии.
То есть, видите, у нас как бы определение направлено на такой, на
конструктив.
Ну, тот, кто ходит в игре, он как бы кто-то первый
ходит, а кто-то второй.
Поэтому проигрышность и выигрышность.
Но правда парадокс в том, что после того, как вы
походили, да, вы попадаете в позицию, в которую вы
теперь второй игрок.
То есть, выигрышность этого我們的.
Да, когда мы говорим о выигрышности или проигрышности,
мы говорим, что она выигрыш Mcさ для того, кто
ходит.
То есть, когда мы сейчас говорим первый и второй,
то мы говорим, да, что первый тот, кто сейчас ходит,
второй кто сейчас не ходит.
Игра может быть выигрышная как для одного, так и для
второго.
Но мы ее называем выигрышной Moscow.
но мы ее называем выигрышной и проигрышной
ну вот заметим что
игра из нуля палочек откровенно
проигрышная, потому что первый игрок подает в позицию
где он не может сделать ход и проигрывает
понимаете да?
так
а если у нас одна палочка
тогда первый игрок может выиграть
ну у него ладно, у него вариантов нету в общем то ходов
а вот здесь он может и проиграть
но мы подразумеваем что оба игрока играют
оптимально
вот эта магическая фраза играют 100 00,000
то есть это означает что если есть выигрышная
стратегия у первого игрока то есть, если у первого игрока
есть какая то тактика то он будет ей
придерживаться
и если у второго игрока есть какая то тактика
он тоже будет ей придерживаться
вот тут все просто
Это называется «играют оптимально».
Ну и соответственно, если у нас 1, 2, 3 палочки, то у первого игрока есть выигрышная стратегия.
Просто забрать все палочки.
А вот если у нас 4 палочки, то тут подлянка.
Как бы первый игрок не походил, то есть он бы оставил второму 3, 2 или 1 палочку,
у второго игрока, который становится в этих позициях первым, всегда есть выигрышная стратегия.
Ну по сути это означает, что у второго игрока в принципе есть выигрышная стратегия,
значит, это позиция проигрышная.
Понимаете, да?
Вот.
Но дальше теперь заметим, что 5, 6, 7 превращаются в выигрышные игры, потому что есть выигрышный ход.
Надо просто оставить противнику 4 палочки.
И он проигрывает, а мы выигрываем.
Ну и так далее.
Тут получается P, дальше V, V, V, ну в общем и так далее.
Ну в этом смысле, да, вот эта игра оказывается достаточно простой.
То есть если количество палочек делится на 4, то выигрывает второй игрок,
если не делится, то выигрывает первый.
И стратегия очень простая.
На каждом шаге оставлять противнику количество палочек, делящихся на 4.
Да, причем обратите внимание, в шахматах есть понятие «точный ход».
Ну вот здесь тоже заметим, что выигрывающий игрок должен играть абсолютно точно,
потому что малейшая ошибка, и тогда противник перехватывает инициативу и выигрывает.
Вот, в шахматах тоже есть понятие «точный ход».
То есть вы выигрываете, если делаете точный ход.
То есть вот если вы этот ход делаете, то вы выигрываете, если нет, то вас облапошивают.
Вот.
Да, ну здесь правда, ну вот.
Ну правда, здесь вот заметим, что, конечно, интересно, что любая игра с палочками,
она либо выигрышная, либо проигрышная.
Ну здесь, конечно, стоит обсудить еще.
А если бы можно было забирать не одну, две, три палочки, а что-нибудь другое.
Например, две палочки, три палочки или семь палочек.
Спрашивается.
А что в этом случае?
Как бы в этом случае понимать, кто выиграет на N палочках?
Ну надо либо два, либо три, либо семь.
То есть в данном случае, да, давайте это мы...
Ну вот.
Да, ну как ретро?
Ну пока палочки даже не надо ретро, а просто действительно есть та же самая динамика.
То есть если нам позволяется решать задачу за OATN, то в общем-то мы можем просто написать динамику.
Ну кажется это OATN-K динамику.
Ну по факту, да.
Если у вас K ходово, давайте, да, можно сразу обобщить.
Вот OATN значит решается за вот единицу.
Да.
Да.
Уверен.
А, 237?
Да.
237, наверное, нет.
Ну там...
Нет, ну может...
Ну как сказать, там по-разному, что вот 1A2, A3 и так далее, AK.
То есть, допустим, если у вас есть то, можно решать задачу за OATN-K, просто вот написав тупую динамику.
То есть, ну, заметьте, это просто динамика.
Да слава богу, мы с вами знаем, что такое динамика.
Вот.
Но не знаем, что такое DFS.
К сожалению.
Вот.
Ну а вы скажете вопрос, а можно ли это как-то ускорить?
Ну в каком плане ускорить?
Ну вот.
Ну на самом деле вот бывают случаи, когда K достаточно мало, и самое главное, все эти K, они там не сильно большие, они, например, 10.
Но при этом у вас N, допустим, до 10 в 18.
Вот такая типичная ситуация.
Ну, это, фактически нас интересует только последние там 10.
Короче, вот 10.
Да, хули.
Ну, нас интересует только последние 10.
А вы не можете сказать, что у нас период не больше, чем произведение всех Аши?
Нет, это не произведение.
Почему?
Нет, мы же, нас же интересует только результаты типа последних 10.
Ну, аккуратно скажем, да.
Заметим, что каждую следующую букву мы можем восстановить только по 10 предыдущим, правда?
То есть.
Вот.
То есть как бы каждые 10 идущих подряд буквок однозначно определяют следующую.
Ну теперь заметим, что количество буквонаборов из 10 букв P и V у нас вообще конечное количество.
А, вот так?
Да, 2 в 10.
Да, мы так мыслим.
Да, получается 2 в 10.
Понимаете, да?
Ну, что это значит?
Ну, тогда это означает, что если вы будете честно динамикой это вычислять, то рано в какой-то момент вы обнаружите зацикл.
Да, правда, не факт, что именно с нулем, правда, да?
То есть может быть, что у вас там типа вы считали, считали, считали, и у вас вот эта строчка, вот эта строчка совпала с вот этой, но не с нулем.
То есть предпериод возможен.
Ну, окей.
Ну, вы гарантируете, что это произойдет не более чем через там, то есть на, то есть вот эта штука не более чем там 2 в степени K плюс K.
Понимаете, да?
Да.
Ну, тогда после этого зацикла, тогда вы получается, что вы тогда уже в принципе тут все поняли и можете получается для любого N, после этого все вычисляется у от единицы.
Вот.
Ну, как говорится, технические детали мы опустим вот для краткости.
Вот.
И только скажем, что асимптотика такого решения получается там 2 в степени K на K плюс 1.
То есть можно вот это вот так вот сделать.
Ну, где только не K, правда, а вот это вот.
Макс, так сказать, Макс А.
Вот.
То есть вот такие игры можно еще вот так еще более интеллектуально решать.
Наверное, можно еще матрицу в степени.
А при чем тут вообще?
Ну, как бы там переходы живут.
Ну, в конечное число.
Ну, там, да, но они там как бы не над полем получаются, просто над чем-то булливым, поэтому не факт.
Ну, это же кажется какие-то логические...
Ну, да, это же какие-то булливые операции.
Ну, да, но по-моему не такие, над которыми можно матрицу забахнуть, потому что с отрицаниями там же будет.
Потому что по сути вам для каждой позиции нужно понять, нужно перебрать несколько позиций, понять, есть ли среди них проигрышное.
Если да, то вы выигрышное.
Если нет, если все выигрышные, то это проигрышное.
если все выигрышные, то это проигрышное. То есть, по сути, это что там получается?
Ну, то есть дизюнкция отрицаний. Ну вот, как бы, по-моему, в матрицу это, по-моему,
писывается не очень. То есть, если были ксорчики, тогда, конечно, там святое дело. Вот так.
Вот. Но нам это не очень принципиально. Это мы так немножко разомнулись, в общем-то. Потому что,
то есть, по сути, заметим, что если бы попытались эту игру представить как игру на графе,
у нас бы получился просто ациклический граф, правда? Чем не просто ациклический,
а еще какой-то просто устроенный. Но, с другой стороны, заметим, что у ациклического графа,
на самом деле, все может быть в этом смысле еще проще. Ну, потому что ладно. Так. Потому что,
ну, во-первых, потому что у ациклического графа есть такое понятие, которое почему-то,
как выясняется, не все знают. Как топологическая сортировка? Найдите топологическую сортировку
граф. Ну да. Ну да. Хе-хе-хе-хе-хе.
Ну вот. Заметим, что да, топологическая сортировка у нас существует. Более того,
да, мы не знаем, что такое ДФС. Но, на самом деле, знаем, что такое БФС. Ну, потому что самое
приятное в топологической сортировке это то, что мы знаем, что если игра ациклический и
конечная, мы рассматриваем конечную игру, то мы точно знаем, что существует вершина,
из которой ребра не торчат. Логично, да? Вот. И тогда, получается, идея могла быть, то есть,
можно делать такой, что-то типа обратного БФСа. То есть, запихнем в очередь все стоки. Ну, то есть,
вот, вершины, из которых ничего не торчит. А дальше будем говорить, что достаем вершину из
очереди, перебираем все ребра, которые ведут в нее, и как бы их выкидываем. Если после выкидывания
проверяем, что если из какой-то вершины оказалось, что ребра уже больше не торчит, значит мы ее добавляем
в очередь. Понимаете, да? И таким образом, ну вот, добавляем в очередь. И таким образом заметим,
что если выписать вершины, в каком порядке мы их достали из очереди, то это и есть топ-сорт. Ну,
правда, в котором ребра идут справа налево. Вот. Понятен механизм, да? Ну, в общем-то. Вот. Значит,
вот тут надо аккуратно. Итак, предположим, что у нас топ-сорт есть. Там все ребра идут справа налево.
Допустим. Вот. Ну, как-то вот так я тут от балды нарисую. И тогда оказывается,
фирмистическое утверждение, что любая ациклическая игра заведомо либо выигрышная,
либо проигрышная. Как это доказать? Ну, в общем-то, примерно тем же способом. То есть идем по топ-сорту
и для каждой вершины определяем выигрышная или проигрышная. Как мы определяем? Да очень просто.
Потому что у нас есть два принципа. Первый. Принцип выигрышности. Значит, принцип выигрышности.
Если у нас есть вершина, из которой есть ходы непонятно куда, но существует ход, хотя бы один
ход, в проигрышную вершину. То есть вершина, по которой мы точно знаем, что она проигрышная. То
из этого следует, что наша вершина выигрышная. Логично, да? И у нас есть выигрышная стратегия,
вида пойти в эту вершину, а дальше воспользоваться проигрышной стратегией. То есть это выигрышная
стратегия из-за второго игрока здесь. Понимаете, да? То есть есть вот такой принцип. И принцип
напарник. Принцип проигрышности. Если выяснилось, что все ходы ведут нас в заведомо выигрышные
вершины, то тогда из этого следует, что наша игра проигрышная. Заметим, что в этот принцип
входит и ситуация, когда ходов нет вообще. Если у нас ноль ходов, то значит все ходы ведут в
выигрышные вершины. А также можно сказать, что все ходы ведут в проигрышные вершины,
нечейные вершины и в 57 школу. Соответственно. Вот. Конечно. Да, это правда, что интересно. Да.
Вот. Соответственно. Вот. То есть это вот такие два принципа. Причем заметим, что я их, то есть я
их написал в принципе для произвольного графа. То есть даже если граф циклический, то в нем тоже
могут быть выигрышные и проигрышные игры, и эти принципы вполне применимы. Понимаете, да? Ну,
заметим, что в циклическом графе, если мы будем применять эти принципы к вершинам вот так по
очереди, то тогда у каждой вершины вопросиков не будет. Но тогда у нас два варианта. Либо все вершины
выигрышные, и тогда она проигрышная, либо тут хоть кто-то проигрышный, и тогда она выигрышная.
Понимаете, да? То есть оба принципа вполне себе применимы. И тогда получается, что просто за
простую динамику там на топ-сорте, за O от V плюс E, вы для каждой вершины можете легко понять
выигрышная она или проигрышная. Вот. Понятно? Вот. Это такой самый-самый-самый простой,
вот это сам простой вариант, ациклическая игра. Вот. Значит, ну что, ну вот. Ну да, тут дальше,
дальше дайте тут у нас как бы беседа на самом деле по теории, у нас будет иметь такую ромбовидную
структуру. Потому что когда мы говорим, потому что начинаем мы с ациклических игр, да? Теперь
дальше у нас есть развилка. Мы можем говорить об анализе циклической игра. Вот. А можем пойти
говорить о сумме ациклических игр. Это такие достаточно независимые темы. Вот. Ну, я думаю,
эти возможно вам там, скорее всего, многим из вас более-менее известны. Ну, там по модулю
доказательства. Вот. Ну вот. Да, это анализ неизвестен с доказательством. Ну, мы его сейчас
аккуратно проведем. Да. Но они у нас обе сойдутся. Потому что в итоге это приводит нас к теории Смита,
которая позволит искать сумму циклических игр. То есть максимум, что мы научимся, это такое. То есть
у нас дано несколько графов. То есть это типа как сумма игр. То есть у нас будет несколько графов,
суммарное количество ребер в них будет там где-то порядка 200 тысяч. Там вершины игр. Ну и нам дают
запросы вида. Допустим, мы там стартуем там вот в каждом графе сказано где. Скажите, пожалуйста,
это игра выигрышная, прогрешная или что или как. Вот. Это вот самые вот интересные задачи,
которые мы научимся. Нормально.
Да. Так вот. Эквиваленты. Где написано эквиваленты? Нет, в данном случае под словом экваленты я
подразумевал, что, ну, смотрите, то есть вот игру с палочками я могу проинтерпретировать так.
Вот у меня, допустим, есть вершина от нуля до девятнадцати и я из каждой из каждой вершины
могу пойти сюда, сюда и сюда. И здесь могу пойти сюда, сюда и сюда. Вот в данном случае
под эквалентность я подразумевал ровно это. То есть я могу просто легко представить граф,
в котором будет происходить вот по сути то же самое. Ну вот. То есть просто без изменения
математической сути. Хотя, как бы, важный вопрос, потому что на самом деле понятие
эквивалентной игры у нас будет, значит, оно будет принципиально другое. Вот. Значит, смотрите.
Итак. Значит, вот у нас такой ромбик. То есть у нас такие две линии сойдутся. Ну, начнем мы с,
может быть, более простой. Хотя кто тут простой? Не понятно. Ну, начнем, ладно. Допустим,
значит, сейчас мы перейдем к понятию циклической игра. То есть, предположим, что нам дан граф,
ну, допустим, там миллион вершин, два миллиона ребер. Но циклы в нем есть. Если бы в нем не было
циклов, мы бы, конечно, этот граф решили вот за втока. А что делать, если циклы есть?
Ну, начнем с того, что можно ли, тем не менее, найти, это, разделить вершины на выигрышные или
проигрышные? Ответ. Не факт. Потому что есть всякие интеллектуальные игры вот такого формата.
Вот. Интеллектуальная игра. Да. Как говорится, игра называется прогулка в тюрьме. Да. Вот.
Не, у меня первая мысль была вообще карусель, карусель. Ну, вот это уже. Вот. Нет, если говорить о
более официальных названиях. Нет, есть вообще интеллектуальная игра. Вот. Вот есть вообще такая
интеллектуальная игра из одной вершины. Да. Да. Эта игра называется луп. Да. Вот. Да, это вот одна из самых,
самая такая, самая, одна из самых интеллектуальных игр. Да, интеллектуальнее только вот то же самое,
но без ребра. Но это, ну ладно, там интеллектуальность уже там к толстому восходит,
но это уже другой вопрос. Да. Вот. Ну или есть там у ее напарник еще есть такой вот. Это игра сейв.
Вот такая игра. Заметим, что несмотря на наличие цикла, оказывается, что эта игра выигрышная.
Удивительно. Да, потому что, оказывается, есть выигрышная стратегия не бегай по петле. Вот. Ну,
в текущем пока у нас цикл только один, на самом деле эти игры, в общем, не особо
интересны для анализа. Вот. Но тем не менее вот луп, очевидно, выигрышный и прогрешный не является.
Это типичный пример, ну такой, может не самый типичный, но такой пример ничейной игры. Ну,
бывают, впрочем, разные ситуации. Можно построить пример, когда у нас два варианта ходить по петле или
проиграть. Ну, ну да. А, ну да. Да, да, да. Потому что есть вообще вот неожиданная версия. Вот такая,
допустим. Вот. Вот есть такая вот. Тогда можно принципы прям применять. Говорить, что вот эта
игра проигрышная. Да. Эта игра выигрышная. То есть мы просто поменяем принципы выигрышной. А эта игра
нечейная. Непонятно какая. Но по факту получается нечейная. Потому что, да, каждый игрок знает,
что, так, либо я пойду по петле, либо проиграю. Так, ну ладно, я пойду по петле. И оба будут ходить
по петле, и как бы, то есть дальше игра будет уже не интеллектуально-математическая, у кого нервы
сдадут. Ну, для этого в шахматах придумали правила с треекратным повторением. Но тогда это усложняет
нам граф, поэтому мы такое рассматривать не будем. Вот. Вместо этого мы скажем, а что такое вообще
нечейная игра. Кстати, а как мы делаем ретроанализ условно-шахмат, если там есть вот такие вещи?
В смысле? Раздуваем граф? Ну да. Ну то есть в позиции написано, где находятся белые, где находится
черные, кто ходит, когда последний раз ходила пешка и хит сезона, а какие позиции уже были,
чтобы не было трёхкратного повторения. Да, нет, это называется совсем тупой способ привести
задачу к конечному графу. То есть да, когда компьютеры станут достаточно быстрыми, как бы да, то есть
компьютер просто это будет такой... Ну почему? Нет, на самом деле особой жести нет, потому что
одно дело компьютер решил игру, а другое дело как бы человек это понял, то есть это немножко разные
вещи всё-таки. Нет, пока конечно нет, пока выясняется, что как бы на любой стоквиш найдётся альфа-зера,
но вот поэтому ещё вопрос. Ну вообще да. Кстати, да, вот они ж не проводили тренировку, что давайте
есть альфа-зера, тренированная четыре минуты, а есть альфа-зера, тренированная полчаса. Спрашивайте,
с каким счётом полчаса вынесут четыре минуты? Вот, к сожалению, да, Google... Ну, хотя нет,
нет, скорее всего они, скорее всего они, конечно, проводили такие эксперименты, это да. Ну да,
но правда нет, вот тут в этом смысле аккуратно, потому что заметим, что тут принципиально разные
технологии компьютерные, потому что допустим там все под стоквиши и прочие, там эти все пицунды,
там с этими, там прочими, они там основаны на всяких там альфа-бета отсечениях и отличаются
только оценкой какой-то конечной позиции в общем-то. Не совсем правда. Почему? Тоже есть. А, всё-таки
стали запихивать туда, но окей. Ну да, ну ладно, но давайте попробуем к этому приблизиться,
о чём мы вообще говорили. Так вот, а то мало ли. Ну вот, значит теперь вопрос, что такое игра
нечейная? Ну как вы уже говорили, мы будем говорить, что игра нечейная, если у нас сейчас будет
именно в очень позитивном смысле. То есть часто говорят, что такое игра нечейная, когда ни у кого
из игроков нет выигрышной стратегии. Ну вот, но это не... Что такое нет стратегии? Вот как доказать,
что у игрока нет стратегии? Вот как доказать, что у него нет в принципе стратегии, а не просто
потому что он тупой? Вот. Ну на самом деле я знаю только один надёжный способ, как доказать,
что у первого игрока нет стратегии. Очень просто. Надо доказать, что у второго игрока есть
стратегия, которая не позволит ему выиграть. Поэтому мы будем говорить, игра нечейная, если у каждого
из игроков, у обоих игроков, так я так напишу, у каждого из игроков есть своя непроигрышная
стратегия. То есть отличие, да? То есть выигрышная стратегия, которая позволяет жёстко выиграть,
а непроигрышная, которая позволяет не проиграть. Вот. Но у такого позитивизма есть, собственно,
одна маленькая проблема. А бывают ли игры кроме выигрышных, проигрышных или нечейных? Вот заметим,
на уровне таких определений это вообще говоря не очевидно. Ну это нужно доказать. Да. То есть если
вы написали просто игра нечейная, если она не выигрышная и не проигрышная, тогда да, без вопросов.
Но на таком позитивном уровне всё-таки, знаете, надо доказывать. Но давайте думать, значит.
Значит, попытаемся, ну, значит, попытаемся, значит, решать. Итак, что же у нас будет? Значит, что же тут у нас будет?
Ну вот. Как там? Ой, вонючка. Так. Так, значит, это мы убираем. Нет, мы убираем. Хочется доказать,
что в духе, что если у какого-то из игроков нет выигрышной стратегии, поэтому нет непроигрышной,
то он должен проиграть. Ну. Не кажется, это должно быть достаточно, чтобы говорить ничего? Да. Но мы пойдем другим путем.
Значит, мы скажем так. А какие у нас способы вообще сейчас есть доказать, что игра выигрышная или
проигрышная? У нас по сути пока есть только вот эти принципы. Правда? Так вот, идея такая. Давайте
применять эти принципы пока можем. Более того, мы их еще и будем применять красиво. А именно. Но очевидно,
что первая вершина, которую мы можем в графе применить какой-нибудь принцип, это очевидно
принцип проигрышности к тем вершинам, из которых ребер не торчит. Правда? Так вот, мы сделаем даже
более аккуратную вещь. Мы выпишем сразу себе все такие вершины и объявим их. Нет, неправильно. Вот. Мы
объявим их проигрышными и назовем их слоем номер ноль. Почему мы их назовем слоем номер ноль? Потому что
заметим, что из этих вершин игра будет длиться ноль ходов. Но тут без вариантов. Хорошо. Применяем
принцип проигрышности пока можем. Вот все эти вершины оказались таким. Принцип проигрышности
закончился. Теперь к некоторым вершинам, наверное, можно применить принцип выигрышности. Вот давайте
тоже его применять как можем. Ну что это за вершины? Очевидно, это вершины, из которых есть ход куда-то
вот в этот слой. Может даже не один, но хотя бы один точно есть. Вот. При этом заметим, что эти вершины
мы назовем выигрышными из слоя номер один. Почему? Потому что из этих игр, то есть из этих вершин игра
может длиться один ход. Ну что значит длиться? Ну тут по-разному. Потому что заметим, что если вот здесь из
этих вершин ребер нет, то из этих вершин помимо вот этих ребер может быть что угодно. Может быть ребра
из, просто в другую вершину такую же, может быть даже в себя тут какие-то вот такие ребра, а может
быть вообще ребра в какие-нибудь вершины там еще, которые в эти слои не попали. Понимаете, да? Но
тем не менее, если мы будем говорить о том, что мы даже себе поставим такую цель, что если выигрывающий
игрок хочет выиграть как можно быстрее, а проигрывающий хочет наоборот тянуть время как может,
то тогда при идеальной игре, значит игра будет длиться из этих вершин один ход. Ну выигрышный игрок
просто сразу расставит все точки над ею, соответственно. Вот, значит хорошо, принцип выигрышности
наприменяли, прям наприменяли, наприменяли, наприменяли, но теперь значит и выигрышные вершины
закончились временно, но зато появились новые проигрышные вершины. Что это за вершины? Ну это
очевидно вершины, у которых все ребра, хотя бы одно ребро есть, ну чтобы они сюда не попали, да, но
тем не менее все эти ребра ведут куда-то в слой В1. Вот как-то вот так, вот может вот так, вот так. Вот
вот. Эти вершины мы будем называть P2, потому что из них оптимальная игра будет длиться два хода. Ну вот
применяем, применяем, применяем, применяем, применяем, применяем. Ну хорошо, больше проигрышных вершин
пока нет, начинаем применять принцип выигрышности. И появляются вершины, про которых мы знаем только
одно, что из них нет ребер в P0, но есть ребра в P2, хотя бы одно. То есть все, что мы можем знать,
то что вот такого вот таких ребер нет. А могут быть вполне себе ребра вот сюда, могут, кстати,
обратно ребра вполне себе идти. Вот. Но хотя бы одно вот какое-то ребро из каждой вершины обязательно
будет иметь место. Вот так вот. Это мы называем очевидно в V3. Вот. Вот обратите внимание, да,
вот из какой-то вот этой вот вершины, да. Да, кстати, обратите внимание, вот из этих вершин вполне себе,
ну вот из этих вершин, ну вполне себе куда-нибудь вот сюда на самом деле вполне себе ребро быть могло.
Но из этой вершины так ходить невыгодно. Вот. А могли быть сюда, но это вообще невыгодно, потому что
тупо проигрываем. Вот. Но это соответственно V3. То есть если делать оптимальный ход, то как
оптимальные ходы, то как бы игра будет длиться три хода. Вот. Ну и так можно повторять. Потому что
дальше будет идти слой, соответственно, P4. Что можно сказать про слой P4? Что все ребра ведут либо
в V3, либо в V1. Причем из каждой вершины хотя бы одно ребро в V3 идет. Ну потому что если все
ребра придут в V1, то очевидно мы бы его просто в P2 бы уже записали. Правда? Вот. Да. То есть вот как-то так, вот так, вот так, вот так, вот так, вот так, вот так, вот так. Ну и там всякая вот. Такая вот, вот так.
Мы же не можем вершину сразу записать в V2, если у него все ребра в V1? Нет. Если у него одно ребро в V1, мы не можем написать.
А, да, потому что надо все. Потому что надо все. То есть знаете как-то, как-то в старой книжке говорили. То есть допустим на вас упали папины штаны. Что это значит? Ну все что угодно. Но если на вас дружно
посыпались папины рубашки и мамины платья, то можете успокоиться. Вы забрались в плотяной шкаф,
и сейчас вас оттуда за шкирку будут вынимать. Вот. Вот здесь примерно такая же ситуация. То есть допустим там у вас есть ребро в V1. Что это может
значить? Ну все что угодно. Но если на вас дружно посыпались ребра, все из которых торчат в V1, можете успокоиться. Вы в P2. Вот. А если там есть все V3, V1 и есть тройбан, то значит вы в P4.
А вот с выигрышностью наоборот. Если у вас есть ребро, значит соответственно в P, там какой-то вот скажем вот теперь у вас появились, там в следующем слое будут
вершины у которых нет ребер в P2 и P0, но есть в P5. То есть в P4. Значит это V5. Тут V5. Ну и так. Ну еще короче и так далее.
Сейчас мы утверждаем, что их статус, эти ВП, они всегда зафиксируются. Да. И то, что ты на максимальной игре, то есть если я пытаюсь укоротить, они соберут.
Да, если выигрывший укорачивает, а проигрывающий и затягивает, то длина игры будет ровно такая. И вы просто прям аккуратно по индукции, то есть на самом деле то, что мы сейчас
доказываем, мы прям по индукции доказываем, что прям конструктивно, что в каждом слое происходит именно так.
Ну вот. Ну вот V5 почему это так, например? Потому что кто такие V5? Это те, у кого после окончания работы с четвертым слоем неожиданно оказались выигрышными, а раньше они выигрышными еще не являлись.
В смысле мы об этом не узнали. Как это могло произойти? Это могло произойти по одной простой причине. У них нет ребер в P2 и P0, но есть ребер в P4.
Логично, да? Вот. Значит, вот эти ребры есть. Ну там какие еще там ребры есть? В3 у них могут быть ребра, V1, пожалуйста, и наоборот, пожалуйста, все что угодно.
Вот. Ну и так далее. После того, как мы обработали V5, у нас могли появиться новые проигрышные вершины. Что это за проигрышные вершины?
Ну это очевидно. Во-первых, это вершины, у которых все ребра ведут выигрышные, а во-вторых, хотя бы одно ребро ведет сюда, потому что иначе она попала либо сюда, а то и раньше.
Ну потому что нам сейчас принципиально, когда вершина и была идентифицирована нами как проигрышная. То есть как бы у нее, видимо, были уже какие-то ходы в выигрышные вершины, но как бы именно с появлением этого слоя появилась последний гвоздь в крышке гроба.
Понятно, вроде, да?
Сейчас я не понимаю, почему у нас длина будет, ну почему меньше?
Ну потому что, смотри, ну потому что идея такая, то есть ну как бы если игрок в проигрыши вот думает, куда ему пойти, если он пойдет сюда, то значит игра будет длиться четыре хода, да?
А если пойдет сюда, то будет длиться шесть ходов.
Утверждение. Может ли он куда-то пойти сюда, ответ? Может. Почему?
Ну просто потому что, если бы из этой вершины можно было пойти только в v3 v1, то эта вершина попала бы уже в этот слой.
Так, хорошо. А почему мы не могли, почему не могло бы быть какого-то другого пути, который привел бы, ну какой-то другой выигрышный вершин, который не лишит v3 v1 v5, и при этом привело бы нас к проигрышу, потому что, ну понятно, давайте чего-нибудь
А потом, нет, пока нет, у нас просто нет, просто мы про эти вершины как бы у нас все доказательно.
Ну, значит там, так, ну как сказать, да, по-разному можно проводить аккуратное доказательство, можно просто рассмотреть этот, так сказать, какой-нибудь оптимальный путь, наверное, и доказать, что там,
то есть все его вершины на самом деле были, уже попадали в эти слои.
Ну, то есть мы просто на каждом шаге доказываем, что у нас, то есть здесь мы берем все вершины, из которых, вот, проигрышные игры, у которых длина будет 0, игры, да?
То дальше мы берем все вершины, у которых, потому что что такое выигрышные вершины с длиной игры 1? Это игры, из которых существует ход в проигрыш с ходом 0, да?
Ровно все такие вершины мы выписали.
Сейчас, Филипп Дмитриевич, почему из наших определений не очевидно, что все являются на три типа? У нас же определение ничейной игры, это просто отрицание первого и отрицание второго.
Нет, ну, я не знаю, лично для меня, как бы, утверждение, что, как бы, нет выигрышной стратегии, у первого нет выигрышной у второго, и утверждение о том, что у каждого из них есть не проигрышная стратегия, это не одно и то же.
Ну, просто нет выигрышной может означать, что ты вообще проигрываешь всегда.
То есть, может быть, как-то можно очень жестче сформулировать, но как-то для меня на уровне, просто на уровне русского языка это разные вещи.
То есть, может быть, теоретически на уровне языка можно как-то аккуратно действительно это вывести, но лучше сделаем по-другому.
Так, вот, возвращаясь к этому, ну, на самом деле так, можно построить в явном виде эти слои, запомнив свойства, но, по крайней мере, что не вызывает сомнений, так это то, что эти вершины реально проигрышные или выигрышные, пока плевать на какое количество ходов.
Ну да, мы вот буквально это и делаем, потому что мы применяем честные проигрышность и выигрышность, вопрос, в какой слой она попала, и свойства мы знаем.
Если вершина попала в слой V5, значит у нее есть ребров P4, но нету слой ребров P2 и P0.
Пока это не значит, что игра будет длиться ровно столько, это значит пока это.
Пока еще совершенно не понятно, что делать с остальными.
Вот, а что значит с остальными? Ну, рано или поздно принцип закончится, то есть следующий слой обрубится, да?
Да.
Да.
Ну, сейчас.
Итак.
У нас конечный граф.
Да, у нас конечный граф, но у нас, но проблема в другом, то есть да, то есть сколько-то у нас слоев еще будет, да, то есть сколько-то слоев будет-будет,
если повезет, ну может нам повезет, и на самом деле слои, то есть просто вершины закончатся, и тогда получается все вершины у нас выигрышные и проигрышные.
Вот, кайфец.
Но может так случиться, что вершины не закончились, а слои закончились.
Ну, просто оказалось, что тут и принцип выигрышности уже вот нельзя применять, но и принцип проигрышности применять тупо некому.
Тогда остались вершины, которые мы обзовем X, такой слой X, так сказать, то есть вершины, которые в эти исходные слои не попали.
Ну вот, так вот, сейчас мы просто докажем, что все эти вершины являются нечейными вот прям вот в этом жестком определении.
Как мы это сделаем?
Да очень просто.
Потому что утверждение такое, давайте подумаем, куда из, ну, во-первых, заметим, что из каждой из этих вершин ребра в принципе есть, правда?
Иначе они не будут впадать.
Да.
Ну, куда эти ребра есть?
Заметим, что ребер в проигрышные вершины здесь из X быть не может.
А куда могут быть?
Ну, выигрышные могут быть вполне.
Ну, еще обязательно куда-то.
А могут быть и внутри X, но заметим, что из каждой вершины обязательно есть хотя бы одно ребро в другую вершину слоя X, ну или в себя любимую.
Иначе их уже можно выписать в проигрышные.
Да, потому что совершенно верно, да, потому что если все ребра ведут в выигрышные, значит мы бы их записали в проигрышные на какую-то там, а мы говорим, что принцип нельзя.
То есть получается вот такая интересная штука, да, что могут, то есть из каждой вершины есть хотя бы одно ребро в X и может быть есть ребра в V.
Но теперь утверждение.
Все эти ограниченные.
Ну, тут доказательства, может, самое короткое доказательство, по-моему, вот, проводится так.
Первое утверждение, докажем, что у второго игрока есть в любой вершине X непроигрышная стратегия, у второго.
Ну, как мы это докажем?
Вот мы это будем делать всегда по одному принципу.
Рассмотрим ход первого игрока, да?
Куда он нас может привести?
Он нас может привести либо в X, либо в V.
Ну, если он нас приведет в V, то у нас есть, как бы, мы можем не проиграть, просто путем выигрыша.
То есть типа лучшая защита это нападение.
Вот.
Но первый игрок может...
Сейчас, подождите, если у нас ход идет в V, то мы...
Да, но мы второй игрок, напоминаю.
То есть если первый игрок пойдет сюда, значит мы выиграли, да?
Но если первый игрок пойдет в X,
то у нас тогда получается, что у нас заведомо будет ход.
Ну, у нас будет ход в X, и мы по нему пойдем.
По-любому.
Ну, если их несколько, выберем любой.
И заметьте, что эта стратегия гарантирует нам непроигрыш.
Потому что после каждого хода первого игрока гарантируется, что у нас ход...
Ну, то есть гарантируется, что у нас ход будет.
То есть либо первый игрок будет вечно нас гонять по X,
и мы будем с ним вечно ходить по X, и не проиграем.
Либо в какой-то момент у него сдадут нервы, и он все-таки пойдет в V.
И тогда мы тупо выиграем.
То есть вывод.
У второго игрока в любой вершине X есть непроигрышная стратегия.
Остается только доказать, что у первого игрока тоже есть и проигрышная стратегия.
Ну, все очень...
Да, но у него стратегия очень простая.
Так, у меня есть ход в X, я иду в X и теперь не проигрываю, как второй игрок.
Все.
Вот оптимальнее вот так просто начать со второго, а потом первый просто очень быстро к нему сводится.
Вот, понятно?
Вот.
То есть таким образом получается, что все, что не попало в эти вершины, то есть в эти слои,
это не чейные вершины.
То есть таким образом мы доказываем, что, по крайней мере, в таких играх на графах
действительно все игры выигрышные, проигрышные или не чейные.
Вот в конструктивном смысле.
Остается...
Ну вот.
Правда, теперь вот остается только...
Вот был вопрос действительно, что теперь, пользуясь тем, что это все боевая ничья,
да, то мы теперь можем, теперь можно уже аккуратно доказать, что, как бы, если у нас тут выигрыш и проигрыш,
то длина игры, если выигрывающий будет стараться выиграть побыстрее, а проигрывающий
попытается проигрывать как можно медленнее, то длина игры будет ровно такая.
Почему?
Ну просто заметим, что согласно выигрышной стратегии, ну заметим, что проигрывающий игрок,
да, он может, то есть он может сделать ход в следующий слой всегда.
Ну может, иногда может перескочить, но ему это просто невыгодно, да.
А выигрывающий, наоборот, он может сделать ход в следующий слой, но перескочить,
там, перескочить он может только, если пойдет в другую выигрышную вершину, а он этого делать не будет,
потому что он тогда проиграет.
Поэтому тогда отсюда аккуратненько по индукции получается, что длина игры будет ровно такая.
Да, уже после того, как бы показали, что, то есть там могут быть, то есть там индукция изначально не работала,
потому что, как бы, из вешного слоя есть ходы даже и в эти иксики, вот.
Но в этих иксиках мы уже сказали, что там, как бы, он туда ходить не будет,
потому что там противник, собственно, гарантирует себе не проигрыш.
Это ему тоже не надо.
Потому что основной принцип все-таки, да, что если мы можем выиграть, то мы выигрываем.
Вот, там разные подлянки, потому что там, скажем, как бы, если уж говорить о задачах из лоши,
то у кого-то из поколений была вообще эпическая задача, там, что два котенка там тоже играют
с подобного рода игру, но у них теперь, наоборот, фишка.
Выигрывающий хочет растянуть удовольствие, выигрывать как можно дольше,
а проигрывающий, наоборот, хочет закончить игру как можно быстрее.
Вот, но там, да, но там, заметим, выясняется, но там может выясниться интересная подробность,
что там, вот, при наличии вот подобного рода ребер, оказывается, что игра может длиться вечно.
Ой.
Да, такое бывает, там вот интересные эти случаи, там интересные эти случаи рассмотреть, да.
Вот.
Он в любой момент может закончить.
Да.
Но он не хочет, да.
Но он не хочет.
Ну, садизм.
Вот.
О, да, добрый.
Кстати, а кто, а кто встречался с задачей?
Только подивите, кто встречался с задачей?
Вариации задачи прокатят.
Да ладно.
Так бывает.
Ну ладно, придется, да ладно, придется дадизм вам понравится, да.
Нет, ну это проще, чем там это, писать красночерное дерево со сплетом и ржом, да.
Ну почти все что угодно проще.
Да.
Ага, а если я тебя попрошу софт хип написать?
Ну ты почти.
Вот граната Чизеля просто открою.
Черт.
Как бы элементарно.
Ну да, а потом выяснится, что он не работает.
Нет, ну я не знаю, я не проверял.
Ну, кажется, кое-что публикованное в статье должен бы работать.
Ну.
Он об этом не знает.
Ну, валя, а что думаете, кто-то его проиграл?
Ну валя, а что думаете, кто-то его переписывал, запускал?
Думаю, за столько лет, да.
Ну да, ну там, ну да.
Ну окей.
Вот.
Так.
Ладно, значит, смотрите.
Так, ладно, нам еще кое-что тут надо добить, на самом деле.
Так, что, вопросы еще какие-то возникли?
Вообще але сейчас pressing on is open.
Что, вопросы еще какие-то возникли?
Да?
Ну и если взять просто отрицание третьего определения,
то мы получим одно, и я про это говорю.
У каждого есть непроигрышное.
Отрицания у одного нет.
Ну как-то я не понимаю.
Вот как так на уровне с vorher.
То есть, допустим, пусть у второго и chyba нет непроигрышной
стратегии, а как следует из этого, что первая есть выигрышная?
Нет, если у него нет непроигрышной, вообще все.
А если у кого-то все проигрышные, то тогда полно?
Ну вот не знаю. Лично у меня тут какие-то сомнения еще вызывают. Возможно, если прописать формальное определение стратегии, конечно.
Но стратегия как набор ходов, то может быть что-то подобное доказать и можно.
Просто как будто если у человека все стратегии проигрышные, это достаточно понятная ситуация.
Но все равно возникает интуиция. Все равно может там конкретные стратегии проигрышные.
Но если там призвать на помощь за эту самую молитву, которую мы уже упоминали, то может и сработает.
То есть мало ли. Потому что стратегия как бы это все-таки что-то ограничивающее.
Что мы жестко делаем вот так. А может быть там еще что-то привлечь может.
Но вот подобным методом доказали, что на самом деле нет. Тут все достаточно четко.
Четко, конструктивно, позитивно. В каждой вершине четко прописано, что кому надо делать.
Остается только маленький вопрос, прежде чем мы пойдем на перерыв.
А за какое всем точку мы вообще вот это можем все проделать?
Вот как.
Ну да.
Ну на самом деле по большому счету да.
То есть давайте запустим БФС по обратным ребрам. Но БФС хитрый такой.
То есть мы будем говорить, что сначала мы будем добавлять в очередь все вершины, у которых нет ребер.
Нет, ладно, вру, не так. Сначала мы добавим все вот эти вершины в очередь.
И объявим их проигрышными с нулем и добавим в очередь.
И дальше, когда у нас в очереди, мы говорим вот мы достаем вершину и допустим это вершина из П, там что-нибудь там 4.
Тогда перебираем все ребра ведущие в нее.
И если эти ребра еще не в очереди, да, то есть кто-то уже там давно в очереди, или там уже побывал давно, это не интересно.
Но если вот эта вершина еще у нас не была, то мы ее добавляем в очередь, обозначая как В5.
Вот.
Это если она проигрышная. В чем там плевать, есть еще ребра нет.
А если выигрышная, то когда мы ее достаем из очереди, тогда мы прибираемся по всем ребрам ведущим в нее и как бы удаляем их.
Но самый простой способ удалить их, это просто в каждой вершине хранить, а сколько ребер у нее торчащих еще живы.
То есть надо просто счетчик в каждой вершине уменьшить на 1.
И сказать при этом, что если оказалось, что счетчик достиг нуля, вот тут допустим счетчик 2, тут счетчик 3, а тут счетчик стал 0.
То значит торжественно объявляем, что эта вершина П6, и мы ее торжественно добавляем в очередь.
То есть заметим, что этот BFS пробежится ровно по слоям.
То есть сначала у него будут П0, когда он достанет все эти вершины из очереди, у него в слоях будут в точности В1.
Когда он обработает все В1, там будет в очереди находиться в точности П2, ну и так далее.
Понятно, да?
То есть таким образом получается О от В плюс Е.
Вот, ну обычно вот этот алгоритм обычно и называется ретроанализ.
То есть это еще сокращение, потому что это обычно называется что-то типа retrograde analysis, там что-то в этом роде.
Так что вот такая вот веселья.
Так что вот таким образом получается, что если у нас любой граф, который мы хотя бы можем адекватно считать и похоронить, мы можем легко решить.
Но игры бывают и более сложные.
То есть на самом деле один из способов это действительно сделать сумму игр.
А что такое сумма игр?
А сумма игр, ну давайте сразу скажу на пальцах, что представьте себе, что у нас такая игра, у нас есть два графа и две фишки.
И каждый раз игрок выбирает какую фишку двигать и двигает ее.
Проигрывает тот, кто не может сделать ход прям не там, не там.
То есть тогда оказывается, что эту игру достаточно легко свести к игру на одном графе, только количество вершин там будет типа произведения.
То есть там есть эти карты произведения, прям честно забывать.
А хочется быстрее, да.
Но оказывается на циклических рафах это делается совсем легко.
Ну а на циклических, ну там за более сложную симпатику тоже делается.
Ну первую часть мы обсудим сегодня, а следующую обсудим в следующий раз.
А пока перерыв.
Нет, это еще не конец, сейчас еще только 12.10.
Вот.
Итак, следующий номер нашей программы.
Значит мы попытаемся просуммировать пока, пока не менее ациклический игр.
Но я уже кратенько сказал, что это такое.
Так, ну ладно, про выигрышность, проигрышность, нечейность мы все поняли.
Вот, значит и так.
Значит давайте еще раз.
Что же такое у нас сумма игр?
Да, сумма игр это у нас обычно, то есть это обычно такая игра.
То есть здесь у нас две, допустим две игры.
Вот допустим, может быть вот такая.
Вот и ну скажем, вот такая.
И допустим в каждой игре есть фишка.
И тоже играют два игрока, но на этот раз игрок может выбирать какую фишку двигать.
То есть он двигает только одну фишку, но он выбирает какую.
Проигрывает соответственно тот, кто не может сделать ход ни в одной игре.
Вот, ну и нам тоже жутко интересно, кто выиграет при правильной игре.
Самый простой способ, конечно, то есть понятно, что такая игра тоже может быть сведена к игре на одном графе, правда?
Да нет, наверное.
Ну естественно, потому что можно, например, там сделать граф просто на там, просто декартовых произведениях верши.
Логично, да?
Ну тут я даже особо рисовать не буду.
Но это много, потому что если каждый граф по 100 000 вершин, 200 000 серебр, то декартового произведения вы естественно не построите.
Вот.
Значит, что же делать?
Ну, значит, как в шахматах.
Надо, значит, находить какие-то более глубокие стратегии.
То есть это более глубокие стратегии, более глубокие свойства.
Вот.
Ну, во-первых, да.
Ну вот.
Ну, во-первых, да.
Обозначать сумму игр мы так и будем.
Если это игра A, это игра B, то сумму будем означать, естественно, A плюс B.
То есть игра плюс игра равно игра.
Возможно, другая.
Ну, вот.
Ну, заметим, что складывать, естественно, мы можем, в принципе, и три игры, и четыре, и пять, и шесть.
Причем сумма будет, как говорится, кому-то активна, ассоциативна.
Логично, да?
Вот.
Так что не будем тут особо заморачиваться.
Вот.
Но мы попытаемся все эти игры, как говорится, кормить.
Вот.
Ну, вот.
Не будем тут особо заморачиваться.
Вот.
Но мы попытаемся эти игры как-то классифицировать.
Что имеется в виду?
Значит, мы скажем, вот мы уже упоминали это слово, но сейчас мы дадим ему принципиально другое вместе с тем формально определение.
Так, да.
Во-первых, начнем с другого.
То есть пусть A это произвольная игра на графе.
Тогда ведем такое понятие.
Я его люблю называть view от A.
Вот.
Ну, нет такой, конечно, буквы view, конечно, в греческом алфавите.
Нету, естественно.
Есть new.
Ну, вот.
Но я ее люблю называть view от A.
Вот.
Так вот view от A это будет буковка типа выигрыш vnp.
Это типа результат игры.
Если оба игрока играют оптимально.
Ну, я тут немножко оптимально.
Оп-ти-маль.
Вот.
Тут все.
Ну, вот.
Ну, то есть просто мне для игры вот хочется понимать она там.
То есть понятно, мы уже доказали, что любая игра играется выигрышной, ничейной или проигрышной.
И вот пусть view от A это вот, собственно, чем она является.
Понятно, да?
Понятно, да.
Так вот теперь вот интересное определение.
Значит, интересное определение.
Значит, будем говорить, что...
Значит, пусть A и B играют.
Тогда будем говорить, что A эквивалентно B.
Если для любой игры C верно, что view от A плюс C равно view от B плюс C.
Вот такая неожиданность.
Вот такие игры мы будем считать эквивалентными.
Вот наша задача будет изучить, а какие игры вообще с точностью до эквивалентности бывают.
Вот.
Понятно?
Оптимально это еще раз.
Если у них есть выигрышная, то они играют по выигрышной, если есть непроигрышная, то по непроигрышной.
Ну, типа да.
Ну, типа если у одного игрока есть выигрышная стратегия, он как бы играет по ней и выигрывает.
Если у обоих есть непроигрышная стратегия, значит они обыграют по непроигрышной стратегии и объявляется ничья.
Результат имеется в виду, конечно же, вот в этой ситуации.
Так вот.
Смотрим дальше.
Значит, смотрите.
Ну, во-первых, мистическое свойство, которое мы будем почему-то называть тиремой 1.
Ну, почему-то ладно.
Причина простая.
Потому что я рассказываю.
Редкий случай.
Есть красивая русскоязычная литература.
Называется Эндрюс Танкевич и гранографа.
А, ну я на автомате, да, извините.
Да, там Андрей Танкевич.
Там А.С. Танкевич будет.
И просто нагуглить можете на самом деле и прям следить.
Вот.
Такая замечательная штука, конечно.
Так вот.
И там тирема 1 говорит.
Значит, говорит, что пусть.
Ну, он говорит так.
Пусть А1 эквивалентно А2 и Б1 эквивалентно Б2.
Тогда, естественно, А1 плюс Б1 эквивалентно А2 плюс Б2.
Вот.
Понятно, да?
Ну, давайте проведем формальное доказательство.
Формальное доказательство звучит так.
Что для любой С В от А1 плюс Б1 плюс С, да.
Это вот если воспринять это как произвольную игру, да.
То получается, что это равно В от А2 плюс Б1 плюс С.
Логично, да?
Но с другой стороны, это равно В от Б1 плюс, и тут в скобочках, А2 плюс С.
Так вот.
Ну, вот.
То есть, получается, Б2 тоже подменяем.
Это равно В от Б1 плюс Б2 плюс С.
Доказательство окончено.
Вот.
Ну, это я тут немножко раслегся формализмом.
То есть, что приятно, да.
Эквивалентные игры можно складывать, и тоже получится что-то эквивалентное.
Вот.
Понимаете?
Так.
Так.
Так.
Ну, в смысле, у нас получилось А1 плюс Б1 эквивалент на А1 плюс Б2.
В смысле, почему?
Нет, ну, А1 плюс Б1 эквивалент на А2 плюс...
Ой.
А.
А, я описался.
Да.
Ну, бывает.
Значит, да-да-да-да-да.
Правильно.
Б2 плюс А2.
Да.
Да, вот так.
Влад, я ж не буду дописывать, что это равно В от А2.
Влад, я ж не буду дописывать, что это равно В от А2 плюс Б2 плюс С.
Вот.
Ну, и так.
Это пока просто прикольное свойство.
А теперь вообще заметим.
Вот мы хотим складывать игры, да.
Потому что ВАЗК это вообще идея такая.
Вот.
И если мы сложим две игры, то есть, вместо того, чтобы анализировать дикартовые произведения игр,
хочется вообще сказать, а давайте просто проанализируем одну игру и проанализируем другую.
Может, мы на самом деле по результатам анализа уже можем сказать, каков результат суммы.
Ну, вот давайте теперь в это поиграемся.
Вот, например, если нам предложили сложить две проигрышные игры.
Вот нам дали две проигрышные игры.
Как вы думаете, каков будет результат?
Проигрышных, да?
Так.
Не факт.
Может быть две тупиковых.
Так.
Ну, если две тупиковых, то это проигрышные игры.
А, стоп.
Наверное, проигрышные.
Так.
Потому что соперник может отвечать в той игре, в которой мы сходили.
Да-да.
То есть, в данном случае, да.
Ну, в общем, заметим, что по-хорошему, да, П плюс П может быть проигрышным, потому что есть два тупика.
Но в данном случае заметим, что других вариантов не бывает.
То есть, П плюс П тут заведомо П.
Да, потому что у второго игрока есть явная стратегия победы.
А именно, какой бы ход ни сделал первый игрок, второй игрок идет в ту же игру и делает ход в соответствии с выигрышной стратегией в этой игре.
Все.
Вот.
Ну, отсюда следует еще маленькая приятная вещь.
А если я вас попрошу сказать П плюс В?
Ну, мы делаем ход в выигрышной у соперника.
Да, совершенно верно.
То есть, первый игрок выигрывает, потому что он просто идет в выигрышной игре в выигрышный ход и подсовывает противнику П плюс П.
Логично, да?
Так.
А вот теперь более сложный вопрос.
П плюс Н.
П плюс Н.
Сейчас.
Ну, казалось бы, нечейно.
Почему?
Ну, пока что мы в общем случае рассматриваем сумму игр.
Конечно.
Да, но мы прям жестко знаем, что какие бы вы две проигрышные игры не сложили, получится проигрышные.
Если мы выходим в проигрышной, то если первый выходит в выигрышной, а второй просто обидит именно в той же, то мы снова получим П плюс В.
А если первый выходил в нечейной, то, соответственно, второй будет играть по своей нечейной тактике.
Ну, да.
То есть, давайте посмотрим.
Ну, да, хорошо.
Да, здесь заметим следующее.
Что, значит, просто опишем.
Ну, давайте так.
Опишем непроигрышную стратегию второго игрока.
Да, то есть докажем, что да, тут П плюс Н, железо, бетонно, Н.
Ну, заметим, очевидно, что когда вы складываете что-то с ничей, то всегда может получиться ничья, потому что есть такая типичная ничейная игра, как луп.
Вот, помните, да?
Вот эту интеллектуальную игру.
То есть, это вообще, это прям супер нечейная игра.
То есть, вы ее с чем угодно сложите, получится ничья.
То есть, она просто обнулит все.
Вот.
Но, возможно, но нечейные игры бывают и другие, поэтому надо доказывать, что ничего кроме ничьи не бывает.
Или, наоборот, находить, что, может, там найдется какая-нибудь там П плюс Н, какая-нибудь выигрышная.
Но не в данном случае.
То, что докажем, что в игре П плюс Н у второго игрока всегда есть непроигрышная стратегия.
Потому что, ну, идея будет такая.
Что может сделать первый игрок?
Ну, у первого игрока есть, может быть, ход в игру В плюс Н.
Да? То есть, какие вообще ходы он может сделать?
Он может сделать ход в игру В плюс Н.
Он может сделать ход в игру П плюс В.
Ну, в смысле, в ничейной игре.
Да, ну, есть проигрышная игра.
Он, если может сделать ход, то только выигрыш, правда?
Значит, тут получается П плюс В.
То есть, такой классический для нас будет анализ.
И еще будет вариант сохранить статус ЧО и, собственно, пойти в П плюс Н.
Статус ЧО это, конечно, хорошо.
А что? Вот.
Вот.
Значит, давайте думать.
Но заметим, что если первый игрок пойдет сюда, ну, мы уж точно не проиграем.
Потому что, как мы уже доказали, мы тупо выиграем.
Вот.
Ну, теперь идея такая.
Если он пошел в В плюс Н, то у нас есть, как минимум, замечательный ход.
В плюс Н.
Да. В плюс Н.
То есть, получается, сохранить опять же статус ЧО.
То есть, опять первому игроку подсунуть позицию В плюс Н.
Из В плюс В мы переходим в В плюс В вообще?
Ну, нет. А мы уже никуда не переходим.
Мы уже пишем, что мы выиграли.
Да, так что можно даже...
Так что, как это называется, да, можно не...
Выводим задачу предыдущей.
Да. То есть, да, даже более...
Ну, да.
Да, выливаем воду из чайника и говорим, что...
И даже не вспоминаем о том, что надо ее налить заново.
Да.
Так. Значит, а тут теперь заметим, что из П плюс Н мы тоже всегда можем пойти в П плюс Н.
То есть, получается, что мы, как второй игрок, всегда можем первому игроку либо подсунуть В плюс Н,
либо...
Ну, вот.
То есть, либо пойти в П плюс Н, либо гарантировать себе выигрыш с помощью П плюс В.
Что?
То есть, получается, что второй игрок не проигрывает.
Но, правда, теперь осталось только доказать, что первый игрок не проигрывает.
А как доказать, что первый игрок не проигрывает?
Он может просто в ничей не передать ход.
Ну, не передать ход, конечно.
Это не тот же П плюс Н, который вот здесь.
Но с нашей точки зрения, без разницы.
Но по смыслу, да.
Первый игрок просто говорит, я сделаю ход в позицию П плюс Н, и все.
И теперь он будет гарантировать себе не проигрыш, как второй игрок.
Так что, видимо, типичная ничейная игра, скорее всего, будет вот болтаться где-то здесь.
Сейчас. То есть, проигрыш на игра нам ничего не меняем.
Получается так.
И, в принципе, отсюда на самом деле возникает мистическая теорема.
Просто можно назвать ее теорема имени Льва Толстого.
Теорема называется все проигрышные игры эквивалентны.
Ну, потому что мы, по сути, вот что тут доказали.
Мы доказали, что, допустим, если, допустим, А1 и А2 проигрышные,
то оказывается, что дело в том, что АВИО от А1 плюс С равно тупо ВИО от С.
И это равно ВИО от А2 плюс С.
Вот.
Так что получается, да.
Так что вот такая мистическая теорема.
Ну а теперь попробуем все-таки этот анализ подобивать.
Вот, например.
А если я вам предложу, например, А1 и А2 проигрышные игры эквивалентны,
подобивать.
Вот, например.
А если я вам предложу поиграть в выигрыш плюс выигрыш.
Что получится?
Так вот. Ну давайте.
Но это тоже надо доказать.
Это возможный ответ, но это надо доказать.
Привести примеры на что угодно.
Так.
Ну давайте попробуем привести пример на что угодно.
Ну вот, например, можно ли из суммы двух выигрышных игр получить проигрышную игру?
Ну да.
Ну просто две спички.
Ну да. Самое тупое, что можно сделать, это, конечно, две вот такие игры.
Хотя, на самом деле, любые, если вы сложите...
Ну, в принципе, вообще можно заметить, что А плюс А, если игра А циклическая,
то эта игра заведомо проигрышная.
Потому что у второго игрока есть так называемая симметричная стратегия.
То есть, просто тупо дублируем в другой игре ход первого игрока.
Так как игра...
То есть, заметим, правда, тут вот важный момент.
Видите, что это работает именно потому, что игра ациклическая.
То есть, ход. То есть, игра рано или поздно закончится независимо.
Вот.
То есть, в принципе, в общем случае можно пока гарантировать только что...
Что эта игра не выигрышная.
Что игра с собой точно не выигрышная.
Да, точно не выигрышная, да.
Но, как бы это, то есть, как бы да.
То есть, потому что у второго играя есть непроигрышная стратегия.
Может, у него есть выигрышная стратегия.
Может и нет, я не знаю.
Вот.
Хотя, может, мы с вами сейчас это узнаем.
Всякое может быть.
Хотя...
Так, ну хорошо.
Выигрыш плюс выигрыш.
Хорошо.
Значит, бывает проигрышем.
А бывает ли выигрыш плюс выигрыш выигрышем?
Да.
Каким образом?
Ну давайте вот к этой штуке прорисуем еще...
Вот, к одной из этих спичек прорисуем еще такую цепочку из двух.
Вот.
От нее ответ будет.
Вот.
А, вот такой.
Ну или так, да.
Ну так проще, пожалуй, будет.
Да.
Ну это тоже две выигрышные игры.
Но их сумма тоже выигрышная.
Потому что первый игрок может вместо того, чтобы пойти сюда, аккуратненько пойти сюда и получить предыдущую.
А бывает ли ничья?
Save plus...
Save plus игра, где палочки?
Так.
Ну в принципе, да.
А можно просто вот так две палочки.
А можно, кстати, save plus save.
Кстати, к вопросу о двух...
Хотя нет, это две выигрышные игры.
Ну ладно.
Но тут заметим следующее, что каждый игрок знает, что если я закончу одну игру, второй игрок тут же закончит вторую игру и выиграет.
Поэтому все, что вам остается, это сейвится.
Но здесь, да, заметим, достаточно одного сейва.
То есть в принципе вот...
Это две игры.
Сейв у нас может быть еще что?
Когда вот эта вершина, из которой есть ход в себя.
Там становится красиво, что три сейва, это уже кажется...
А нет, это все еще ничья.
Да.
Нет, в чем проблема?
Вы хотите запрятать последнего.
Ну да.
Они будут уменьшать сейв, а потом придут в состояние два сейва.
Ну да.
И там будет ничья.
Почему сейв выигрыш?
Нет, потому что если вы рассматриваете сейв без суммы из чего-то, просто саму по себе игру сейв, то как бы первый игрок просто ходит сюда и выигрывает.
Да, это да.
И ретроанализ это неожиданно найдет.
Ну потому что...
То есть такую вершину он конечно...
Да, вообще приятно, что если из вершины есть ход в себя, то тогда эта вершина заведомо не является...
Чем она не является?
Она не является проигрышной.
Почему?
Ну потому что предположим, что у второго игрока в этой игре есть выигрышная стратегия.
Тогда у первого игрока есть выигрышная стратегия, вида пойди в себя и выиграй.
Противоречие.
Вот, да.
То есть получается, да, вот такого...
То есть если из игры есть ход в себя, то значит вы заведомо не проиграли.
Но вы вот в такой ситуации теперь могли выиграть.
Так, ну вывод очень простой.
Значит В плюс В оказывается может быть чем угодно.
То есть потому что В плюс В бывает нечейной, В плюс В бывает проигрышной и В плюс Э бывает выигрышной.
То есть оказывается, если вы складываете две выигрышные игры, может быть все что угодно.
Так, что еще надо?
Так, а теперь давайте подумаем.
А если я вас попрошу сложить выигрышную игру и нечейную игру, что получится?
Похоже, что нечейная.
Так, ну она не может...
В плане давайте второй игрок вообще забьет на первую игру, которая выигрышная, и будет просто ходить в нечейную.
Так.
Ну противник ему в какой-то момент подсунет проигрышное В плюс В, например.
А, и вас проигрывает.
Ну, да.
Давайте отвечать в той же игре, в которой и походил первый игрок.
А, мы сюда можем�изить.
Ну смотрите, есть подозрение, что выигрышная эта игра точно может быть, потому что наверное там...
Ну что это может быть, действительно?
Ну то есть выигрышная эта игра может быть.
Ну что это может быть действительно?
Смотрите, у нас есть состояние V плюс N.
Давайте сделаем перейдем из него в состояние P плюс N.
Второе либо у нас переводит P плюс V.
Нет, то смотрите.
А, сейчас, ну, погодите.
Начнем с первого.
Заметим, что первый игрок может пойти в P плюс N
В плюс N и гарантировать себе тем самым не проигрыш.
Да?
То есть, проигрышная эта игра точно не является.
Теперь она может являться ничейной и выигрышной.
Так, ну, опять так, ничейная она может являться?
Ну, конечно, да, потому что есть луп.
Сложи что угодно с лупом и получи бесконечную ничью.
Остается только выяснить, может ли V плюс N быть выигрышной игрой?
Ну, сейчас кажется, что если мы из V плюс N входим в P плюс N.
Да, но это нет.
Тем самым мы только гарантируем, что игра для первого игрока непроигрышная.
А какие вообще возможны ходы первого игрока из V плюс N?
Он может проходить в P плюс N?
Ну, во-первых, он может проходить и в V плюс N.
Ну, там, как повезет, он куда угодно может пойти.
Потому что из V можно пойти теоретически вообще куда угодно.
Давайте рассмотрим проигрышный сейв, то есть когда у нас две...
Так, вот, давайте посмотрим.
К нему прибавим...
Да, смотрите, вот такая, давайте вот такой сейв сделаем.
И вот такую выигрышную игру.
Да, и первый игрок первым ходом сходит вниз и сделает...
Да, то есть, видите, заметим, что эта игра откровенно ничейная.
Да, сама по себе, потому что никакому игроку не выгодно ходить сюда и проигрывать.
Но если вы складываете вот тут, то тогда первый игрок может просто выйти отсюда
и пойти также в игру V плюс V.
Видите, да?
В чем V плюс V ациклическую и симметрично выиграем.
То есть две спички, как мы еще называли.
Поэтому получается, что выигрышность тут бывает.
Вот, выигрышность бывает, ничейность бывает, проигрышности не бывает.
Так, ну и немножко эпичности.
А ничья плюс ничья это что?
Это мясо.
Да, это точно может быть ничья.
Потому что есть лупки.
Да, просто два лупа.
Да, два лупа хлопающих глазами, да.
Так, хорошо. А что-нибудь еще это может быть?
Да, может ли быть это что, кроме ничьи?
Наверное, нет.
Почему?
Ну, какие у нас возможные ходы?
Если мы сходим в П, то в П мы не можем сходить.
Нет, из ничьи можем, да.
Из каждой ничьи можем ходить только либо в ничью, либо если повезет в В.
Если мы сходим в ничью, то мы как бы прижили то же самое.
Если мы из Н сходили в В, то там может быть либо В или ВН.
Короче говоря, проигрышной игрой для противника это не стало.
Да.
То есть заметим, что мы можем пойти либо в Н плюс Н, либо в заведомо непроигрышную игру.
Вот.
Тогда у второго игрока есть, получается, непроигрышная стратегия вида,
если первый игрок пошел в В плюс Н
то второй игрок точно не проиграл, мы это уже доказали.
А если первый игрок пошел в Н плюс Н,
то мы тоже оставили ему Н плюс Н.
То есть таким образом второй игрок не проиграл.
Ну, а первый не проиграл потому, что он тоже может оставить Н плюс Н.
То есть вывод — сумма двух ничейных игр — это ничья.
Это ничья.
А мы сейчас рассматриваем игры, только такие, у которых поражение равно нельзя расходить, да?
Да, конечно.
Да.
Вот из V плюс N мы можем перейти в P плюс N, в V плюс V и V плюс N, да?
Откуда? Из N плюс N?
Из V плюс N.
Потому что если мы перейдем в P плюс N, то у второго игрока будут непроигрышные стратегии.
Если мы перейдем в V плюс V, то у второго игрока тоже не будет непроигрышной стратегии.
так и проигрышной игрой. И мы даже примеры привели, так что тут такое. Вот, так что мы
тут немножко поигрались, тут видим, что, к сожалению, да, если одна игра проигрышная, то нам повезло ее
можно вытянуть из анализа. Причем везде, скорее всего, но там, да, конечно, надо будет аккуратно
думать, но факт остается фактом, да, проигрышность плюс, да, то есть там с проигрышной игрой надо
как-то аккуратно думать, но правда, как складывать три игры, это нам все еще пока не сообщает.
Потому что, видите, если у нас действительно есть хотя бы там, то есть если там какие-нибудь две,
то есть, да, если там есть проигрышная игра, то ее из анализа можно выкинуть, но если есть там две
выигрышные или там выигрышная плюс ничейная, то у нас просто так, конечно, все плохо. Так что,
знаете, то есть получается так, то есть как бы Толстой был, наверное, сказал так, все, да,
все проигрышные игры, проигрышная одинаково, но каждая выигрышная игра выигрышна по-своему.
Вот, как говорится, да, где-то через два тома одна накоренина бросилась под поезд.
Да, соответственно, вот. Ну вот, соответственно, значит, что у нас получается? Ну, здесь вот дальше
будем рассматривать сначала ациклические игры. Так, вот дальше я перестаю помнить номерацию
теориям, но неважно. Ну, теперь давайте себе вообразим, что мы рассматриваем только ациклические
игры. Тогда, конечно, вот эти все ничейности мы сразу выкидываем. Понимаете, да? Вот, то есть
остается только вот P плюс P, P плюс V и V плюс V, но V плюс V может быть даже на уровне ациклических
игр, как мы уже убедились, чем угодно, правда? Вот. Ну, правда, да, есть бывает ациклические
игры. Ну вот, но на самом деле есть такая, сейчас вот я расскажу, просто пришло время еще одной
интеллектуальной игры. Вот. Значит, интеллектуальная игра NIM. Значит, игра такая. Жила-была N, значит,
кучка, а в кучке N камешков. Внезапно. Играют два игрока. На каждом ходу игрок может из этой кучки
взять произвольное ненулевое количество камней. Все. Ну, проигрывает тот, кто не может сделать ход.
Вот такая интеллектуальная игра. Да, вы услышали то, что вы услышали. Да, верно. Вряд ли по ней будут
проводить чемпионаты мира. Ну, кстати, NIM с несколькими кучками давали на межнаре по математике
90-го года. Кстати, никто не решил. Хотя теория, которую сейчас рассказываю, была известна еще в 30-е. Ну,
вот это, ну, возможно. Не, ну, как сказать вообще, теория подобных игр, как бы это, мы почти сейчас
математикой загибаемся, в общем-то. Выигрышное, проигрышное, вот это все. Так что это, конечно,
немножко. Хотя там всякое бывает. Может, там в 90-е годы не было распространено спортивное
программирование. Там когда-то в 2007. Ну, по-разному. Не, ну, в 90-е, хотя нет, в 90-е, в общем-то,
чемпионаты ACPC, как бы ACPC, вообще-то, империоз свое начало с 1977 года. Да, и в то время там участвуют
что-то типа три американских ВУЗа. Ну да. Ну, не три, там больше. Там уже, по-моему, начали выигрывать,
по-моему, ВУЗы из Европы вообще-то к тому моменту. Можете гуглануть, проверить. Там более,
там уже достаточно быстро потом где-то там начали проявляться, там, собственно, наши. Там,
в первую очередь, это там ИТМО, там МГУшники, там и так далее. Так что там, так что дело старше,
чем вы думаете, да. На самом деле, даже сейчас ретроанализ, это прям такой почмочный чит на
каком-нибудь геоне по математике или даже на все России. Потому что иногда там просто появляются
задачи, которые задумываются гробом, а при этом пробиваются вот так лапками. Да, но не только. Я
вам даже больше скажу. Я видел видео, когда рассказывают, что там на Межнаре дали крутить
задачи по геометрии. Не-не-не, там 90-е годы, это был первый год, когда американцев победили в Австралии.
Понятно. Ладно, все окей, хорошо. Ну да-да-да, а потом фриками появились мы, да. Да,
по-моему, там в 2000 году фриком оказались, там был Дуров и Лопатин, да-да-да. Ну и так далее.
Ну, в общем, ладно, там, конечно, мода была такая, что там на тех фотографиях как-то,
во-первых, все выглядят фриками, честно говоря. Вот. Ну ладно. Ну вот, нет, а на самом деле,
если говорить про задачи, то да, это, конечно, там, я помню, там было какое-то видео где-то,
вот там какая-то задача по математике. Я, к сожалению, все время запамятую, что это за задача. Там
что-то была, то есть была какая-то задача, что там есть какая-то точка, то есть там N точек,
там никакие, там три не лежат на одной прямой. Вокруг одной вершинки, по-моему, там вращается
какая-то прямая, в какой-то момент она перекидывается. Взятка проводится прямая, и типа она вращается,
как только она касается новой вершин и новые точки, она начинает уже относительно ее вращаться.
А, и что там надо было доказать? Доказать, что она вернется в исходное положение. А, ну да.
Ну, значит, нет-нет-нет, смотрите еще раз. Ладно, раз об этом зашло есть. Представьте,
на плоскости доноем точек. Две, значит, никакие три не лежат на одной прямой. Значит, вокруг одной
точкой вращается прямая, но там дается какая-то точка, дается какая-то прямая. Она вращается там,
скажем, против часовой стрелки. Если она натыкается на другую прямую с этой или с этой стороны,
то дальше она вращается уже вокруг нее. Докажите, что прямая вернется в исходное положение.
Нет, вокруг выпукла оболочка, если бы у тебя исходная прямая была бы вокруг выпукла оболочка,
а так, в принципе, если у тебя там... Видимо, там все-таки более интересные условия,
что там может быть... Короче, что изначально прямая и не бывая. Да, любая, любая. Нет,
там просто да. Нет, я помню, меня позабавил, что задача подавалась как, что эту задачу на полный
балл решил только один человек, и тот абсолютный чемпион этого междара, который решил вообще все на
полный балл. Просто единственный тотал. И при этом, конечно, задача простая, но, не знаю, окажется,
любой спортивный программист в адекватном уровне решит ее минут за 15. Ну, можете попробовать,
я не знаю, потом мы можем там обсудить, но, на самом деле, полностью, просто вот, просто задать,
просто знакомый с концепцией, вращающейся с конлайн, там, скажем, там, который просто имеет
опыт решения задач на вращающейся с конлайн, скорее всего, решит ее быстро. Да, вот тоже,
вот преимущество, когда программисты неожиданно начинают диктовать математикам свои условия, да.
Вот. Ладно. Во-во-во. Именно. Так. Именно. И заметим, что, и заметим, что эти количества
постоянно сохраняются, да. Вот. Вот. Так вот. Ладно. Вернемся к интеллектуальной игре ним. Так, раз
она интеллектуальная, расскажите мне, пожалуйста, а кто в ней выигрывает вообще или проигрывает?
Да, вот это важно, кто-то все говорят, да, конечно, эта игра выигрышная, но это неправда. Она выигрышная,
только СН больше нуля. А если Н равно нулю, то это игра проигрышная, и это важно. То есть,
тут игра проигрышная, это выигрышная. То есть, видите, уже на этом уровне есть принципиальная
разница. Да, такая игра называется звездочка Н. И, в принципе, теорему два, на самом деле,
можно переформулировать как все проигрышные игры эквивалентные звездочка ноль. То есть,
звездочка ноль это такая абсолютно проигрышная игра. То есть, она это просто такая игра,
в которой нельзя сделать ход. Вот. Мы могли просто нарисовать игру на вершины и нуля играть? Ну,
могли, да. Но мы ее будем просто называть звездочка ноль, потому что по факту это она есть. Так вот. Идем
дальше. Ну, вот. Так вот. Ну, теперь вот возникает следующий уровень. Да, мы научились понимать про
игры там, что они там выигрышные и проигрышные, если не суммировать. Но теперь хочется подумать.
Ну, это бывают же, наверное, игры эквивалентные нимом, правда? Наверное, бывают. Но нет,
но начнем вот с чего. Так. Ну, начнем с маленькой технической теоремы, которая нам поможет. Теорема
три. Значит, игра A эквивалентна нему языка мне. Тогда и только тогда, когда игра A плюс звездочка
и проигрышная. То есть вот такой неожиданный критерий, что игра эквивалентна нему какому-то
тогда и только тогда, когда в сумме с ним она проигрышная. Вот. Понятно, да? Вот. Значит,
соответственно. Как же это нам доказать? Ну, на самом деле, как ни странно, сейчас,
по-моему, впервые в жизни мы не будем пользоваться каким-то там, типа найдем какие-нибудь стратегии.
Потому что, смотрите, доказательство в эту сторону будет звучать так. A эквивалентна звездочка
и, то есть, из этого следует, что A плюс звездочка i эквивалентна звездочка i плюс звездочка i. Логично,
да? Ну, потому, что A эквивалентна звездочка i, а звездочка i эквивалентна звездочка i. По
теориям и один, это эквивалентна этому. Но эта игра проигрышная, потому что она ациклическая
симметрично логично да все значит в эту сторону доказали теперь докажем в
обратную сторону то есть если у нас а плюс звездочка и проигрышная то есть
эквивалентно нулю да потерями 2 это одно это уже да то из этого следует что
даже не так я сделаю смотрите по-другому звездочка 0 эквивалентно а плюс звездочка и
значит из этого следует что звездочка и эквивалентно такой игре как а плюс
звездочка и плюс звездочка и логично да а это но заметим что это эквивалентно ну
так как звездочка и плюс звездочка и эквивалентно нулю да то это эквивалент на
игре а плюс звездочка 0 вот равно а все
взять вот да немножко вот меня вот всегда радует это доказательство потому
что оно выглядит как вот просто мы тут что-то то есть как не такая некоторая
магия просто а где мы во первых где мы этим пользовались нет я написал что
звездочка 0 эквалентна плюс звездочки то есть мы предполагаем что плюс звездочка и
проигрышное да но это по теореме 2 все проигрышные игры эквивалентную нулю вот а понял да тут
конечно по-хорошему написать что 0 плюс звездочка и но заметим что звездочка и
эквивалентно звездочка 0 плюс звездочки и ну потому что очевидно от того что вы
уберете суммы игру в которой нет ходов ничего не поменяется вот так что вот немножко так что
получилось вот такая вот немножко магии вот ну кстати приятно да что у нас кстати в играх
появился 0 то есть получается там так по-моему чем чем можно называть получается множество
чем там обелевым кольцам обеля а обелевым маной нам да чего поэтому маной это не группа
нет ну я вот как раз вот запамятовал что там что там маной что там группа там вот это
не важно вот этот ну смотрите звездочка 0 эквалентно плюс звездочка и по теореме 2
да следовательно давайте к обеим частям этого что прибавим по эквивалентной игре то есть
просто по звездочке и получилось вот это да но это эквивалентно и просто по сути
вот а эта штука заметим что в ней вот игра звездочка и плюс звездочка и вот это вот
может быть заменена на звездочка 0 как эквивалентно
да так но ну почему потому что звездочка и плюс звездочка и это симметричная циклическая
но пойти у нас была первая теория ма да о том что если а 1 эквивалентно б1 а 2 эквалентно
б2 то один плюс а 2 эквалентно б1 плюс б2 вот мы ровно этим здесь и занимаемся то есть просто
когда мы прибавляем и при этом еще и одинаковые игры вообще который уж точно то есть каждый
град друг другу эквивалентно да на всякий случай дает эквивалентность это реально отношение
эквивалентности да потому что там да рефлексивность симметричность транзитивность
ну тут думаю очевидно вот так вот значит у нас появился вот такой приятный критерий и мы им
будем пользоваться пользоваться будем следующим образом совершенно мистическим да если вы
случайно ну если вы конечно не знаете теорию который я сейчас рассказываю ну на уровне
результатов конечно это результаты конечно общие известные могут быть ну-ка так ну-ка давайте
рассказ так а ну-ка расскажите кстати кто вообще знает о чем вы тут вообще говорим и каким
результатом мы придем ну типа того ну и вопрос как вы вычислять еще кто знает словосочетание
функция шпрага гранди давайте так так ну вот но сейчас мы ее а кто умеет ее доказывать
ну ладно не будем тогда палить интригу но значит мы потому что это все равно это все
аккуратненько с нуля выводим так что все нормально и так тирема 4 говорим мы вот значит говорим
предположим что у нас есть интеллектуальная игра а и из нее и нам известны все ходы эти
ходы ведут в игры а 1 а 2 там а 3 и так далее а к ну понятно что ну я думаю понять понятие
игра идет в игру понятно да теперь вот а 1 а 2 и так далее а к и нам известно что а 1 эквивалентно
не муис и 1 камней а 2 эквивалентно не муис 2 к из двух камней тут и 3 и так далее тут эквивалентно
не муис и как вот эти ишки нам известны вот понятно да тогда я утверждаю что из этого следует
что а тоже эквивалентно не му из и камней где и равно чему
ну да ну ладно вот да вот за да вот особенно весело да пытаться угадать конечно в аудитории
которые не знают заранее ответа да причем знаете даже правда даже интересно попытаться вообще
вывести но вот то есть а действительно что это за и вообще давайте думать что это за
и должно быть то есть это должна то есть как мы будем доказывать те рему вне зависимости от
того что тут написано да то есть мы будем доказывать мы попытаемся доказать что
а плюс и звездочка и проигрышная игра правда но тогда значит тогда мы перебираем ходы какие
ходы есть есть ходы либо в звездочка и житое какой-нибудь плюс звездочка и и
эта игра должна быть выигрышная да а теперь давайте себе представим вот
кстати простой вопрос вот это игра когда это игра выигрышная когда проигрышная
вот кстати вот сумма двух нимов она когда выигрышная когда проигрышно но да
но если они равны то проигрышная мы уже выяснили по симметричной стратегии а
если не равны то как бы она выигрышная потому что первый игрок быстро сводит
ее к симметричной игре то есть поэтому если мы хотим чтобы это было в то
значит нужно чтобы и жи не было равно и понятно да то есть для любого жи верно
что и житое не равно но первый игрок может пойти в игру а плюс звездочка и
штрих и штрих меньше чем и причем любое да но тогда но вот и тогда наверное у
второго игрок второго игрока должен быть выигрышный ход правда но чтобы чтобы
он железно был наверное желательно чтобы он был в апп потому что а плюс
что-то там не понятно пока что да но вот поэтому желательно чтобы то есть
наверное желательно чтобы для любого из штрих меньше и было что там звездочка что там
звездочка и штрих лежит вот в этом множестве там и 1 там и 2 и так далее то есть тогда
получается что как бы мы докажем теоремы если окажется что и в этом множестве не
лежит а все меньшие числа в этом множестве есть логично да то есть просто вот у нас
доказательства и нарисовалось само и мы автоматически вводим что и равно действительно
мекс от вот этого и 1 и 2 и так далее и к это называется минимума почему мекс потому что
минимум исключить то есть то есть это как бы то есть и то есть нам дается множество
из целых не отрицательных чисел мекс таких это минимальное целое не отрицательное число
которого нет в этом множестве ну кстати это может быть и мульти множество не сломается
рассуждение о том что произвольная игра плюс произвольная игра проигрышная это верно только
то есть это сработает то вот вот это рассуждение сработает ток вот на халяву только если игра
циклическая но если ациклические но я вам даже больше скажу если мы сейчас докажем эту теорию
мы просто убедимся что любая ациклическая игра эквивалентной не мы можем сказать просто
ну для ну ну хорошо а для удобства видимо для удобства записи нет хорошо можно сказать что
если бы ациклическая то да пусть бы ациклическая тогда эквалентно б это дает то есть тогда
эквалентно б тогда и только тогда когда плюс б эквалентно там проигрышная абсолютно нет
а вообще произвольная хоть циклическая хоть чего но циклическая игра иногда тоже бывает
эквалентной нет хотя нет не факт да то есть там мы просто применили теорию внутри доказали
что если и взять вот таким то у второго игрока реальность выигрышная стратегия ну потому что
либо первый игрок пойдет в какой-то ним вот из этих и тогда это два неравных ним игра выигрышная
либо он уменьшит и но следующим ходом мы просто из а пойдем соответствующий ним потому что все
меньшие у нас представлены и перенот и первый игрок получается попал в проигрышное положение все
так что вот такой вот неожиданный мерз то есть обратите внимание да то есть в принципе то есть
отсюда на самом деле прямое следствие то есть любая то есть любая а циклическая игра
эквивалентно какому-то нему из каких-то н камней
вот почему ну просто мы берем просто то есть как-то доказать мы берем просто этот ациклический
граф и в порядке то но ты в порядке топологической сортировки для каждой вершины тупо вычисляем
мекс из всех гимберов которые мы уже нашли в чем заметим что самое приятное мы это можем сделать
конструктивно за суммарное время от в плюсе но маленький приятный факт если вам данный к чисел
то вы мекс таких можете легко найти за отка плюс один вот догадываетесь каким образом каким
ну да то есть заметим просто сдадим массивчик от нуля до к и будем помечать какие числа есть
если какое число больше ка значит игнорируем тогда после этого прибегаемся от нуля до ка и
находим первое не помеченное а такое найдется потому что от нуля до ка у нас ка плюс одно
число все тогда получается что каждое следующее число кажется но вот мы найдем через предыдущих
за от количества ребер из него плюс один получается в плюсе да это число называется
нимбер но точнее так то есть для вот ациклической игры а тот по-разному в математике это называется
либо сг от а почему сг потому что функция шпара гранди или шпара грюнди там я не знаю вот вот так
но в каком-то разборе какой-то задачи на самом деле я вот это число на самом деле видел что не
сг я видел что оно называется нимбер ну да да на самом деле да поэтому дайте поэтому я
тоже меня видимо постоянно будет проскальзывать слово нимбер вот то есть заметим теперь что если
у нас есть ациклическая игра то для каждой ее вершины я могу легко найти нимбер причем за
7 точку в плюсе но вот более того теперь сложить две игры для меня теперь расплюнуть потому что
я просто вычитаю нимбер одной нимбер второй если они равны то игра проигрышная если они
не равны то игра выигрышная логично да но на межнаре 90 года подсунули конечно более сложную игру
а если вам складывают три или четыре или да причем там на самом деле даже не ну там не было
там просто сказали что вас нимбер на к камнях ну короче ним на к камешках то есть как бы просто
данный к камешках в них какие-то количества там в них количество кучка количество камней равно а1
а2 и тарталия а к вот за один ход вы имеете право брать произвольное не нулевое количество камней
но только из одной кучки на ваш выбор какой проигрывает тот кто не сможет взять ничего кто
выиграет при правильной игре да вот такую задачу там походу никто не решил я не знаю там
насколько математики насколько математик и старт кредит сейчас понятием к сор ой спали
ой спалил ответ да но в причем да тут ну хотя ладно тут это в этой теме понятно что про мексик
сор знают все вот как он доказывается не факт но да а ну по сути но давайте это уже тогда добьем
потому что по сути чтоб складывать произвольное количество циклических игр на самом деле нам
осталось только одно доказать то есть нам по сути теперь надо то есть мы теперь то есть там по
сути теперь надо доказать то есть сериям опять да что звездочка и плюс звездочка g эквивалентно
звездочка от и к сор же просто тот самый наш любимый побитый двоичный к сор все то есть в общем-то
на этом теория о циклических суммы о циклических игры заканчивается но как же доказать ну доказать
но я бы даже так я бы избавился от этого сора я бы доказал так ну то есть на самом деле надо
доказать следующее но стой ну с точки зрения теории мы да то есть надо доказать что эквивалентно того
что звездочки но вот то есть вот это утверждение теория оно эквивалентно тому что звездочка и
плюс звездочка g плюс звездочка и к соржи это проигрышная игра понятно да значит ну значит ну
аккуратную схему доказательства я предложу такое я скажу так мы докажем так значит утверждение
звездочка и плюс звездочка и g плюс звездочка к значит выигрышно если и к соржи к сорка не
равно нулю и проигрышна иначе вот по сути по какой схеме это можно доказывать доказывать будем
по индукции доказательства по индукции по и плюс g плюс к на этот раз прям реально сумма целых
не отрицательных чисел но вот ну база понятно да и равно g равно к нулю сумма трех нулей по любому
0 понятно да но теперь дальше заметим что ну там переход говорит так вот у нас и жк и ход есть но
тогда если и к соржи к сорка равно нулю то заметим что как бы мы не походили то к сор перестанет
быть равно нулю и мы тем самым сводимся уже к дако дако по предположению индукции выигрышной
игре правда остается доказать только одно по сути что если и к соржи к сорка не равно нулю то
существует ход по которому и к соржи к сорка будет станет равен нулю то есть вот все что осталось
доказать то есть такой математический факт если и к соржи к сорка не равно нулю то одной из этих
чисел можно уменьшить так чтоб к сор стал равен нулю вот понятной идеи ну как оказывается ну как
говорится вспомним фенвичка ну вот и сделаем примерно тоже самое а именно ну то есть вспомним
так как мы рисовали а мы рисуем это примерно это же рисуем и жк да идем слева направо из
бесконечности видим нули нули нули нули нули нули нули нули нули нули нули в какой-то момент
стали появляться единицы но сначала эти единицы ходят парами вот а иногда там 0 0 там вот что-то
такое но мы знаем что но вот но мы знаем что к сор он нулю не равен да вот эти все штуки
делают его 0 0 0 0 0 0 0 и тут опа в какой-то момент неожиданно оказалось один что это значит это
значит что хотя бы одной из этих чисел неожиданно стало то есть стало единицей и более того тут как бы
либо три кола либо ровно один кол мы их нечетное количество понимаете да ну пусть без ограничения
общности это оказалось числе к единицы оказалось значит тогда идея такая но тогда что-то у нас
происходит тут какие-то рандомы расположены 0 0 там 0 там 1 0 0 там 1 1 0 или там 0 1 0 0 1 1 да тут
можно было видимо все ой они все ли этот способ выписал так что я там еще не выписал а 0 0 1 я не
выписал но дальше подгон делаем такой то есть смотрим где тут то есть смотрим так во-первых
говорим что в этом месте у ка будет не единица а 0 и тогда тут вместо единиц к сор будет 0 а дальше
заметим что так как мы уменьшили этот бит то мы им право с имеем право с остальными битами это
числа к делать абсолютно что угодно правда и число ка все равно станет останется меньше чем
было изначально так давайте теперь биты просто подгонять так чтобы получался 0 то есть вот
смотрите тут вот к сора получается вот такие вот как-то так да ну и тогда идея такая где я к сор
0 не трогаем а где к сор 1 значит меняем бит да иногда приходится это делать заменяя не
только единичку на 0 но и 0 на единичку вот то есть вот так и вот только 0 тут 0 вот собственно и
все то есть реально в реальном коде конечно это делать не надо потому что в реальном коде вы
просто переберете что давайте попробуем заменить ка на х соржи если х соржи меньше ка значит у нас
получилось если нет перебираем другие варианты но вот но вот такого математическое заказательство
того что один из вариантов точно сработает вот видите в общем-то оказалось даже не сильно
сложно нет это это доказательство того что вы его найдете то есть вы можете так это и в коде
написать конечно не зачем вот тот я говорю не зачем потому что реально вы просто как бы просто
перебираете что вас вам надо либо ка сделать х соржи либо джи сделать х сорка либо и сделать
джи сорка сорка поэтому тупо перебираете все варианты как бы утверждение если они к сор не равен
нулю то один из этих вариантов вас устроит хотя бы один вот то есть в принципе ну заметим так
ну заметим что если в этом вот максимальном столбце одна единичка то вас устроит только один
вариант если тут было три единички то вас устроил походу устроили бы все варианты вот понятно вот
на эту тему тут конечно очень интересно вот ну и тогда получается что значит сумма и плюс ж
эквивалентно к сору но и получается что если вы складываете даже не две игры а 3 4 5 6 то получается
вам просто нужно найти нимберы и их просурить да то есть не знаю там сложно было наверное да вот
намежная видимо никто не смог додуматься что ответ на задачу если побитого и двоичное какое-то
там или там один плюс о два чего да это был мечтар по математике реально
ну а нет а кто сказал что она не оно намежная я не ну не знаю ну опять там вот но да
но я я не знаю либо я что-то перепутал в байке либо скажет что скорее всего это
просто была видимо не самое видимо была не сильно из не не сильно известная теория в
математической среде вот ну мало ли там всякая программирование тоже не все знают как там
за линейное время у строки найти меня там минимальный этик графический суффикс да такой
алгоритм есть и без хэшей вот вот только вот но вот то есть ну просто на практике он может
просто не особо пока нужен на самом деле потому что но вот вот подвеска просто вот не знали а
тут вот с этой точки зрения классно потому что дали новую задачу то есть задачу на вот
принципиально там то есть другое место то есть эти эти там ваши там какие-то глобальные понятия
какой-то непрерывности там по производной там и прочим там чем-то там черти чем еще я там ну я
мало занимался на математике не знаю вот то есть и вот звать это вылезал в трубу что дали что-то
принципиально новое вот но вот почему-то никто не решил хотя конечно действительно странно
потому что теория вроде как тридцатого то есть там шпрагранде вроде это все в тридцатых годах
писали ну или в другом виде это писали но возможно это как была какая-то относительно
ой ну хотя философский опрос потому что тут как бы надо говорить еще
потому что как бы есть на самом деле по теории есть такая классическая книга такого автора как
конвей там так и называется combinatorial game theory про что но не помню да как
честно честно скажу я ее так это подробно не читал ну не ну я ну сакша могли рассказывать
конечно да пошеда так а да чего доказать то киур мы хотели доказать что а при зелочке
ну точнее нет мы должны найти такой и что да но мы это но но но левого слова я понял там
а правая не но мы не вывели но мы сказали что то есть ну наша задача не вывести наша
задача как бы замкнуть доказательства то есть мы замкнем доказательства если для любого
и штрих меньше и выяснито что плюс звездочка и это выигрышная игра вот как нам это вывести так
ну наверное если все и штрихи меньше и будут присутствовать вот в этом списке а куда мы
можем пойти то тогда мы победили и получается что доказательства зайдет если и само в этом
списке не будет но все меньшие числа в этом списке будут но вот так появился мекс то есть
получается мы просто берем минимальное число число которое в этом списке не представлено все
так что такая вот не как это не не сильно сложная логика
вот так что да но там конечно разная подлянка знаете последнее наверное что мы сегодня
расскажем если нас еще не выгоняют это называется но там есть еще пара смешных
такая смешная га называется ним поддавки вот представьте себе вы играете в ним на
большом количестве кучек но при этом если вы делаете если вы не можете сделать ход вы выигрываете
почему нет на самом деле не мерзость хотя нет нет на самом деле не мерзость и знаете то есть
на самом деле думаю в следующий раз мы начали давайте нет все таки мы сейчас остановимся но я
сейчас сформулирую две задачи с разбора которых мы начнем следующую лекцию можете ради интереса
попробовать их решить но если вы не знаете их конечно то есть первая задача ним поддавки да то
есть допустим у вас есть n кучек в которой есть там а в первой кучке один камней во второе 2 в 3
а 3 и так далее там да там да и вот вы имеете право на каждом ходу делать брать произвольное
количество камешков но только из одной кучки произвольное не нулевое но если как бы камешка
в кучках вообще нигде не осталось то вы победили то есть наоборот то есть у нас как бы наоборот
получается да то есть раньше бы сказали что если во всех камешках 0 том и проиграли теперь бы
победили то есть условно тот самый забравший последний камешек про наоборот проигрывает
спрашивается вот тоже надо определить математически кто выиграет при правильной
игре вот и вторая ика тоже такая очень смешная игра но в ней как бы помимо теории придется
что-то думать называется знаменитый хакен буш да я честно говоря много лет думал что хакен буш
это фамилия нет а пока обычный ну да честно скажу я пока даже не пытался это рассказывать
вот хотя наверно когда-нибудь надо вот ну по чем посмотрим может так вот доходу от я думал
что хакен буш это фамилия но на самом деле хакен буш это просто такие английские слова
hacking bushes подрезание кус да но задача действительно такая у вас есть подвешенное
дерево вот жестко подвешенное за корень но это мы конечно но это мы себе воображаем что у нас
дерево такое сверху вниз растет так вот на каждом шаге вы имеете право удалить
ребро и все висящие на нем под дерево просто вот обрезать проигрывает тот кто не может
сделать ход время пошло что-что нет ну вот очевидно циклическая да очень хоть да естественно
хочется да явно хочется находить видимо ее нимбер потому что очевидно что да между вот разными
веточками игры игра игры конечно независимая хочется найти нимбер каждой этой веточки и
собственно их проксорить естественно ну понятно да дфсом нет он по сути да то есть надо дфсом
найти какой-то нимбер но в итоге у вас задача жила было дерево т и у него есть какой-то и
допустим это игра эквивалентно звездочка икс а теперь представим что у нас это дерево
т подвесилось за одно ребро спрашивается да это эквивалентно какому-то нимберу но какому
когда-то эту задачу дали в алкаша в параллельце да а предлагалось типа это придумать предлагалось
это придумать ну в принципе я как бы рассказал видимо ну да ну нормально господи хотя страшно
в школе в целом не ну бывает ну что делать вы знаете мне геомы толком не было по школе когда
мне я первый раз читали геометрию потом выяснилось что да у меня были проблемы что толком не
понимала что такое аксимус вообще вот а надо было там так я ну если шестикласс в пятую группу
алкаша ну знаете так ну ладно ребят давайте сейчас нас погонять начнут так что вот в принципе
я тут промотал по идее все что тут все что есть вот до этого момента теперь вот заратим можно
ли теперь однозначно определить нимбер или может быть там есть варианты сейчас ну не быть однозначно
можно определить потому что мы тоже какая-то понятная игра почему ну не факт может разная
может в зависимости от того какое дерево с нимбером x вы повесите тут будет разные нимберы мало
нет если как бы хочется предположить что ответ уникальный то угадать его не сложно ну потому
что как вы думаете как придумать вот как придумать хоть какое-нибудь дерево с нимбером x да то есть
на самом деле бамбук из x-ребер все это дерево очевидно с нимбером x потому что это просто
очевидно эквивалентный нимбер просто логично да но тогда отсюда следует что если эту бамбуку
увеличить на одно ребро то наверное тут должно получиться x плюс 1 логично да а теперь дальше
говорю так а не получится ли у вас теперь доказать по индукции какой-нибудь что действительно при
таком подвешивании нимбер просто увеличится на 1 и оказывается получается почему ну давайте
доказывать по индукции по числу ребер в дереве ну потому что заметим следующее что вы можете
сделать но если тут x то значит вы можете сделать какой-то ход внутри дерева t и получить любое
число меньше x ну не можете получить само x правда понимаете да значит получается вы здесь обрезая
дерево внутри то есть что-то внутри t вы можете получить ну по индукции по числу ребер что там
получается здесь можете получить что угодно меньше x но не x значит сумма вы отсюда получите
что угодно от 1 до x но не x плюс 1 правда то есть x плюс 1 мы получить не можете но вы можете
получить 0 потому что можете зарезать вот это просто образы деревок чертям следовательно
действительно не берг здесь x плюс 1 все вот видимо примерно что подразумевалось видимо
чтобы должны придумать ну или там я не знаю за гуя или загуглить статью
стантевича в которой это все расписано но я понимаю что там был кеша будет
скорейчить конечно пытаться загуглить такие там такие вещи все тогда работал
но почему не но интернет более менее в каком-то виде работает да да ладно
но не знаю нет почему ли почему легенда не почему легенда об основании лкша
знаете гласит гласит пример следующие идет матюхин так знаете матюхина а не
знаете вот мои времена он был заучил кеша если что сейчас вы уже сейчас вы
даже не знаете кто это да вот ну ладно так вот идет матюхин по лесу но просто
по лесу идет обстрелит смотрят там звенит телефон говорит о здесь ловится
белая л кеша будет здесь вот как видите на момент 2006 годов вот такая
легенда была да ну по чем там много чего было там это знаете это тогда же
появлялись какие-то песни там кольд икс тру писать без кучи то тайм лимит ты
получишь об совсем крутой задачи
юзик у чьих ибоначе могли догадаться ну что не оно чего безобразие не знаю ну я
не знаю может автор пробовал я не знаю ну правда да автор вы тоже скорее всего
не знаете но да пошел я то нет у меня друг это допилил вообще он говорит коле
хип писать без кучи то диагноз ты получишь да коле хип писать без кучи
диагноз ты получишь ну ну как тут немножко в другом проблема да тут как бы да то
знаете ну это такая шутка как-то как-то сейчас как где сейчас как там тиги гидроксид
что-то там а ну да то есть это опасное вещество до гидроксид водорода до гидроксид водорода
страшное вещество никто еще в полной мире не смог избавить воду от этого элемента там например
то есть страшный я да люди там на больше чем на 50 процентов состоят из гитам из гидроксидов
водорода там и так далее там еще более умная правда словосочетание подогнали ну да ну да
да не до балали не но там это уже логика дашу огурцы убивают потому что мы тестировали людей
от родившихся в период с 1859 по 1876 год и как бы 100 процентов и тех из них которые приедли огурцы
умерли вот так что в общем в общем короче не есть
