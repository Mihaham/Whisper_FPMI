Усложняем изучать задачу условно-экстремум функций многих переменных.
Наша задача, как обычно такая, исследовать функцию f равна f от x1 и т.д. xm.
Коротко мы допишем f от x на локальные экстремумы при выполнении так называемых условий связи.
Они у нас записываются в виде g1 от x1 и т.д. xm равно 0 и т.д. gm от x1 и т.д. xn равно 0
Или, если коротко, то это равносильно тому, что отображение g в точке x должно быть равно 0, где g это отображение с компонентами g1 и т.д. gm.
Давайте мы обозначим множество всех точек, которые удовлетворяют этому условию.
Вообще надо сказать, что все это происходит в каком-то открытом множестве омегабольшое Rn.
Давайте я здесь напишу.
x принадлежит какому-то омегабольшому, лежащему в Rn.
Мы предполагаем, что это омегабольшое открыто.
И что мы будем предполагать относительно наших функций f и g?
Относительно g мы будем предполагать непрерывную дифференцированность.
А относительно f мы будем предполагать, что она либо один раз, либо дважды дифференцируема.
Давайте я напишу дважды дифференцируема, чтобы не было вопросов.
Это зависит от того, какого условия мы рассматриваем.
Дважды дифференцируемости нам хватит.
Это наши предположения про множество и про функции.
Что такое с тремом мы определили в прошлый раз.
И давайте мы в качестве s еще обозначим множество всех точек x из омега,
которые удовлетворяют этим условиям связи.
То есть s это будет множество всех тех x, принадлежащих омега,
для которых g от x равно 0.
Вот наша задача. Мы рассматриваем такое множество.
И на нем нужно найти на этом множестве локальные минимумы и максимумы функции f от x.
Пример, который мы в прошлый раз с вами рассмотрели, был такой.
С это было x квадрат на a квадрат плюс y квадрат на b квадрат равно 1.
Ну и в качестве f от x y у нас было x плюс y.
И мы сделали такое ключевое наблюдение, которое я на всякий случай еще раз хотел бы повторить.
Если мы нарисуем вот это множество s на плоскости x y, то видно, что можно найти локальные экстремумы функции f
просто из геометрического смысла, проводя вот линии уровня.
Это все прямые, у которых нормаль имеет компоненты 1,1.
То есть это прямые с уравнением x плюс y равно константе.
У всех этих прямых нормаль имеет конпоненты с точностью до константа 1,1.
И кроме того, еще проще можно сказать, что градиент этой функции имеет везде компоненты 1,1.
Градиент этой функции у нас везде один и тот же вектор.
Хоть это и противоречит рисунку в некоторых местах.
В общем, вот градиенты я нарисовал. Это вот градиенты функции f.
И если мы будем рисовать градиенты функции g, то у нас получатся вот такие вот векторы, которые будут перпендикулярны меллипсу.
И вот ключевое наблюдение, которое мы сделали, это что в точках экстремума функции f
градиенты функции f оказались параллельны градиентам g.
Значит, наблюдение №1 с прошлого раза в точках условного экстремума градиент f параллельен градиенту g.
Надо еще раз давать определение условного экстремума, или вопросов это не вызывает?
Наверное, не вызывает, да?
Это равносильно оказалось тому, что дифференциал функции f – это лямбда на дифференциал функции g.
Вы как раз ничего не пропустили.
Дать определение условного экстремума.
Ну давайте, да, наверное, дадим.
Еще раз напоминаю определение x0 принадлежащее s.
Что такое s? Это понятно.
Это множество всех точек, которые удовлетворяют условиям связи.
Это называется локальным условным минимумом функции f при выполнении условий связи 2.
Давайте мы их, наверное, назовем.
Дана функция, и вот это у нас будут условия связи.
Ну а функция пусть будет 1.
Так, 3.
Значит, точка x0 принадлежащая s называется локальным условным минимумом функции f при выполнении условий связи 2.
То есть, если существует некоторая дельта больше нуля, такое, что для всех x из дельта-окрестности x0, которые попадают на множество s, f от x будет больше либо равно, чем f от x0.
Соответственно, локальный минимум может быть строгим или нестрогим.
В случае строгого локального минимума мы требуем, чтобы здесь было строгое неравенство.
Ну а здесь нужно рассматривать проколоту окрестности.
Давайте я напишу строгий локальный минимум.
Ну то есть здесь строгое должно быть неравенство.
Локальный максимум, соответственно, другие неравенства мы меняем.
Больше либо равно, на меньше либо равно.
Аналогично, условный локальный максимум.
То есть, в чем отличие условного минимума от обычного, который безусловный?
Здесь мы требуем, что точки не просто принадлежат дельта-окрестности,
точки x0, но еще и для них выполнены условия связи.
Минимум на какой-то поверхности или пересечении поверхностей.
Потому что то, что здесь написано, одно такое уравнение, а это некоторая поверхность получается.
Если мы требуем, чтобы одновременно выполняли все эти уравнения, то мы пересекаем эти поверхности.
И мы рассматриваем эту функцию на пересечении поверхностей.
Ну, соответственно, у нас возникает вопрос, как это условие обобщить на случай, когда у нас несколько условий связи.
Потому что здесь у нас было одно условие связи.
То есть в данном парриере g от x и y было x2 на a2 плюс y2 на b2 минус 1.
Одно было условие связи, и вот такая штука.
Давайте мы сделаем некоторое усилие воли.
Не будем слишком увлекаться обобщением конкретных примеров.
Сразу перейдем к делу.
Обобщением коллинеарности векторов является линейная зависимость.
И достаточно естественно ожидать, что необходимым условием экстривума будет то,
что градиент f будет раскладываться в линейную комбинацию градиентов этих уравнений, издающих условия связи.
Гипотеза такая.
Но это условная гипотеза.
Если x0 экстримум, то существует лямда 1 и тогда лямда n такие, что в этой точке дифференциал функции f будет являться линейной комбинацией дифференциала функций g.
Лямда 1 g dg1, плюс и так далее, плюс лямда n dgn.
Можно было бы в терминах градиентов это написать.
Таким образом, по-другому это равенство можно было бы записать так, что дифференциал функции лагранжа f, минус лямда 1 g1, минус и так далее, минус лямда n dgn должен быть равен 0.
Вот этот дифференциал должен быть равен 0 в точке x0, как функция от этих векторов dx1 и так далее dxn.
Но чтобы все-таки это доказать, еще нужно некоторые условия.
В нашем примере нам повезло, что везде градиент функции g не равен 0.
Но в принципе может быть такое, что градиент функции g где-то обращается в 0.
И тогда это, казалось бы, всегда будет выполнено.
Поэтому нам нужно еще дополнительное условие, которое стоит в том, что у функции g в случае одного уравнения не 0 градиент.
Что это означает?
Это означает, что в первом порядке наша функция g достаточно хорошо описывает условия связи.
Короче говоря, мы будем предполагать, что в случае одного условия связи градиент не равен 0, и это означает, что условия связи можно линеризовать.
Мы сейчас хотим понять, какие условия являются необходимыми для условного экстремума, и какие условия являются достаточно для условного экстремума.
Поэтому нам интересно рассматривать только те точки, в которых может быть условный экстремум.
А по определению это только те точки, которые лежат на множестве s.
Поэтому то, что в 0,0 градиент обращается в 0, это, конечно, не страшно.
Ну все, давайте теперь будем писать теорему и доказывать ее.
Теорема 1 будет такая.
Теорема 1.
Это будет необходимое условие условного экстремума.
Такая немного тавтология, но ничего не поделаешь.
Необходимое условие условного экстремума.
В принципе, есть еще один термин.
Вместо условного экстремума иногда говорят относительно экстремум.
Давайте мы будем пользоваться термином условного экстремума.
Вроде он более распространенный.
Но нам все-таки привычно говорить о необходимых условиях и достаточных условиях.
Поэтому необходимое условие – это вроде такой устоявшийся термин.
В чем он стоит?
Предположим, что x0 принадлежит S.
Это локальный условный экстремум.
То есть локальный условный минимум или локальный условный максимум.
Функция f.
Пусть в точке x0 выполнено следующее важное условие.
Пусть rank матрицы якобы отображения g в точке x0 равен m.
Что это означает?
Это означает, что к этой системе уравнений можно будет применить теорему о системе функций заданных неявно.
И выразить какие-то m переменных через n-m остальных.
Словами это называется так, что матрица якобы имеет полный rank.
Важные условия.
Тогда существуют числа.
Существует лямбда 1 и так далее.
Лямбда m, принадлежащие r, такие, что
Давайте я напишу здесь полностью.
Для любого h, принадлежащего r, n.
df от x0 h равно лямбда 1 dg1 от x0 h
плюс так далее, плюс лямбда m dgm от x0 h.
То есть вот в такой записи более строго написано, что означает, что дифференциал функции f является линейной комбинацией дифференциалов этих уравнений связи.
То есть мы взяли точку x0, в ней посчитали все дифференциалы.
И эти дифференциалы, как линейные формы в этой точке, оказываются линейно-зависимыми в таком виде.
Другими словами, давайте я здесь напишу.
x0 будет стационарной точкой функции лагранжа.
l от x, это функция лагранжа, определяется как f от x минус лямбда 1.
И здесь идет, соответственно, g1 от x минус так далее, минус лямбда m dgm от x.
Вот такая теорема.
Замечание такое.
Мы функцию лагранжа сейчас рассматриваем, когда говорим про стационарную точку, как функцию только от x.
Но, в принципе, можно рассматривать еще функцию лагранжа как функцию от лямбда.
Но давайте я здесь, наверное, вот так вот сделаю.
Вы можете себя не поправлять, но я просто здесь для наглядности подпишу нолики.
Мы можем рассмотреть, как функция не от тобой относится к деференцированию.
У нас все равно, если мы деференцируем там конкретно лямбди, у нас только один останется.
Ну, только той функции, при которой эта лямбда существует.
Я имею в виду, что, смотрите, мы можем функцию лагранжа рассматривать как функцию от двух переменных, от x и от лямбда.
Ну, давайте так вот.
Функции u, l можно рассматривать как функции u от x и лямбда.
А, вот здесь я забыл нолики.
Ну, хотя ладно.
Вот как раз, давайте здесь я пока оставлю, как есть.
То есть, смотрите, вот что я хочу сказать.
Функцию лагранжа мы можем рассматривать в таком виде.
Л от x лямбда равно f от x минус лямбда 1 g1 от x минус и так далее, минус лямбда m gm от x.
А здесь я давайте нолики напишу.
Все, вот так вот у меня получается хорошо.
Все ничему не противоречит.
Так вот, теорема говорит, что найдутся лямбды такие, что дифференциал функции f раскладывается по этим дифференциалам.
То есть, для некоторых лямбда 0 у нас точка x 0 будет стационарной точкой функции лагранжа.
А можно по-другому еще смотреть.
Будет ли точка x 0 лямбда 0 стационарной точкой функции лагранжа?
Функция лагранжа, если рассматривать функцию лагранжа, как функцию от x лямбд.
И замечание стоит в том, что это на самом деле одно и то же.
Вот, x 0 является стационарной точкой l от x при лямбда равном лямбда 0.
Тогда и только тогда, когда вот такая точка x 0 лямбда 0 является стационарной точкой l от x лямбда.
То есть, в чем отличие?
Чтобы быть стационарной точкой вот этой функции, нужно чтобы производные функции лагранжа по x были равны 0.
А чтобы быть стационарной точкой вот этой функции, нужно чтобы не только по x производные были равны 0, но и по лямбда.
Но к чему будут равны производные вот этой функции по лямбда?
Вот dl по d лямбда it от x.
Если предифференцировать, вот вы сказали, что легко предифференцировать.
Получаем g it от x.
А чему равно g it от x, если x это точка принадлежащая множеству s?
А чему равно g it от x, если x 0?
Вот это 0.
Значит, если x принадлежит s.
Вот, собственно говоря, все, что я хотел сказать.
Потому что в каких-то учебниках функцию лагранжа рассматривают как функцию от x и лямбда, а в каких-то только от x.
Но, в общем, разницы нету в силу вот этого вот замечания.
Теперь, чтобы доказать эту теорему, нам нужно доказать ключевую лему, которая будет использоваться еще и в достаточных условиях.
Это будет так называемая лемма о выпрямлении координат.
Лемма о выпрямлении координат.
Она утверждает следующую вещь.
Если ранг матрицы якобы отображения g в точке x0 равен m, то существует...
Ну, давайте я сначала по смыслу скажу.
Что вот систему вот этих вот функций g1 и так далее gm можно дополнить еще n-m функциями до некоторой криволинеи системы координат.
То существует непрерывно дифференцируемые функции phi1 и так далее phi n.
Ну, и неверно дифференцируемые функции где? В окрестности? В окрестности x0.
Такие, что phi1 это g1, так далее phi m это gm и екабиан отображения phi в точке x0 отличен от нуля.
Помните, мы вот так обозначали екабиан g phi 0. Я на всякий случай напомню, что это определитель матрицы якобы.
А стало быть, к отображению phi можно применить будет теорему об обратном отображении получается.
Вот эта вот лемма доказывается, она очень просто.
Ну, раз ранг вот этот равен m, то у нас существуют какие-то m переменных такие, что екабиан отображения g по этим m переменным не равен 0.
Ну, не умешая общности, пусть это первые m переменных, не умешая общности d phi1, так далее phi m, по d x1, так далее xm не равно 0 в x0, в x0 сверху.
Ну, соответственно, тогда понятно, что взять, так только здесь не phi, естественно, здесь не phi, а здесь g, потому что phi нам надо определить.
Ну, такая некоторая тавтология, но ничего значит.
То есть вот это вот условие означает, что какие-то m столбцов вот этой матрицы линейно независимы, правильно?
Не умешая общности, пусть это первые m столбцов, потому что если это не первые m столбцов, то мы как-то переименуем независимые переменные так, чтобы это стали первые m столбцов.
Ну, не умешая общности, значит, у нас вот это выполнено. Ну, и тогда мы берем, берем, значит, что мы берем, что, значит, берем phi1 равное g1 и так далее, phi m равное gm.
И, соответственно, phi it от x равно x it при и принадлежащему от m плюс 1 до m.
Вот. Тогда что из себя будет представлять матрица якобы отображение phi? Ну, она будет вот такая блочная матрица, значит, d phi будет иметь следующий вид.
Так. Вот так мы это обозначим. Значит, здесь будет блок из d g1 и так далее gm по d x1 и так далее x m. Здесь будут нули, а здесь будет единичная матрица размера n минус m.
Значит, здесь будут единички и здесь нули. Вот. Соответственно, определитель вот этой матрицы, он будет равен просто определителю вот этой матрицы. Ну, и стало быть, он не равен нулю.
Вот. Ну да. Ну, может быть, какая ситуация? Может быть, нет, у нас вот этих вот g, у нас всегда m. То есть, что может быть плохого? Может быть, вот такая штука.
Ну, в общем случае d g1 и так далее g mt по d x i1 и так далее x i mt не равно нулю. Вот это вот общая ситуация, да. То есть, что по каким-то столбцам, у которых индексы равны i1 и так далее i m, якобиан не равен нулю.
Вот. Ну, тогда нам надо будет, получается, взять все-таки первые m функции таких вот, первые m берем как g, а в качестве фиитова при i больше, чем m, нам нужно брать x с теми индексами, которые не равны i1 и так далее i m.
Ну да. Да, это сменит максимум знак, это правильно, да. Вот. Поэтому нам главное, чтобы вот якобиан был не равен нулю, потому что то, что якобиан не равен нулю, нам позволяет сказать, что, значит, в какой-то окрестности, да, точки x 0 отображение фи окажется взаимно однозначным.
Вот. Ну, хорошо. Теперь перейдем к доказательству теоремы 1.
Что? Что еще раз?
Не, оно не может быть равно только нулю, потому что если...
Ну, смотрите, если g1 равно нулю тождественно, да, то у нас вот получается, что вот этот вот якобиан будет равен нулю.
Так что...
У нас, смотрите, у нас вот этот вот ранг равен m.
Поэтому всегда найдутся какие-то m индексов такие, что вот такой вот определитель не равен нулю.
Так, если фи1 равно g1.
Так, если фи1 равно g1.
Получается, что матец фи будет 0.8.
Ну, я не очень понимаю, почему... Вот вы говорили, что получится 0.8 толбец.
Я не понимаю, почему там должен получиться 0.8 толбец, потому, значит...
Ну, смотрите, значит, g1 не может быть равно нулю, вы имеете в виду, что g1 тождественно равно нулю.
Такого не может быть, потому что тогда ранг вот этой матрицы, он в любом случае будет меньше, чем m.
Потому что у матрицы будет 1 нулевой, кто там получится, одна нулевая строка получится, правильно?
Вот, конечно, эту штуку может быть не очень легко сразу представлять себе в голове вот эту вещь.
То есть вот dg, то есть мы берем матрицу якобы там dg1 по dx1 и так далее.
dgm по dxn, ну а здесь будет dg, значит, здесь dg1 по dxm, а здесь dgm по dxm.
Ну, здесь много многоточек, я их пропустил.
Ну, короче говоря, видите, вот такая матрица получается, да?
Значит, и если g1 равно нулю, то первая строчка у нее получается нулевая.
Вот.
Потому что в общем случае вот вместо этого условия, что означает, что ранг вот этой матрицы равен m?
Значит, у нее строки линейные независимые, ну или что то же самое, что какие-то m столбцов линейные независимые, правильно?
Вот. Значит, здесь я рассматриваю случай, когда линейные независимые первые m столбцов.
Могут быть какие-то другие m столбцов линейные независимыми.
Нет, в ней m строк, а столбцов в ней n.
Потому что вот здесь я написал не то, здесь n, я не аккуратно написал.
То есть, да. У нас вот эта матрица размера m на n.
Все, окей, хорошо, разобрались с этим вопросом.
Вот. Значит, что это означает?
Значит, вот теперь давайте мы ведем некие обозначения про переход в криволинейные координаты.
Значит, давайте мы x с волной, под x с волной будем понимать phi от x.
Хорошо. То есть, x с волной это запись некоторого вектора в новых координатах.
Вот. А как будет выглядеть наша функция, ну, например, f в новых координатах?
Вот давайте мы определим f с волной, f с волной от y.
f с волной от y мы определим как f от, естественно, phi минус 1 от y.
Ну, давайте мы под psi будем понимать phi минус 1.
Здесь мы применяем теорему об обратном отображении.
Вот. И f с волной от y это будет f от psi от y.
Вот. Ну, значит, соответственно, у нас всегда будет выполнено такое свойство,
что вот то, что было f от x в старых координатах,
оно становится f с волной от x с волной в новых координатах.
Ну, а если мы будем понимать, что f с волной от y это будет f от psi от y?
В старых координатах оно становится f с волной от x с волной в новых координатах.
Ну, просто почему это так?
Потому что f с волной от x с волной это у нас получается, значит, f с волной это вот эта штука,
f от psi, а x с волной это вот эта штука, это phi от x.
Ну, и поскольку, значит, psi это phi минус 1, то это f от x.
Вот.
Значит, что такое f с волной?
Ну, это, так сказать, выражение для старой функции в новых координатах.
То есть, короче говоря, смотрите, я у одной и той же точки могу записывать старые координаты и новые координаты.
Старые координаты обозначаем x с волной, новые координаты x.
Что такое f с волной?
f с волной это функция, которая говорит, чему будет равно f от x в точке, у которой новые координаты это x с волной.
Ну, вот такие вот обозначения.
Так, сейчас давайте мы напишем.
Значит, тогда вот самый главный момент, что точка x принадлежит s.
Это равносильно тому, что g от x равно 0.
А это равносильно будет чему, в свою очередь?
Значит, это получается равносильно тому, что phi it от x равно 0 для любого i, принадлежащего от навода m.
Вот. А чему это равносильно?
Это получается равносильно тому, что у точки x в новых координатах, в новой системе координат все вот эти вот x it будут равны 0.
Равносильно получается тому, что x it с волной равно 0 любого i, принадлежащего от навода m.
То есть, если мы нарисуем картинку, то я полноценную картинку не могу нарисовать, потому что на доске это правливатично.
Но если у нас s задавалось к пересечению каких-то двух поверхностей, это, так сказать, плоскость x, то на плоскости x с волной в новых координатах это будет уже выглядеть вот таким вот образом.
То есть, вот что я здесь нарисовал. Это у меня, допустим, условия g2 равно 0, это условия g1 равно 0.
Вот. Ну а, соответственно, здесь у меня на плоскости, ну даже это будет более аккуратно выглядеть, потому что мы нарисуем это так.
Так, значит, это будет у нас x2 равно 0. Так, как бы лучше это изобразить. Ну, так вот, x2 с волной равно 0, а это вот x1 с волной равно 0.
То есть, после того как мы переходим в криволинейные координаты, у нас выпрямляются вот эти вот ограничения g1 равно 0 и g2 равно 0.
Так, ну ладно, давайте сейчас сделаем перерыв, раз был звонок. Вот. Если по вот этим вот обозначениям есть какие-то вопросы, то спросите.
Но здесь включу момент, что мы, значит, иногда мы будем рассматривать x с волной как функцию от x, а иногда мы будем их рассматривать как независимые переменные.
Вот надо будет за этим нам аккуратно следить.
Исправить небольшую опечатку вот в этом равенстве. В этом равенстве у меня получилась опечатка какая, что вот здесь вот 0 я почему-то написал, но на самом деле здесь, конечно, будет не 0.
Здесь будут производные g по последним n-m переменным. То есть вот здесь вот надо поправить, такая штука получится.
Д от g, m плюс 1 и так далее, g, m, точнее говоря так, g1, gm, у нас функции g, m штук.
Вот. По d, x, m плюс 1 и так далее, x, m. Вот такая штука. То есть вот здесь вот у нас есть блок, который представляет собой невыружденную матрицу размера m на m.
Дальше блок какой-то непонятный такой размера m на n. Здесь внизу блок из нулей и здесь единичная матрица.
Но как считать определитель такой блочной матрицы вы знаете из линейной алгебры?
В общем, вот то, что здесь написано, оно не влияет на определитель, поэтому вывод как бы сохраняется.
Ну так вот, мы перешли, основная идея всех вот этих рассуждений, которые дальше пойдут, она стоит в том, что мы переходим в криволинейные координаты, в которых поверхность s задается очень простым условием.
Что, так сказать, x и t с волной, вот эти новые координаты равно 0. А в этом случае фактически задача сводится к обычному экстремуму.
Значит, тогда вот получается, тогда, если x0 это локальный экстремум, локальный условный экстремум функции f, даже можно без если написать.
Значит, x0 является локальным экстремумом f, это равносильно тому, что x0 с волной это локальный условный экстремум f с волной.
А где? Где? На множестве s с волной, которая вот просто сдается вот этими условиями.
x и t с волной равно 0 любого и принадлежащего 1 до m.
Ну все, теперь пошла простая часть.
То есть сложная часть, на самом деле, это осознать эту замену переменных, которую мы делаем.
Ну а простая часть такая.
Значит, у нас получается, что 0 и так далее 0, у нас тут m0, дальше пойдет x с волной 0, m плюс 1 и так далее, x с волной 0, n.
Это получается у нас локальный экстремум вот такой вот функции.
Значит, функции f с волной от 0 и так далее 0, x с волной m плюс 1 и так далее, x с волной n.
Причем вот эту штуку, очень важно здесь, что мы ее рассматриваем как функцию лишь от последних n минус m переменных.
Вот я это здесь напишу. Как функции n минус m переменных.
Переменных вот этих вот x, m плюс 1 с волной и так далее, x, n с волной.
То есть вот здесь как раз вот эти штуки мы рассматриваем как независимые переменные.
Теперь надо вспомнить, что из себя представляет необходимое условие обычного экстремума.
Стационарная точка, да. Тогда получается, что точка x с волной 0, m плюс 1 и так далее, x с волной 0, n, это стационарная точка.
Ну и все, и получается, что производная f по dxитому с волной, df с волной по dxитому в точке x0 с волной,
ну я для краткости так напишу, потому что x0 с волной как раз есть вот эта точка, они получаются равны 0 при i больше m.
Все, а это означает, что дифференциал f с волной в точке x0, ну здесь какое-то w давайте я напишу,
это получается сумма будет сумма по i одного до m, df с волной по dxit с волной в точке x0 с волной умножить на wit.
То есть у нас получается, что производные по последним n минус m переменному функции f с волной равны 0, значит ее дифференциал это линейная комбинация дифференциалов первых m переменных.
И теперь остается применить к этому равенству теорему фактически об инвериентности дифференциала первого порядка, ну или другими словами теорему о дифференцировании композиции отображений.
Значит смотрите, вот я хочу теперь доказать вот это равенство, мне нужно доказать вот это равенство, вот оно написано.
Значит давайте мы определим лямда it как вот эти вот коэффициенты df с волной по dxit в точке x0, определили такое лямда it.
То есть у нас тогда получается формула, это упрощается так, x и с волной, правильно, да, спасибо, очень здорово.
Лямда it, wit. Вот такая получается простая формула.
Ну это дифференциал f с волной, а мне нужно получить обычный дифференциал функции f.
Вот как их связать? Ну, значит мы вспоминаем вот это вот равенство, да, что у нас есть.
И фактически нужно взять дифференциал от него получается. У нас значит f от x это будет f с волной от phi от x.
Следовательно, по теореме о дифференциировании композиции, ну или другими словами, по теореме оба варианта дифференциала в первом порядке.
Дf от x, значит df от x0, да, h. Это что получится? Это получится такая сумма.
Сумма по i на v до m. Ну, на самом деле здесь пока что до m давайте напишу.
Дf с волной по dx it с волной, вычисленная в точке phi от x0, умножить на d phi от x0, h.
Вот, ну и все. Значит у нас получается, что последние n-m компоненты за нуляются, а вот эти штуки для i от 1 до m это лямда it.
Видите, да? Значит все получается сумма по i. Так, d phi it. Вот здесь i я пропустил. Образите внимание, здесь индекс i.
Вот, ну все. Получается сумма по i на v до m, лямда it, лямда it на, на кого? На, значит, на d phi it от x0, h.
Вот, все. Ну, значит, у меня была плохая идея одновременно двумя теоремами пытаться доказать это дело.
Значит, давайте я просто буду пользоваться теоремой у дифференцирования композиции отображения, как здесь написано.
Значит, смотрите, вот, строго говоря, должно быть суммирование от 1 до m. Правильно вы сказали. Вот такое вот суммирование от 1 до m.
Но у нас вот эти вот производные d f с волной по dx it равны нулю при i больше чем m. Вот.
Поэтому, поэтому получается здесь суммирование только по i от 1 до m. И в этом случае вот эти штуки у нас как раз лямды получаются.
Все. Вот. Вот доказали. Так, ну, вот. Мы доказали с вами необходимые условия.
Значит, теперь, чтобы перейти к достаточному условию и ко второй части необходимого условия, нам нужно еще одно сделать интересное наблюдение.
То есть функция Lagrange это не просто удобный способ вот этого обобщения того факта, что в локальных экстремумах градиент f параллельен градиенту g.
Значит, еще функция Lagrange важна в силу следующего наблюдения.
Давайте я его здесь напишу. Наблюдение номер два.
Значит, у функций f от x и l от x одни и те же локальные условные экстремумы при выполнении условий связи 2.
Вот. Ну, это в принципе довольно простой факт, но он тем не менее стоит того, чтобы его зафиксировать.
Почему это так? Почему у них одни и те же локальные условные экстремумы?
Ну, мы посмотрим, чем вообще эти функции отличаются? В чем отличие этих двух функций?
Ну, вот эти слагаемые, да? Но локальный экстремум – это когда мы рассматриваем эти функции только на множестве s.
А на множестве s функции g равно нулю. Правильно? Видите, какая интересная штука, да?
То есть, казалось бы, реальный факт, вот это наблюдение два, но мы его все-таки выделим, потому что он важен. Мы дальше это увидим.
То есть, получается, он важен чем? Что точка x0 будет локальным условным экстремумом функции f тогда и только тогда, когда она является локальным условным экстремумом функции l.
Так как в точках… То есть, получается, что функции g, они сказываются у нас только на дифференциале, да?
То есть, дифференциалы у f и у l разные получаются, но вот на множестве s у них значение одинаковое. Вот такая интересная штука.
Так, значит, и наконец-то нам понадобится еще одна конструкция интересная.
Значит, еще давайте дадим одно определение.
Множество… Множество… Ну, значит, как бы его лучше написать?
Давайте, наверное, так. Множество тех векторов h принадлежащих r,n таких, что dg от x умножить на h равно 0.
Обратите внимание, здесь записана система линейных уравнений. Вот эта штука, это у нас матрица размера m на n, а это столбец высоты n.
Значит, вот такое множество всех тех h, для которых dg от x умножить на h равно 0.
Значит, это множество… Давайте мы его будем как-нибудь обозначать. Вот так вот, t, x, s.
Это называется касательным пространством к s, к множеству s, в точке x.
Это называется касательным пространством к s, в точке x.
И вот эта вот удобная штука, чтобы сформулировать необходимое и достаточное слое условного экстремума.
Теорема необходимое условие условного экстремума, часть 2.
Значит, вот в чем она стоит. Это теорема 2.
Если x0 принадлежит s, это локальный условный экстремум функции f при выполнении условий связи 2.
То есть, если x0 – это локальный условный экстремум функции f при выполнении условий связи 2, то…
Первое. Если x0 – это локальный минимум, то второй дифференциал функции Лагранжа в точке x0…
Здесь имеется в виду, естественно, функция Лагранжа с теми лямбда, который дает необходимые условия.
Сейчас мы это напишем. Давайте я напишу так.
Это зазротичная форма d2l, где лямбда иt берутся из необходимого условия.
То есть, из теоремы 1.
То есть, фактически то, что я сейчас пишу, это некоторое приложение, теорема 1. Можно было бы ее не разбивать на две части.
Вот. То, что зазротичная форма оказывается, будет не отрицательно определена на этом касательном пространстве.
Не отрицательно определена.
Хорошо, да. Будем согласовывать терминологию с линейной алгеброй положительно.
На касательном пространстве в точке x0.
Вот. Ну, второе, аналогично, в случае локального условного максимума, она будет отрицательно полуопределена.
Вот. И остается нам для полноты картины еще сформулировать теоремы про достаточные условия условного экстремума.
Возможно, я их сегодня и не успею до конца доказать, но, наверное, вот сюда буду писать доказательства формировки.
Вот.
Значит, теорема 2.
Теорема 2.
Достаточные условия.
Теорема 3, простите.
Значит, если x0, ну, давайте я так напишу, если x0, лямбда, это сационарная точка функции Лагранжа,
ну, собственно говоря, то, что x0 принадлежит S, это уже следует из-за того, что это сационарная точка.
Так вот, если у нас есть некоторая сационарная точка, и в этой точке второй дифференциал функции Лагранжа положительно полуопределен на касательном пространстве,
положительно, вот правильно, да, вы, это я оговорился, да, значит, положительно определен, именно положительно определен.
Ну, потому что понятно, что легко придумывать ситуации, где даже без условного экстремума, там, положительная полуопределенность ничего не дает.
Здесь именно положительная определенность должна быть.
Если x0 положительно определен на tx0s, то x0, это будет локальный, условный, строгий минимум.
Лучше написать строгий, да, обычно пишут вначале строгий.
Это будет строгий, локальный, условный минимум.
Аналогично, если, значит, если d2L отрицательно определен на tx0s, то x0, это будет, это будет строгий, локальный, условный максимум.
Единственное, что я забыл написать в этих теоремах 2 и 3, это, как обычно, я забыл написать, что в этих теоремах предполагается, что
Ранг dg в точке x0 равен m.
Вот давайте мы допишем здесь, и здесь тоже я напишу это.
Пусть dg, пусть ранг dg в x0 равен m.
Вот, значит, если, ну давайте, наверное, я немножко скажу про договорительство, а потом скажу про вот это вот условие, почему оно все-таки важно.
Вот две теоремы мы сформулировали, то есть первая теорема это необходимое условие условного экстремума, а третья теорема это, это, это достаточно условие.
Ну здесь есть еще можно дополнить таким утверждением, если, если d2l не определена на tx0s, то x0 не является локальным условным экстремумом.
То есть картина полностью аналогична тому, что было в случае, значит, что было в случае обычного экстремума, полностью аналогична.
Только очень важно здесь, в этой теореме, вот, обратите внимание, что второй дифференциал функции Лагранжа нужно исследовать не на всем rm, то есть он является квадратичной формой на rm, но нам его нужно исследовать не на всем rm, а только на касательном пространстве.
Вот. Замечание такое, значит, замечание такое, что на практике, чтобы исследовать, чтобы исследовать вот этот вот d2l на касательном пространстве, что нам нужно сделать? Вот давайте мы посмотрим.
Значит, что такое касательное пространство? Касательное пространство означает, что из этой системы линейных уравнений, раз у нее rank равен m, я могу выразить какие-то m переменных через все остальные, правильно?
Вот. Поэтому на практике получается, что нужно сделать? Нужно вот из этой системы линейных уравнений выразить m переменных через n-m остальных, подставить их во второй дифференциал, значит, это у нас была функция от n переменных, мы туда подставляем m переменных, получается квадратичная форма от n-m переменных.
Ну и все. И полученную форму от n-m переменных мы исследуем на знак. То есть, вот давайте это замечание я еще напишу. Давайте, все-таки не буду пытаться все доказать за сегодня, как раз хорошо, что мы еще раз на следующей лекции мы тогда продолжим вот с этой заменой координаты работать, чтобы набить на ней руку.
Поэтому задача будет домашнее задание, если здесь остались какие-то неясные моменты, то попытаться с ними разобраться.
Вот. Теперь я давайте вот это замечание напишу, которое здесь есть, которое я хотел вот тут написать, но здесь места мало, я его напишу здесь.
Замечание. На практике для исследования d2l на tx0s, значит, второй дифференциал, я напомню, что это у нас функция от чего. Вот есть x0 и есть h. У нее есть n переменных.
У нее есть n переменных. И мы ее исследуем в эту координатную форму, на вот этом подпространстве. Нужно из вот этого равенства, так, это у нас равенство 4, нужно из 4 выразить какие-то...
то n переменных.
Через n-m остальных и подставить вот сюда вот.
Вот. А затем останется исследовать полученную квадратичную форму от n-m переменных на знак.
Значит, с помощью критерии Сильвестро.
Вот. И теперь, оставшиеся, наверное, 5 минут или даже меньше, я хотел бы... будет лучше, если я не буду сейчас доказывать эти теоремы, а я приведу пример, который показывает, что вот это вот условие, которое я вначале здесь забыл написать, оно важно.
Значит, давайте мы что-нибудь сотрем. Так. Ну, наверное, вот это вот можно стереть. Да, давайте. Хорошее предложение.
Вот. На счет замечания условия rank dg.
Ну, на практике, по-моему, редко снижают какие-то баллы за то, что это условие не проверяется.
Значит, вот это условие dg от x равно m. Но, тем не менее, его нельзя отбросить.
Вот. Почему? Потому что, может быть, такая ситуация. Значит, вот смотрите. Давайте мы...
Ну, сейчас я хочу сказать, что его нельзя отбросить, в общем-то, даже в первой теореме.
Которая необходимое условие. Да, необходимое условие, помните, у нас было, что дифференциал функции f является линейной комбинацией ограничений.
Давайте мы рассмотрим такой пример. Пример. Ну, давайте так. Пусть g1 от x, y, z равно z.
g2 от x, y, z равно x минус y квадрат. Плюс z, наверное. Вот так мы сделаем. Плюс z.
Ну, тут плюс или минус, это не сильно важно. Вот. Значит, тогда что получается?
И я хочу что исследовать? Я хочу исследовать, например, точку 0, 0, 0. Я еще должен написать, чему равно f от x, y, z.
Давайте мы напишем f от x, y, z. Ну, пусть это будет x плюс y. Значит, так, x. Ну, или x минус y. Значит, x минус y.
Вот такая вот функция, да? Значит, давайте посмотрим, что из себя представляет множество s.
s это будет множество, где зануляются функции g1 и g2. g1 равно g2 равно 0. Вот.
И, как ни трудно видеть, это множество тех точек, у которых z равно 0 и x равно y. То есть, геометрически, что это означает?
Это означает, что мы находимся на плоскости x, x, y. Значит, это вот x. Допустим, это y.
Ну, как там лучше изобразить? Вот так вот. x, y, z. Классически мы изобразим.
И s представляет собой вот такую прямую, лежащую в плоскости x, y. Это вот s.
Вот. Значит, что мы можем сказать про функцию f? Функция f вдоль s. Постоянно, правильно, да?
Поэтому любая точка s является локальным экстремумом функции f.
Любая точка x, y, z, принадлежащая s, это локальный экстремум функции f.
Ну, потому что f равно 0 на s.
Вот. Но, тем не менее, что мы можем сказать? Тем не менее, дифференциал функции f у нас получается чему равен?
Дифференциал функции f – это dx – dy. То есть, это вот такая вот штука получается.
Значит, если записать эту линейную форму через координату строкут, получится 1 – 1, 0 на dx, dy, dz.
Вот такая вот линейная форма. А чему равны дифференциалы g1 и g2?
Ну, в точке 0, 0. В точке 0, 0, 0. Дифференциал g1.
Ну, тут на самом деле видно. Прямо по определению видно. Ну, дифференциал g1, вы прямо мне можете сразу сказать, чему будет равен дифференциал g1.
Вот. 0, 0, 1. Ну, там то же самое. dx, dy, dz. А чему равен дифференциал g2?
Ну, смотрите, строк говоря, должно быть такое. Значит, 2x – y dx – dy. Вот такая штука.
Вот такая вещь. Но мы, поскольку говорим про точку 0, 0, 0, то эта штука уходит.
Поэтому тоже получается то же самое. 0, 0, 1. dx, dy, dz.
Вот. И получается, видите, какая неприятная штука, что вот этот дифференциал не является линейной комбинацией этих дифференциалов.
В принципе. То есть получается, что у нас необходимое условие не выполнено.
Но оно не выполнено за счет того, что у нас не выполнено вот это вот условие.
Вот. Ранг d, g получается меньше 2. И необходимое условие из теоремы 1 не выполнено получается.
Несмотря на то, что это, ну, точка, строк говоря, является локальным экстремом.
Вот. Картинка такая получается, как бы, что у нашего вот условия, ну, в некотором роде оно получается такое, да, что мы вот берем плоскость.
Вот плоскость z равно 0, да. Вот представьте, что это вот этот стол.
А второе ограничение, ну, это, ну, не совсем цилиндр, но можно думать, что этому цилиндр, как бы, да, так сказать, какой-то крутин.
Вот. И интересно, что получается, что, грубо говоря, дифференциал вот к функции g1 представляет собой, ну, так не точно говорить, но тем не менее можно так думать, что дифференциал это касательная плоскость, да, вот, к поверхности.
Поэтому дифференциал функции g1 это вот, ну, поверхность стола. И дифференциал функции g2 это тоже поверхность стола.
Но, как бы, видите, что мы можем вот этот вот цилиндр там вращать как хотим получается, да, и несмотря на то, что дифференциалы не меняются, вот наше множество s существенно зависит от того, как расположен вот этот цилиндр получается.
То есть смысл в чём, что вот это вот условие, оно очень существенное, что ранг матрицы якоби g должен быть равен m.
Иначе, если это условие не выполнено, дифференциалы функций g, они нам не дают достаточно информации о том, что из себя представляет множество s. Всё. Спасибо.
