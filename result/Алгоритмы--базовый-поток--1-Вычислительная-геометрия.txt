поговорим про довольно необычную тему, а именно про вычислительную геометрию на
плоскости. Давайте дам для начала немного мотивации, что это и зачем. Смотрите, вроде как у всех из вас
так или иначе был или есть курс по какой-нибудь линейной алгебре, аналитической геометрии,
на которой вы занимались всякими геометрическими штуками, векторочками, отрезочками, линиями и так
далее. Искали всякие пересечения, расстояния и тому подобное. Вроде как предполагается,
что вы все это делать умеете. Но когда мы говорим про методы, которые вы обсуждаете на
математических курсах, линейной алгебре или аналитической геометрии, то мы как бы сталкиваемся
там с тем, что мы живем в таком действительно значенном или комплексно значенном мире, в котором
мы там можем абсолютно точно посчитать соответствующие расстояния, мы с точностью
до последнего знака знаем число pi и так далее. С любой необходимой точностью. Естественно,
в реальной жизни это не так. То есть, естественно, когда вы начинаете реализовывать все алгоритмы,
которые вы изучали на линейной алгебре или аналитической геометрии, мы сталкиваемся с
некоторой погрешностью. Почему? Потому что у вас всякие вычисления с флотами или даблами
происходят с какой-то определенной точностью, плюс сами значения дабл или флот тоже хранят
себе значения с какой-то точностью, с какой-то погрешностью. И, соответственно, когда вы там
делаете какие-то вычисления, эта погрешность накапливается и в итоге вы получаете не совсем
точный результат. То есть, возможно, не совсем тот, который вы ожидали. Например, вы ищете
пересечение двух прямых, находите, соответственно, эту точку с какой-то погрешностью, дальше из этой
точки пускаете луч в каком-то далеком направлении, дальше смотрите вот это вот пересечение с каким-нибудь
другим отрезком и так далее. И, соответственно, у вас ошибка накапливается и накапливается,
и в итоге получается не совсем удовлетворительный результат. Ну или, например, скажем банально,
вот у вас есть две прямые, соответственно, которые заданы какими-то уравнениями типа ax
плюс by плюс c, и тут alpha x плюс beta y плюс гамма. И, соответственно, вам нужно определить параллельно
прямые или нет. То есть, если у вас вот эти значения a, b и c, alpha, beta, гамма, это какие-то
действительные числа, то, в принципе, опять же из-за ошибки погрешности, из-за ошибки,
из-за погрешности вы можете получить такую ситуацию, что прямые это вроде как
предполагались параллельные, но где-то совсем вдалеке на бесконечности они в итоге пересекутся.
Тоже как бы не совсем приятная ситуация. К чему я это все? Сегодня мы будем обсуждать методы
и алгоритмы решения различных геометрических задач в предположении, что у нас все координаты,
координаты точек, координаты концов векторов, координаты вершин многоугольников и так далее
будут являться целыми числами. То есть, грубо говоря, вычислительная геометрия с целочислыми
координатами. Чем это хорошо? Ну, это хорошо тем, что в целых числах вся арифметика в компьютере
точная. То есть, если вы не выходите за границы, если вы не переполняете целые числа, то, соответственно,
все вычления у вас абсолютно точные и, соответственно, вот таких вот ситуаций у вас точно не возникает.
Это первый момент. А второй момент, к сожалению, не все методы, которые вы проходили на курсе
аналитической геометрии, применимы непосредственно в целочистом координатам. Потому что там мы предполагаем,
что нам доступны все возможные операции, типа вычисления косинуса, синуса, делений и так далее,
что, естественно, приводит к каким-то погрешностям и ошибкам. И, соответственно, хотелось бы разработать
такие алгоритмы, которые бы не использовали этот аппарат. Ну, давайте вот некоторые избранные
задачи рассмотрим сегодня на лекции. Соответственно, у вас в задании тоже, ну, в задании на семинарах вы
там пообсуждаете какие-нибудь другие применения. Ну, значит, да, как я сказал, будем решать задачу,
которую геометрический объект задает с набором каких-то целочистных координат или коэффициентов.
Ну, и, соответственно, самыми базами привитива, которым мы будем пользоваться, это, соответственно,
точка и вектор. То есть, точка задается двумя координатами, в котором она находится. Вот,
соответственно, вектор тоже задается двумя координатами, координатами конца этого самого вектора.
Ну, в предложении же, что начало вектора расположено в точке 0,0. Вот. Давайте ведем несколько, на самом
деле знакомых вам понятий, ну, просто-напросто немного вспомним и дадим им некоторую новую
интерпретацию. Значит, ведем следующее понятие. Ведем понятие ориентированного угла. Значит,
ориентированным углом между двумя векторами a и b мы будем называть такое число, модуль которого
совпадает с величной угла, которая образована, собственно, вот этими двумя векторочками. То есть,
у меня есть вектор a и b, соответственно, величина ориентированного угла между ними в
точности равна радианному значению углу между ними. Окей? Вот. Ну, плюс дополнительно ориентированный
угол будет обладать знаком. Так вот, что это за знак? Если поворот от первого вектора ко второму
отсущиляется против часовой стрелки, то будем считать, что такой поворот у нас будет положительным.
Против часовой. Да. Ну, правый и левый поворот. Если поворот осущитается против часовой стрелки,
то соответственно знак положительный.
То есть ориентированный угол между векторами A и B в данном случае он положительный.
А если взять ту же самую ситуацию, но посчитать ориентированный угол между B и A,
то соответственно ориентированный угол будет отрицательный.
То есть противчасовой положительный, повчасовой отрицательный.
Всё просто.
А для чего это нужно? Давайте подумаем.
Вот такая задача.
Давайте рассмотрим сразу применение, почему ориентированные углы – это хорошо,
почему мы не просто вводим понятие обычного угла и считаем всякие косинусы, синусы.
Вот, допустим, мне дано три вектора, a, b и c.
И что я про них знаю? Я знаю про них следующую вещь.
Я знаю ориентированный угол между векторами a и b и ориентированный угол между векторами b и c.
Соответственно, я хочу найти…
Давайте так, если вы чуть-чуть опаздываетесь, то, пожалуйста, приходите и садитесь потише, окей?
Вот, я хочу найти ориентированный угол между векторами a и c.
Вопрос – как я это могу сделать?
Ну, смотрите, если бы я не знал про понятие ориентированный угла…
Если бы я не знал про понятие ориентированный угла, что бы я сделал?
Ну, я бы, наверное, рассмотрел несколько случаев.
Вот, если у меня вектора… Я бы смотрел на взаимное расположение этих векторов.
Скажем, если у меня вот такая ситуация a, b и c, то, соответственно, как найти угол между a и c?
Ну, нужно взять вот этот угол, взять вот этот угол и просто просто их сложить.
Согласны?
Если у меня какая-нибудь вот такая ситуация, вот этот вот вектор a, вот этот вектор c,
вот этот вектор b, то, соответственно, что мне нужно было бы сделать?
Мне нужно было сначала взять вот этот угол a, b, который мне известен,
нужно было взять угол b, c, который мне тоже известен, и вычесть.
То есть не сложить, а вычесть один из другого.
Ну и, на самом деле, можно поиграться, рассмотреть еще какие-то другие ситуации,
в зависимости от расположения a, b и c.
То есть понимаете проблему, да?
То есть, чтобы вычислить угол между, скажем, векторами a и c,
мне нужно знать заимное расположение векторов a, b и c.
А если мне известны ориентированные углы, вот, как бы данная задача?
Чему равно значение ориентированного угла между векторами a и c?
Да, просто-напросто сумма, смотрите.
Действительно, значению ориентированного угла between a и c
просто-напросто сумма a-b плюс просто-напросто сумма.
То есть мне не нужно думать о том, нужно ли что-то вычитать, не нужно,
что-то вычитать, не нужно ли что-то вычитать. Вот, просто наоборот сумма
ориентированного угла между a и b и угла между b и c. Почему?
Давайте вот на примере вот этих двух ситуаций рассмотрим. Значит, как не найти
ориентированный угол между a и c? Ну, смотрите, я сначала беру ориентированный угол
между a и b, да, то есть вот он, дальше прибавляю к нему ориентированный угол b и c,
то есть оба этих угла отрицательные, соответственно, я получаю отрицательный
угол, то есть отрицательный поворот от акции. Все нормально. То же самое вот в
этой ситуации. Сначала я прибавляю, сначала я беру ориентированный угол от a до b,
вот он, потом прибавляю ориентированный угол от b до c, вот он, он идет в обратном
направлении, то есть это идет с минусом, это идет с плюсом и, соответственно, в
итоге я получаю вот значение вот этого угла. Понятно? Вот. Ну, правда, тут есть еще
одна небольшая деталь, то есть тут на самом деле, на самом деле может
получиться тогда, что у вас угол между a и b и b и c достаточно большой, что вы в
итоге перекрестнетесь через значение p. Скажем, если у вас, не знаю, представьте
угол c, он, не знаю, вот как-то вот так вот выглядит, да. Соответственно, вы складываете
угол между a и b, b и c, вот и получаете вот такой вот угол. Соответственно,
чтобы вот из вот такого угла перейти, на самом деле, к вот этому, ну нужно просто
вычесть из полученного значения 2p, ну или прибавить 2p. Вот. Вот такая история. Понятно?
Окей. Значит, сориентированный углом разобрались. Значит, продолжаем поднимать планку и теперь
поговорим про скалярное произведение. Значит, внезапно скалярное произведение
векторов i и b, мы будем называть вот такую вот чиселку. Произведение модуля вектора a на
модуль вектора b на кости нас угла между ними. Причем не важно, вы берете обычный угол по модуле
либо ориентированный угол, то есть кость у нас функция четная, все равно. Значит, чем хорошо
скалярное произведение? Скалярное произведение хорошо тем, что, смотрите, как бы вот я все это
время сказал, что вот мы работаем с столчисленными координатами, то есть у нас все значения целые,
поэтому все будем вычислять абсолютно точно. Но как бы если посмотреть на эту формулу, то кажется,
что что-то идет не так. Почему? Потому что я вычисляю модуль Вектора. Модуль Вектора даже
столчисленными координатами вообще говоря не обязаны являться целым числом, strict
говоря даже рациональным числом. Тоже самое касается b. И абсолютно то же самое касается
Косиниса. Но что мы знаем про скалярное произведение? Про скалярное произведение мы знаем,
что оно еще дополнительно представимо вот в таком виде. Это просто произведение x координат
обоих векторов, плюс произведение y координат обоих векторов. Какой мы вывод из этого делаем?
Скалярное произведение двух векторов с целочистыми координатами тоже всегда является целым числом.
То есть мы имеем полное право использовать скалярное произведение для наших дальнейших вычислений, для наших дальнейших алгоритмов.
Какие еще свойства есть хорошие у скалярного произведения, которым мы будем пользоваться?
Первое, наверное, самое главное – то, что скалярное произведение позволяет определить, лежат ли концы и векторов в одной полуплоскости, образованы перпендикулярно к одному из векторов.
Грубо говоря, одинаковы ли направлены вектора или нет?
Если я возьму два таких вектора, то они смотрят в одну сторону.
Если я проведу перпендикуляр, скажем, к этому вектору, то они будут располагаться в одной полуплоскости.
А если я возьму вот такой вектор и вот такой вектор, то угол между ними как бы смотрят по разные стороны.
И, соответственно, по знаку скалярного произведения можно понять, они в целом смотрят в одну полуплоскость или смотрят в разные полуплоскости.
Ну так, на интуитивном уровне.
И, соответственно, как я сказал, скалярное произведение векторов с толчительными координатами всегда является целым числом.
Еще одно определение – косое или векторное произведение.
Векторное произведение имеет в виду, что, скажем, если мы работаем на плоскости, если мы живем в двухмерном мире с координатами x, y, то, в принципе,
мы знаем, что векторное произведение – это все-таки вектор, но если мы берем произведение двух векторов, которые расположены на плоскости,
то нам достаточно всего лишь взять проекцию на координату z.
Соответственно, будем отрежисслять векторное произведение с проекцией на вот эту самую третью мнимую координату.
Косым или вектором произведения векторов i и v будет называться следующее число.
Модуль вектора A на модуль вектора B на синус угла между ними.
Соответственно, тут ровно та же самая история.
Казалось бы, модуль вектора A, модуль вектора B и синус угла между ними – это сугубо не рациональные числа.
Но тем не менее мы знаем, что проекция на ось z векторного произведения вычисляется вот таким образом.
То есть это A x на B y минус A y на B x.
Так как все координаты вектора предполагаются числачисленными, то и косое или векторное произведение мы можем посчитать абсолютно точно.
Без всяких приближений, если мы не переполним целые числа, то мы его знаем вполне однозначно.
Для чего нам понадобится косое произведение?
Я сказал, что в скалярном произведении мы можем определять, в какую сторону смотрят все векторы.
А с помощью косого произведения мы сможем понять, как ориентирован угол междуaffen ί и Β.
Пят минут назад мы поговорили про ориентированный угол, про его знак.
К косое произведении будет говорить о знаке этого самого поворота.
если косоя произведение положительная, то соответственно поворот положительный.
Если косоя произведения отрицательная, то и поворот будет отрицательным.
Ну и соответственно последнее тоже самое.
Тут пока никакой шокирующей информации не было, надеюсь.
Замечательно.
Следующее понятие тоже важно. Это ориентированная площадь.
Короче говоря, если я возьму просто-напросто косоя произведения векторов A и B,
то таким образом я получу ориентированную площадь параллограмма, построенного на этих двух векторах.
Скажем, вот у меня есть два вектора, я достраиваю их до параллограмма.
Это не очень получилось.
Соответственно, если я возьму косоя произведения векторов, которые образуют мне этот параллограмм,
то такое значение я буду называть ориентированной площадью этого параллограмма.
Я думаю, вы понимаете, что знак вот этой самой ориентированной площади
будет сильно зависеть от того, в каком порядке вы перемножаете два вектора.
Но при решении задачи у нас будет однозначно всегда, в каком порядке мы перемножаем.
Ну и соответственно половинная площадь параллограмма, точнее половина от вот этого значения,
будет являться соответственно ориентированной площадью треугольника, образованной вот этими двумя векторами.
Договорились.
Вроде с определениями более-менее все.
Давайте решим еще одну задачу.
Я ввел понятие ориентированной площади параллограмма,
ввел понятие ориентированной площади треугольника.
Давайте поднимем планку и обсудим ориентированную площадь многоугольника.
Задача такая. Вот вам дан некоторый произвольный многоугольник.
Как нам задается многоугольник? Ну просто напросто некоторым набором точек.
И соответственно дается задача посчитать его площадь.
Причем, как мы уже сказали, нужно площадь данного наугольника найти абсолютно точно.
Прямо с абсолютной точностью.
Давайте как раз этот вопрос и обсудим.
Смотрите.
Давайте я возьму произвольный прелограмм с столочисленными вершинами,
которые расположены в столочисленных координатах.
Верно ли, что я площадь такого многоугольника могу найти абсолютно точно?
Почему?
Ну потому что это просто наоборот косовое произведение.
Мы с вами сказали, что косовое произведение считается в целых числах тоже абсолютно точно.
А про треугольник такое можно сказать?
Смотрите, я про что.
То есть площадь прелограмма, построенного на векторах I и B, вычисляется как косовое произведение.
В то же время, если я задамся вопросом, как мне найти площадь треугольника,
то площадь треугольника нужно будет разделить на 2.
В итоге в правой части я получу вроде как не целое число.
У меня справа будет стоять какое-то целое число, которое я поделю напополам.
Но в то же время площадь треугольника я всегда знаю наверняка абсолютно точно.
Потому что это либо целое число, либо полу целое число.
Вот этот дополнительный 0,5 никакой погрешности не вносит.
Потому что 0,5 и есть 0,5.
Поэтому здесь никакой проблемы нет.
Грубо говоря, вы всегда можете хранить не просто площадь треугольника,
а можете хранить удвоенную площадь треугольника.
Вы от этого никакой информации не теряете.
Это вот то, что я хотел прокомментировать.
То есть на самом деле кажется, что мы умеем находить абсолютно точно площадь прелограмма,
без всяких погрешностей находить площадь треугольника.
И, наверное, кажется, что и площадь многоугольника произвольного мы тоже можем найти абсолютно точно.
Остается лишь один вопрос. Как? Есть какие-нибудь предложения?
Разбитые треугольники. Есть такой подход.
Грубо говоря, мы берем какую-нибудь точку внутри многоугольника
и как-нибудь таким образом разбиваем его на треугольники и считаем эти площадь.
В принципе, так поступать можно.
Но проблема в том, что в такой ситуации вам нужно найти какую-нибудь точку,
которая расположена внутри многоугольника.
Вообще говоря, не обязательно внутри многоугольника содержится хотя бы одна целая точка.
Поэтому план хороший, часто работает, но как бы есть несколько проблем.
Я предлагаю поступить немного иначе.
Да, я предлагаю на самом деле не привязываться к самому многоугольнику.
Нам даже вычитать ничего не придется.
Моя идея вот такая.
Давайте я возьму абсолютно произвольную точку.
Ну, не знаю, на обум.
Ткну вот здесь.
Не обязательно она лежит в этом многоугольнике и так далее.
И сделаю следующую вещь.
Давайте я проведу векторочки из этой точки в вершина.
Проведу векторочки.
И просто возьму и посчитаю ориентированные площади последовательных векторов.
То есть посчитаю площадь вот такого треугольника.
Посчитаю площадь вот такого треугольника.
Посчитаю площадь вот такого треугольника.
Ну и так далее, причем буду считать не просто площадь, а ориентированную площадь.
Почему это хорошо? Почему, если я сложу все ориентированные площади, у меня получится все окей?
Ну потому что, смотрите, когда я иду по часовой стрелке, у меня площади вычитаются, площади идут с отрицательным знаком.
То есть вроде как кажется, что я вот эти вот площади, вот эти вот, которые расположены где-то вот здесь, я учитываю по несколько раз.
Но в то же время эти же самые площади, вот эти вот самые маленькие, я буду вычитать, грубо говоря, брать с обратным знаком при движении в обратном направлении.
Например, когда буду считать площадь вот этого треугольника, буду считать площадь вот этого треугольника и так далее.
То есть при обходе в обратном направлении, я тоже буду считать в площади вот этих треугольников.
Вот этo вот этo.
Но при этом брать их, буду с обратным знаком. Окей?
И соответственно получается так, что когда я обхожу в одном направлении, я высчитываю площадь вот этой фигуры, а когда я иду в обратном направлении, я высчитываю уже площадь вот такой вот фигуры.
И соответственно у меня всё, что остаётся, это вот эта часть. Окей?
Потому что при движении почтовой стрелки у меня все эти площади будут идти с одним знаком
При движении в обратном направлении у меня эти площади будут идти с обратным знаком
И поэтому они взаимно уничтожатся
Груг говоря, идея вот такая
Есть произвольная фигура, я просто заметаю вектором
просто иду вектором вдоль контура этой фигуры
в одном направлении у меня, грубо говоря, площадь прибавляется, когда я иду в обратном направлении, лишняя часть напроса-напросто вычитается.
Таким образом я могу посчитать площадь абсолютно произвольного многоугольника,
используя всего лишь понятие ориентированной площади, без всякого разбиения самой фигуры на треугольники и так далее.
Нет, мы считаем, что все многоугольники простые.
Да, многоугольники простые, без самопересечений и так далее.
Да, не-не, вот именно по контуру, да.
Ну, смотрите, давайте делать разумное предположение, что, все-таки, если вам дано множество вершин,
то они вот в этом массиве или векторе, они как-то упорядочно все-таки.
Ну, это разумно, да, все-таки странно предполагать, что вам в многоугольнике даны какие-то произвольные вершины.
Ну, на самом деле, давайте так говорить, что если вам даны просто вершины в произвольном порядке,
то их можно упорядочить некоторым способом, о котором мы поговорим в следующий раз.
Ну, грубо говоря, выпукло оболочку построить и все.
Значит, как строить выпукло оболочки, мы будем говорить в следующий раз.
Пока предполагаем, что просто нам вот порядок задан, ну, скажем, либо по числовой стрелке,
порядок обхода многоугольника задан либо по числовой стрелке, либо против числовой стрелки, не важно.
Да, ну и соответственно, главный вопрос-то, в чем состоит?
Ну, смотрите, вроде как определить с пролограммом, да, у пролограмма всегда целая площадь,
у треугольника всегда либо целая, либо полу целая площадь.
А что сказать про произвольный многоугольник? Верно ли, что для него тоже всегда площадь вычисляется абсолютно точно?
Ну да, из того, что мы площадь треугольника складываем из ориентированных площадей треугольников,
sci separate offendings из этого следует, что площадь любого многоугольника, построенного на целочисленных координатах,
тоже всегда является либо целым, либо полу целым числом. Поэтому площадь любого многоугольника, абсолютно произвольного,
мы можем вычислить с абсолютной точностью.
У вас есть задача в контесте посчитать площадь многоугольника.
Там ответ проверяется именно с абсолютной точностью,
без каких-либо погрешностей.
Даже если вы дадите какой-нибудь ответ,
типа 6, 4, 9, 9, 9, 9, 9, 9 и так далее,
это не будет считаться правильным ответом.
Только 6,5.
Тут все понятно, да?
Следующий примитив, который мы рассмотрим,
будет линия.
Давайте линии считать просто на геометрическое место по точке,
которое удовлетворяет вот такому уравнению.
При этом считаем, что a квадрат плюс b квадрат больше 0,
то есть a и b одновременно не равны 0.
Просто воспользуемся этим определением, чтобы было проще.
И вообще говоря, когда мы будем говорить про линию,
мы будем считать, что мы линию представляем именно вот в таком виде.
Тут, наверное, стоит напомнить, откуда берется вот эта вот штука,
точнее, интерпретацию этих самых коэффициентов,
a, b и c, что они означают, что из них можно вытащить.
Интерпретация довольно простая.
Если вы возьмете просто произвольную прямую
и, скажем, какую-нибудь фиксированную точку на ней,
возьмете такой-нибудь произвольный вектор,
который перпендикулярен на этой самой прямой,
то любая точка на этой прямой,
которая задана радиус-вектором p,
будет удовлетворять следующему соотношению.
Вот эта вот самая направляющая,
если вы возьмете p и вычисляете по 0,
то, естественно, этот вектор будет идти параллельно этой самой прямой,
и, соответственно, из этого следует, что скалярное произведение
вот этого направляющего вектора, который образован разностью p и по 0,
он будет, естественно, перпендикулярен n,
то есть будет давать нам 0 в скалярном произведении.
И, соответственно, если мы просто раскроем скобки и так далее,
то получим вот такое вот уравнение.
То есть если p задается координатами x, y,
вы скалярно умножаете x, y на координаты n,
ну и, собственно, отсюда следует, что вот эти коэффициенты a, b,
в принципе, можно интерпретировать как координаты нормального вектора,
вот этого самого.
Ну а вот этот коэффициент c как раз таки есть скалярное произведение
этой точки по 0 и нормального вектора n,
ну, со знаком минус.
То есть вот эти коэффициенты a и b, на самом деле, не что иное,
но это просто напоминание.
Думаю, это все известно.
Так, ну и давайте разберем несколько задач на линию.
Ну, первый простой вопрос.
Вот мы поняли, что у нас есть нормальный вектор к прямой,
и, соответственно, у него есть нормальный вектор к прямой.
Ну, в случае, если у вас прямая задана вот таким вот уравнением.
Вопрос. Как найти какой-нибудь направляющий вектор?
Ну, то есть вектор, который параллелен данной прямой?
Ну, давайте не по-моему, давайте, вот,
хорошо, как можно подобрать вот этот вот самый вектор?
Из каких соображений?
Ну, на самом деле, достаточно всего лишь сказать,
что этот вектор, он должен давать скалярном произведении с n значение 0.
То есть если я возьму вот этот вектор и скалярно онножу на n,
то должно получить значение 0.
Почему? Потому что параллелищий вектор, он строго перпендикулярен нормальному вектору.
Ну, вектору нормальный.
Ну, отсюда следует, что, например, в качестве V можно спокойно взять,
ну, там не знаю, что-то типа B-A.
Потому что я умножаю B на A, а потом −A на B.
Соответственно, естественно, получится 0.
Ну, вот, например, вот так.
Первый вопрос довольно тривиально, довольно прост.
Ну, если у вас есть нормальный вектор,
то, конечно, у вас есть нормальный вектор,
но если у вас есть нормальный вектор,
то Italian yes makes absolutely0.
Ну, вот.
Соответственно, вторая задача,
даны точки P1 и P2 и прямая L, скажем,
прямая L, и какие-то точки P1 и P2.
Модуль issuing у нас будет неvy器,
аhour mittlerweile максимально.
в этом случае я должен сказать да, то есть они находятся в одной полуплоскости
скажем, если я возьму точку P2 вот здесь
давайте P2 штрих, то соответственно находятся
по разной стороны от этой прямой
вопрос?
как определить?
тут вам надо подобрать какую-нибудь точку на этой прямой
а потом любую, даже так
мне то, что там предлагали, больше нравится
давайте просто возьмем координаты
координаты вот этой точки
x1, x, y1
и здесь, значит, x2, y2
и просто-напросто вот эти значения
подставим в уравнение прямой
а x плюс b, y плюс c
ну не в уравнение, а просто вот в это выражение
если мы вернемся к интерпретации вот этого выражения
то что мы увидим?
мы увидим, что вот это выражение
на самом деле эквивалентно вот такому выражению
это просто координаты точки умножены нормально
минус P0 умножить на n
то есть что мы знаем?
для всех точек, которые расположены на этой прямой
вот это значение равно 0
а теперь смотрите
фокус
ну у меня вектор нормаля куда-то направлен
то есть если я возьму какую-нибудь точку вот отсюда
то, куда направлен вектор нормаля
то, соответственно, у меня значение будет больше 0
согласны?
вот, то есть вот это значение будет больше 0
для полуплоскости 1
с другой стороны, обратная ситуация верна и для нолья
и для нолья
и для нолья
с другой стороны, обратная ситуация верна и для вот этой полуплоскости
то есть если я возьму вектор какой-нибудь, который
ведет вот сюда
то, соответственно, вот этот вектор и вот этот вектор
они будут противоположно направлены
грубо говоря, опять же, относительно этой прямой
соответственно, скалярное произведение будет давать
ну не скалярное произведение, а значение вот этого выражения
будет давать значение меньше 0
это понятная история?
вот, соответственно, мне достаточно подставить
значение координата вот в это выражение
и соответственно, посмотреть на знак
если эти знаки различаются
то значит, мы находимся по разной стороны от прямой
если эти знаки совпадают
то соответственно, я получаю тот факт, что
значение находиться по одну сторону
от данной прямой
соответственно, если значение выражения равно 0
то что это означает?
да, значит, что какая-то точка расположена непосредственно
на прямой, ну все, отлично
то есть вот мне нужно подбирать некие дополнительные точки
Я просто подставляю координаты этих точек в мое выражение и, соответственно, отсюда сразу делаю нужные выводы.
Снова заметьте, что мне не пришлось прибегать даже не то что иррационально, а просто какой-нибудь дробной арифметики.
Не пришлось ничего делить, не вычислять какие углы и так далее.
Все происходит абсолютно точно, просто-напросто за счет подстановки целочисленных координатов в выражение с целочисленными коэффициентами.
Все задачи мы решаем пока абсолютно точно. Все понятно, да?
Еще одна задача, связанная с прямыми, это параллельность прямых.
Вот, собственно, то, с чего мы начинали лекцию.
Даны две прямые, заданы уравнениями a1, b1, y.
Нужно определить параллельно эти прямые или нет.
Что будем делать?
Да, да.
На самом деле можно, действительно, смотрите, что можно сделать.
Ну, детерминат, можно посчитать детерминат, но как-то такое.
Давайте сведем задачу к тому, что мы уже умеем делать.
Мы умеем получать просто-напросто направляющие вектора.
То есть мы знаем, что у нас есть какой-то направляющий вектор у первой прямой, есть какой-то вектор направляющий у второй прямой.
Умеем ли мы проверять параллельность двух векторов?
Да, просто-напросто с помощью косового произведения. Ну, по сути, косовый произведение – это и есть детерминат, грубо говоря.
То есть мы умеем проверять параллельность двух векторов.
Но, соответственно, параллельность двух векторов соответствует параллельности прямых, к которым они принадлежат.
Все, соответственно, получать направляющие вектора мы умеем.
Это что? Это минус b1 минус a1 и b2 минус a2.
Да, в целом, кстати, можно и нормальные взять.
То есть можно просто взять нормальный вектор a1, нормальный вектор a2, то есть без вот этих вот приколов.
То есть просто взять вот эти вот значения и проверить параллельность.
Если у вас прямые параллели, то, соответственно, нормальные векторы, естественно, тоже они параллельны.
То есть все гораздо проще.
Ну да, прямые параллели тогда и только тогда, когда параллельные направляющие векторы,
параллельные нормали, соответственно, свое произведение нормальный равно нулю.
Понятно, да?
Снова опять же возвращаемся к вопросу, который мы поставили изначально.
Не нужно искать точку пересечения, не нужно искать решения какого-то там уравнения.
Просто-напросто, абсолютно честно, в целочисленных координатах, в целых значениях,
вычитываем вот это произведение, вычитываем вот это произведение, и все.
Сразу получаем однозначный ответ, то есть либо да, либо нет, то есть либо параллельно, либо не параллельно.
Вот.
Окей.
Так, следующий примитив.
Это луч.
Ну, короче, не знаю, ничего у меня не придумал.
Просто луч – это вот такое множество точек.
Здесь есть некоторое начало,
здесь есть некоторый направляющий вектор, то есть вот начало луча,
есть некоторый направляющий вектор, и, соответственно, просто-напросто это геометрическое место точек,
которые удовлетворяют этому выражению при t больше рамок нуля.
Вот.
Луч. Окей.
Давайте пообсуждаем, что можно поделать интересного с лучом.
Ну, вот первая снова классическая сдача.
Есть точка P, и нужно проверить,
принадлежит ли точка P лучу R.
Начало.
Направляющий вектор.
И, соответственно, какая-то точка…
какая-то точка P.
Ну, или P-штрих, который расположен на луче.
А еще есть ситуация, когда у вас точка лежит на продолжении луча.
Два штриха.
Два условия. Какие?
Ну, смотрите, чтобы понять, принадлежит ли точка прямой или нет.
Ну, какие у нас есть для этого инструменты?
Ну, вроде как, как мы до этого обсудили, что достаточно поставить точку…
координат точки по уравнению прямой, и, соответственно, все получить.
Тут у нас нет.
Тут у нас нет.
Тут у нас нет.
Тут у нас нет.
Тут у нас нет.
Тут у нас нет.
Значит, уравнение прямой…
то есть мы его можем получить.
Но хочется как-то без этого обойтись, то есть пока просто какими-то простыми инструментами.
Но идея, в принципе, действительно верная.
Во-первых, мы хотим что проверить?
Вот мы хотим, во-первых, оттечь вот такой вот случай.
Да, то есть...
Давайте возьмем вектор OP и скалярно умножим на направляющий вектор V.
И мы хотим, чтобы это произведение, которое мы высчитываем с абсолютной точностью, было больше равно 0.
Таким образом, мы отсекаем все эти случаи, когда у нас точка лежит на продолжении этого луча.
Отлично. А теперь как мне отличить вот эту ситуацию от этой ситуации?
Давайте возьмем вектор импровидения. Чего с чем?
Тоже самое, вектор импровидения OP и V.
И что с ним должно быть?
Оно должно быть просто равно 0.
Действительно, если у меня вектора коллинеарные, то соответственно все хорошо.
В принципе, вот два условия. Как раз-таки берем два наших произведения.
И соответственно с помощью них снова абсолютно точно понимаем, принадлежит ли точка лучу или нет.
Бежим дальше.
Расстояние от точки до луча.
Тут надо сделать дисклеймер.
Естественно, высчитывать абсолютно точную расстоянию у нас не получится.
Единственная задача, которую мы будем рассматривать, в которой у нас не получится добиться абсолютной точки, это задача расстояния.
Если у вас есть две целочисленные точки, то расстояние между ними, вообще говоря, даже рациональным числом не обязано являться.
Поэтому, соответственно...
Вообще говоря, можно сказать про то, что...
Ладно, нельзя сказать.
В общем, будем искать расстояние.
Просто каким-нибудь образом.
Каким-нибудь хорошим образом.
То есть, мне дан луч.
Задан он направляющим вектором.
Задан он начальной точкой O.
И дана какая-то точка P.
То есть, нужно найти расстояние от этой точки до множества точек, которые образуют луч.
Что делать?
А для чего?
Вот, отлично. Да, действительно.
Смотрите, очень легко сказать, что расстояние от точки P до соответствующего луча, это просто настояние от точки до прямой.
Расстояние от точки до прямой я не обсуждал, но, в принципе, я думаю, все с формулой знакомы.
Подставляем точку формулу, и дальше делим на корень квадратный.
В любом курсе по аналичить геометрию это проходит, поэтому на это забьем.
Действительно, смотрите, вот если у нас вот такая ситуация довольно простая, давайте я снова ограничу полуплоскость.
Вот если у нас вот такая простая ситуация, то, в принципе, просто нам достаточно найти расстояние от точки P до вот этой прямой.
Согласна.
Кстати, давайте обсудим, а как найти вот это расстояние, если нам не задано уравнение прямой.
Если вам задано уравнение прямой, то там все просто. А если уравнение прямой не задано, то что делать?
Так, а что будем делать через вектор произведения?
Вектор на В на УП. Это мы что таким образом нашли?
Таким образом мы нашли площадь вот такого прелограмма.
Ну, надо вы не обязательно, нам достаточно просто разделить на что?
Ну, видимо, на модуль В, да?
Вот, ну почему? Потому что альтернативно, то есть понятно вот это вот, то, что написано сверху, это площадь вот этого красного прелограмма.
Альтернативно, площадь прелограмма можно найти просто как высота, вот она, умноженная на вот эту вот сторону.
А эта сторона имеет длину модуль В. Согласны?
Ну, тут модуль можно поставить.
Вот, окей. Значит, первая ситуация.
Ну и вторая ситуация, как правильно сказали, она происходит тогда, когда мне точка П находится вот здесь.
Вот если у меня точка П находится здесь, то естественно неверно искать расстояние от нее до вот этой прямой.
Потому что тут нет никакой точки, которая принадлежит лучу.
Поэтому тут просто-напросто чему равно расстояние от П до луча?
Просто-напросто модуль ПО.
Тут мне нужно просто найти длину отрезка, ну точнее длину вектора ПО.
Отрезков у нас пока нет.
Ну вот и все.
Да, рассматриваем два случая.
То есть если у меня вектор ОП и В находится в одной полуплоскости, то соответственно вычисляем вот по этой формуле.
То есть по формуле, которая написана вот здесь.
Если у меня обратная ситуация, то есть если у меня точка П находится вот в этой полуплоскости, то соответственно я вычисляю просто длину вектора ОП.
Вот.
Такие дела.
Ну все, перерыв.
Очередной примитив.
Это отрезок.
Вот иллюстрация.
Ну отрезок это просто наоборот часть прямой, ограниченная точками.
То есть любой отрезок просто представляем в виде памяти компьютера, в виде двух точек.
Все.
Не знаю, что еще комментировать.
Вот.
Давайте снова, давайте тут тоже поразбираем всякие вопросы, связанные с отрезком.
Первая задача простая.
Этот отрезок АВ.
Почка П.
Либо такая П, либо вот.
Здесь нужно понять, принадлежит ли точка П отрезку АВ, либо нет.
Например.
Давайте возьмем луч АВ и возьмем луч БА.
Соответственно, если точка П принадлежит и лучу АВ, и лучу БА, то эта точка принадлежит отрезку.
В принципе вариант.
Давайте что-нибудь попроще придумаем.
Ну чем, например, вот эта вот точка П отличается вот этой точкой П штрих?
Она лежит на прямой, да, например.
Ну, например, я могу взять вот такую еще точку.
Она лежит на продолжении.
Что?
Ну, смотрите, посчитать, ну, посмотреть на неравенство треугольника и так далее,
посчитать расстояние, это все, ну, это как бы путь в никуда,
потому что мы, как мы сказали, расстояния считаются не очень точно.
Какую прямую?
Ну, смотрите, снова расстояние.
Если вы считаете расстояние, то снова вам скорее всего, скорее всего,
находится работать с веществной арифметикой.
Ну, а как бы вещественной арифметике, ахрен поймешь, там ноль или не ноль, ну, как бы.
Но при этом она может быть и ноль, если нет.
Потому что, ну, если у вас есть точка, которая вот, ну, представьте себе, что у вас
какая-то, ну, я хотел сказать, длинная прямая, ну, как бы,
у вас, ну, представьте себе, что у вас у прямой какие-то, ну, не знаю, какие-нибудь большие координаты, да,
координаты А, Б и С большие.
Соответственно, у вас получается, что когда вы подставляете в уравнении прямой, вы тоже получаете довольно большое число.
И, соответственно, когда вы переходите к арифметике с даблами, то, я надеюсь, я ни для кого не открою тайну,
что дабл, вообще говоря, не все целые числа умеют представлять.
Если у вас есть какое-то очень большое целое число, то там тоже начинаются приколы с погрешностью.
То есть на больших целых числах дабл тоже дает неточное значение с некоторой точностью.
Соответственно, когда вы будете переводить целые числа в дабл, то, соответственно, у вас при переведении целого числа в дабл возникает погрешность.
Дальше вы там делите дабл на какой-нибудь другой дабл тоже с погрешностью, и получаете там, соответственно, какую-то бяку.
Поэтому расстояние мне не нравится, но, собственно, по этой причине.
Давайте снова сведем что-нибудь к произведениям.
Так. Да, нормально.
Ну, можно по-разному. То есть кажется, что можно обойтись действительно, или нельзя.
Ну, короче, план такой. Давайте рассмотрим.
План такой. Давайте рассмотрим вектор АП штрих и П штрих Б.
Что можно сказать про эти вектора, если точка лежит на отрезке АБ?
Ну, они просто-напросто параллельно одинаково направлены. Со-направлены, согласны?
И вот на самом деле со-направленность вот этих векторов просто-напросто является критерием принадлежности точек в отрезку.
Потому что если я возьму вот эту точку, то, естественно, вектор АП никак не со-направлен с вектором ПБ.
Если я возьму какую-нибудь точку на продолжение прямой, то у меня вектора будут противонаправлены.
Поэтому у меня вектора АП и ПБ со-направлены в том и только в том случае, когда точка П принадлежит отрезку АБ.
Ну вот давайте ровно этим воспользуемся. То есть просто-напросто сведем снова к двум произведениям.
К произведению, к одному косом произведению и одному скалярному произведению.
Как я проверяю со-направленность? Ну, во-первых, я проверяю, что они параллельны.
То есть с помощью косового произведения векторов АП и ПБ и проверяю, что они одинаково направлены.
То есть просто-направленность смотрю, что у меня скалярное произведение тоже больше чем равном нуля.
То есть эта параллельность – это, грубо говоря, то, что мы смотрим в одну сторону.
Два произведения и сразу получаем ответ.
Без вычислений расстояний и всего подобного.
Скалярное произведение вычисляется в целых числах абсолютно точно.
Векторное произведение и косовое произведение тоже вычисляются абсолютно точно в целых координатах.
Окей? Все.
Хорошо.
Да, ну соответственно, вот еще одна задача, связанная с расстоянием.
Тут можно уже поиграться.
Значит, данный отрез АКБ и дана точка П.
Нужно найти расстояние от точки П до отреза АКБ.
Что будем делать?
Дана отреза АКБ, дана точка П. Нужно найти расстояние от точки до отрезка.
Как площадь треугольной?
Видимо, как-то вот так, да?
Нет, как длину веокрафт свою точно мы, конечно, не можем.
Хорошо, предположение первое. Давайте действительно посмотрим на вот такой треугольник.
Площадь треугольника мы считать умеем, вроде как абсолютно точно.
Длину отрезка мы тоже вычислить можем, пусть и не абсолютно точно.
Но взяв площадь этого треугольника, разделив на длину отрезка, мы получим вот это расстояние.
Все согласны?
План-то хороший, но работает, к сожалению, не как швейцарский часы.
Если точка П находится где-то в этой области, давайте я сразу назову ее областью 3,
то действительно мы вычисляем именно так.
Но начинаются приколы, что если точка П находится где-то вот здесь, или точка П находится где-то вот здесь.
Что в этом случае делаем?
Ну если здесь, то просто вот такое расстояние, если здесь, то вот такое расстояние.
Ну и контрольный вопрос, а как понять, точка П находится здесь?
Ну это я так нарисовал, только у меня отрезок же вот такой еще может быть.
Ну и эти самые могут быть перепут.
То есть тогда мне нужно рассматривать такие вот штуки.
На что смотрим? На знак колярного произведения? Ну да.
Ну вот берем точку А, проводим АП, проводим АВ.
То есть то, что мы говорили, скалярное произведение меньше нуля в том случае,
если относительно перепутигуляра, проведенного к одному из векторов, оно не находится по разной стороны.
Ну вот соответственно тут такая же ситуация. То же самое касается точки В.
То есть на самом деле рассматриваем три случая.
Первый, если АП умножить на АВ меньше или равно нуля, то есть точка П находится где-то вот здесь,
то соответственно мы считаем просто расстояние от точки А до точки П, длину вектора АП.
То же самое касается вот второй случаи. Если у меня точка П находится здесь, как мы это определяем?
Берем вектор ВП, берем вектор ВА.
Если они находятся по разные стороны от этого перепутигуляра, то значит, что мы находимся в этой области.
Соответственно расстояние от В до П вычисляем просто как модуль вектора ВП.
Ну и третья ситуация. Если не вот это и не вот это, то значит мы находимся где-то вот здесь.
А это, собственно, хорошая ситуация. То есть просто находим расстояние от точки П до прямой АВ.
На самом деле простая задача. Давайте обсудим.
Сейчас вот то, что мы до этого рассматривали. Всякие лучи, прямые.
Сейчас будем все это совмещать. Теперь у меня дана прямая и отрезок.
Мне нужно понять, пересекает ли отрезок ПК прямую Л.
Ну, собственно, да, тут в общем-то нечего обсуждать.
Эту задачу мы уже решали. По сути, эта задача просто сводится к тому, лежат ли две точки по одной сторону от прямой или нет.
TransformAware…
Ну, сама логика понятна, да? По одну сторону или по разные стороны.
Все. Хорошо.
Во, отлично. Да, перчение, отрезка и луча. Вот тут сейчас поговорим.
Куда на отрезок АВ?
АВ. И луч. Давайте вот.
Нужно понять, пересекает ли отрезок данный луч.
На самом деле задача действительно, наверное, сложная.
Вот с какой точки зрения. Потому что тут, к сожалению,
просто так свести к задаче прямой не получится.
Более того, эта задача усложняется тем, что, скажем,
давайте я возьму, например, не вот эту точку А, а возьму точку h3 где-то вот здесь.
И сделаю вот так. То есть, казалось бы,
вот эта точка и вот эта точка h3, они, в принципе, очень похожи,
они расположены по другую сторону относительно перпендикуляра,
но в одном случае пересечение есть, в другом случае пересечения нет.
Как различать эти ситуации, сходу, на самом деле, не очень понятно.
То есть, тут можно поставить двумя вариантами, двумя способами,
как бы какие-то векторочки, посмотреть, что тут как бы такой
неразвернутый угол, тут более-менее развернутый угол,
и просто с этой точки зрения. Мне больше, если честно, нравится
такой аналитический подход. Давайте его обсудим.
Давайте его обсудим. Смотрите, вот у меня есть отрезок А,
и есть луч. Давайте запишем уравнение луча
и уравнение произвольной точки на отрезке.
То есть, уравнение луча выглядит в следующем образом.
Есть точка О. Давайте я буду так писать. С координатом точки О я прибавляю
направляющий вектор В, умноженный на какое-то число Т.
Соответственно, это уравнение луча. Уравнение отрезка выглядит
примерно вот так. У меня есть А, к которому я добавляю альфа, умноженный
на вектор АВ. При этом у меня
больше брави нуля, а альфа принадлежит от нуля до единицы.
Соответственно, у меня отрезок пересекает луч
в том только том случае, если у меня есть решение вот такого уравнения
для некоторого Т и для некоторого альфа, который удовлетворяет в следующем соотношении.
Согласны?
Давайте сделаем вот что.
Давайте проверим, что действительно вот такой альфа теоретически может существовать.
Как мы это сделаем?
Скажем, как убедиться в том, что у меня действительно существует некоторое альфа,
пока давайте не смотреть на вот это ограничение, что у меня существует некоторое альфа,
которое удовлетворяет вот этому соотношению. Согласны ли вы, что первым делом
можно просто проверить, что АВ пересекает прямую,
на которой лежит луч. Согласны?
Если у меня отрезок пересекает прямую, на которой лежит луч, то соответственно альфа у меня гарантирована от нуля до единицы.
Я это проверил, следует, альфа принадлежит от нуля до единицы. Отлично.
Соответственно, это условие я могу пока забить.
Давайте порассуждаем дальше. Давайте я вот эту А перенесу в левую часть.
Я получу вектор АО плюс ВТ равно альфа на АВ.
Я сейчас хочу избавиться от альфы.
Давайте я просто возьму и косым произведением домножу на вектор АВ.
Что я получу? Я получу косое произведение АО и АВ
плюс косое произведение В на АВ.
Т равно нулю.
Отсюда мне надо проверить второй шаг.
Проверить, что существует Т больше равное нуля, который удовлетворяет этому соотношению.
При каком условии у меня найдется такое Т?
Такое происходит, если эта штука и эта штука положительные, то ничего не получится.
Если они обе отрицательные, то тоже ничего не получится.
А получится это может только в том случае, если эта штука отрицательная, а эта положительная.
Все, то есть такое происходит, если вот такое произведение, давайте так умножить на,
давайте не умножить, а просто скажем вот это и вот это,
разных знаков. Вот и все. То есть по сути, идейно-идейно задача сводится к тому, чтобы
просто посмотреть на вот эти вот два произведения, векторных или косых, и посмотреть разных знаков,
они или нет. Понятно? Тут есть еще один нюанс, который заключается в том, что,
смотрите, вот это произведение, теоретически, может быть равно нулю, и тогда я, в принципе,
информацию, что если у меня вот эта штука равна нулю и вот эта штука равна нулю, в каком случае
это происходит? Вот если они обе равны нулю, то что это означает? В каком случае у меня эти обе
штуки могут быть равны нулю? Да, если отрезок лежит на прямой, вот как-то вот так, то, соответственно,
и вот эта штука равна нулю, и вот эта штука равна нулю, и в принципе я такого вывода сделать не
могу, потому что у меня, возможно, либо такая ситуация, либо, например, вот такая ситуация,
ну там, не знаю, вот такая ситуация. Ну то есть понятно, да? Вот в этом случае нужно,
ну то есть это еще один особый случай, нужно просто проверить, принадлежит ли хотя бы одна из точек
лучу или нет. Все, окей? То есть вот есть вот такой частный случай, давайте отдельно пропишем,
1, 2, 3. Если оба произведения равны нулю, то проверяем принадлежность A или B лучу.
Вот, в принципе все. Понятно, да, что сделали? Вот рассмотрели такое равенство и, значит,
сказали, что пересечение есть только в случае, если у меня существует t больше либо равная нуля и
существует альфа, которая принадлежит 0.1, при котором эта равенство достигается. Значит, вот это
условие мы проверяем первым пунктом, вот это условие мы проверяем вторым пунктом. Если второе
условие таким способом проверять, проверить не получится, да, то есть если вот это и вот это 0,
то соответственно остается вот третий, ну третий особый случай. Все, окей? Ну вот. Ну да.
То есть снова как бы, снова вопрос принадлежности, вопрос принадлежности, ну точнее вопрос
по существовании пересечения сводится всего лишь к вычислению каких-то там произведений,, да, то есть
либо скалярных либо косых. Все. То есть опять же никаких приближений и так далее мы не делаем, то есть
мы либо однозначно говорим, что пересечение есть, либо однозначно говорим, что пересечения нет.
Но то есть никаких как бы приближенных методов и так далее вычлений и расстояний мы не производим, окей?
Хорошо. Да, пересечение отрезков. Рассмотрели пересечение отрезка и луча. Теперь давайте
возьмем два отрезка и попробуем их попересекать. А b? cb. Как понять пересекаются два отрезка или нет?
Ну да, действительно. Ну действительно, смотрите, кажется, что в каком случае у меня отрезки
ab и cd пересекаются. Но только в том и том случае, если у меня c и d лежат по разной
стороны от прямой ab и то же самое для точек ab, они лежат по разной стороны от cd. Вот тут,
например, это не выполняется. Или, скажем, давайте более сложный случай. Вот так. То есть a и b
лежат по разной стороны от прямой cd, но не наоборот. То есть точки c и d не лежат по разной
стороны от прямой ab. Это работает, но не всегда. В каком случае этот способ зафейлится?
Ну нет, если точка лежит на отрезке, то как бы это мы тоже можем дектировать. То есть,
если точка лежит на, то есть принадлежность точки отрезку, в принципе, мы тоже умеем проверять.
В этом какой-то особой беды нет. Давайте вот в общем случае. Один вложим в другой. Ну,
в принципе, давайте более общий случай. Что если у меня оба отрезка лежат на одной прямой? Давайте
так скажем. Есть ab, есть cd. Вот, например, в таком случае у меня все векторные произведения скажут,
что ноль. То есть, если я попробую знать, то есть у меня и точка a и точка b лежит на прямой cd,
и то же самое, кстати, с точки cd, и точка c и точка d лежит на прямой ab. Но при этом могу ли я
вот на основании этого сделать вывод, пересекаются отрезки или нет? Ну, естественно, нет,
потому что у меня может быть еще вот такая ситуация. Например, ab и тут cd. Ну, например,
такая, да. Ну, еще может быть такое, что, скажем, сначала идет точка a, потом идет точка c. Ну,
короче, куча ситуаций возможно. То есть, в первой ситуации у меня отрезки не пересекаются,
во второй и третьей ситуации отрезки пересекаются. Но при этом все векторные произведения мне дают
ноль, соответственно, ничего я сказать не могу. Что в этом случае будем делать?
Ну да, в этом случае можно просто проверить для каждой точки, ну, на самом деле достаточно
всего лишь для трех точек, проверить принадлежит ли какая-то точка не прямой отрезку или нет. Все.
То есть, тут тоже есть особый случай. Ну вот, рассматриваем два случая. То есть, если отрезка
ab пересекает прямую cd и cd пересекает прямую ab, то пересечение есть. То есть, как это проверяется,
ну просто-напросто считаем четыре векторных произведения. То есть, смотрим, верно ли, что вот
эта вот пара и вот эта вот пара имеют разные знаки. Но если все вот эти четыре векторных произведения
равны нулю, то мы как раз таки попадаем вот в эту ситуацию, при которой мы ничего сказать не можем.
Ну, соответственно, это особый случай, мы его рассматриваем отдельно, просто-напросто проверяем,
лежит ли концы отрезков, лежит ли какой-то из концов отрезков в другом отрезке.
То есть, верно ли, что у нас вот такая или вот такая ситуация?
Так, ну и наконец, отлично, да, наконец, многоугольник.
Ну, значит, про многоугольник мы уже сказали, да, что многоугольник это просто, ну, по-первых,
многоугольник это замкнутое лом, ломанное, не знаю, мне было лень придумывать что-то, какое-то определение,
вот. Значит, вот просто у нас есть многоугольник, который сдается последовательностью вершин.
Ну, давайте опять же считать, что вершины заданы, ну, в порядке некоторого обхода, да,
либо по часовой стрелке, либо против часовой стрелки. Ну, как бы считаем, что как бы все приведено
к нормальному виду. Вот, да, многоугольник простой, без самопересечений, да.
Да, ну и ключевая задача, которая нам... Вообще говоря про многоугольники,
мы будем говорить в следующий раз много, то есть будем говорить про выпуклость,
про как построить выпуклое оболочку. То есть, что если не упорядоченные вершины многоугольника.
Ну, или вообще как выделить, скажем, минимальное количество вершин,
которая будет образовывать многоугольник, который содержит все остальные точки,
то есть задача выпукла оболочки. Но сегодня давайте просто рассмотрим вот такую вот
нетривиальную задачу. Давайте сначала обсудим более простую задачу.
Скажем, вам дан многоугольник, вам дана точка. Нужно просто понять, принадлежит ли точка
границам многоугольника. Всем ли понятно, решается такая задача.
Лежит ли точка на границе многоугольника.
Просто взять все стороны многоугольника и проверить, принадлежит ли точка данному отрезку.
Проверять принадлежность точку отрезку мы умеем, поэтому и задачу принадлежности точки границы
многоугольника тоже решать умеем. А тут другая задача.
Дан некоторый многоугольник. Абсолютно может быть не выпуклый.
И соответственно нужно определить, принадлежит ли точка многоугольника или нет.
Точнее, лежит ли она внутри многоугольника, принадлежит ли она внутрь многоугольника или нет.
Интересно. Сами додумались.
Ну да, в принципе, тут физики в основном. Теоремы Гаутса проходили уже?
Кстати, доказать теоремы Гаутса, скорее всего, вы пользовались тем фактом,
что мы пускаем какую-нибудь произвольную трубку, и соответственно мы говорим,
что если у нас есть какая-то замкнутая поверхность, то сколько раз мы ее пересекаем,
то есть если мы ее пересекаем четное число раз, то в принципе мы находимся вне нее.
Если мы пересекаем нечетное число раз, то это значит, что мы находимся внутри этой самой поверхности,
и соответственно, условный заряд вносит свой вклад в поток.
Но это для физиков было. В общем, история на самом деле действительно очень простая.
Вот на примере произвольной фигуры. Возьму какую-нибудь такую фигуру.
Давайте возьму точку.
И действительно давайте из этой точки, которая меня интересует, пушу луч в произвольном направлении.
Например, в горизонтальном направлении. Пускаю луч.
Я считаю количество пересечений вот этого луча со сторонами многоугольника или произвольной фигуры.
О чем мне скажет это количество? Как на основе этого количества я могу утверждать,
принадлежит ли оно внутренности или не принадлежит?
Да, смотри, действительно, если у меня количество пересечений нечетно, то это значит, что я нахожусь внутри.
Почему? Потому что как только я впервые пересекаю границу, это значит, я выхожу из моей фигуры.
Если я второй раз пересекаю границу, то значит, я снова захожу внутрь фигуры.
И вот так, соответственно, вхожу-выхожу, вхожу-выхожу.
Если я в итоге набрал нечетное количество пересечений, то это значит, что я в итоге вышел из фигуры.
А если, скажем, я возьму точку. Давайте вот тут. Возьму вот эту точку и пущу вот такой вот луч.
То я сначала вошел в фигуру, потом вышел из фигуры.
Соответственно, баланс счетный, соответственно, у меня точка находится вне фигуры.
Вот такая вот идея.
Вот, вот, да. Тут начинаются приколы.
Отлично. Это еще не решение, это идея решения.
Идея решения такая. Пустим луч из точки в произвольном направлении, будем считать количество сторон, которые он пересечет.
Если их четное число, то точка находится снаружи, иначе внутри.
Какие проблемы есть у этого подхода?
Касание, например, да. Ну, давайте вот тут вот.
Точка, я пускаю луч, и вот тут у меня касание.
Смотрите, вроде как число пересечения нечетное.
Наоборот, четное, да, вот.
Но при этом точка находится внутри. То есть вот это вот касательное, она меня все испортила.
Ну, сейчас, секунду. В терминах многоугольника это что означает?
Это означает, что я прошел через вершину.
То есть вот я взял и так вот прошел по вот этим вот пикам.
Что вы хотели сказать?
Смотрите, чтобы понять, нужно ее считать или нет, нужно определить, принадлежит она фигуре или нет.
Мы как раз хотим определить, принадлежит она фигуре или нет.
Просто не будем считать.
Контр-пример.
Смотрите, возьму вот такую фигуру.
Да, возьму вот такую фигуру.
Вы предлагаете не считать. Не считаем.
Беру вот эту точку. Не считаем.
Две разные ситуации, но при этом и там, и там ноль.
Как бы вот не считать не получается.
Это другая ситуация.
Хорошо, давайте сначала это обсудим.
Если луч проходит через сторону, то вот тут можно ничего не считать.
Тут все нормально.
Давайте еще раз повторю.
Значит, если луч проходит через сторону, то вот такую ситуацию можно в принципе не считать.
То есть можно не считать ее пересечение.
Давайте вот с этим, с более сложной ситуацией разберемся.
И так будем перевернуть лучи, пока у нас все не сойдется.
Ну, в принципе нет.
В принципе есть способ, когда нужно взять просто хороший луч.
Нет, можно придумать прям хороший луч, который гарантированно не пройдет.
Но это второй способ.
Ну, это снова не факт.
Ну, снова берем середину.
То есть вы не угадаете, пройдете вы через вершину или нет.
Значит, трюк на самом деле следующий.
Вроде как не совсем очевидный, но...
Потом как поймете.
Да, ну, собственно вот проблема.
То есть у вас вот эта ситуация.
Тогда вы вроде как не должны учитывать.
С другой стороны у вас может быть вот такая ситуация.
Тогда вы это пересечение, естественно, должны учитывать.
Потому что вы либо вошли, либо вышли из фигуры.
И, возможно, плюс ситуация, когда вы просто-напросто проходитесь вдоль стороны.
Ну, значит, ну треть про треть ситуацию мы уже поговорили.
Что ее можно в принципе не учитывать.
Ну, потому что как бы...
Ну, по-моему, у вас может быть такая ситуация.
Ну, потому что как бы...
Ну, если подумать, то это на самом деле ни на что не влияет.
То есть если вы были внутри фигуры, то вы так внутри фигуры остаетесь.
Если вы были снаружи фигуры, то вы тоже так снаружи фигуры остаетесь.
Вопрос в том, что делать вот с такими ситуациями.
Значит, трюк на самом деле довольно элегантный и простой.
Смотрите.
Давайте делать так.
Вот допустим, как мы работаем.
Вот у нас есть луч.
Ну, на самом деле мы просто-напросто перебираем стороны.
То есть давайте я проговорю алгоритм, как мы действуем.
Мы пускаем произвольный луч.
И дальше в цикле перебираем все стороны.
И смотрим, пересек ли наш луч нашу сторону.
И давайте делать следующую вещь.
Если оказалось, что луч пересекает нашу сторону в нижней точке.
В нижней точке.
Ну, нижняя точка – это точка, у которой меньше y-координата.
То такое вхождение мы…
То такое пересечение мы считать не будем.
Ну, давайте предполагаем, что горизонтально.
Хотя, в принципе, неважно.
То есть если я попадаю в вершину,
и эта вершина является нижним концом
моей стороны, которую я сейчас рассматриваю,
то вот это пересечение я не учитываю.
А если точка, через которую я прохожу,
является верхним концом моей стороны,
то ее я учитываю.
Понятно?
Смотрите, к чему это приводит.
Возможно, такая ситуация.
Когда я пересекаю точку, которая является верхней точкой
тогда я к моему щечку добавлю плюс два.
Плюс два не изменяет четность.
Опять же, повторюсь, что для определения,
лежит ли точка внутри фигуры или снаружи,
мне достаточно посмотреть всего лишь на четность.
Так вот, когда я пройду через эту точку,
у меня баланс изменится на плюс два.
То есть баланс четости вообще не поменяется.
Вам нужно просто посмотреть, что эта точка
смежна для двух сторон, для которых она является верхней.
Проще просто щечку увеличить.
Я к этому и говорю, что в данной ситуации,
если вы действуете по этому способу,
то четность у вас в любом случае не меняется.
Если я прошел вот таким касанием,
то действительно у меня ситуация не поменялась.
Если у меня эта точка изначально была внутри многоугольника,
то я так внутри многоугольника и остался.
Если я был снаружи, то я так снаружи и остался.
Давайте третья ситуация.
Если я прокажу по точке, которая является нижней
для двух смежных сторон,
тогда в этом случае я нижние точки не считаю,
то есть не для первой стороны, не для второй.
И соответственно баланс у меня плюс ноль.
Снова четность не изменилась.
То есть то, что мне нужно.
Четность меняется только в одной ситуации,
когда вот эта точка для одной стороны является нижней точкой,
а для второй стороны верхней точкой.
Вот только в этом случае я ее учитываю для изменения четности.
Делаю плюс один.
Здесь, соответственно, просто плюс ноль. Тут автоматически получится плюс ноль, если вы пускаете горизонтальный луч, то, соответственно, если у вас сторона лежит на луче, то, соответственно, ни эта, ни эта точка не является верхней, поэтому вы эти обе точки можете либо одновременно учитывать, либо одновременно не учитывать, ну, вообще неважно.
То есть вот такой вот трюк.
Давайте просто напосчитать, что если у вас отрезок принадлежит лучу, то есть если у вас отрезок параллелен лучу, то мы просто его не учитываем.
Нет, просто вот сам отрезок, который лежит на луче, мы его не рассматриваем.
Ну, типа.
Вот. Ну, это значит первый способ, как можно обходить вот эту ситуацию.
Ну, мне кажется, наверное, он наиболее актуальный.
Есть второй способ, 2b, который как раз в ту сторону, про которую вы говорили, что давайте подберем какой-нибудь хороший луч.
Ну, то есть можно как бы выбирать различные направления лучей и смотреть, что мы никогда не попадаем на вершину.
А можно как бы, а можно сразу взять вот следующий луч.
Ну, вот пусть у меня дана точка x, y, собственно, для которой мне нужно определить...
Давайте вот точка x, y, для которой мне нужно определить, принадлежит ли она фигуре или нет.
Давайте я сделаю следующий трюк.
Давайте я возьму точку, которая очень сильно удалена от моей фигуры.
Ну, скажем, не очень сильно, а просто которая гарантированно лежит вне фигуры.
Ну, условно давайте я назову, что эта точка имеет координаты бесконечности y плюс 1.
И рассмотрю, и рассмотрю луч, который идет из точки O вот в эту точку.
Ну, как-то такой себе луч.
Так вот, я утверждаю, что вот этот луч гарантированно не пройдет по вершине.
Понятно ли почему, как бы там написано, понятно ли идейно почему.
Да, ну потому что смотрите, у вас как бы вот расстояние по вертикали между этой и этой точкой равно 1.
То есть вот тут вот, вот тут вот, в этой полосе у вас гарантированно нет точек с численными координатами.
Ну а поэтому я гарантированно, у меня вот этот луч гарантированно не пройдет в никакой вершине.
Все, и соответственно никаких проблем с прохождением через вершину у вас вообще нет.
Вот и все.
Единственный недостаток у этого метода заключается в том, что непонятно как подбирать эту бесконечность.
Понятно, что в качестве бесконечности можно взять точку, которая гарантированно лежит правее вот этой вот фигуры.
Да, но проблема может заключаться в том, что вот это вот значение может быть достаточно большим, что у вас там возникали различные переполнения.
Поэтому тут тоже надо быть аккуратным, тут надо за этим следить.
Но в принципе метод рабочий, который позволяет в принципе не рассматривать никакие, скажем так, частные случаи.
Понятно?
Ну, у меня все на этом. Дальше плюсы.
Все.
