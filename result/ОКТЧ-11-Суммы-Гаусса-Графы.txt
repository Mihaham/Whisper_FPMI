Так, всё, давайте начинать. Добрый день. Что у нас там
было? Гауссовская сумма, да? Ну давайте я ещё раз
напишу. А, кстати, я не отчертил слепую зону,
но она не то, чтобы очень важна. Народу мало. Я думаю,
что все сидят так, как нужно, чтоб всё видеть. Так, сумма
Гауса. Значит, ещё раз. У нас есть число Ку, есть число
А. Эти два числа взаимно простые, но Ку при этом не
обязательно простой. То есть это какое-то просто
число, может быть, чётное, нечётное. Любое натуральное
число. А, тоже любое натуральное число, которое с ним взаимно
просто. Нас интересует такая вот сумма. Сейчас, а почему
она от Х? Она просто С. По Х сейчас будет суммирование.
Да, печатка. Так. Ну, если я надавлю, то, наверное,
будет хорошо видно. Да, всё равно, такой вот сумме
по Х от единицы до Ку не в степени 2П, а Х квадрат
поделить на Ку. Ну, в прошлый раз я вроде пытался это
максимально замотивировать. У нас был критерий Вейля
равномерной распределённости последовательности. Ну
и, соответственно, в этом критерии возникали подобные
суммы с линейным членом, так сказать, с линейным
выражением в показателе экспоненты. Ну, а естественным
обобщением, конечно, служат какой-то многочлен, не обязательно
первой степени. И вот то, что я утверждаю и продолжаю
утверждать, это значит, что для квадратичного многочлена
посчитать такую штуку ещё можно, а уже для многочлена
какой-либо большей степени, ну, к сожалению, это, в общем,
задача нерешаемая, хотя очень важна, и люди этим
прямо занимаются. Эта целая большая наука называется
теория тригонометрических сумм. Такой вот раздел теории
чисел. Но вот суммы Гауса посчитаны, мы посчитаем
только модуль, как уже было заявлено в прошлый раз,
но если хотите найти точное значение, можете взять,
например, книжку Коробова, «Трик суммы», и там это всё
написано. Вот для интересующихся напишу книжку. Николай Михайлович
Корбов такой был специалист. Называется тригонометрические
суммы. Вдруг кому-то интересно разобраться глубже, там
много всего, и про произвольные многочлены тоже. Так, ну,
я вроде писал даже утверждение теоремы. Я его, правда, благополучно
опять забыл. Поэтому давайте сделаем так всё-таки. Вдруг
я ошибся в этом утверждении? Давайте посчитаем модуль
этой суммы вместе, а потом у нас появится формулировка.
Ну или, если хотите, можете мне напомнить, как я её
формулировал в прошлый раз, но я совершенно не уверен,
что я нигде не ошибся. Там два случая – кучотная, куничотная,
что вы сейчас увидите, почему. Ну и в чётном случае
там надо ещё разбирать, какой остаток отделения
на 4. Разберёмся сейчас. В общем, давайте я пока многоточие
поставлю, хотим посчитать модуль суммы. Давайте напишем
модуль S. Ну, не просто модуль S, а удобно модуль S возвести
в квадрат. Это же комплексное число. Соответственно, модуль
комплексного числа – это просто корень из суммы
квадратов, там его вот этих вот составляющих. Но можно
написать вот так. Это S с чертой умножить на S, поэтому
удобно считать квадрат модуля. Так, все знают, что квадрат
модуля комплексного числа – это произведение сопряжённого
на само исходное число. Ну просто в прошлый раз меня
немножко кокнуло в тот момент, когда оказалось, что якобы
E в степени 2P всегда лежит на окружности, поэтому равно
единице. Вомните, мы это дело обсуждали, я там целую
окружность нарисовал, но разобрались, поэтому я
уж на всякий случай спрашиваю, вдруг что не так. Ну давайте
как-нибудь вот так напишем по Y от единицы до Q. Это для
S с чертой я пишу сумму. Значит, E в степени минус 2P, АY квадрат
поделить над Q. Я написал S с чертой. Сопряжение у
экспонента E в степени 2P – это E в степени минус 2P.
Тоже понятно, да? Косинус плюс синус, косинус минус
плюс, ну как вот, сопряжение. Так, и дальше это надо умножить
на сумму по X от единицы до Q. Прощаемся к исходному
обозначению, я вот так по разному переменную назвал,
чтобы удобно было. Так, здесь будет E в степени минус,
ой, нет, плюс, конечно, 2P, АY квадрат на Q. Вот сейчас
я сделаю некий ход, который тоже, может быть, потребует
рисования окружности для того, чтобы все было понятно.
Знаете, вот я уже в прошлый раз комментировал, что я
очень быстро иду по курсу, а может, не у вас комментировал,
не помню, у вас, да, что я быстро иду по курсу, потому
что здесь сидят люди, которые всему поддакивают, вроде
все понятно, а там сидят люди, ну кто их знает, кто-то
на X2 слушает, а кто-то ничего не понимает. Мне, конечно,
нормально, все, все, все понимают, хорошо. Ну, оттуда они не
ответят, спрашивают, не спрашивают, они ж не ответят. Вот они
ответят потом, в июне. Да все. В общем, переход нужно
сделать такой, нужно увязать вот эту сумму вот с этой,
надо сюда, давай тоже Y, сейчас мы сделаем такое хитрое
преобразование, у нас будет по-прежнему сумма по Y от
единицы до Q не в степени минус 2 pi АY квадрат на Q,
а вот тут давайте я скобку даже нарисую, сумма по X от
единицы до Q не в степени 2 pi А, и вот тут я напишу
X плюс Y в квадрате поделить на Q. Я вот сюда вместо X в
квадрате напишу X плюс Y в квадрате. Я утверждаю, что
от этого ничего не поменять. Вот в этом суммировании
ничего не поменяется. Дальше я потом переставлю порядки
суммирования, у меня Y квадрат сократится, но это мы чуть
позже сделаем. Сейчас пока вот нужно осознать, почему
ничего не происходит. Но вот я бы, конечно, пытался
надавить на понимание сразу, чем какие-то подробности
выписывать, но смотрите, вот как устроена вот эта
вот штука, когда на X пробегает от единицы до Q. Вот эти вот
выражения е в степень 2 pi АY квадрат поделить на
Q, они как стрелка часов пробегают по кругу. Ну
смотрите, при X равном Q вы снова получаете единицу,
как и при X равном нулю. То есть это как бы полный
период, полный круг мы пробегаем этими комплексными
экспонентами, мы пробегаем как стрелка часов полный
круг. Понятно говорю, нет? Вот если я X смещу на любое
число, неважно какое, от единицы до Q, то как пробегала
эта стрелка полный круг, так и будет пробегать, просто
со смещением стартовая позиция будет другая. Но круг пробежится
тот же самый. Поэтому какая была вот здесь сумма, такая
тут и останется. Я не знаю, нормально так? Мне кажется
нормально. Вот можно, конечно, подробно сейчас выписывать
всю эту сумму, но это как-то вот, вроде должно быть понятно.
Вот. Ну потом еще на X2, послушайте, все совсем хорошо
будет. Давайте переставим порядки суммирования. Внешне
сумму сделаю по X от единицы до Q. Так, что у меня зависит
от X? Что у меня зависит от X? Ну кажется только вот
это зависит от X, но оно еще и от Y зависит. Надо было
наверное сначала скобки раскрыть. Давайте я сначала
все-таки скобки раскрою, вот эти вот скобки, а потом
переставлю порядки суммирования, потому что иначе будет все-таки
трудно воспринимать. Сумма по Y от единицы до Q. Так, знаете
вот так, сумма по X единицы до Q. Здесь будет E в степени
minus 2 pi a y2 на Q плюс 2 pi, ну и тут ax2 плюс 2 axy
плюс y2. Так, ay2 конечно поделить на Q. Так, вот такая вот
зверская экспонента, но сейчас сократится, как я
обещал, у2. Это понятно, что вот это вот сокращается
вот с этим вот. Правильно? Ну это вроде понятно совсем.
Так, чего у нас остается? Вот теперь удобно переставлять
порядки суммирования, потому что понятно, что от X зависит
от Y. Сумма по X от единицы до Q. Тут будет E в степени
2 pi ax2 на Q. То есть я выписываю только то, что зависит от
X и не зависит от Y, после чего уже произвожу суммирование
по Y. От единицы до Q. А суммируются вот такие вот выражения
2 pi и тут будет 2 axy на Q. Ну вроде видно, как переставил
порядки. Тут ничего не должно вызывать трудностей, кажется.
Ну смотрите. Так, ну давайте думать, как считать такую
сумму. Эта сумма-то линейная. Но смотрите, сумма линейная
это либо геометрическая прогрессия, которую мы
в прошлый раз учились суммировать. Слушайте, но это геометрическая
прогрессия, суммирующаяся по полному периоду. Трудно
так воспринимать. Нужно писать прям сумму в явном
Я, смотрите, что хочу. Давайте я скажу, что я утверждаю.
Я утверждаю, что вот эта вот сумма, она равняется,
можно явно писать прямо, когда-то нулю, а когда-то
она равняется Q. Но вот когда она равняется Q, это совсем
очевидно. Значит, она равняется Q, если каждая экспонента
равняется единице, а экспонента равняется единице, если 2АХY
делится на Q. То есть ответ вот здесь получается Q, если Q
является делителем выражения 2АХY. И ноль иначе. Потому
что это суммирование по полному периоду. То есть вы
суммируете вот эту геометрическую прогрессию, у вас с одной
стороны экспонента берется в точке Q, а с другой стороны
она берется в точке 1. Вы получаете ноль. Нужно геометрическую
прогрессию суммировать или понятно, почему ноль
получается? Что? Что? 2АХ на что должно делиться? А, да, да, да, да, да, да. Конечно, это
правильно. Да, это я описался. Конечно, Y я нарисовал лишне. Извините, спасибо. Да, да,
видите, как хорошо. Что? Ну, понятно, что если 2АХ делится на Q, то получается Q.
Если 2АХ делится на Q, то вот это вот число при любом Y является целым.
E в степени 2P это единица. Правильно? Потому что это cos2P, sin2P это ноль, cos2P это...
Ну, понятно, в общем, это единица. E в степени 2P это факт, это единица. E в степени P это минус
единица, а E в степени 2P это единица. Вот это надо помнить. Поэтому если вы единицу возводите в
целую степень, у вас получается по-прежнему единица. И вот вы складываете Q штук единиц,
получили Q. Это если Q является делителем 2А. А если Q не является делителем 2А, если Q не
является делителем 2А, тогда это фактически сумма геометрической прогрессии. Ну, давайте
посчитаем сумму геометрической прогрессии, раз это вызывает вопрос. Значит, еще раз. Сумма по
Y от единицы до Q не в степени 2P. Как-то надо переобозначить, наверное, для краткости просто
кто-то такое сделать или не переобозначать. Ну ладно, давайте напишем честно 2Ах. Что здесь
является? Ну давайте первый член выпишем. Значит, первый член будет E в степени 2P и 2Ах на Q.
Это первый член при Y равном единице. И дальше мы суммируем геометрическую прогрессию. Значит,
что является ее знаменателем? Что у нас получается? Надо подставить Q сюда, да? Так, товарищи,
правильно? Надо подставить Q. То есть у нас будет, да, кто-то мне решил позвонить. Так, 2АхQ
на Q. Прям честно напишу. Так, что надо вычесть? Единицу, как обычно, так? А в знаменателе что
надо сделать? Надо взять из знаменателя вычесть единицу. В знаменателе я имею в виду геометрической
прогрессии. Какой тут знаменатель геометрической прогрессии? А? Что? Тоже, что и первый член,
правильно, да, 2Ах на Q минус 1. Ну прекрасно, смотрите, 2Ах на Q не делится. 2Ах на Q не делится
сейчас в нашей ситуации. Поэтому вот эта штука не равна единице, хотя, повторяю, модуль ее равен
единице. Она лежит на окружности, модуль этого вектора, длина его равна единице, но само число не один,
потому что 2Ах на Q не делится. Значит, в знаменателе стоит нечто, не равное нулю, а в числителе вот это Q
и вот это Q сокращается, и у нас получается ноль, потому что е в степени 2П и 2Ах это единица. Вот
я про это говорю, что полный период пробежали, поэтому тут и тут получается одно и то же. Все,
это ноль. Вот я обосновал, почему тут получается ноль. Когда геометрическая прогрессия ноль,
а когда прогрессии нет, просто сумма единицы получается Q. Вот, ну давайте, собственно,
думать. Вот сейчас тут равенство напишем. Чего у нас получается? Я вот так напишу. Если Q нечетно,
прямо как я и заявлял, что там отчетности и нечетности зависит. Если Q нечетно,
тогда 2К не играет никакой роли, А и Q взаимно просты по условию. А и Q взаимно просты. То есть,
вот это 2А и Q взаимно просты по-прежней. То есть, для того, чтобы Q делила вот это произведение,
нужно, чтобы Q делила х. Ну, Q является делителем х только в одном единственном случае, когда х
сравняется Q. То есть, у нас получается, что ответ вот такой, е в степени 2АQ2 на Q умножить на Q.
Q является делителем 2х только если х делится на Q. Единственным х, который делится на Q,
является число Q. Подставляем сюда число Q, а здесь получаем Q согласно тому, что вот тут
написано. В остальных случаях получаем нули. Нули суммируются в ноль. Ну, вот это вот. Это есть,
конечно, и имеется. То есть, мы получаем, что квадрат модуля нашей суммы, действительно,
равен Q, если Q нечетно. Ну, а сам модуль, естественно, равен корню из Q. Так,
я могу начать выкидывать. С равняется корень из Q, если Q нечетно. Это мы уже выяснили. Теперь
давайте пусть Q чётно. Тогда что у нас получается, если Q чётно? Тогда 2АХ делится на Q в двух
случаях. Если X равняется Q, и X равняется Q пополам. По-моему, очевидно. Q чётно? Q можно
разделить пополам. Ну, дальше делить бессмысленно. Значит, тогда у нас получается вот так. Давайте E в
степени 2ПИА, пусть Q квадрат, поделить на Q, умножить. На что же умножить? На Q, да?
Или не на Q? Так, если X равняется Q, да, то мы, естественно, умножаем на Q. Так, плюс. Пусть X
теперь равняется Q пополам. У нас получается E в степени 2ПИА, а Q квадрат на 4Q. Ну, и здесь
тоже будет Q. Так, все поняли, что произошло, да? Мы взяли два тех самых X, при которых внутренняя
сумма оказывается равной Q. При X равном Q получаем внешний со множества такой, при X равном Q пополам
внешний со множества такой. Так, чего у нас здесь получается? Здесь получается E в степени 2ПИА,
давайте перепишу. E в степени 2ПИА, Q. Это еще? Ать. Это равно Ать. Так, что мы получаем тут? Здесь
мы получаем E в степени 2ПИА, Q пополам. И вот тут вот как раз влияет какой остаток отделения на 4 у числа Q.
То есть опять у нас получается, давайте я тут напишу, что вот если Q имеет какой-то вид 4К,
например. Давайте, пусть Q имеет вид 4К, то есть делится не только на двойку, но еще и на четверку.
Тогда вот это E в степени 2ПИА, Q пополам. Это E в степени 2ПИА. Q равно 4К. Так, что-то я потерял.
Еще К. Все время какую-нибудь буковку я потеряю и лишнюю напишу. Вот если Q равняется 4К пополам,
делим, получаем 2К и 2ПИА. Вот оно сюда перекочевало. Это, конечно, единица. А если Q равняется 4К
плюс 2, то мы получаем, что E в степени 2ПИА, Q пополам. Это будет E в степени 2ПИА на 2К плюс 1.
То есть мы получаем минус единицу в нечетной степени. Понятно, почему в нечетной? Потому что А и Q
взаимно просты. Значит, А это нечетное число, ну а это, очевидно, нечетное число. То есть это минус единица,
и того вот прям вот сюда выписываем ответ. Ноль, как я и говорил в прошлый раз, если Q имеет вид
4К плюс 2, и корень из 2К, если Q равняется 4К. Все. По-моему, получилось. Минус единица,
просто вот тут происходит компенсация. С единицей сокращается, получается ноль. А если тут единица,
ну тогда они складываются и получается два. Такой вот замечательный результат. Ну просто вот хотелось
в этом месте с этим познакомиться. На самом деле мы дошли до конца той части курса, которая посвящена
вот именно сугубо комбинаторике теории чисел. То есть, начиная с какого-то момента, я в этом
месте стал читать кусок из дискретного анализа, причем такой достаточно поначалу стандартный,
который рассказывает про то, что такое граф. Ну понятно, что вы знаете, что такое граф. Какие-то
факты из теории графов базовые я успеваю доказать в этом тиместре. А дальше уже начинается мощный
дискретный анализ, в котором там всякие крутые штуки доказываются. Поэтому сейчас мы как бы
сверзнемся с небес на землю. У нас тут, видите, какая продвинутая техника и все такое. Я вам
напомню, что такое граф. Ну дальше докажу все-таки чего-нибудь относительно продвинутое, если не
прямо сейчас, так в следующий раз и после следующей тоже. Курс пока не закончился. Но это вот такой
кусочек базовой программы по графам сюда попал. Когда-то я в этом месте читал алгоритм проверки
на простоту невероятностной, а то, что называется, детерминированной. Ну великое достижение теории
чисел, которое было сделано еще в начале двухтысячных годов тремя авторами, Агорвалом, Каялом и Сапсеной.
Вот такая я с алгоритмом знаменитой. Но я понял, что большинство слушателей все-таки в конце первого
курса его не тянут. Поэтому я вытащил начало программы дискретного анализа, вот эта вот графа
там базовая, сюда, а Агорвала Каяла Сапсену читаю в конце второго курса. То есть это теперь кульминация
всей дискретной математики в моем исполнении. Вот ОКТЧ год, потом дискретный анализ год и в самом
конце я все-таки рассказываю вот эту вершину всех знаний, которые человек получает, когда хорошо
владеет и комбинаторикой, и теорией чисел, и алгеброй. Не тянут люди в конце первого года,
ровно потому, что еще не очень хорошо знают алгебру. А там начинаются какие-то алгебраические объекты,
какие-то хитрые группы, которые надо сравнивать, порядок их и так далее, в чем народ кокается.
Поэтому я сейчас подготовлю доску и буду рассказывать простые вещи поначалу, совсем простые.
Но вы не теряйтесь, потому что все-таки определение это нужно согласовать, они по-разному немножко
воспринимаются в разных курсах. Если мы не четко договоримся о том, что такое граф, как мы его
понимаем, то дальше никакую сложную теорему мы не докажем.
Так, ну смотрите, я буду исходить из того, что вы знаете, что такое граф, в принципе. То есть,
ну конечно, там и на алгоритмах они встречались, и по жизни вы должны знать, что это такое. Но мне
нужны разные определения типов графов, поэтому все-таки тут вот я буду употреблять какие-то
термины. Если вдруг что-то из них кажется непонятным, лучше переспросить. Я буду рассматривать
отдельно простые графы. По-русски еще принято говорить обыкновенный. Такая вот забавная история,
когда какая-то терминология сначала перекочевывает в английский язык, а потом возвращается назад.
И вот эти обыкновенные графы по-английски принято называть simple graphs. Соответственно,
когда вся литература переводится на английский язык, и люди начинают массово читать по-английски,
они уже по-русски употребляют термин «простой граф» вместо обыкновенного. Но вообще вот в
литературе русскоязычной раньше было общепринято говорить им на слово «обыкновен». Но сейчас уже все
говорят «простой». Простой граф — это тот, у которого нет ни петель, ни кратных ребер, ни ориентации.
Это понятно, что значит? У нас есть вот такая вот стандартная нотация. В — это множество вершин,
Е — это множество ребер. Ну и вот в случае, когда мы говорим о простом графе, можно так сказать,
что пара ХХ не принадлежит Е, то есть отсутствует петли. Мы считаем, что пара ХY и пара YX суть одной
тоже. То есть это неупорядоченные, неориентированные ребра, нет ориентации. Ну и Е — это под множество в два
в степени В, то есть у нас нет кратных ребер. Речь идет о том, что каждое ребро, если встречается,
то не более одного раза. Если я так пишу, то корректно задает мне именно простой граф каким-то
количеством вершин. Е — это под множество два в степени В, потому что два в степени В — это множество
всех под множество множества В, не обязательно двухэлементных. А Е — это некая совокупность этих
под множества, ну в данном случае, конечно, двухэлементов. Если они будут не двухэлементными,
такая штука называется гиперграфом, но это мы будем обсуждать уже в курсе дискретного анализа.
Вот пока у нас есть только графы двумя вершинами в каждом ребре. Так, ну смотрите, если мы разрешаем
ориентацию, если разрешить ориентацию, нужно разрешить по теории графов, который написал огромное
количество работ по этой науке и в частности написал книжку «Теория графов», которая, в общем,
в 60-е годы была таким прям вот, ну законодателем мод что ли. Вот если мы разрешаем петли, то говорим
про псевдографы, то есть приставочка псевда означает возможность наличия петель, то есть парсов
впадающих вершин в нашем графе. Значит, если мы разрешаем кратные ребра, то говорим про мультиграф,
я произнес тут слово гиперграф. Вот гиперграф — это не мультиграф, не надо путать. Мульти — это
когда некоторые ребра встречаются по несколько раз, но ребра при этом двухвершинные, обычные
графовые ребра. Гиперграф — это вот в следующем семестре я расскажу, но гиперграф — это когда
ребра не обязательно из двух вершин, а кратности там тоже нет вообще, говорят. Вот, ну и вот эти три
приставки — ор, псевд и мульти — можно комбинировать в любом порядке. То есть если мы разрешаем не что-то
одно, а сразу все три, то у нас получится псевд, мульти, ор, граф. Ну или там в каком порядке хотите,
в таком и говорите, тут я не вижу никакой унификации. Можно, конечно, сказать как-то иначе. Ну просто вот,
чтобы была общая терминология. Там какой-нибудь граф интернета, который я очень люблю, сам изучал,
много чего мы про него доказывали. Это вот как раз псевд, мульти, ор, граф. Вершины сайта,
ребра ссылки. Понятно, что между двумя сайтами может быть много кратных ссылок, идущих в одном
направлении может быть много и в другом тоже. Петли, когда одна страничка внутри сайта цитирует
другую. Конечно, могут быть очень монстрозные конструкции. Но в большинстве случаев, когда мы
с вами будем что-то обсуждать, мы будем говорить просто слово граф, подразумевая, что это простой
граф. То есть вот если я говорю, давайте рассмотрим граф там с множеством каких-то вершин и не ставлю
никакую больше к нему приставку, то это обычный простой граф. И в основном мы будем изучать их
свойства, потому что все остальное это уже легко накладывается на то, что изучено для простых графов.
Там есть всякая специфика, для ор графов есть продвинутая наука, но мы, как правило, в эти
дебри закапываться не будем. Хотя что-то может быть обсудимо для них отдельно. Вот граф – это
простой граф. Иначе нужна уже какая-то приставка. Ну, давайте я начну с каких-то простых вещей,
которые просто сформулирую, которые надо знать, но я уверен, что вы их и так знаете. Но если вы
мне скажете, что вы не способны их доказать самостоятельно и потребуете с меня доказательства,
я нетресно докажу. Просто какие-то базовые факты, но кажется, что скорее упражнения для людей уровня
нашего замечательного ФПМИ, нашей замечательной ФПМИ. Вот. Ну, чего лучше начать? Давайте, наверное,
начнем с деревьев. Важный класс графов составляют деревья. Но, опять же, если говорить в плане
терминологии, то понятно, что такое дерево, я думаю, все присутствующие, конечно, с ними сталкивались
неоднократно. Это то, что называется связные графы без циклов. Но, тем не менее, вот тут нельзя
проглатывать этот кусок. Я произнесу аккуратное определение, что такое цикл, что такое цепь или путь
в нашем контексте, чтобы тоже не было разночтений при доказательствах, потому что можно по-разному эти
вещи, вообще говоря, определять. Значит, давайте скажем, что маршрут в графе, просто я напомню
терминологию. Деревья, конечно, связные графы без циклов, да, но вот что такое связные, что значит
без циклов. Сейчас аккуратно скажу. Маршрут в графе, это такая вот чередующаяся последовательность
V1, E1, V2, E2 и так далее, V, скажем, N, E, N, VN плюс A1. Понятно, что имеется в виду, VIT это вершины,
EIT это ребра, и, конечно, предполагается, что каждое ребро EIT представляет собой пару VIT VI
плюс 1. То есть вот написано ребро, это вот его концы. Написано ребро, тут тоже его концы, написано
ребро, тут тоже его концы. Ну, то есть делается ровно то, что вы себе и представляете. Мы стартуем
из какой-то вершины, проходим по ребру, концом которого она служит, приходим во вторую вершину
конец этого ребра и дальше двигаемся. Но просто, чтобы вам было четко понятно, вот у вас вершины
какие-то V1, V2, вот это вот туда-сюда, туда-сюда, туда-сюда. Это тоже маршрут, согласно этому
определению. Никто не говорит, что вот в этой цепочке, в этой последовательности VEIT и разный,
и никто тем более не говорит, что все VEIT и разный. Можно ходить туда-сюда, или какое-то время ходить
туда-сюда, а потом двигаться дальше. Перепрыгивать нельзя, поэтому вот мы говорим, что концы ребра
это те вершины, которые в этой последовательности его обрамляют. Маршрут – это вот то, что мы можем
сделать, не отрывая руки, если рисовать картинку. Так, прекрасно, маршрут в графе определили. Давайте
скажем, что маршрут замкнутый. Если V1 равняется VN плюс 1, там как угодно ходили туда-сюда,
где-то потом переходили, вернулись и так далее. Но важно, что вот стартовая вершина и последняя
совпадают. Тогда маршрут замкнутый. Дайте я все чуть-чуть договорю, какой-то связанный кусок.
Маршрут замкнутый, если вершины совпадают. Если в замкнутом маршруте все ребра разные,
вот эти вот E1, E2, EN – все разные, то он называется циклом. А если все вершины разные,
ну тогда ребра автоматом разные, конечно. А если еще и все вершины разные, ну кроме первой и
последней, он замкнутый. Но если все остальные вершины разные, больше никакие две не повторяются,
то он называется простым циклом. Ну то есть обычный цикл, он может быть хитро как-то устроен. Как-то
вернулся в какую-то вершину, дальше как-то хитро пошел, еще как-то пошел. В общем, какая-то хитрая
штуковина может быть очень сложная, накрученная сама на себя. И это все называется циклом. Но
простой цикл – это для такой конструкции, для которой типичный портрет – просто многоугольник.
Так, ну я думаю, что все понятно. Смотрите,
последнее, чтобы уже связанный кусок завершить. Если маршрут не является замкнутым, то все то
же самое, что здесь написано, называется уже не циклом, а путем или цепью. Это синонимы – путь
и цепь. Соответственно, бывает цепь какая-нибудь вот такая дурацкая. Это тоже цепь. Она началась
здесь, пошла там как-то и вернулась в какую-то вершину. У нее все ребра разные, но это вот цепь,
несмотря на то, что она где-то тут зацепилась, внутри нее цикл появился. А простая цепь – это,
ну вот просто такая штука. Если ее вот так перевернуть, то можно называть такую штуку
бамбуковым. Бамбуковое дерево. Простая цепь. Все, пять минут перерыв, дальше продолжим. Ну ладно,
все, я формализовал, что такое маршрут цикл-цепь. Что такое дерево теперь точно понятно. Давайте
я сформулирую теорему, которую не планирую доказывать, потому что я думаю, что каждый ее
расценивает как простое упражнение, но повторяю, если нужно, что-то докажу. Теорема звучит так,
g, нет, давайте так, для графа g следующие четыре утверждения эквивалентны. Это определение дерева
сейчас в четырех вариантах будет, но это важно, потому что таким образом мы понимаем структуру
дерева максимально детально. Во-первых, g действительно дерево, то есть g вязаный и не
содержит циклов. Базовое определение. Во-вторых, для любых двух вершин этого графа существует и
притом единственная цепь, которая соединяет v и w. Каждые две вершины соединены единственной
цепью. Ну понятно, что эта цепь будет простой. Она единственная, то она, конечно, проста. Так,
третье g связан, ну, кстати, связанность я не определил, но это понятно. Графа между любыми
двумя вершинам хоть какой-то маршрут есть. Значит, g связан и, ну, давайте так скажем,
мощность e равняется мощность v-1. Количество ребер на единицу меньше, чем количество вершин.
Любого дерева, конечно, это так. И четвертое g ацикличен, то есть не содержит циклов и все
то же самое. То есть, сказать, что граф связан и у него n-1 ребро на n вершинах, то то же самое,
что сказать, что он не содержит циклов и у него n-1 ребро на n вершинах. Ну, я думаю, что для вас
совершенно все не новости, конечно, но вопрос в том, чтобы вы смогли равносильность по парну
этих утверждений доказывать, я надеюсь, вы понимаете, что я их специально выписал так,
чтобы мне, например, в случае чего было удобнее по циклу доказывать равносильность. То есть,
я не буду все шесть пар проверять, я из один выведу два, из два выведу три, двенадцать пар туда
обратно, из три выведу четыре, из четыре выведу один. По циклу выведу, получим по парную эквивалентность
этих утверждений. Ну как вам? Знакомы? Я думаю, да. Так, что я еще не сказал, ну вот связанность я все-таки
определил скользь. Понятно, что если граф связанным не является, то он распадается на компоненты.
Слово компонент, выражение компонент связанности знаете, да? Если вдруг не знаете, вот я его
произношу. Компоненты связанности, ну думаю, что знаете. Компоненты связанности. Можно сказать,
что это классы эквивалентных вершин, если считать, что две вершины эквивалентны,
коль скоро между ними есть какая-то цель. Отношение эквивалентности и, соответственно,
компоненты связанности это вот такие вот классы эквивалентных. Мы с вами можем говорить на таком
языке. Так, ну давайте еще слово степень вершины напомню, но это уж точно все, я думаю, знают. Значит,
есть вот такое вот обозначение от слова degree, степень вершины. Но это просто количество ребер,
концом которых эта вершина служит. Если перейти к орграфу, то там отдельно рассматривают входящую
степень и исходящую степень. Степень там тоже рассматривают, это просто сумма входящей и исходящей.
Это вот когда мы говорим про ориентированный граф. А петли всегда дают вклад 2-ка степень вершины.
То есть, если мы имеем дело с псевдографом, и там в какой-то вершине петля, то ребро-то одно,
а степень сразу увеличивается на двойку. Ну просто оно как бы и исходящее, и входящее вместе с тем.
Такое соглашение. Ну и, конечно, вы, я не сомневаюсь, понимаете, что если взять сумму степеней по всем
вершинам какого-то графа, то мы получим удвоенное количество его ребер. Но это полезное замечание,
которое надо как-то держать в голове, когда мы что-то теоретически доказываем.
Так, ну давайте я напомню еще один важный факт.
Я тоже уверен, все знают, но он уже будет шашком в сторону чего-то чуть более продвинутого.
А, нет, рано еще напоминать факт. Понял, чего я хочу сказать. Давайте еще задержимся на деревьях.
Нет, пока задержимся на деревьях. Чуть более продвинутым фактом даже о деревьях является вопрос
и ответ на него о том, сколько всего можно построить разных деревьев на N-вершинах.
Давайте я произведу опросу небольшой аудитории, которая присутствует очная, не называя формулу,
не произнося формулу, чтобы не опережать события. Поднимите, пожалуйста, просто руки те,
кто знает формулу для числа деревьев на N-вершинах.
Ну, даже в этой аудитории далеко не все. Меньшая, значимо меньшая часть. Ну, потерпите, что-то я вам
новое точно расскажу скоро, но, видимо, не сегодня уже. Ну, в следующий раз будет
нечто новое точно совершенно. Так, значит, давайте обозначим тест индекс МН, число деревьев на N-вершинах.
Но тут нужно оговориться, в каком смысле я имею в виду число. Я имею в виду, что два графа различные,
если у них различное множество ребер. То есть, это занумерованный граф, у нас вершины занумерованы,
у нас есть числа, скажем, один, два и так далее N, и вот это вот вершины нашего будущего дерева.
Все, они занумерованы. И нас интересует, каково количество деревьев, если вершины именно имеют
такие вот номера. То есть, например, вот такое вот дерево и вот такое вот дерево, казалось бы, одинаковые,
но мы их считаем разными, если у них разные вершины стоят в центре вот этого вот колесика.
Ну, дальше тут стоят какие-то один, два, четыре, тут неважно в каком порядке один, два, три,
но вот это разные графы, потому что у одного есть, скажем, какое ребро, один, четыре,
а у другого такого ребра нет. Это разные графы. Но я не думаю, что в этой аудитории я должен
кого-то убеждать в том, что они разные. Вы наверняка слышали выражение изоморфные графы,
они, безусловно, изоморфны. Точно слышали, кстати? Ну, то есть, видно, можно установить взаимно
однозначное соответствие биекцию между вершинами, при которой ребра переходят в ребра,
неребра переходят в неребра. Конечно, они изоморфны, это прямо по картинке видно,
но они разные, потому что вот сами ребра в них разные. Если это какой-то граф химических
соединений, например, или каких-нибудь дорог между городами, то, естественно, это разные графы,
по сути. У одного в центре углерода, у другого в центре водорода. Это разные графы. Так вот,
теорема. А, мы сейчас ее угадаем. Вот те, кто не знает формулу. Почему я просил не называть
формулу? Потому что я хочу, чтобы вы ее угадали. Те, кто эту формулу еще не знает,
давайте мы сейчас ее вместе угадаем. Померяем IQ. Ну, хорошо, t1, это понятно, это 1. И, в общем,
давайте считать, что это какая-то выделенная ситуация. Ну, сколько деревьев на одной вершине?
Одно. Семечка. Ну, одна вершинка. Семечка такая. Зародыш дерева. Сколько деревьев на двух вершинах?
Ну, тоже одно. Просто ребро. На двух вершинах одно, единственное, ребро можно построить,
если зафиксированы эти вершины. Неважно, в каком порядке их нумеровать. А t3, ну, как бы чуть
интереснее, t3, это структурно, с точностью доизоморфизма, это, конечно, всегда бамбук. На трех
вершинах бывают только цепи. Сколько цепей? Разных. На трех вершин. Ну, три. Две? Три. Так,
три, конечно. Ну, важно, что стоит в центре, а по краям уже неважно. В центре единица, двойка или
тройка. Так, давайте посчитаем t4. Ну, если кто-то надеялся увидеть число фибоначчи, то он уже
видит, что ошибся. Потому что после 1, 1 обычно идет 2, а не 3. Пошло 3. Знаете, t4, это вот как раз
частный случай дерева на четырех вершинах. Таких четыре штуки. Вот этих вот звездочек,
что ли, как их назвать, таких трилистников. Таких четыре штуки. Ну, и бывают еще бамбуки для
t4. Структурно, больше никаких классов изоморфных деревьев нету. Вот. Сколько бамбуков
на четырех вершинах? Ну, слушайте, ну, 24 пополам. Четыре факториал, и неважно в какую сторону читать.
Двенадцать. Того шестнадцать. Ну, в принципе, информации не очень много, но если люди не знали,
формулу сейчас угадают, ну, значит очень хорошо. Вот вы на это особо не смотрите, хотя оно тоже
подойдет под формулу 1, 3, 16. Надо продолжить последовательно, что будет t5. Трудно догадаться.
Если не знать, то догадаться трудно. Никто не может из незнавших догадаться, но это трудно. Да.
Вот это вот надо воспринимать так. Это 1 в нулевой, это 3 в первый, а это 4 в квадрате. Ну, я хочу
сказать, что t5 это 125. Да? n в степени n-2. Да, да, вот теорема, которую я хотел написать,
сейчас напишу. n в степени n-2. Это классический результат, который называется формула Келли.
Ну, потому что Келли, видимо, один из первых, кто эту формулу установил. Я небольшой историк науки,
я, честно, не берусь утверждать, что формулу Келли придумал именно Келли. Я точно знаю,
что эту формулу передоказывали порядка сотни раз. Ну, потому что она действительно очень важна
для самых разных наук, а интернета не было, и люди публиковались, конечно, где-то, но друг о друге
не знали. И вот если Келли, например, установил эту формулу в каком-то, кажется, 1857 году,
если я не путаю, то передоказательства появлялись вплоть до 30-х годов 20 века,
ну а дальше люди все-таки поняли, что есть такая формула и передоказывать стали исключительно ради
искусства. Я не помню, но есть прям целая литература на тему этих сотен доказательств того,
как устроена эта формула Келли. Сам Келли мотивировался, кстати, именно химии, то есть он
интересовался подсчетом числа парафиновых деревьев. Там всякие формулы, которые представляют
собой такие вот, как рыбьи-скелеты, что-то такое классы деревьев с определенными степенями вершин.
Ну, в частности, посчитал, сколько всего есть деревьев на n вершинах. Ну а в разных других науках
возникали другие соображения. Значит, доказательства я все-таки здесь приведу, но в виде такой
относительно короткой схемы, в которой надо будет немножко додумать самостоятельно. Если вы будете
чувствовать, что не додумывается, во что я не особо верю, обычно додумывается, то точно разжуют на
семинаре. То есть это все будет обсуждаться. Конкретно здесь я приможу доказательства, основанные на идее
приуфера. Приуфер предложил кодировать деревья. Это называется коды приуфера. То есть каждому
дереву на n вершинах он предложил сопоставить некоторую последовательность чисел. Дайте я на
примере нарисую, как это делается, и будет понятно, как это делать в общем случае, иначе это будет трудно
воспринимать. Вот берем какое-нибудь дерево. Вы меня можете спросить, почему дерево рисуется именно так,
как я его рисую. Я вам отвечу, а совершенно не обязательно его так нарисовать. Можно рисовать как
угодно. Имейте в виду просто эту теорему, что структура дерева, она вот примерно такая,
как я сейчас нарисовал. Вот какое-нибудь дерево. Вот давайте вот такое небольшое дерево. Как-нибудь
занумируем его вершины совершенно в хаотичном порядке, неважно. 4, 5, 6, 7, 8. От того, как мы их
занумируем, как раз и будет зависеть, какое дерево мы смотрим. Нам же важна не только структура,
нам важны сами ребра. Какие у них концы. Оно занумированное. Вот давайте этому дереву сопоставим
код. Объясняю как. Значит, вот если вы глядите на эту теорему и на вот это замечательное простое
утверждение, то вы с легкостью можете доказать, я в это верю свято, что у любого дерева на больше
чем одной вершине, ну при n равном единице все очевидно. Вот пустян больше чем один. Это уже не
семечко, там хотя бы один расточек есть. У любого дерева на больше чем одной вершине есть, как говорят,
листья. Ну то есть вершины степени 1. Очевидно. Только, пожалуйста, не ссылайтесь вот на эту картинку.
Сумма степеней вершин удвоенное число ребр, если бы у каждой вершины была степень не меньше
двойки, то эта сумма была бы не меньше чем 2. Получилось бы, что ребр не меньше чем n, а их n-1.
Поэтому висячие вершины листья есть всегда. Давайте возьмем лист, он же висячие вершина,
с минимальным номером. Вот здесь он вот. Так, друзья, я, наверное, не очень разогнался. Нормально
успеваете. Возьмем лист с минимальным номером и в качестве первого элемента строящегося кода
возьмем не его, а второй конец соответствующего висячего ребра, но одно, поэтому второй конец
выбирается однозначно. Пишем 4. Потом берем большой секатор и отстригаем эту веточку.
Так, остается, очевидно, дерево. Глядите на это утверждение. Если мы отрезали висячую вершину,
ясно, что на выходе остается снова дерево. Ну, конечно, если n там больше двойки. Хорошо. В
общем случае делаем так же. Какая теперь вершина висячая с наименьшим номером? Нет,
3 по-моему, да? Значит, снова выписываем 4 и отстригаем. В какой-то момент произойдет
переключение. Значит, смотрите, вот теперь действительно 6. 6 имеет второй конец 2.
Так, теперь действительно, теперь кто? Теперь 7. 7, 5. 5, да? Давайте 5, 4. Так,
теперь у нас 4 с минимальным номером, висячая вершина, но вырисуем 2. Так,
все, у нас осталось одно ребро, больше ничего не делаем. Все, осталось одно ребро, с ним ничего
делать не надо. Вот это вот, это код нашего дерева. Код нашего дерева. 1, 2, 3, 4, 5, 6. Было 8 вершин,
стало 6 чисел в коде. Ну, я думаю, вы понимаете, что было бы n вершин, было бы n-2 числа. Было бы
n-2 числа. Мы научились каждому дереву сопоставлять последовательность из n-2 чисел, если дерево
на n вершинах. Каждому дереву на n вершинах мы сопоставляем некоторую последовательность из
n-2 чисел. Ну, всего возможных последовательности из n-2 чисел, конечно, n в степени n-2. Надо
просто показать, что есть биекция между множеством таких последовательностей и множеством деревьев.
Это докажет теорему Кэрри. Ну, первое, что я не буду объяснять, но вы можете додумать самостоятельно
или с участием ваших семинаристов, это то, что, конечно, есть инъекция. Но вам нужно осознать,
почему, если два разных дерева, то последовательности будут разными. Двум различным деревьям соответствуют
две разных последовательности. Это вот я не буду объяснять подробно. Подумайте над этим или
обсудите с семинаристами. Но, в общем, это надо понимать, конечно. Инъекция имеет место. По
поводу сюръективности, что нужно сделать? Нужно доказать, что каждой последовательности соответствует
какое-то дерево. Ну, я тут сделаю два шага. Во-первых, я по последовательности восстановлю дерево,
опишу процесс, как восстанавливать дерево. Декодирование, так скажем. По дереву мы построили
последовательность, а сейчас обратно по последовательности соберем дерево. Вот у нас
есть последовательность 4-4-2-5-4-2. Вот это самое. Давайте по дней напишем 1-2-3-4-5-6-7-8,
то есть все возможные номера вершин нашего графа. Не кокнул скорость, успеваете?
Держите меня в темпе, пожалуйста. Значит, что очевидно? Очевидно, что поскольку здесь
чисел меньше, чем тут, то в верхней строчке отсутствуют какие-то числа из нижней. Давайте
выберем число с минимальным номером, которое в нижней строчке есть, а в верхней отсутствует.
Число с минимальным номером. 1, да? Правильно. Так, выбираем 1, а здесь берем 4 и формируем
ребро 1-4. Ну оно же 4-1, потому что у нас граф не ориентирован. Формируем ребро 1-4. В кобочках
так вот глядим сюда и замечаем, что, елки-палки, это и есть то самое ребро, которое мы отстригали
первым. Ладно, это повезло. Наверх. Ну давайте вот это удалим, вот это удалим. Все, мы ребро
1-4 сформировали. Ново смотрим на нижнюю строчку и снова находим в ней число с минимальной величиной,
которое отсутствует в строчке сверху. Какое теперь число самое маленькое отсутствует наверху? Три,
правильно. Два присутствует, да? Да, эти три, а здесь возьмем просто следующее внутри последовательности,
вот это четыре. Сформируем ребро 3-4. Правда ли, что мы его отстригали вторым? Вроде правда.
Что-то как-то уже напоминает закономерность. Первый раз, может, повезло, но второй-то раз не может
так повезти. Повезло, да? Снова повезло. Ну и так дальше действуем. Значит, двойка по-прежнему
присутствует. Так, что там? Четверка присутствует, пятерка есть, а шестерки нет. Пишем 2-6 и вычеркиваем
6 и 2. Ну и пытаемся вспомнить, елки-палки, ну вот мы и отрезали как раз 6, то есть уже третье
совпадение. Нет, ну я так, конечно, весело иронизирую. Понятно, что это закономерность,
что это так всегда и будет. Ну давайте до конца доведем. Так, тут чего? 4 и 5 пока есть,
два тоже есть, семерка отсутствует. Ну семерку-то мы и отрезали там, конечно.
Получится 5-7. Вот, теперь пятерки нет. Пятерка тут есть, а тут пятерки нет. Пишем туда, запитает 4-5.
Ну вроде так и было, да, отстригли это, потом отстригли это. 4-5. Так, чего у нас тут 4? Тут 5.
Два есть, четыре теперь нету. Ну отлично, да, вот как раз четверку мы отстригали, там последний.
Получится 2-4, 2-4. И осталось 2-8, не вырезанное в нижней последовательности. Это как раз то
самое ребро, с которым мы ничего не делаем. Но это как бы следующее упражнение, которое вам нужно
для себя осознать. То, действительно, если у вас какая-то последовательность получилась при
кодировании, описанном вот здесь, последовательность, то декодирование, которое описано тут, всегда
восстановит исходное дерево. Ну я не буду подробно доказывать, а вам это надо осознать.
Но это всегда разбирают, если кто-то не понимает, разберут, конечно. Вот, и последнее. Смотрите,
но это же не доказала сюръекцию, правда? Потому что пока мы только увидели красивую историю, что взяли
дерево, закодировали, взяли вот эту последовательность, зная, что она соответствует вот этому дереву, что она из
него получена, и ее вот так вот раскодировали обратно в это самое дерево. Ну мало ли, а может
быть есть какая-то вообще случайная рандомная последовательность, которая не из дерева получена,
вы ее будете декодировать с помощью вот этой процедуры, а дерево не выйдет? Может же такое быть?
Теоретически, да. Поэтому третье, что вам предстоит продумать для себя, что если вы запускаете этот
процесс декодирования на любой совершенно последовательности длины n-2 из n чисел, на
любой совершенно, то вот этот набор ребер, который получится, действительно образует дерево.
Тогда получится сюръекция. Смотрите, что для этого нужно? Понятно, что ребер-то получается n-1 по
построению. Вот это построение всегда дает n-1 ребро. Согласны? Ну очевидно. Поэтому, глядя на эту теорему,
вы понимаете, что достаточно доказать, что итоговый граф будет просто связан или просто
ацикличан. Это одно и то же. Мне почему-то кажется, что чуть проще доказывать отсутствие циклов и
делать это надо просто индукцией Паем. Это максимальный, так сказать, набор подсказок,
которые я в этом месте обычно даю. То есть, есть кодирование, есть декодирование. Надо доказать
инъективность, что разным деревьям соответствуют разные коды. Надо понять, почему декодирование
приводит к тому же самому дереву, что это не только вот такое чудо на примере, но это всегда так. И
надо понять, например, по индукции, почему циклов в такой штуке не возникнет, если вы берете
совершенно произвольную последовательность. А то, что ребер столько, сколько надо, это просто по
построению. Вот такая вот схема доказательства теоремы Келли. Слушайте, а я могу еще что-то
рассказать? Что, я разогнался, что ли? Нормально-то там все успели? Бессловесное животное.
Но даже не знаю. Может, успеем? Нет, не успеем. Не успеем. Продолжением этой истории, знаете,
что является? Ну, дайте я просто анонсирую, рассказать нормально, не успею. Значит, дерево,
как вы, наверное, понимаете, это самый тощий связанный граф. Тощий по числу ребер. То есть,
если вы возьмете на n-вершинах n-2 ребра, то это никогда не будет связанным графом, но это видно
в общем и из теории. Это самый тощий среди всех связанных графов на n-вершинах. Для очень многих
приложений важно подсчитывать, конечно, не только количество деревьев, но и количество графов более
толстых. То есть, люди интересуются таким вопросом. Вот пусть c от n и k, это количество связанных
графов. Количество связанных графов на n-вершинах с к ребрами. С к ребрами. Это важно, например,
для теории случайных графов, которые позволяют в большинстве случаев какие-то задачи решать,
в том числе алгоритмические. То есть, эта вещь такая очень применительная. Ну вот, что мы понимаем,
что если k не превосходит n-2, то c от n и k равняется нулю. И сейчас мы доказали, что если k равно n-1,
то есть получается дерево, то c от n и k равняется n в степени n-2. Вопрос, который хотелось бы
обсудить, но за пять минут все-таки мы не обсудим точно, совершенно. Это вопрос о том,
чему равняется c от n, n плюс a1. Сейчас, почему n плюс a1? Просто n. Извините, я куда-то улетел.
Да, от n, n, конечно. То есть, это следующее после дерева по толщине, так сказать, конструкция.
Как бы можно было в целом охарактеризовать графы, у которых на n-вершинах n ребр? Можно сказать так,
это графы, у которых ровно один цикл. Понимаете? То есть, это дерево, к которому добавили дополнительное
ребро. Замыкающая некий простой, конечно, цикл. Оно вот так еще обозначается, потому что u это
первая буква слова унициклический граф. Граф называется унициклическим, если в нем содержится
ровно один, естественно, простой цикл. Унициклический. Одноцикловый. Графы, вот их
столько. Сколько их? С обсуждения этого мы начнем, видимо, тогда следующую лекцию,
потому что прямо сейчас, ну, за 4 минуты это не сделать. Все, на сегодня.
