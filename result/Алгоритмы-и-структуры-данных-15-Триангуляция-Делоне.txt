Так, здравствуйте. Давайте заканчивать. Нам осталась последняя все эта треангуляция
сделанная. Вот. Что-то такое, зачем это надо. Ну, смотрите, мотивация такая. Моделирование ландшафта.
Представьте, что вы хотите в компьютере визуализировать какую-нибудь гору. Ну,
или просто какой-нибудь интервьюальный рельеф. Понятно, что, наверное, на самом деле это рельеф,
какая-то непрерывная функция. Скажем, если мы введем, если мы считаем землю плоской, если мы
введем на плоскости систему координат и z направим наверх, то по факту рельеф характеризуется функцией
из x, y в z. То есть, у нас над каждой точкой известен уровень, ну, как бы, уровень горы над этой точкой.
Вот. Понятно, что физика это, наверное, что-то непрерывное. Понятно, что непрерывные вещи особо
в компьютере представлять не умеем. Поэтому мы можем с какой-то достаточно хорошей точностью это
дискретизировать, приблизить. Вот. Ну, и можно дискретизировать следующим образом. Значит, давайте
вот представим, что у меня в каких-то точках известна высота этой горы. То есть, для
нескольких точек x и y мне сказано, на каком уровне над уровнем моря в точке z находится вот гора.
Ну, там, высота горы в этой точке. Вот. Давайте мы сделаем следующее. Значит, давайте мы на плоскости
вот, то есть, в каких-то точках была померена высота. Давайте мы построим эти точки. Давайте
дальше мы вот это вот семейство точек триангулируем. То есть, ну, порисуем здесь какие-то вот такие
треугольнички, которые разобьют всё множество точек на какие-то вот такие вот фигурки. Дальше,
смотрите, давайте каждую вершину каждого треугольника вот мы поднимем на ту высоту,
на которой находится. У меня в каждой этой точке известна какая-то высота на уровне моря. Вот.
Ну и тогда, соответственно, каждый треугольник с плоскости поднимется, станет каким-то треугольником
в пространстве. Возможно, наклоненным. Вот такой, вот такой будет какой-нибудь вот такой узенький
треугольник. Ну, в общем, всякие такие треугольники, причем они будут именно с наклоном. У меня каждая
вершина куда-то поднялась, у меня есть три точки в пространстве, я по ним могу провести плоскость.
Соответственно, вот у меня получилась ну что-то такое какая-то возможная дискритизация плоскости.
Я знаю, что в этих точках должна быть такая-то высота. Я просто через них провожу плоскость и скажу,
что ну вот в этом районе я считаю просто как бы первой степенью приближения. Что у меня в этом
районе проходит просто плоскость. Вот, если этих точек достаточно много, если у нас достаточно
высокой степень дискритизации, то у нас получается ну вполне себе хорошее приближение. То есть,
То есть мы считаем, что рельеф не непрерывный, а такой
дискретный треугольный.
Понятно?
Ну, соответственно, нам хотелось бы вот как-то
вот здесь, если все точки на плоскость спроектировать,
если забыть Z координату, то нам хотелось бы вот здесь
как-то триангулировать, чтобы потом можно было
бы поднять.
Вот такая мотивация.
Отсюда же, например, возникает следующая идея, какую из
триангуляций нам хотелось бы выбирать.
Ну представьте, вот давайте я эту плоскость разверну
на плоскость доски.
Представьте, что у меня известна какие-то такие
данные.
Вот здесь был какой-то горный хребет,
и в этих точках, скажем на этой прямой, мне известно,
что высота какой-нибудь очень большая.
А здесь ноль.
Здесь море, здесь ноль.
То есть есть какой-нибудь такой узенький горный хребет
высокий, который с двух сторон окружен равниной
или морем.
Нам известно, что у всех этих точек высота над уровнем
море ноль, здесь ноль, а здесь в основном уровне
моря тысяча.
Ну и если это дискретизировать, треангулировать, то наверное
хотелось бы что-то вот такое вот сделать.
Наверное, это было бы хорошо, то есть примерно у нас тогда
было бы, что у нас вся гора выглядит как вот такие
вот треугольники как раз со стрием здесь и уходящие
на плоскость вот здесь, то есть вот такие треугольники
были.
Вот, это хорошая треангуляция, а плохая треангуляция была
бы такая, где, например, ну давайте я сам в плохой
случае нарисую, где, например, что-нибудь вот такое было
бы треугольником.
То есть представьте, у меня вот эти три точки являются
треугольником треангуляции.
Тогда, поскольку у меня эти точки находятся в плоскости
просто z равна нулю, у них восстановливая, то если
я здесь что-то треангулирую, у меня получается, что у
меня в этом горном хребте есть какая-то там такая
дырка, не знаю, как это на русском называется.
Ну типа вот у вас был горный-горный хребет, потом такой обвал
и потом он обратно вернулся, это вот как раз такой провал
соответствует тому, что вот с высота z равна нулю.
Это странно.
Чем этот плох треугольник?
Значит он плох тем, например, что у него вот этот угол очень
маленький.
То есть можно по-разному говорить, чем этот треугольник
плох, но в частности он такой очень узкий, очень тонкий,
то есть у него вот этот угол очень маленький и ну
какой-то он совсем дохленький.
Нам хотелось бы, чтобы треугольники были, наоборот, вот такие
толстые, примерно равносторонние, то есть наш идеал равносторонние
треугольники, тогда мы как раз, грубо говоря, точки
больше всего друг на друга похожи и они как раз нам
максимально близко друг к другу высоте, ну можно
было бы ожидать.
Поэтому наша цель была бы сделать так, чтобы вот
эти углы все были как можно больше.
А чем отличается точка с левой точкой?
Ничем, ничем, ну просто вот у вас есть, не, еще раз
смотрите, вот пусть реальный мир такой, у вас есть горный
хребет узенький, узенький, высокий, вот он, а здесь
с обеих сторон от него равнина, ага, вот, значит
тогда, ну одна из версий, которую можно было бы рассматривать
это следующее, значит среди всех треангуляций, хотел
бы найти такую, у которой, скажем, минимальный из, среди
всех углов всех треугольников максимально возможен.
Который минимальный среди всех углов треугольников,
максимально возможен, вот, ну собственно, значит,
это мы и будем хотеть делать, это в частности достигается
над реангуляцией деланой.
Понятно?
Хорошо, ну давайте начнем с того, что такое вообще
Ну, значит, пусть, С это какой-то множество точек, а конечный
множество точек в R2, значит тогда, треангуляция множества
С, это совокупность треугольников, вершинами которых выступают
какие-то точки С, и которые при этом, если пересекаются,
пересекаются по общему ребру или по общей вершине.
Значит, ну давайте напишу так, максимальная совокупность
треугольников с вершинами в точках С, пересекающихся
по общим ребрам или по общим вершинам, ну или по включению
неважно, по умолчанию, по включению, да, так, пересекающие
по общим ребрам или по общим вершинам, вот, то есть пример
что такое плохая, ну хорошие треангуляции я уже рисовал
вот там, вот, например, вот такая штука была бы плохой
треангуляции, то есть если у меня вот здесь вот точки,
я вот нарисовал такую совокупность треугольников 1, 2, 3, то это
плохая треангуляция, потому что, скажем, вот этот вот
большой треангульник пересекается вот с этим по куску своего
ребра, да, но я и говорю, это не треангуляция, потому
что надо на самом деле вот это ребро еще довести,
вот, окей, ну, значит, есть какие-то простые факты,
что если у вас есть данное множество С, то любая его
содержит данное это число ребер, данное число треугольников.
Значит, пусть С содержит N вершин, при этом K из них
лежат на границе выпуклой оболочки, при этом K точек
лежат на границе выпуклой оболочки С.
Значит, тогда в любой треангуляции множество С содержится
2N-K-2 треугольника и 3N-K-3 ребра.
Это я даже не буду включать, просто фан-фэкт.
Не торопитесь, это любая, да, треангуляция делана
сет-фэкт, вот, значит, ну, доказывается, доказывается
очень просто, можно просто рассмотреть треангуляцию
как граф, да, соответственно, точки С это вершины, ребра
это ребра треугольников, грани это треугольники.
Ну и дальше надо просто писать форму Лейлера, понятно,
что граф связанный, потому что у нас максимальное
множество треугольников, если не связан, то можно
было бы что-то добавить, грубо говоря, чтобы увеличить
число треугольников и дополнить связанность.
Вот, каждая грань треугольная, поэтому грани примерно
в полтора раза больше, чем ребер, да, потому что
на каждой гране три ребра и каждое ребро участвует
в двух гранях, отсюда три вторых, да, грани соответствуют
трём вторым ребрам.
Вот, ну и дальше просто форма Лейлера.
Наказательства Лейлера для связанного плоского
графа.
Так, ну вот, сейчас вся штука линейная, здесь линейное
число треугольников, линейное число ребра, то есть это
можно опять-таки ожидать, что треангуляцию любую,
ну и там, треангуляцию деланной в частности можно представлять
за линейную память, а значит, какой-то алгоритм, наверное,
с адекватным времени работы тоже есть.
Вот, ну определение.
Значит, пусть, как обычно, С это конечное множество
точек, давайте мы построим его диаграмму Воронова.
Давайте, сейчас, я это С, да, назвал, ну ладно, пусть
С, конечно, пусть ворот С, это диаграмма Воронова
для множества С, значит, тогда графом Делане называется
следующий граф.
Когда мы вершинами считаем опять-таки точки С, наши
сайты, а ребрами будем соединять те вершины, те сайты, которые
соответствуют соседним ячейкам диаграммы Воронова.
То есть, если две ячейки пересекаются, то мы проводим
ребро между их центрами, между их сайтами.
Граф Делане, это следующая вещь, вершины, это просто
С, ребра, это те пары сайтов, ячейки которых соседние,
ячейки которых пересекаются.
Ну, давайте, значит, я так и напишу, что ребра соединяют
пары тех сайтов, ячейки которых пересекаются
по куску положительной длины.
Вот, если они касаются только по вершине, то я это игнорирую,
я такое не считаю пресечением, только по ребрам.
Фигня будет.
У вас новое любимое слово.
Так, давайте что-нибудь нарисуем.
Давайте я что-нибудь необычное для себя нарисую.
Давайте что-нибудь вот такое нарисуем.
И пусть здесь будет тоже сайт.
Значит, вот у меня набор шести сайтов.
Сейчас попробую изобразить диаграмму Воронова сначала.
Что-то такое, тут будет все как обычно, вот, и здесь
какая-то вот такая вот штука будет.
Похоже, вроде нормально.
Ну вот, и теперь давайте просто, вот это у меня
диаграмма Воронова.
Теперь давайте пунктиром я проведу ребра из графа
Дилане.
Значит, вершины у меня это сайты, ребра провожу
между теми сайтами ячейки, которых пересекаются по
куску, положительной длины.
Например, вот эти две ячейки пересекаются по этому лучшему,
я провожу здесь ребро.
Вот эти две ячейки пересекаются по этому ребру, вот здесь
ребро, здесь ребро, здесь ребро.
Вот эта ячейка тоже со всеми этими четырьмя пересекается
и провожу такие ребра.
Ну и наконец вот эта ячейка пересекается с этими двумя
— провожу вот такие два ребра.
Вот, то, что я построил, называется графм Дилане.
Так, причем у меня сразу получилась треангуляция в этом случае, да?
Какую?
Давайте нов... давайте новую картинку нарисуем. Чего, нам жалко, что ли?
Нет, на самом деле приятно. Мне хотелось бы показать, что это не всегда треангуляция.
Здесь будет что-то подобное, да, и вы хотите, чтобы оно вот так вот проходило, как бы.
Ну да, какая-то такая точка, наверное, здесь есть.
Да-да-да-да, все правильно говорите.
А, да-да-да-да.
Да, супер.
В таком случае у меня как раз получается не треангуляция, просто какой-то граф.
Причем здесь будет грань с четырьмя вершинами, да, то есть вот это вот будет грань с четырьмя вершинами.
Да, такое вполне себе бывает.
Вот.
Ну, значит, мы что-то построили.
Значит, я утверждаю, что то, что мы нарисовали, это обязательно плоский граф.
Значит, граф Дилане.
Плоский.
Значит, плоский в том смысле, что вот именно такая его укладка на плоскость, что если провожу ребро между соседними ячейками, то именно такая укладка на плоскость будет как бы без пересечения ребер.
То есть не просто граф планарный, что его можно как-то уложить, как-то перерисовав ребра, сделать так, чтобы не пересекались.
А именно вот просто, если вы рисуете отрезок между сайтами, то такой граф будет плоский.
А Чев вообще нет.
Ни капли.
Давайте попробуем доказать.
Значит, я сегодня все доказывать не буду, потому что мы иначе ничего не успеем.
Ну это давайте попробуем.
Ну пусть не так, пусть этот граф не плоский.
Это значит, что какие-то два ребра пересекаются.
Давайте будут для простых считать, что они пересекаются по мясу, то есть по внутренностям.
То есть есть какая-то внутренняя точка на обоих отрезках, которая там и там лежит.
Пусть не так.
Пусть два отрезка.
Пусть два отрезка пересекаются по внутренности.
Вот, пусть это какие-то отрезки по ИПЖ и по КПЛ.
Что такое отрезки по ИПЖ и по КПЛ?
Почему это вообще отрезки графа Дилане?
Потому что они соответствуют пересекающимся ячейкам.
То есть если мы рассмотрим ячейки по ИПЖ, то они разделяют какой-то общий кусок границы.
То же самое по КПЛ, они разделяют общий кусок границы.
Но у нас есть свойство, что такое пересекающиеся ячейки.
Это значит, мы помним с вами, что у меня ячейки соседние и соответственно разделяют какой-то кусок общей границы.
Если на серпере между ними есть окружность, которая содержит только их.
Критерии того, что серпер к двум сайтам участвовал в диаграмме Воронова.
Такое, что где-то на серпере есть точка такая, что в этом пустом круге с центром в ней есть только по ИПЖ.
Но давайте эти точки нарисуем.
Они существуют для пары по ИПЖ, для пары по КПЛ.
Давайте их нарисуем.
В частности, есть какая-то точка Х и ТЖТ.
Которая лежит на середином перпендикуляре между по ИПЖ.
Такая, что если я нарисую круг с центром в этой точке.
Больше никаких других сайтов внутри круга нет.
Более того,
давайте вот так проведу.
Вот так вот.
Вот так вот.
Вот так вот.
Вот так вот.
Вот так вот.
Смотрите, я утверждаю, что отрезок Х и ТЖТПИТ лежит целиком в ИТ-ячейке.
Более формально я напишу так, что полуинтервал ПИХЖ лежит во внутренности ИТ-ячейки диаграммы Воронова.
Почему? Потому что эта точка, это какая-то точка на серпере, лежащая на ребре, то есть она лежит одновременно в обеих ячейках.
Ну а этот отрезок лежит только в ИТ-ячейке получается.
Если это граничная точка, это точка внутри ячейки, то значит это все внутри ИТ-ячейки лежит.
Внутри ребра была такая точка?
На самом деле в утверждении такого не говорил, но когда рисовал, там на ребре она получалась.
Я брал точку, отступал на нее плюс-минус эпсилон и говорю, что весь отрезок это часть серперы, которая является частью границы.
Поэтому да, поэтому она внутри.
Ну и то же самое можно сказать про вторую сторону, что отрезок, точнее интервал ПИХЖ лежит строго во внутренности ЖИТ-ячейки.
Хорошо, значит у меня есть такой один треугольник, есть какой-то другой треугольник ХКЛПКПЛ, который как-то с ним пересекается.
То есть я предполагаю, что у меня есть другая сторона ПКПЛ, которая пересекает ПИПЖ, вот она какая-то такая.
Причем, я утверждаю, что если у меня какой-то ПКПЛ пересекается с ПИПЖ, то этот отрезок, который пересекает эту сторону, он обязательно выходит из треугольника.
То есть не может быть такого, что вот эта точка, скажем, внутри.
Ну потому что надо еще сказать, что весь этот треугольник лежит внутри ИТ-ЖИТ-ячейки.
Ну или иными словами, просто если бы у меня здесь была какая-то, скажем, вот если бы здесь была ПК, то понятное дело тогда, что ХИТ-ЖИТ был бы ближе к ПК, чем к ПЖ.
А мы знаем, что ХИЖ лежит на границе между ПИПЖ, то есть никаких других, ну вообще в этом круге просто нет других сайтов, можно так сказать.
В этом круге нет никаких других сайтов, поэтому ПК здесь быть не может.
Поэтому если ПЛПК как-то и пересекает эту сторону, то обе, оба конца лежат вне этого круга.
Вот, хорошо, ну давайте я еще нарисую где-то точку ХКЛ, которая опять-таки лежит на серпере уже к этому отрезку.
Давайте я ее где-нибудь вот здесь вот нарисую.
Она где-то здесь.
Она так плохо получилась.
Вот здесь я ее нарисую.
То есть всегда у нее получается есть два таких треугольника.
Мы знаем, что у них есть пара пересекающихся сторон, вот эта и вот эта.
Я утверждаю, что у них есть обязательно еще хотя бы одна пара пересекающихся сторон.
Потому что если не так, у меня был один треугольник и другой треугольник.
Если бы у меня была какая-то вот такая картинка примерно, то смотрите, у меня бы точка ПЖ лежала бы внутри вот этого треугольника, значит в частности внутри вот этого круга.
Но таких точек не бывает.
Мы знаем, что пустой круг с центром в ХКЛ никаких других сайтов кроме ПКП или не содержит, поэтому в частности внутри этого треугольника других сайтов быть не может, ПЖ здесь быть не может.
Получается недопустимая конструкция, недопустимое такое перечень треугольников, когда ПИ или ПЖ лежит в другом треугольнике, и то же самое нельзя чтобы ПКП лежала в другом треугольнике.
Поэтому конструкция обязательно именно такая, и пересечение не просто 1 такое, но есть обязательно еще какое-то.
какой-то, по крайней мере, одну. Значит, тогда отсюда можно сказать, давайте запишу, что
PIPG не лежат в треугольнике PK-PL-XKL, аналогично с PK-PL. Тогда эти два треугольника обязательно
где-то еще пересекаются, пересекаются где-то еще. Вот, ну и, например, на этой картинке у меня
получилось, что у меня цветной есть, нет, нету. Значит, тогда у меня вот этот вот отрезок пересекается
вот с этим отрезком, да, PL-XKL, PG-XIG. Но я знаю, что эти отрезки оба целиком вложены в свои ячейки
диаграммы Воронова. То есть я написал, что у меня вот этот вот интервал, XIG-PG, люди строго вжиты
ячейки. То есть все вот эти точки люди во внутренности V от PG. То же самое здесь, все вот эти
точки внутренние лежат во внутренности ячейки PL, и при этом они пересекаются. Но мы знаем, что
ячейки по внутренности о мне пересекаются. Нет, еще раз. Вот я сказал, что просто одного пересечения
быть не может. Нет, не может, потому что, потому что вас тогда обязательно, ну, картинка какая-то
вот такая будет, что вас будет PG внутри или PE внутри. Честно-честно. Вот если все случаи
порисовать, то можно убедиться в этом. Что? Да. Не, не будем, не будем. Значит, что я хочу записать,
что тогда какая-то из сторон, из сторон XIG-PI или XIG-PG пересекается с какой-то из сторон
XKL-PL или XKL-PK. Ну, это противоречие с тем, что у меня эти стороны лежат только во внутренности
ячеек, да, тогда, получается, у меня пересекаются внутренности ячеек противоречия. Еще раз. Да, да,
да, да, да. То есть, когда я провожу эти отрезки, они будут попарно не пересекаться. Да. Так, хорошо.
Это что мы сделали. Вот. Ну и дальше, значит, если у нас граф плоский, можно еще доказать
следующее утверждение, которое во многом основывается на то, что мы делали про, значит,
диаграмму Воронова. Значит, во-первых, в графе Дилане присутствует ребро PI-PG,
ребро PI-PG, если и только если мы знаем критерий. Существует точка Q на серпере между ними,
такая, что максимальный пустой круг с центра вниз содержит только PI-PG. Существует Q содержит
только PI-PG. Это по факту я просто переначал критерий пересекаемости двух ячеек диаграммы
Воронова. Это просто то же самое. Вот. Во-вторых, три точки PI-PG-PK являются вершинами одной и
той же грани графа Дилане, являются вершинами одной грани графа Дилане, если и только если
существует точка Q, такая, что пустой круг с центра вниз содержит эти три точки на границе,
содержат их на границе. Вот. Ну, это переначанное условие про вершину диаграммы Воронова. Как
хорошо такое вершина. Это такая точка, которая одновременно инцидентна нескольким ячейкам,
хотя бы трём. Значит, для неё вот это вот верно, что если провести максимальный круг,
то там будет много точек, и вот они образуют грань графа Дилане. Вот. Ну и в частности давайте
напишем продолжение подтверждения. Более того, каждая грань графа Дилане
это вписанный выпукланный многоугольник. Вот. Ну, потому что вершины одной грани лежат на какой-то
одной общей окружности. Как вот в этом случае у меня вот здесь есть вот эти четыре точки,
они являются вершинами одной грани, но там для любых трёх из них существует какой-то круг,
который содержит только их. Значит, есть круг, который их все содержит. Ну, вот, собственно,
и будет тот самый. Ой, тут круг, конечно, не получается, но давайте считать, что это круг.
Вот. Значит, есть какой-то круг, который их как раз на границе содержит. Так. Окей? Вот. Ну,
вот там. Предиказательство. Каждая грань, да, спасибо. Спасибо. Ну, вот. Значит, теперь,
когда мы более-менее понимаем, как были графы Дилане, определение, что такое триангуляция Дилане.
Триангуляция Дилане. Значит, это произвольное дотриангулирование графа Дилане. То есть у нас
есть граф Дилане какой-то, там большинство грани, скажем так, треугольники. Не треугольники,
только вот такие какие-то вписанные там четырёхугольники и более. Пяти шестиугольники. Сколько хочешь,
столько может быть. Вот. Ну, давайте просто как угодно их дотриангулируем. Вот захотим,
то есть вот скажем, в этом четырёхугольник я могу провести вот такую диагональ, могу вот такую. Как
хочу, так и делаю. Это всё будет триангуляция Дилане. Ну, давайте напишем, что это просто
произвольная триангуляция графа Дилане. Вот. Почему произвольная? Ну, смотрите, если мы живём в
парадигме, что мы хотим максимизировать минимальный угол, то от того, что мы произвольным образом
триангулируем выпуклый вписанный многоугольник, у нас угол не меняется минимальный. Потому что,
ну вот скажем, был у меня какой-то круг, был у меня здесь какой-то многоугольник. От того, что я
триангулирую его, в любом случае будет какой-то угол, опирающийся на наименьшую дугу. Скажем,
если у меня вот эта дуга наименьшая, то обязательно, ну там, вот эта штука будет являться
стороной какого-то треугольника, значит обязательно будет угол, опирающийся на эту дугу. Ну,
значит, минимальный угол однозначно определён, как не триангулируй. Обязательно будет кто-то
сюда опирающийся, поэтому минимальный угол один и тот же всегда, независимо от триангуляции.
Замечание, минимальный угол независит от триангуляции. Вот, поэтому я имею право,
как угодно, до триангулировать, если есть граф. Вот, ну и теперь, если мы так всё
это определили, если мы так всё определили, то у нас есть готовый алгоритм построения
триангулирации Делане. Значит, он просто следует из всего того, что мы уже знаем. У нас есть алгоритм
Форчина, который строит диаграмму Воронова. Давайте мы просто будем вот, ну там, либо можно
сказать так, либо давайте просто построим диаграмму Воронова, потом переберём пересекающие ячейки и
проведём ребра между ними, а там как-нибудь до триангулируем. Либо можно просто сказать, смотрите,
давайте мы Форчину ещё раз вспомним. Значит, он идёт сверху вниз, поддерживает береговую линию,
как набор дуг-парабол, вот таких вот каких-то. Что такое соседние дуги-парабол? Это значит,
что вот здесь вот точки вот эти вот вычерчивают ребра, вычерчивают ребра ячеек. Это значит,
что в этот момент времени фокус вот этой параболы и фокус вот этой параболы являются соседними
ячейками, да, потому что у них вот эта точка вычерчивает границу, вычерчивает серпер между
ними как раз. Ну, значит, в момент, когда у меня две параболы пересекаются, точнее являются
соседними в береговой линии, я говорю, что вот здесь вот появляется ребро графа Дилана,
да, потому что как раз вот эти две параболы задаются, задают серпер между вот этими точками,
значит у меня есть ребро между этими точками в графе Дилана. Вот. Можно ещё раз, смотрите,
когда мы вспоминаем алгоритм Форчуна, у нас есть береговая линия, как набор парабол, и мы знаем,
что точки пересечения соседних парабол вычерчивают ребра в диаграмме Воронова. Вот. Ну,
что такое ребро? Это как раз граница, разделяющая два сайта, два, две ячейки. Теперь, если мы просто
следим за вот этими точками пересечения соседних ячеек, в каждом времени, когда появляется новая
точка пересечения двух парабол, скажем вот, которая соответствует вот этому сайту и вот этому сайту,
вот две параболы, они вот здесь пересекаются. Я такой, окей, это значит, что в графе Дилане вот
такое ребро есть. Я его просто провожу, потому что вот они пересекаются. Эти две ячейки пересекаются.
Ну и всё, я так прошеду сверху вниз, слежу за новыми пересечениями соседних парабол,
когда появляется новая, добавляю ребро в граф. Значит, Форчун, отслеживаем пересечение соседних
парабол. Вот, тем самым в конце у нас получится граф Дилане, останется его как-нибудь дотреангулировать.
Как можно его треангулировать? Ну, например, смотрите, вот у меня получился какой-то граф на
плоскости. Многие грани треугольные, но иногда бывают какие-то вот такие вот
вписанные многоугольники. Как его дотреангулировать? Ну, например, можно, если вообще не думать,
можно написать алгоритм выделения грани в плоском графе. То есть, представьте, у вас вот это вот
всё вершины, ну в смысле сайты, да, и есть между ними какие-то ребра. Давайте выделим грани. Что это
значит? Вот давайте мы для каждой точки посортируем по полярному углу все исходящие из неё ребра,
и дальше давайте начнем обходить все многоугольники против часовой стрелки.
Скажем, начнем идти вот так вот. Дойдем до сюда. Нам нужно следующее ребро, в порядке обхода
против часовой стрелки, это это ребро. Бин поиском определяется следующее. Если у нас всё посорчено,
можноtaking поиском понять следующее. Пришли сюда, следующие , это вот это, пришли сюда,
следующем за этим это вот это. Вернули сюда обошли весь многоугольник против часовой Стрелки.
То же самое можно сделать с каждой гранью, выделить
все гранья, ну и дальше дотреангулировать, если
у вас известно выделение граней, если вам известно,
какие именно многоугольники у вас входят в граф, то
надо потом просто провести диагонали как хотите, так
проводите.
В конце выделить грань и треангулировать.
Так, ну давайте первое, что мы хотим там, какой-то
угол максимизировать, пока что мы просто построили
явную конструкцию, вот такой-то граф, такая треангуляция,
да, мы умеем его быстро строить, вопрос как это
связано с минимальным углом.
Начну, определение, флип ребра, это следующая простая
процедура.
Представьте, что у вас была какая-то треангуляция,
где были два вот таких вот треугольничка, разделяющие
общую сторону.
Так вот, флип, это просто изменение вот такой диагонали
в этом выпуклённом четырёхугольнике на противоположном.
То есть, если есть два треугольника, разделяющих общую сторону,
можно поменять их в такую-то диагональ, на такую.
И давайте назовём вот эту вот процедуру, то есть,
ну, флип ребра, это просто смена одной диагонали на
другую.
Значит, когда нам это выгодно?
Ну, понятно скажем, что если у меня, вот давайте померим
все вот эти вот шесть углов, три угла этого треугольника,
три угла этого треугольника, альфа-1, альфа-2 и так далее,
альфа-6, бета-1, бета-2 и так далее, бета-6.
Вот если у меня минимальный угол строго вырос, то понятно,
что, ну, наверное, это полезное действие, если мы хотим
максимизировать минимальный угол, и при этом вот тут
вот локально я смог увеличивать минимально из этих шести
углов, то я, наверное, победил.
Так вот, давайте скажем тогда, что, значит, вот это
старое ребро какое-нибудь, давайте, PEPG, ребро PEPG нелегально,
если после флипа минимум из шести углов увеличивается.
Значит, если минимум по альфа-и строго меньше,
чем минимум, так, и занято, да, давайте какое-нибудь
S и T, вот, то есть ребро нелегально, если после флипа минимальный
угол строго увеличивается.
Да, да, да, ну, конечно, это всё в предположении, что
есть какая-то вот всеобъемлющая большая переангуляция.
Вот, такие дела.
Минимум альфа-с от одного до шести.
Ну, предсказуемое, да, пределы?
Понимаю.
Вот, ну и, соответственно, значит, давайте скажем, что
переангуляция легальна, если в нём нет ни одного
нелегального ребра.
Значит, утверждение простое.
Ну, значит, пусть у меня есть два треугольника
треангуляции, PIPGPK и PIPGPL, два треугольника треангуляции.
Значит, тогда ребро PIPG легально, если и только если в круге
описанном вокруг одного треугольника нет четвёртого
сайта.
Достаточно требовать в одном, в другой будет…
короче, одного хватает.
Описанном вокруг PIPGPK внутри не содержится PL, то есть
может быть на границе, но не может быть внутри.
Ну, и поскольку определение симметрично, то, значит,
в частности, в другом круге нет первого сайта.
Так, ну, доказывать я не буду, давайте нарисую просто
одну картинку.
Что?
Значит, давайте нарисую одну картинку, смотрите.
Пусть у меня, давайте нарисую какой-то круг вокруг нашего
треугольника.
Значит, я вот уже следующего, давайте померим угол, вот
этот вот.
И давайте рассмотрим три случая, где лежит PL.
Значит, PL может лежать где-то внутри этого круга, давайте
назову тут вариант A.
Вариант B на границе, вариант C где-то вовне.
Так, пока не хочу рисовать ПК, то есть она на самом деле
вот здесь вот, извините, она на самом деле вот здесь
вот.
Вот.
Значит, если я рассмотрю три точки внутри, на границе
и вне, и померю вот эти вот углы, то они будут
убывать.
Любой угол внутри круга меньше, больше, чем угол
на границе, больше, чем угол вне.
То есть угол PEAJ строго больше угла PEBJ, строго больше
угла PICPJ.
Вот.
Ну и, короче, это все доказывается, этого достаточно, чтобы
доказать.
Если хочется, порисуйте, докажите.
Ну и, значит, теперь, то есть у нас есть, по факту
у нас есть просто как бы другая интерпретация
легальности ребра.
Вот здесь было всех разных углов, ребро легально, если
после флипа минимум не увеличивается.
Значит, вот другая интерпретация просто с точки зрения кругов.
Значит, теорема, триангуляция является триангуляцией
деланной, если только, если она легальна.
Если только, если она легальна.
Вот.
Ну, тоже за нехватка времени давайте оставим без доказательства.
Да, там в одну сторону очевидно.
Ну, давай, давай, ты вы сказали.
Вот, значит, обычно доказывается так, значит, действительно
слева-направо просто, мы знаем, что в триангуляции
деланной круг описан вокруг любого треугольника, внутри
себя никаких сайтов не следит, только на границе.
Мы знаем, что каждая грань, она, это вписан на многоугольник,
поэтому никаких других сайтов там внутри нет.
Вот.
Справа-налево доказывается в два шага.
Значит, сначала из легальности, что такое легальности?
Значит, если мы описали круг вокруг одного треугольника,
Тco, Paa, Pjéc, Pkk.
Да?
Значит, легальность означает, что в этом круге нет трёх
других соседних сайтов.
То есть нет третьей вершины вот этого треугольника,
нет третьей вершины вот этого треугольника, нет третьей
вершины вот этого треугольника.
То есть, есть вот эти три соседних треугольника, вот эти точки,
вот эти сайты, лежат вне вот этого круга.
Это легальность.
Значит, отсюда, если предполагать легальность
триангуляции, можно доказать следующее, что не просто
в каждом таком круге не лежат три соседних сайта,
но вообще никакие сайты не лежат.
То есть, из легальности, из предположения того,
что нет соседних сайтов в круге, можно доказать,
что нет вообще никаких других сайтов в этом круге.
Сайты не лежат, да.
Ну, типа, потому что если бы кто-то лежал, тогда можно
было бы нарисовать вот такой вот другой круг вокруг
вот этого треугольника такой, что здесь этот сайт
тоже лежал.
И скажем, если рассматривать вот такой вот угол, ну как
бы плохой угол, под которым из плохого сайта видна какая-то
сторона, то вот этот вот угол можно было бы нарисовать
другой круг вокруг другого треугольника, здесь этот
сайт тоже был бы внутри этого круга, и из него эта
сторона была бы видна под еще большим углом.
И получается, что можно бесконечно увеличивать
угол, что неверно.
Ну, опять же, это тонкость, давайте я идею пропишу.
Значит, слева направо тривиально, справа налево.
Из легальности сначала можно доказать, что нет
не просто соседних сайтов, но нет никаких других сайтов.
Из легальности следует следующее, что круг, описанный вокруг
любого треугольника, не содержит внутри себя других
сайтов.
Ну, точнее, просто внутри себя они содержат сайтов.
Внутри себя сайтов.
Ну, а оттуда уже деланное более-менее очевидно.
Так, хорошо, значит, ну и теперь мы наконец-то готовы
доказать следующий факт, что в триангуляции деланной
минимальный угол максимально возможен.
Триангуляция деланной, минимальный угол максимально возможен.
Доказательства.
Ну, пусть не так, пусть есть какая-то другая триангуляция,
где минимальный угол будет строго больше.
Значит, давайте как-нибудь обозначим.
Пусть T1 это триангуляция деланная, T2 это другая триангуляция
с большим минимальным углом.
Триангуляция с большим минимальным углом.
Тогда, значит, давайте первое, что я сделаю, это я легализую T2.
Что значит легализация?
Что значит легализация?
Значит, давайте пока в T2 есть нелегальные ребра, их флипать.
То есть пока есть нелегальное ребро, его флипаем.
Вот, значит, вопрос к вам.
Скажите, пожалуйста, почему это вообще конечный процесс?
Почему в конце получим какую-то триангуляцию?
Еще раз?
Ну, не совсем.
У меня увеличивается минимальный угол в четырехугольнике,
но вообще глобально он может быть и не увеличился.
Не уменьшается.
Вот, да, значит, можно сказать следующее.
Можно рассмотреть отсортированный список всех углов.
Тогда флип ребра обязательно увеличивает лексикографически этот вектор.
Если α1, α2 и так далее, альфа3t это отсортированный список всех углов,
то после флипа этот список строго возрастает лексикографически.
Вот.
Ну и поскольку значение каждого угла лишь конечное количество,
ну точно не больше mn куб, потому что вершина и две другие,
вот, значит, процесс конечен обязательно,
потому что у меня есть какой-то вектор, он всегда увеличивается,
для него конечное количество конфигураций,
поэтому мы какую-то triangуляцию в конце получим, а легально.
Получается, что мы из t2 получили какую-то легальную t2 звездочку.
Нет, из t2 вроде.
t1-то делане, она и так легальна, ее не надо легализировать.
Вот.
И при этом, пока мы легализовывали t2, у меня, понятное дело,
минимальный угол не уменьшался точно.
Поэтому, когда я ее долегализовал, у меня минимальный угол мог только вырасти,
ну или остаться таким же, как был.
Поэтому у нас получается, что, ну давайте,
напишу, минимальный угол в t2 звездочка больше минимального угла в t1.
И при этом, мы знаем, что вот это легально, друзья,
а это делане.
И мы знаем, что легальная делане, это одно и то же.
Значит, это тоже делане.
И при этом мы знаем, что вот это легально, а это деланэ.
Еще мы знаем, что легальное деланэ – это одно и то же.
Значит, это тоже деланэ.
Получается у нас есть две триангуляции деланэ, в
которых минимальные углы различны.
Мы знаем, что это не так, потому что мы проговаривали,
что они отличаются только тем, как именно мы триангулируем
вписанные многоугольники, от этого минимальные углы
не меняются.
Патива речи.
Так, ну что, с кайфом.
Ну хорошо.
Тогда получается, что мы победили.
Мы показали, что то, что мы делали, это не бесполезно,
это не просто какая-то триангуляция, а именно та, которая в частности
нам позволяет достигать максимального значения минимального
угла.
Ну хорошо.
Давайте тогда, теперь, если мы поняли, что это такая
хорошая триангуляция, давайте попробуем сделать другой
алгоритм, который ее строит.
Возможно, он покажется кому-то проще.
Значит, а именно мы выйдем в 3D и будем строить выпуклоболочку
в 3D.
Тут уже ваш выбор, что вам кажется приятнее, писать
выпуклоболочку в 3D или алгоритм в Fortune?
Кому как.
Ну, мне кажется, выпуклоболочку попроще все-таки пишется.
Итак, что мы сделаем?
Давайте напишем выход в 3D.
Давайте скажем, что все мои точки, которые я хотел
триангулировать, лежали в плоскости z равно нулю.
Давайте я построю в пространстве вот такой параболлоид.
Двайму вот таким уравнением.
И давайте я все точки с плоскости подниму на параболлоид.
Если тут у меня были какие-то точки, которые мне хотел
триангулировать, я каждую из них могу вот так вот
поднять на параболлоид.
Ну, соответственно, если у меня была точка x запятая
y, то новые ее координаты будут x, y, x квадрат плюс y квадрат.
Просто все точки, давайте напишем, что точки pi на
плоскости я поднял, преобразовал в точки pi с волной в пространстве
на параболлоиде.
Тогда вот ожидается следующее, что чтобы построить грав-дилане,
нам достаточно поднять все вот эти точки на параболлоид,
на них построить выпуклую оболочку и спроецировать
на плоскость нижнюю часть этой выпуклой оболочки.
Сейчас я напишу, наверное.
Значит, построим выпуклую оболочку, точек pi 1 с волной
и так далее, pn с волной.
Дальше, чтобы мы построили оболочку, это какой-то многогранник
выпуклый, у него есть какие-то грани.
Так же, как в плоскости, я могу определить нижнюю
часть выпуклой оболочки и верхнюю часть выпуклой
оболочки.
Ну, грубо говоря, нижние – это те, которые вот так
вот расположены, верхние – это те, которые вот так
вот расположены.
Понятно.
Если надо, можно формализовать.
Так вот, дальше давайте мы просто спроектируем на
плоскость все грани нижней части выпуклой оболочки.
Все грани нижней части выпуклой оболочки.
Я отражаю, что мы получим в точности граф Дилане.
В частности, да.
Видите, а вы говорили, что плохой алгоритм.
Так, ну что, давайте попробуем это доказать.
Да, ну, как бы, давайте попробуем что-нибудь нарисовать
сначала.
Ну, вот пусть у меня на проблоде были какие-то
точки.
Вот у меня там была какая-то грань, например, вот, о божечка
моя.
Как?
Нет, невозможно рисовать, конечно.
Неважно, у меня тоже какая-то фигура, какой-то многогранник.
Да, очень плоский получился.
Неважно.
Значит, вот давайте рассмотрим какую-то его грань нижнюю.
Одну из нижних граней.
Моя плоскость, вот есть какая-то грань.
Что такое грань?
По факту, это какая-то плоскость, пересекающая наш параболоид.
Ну, сечение там, в общем случае, будет, наверное,
эллипс.
Давайте нарисуем эту плоскость, она как-то пересекается
по эллипсу с параболоидом, и, в частности, там есть
какая-то грань нашей выпуклооболочки, ну, например, там четырехугольник
какой-то.
Вот пусть вот эта вот грань выпуклооболочки.
Значит, тогда я ее проектирую обратно на плоскость и утверждаю,
что вот эти вот четыре ребра будут задавать одну из
граней графодилана.
То есть, по факту, грани выпуклооболочки у меня отображаются в
грани графодилана.
Вот, и, то есть, если я построю выпуклооболочку, просто пройдусь
по граням, ну, нижней части, если я нахожу очередную
грань выпуклооболочки, то она же будет гранью графодилана,
и если что, я могу ее дотриангулировать, чтобы получить триангуляцию.
Так, давайте попробуем понять, почему это верно.
Нет.
Значит, для этого сначала я построю касательную
плоскость к моему параболойду в данной точке.
Давайте рассмотрим какую-нибудь точку A, B, A квадрат плюс B
квадрат.
Давайте я рассмотрю касательную плоскость, проходящую через
эту точку, касательную к нашему параболойду.
Нет, это пока произвольная точка вообще, пока просто
точка на параболойде.
Точка произвольная, дальше проживу к ней касательную
плоскость.
Значит, как она устроена?
Я утверждаю, что, чтобы построить уравнение касательной,
точнее просто уравнение касательной, выглядит как-то
так.
Значит, ну, смотрите, мне по факту, касательная
это по факту приближение первой степени, поэтому
мне нужно продиференцировать вот здесь вот эту штуку
по X и по Y в точке A, B, поэтому коэффициент перед X будет
2AX, 2A, перед Y будет 2B, ну и дальше минус какой свободный
член?
Минус какой?
Вот такой, потому что с ним сойдется.
Ну, значит, если подставить точку AB вот с этими координатами
сюда, то как раз одна сумма квадратов уберется и будет
вот такое, такое уравнение, значит, это уравнение касательной
к плоскости параболойду в точке A, B, A квадрат плюс
B квадрат.
Дальше давайте мы ее поднимем на какое-то расстояние,
давайте рассмотрим новую плоскость, которую я просто
вверх сдвину на R квадрат, то есть вот у меня была какая-то
касательная плоскость, я ее просто поднял на R квадрат
вверх, получу какую-то новую плоскость, ну параллельную
она как-то еще пересекает наш, то есть теперь она
начинает пересекать наш параболойд, потому что
я ее поднял, вот по какой-то фигурке, по какому-то эллипсу
видимо.
Вот это новая, новая, новая плоскость.
Пока произвольное число.
Дальше, вот пусть, я хочу сказать, что пусть вот эта
вот та самая плоскость, которая задает одно из
граней выпуклой оболочки, то есть пусть вот эта штука
это плоскость, задающая одно из граней, граней выпуклой
оболочки.
Ну видимо, я любую плоскость могу так задать, потому
что я ее могу опустить до касания с параболойдом,
как получится как раз сначала вот это, потом я ее как-то
обратно поднимаю на какой-то R квадрат.
Вот, то есть я могу любую плоскость по факту, что
такое плоскость, задающая одно из граней, это такая
плоскость, проходящая через три или более точек нашего
множества, такая, что все остальные строго выше.
Что какие-то точки лежат на этой плоскости, лежат
в этой грани, а все остальные строго выше.
Я как раз рассматриваю нижнюю часть выпуклой оболочки,
поэтому все остальные точки лежат выше, чем вот эта
вот плоскость.
Получается, что в этой плоскости лежат какие-то точки, а все
остальные выше.
Все остальные выше.
Так, теперь давайте сделаем следующее.
Давайте мы спроектируем вот этот вот эллипс, который
является пересвечением.
Я вообще не глупость говорю, что в пересвечении плоскости
пробудет эллипс.
Это похоже на правду?
Гипербол, видимо, если у меня вертикальная.
А здесь что?
Не эллипс, думаете?
Это какая-то кривая второго порядка, очевидно.
Ну да, поэтому я так вольно говорю эллипс.
Давайте я вот говорю, что это эллипс, тогда никого
не корежет.
Давайте назовем это эллипс тоже.
Хороший план.
Так вот, давайте этот эллипс спроектируем на плоскость.
Спроектируем эллипс пересечения плоскости параболойда
на плоскость z равная нулю.
Я утверждаю, что получится круг с центром вa, b радиуса
r.
Почему?
Ну потому что, что такое пересечение параболойда
и вот этого вот безобразия этой плоскости?
Это те точки, где вместо z стоит x квадрат плюс y
квадрат.
Поэтому то, что я хочу спроектировать, это точки удовлетворяющие
вот такому равнению.
Но если я это перепишу в нормальном виде, у меня
как раз получится равнение окружности.
Волшебным образом.
Получается, что с точки зрения координата x, y это
эллипс, то есть после проекции на z равная нулю, то есть
если мы живем в плоскости вот этой вот нашей изначальной,
то этот эллипс выглядит как круг, как окружность.
Получается, что проекция это круг.
Ну и более-менее все.
Мы поняли, что смотрите, мы взяли какую-то плоскость,
выعة вели плоскость через одно из граний.
На этой грани, на этой плоскости лежали какие-то сайте,
какие-то точки нашего множества, все остальные были выше.
Теперь, когда я проекцирую на плоскость, у меня получается
круг.
То есть вместо вот этой вместо эллипса получается
круг, на границе которого лежат как раз эти вот сайты,
но потому что раз они лежали на плоскости, то они лежали
как раз на границе круга после проекции.
А все остальные сайты лежат выше эллипса, то есть вне
круга.
эллипса, когда вот здесь значок был больше, вот здесь вот значок был больше, выше значит z больше
чем это, значит все остальные точки, которые стояли неравенственно вот здесь больше, значит здесь больше
значит они лежали вне круга. Получается, что у нас получилось вот с точностью то, что мы хотели, что
грань выпуклой оболочки проецируется в грань графа делана, то есть набор точек таких, что все остальные
выше этой плоскости проецируются в круг, такой, что все на границе, а остальные вне, ну вот и
получилось, что грань нижней выпуклой оболочки у нас проецировалась в грань графа делана,
то есть здесь все точки должны были лежать выше плоскости, здесь все точки перешли в точки вне круга,
то есть точки выше плоскости перешли в точки вне круга.
Прикол. Это магия, мне кажется, какая-то честно говоря. Вот, то есть получается, что вместо того,
что писать Fortune, можно было бы написать алгоритм по стороне выпуклой оболочки в 3D, то есть можно
было бы поднять все точки с плоскости в пространство, запустить 3D выпуклую оболочку, дальше у вас
построился многогранник с какими-то гранями, ну мы рассматриваем те из них, которые ориентированы
как-то вот так вот, одну, то есть верхнюю часть отбрасываем и все все грани проецируем, они образуют
грань графа делана. Ну, типа того, да, потому что если мы вспомним, как у нас работает выпуклая
оболочка в 3D, у нас там каждая грань задается обходом против чего стрелки, если смотреть
со внешности, ну из внешности многогранника, то есть, например, вот если вот, то есть по факту,
после того, как вы написали выпуклую оболочку в 3D, у вас каждая грань имеет обход против всего стрелки,
и, соответственно, вы знаете, куда торчит вектор нормалии из нее, ну вот если вектор нормалии
который торчит в нему в внешности, но у вас все грань ориентирована, потому вы бы знаете,
куда смотрит нормаль здесь нормально смотрит на нас, тут нормально куда-то туда,
то нормально вверх там влево там вниз и так далее, вот ну и дальше просто по направлению вектора
нормалей, если вверх смотрит, то это верхняя часть, если вниз, то нижняя, ну то есть, в смысле если z
координата нормалия меньше равна нуля, тогда это не часть нижней, ну вот локальные
физические мемы. Так, ну хорошо, хорошо, тогда давайте последнее, что скажу, это
про двойственность вороновой делане и выпуклой оболочки в 3d и верхней огибающей. Значит,
смотрите, мы с вами, когда строили граф деланы, мы по факту построили двойственный граф к диаграмме
воронова. Мы говорили, что вершина это сайт, то есть по факту ячейка, у нас ячейки сайт это одно и
тоже, а соединяю ребрами я такие ячейки, которые пересекаются, которые соседние. По факту это
просто двойственный граф к плоскому графу. Да, кстати. Вот, значит, что-то похожее можно было бы
сделать и в пространстве. Значит, я вот ожидаю следующее. Давайте альтернативный, ну то есть такой
же алгоритм выхода в 3d для диаграммы воронова. Значит, смотрите, мы сделаем то же самое, опять,
если у меня был набор точек, я построю параболоид, подниму каждую точку на параболоид и давайте скажем,
что пусть h и t это полуплоскость, касательная полуплоскость к параболоиду в точке p и t с
фолной. Касательная плоскость к параболоиду в точке p и t с фолной. То есть я каждую точку
поднял на параболоид и вот здесь нависывал касательную плоскость h и t. Дальше, что такое,
давайте определим, что такое верхняя огибающая этого семейства полуплоскостей. Просто плоскости,
извините. Верхняя огибающая для h1 и так далее hm. Ну вот представьте, у вас вот есть параболоид,
какой-то такой стаканчик и вы провели много-много касательных к нему полуплоскостей. Они там
как-то пересекаются, что-то делают. Вот давайте мы в каждой точке плоскости проведем такой луч
вертикально вверх и посмотрим самую верхнюю точку перчения этого луча с одной из плоскостей.
То есть понятно, там много плоскостей пересекают один тот же луч. Давайте рассмотрим самую верхнюю
точку пересечения. Вот это и будет верхняя огибающая. Можно написать так, что в каждой точке x,
y на плоскости сопоставляется максимальная координата пересечения вертикального луча
с одной из плоскостей. Либо можно так сказать, смотрите, вот у вас есть какие-то полуплоскости,
по факту обрезающий ваш параболоид. Вот если мы сверху начнем наливать водичку в каждой точке,
то она как раз будет падать до самой верхней полуплоскости. То, что у вас будет водичкой,
это как раз верхняя огибающая. Нижняя граница водички, это верхняя огибающая. Ну вот,
и тогда утверждается следующее, что диаграмма Воронова, она получается проекцией верхней
огибающей вот этого семейства плоскостей. Проекция верхней огибающей. Да-да-да. Ну то есть мы
проецируем граничные точки, то есть точки, ну вот эти вот лучи или отрезки пересечения. И это как
раз проекция будет диаграммой Воронова. Вот. Ну доказывается, вот какой-то похожей техникой,
вот тоже надо просто понять, что такое, а то даже еще проще. Надо понять, что такое вот эта вот
максимальная Z-координата пересекающая какой-то вертикальный луч. То есть из всех таких плоскостей
мы выбираем самую высокую. И можно показать, что эта самая высокая плоскость как раз соответствует
самому близкому сайту. То есть вот если мы пускаем вертикальный луч, то самая высокая пересекающего
плоскость соответствует самому близкому к нему сайту. Можно показать. Вот. И, значит в чем прикол.
Смотрите, у нас есть с вами двойственность графа Дилане и диаграммы Воронова. Мы знаем,
что они получаются друг из друга каким-то простым преобразованием. И более того, существует некая
простая двойственность между вот этой вот нижней частью выпуклой оболочки и верхней
огибающей вот этого семейства плоскостей. Это похоже на то, когда мы строили пересечение
полуплоскостей. Я там говорил, давайте полуплоскости посортирую по углу и дальше там начну вот так
заворачивать. Было очень похоже на выпуклую оболочку на плоскость. Здесь то же самое. Нижняя
часть выпуклой оболочки и верхней огибающей для семейства плоскостей в пространстве это двойственная
задача. Значит, а именно, если у меня был набор точек x и t, y и t, z и t, если по точке построить вот
такую плоскость, вроде бы вот так, да, по-моему, ровно так. То есть, если я вот таким вот образом
спарю точки и плоскости, да, ровно так, то у меня нижняя часть выпуклой облочки такого семейства
точек будет совпадать с верхней огибающей, то есть, будет соответствовать верхней огибающей. То есть,
те точки, которые участвуют здесь, в нижней части выпуклой оболочки, здесь участвуют в верхней
части огибающей плоскостей. Ну и, соответственно, да, вот если здесь в этой задаче нам нужно было
найти верхнюю огибающую для семейства плоскостей, мы можем эти плоскости сначала превратить в точки,
то есть, на самом деле, отображение в обе стороны работает. Можно сначала плоскости отразвести
с точками. Ну, на самом деле, это будут как раз вот те самые точки, потому что здесь все двойственное
друг другу соответствует. Поэтому можно построить нижнюю часть вот этой вот выпуклой оболочки,
отразвести их вот с этими плоскостями, и это и будет как раз верхней огибающей. То есть, короче,
пафос в том, что двойственность диаграммы Вороновой графа Дилане позволяет нам что-то говорить
про двойственность. То есть, на самом деле, в любом случае так работает, но можно, как бы, мы здесь
на это выходим, что если у нас есть набор точек в пространстве, мы можем им сопоставить вот такие
вот плоскости, и тогда задача нахождения здесь нижней выпуклой оболочки, а здесь верхней огибающей
это одна и та же задача. Если вы умеете решать одно, то умеете решать другое. Здесь нижней выпуклой
оболочка соответствует вот здесь вот верхней огибающей. Ну вот, на этом все.
