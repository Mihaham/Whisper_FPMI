У нас какая-то лекция по счету.
Ну да, вот у нас сегодня с вами удачная лекция.
Она будет очень легкой.
Вот да, лекция вообще сегодня прям крайне простая.
Единственное, что надо будет немножко последить за
руками, потому что я буду стараться вас обмануть.
Вот, а ваш цель стараться найти обман.
И первая задача наша, ну да, у нас сегодня по сути
три задачи.
Издача первая – это дан многочлен П и число М.
Хотим найти такой Q, что Q сравнимо с единицей по модулю
хм.
Вот, это то, что мы хотим.
Казалось бы, зачем вам это надо, крайне искусственная
операция.
Ну вот, на самом деле нет, это мы пытаемся учиться
брать обратные многощены в некотором плане.
То есть, чтобы делить вообще произвольные числа, мы там
учимся искать обратные.
Вот у нас план примерно такой же, мы учимся искать
обратные.
Так, ну решение здесь будет длинным и ужасным, и в принципе
мы все от него пострадаем.
А именно, какой у нас план?
Пусть Qмт – это такой многочлен, что П на Qмт сравним с единицей
по модулю хмт.
То есть, смотрите, какой у нас план.
План такой же, что я буду вычислять обратные постепенно,
а повышаю вот эту вот степень.
Вот.
Давайте считать, что они в коммутативном кольце живут.
Проще считать, что в R.
То есть, у нас для всего есть обратное.
Можно считать, что в Q.
Ну, вот хочется, чтобы Q был тоже степень меньше.
Ну, вы умеете брать многочлен по модулю?
Ну, что такое 5x² плюс 1 у модуль x²?
Почему 1?
Ну, потому что 5x² на x² делится, остается только 1.
Это равно единичке.
А теперь можно рассмотреть 5x³ по модулю x².
Это что такое?
Ну, это тоже 1.
А 5x плюс 1 – это 5x плюс 1, да.
Потому что никакая с компонент не делится.
То есть, грубо говоря, мы сносим все степени, которые выше, чем xµ.
Вот.
То есть, вы делите с остатком многочлена, либо столбиком, либо как-то еще.
Поэтому также можно брать по модулю произвольного многочлена.
Так, пусть qmt – это вот такая вот штука.
Тогда научимся
строить из qmтого q2mтый.
План такой.
Вот.
Но еще надо будет по-хорошему научиться qmтый в qmтый плюс 1.
Вот.
Но это я оставлю вам на дом в качестве упражнения.
Это совсем легко.
Он делается аналогично переходу из m в 2m.
Просто там надо будет поменять в одном месте чиселку.
Точнее, замену переменных надо будет сделать.
Просто проведете выкладки – все получится.
Я в вас верю.
Поэтому мы рассматриваем только вот этот переход.
Если мы научимся его быстро делать, то победа, в общем-то.
Окей.
Так.
Что можно тогда сказать?
Тогда по-хорошему…
Все-таки имеет смысл рассматривать…
Ну ладно, это странное замечание.
Так.
А распусть p – это какой-то p0 плюс i1 p1 на xmтый.
Но я же могу так сказать.
Могу.
Просто взял и вынес все, что с xmтый, все, что больше, чем xmтый.
В отдельном многочлене.
То есть, если бы я рассматривал бы p равный 5x куб плюс x квадрат плюс 1,
и считал бы его m равно 2, то p равнялся…
Почему?
…х в квадрате в скобочках 5x плюс 1 плюс 1.
Вот этот был бы p0, вот этот был бы p1.
Наоборот.
Нет, все нормально.
1 и 0 – это не степень, это просто индекс.
Да, да.
p0 и p1, да.
А если бы был 0 и 0 и 0 и 0 и 0 и 1…
Нет, xмтин тогда все обошел.
p0.
Ну я бы не мог из него вынести x квадрат.
Да.
Так.
Это я записал.
Давайте я рассмотрю тогда, что такое pqmтый в произведении.
Это p0qmтый плюс p1qmxwmтый.
Окей.
А рассмотрю я по модулю xм, сравнимо с p0qmxwmтый.
Вроде логично, да?
Что такое p0qmтый по модулю xмтый?
Это ну что-то.
Пока что это просто что-то.
Аналогично заметим, что p сравнимо с p0 по модулю xмтый.
Да, я говорю, лекция сегодня в стиле хала-махала, следим за руками просто.
Поверьте, по памяти это тоже не прикольно воспроизводить.
А предположим, что q2mтый, он имеет какой-то такой вид.
То есть это qmтый наш маленький плюс xmтый на t.
Ну, очевидно, что q2mтый по степени не превосходит 2m, поэтому мы можем его так разбить.
Тогда давайте рассмотрим pq2mтый.
Это что такое?
Это p0 плюс p1 в xwmтый qm плюс xmтый t.
Ну, пока что я Америку не открыл, я просто подставил то, как я их обозначил.
Раз, два.
Давайте раскрывать скобки.
Так, p0qmтый плюс p1xwmтый.
Так, p1qmxwmтый.
На этом дальше.
Плюс p0txwmтый.
И последнее это p1t.
p1t и к степени 2mтый.
Так, алгебра седьмого класса окончена.
Отлично.
Сравнимо с... так как мы все-таки рассматриваем по x2mтый,
давайте посмотрим по модулю x2mтый, это все урожение.
Так, нужно взять и написать p0qmтый плюс xwmтый в скобочках p1qm.
Плюс p0t по модулю x2mтый.
Да.
Очень плохо.
Это некрасиво.
Вот.
Так, теперь нам нужно понять, чего мы хотим по сути.
Мы хотим, чтобы это было сравнимо с единицей, да, по модуле x2mтый.
То есть хотим...
Чем хотим? Мы хотим, чтобы p0qm плюс xwmтый
p1qm плюс p0t
было сравнимо с единицей по модулю x2mтый.
Так.
Что теперь надо сказать?
Сейчас.
Так.
Давайте поймем, что мы из этого знаем.
P0 знаем?
Знаем, да.
P1 знаем.
qmтый мы будем считать, что мы знаем, потому что из qmтый переходим в q2mтый.
Это мы тоже знаем.
И p0 мы знаем.
Да.
Ну, давайте тогда скажем следующее, что вынесем то, что созвестно в одну сторону, снеизвестно в другую.
Или нет, сейчас.
Так.
Па-па-пам.
Как теперь нужно выкрутиться из этого всего дела?
Так.
Давайте рассмотрим что-нибудь типа, не знаю.
Сейчас надо подумать как-то все.
Надо отсюда выразить t, вот так скажем.
То есть, мы получаем, что xwmтый
p1qm плюс p0t
сравнимо с единичкой минус p0qm.
Да.
Это все по модуле x2mтый, конечно, берется.
Теперь нужно понять, что такое p0qm по модуле x2m, по-хорошему, да.
Вот если мы это понимаем, то это победа.
Вот здесь я первый раз загляну в телефон, потому что если я, к сожалению, гибридческий преобразователь, не хочу уводить слишком много раз.
Вот.
Так.
А, ну смотрите, да, у нас же p0, что единичка?
Нет, сейчас.
Не, не, сейчас, здесь верно все сказали.
Сейчас нужно сказать про какое-нибудь произведение классную штуку.
А именно, так.
pqmтый сравнимо с p0qmтый равно p1qmxm равно p0qm по модуле xm, да.
То есть, тогда вот из этого следует.
А, ну и p0qm с чем у нас равен по модуле единичке?
Все по модуле x2mтый.
Сейчас, все, давайте я здесь напишу.
Так.
pqmтый сравнимо с p0qm, да, по модуле xm.
Это вот отсюда выберется.
Дальше нужно написать следующее, сказать, что если у нас верно это, из этого следует, что p0qm имеет какой-то вид.
А, ну и при этом мы pqmтый по модуле xm, это что такое по сути?
Собирался так, чтобы это равно единице было.
Откуда вот следует, что p0qmтый имеет вид 1 плюс xmтый на какой-то R.
Понятно шаг?
Ну вот еще раз, у нас pqmтый, это была просто единичка по модуле xmтый, мы qm так брали.
Вот с другой стороны, то же самое, что p0qm, ну по вот этому интеллектуальному соображению.
Поэтому могу сказать, что p0qm, это вот такая вот штука.
Поэтому давайте я напишу следующее, подставлю просто вот этот p0qm вот сюда.
Я получаю, что 1 плюс xmтый R плюс p1qm плюс p0t, это сравнимо с единичкой по модулю x2mтый.
Но qm, это по определению такое многочерство, что qm сравнимо с единичкой по модуле xm.
Здесь никакой магии нет. Здесь магия заключается в том, что мы просто берем p и расписываем.
p0 плюс p1xmтый.
Вот, получили уравнение, оно уже более красиво, потому что от единичек мы избавляемся.
Мы избавляемся, а единички избавиться от единичка всегда приятно.
То есть мы получаем с вами, что xmтый R плюс p1qm плюс p0t, сравнимо с 0 по модулю x2mтый.
Ну что из этого можно сказать?
Это то же самое, что вот эта штука сравнима с 0 по модулю xmтый.
То есть тогда я хочу, чтобы R плюс p1qm плюс p0t, сравнимо с 0 по модулю xmтый.
Так, теперь осталось понять, что мы хотим, собственно, найти из этого выражения.
Вот это?
Я взял 1 плюс xmтый R и подставил сюда, вместо этого.
И xmтый R просто сюда занес.
Почему вот это?
Что именно?
Да вот, потому что мы хотим.
Потому что q2m так определяется, что эта штука сравнима с единицей по модулю 2m.
Это то, что мы хотим.
И мы сейчас говорим, если мы хотим это, то мы должны сделать вот так.
Чтобы сделать вот так, мы должны сделать так.
Чтобы сделать так, мы должны делать так.
И теперь мы хотим понять, о чем неизвестно.
Так, давайте поймем, что нам неизвестно из этого всего.
p0, p1 мы знаем, это просто куски p.
qm мы знаем, он как бы нам приходит на прошлом шаге, каким-то магическим образом.
Пока не знаем как.
Понятно, я вам буду по индукции приходить к нам.
Базу чуть позже рассмотрим.
R, знаем ли мы R?
Потому что мы знаем p и мы знаем qm.
Можем p на qm перемножить и просто срезать все, что выше xmтый.
Получим R.
Поэтому R мы тоже знаем.
А для q2m, что нам нужно?
qm знаем, это знаем.
Мы не знаем только t, то есть нам нужно t найти.
Давайте отсюда выразим просто.
Тогда t сравнимо с minus p0 minus 1.
R plus p1 qmтый будто бы.
Да?
Сейчас, вхож на правду.
Да, вхож на правду.
Ну, qm нам дали, да.
Удержается, что он там...
Потом посмотрим, когда он существует.
То есть мы нашли с вами t по сути.
А мы знаем, что такое p0 в минус 1?
Ну да, по модулю xmтый p0 в минус 1 это q.
Ну qmтый точнее.
Поэтому t сравним с minus qmтый R plus qmтый.
Поэтому t сравним с minus qmтый R plus p1 qmтый по модулю xmтый.
То есть, итак, что мы с вами берем?
Как мы переходим с вами от qm к q2m?
Мы говорим q2m это вот такая вот штука,
где t вычисляется вот по этой формуле.
И тогда получается все ок.
Вот тут.
Вот, мы xmтый убрали.
Это неправда.
xmтый не сравним с нулем.
xmтый по модулю xdmтый с нулем не может быть сравним по определению.
Правильно единичке.
Ну еще раз, 5x2 по модулю x2, это что такое?
Это 5.
Сейчас.
А, мы же остатки есть сразу.
Да, это ноль.
Окей, да.
Ну все равно x2 по модулю xq, это что такое?
Вы пытаетесь x2 поделиться остатком на xq.
Остаток x2.
Вот, все.
Поэтому xmтый x2мтый здесь вот так вот соотносится.
Мы можем xmтый просто вычеркнуть и поделить на xmтый, считать остаток.
Ну окей, мы взяли из двух.
Вот у вас был многочлен a, был многочлен b.
У них есть какой-то x в общей степени.
Можно вынести из них обоих.
Другой остаток не изменится, если вы на этот x в общей степени поделите.
Мод это остаток.
Берете остаток по модулю.
Ну окей.
Что такое x2 поделить на целый xq?
Это 0.
И в остатке x2.
Так, ну ладно, я думаю, вы поняли, да, как qm, q2m переходить.
Вот, соответственно, тогда если у вас есть переход.
Абсолютно аналогично, можно в qm плюс 1 переписать.
Только вы говорите, что здесь не xмтый, а просто x.
Конец.
Ну и дальше здесь вот везде правите чиселки.
А можно просто сказать, что q2m также является qмтый?
Ну, будто бы нет.
Потому что когда вы берете остаток по модулю x в 6, это не то же самое, что остаток по модулю x в 7.
Остаток к модулю x в 7 это не остаток к модулю x в 12.
Ну да.
Если у нас по модулю x7 будет единица, это значит, что у нас произведение имеет вид 1 плюс какое-то многочленное x7.
Если мы это будем брать по модуле x6, то у нас все равно 0,5.
Будут бы да.
Ну ладно, не суть.
Ку должна быть степень маленькой.
Кого?
Ку должна быть степень маленькой.
Ну мы хотим ку маленькой степени.
А, модели использовались?
Где? Вот это?
Да.
Сейчас, ну будто бы нет.
Так вот, модели использовались в монтажной моде.
Сейчас.
Вот это?
Нет, вот здесь мы пользовались тем, что у нас...
А, ну вот да, мы здесь с этим пользуемся.
Мы-то на ку м сокращаем.
Ну ку м мы считаем, что он в степени меньше, чем м.
Поэтому он не будет давать 0 по модуле x7.
Давайте я скажу, что...
Степень ку меньше, чем м.
Ой, оно большое здесь.
Вот так скажем.
Потому что можно огромную взять ку с огромной степени и все это обнулить.
Нет, мы хотим ку маленькой степени.
Ну и?
Ну да.
Ну да.
Ну просто к тому, что
ку лучше все равно не искать огромным каким-то.
Пытаться сразу, а лучше его маленьким сразу искать.
Так, ну давайте базу индукции вывели.
Переход-то вывели с вами.
Так, база индукции.
Это внезапно ку 0.
Кто такой ку 0?
Ку 0 такая-то константа, да?
Сейчас.
Давайте ку 1 искать лучше.
Ку 1. У него степень 0.
Это какая-то константа c.
Ну давайте ку точнее.
Ку маленькая, да?
Тогда p ку1
должно быть сравнимо с единичкой
по модулю x.
Что это значит?
Это значит, что все штуки из p,
они уйдут как бы.
То есть если у нас p это a0
plus a1x
плюс и так далее,
то p по модулю x
это a0.
Просто-напросто.
p ку1
сравнимо с a0
q по модулю
x.
Но откуда следует, что q
равно a0
минус 1?
То есть вот база индукции.
Мы считаем, что мы
в чем-то хорошем живем, типа r.
Ну или zp какого-нибудь.
Вот это то, что нужно сделать.
То есть вы просто берете x
и m сокращаете на самом деле.
Это для произвольного
m вроде работает.
Вы к чему? Вы к тому, что
если a0 равно 0, то что-то
надо делать?
С одной стороны, да.
С другой стороны,
если мы умеем быстро находить
обратную емкость
мы считаем, что умеем, да.
Да, непонятно зачем
нам вообще по емкости искать многочлены,
если можно его конструктивно построить.
Ну может построить конструктивно,
я не вижу какого-то быстрого способа.
Ну,
золотые емкости вряд ли.
Ну окей, давайте во время перерыва расскажете свой способ.
Я почему-то не вижу здесь
способа быстро.
Так, то есть мы с вами научились искать
по попам обратную эквоному.
Так называемый.
Давайте делить многочлены.
Задача.
По данным.
Давайте их обозначим.
Давайте по ку.
Не, давайте я уже обозначу,
чтобы было как конспектий, вы не путались.
Найти такие
ку-р,
что
ну что такое
деление с остатком?
Этому значит f равно же
на q, то есть
делимое,
делитель частное,
плюс остаток.
Чему должна быть
степень меньше,
когда мы остаток считаем?
Почему q? По-моему g.
Мы же степень q не знаем.
dqr меньше, чем dqg.
Мы делим на g.
f на g делим.
Ищем qr.
Здесь понятное дело
имеется ввиду
ку-р,
ку-р,
здесь понятное дело имеется ввиду,
что степень f
больше, чем степень g.
Иначе
непонятно, что вы вообще делаете.
Но если равенство, то там все легко.
Никакого алгоритма запретать не надо.
Окей.
Чтобы
решить эту задачу, нам придется немножко
помучиться, а именно ввести
интересную функцию.
Определение.
Пусть p
это a0
плюс a1x
плюс an-1xn-1.
Тогда ref от p
это an-1
плюс an-2x
плюс a0xn-1.
То есть мы разворачиваем
вектор коэффициентов.
Поэтому ref, reverse.
Нам нужно будет сейчас несколько самих свойств
вывести про ref.
А именно их два,
которые мы будем применять.
А после того, как мы их выведем, там алгоритм деления
это типа,
два шага сделать, по сути.
Первая, a.
То есть ref можно
раскрывать в произведении.
Уже не очевидно, да?
Так, второе.
Пусть степень a
больше, чем степень b.
Тогда
ref от a
плюс b
это ref от a
плюс ref от b.
И не зря я добавил свойства на степени
условия.
Вот такие вот утверждения.
Ну, второе доказывается методом
пристального взгляда, на самом деле.
Первое доказывается
чуть-чуть сложнее, чем методом пристального взгляда.
Надо два пристального взгляда.
Вот.
Давайте я веду обозначение.
Я буду им пользоваться
xкатой от p.
Это коэффициент p.
Это коэффициент p
при
x степени k.
Берется много счетов.
Берется кат и элемент в коэффициенте
векторов.
Векторе коэффициентов.
Ну, давайте
доказывать.
Давайте рассмотрим xкат ref
от ab.
Что это такое? Что вообще такое коэффициент
многочисленный по определению?
По определению это просто сумма
кого с кем.
По всем
i плюс j равным k
произведений.
Так, давайте
выписывать, какие произведения у нас здесь будут.
Только так, как здесь ref,
у нас здесь будет
deck a плюс deck b минус k.
Вон обозначение.
Плюс deck b
минус k.
Ну, deck a плюс deck b это степень
произведения ab.
Минус k, потому что у меня
реверс намногочисленный здесь будет.
При x в итой a
на x в житой b.
Ужасно.
Давайте теперь
сделаем
халай-махалай трюк.
А именно сделаем
очень страшное.
А именно немножко
перекинем местами индекса суммирования.
Так, плюс
deck b минус j
равно k.
То есть, смотрите, я просто взял и
перекидывал знаки в индексе, больше ничего не сделал.
То есть, я взял
i и j перенес сюда, k сюда.
И поменял местами.
И группировал deck a минус i, deck b минус j.
А здесь выражение такое же абсолютно.
Теперь, смотрите,
ну, если я сделаю замену переменной,
замену переменных, да,
в суммировании.
А именно
u плюс v
равно k.
Если у меня
u это deck a минус i,
то и это deck a минус u.
Согласны?
Deck a минус u,
a на
x,
deck b минус v
от b.
Окей.
Что теперь стоит заметить?
Что это, по сути, у-ты коэффициент
рефа тая, в-ты коэффициент рефа тая.
В-ты коэффициент рефа тая.
Так, по u плюс v
равно k.
x у-ты
рефа тая
на x в-ты
рефа тая.
Очень плохо.
Какой?
У нас не было коэффициента рефа тая.
Он разложился на ниже.
Ну, что такое коэффициент
ката и коэффициент многочленов произведения?
Это сумма всех попарных
произведений, которые в сумме дадут k.
Всё, вот сюда и оно и делось.
Почему здесь перешли мы к этому?
Потому что у нас здесь реф.
Мы должны вычислить сумму степеней,
то есть из степени произведения
вычислить k.
Итого, что мы с вами
получили?
Ну, здесь теперь можно записать,
что это просто-напросто по определению
при x катой
от
рефа от a
на рефа от b.
Смотрите, ловкость рук и никакого
мошенничества. Получил коэффициентное совпадение.
То есть для любого k получил коэффициент
равный у этих двух многочленов.
Это значит, что многочлены равны сами по себе.
Поэтому первое доказали.
Первое.
Так давайте вторую доказывать.
Картинку вторую штуку.
Можно я скажу, что доказательства методом
приставного взгляда подходят?
Или вы не поверите?
Ну реально видно.
Вот не, а прямо очевидно на самом деле.
Я могу написать очевидно.
Нет тут приставного взгляда.
Ну ладно.
Как-то можно доказывать.
Мне лень рисовать картинки.
Можно нарисовать картинки,
но мне лень.
Хотя давайте нарисуем картинку.
В конспекте есть формальное доказательство,
а я картинку нарисую.
Давайте я рассмотрю a плюс b. Что это такое?
Мне просто было лень
вравнивать их там
все эти коэффициенты, а здесь я могу повыравнивать.
Поэтому я займусь тем,
что буду выравнивать их.
А, я нанесу второе.
Ну точнее там все то,
что сам будет записано, только не в картинке
таких вот формулах громадных.
Ну у меня сойдет.
Какого-нибудь другого может нет.
То есть это наш могучлен a.
Мы его складываем путем
очень интеллектуального метода
называется столбик.
Здесь такой
не анекдот, это прибаутка.
Когда человек пишет
не нравится треугольника, треугольника с большую букву.
Здесь также можно метод столбика
и столбик тоже с большую букву писать.
Вот это сумма.
Ну не понятно, как оно устроено в общем-то.
Ну оно устроено в следующем образом.
Что вы берете сюда
m-1.
Здесь у вас будет a-1
плюс b-1.
a-1 плюс b-1.
А, все я вспомнил, как я это доказывал в конспекте.
Я это доказывал в том,
что просто брал и в тупу
считал эти многочлены и считал, насколько мне нужно
сдвинуть, чтобы сошлось.
Вот, а здесь я нарисую картинкой.
Теперь я хочу рассмотреть реф
от a плюс b, что это такое.
Реф от a плюс b тогда.
Так, давайте это a.
Здесь буду писать, что и что.
Это b.
Это a плюс b.
Теперь рассмотрим реф от a плюс b.
Так, реф от a плюс b, то можно взять и реверснуть,
что это делал.
То есть, это a0 плюс b0.
Это та.
Ну, сейчас самое плохое.
Надо понять, какой индекс будет
вставить в реверсе.
Может, нормально распишем?
Как вам идея?
Я бы расписал нормально, на самом деле.
Так нет, мне нужно понять, что
на этом месте писать.
Нет, здесь будет
n минус m, ты в этом проблема.
Потому что у вас здесь m отсюда считается, значит
отсюда будет считаться m, а значит
банально, а, ну,
то есть здесь n минус m, то здесь где-то m,
то здесь стоит еще что-то дальше.
Вот, здесь неудобно картинкой доказывать.
Ну, чуть-чуть неудобно.
Уже готовы, да?
Согласно картинку.
Давайте скажем, что где-то здесь стоит вот этот чувак.
Плюс. Здесь уже а и м
остается.
Ну, остается рассмотреть
рев от а и рев от b.
Ой, да.
Спасибо.
m минус 1.
Так, теперь рев от а и рев от b остается рассмотреть.
Рев от а.
Это вот то, что у нас устраивает.
Давайте m минус 1.
Здесь дальше
м минус 1.
Здесь дальше
тра-та-та.
Так, здесь а и м.
Здесь тра-та-та.
Здесь
а, м минус 1.
Рев от b рассматриваем.
Здесь я должен понять,
с какого места писать. На самом деле,
это не очевидно.
b, м минус 1.
Тра-та-та.
Сейчас. Да.
И это здесь будет стоить b 0.
А мне нужно, чтобы это с этим совпало.
Значит, насколько мне надо сдвинуть?
Сейчас.
Ну да, на m минус 1 надо сдвинуть.
То есть я должен вот это получить, чтобы это было будто бы
n минус 1 на самом деле.
Я должен сдвинуть на n минус m.
Чтобы получить этот сюда,
я должен его сдвинуть на n минус m сюда.
Вот это умножение на x,
это и есть двиг.
Вот доказательство в этом картинке.
Доказательство в этом формальных записи
сделать все то же самое, только
иксы расставить в нужных степенях еще.
И не запутаться в индексах.
Я все-таки проделал умственный труд
и сделал это.
В конспекте это не читабельно,
но это корректно.
Вот это тоже не читабельно
без контекста, но
это красиво.
Кто из вас эстет, тот выберет это.
Кто из вас
физтех, тот выберет формальное доказательство.
Это не значит, что эстет не может быть физтехом
и наоборот, потому что
наверняка среди физтехов много эстетов,
но не наоборот.
Ну или функцию ref давайте теперь многощин делить.
Так, мы хотим f равно jq плюс r,
да?
Ну, очевидно, что если я знаю q,
я знаю r.
Потому что r равно f
минус jq.
Конец.
R я нашел, я молодец, давайте
искать q.
Ищем q.
Так, и здесь
будет неприятно, потому что надо...
Давайте посмотрим,
что такое ref от f на самом деле.
Это ref от
jq плюс r,
а это
ref от
j на ref
от q.
И теперь давайте поймем...
Ну, опять же, плюс ref от r,
но нужно понять, на какую степень надо умножать.
Давайте поймем, что вот
степень jq это степень
f, по сути.
Но это очевидно должно быть.
Это нужно брать степень f
минус
степень r.
Так, что теперь я говорю?
Я знаю, что...
Так,
deck r меньше,
чем deck q.
Надеюсь,
зрители не умерли
от оглушающего кашля.
Ой, deck f.
Извините, Егор.
Я умер.
Так, deck r меньше, чем
deck j.
Из этого следует, что
deck f
минус
deck r.
Какую я могу взять
сюда штуку?
Но она, видимо, больше...
Так, из одного
вычитаем одно и то же, поэтому она больше,
чем
deck f
минус deck q. Ой, deck f минус deck j.
Согласны?
Вроде
логично, да?
Или нет?
Но из одного и того же вычитаю
здесь что-то поменьше, а здесь
что-то побольше.
Если из одного и того же вычитать
поменьше, то будет побольше.
А тогда я могу здесь написать
вот так вот.
Больше равно, чем плюс один.
То есть, если я строго больше этого,
то я больше равно, чем плюс один.
Чистая математика, как говорится.
Окей. Что теперь нужно сказать?
Ну, давайте я возьму
вот это вот равенство прекрасное
по вот такому прекрасному модулю.
План капкан,
я считаю.
Давайте обозначим это
звездочкой.
Рассмотрим звездочку
по модулю
х в степени
deck f
минус deck j
плюс один.
Так как степень этой штуки
больше
чем эта,
значит, вот эта штука,
вся вот эта вот х,
взятый по вот такому модулю, он уйдет,
он будет нулю равен.
Но х5 по модуле х кубе
это ноль.
Так же и здесь.
Вот эта штука ноль, значит, и реф r равен нулю.
Мы избавились от r с вами таким хитрым образом.
То есть мы с вами взяли специальную функцию реф
такую, чтобы она r вычленяла
и еще там домножала на какую-то маленькую степень.
Точнее наоборот большую.
А давайте будем по маленькой.
Так как
deck f
минус deck r
больше в общем deck f
минус deck j плюс один.
Из этого следует, что
х в степени
deck f
минус deck j
сравним с нулем по модулю
х в степени
deck f
минус deck j
и здесь плюс один,
которые почти вместились.
Вот.
То есть это ноль, тогда это обнуляется
и тогда реф f сравним
с вот этой вот штукой.
То есть реф от f
сравним с
реф от g
на реф от q
по модулю
х в степени
deck f
минус deck j
плюс один.
Логично, да?
Ну тогда
мы уже умеем
брать обратную по модулю.
Мы этим занимались
пол лекции.
То есть мы можем взять и сказать, что тогда реф q
это реф f на реф g минус 1.
На реф q
сравним с
реф от f
на реф
с g
минус 1
по модулю
х в степени
deck f
минус deck j
плюс один.
То есть я знаю реф q по модулю.
Это мне известно.
Это я могу посчитать. Это взять обратную по модулю.
Это взять
перемножь с помощью fft.
Окей.
Ну согласитесь,
что я знаю только
с точностью до вот такого модуля.
А теперь последний
финт руками.
Это вот такое вот соотношение.
Откуда у вас следует, что
реф от q
просто равен
реф от q
по модулю
х в степени deck f
минус deck j
плюс один.
Конец.
Это это?
Это.
Там реф g
минус 1?
Это g.
Вы берете все скобки,
минус 1.
То есть смотрите, я нашел реф q
по модулю вот такому вот.
Но у меня степень q
это степень f
минус степень g.
Поэтому на самом деле степени
х, которые обнулялись бы при таком взятии,
их просто нет.
Из этого следует, что я нашел в точности реф q,
а не по модулю.
Ну тогда я знаю q.
Раз я знаю q,
я знаю r.
Задача решена. Так, давайте посчитаем по времени,
что происходит.
О том, что-то в обратном не оценили по времени.
Так, в обратном, что мы с вами делали?
В поиске обратного.
Переход qm
q2m.
Это было что?
Это было просто несколько произведений
с помощью fft и сложений.
Там мы ничем
экстрамаганта не придумывали.
Поэтому он был за
у от m log m.
Теперь давайте посчитаем
для x в m большой.
Что мы с вами делали там, по сути?
Тогда
для x в m
нужно рассматривать
его в следующее время работы.
Это будет сумма
пока вот
ну от 0 от 1 не очень важно.
Это константа.
Это константа
до log2m можно округлить вверх,
можно округлить вниз.
Я не буду округлять,
потому что
мне лень писать лишние символы потом.
Сумма o от
это номер шага,
значит многочисленно катом шаге
имеет степень 2 в каты.
2 в каты,
log2 в каты.
То есть это сумма
пока от 1
в m большого
от k
вог k.
Я молодец.
Я получил гениальную симпатику.
Сейчас бы пришлось вог квадрат.
Не успели бы многочисленно прочитать.
Ну, применяем
сложнейший трюк с первой
лекции.
Ну или со второй я уже не умею.
Что мы можем oшке,
сумма oшка, это oшка сумм
k на 2 в каты.
Давайте оценивать эту сумму.
Чего? Нет, зачем?
Все проще.
Сейчас.
Ну,
ну,
ну,
ну,
сейчас.
У нас
будет такой ряд уже.
Ну, давайте оценим по-другому хорошо.
Давайте я чуть по-другому
сделаю. Я буду брать
многочленнее
2 в каты,
а то, что у меня на катом шаге
остается m делить на 2 в каты чиселок.
Или так тоже получится плохо.
Нет,
он не сходится, это очевидно,
если я всегда бесконечно поставлю.
Я не хочу
интегрировать. Интегрировать это для
слабаков.
А, ну все,
придумал, окей.
Я оценю k везде
как максимальное значение, то есть
логарифм.
Ну,
к сожалению, иногда приходится
жертвовать некоторыми вещами.
Ну, понятно, что это 2 в каты плюс 1.
Ну, сравнимо с 2 в каты плюс 1,
да. То есть сравнимо с
2 в каты. Ну, сумма степеней
двоек, если вы вдруг не знали.
Это, конечно, обидно, что вы не знали.
Какая геометрическая прогрессия?
Это самое главное соотношение информатики.
Когда у вас все в битах работает.
Короче, это порядка m будет.
Кто не верит, тот
не прав.
Ну, еще раз, здесь 2 в каты плюс 1 будет.
Ну, порядка 2 в каты плюс 1 что-то.
2 в каты плюс 1, то что-то порядка
2 в степени лог 2m.
То есть что-то порядка m. Конец.
Ну, как говорится,
я опять же говорю, что
алгоритмисты главные обманщики. Все в константу.
Какая константа, мне считает ли?
Вот, m лог m.
Да, мы не рабы константа,
поэтому мы можем себе позволить
на нее забить.
Ну, в плане...
Вы хотите тетп написать?
Ну, вы можете гарантировать тетп,
потому что у вас по сути просто преобразование фурье внутри,
поэтому здесь каждый шаг за тетту работает.
Но
мы не рабы тетп,
мы фанаты его большой.
Я позволю себе писать его большой.
Ну, смотрите,
надо заметить очень сложную закономерность.
1 это...
Нет, для 1 это не работает.
Для 1 плюс 2 это уже работает.
1 плюс 2 это 3.
Это 2, 2 минус 1.
Для 1 тоже работает, кстати.
Ну,
я надеюсь, что это не нужно доказывать.
Это все-таки должно быть уже
очевидно в какой-то момент времени
стать.
Для 0?
2 в какой степени это 0?
Ну, спорно.
О пустых суммах надо говорить аккуратно.
Это примерно как про пустые множества.
Вот,
из пустого множества, наверное, что-то может исследовать.
Из пустой суммы, наверное, можно все что угодно
поставить, потому что она не определена.
Вот, так.
Это все, конечно, смешно.
Но что у нас в итоге
остается? У нас остается 20 минут.
И у нас с вами, в сути,
мы прошли почти все, что я хотел.
Ну, как почти все осталось? Многомерное фурье.
Это что-то очень страшное, что-то очень непонятное.
Поэтому ничего доказывать я не буду.
Не, ну, надо рассказать что-то такое.
Определение.
Пусть
pad
x1
xn
это многочлен от n переменных.
2.k
2.k
Превьюшку
мы будем многомерное ффт изучать.
А здесь не было превьюшки
изначально, поэтому и нет.
Начнем от k переменных.
Не, ну, кликбейт в том, что мы потом
будем изучать, как свертки работают,
сверточные слои в миросетях.
План такой примерно.
Нужно собраться и ввести теорию.
Вот хорошим мы сегодня концу лекции
построим все основные блоки сверточной
нейросети, как они агритмически устроены.
План такой.
Возможно, он не сбудется.
Я не уверен.
Пусть pad x1 это многочлен от n переменных.
Назовем
маргинальной степенью
x и t
маргинальной степенью
x и t
число d i t
что
x степенью d i t
входит
как часть
какого-либо манова
какого-либо манома
максимальная
есть маргинальная плотность
степенью
маргинальная плотность это стер вера
тогда степенью многочлена
от n переменных
степенью
тогда маргинальная степень p по y
это 4
маргинальная степень p по x это 3
x в квадрат y в четвертый плюс x куб y в квадрат
x входит в максимальной степени в тройку
y в четвертый
маргинальная степень p по y это 4
по x это 3
тогда степенью p
d к p
обзовем просто произведение
маргинальных степеней
я их обозначал d i t
и буду дальше обозначать d i t
понятно почему это так
потому что все таки степень многочлена
это максимальная степень
нам нужно именно вот это
почему?
это 4 на 3
да
к сожалению я не настолько хорош
чтобы обрабатывать произведение на лету
мне нужно сохранить
применные в память сначала
а потом я уже могу посчитать
я не настолько хорош
теперь нужно обозначить что такое fft
очень страшное определение
fft от p
это
камерный массив
где
fft
от p по индексам
и катой
это будет p
от
сейчас
скажу точно
omega d1
в степени i1
omega d в катой и катой
что такое omega
jt и t
omega jt
это e в степени
2ep
j деленное на
2ep деленное на j
вот так вот
то есть это корень житой степени из единицы
нижний индекс будет обозначать корень какой степени я беру
то есть смотрите по x
я стер тут
прекрасный
давайте я его заново верну
какой-нибудь вот такой вот
может он не совпался с тем
но к сожалению ссылка провисла
я вынужден был новый писать
следственно тогда что у меня получается
по x у меня маргинальная плотность это 4
я буду говорить
маргинальная плотность
потому что есть терверная штука
вы должны как бы define плотность степени
в этом месте сделать
маргинальная степень
маргинальная это маргинальная
соответственно
тогда у вас по первой переменной
по x d1 равно 4
степень 4
здесь хорошо надо говорить
плюс 1
по 2 степени сюда
что правда давайте запишемся
плюс 1 еще
вот
поэтому у вас здесь будет перебираться 5 значений
омега 5 степени
0 1 2 3 4
а по y будет перебираться
маргинальная степень
это 3
будет перебираться корень 4 степени
из единички то есть
на 4
давайте я здесь подпишу что омега
это 2 и пк делить ножи
вот перебираться возможно эти значения
утверждается
теориям без доказательства
что по массиву f of t
можно восстановить много член
однозначно
то есть если мы в тот раз
могли с вами сказать что раз у нас был
n различных точек мы могли просто
матрично записать
здесь тоже можно матрично записать
я вам сразу скажу можно взять вот этот
весь гипермассив
развернуть
делать от него флаттен
вы получите размер
массива произведения
поэтому здесь вводится
записать огромную матрицу
которая будет стоять произведение
омег в соответствующих степенях
и надеяться что все сработает
на самом деле все сработает
потому что будет везде разные омеги получаться
однако определитель будет не нулевой
а доказывать что он не нулевой
я не буду
теорема
без доказательства
что
по f of t
от p
восстанавливается p
однозначно
в некотором плане мы не будем доказывать
однако многомерное f of t приведем
проведем точнее
потому что сам алгоритм зачем
все это делать
зачем все это делать я объясню чуть позже
когда мы это сделаем
потому что иначе если я скажу зачем мы это делаем
вы не будете слушать как
потому что уже пофиг
поэтому надо стоять за травочку
конец
алгоритм
алгоритм
давайте начнем здесь
закончим где-нибудь в другом месте
алгоритм вычисления
многомерного f of t очень прост
в нем всего лишь k плюс один шаг
шаг ноль
это
представим p
в виде k
многомерного
массива
где
в
комерного массива
давайте а
где а
и один
и катый
это просто коэффициент при таком маноме
от b
да, наше определение коэффициента
можем расширить
ой, почему из запятые
умножить на и так далее
умножить на x катый
x катый же катый
почему же
все, это смерть
вот так вот
потому что есть i стоят
здесь
нет, и
здесь
но это просто что такое
как понимать вот эта нотация
оно с этим не связано
это обозначение
не более чем
то есть что нижний индекс обозначает то
в какой степени корень за единицы
то есть корень 3,4,5
степени за единицы
а верхний индекс обозначает степень
вот
то есть получается
что многочисленный может дать матрицы
или гипермассивом
если у нас там больше чем две перемен
ну сейчас
план такой
делать FFT по всем измерениям пока
не устанем
шаг первый
да, вы что хотели
комерный FFT так одномерный FFT
я говорю k плюс 1 шаг, вот первый пошел
дальше осталось k
зафиксируем
значение
x1
xk-1
зафиксируем в плане
некоторого формального ряда
то есть я могу записать многочисленный как формальную сумму
я буду читать просто какие-то буквы
и они не участвуют в алгебрической подстановке
вот
тогда
p от x1
xk начинает
зависеть только от одной переменной
на самом деле
у некоторых p-штрих
но это наглашение от одной переменной
потому что x1, xk-1
будут как бы сказать, что их нет
а
проведем
одномерное FFT
для
всех
возможных
мне
удобно писать степеней
x1
xk-1
проведем только одномерное FFT
что?
то есть если я беру
если у меня многочисленные двух переменных
я беру матрицу
и провожу FFT по столцам
то есть я вот каждый столец беру его FFT
как одномерно многочисленный
вот
то есть если это
коммерный массив
я беру, одно измерение фиксирую
и вдоль всех
возможных массивов
делаю FFT
что?
берется один столбец
у вас получается одномерный массив
конец
вы делаете FFT на нем
одномерное
потому что это одномерный массив
как будто вы какой-то многочлен
смотрите
у вас была маточка чисел
вы берете FFT
в таком измерении сначала
то есть это один многочлен, это второй многочлен
шаг второй
это во втором произведем
но почему это верно
потому что в конце концов у вас действительно получится
что вы подставили все вот эти
все будете фиксировать по одной переменной сейчас
и все
шаг второй
это зафиксировать XK-1
все остальные отпустите в свободное плавание
и так формом пройтись по всем измерениям
вот получается что у вас получится вот это
но это вроде понятно почему
как раз таки получится
причем во всех возможных ипостасях
потому что вы все возможные наборы перебирали
для каждой фиксированной
не пытайтесь это представить в четырехмерном случае
не получится
в трехмерном еще хоть как-то
в четырехмерном совсем все плохо будет
то есть как бы в четырехмерном вы берете
в трехмерном вы что делаете
вы берете двумерные подпространства
и будто бы от них вызываете
рекурсивные FFT на самом деле
можно еще так-то рассмотреть
если хочется
так что
если вы хотите
если хочется
давайте здесь скажу
шакаты
зафиксируем
X2
XK
проводим
одномерные FFT
то есть смотрите
по сути многомерные FFT
очень много раз применить одномерные
доказывать почему это
корректно конкретно
здесь надо
по-хорошему взять матан
и посмотреть что
камерное фурье
это можно его разложить в маргинальные
компоненты фурье
X2
X2 это расстояние
X2
X2 это расстояние XK
потому что X1 должно направиться в свободное плавание
на каждом шаге
то есть в матане вы можете
доказать что двумерное фурье
это фурье сначала по одному измерению
в том фурье по второму
с помощью каких-нибудь сериям фубини
по крафтным интегралам раскладывать
вот здесь к сожалению это не получится
я оставлю это без доказательств
что это работает
ну давайте подумаем
что если мы умеем делать
фурье через одномерные фурье
abbiamo обратное многомерное фурье
да при чём в обратном порядке
теперь вы берете обратное фурье по X1
обратное фурье по X2, по X3
обратное фурье по XK
вы восстановили многоч rigor
поэтому теперь
если вы умеете
вот вы умеете многомерный
фурье значит вы умеете многомерное уменьш engaging
по сути
Нет, это не важно. Важно, чтобы обратно вышли в обратном
порядке. Вот это важно. Тогда это будет работать, иначе
это не работает, насколько я помню. То есть здесь порядок
не очень важен, потому что вы можете банально y и x
поменять местами, а наоборот, это не то, чтобы изменилось
сильно. Давайте оценим осимпточку
всего этого дела. Время работы. Ну, будто бы хочется
сказать что-то такое. О от суммы, по и от единички
до к. Теперь давайте фиксировать, за сколько у меня работает
одно фурье. Одно одномерное ффт. Я утверждаю, что здесь
одно одномерное ффт выполняется за соответствующую
степень многощена маргинально. Давайте скажу дитая. Лог
дитая, да? И теперь на что его надо умножить? Сколько
раз оно делается? И теперь почему я вводил вот так
вот дкп, интересно образом? Ровно вот столько. Ну почему?
Потому что здесь, если я зафиксировал катую переменную,
то у меня остается произведение всех возможных способов
делить на числа катых выбрать. То есть это d1, d2, tra-ta-ta, dk-1.
Это то же самое, что я возьму суммарно. Это степень
нашего многощенника. Видно дитая? Вот поэтому оно здесь
так взято, интересно образом. Теперь давайте, ну давайте
считать. Да. Математика это сложная наука, да. Дитая
дитая сокращается. Кого сейчас оценим? Пока что у вас дитая
сократились, да? Дкп налог дитой. Ну дкп вынесу, а на ты
не зависит, очевидно. Теперь сумма логарифма — это логарифм
произведения. Ну это дкп, знакомьтесь. Нет, дкп, логдкп. Конец.
То есть вы сами по сути научились делать перемножение
в умеренных многощенах за вот такую интересную
штуку. Ну очевидно, раз вы применяете одномерный
FFT, везде надо дополнять до ближайшей степени 2. Заметьте,
не одно и то и же. Да, по каждому измерению своя степень
2 будет, чтобы было проще жить. Потому что иначе у вас
многощенник типа там маргинальная степень по одной перемене
до миллиона, по всем остальным единицам. Вы таки все миллионы
там добили, и у вас ничего не сработало. Классно вы
победили. Молодцы, но алгоритм сломался.
У нас еще в худшем случае, кажется, это 2 вкатые, 2 вкатые.
А, в плане, как что? У нас по каждому измерению нужно
допить до степени 2. Да, 2 вкатые. Ну, то есть да, здесь
еще можно 2 вкатые написать по-хорошему, но я все-таки
верю, что у вас дает порядка 2 хотя бы, и все будет нормально,
в целом все слопнется. Но да, это извечный спор,
что вы могли писать 2 вкатые в 8 точку.
Не а пока.
