а что там нет пока камеры устанавливают. Мы что так заполняем пока камеры? Все, кино уже начинается.
Ну как это говорят? Константин Георгиевич, камеры не работают, поснимайте на телефон,
ну а что, скринкаст. Так, но для того, чтобы нам что-нибудь поделить, на самом деле на этот раз
нам придется так это прописать, о чем мы вообще хотим делить. Многочлены или числа?
Просто фишка в том, что на этот раз это разные вещи. То есть если вот там для сложения, вычитания,
умножения мы себе умножали многочлены, держа в уме, что числа умножаются ну почти так же,
и практически буквально так, то с делением у нас так не получится. Как минимум потому,
что если вы поделите многочлен на многочлен, то вы получите не многочлен.
Да, вот такая проблема еще. Что такое деление, то есть тут еще оговорка, что когда вы будете
делить, скажем, натуральное число, натуральное число, вы получите какое-то дробное число. И вопрос
будет только в том, с какой точностью вы его хотите получить. Вот, поэтому у нас сегодня будут
такие немножко разные вещи. Значит, внимательно. Итак, давайте начнем с простого.
Камера уже удаляется. Как-то первая мысль. Надеюсь, я до нее докручусь. Вторая мысль, а, ну да.
Так вот, поехали. Что у нас дальше? Итак, давайте себе представим, что мы хотим поделить многочлен
а на многочлен b. Поделить в каком смысле? Ну, соответственно, это означает, что мы его хотим
поделить с остатком обычно, правда? Вот. Ну, вот все вы знаете, что такое поделить многочлен с
остатком, да? Ну, есть такое подозрение. Но есть и немножко другое понятие. Потому что можно
поделить типа, что a поделить на b это равно типа вот bq плюс r, да, где вот у нас выясняется, что там
степень многочлена r строго меньше, чем там степень многочлена b, да? Вот, понимаете, да? Вот. А есть
другой вариант. А есть вариант, что я хочу найти, что a равно bq по модулю x в степени n.
Ну, что это значит, да? То есть, мне интересен не весь многочлен, а только, скажем, там вот его
остатки, то есть, так сказать, по модулю xn, то есть, в переводе говоря, первая n коэффициент. Вот. То есть,
я буду всем операцией, там все умножения, допустим, делать именно, то есть, отбрасывая все коэффициенты
от n и старше. Вот представим себе такое, плюс-минус. Ну, плюс-минус, понятно, ничего не меняет,
умножение отбрасывает что-то, а вот интересно, а можно ли поделить? Ну, поделить, понятно,
то есть, там без употребления слова модуль, получится, что у вас просто bq плюс нечто, ну ладно, нечто
в стере, там, на x степени n. Ну, нечто, это многочлен, конечно. Ну, понятно, что вот это вот и вот это, одно и одно.
Ну, нет, ну n это просто вот количество коэффициентов, которые мы храним. Вот представим себе, что вот a и b
многочлены размера n. Так, а вот давайте думать, почему это вообще выполнимо? Вот давайте попробуем
понять, насколько это выполнимо вообще. Вот, то есть, давайте для этого сейчас просто рассмотрим
какой-нибудь пример. Вот давайте попробуем по модулю x в четвертой поделить многочлен на многочлен.
5 плюс, допустим, 3x минус 2x квадрат плюс, ну я не знаю, 4x куб. И поделю я это на какой-нибудь многочлен,
например, 2 минус, ну, например, x плюс 3x квадрат. Вот, даже куб дописывать не буду. Ну, начнем с того, что
есть подозрение, что если у вас верно это утверждение, то свободный член этого многочлена b, он как-то определяется
однозначно, правда? В точении многочлена b и многочлена q. Потому что он тупо равен там 5 поделить на 2.
Мы в действительных числах, напоминаю, живем, поэтому. Да, то есть, условно, да, это вообще, это у нас получается
это автоматически a0, a1, a2, a3, если что. Вот. А тут, наоборот, это b0, тут b1, где-то тут, это минус 1 типа, и тут b2.
Получилось 5 пополам. Ну, соответственно, давайте домножим эту штуку на 5 пополам, и получилось 5 минус 5 пополам x
плюс 15 пополам x квадрата. Я, кажется, сегодня уже апеллировал к делению столбиком. Ну, так что, думаю, знакомая операция.
Итак, но единственное, что это не числа многочлены. Значит, там. Ну, тут, понятно, шлёп-шлёп мы этого и добивались.
Что у нас теперь получается? 3, это 6 вторых, поэтому тут получается 11 вторых x минус, так, 2, значит, это минус 4 вторых,
значит, минус 19 вторых x квадрата. Вот. Ну, можно ещё снести 4 x квадрата сразу. Так. Ну вот, то есть, вышли, осталось это.
Теперь это пытаемся, без этого пытаемся что-то выжать. Но для того, чтобы у нас остались только степени x квадрата и выше,
очевидно, нам нужно поделить теперь вот это, но всё ещё на это. Получается, сколько там? 11 четвёртых x.
Значит, 11 четвёртых x, получается, берём 11 пополам x, там, что там получается, минус 11 четвёртых x квадрата и там плюс,
что-то там ещё, сколько там? 33 четвёртых x. Вот. Значит, шлёп-шлёп. Так, 19 это 38, 38 минус 11, минус 27 четвёртых x квадрата.
Вот. И тут получается 4, 16, 16 минус 33, это минус 17, минус 17 четвёртых x квадрата. Ну, сносить тут нечего, но тем не менее продолжаем.
Значит, что у нас тут? x квадрат тоже делим на 2, там получаем минус 27 восьмых x квадрата.
В принципе, кстати, заметим, что если бы мы делили не по модулю x четвёртая, а по модулю x кубе, то в принципе вот он ответ, правда?
Обратите внимание. Вот понятно, откуда я это взял?
Ну, вот. Ну, потому что, смотрите, ну, потому что, смотрите, что, ну, смотри, вот давайте я вот сейчас вот ещё это допишу.
Вот у меня тут будет минус 7 24 x квадрат, вот эту вот штуку, да, вот домножаем там.
Значит, тут получается плюс теперь 27 восьмых x куб, значит, минус 81 восьмых x четвёртых.
То есть получается тот бомун, значит, шлёп-шлёп, и тут остаётся какая-то гадость на x кубе.
Ну, там, даже если чуть-чуть подумать, можно конкретно даже сказать, что 61 тут на самом деле, ну, с минусом, естественно.
Вот. Ну, и тут ещё вот эта гадость осталась, сколько тут? 81 восьмых x четвёртых.
То есть смотрите, то есть если так задуматься на тему вообще, откуда взялось деление столбиком, что оно конкретно делает?
В нашем случае оно гарантирует, что если вы умножите вот этот многочлен на вот этот многочлен и произведение вычтите из вот этого многочлена, то останется вот это.
Ну, вот просто по факту мы просто в явном виде вот тут это делали, аккуратно вот подгоняя, чтобы у нас ликвидировался сначала коэффициент нулевой, потом первый, потом второй.
Поэтому уже можно сказать, что как бы мы тут по модулю x в кубе уже поделили.
То есть верно, что эта штука равна там вот это на это плюс нечто на x кубе, нечто это вот минус 61 на восьмая, плюс там 80, вот это вот, короче.
Логично, да?
Ну, правда, если бы мы делили по модуле x в кубе, в общем-то, кстати, этот коэффициент вообще нам не надо было бы рассматривать.
Что?
Ну, вот это да, то есть нечто будет, это минус 61 на восьмая, плюс 81 на восьмая и x.
Вот, это нечто, что мы можем на x кубе получить.
Ну, соответственно, чтобы получить по модуле x в четвертой, нужно проделать эту итерацию просто еще раз и тут написать минус 61 шестнадцатая x у кубе.
Ну, тут, соответственно, да, тут уже это бла-бла-бла-бла-бла, x в четвертой это поля какие-то, да?
Ну, вот.
То есть вот таким вот образом мы можем делить.
Причем, более того, на самом деле, если так внимательно посмотреть, что мы делаем, мы вообще понимаем, что вот эти коэффициенты, которые у нас тут появляются, они однозначно останавливаются.
То есть да, мы, конечно, сейчас говорили в терминологии, давайте подгоним так, чтобы получалось.
Но на самом деле на каждом шаге можно аккуратно написать какое там условие должно быть выполнено и выводить, что действительно именно это и должно быть, других вариантов нет.
Ну, самое тупое, это что, помните, свободный член однозначно определяется, потому что он на два должен быть равен пять.
Этот должен восстанавливаться однозначно, потому что это на это плюс это на это должно быть равно вот этому.
То есть у нас там получается уравнение с одним неизвестным, там линейное уравнение с приемкой эффициент два, поэтому там без вариантов, решение ровно единственное, ну и так далее.
Вот, то есть вот таким вот образом мы можем делить многочлен на многочлен по модулю х в степени и всегда получать, собственно, однозначный ответ.
Какую оговорку я должен сказать, чтобы это утверждение стало верным?
Нет, не в этом дело, может быть мы живем даже там в каком-нибудь поле по простому модулю.
Нет, тут вот, то есть это вот к вопросу о том всегда ли можно так делить.
На самом деле тут у этих многочленов или у одного из них есть одно очень важное свойство, благодаря которому мы это деление вообще осуществили, прям так красиво и однозначно.
Не совсем, еще, еще.
Вот, у него не нулевой свободный член, вот, то есть обратите внимание, если у делителя есть не пустой свободный член, то деление тогда действительно, ну тогда деление получается вот существует и единственно.
А если это не так, ну тогда тут, конечно, как повезет, потому что дальше будет зависеть у кого там самый младший не нулевой член больше, потому что, скажем, если тут будет, например, свободный член не нулевой, а тут он будет нулевой, то деление невозможно, правда?
Вот. А с другой стороны, ну а наоборот, пожалуйста, если бы тут был ноль, скажем, то мы бы это деление спокойно бы сделали, правда?
То есть на самом деле, да, мы видим, что деление действительно вполне себе возможно, если у многочлена не нулевой свободный член.
Вот. А теперь возникает такой вопрос, как же это сделать? Побыстрее, в смысле. Ну понятно, что вы уже поняли, что делить по модулю, ну тут два, да, то есть делить по модулю мы за n квадрат уже умеем, правда?
Вот. Как всегда, возникает как всегда два вопроса. Зачем это нам надо? Мы же изначально собирались вообще-то делить с остатком многочлены, да?
И вообще числа.
Да, и вообще числа. Но я вам сразу скажу, да, числа мы будем делить ну вообще по-другому. Вот, увы, тут даже методы принципиально разные будут.
То есть давай, ну вот. То есть будет вот анализ наш вынесет.
Ага. Так. Это грустно.
Так вот. Значит, смотрите. Ну давайте вообще подумаем. Зачем нам вообще понадобилось, почему у нас возникло вообще произведение по модулю х в степени n?
Вот зачем оно нам надо? Ну вот у нас было деление по модулю х в степени n. Вот мы только что разобрали, что это даже возможно, да?
Можно сказать, что если мы подставляем число меньше единицы, то это будет все меньше и меньшее число.
А при чем тут число? Мы про многочлены говорим.
То есть если мы хотим предсказывать значение в точке, то это будет все лучше и лучше.
Да? Нет, парадите, парадите. Ну как мы тут предсказываем, я что-то не очень понял.
Как мы это будем предсказывать в точках 0 и 1, учитывая, что тут есть какой-то абсолютно рандомный остаток, смысл которого с значением многочленов в каких-то, в каких-бы то ни был точках никак не связан.
Так что тут это, я боюсь. Так что к сожалению, тут деление многочленов, там просто такая несвязанная с интерполяциями задача.
Единственное, что можно сказать, что если вы точно знаете, что A делится на B нацело, то тогда с помощью Фуриатины вы поделить можете.
Ну если точно, железно делится многочленов. Но более того, даже если в длинных числах вы знаете, что A делится на B, я боюсь, как многочлены, но все равно делиться не обязаны.
Ну вот, поэтому тут и выясняется, что многочлены эти числа, это все-таки буквально чуть-чуть разные вещи очень сильно.
Поэтому пока вопрос, зачем нам нужно теперь делить по модулю X в степени N многочлены?
А потому что я сейчас просто так, смотрите, давайте я представлю тебе, что я захотел, вот я же могу на самом деле вот этот вот частный остаток, могу тоже искать столбиком, правда?
Ну вот, если вот это искать, да?
Более того, давайте рассмотрим пример даже. Вот я сейчас, какой бы мне многочлен взять?
Ну например, 5х в кубе плюс 3х в квадрат, да, минус 2х плюс 4.
Давайте поделим нам многочлен 2х в квадрат минус х плюс 3.
Вот, это другие многочлены, другие.
Ну ладно, не совсем, потому что, но на самом деле просто когда я сейчас начну делить их столбиком, будет что-то вот очень похожее, да?
Так, вот как мы обычно делим? Получаем, да, старше на старше делим, да?
Так, это получается тут 5 пополам х. Что тут получается?
Так, 5х в кубе минус, ага, сколько там? Так, 5 пополам х, ага, плюс так, 5 вторых умножить на 3, 15 вторых.
Вот, ну тут дальше отчител зависит, насколько быстро у вас начнет проклевываться.
Чего?
Почему? Мы куб на квадрат поделили, получилось?
А, в этом смысле, да, да, да, это да.
Окей, уговорили, уговорили, уговорили, уговорили.
Так, значит, сколько тут? Ну тут 11 вторых главное, да?
Так, тут получается минус 19 вторых х. Знакомые цифры, да? Особенно если тут 4 снести, да?
Вот, далее, да, 11 вторых, тут получается 11 четвертых, да?
Вот, ну давайте я все-таки напишу, чтобы это совсем красиво было.
Тут х квадрат, минус, ну, чего вы их отдаете, давайте, можно тупо переписывать.
Так, что там? Плюс 33 четвертых получается. Вычитаем, тут получается минус 27 четвертых х, минус 17 четвертых.
Ну правда, единственная разница, что при делении столбиком, конечно, мы обнаруживаем, что...
То есть на этом мы в принципе и закончили. То есть это частное, это остаток, да?
Но заметим, что по нот, что действительно по случайному в скобках нет совпадению, действительно циферки какие-то буквально одни и те же.
Хотя в принципе это один из способов убедиться, что на самом деле деление многочленов с остатком очень легко свести к делению по модулю х в степени n.
То есть для этого нужно просто, как вы заметили, просто пореверсить коэффициент обоих многочленов.
Правда, при этом оговорится, что один многочлен должен быть в степени n в том плане, что n коэффициент должен быть не равен нулю.
Точнее, вот тут n не равен нулю. И тут m коэффициент должен быть не равен нулю, понимаете, да?
Вот. То есть тогда вот в этом плане, если мы берем в одном из них n коэффициентов, в другом m и реверсим.
И тогда получается, что для того, чтобы поделить, вам нужно просто поделить по какому-то модулю.
Ну, по какому понятно, потому что вы знаете, сколько у вас коэффициентов должно быть в q, правда?
И тогда, если вы каким-то вот там с небес по факсу вам это q пришлют, то после этого r вы найдете просто за n лог n с помощью просто одного запуска фурии, правда?
Да, нет, я сказал так. Если мы вот это, то есть я произнес утверждение номер раз, значит q мы можем по крайней мере теоретически поделить,
найти из того, чтобы поделить в многочленном многочленном уже по какому-то модулю.
И утверждение номер два, если меня откуда-то q прислали, то я могу r найти просто перемножив b на q с помощью фуриятины.
И вычтите из a. Это все, что я сказал. То есть таким образом, небеса и факт заключаются только в том, как поделить один многочлен на другой по модулю x в степени n.
В чем более того, мы даже для простоты можем себе гарантировать, что свободный член многочлена b не нулевой.
Понятно, да? Так.
Ну что старший член многочлена еще не нулевой, плюс-минус по определению.
Ну да. Вот. Так что мы себе это свели. Так, есть вот до этого момента вопросы какие?
Если бы мы не делали это столбиком, то нам бы даже не понадобился трюк с тем, чтобы что-то там умножать и пересчитать,
потому что у нас те же самые числа появились, могли просто остановиться, нужно в шаге вот добраться.
Да. Но это да.
Но просто другой вопрос, что просто конкретно делить по модулю x в степени n нам сейчас будет чуть проще просто.
Смотрите.
Значит магия.
Ладно, вот. Так еще. Ну вот.
Так, ладно.
Основной задачный вопрос по делению многочлена a нам многочлен b по модулю x в степени n.
Я вам даже больше скажу.
На самом деле нам нужно просто. Задача на самом деле может сформулировать еще проще.
Дан многочлен b и надо найти, так сказать, многочлен b в минус первой по модулю x в степени n.
Ну то есть такой многочлен, что там b в степени n должно быть по модулю x в степени n равно 1.
Потому что если я такой найду.
Ну вот, если я такой найду, то тогда у меня q будет просто равно a умножить на это обратно.
Согласны?
Так. Нормально? Понятно?
Живо? Ага. Окей.
То есть там, ну просто лишняя фурия, но как бы асимптотика лишнее действие нас устраивает.
Теперь еще.
Значит поехали.
Давайте убираем его на счет.
Теперь думаем, как же нам делиться с таком.
Значит смотрите, как же нам теперь это все делить.
Итак.
Значит давайте себе представим, что у нас есть многочлен b, который равен b0 плюс b1x плюс b2x² плюс и так далее плюс bn-1 на x в степени n-1.
Давайте да.
Давайте да.
Ну вот, хотя ну вот.
Ну потому что если мы ищем обратное по модулю x в степени n, то нам можно считать, что у него n коэффициент. Правда?
Вот.
Более того, мы знаем, что там.
Более того, мы можем так сказать еще пока что n степень двойки.
Как всегда.
И, а, ну еще конечно, что мы обязаны сказать, то что b0 не равно 0.
Иначе 0.
Что?
Ну иначе обратного нету просто.
Просто чисто теоретически.
Просто нет.
Не потому что мы там не можем его найти, а потому что его нету.
Вот.
Вот соответственно.
Значит что дальше?
Вот.
Значит как же мы это будем делать?
Ну, как я сказал, кто у нас в хедлайнер сегодняшней лекции?
Хуйня.
Ну вот.
Хорошо. А какой метод у нас?
Разделение.
Да, разделение и власть.
Конечно.
Поэтому давайте как всегда скажем, что b у нас равно на самом деле b0 от x плюс x в степени n пополам в b1 от x.
То есть многочлен просто как в короцубе.
Да, то есть там давайте я напишу, напомню, b0 от x равно b0 плюс b1x плюс и так далее плюс bn пополам минус 1.
Что там?
x в степени n пополам минус 1.
Вот.
b1 равно, соответственно, к чему там оно равно?
К чему оно равно?
bn пополам плюс bn пополам плюс 1 на x плюс и так далее плюс bn минус 1.
x в степени n пополам минус 1.
Ура.
Вот.
У нас снова появились какие-то многочлены размера n пополам.
Но мы заметим, что вот этот многочлен b0 нам по-любому придется инвертировать.
То есть обратить по модулю n пополам.
Почему? Ну потому что давайте себе вообразим, что у нас ответ равен b'
Вот у нас b' ответ.
То есть пусть у нас это b' такой, что b на b' равно 1 по модулю x в степени n.
Ну у нас есть какой-то мистический ответ, который мы ищем как раз.
Мы замечаем, что b' тоже можно представить в виде b'0 плюс x в степени n пополам на b'1.
Пока логично, да?
Пока логично.
Ну начинается теперь, что же делать?
Ну теперь тогда мы замечаем следующее.
Что чему равно b'
Вот у нас тогда единица это по модулю x в степени n равно b'3.
Но если я теперь еще усилюсь и возьму равенство по модулю x в степени n пополам.
Ну очевидно, что я от каждого многочлена должен оставить буквально первые n пополам коэффициенты.
Потому что все остальные уйдут в x в степени n пополам умножить на что-то там.
Но тогда от b у меня останется b0, а от b' у меня останется b'0.
То есть таким образом я теперь просто объявляю, что b'0 это обратный многочлен к многочлену b0 по модулю x в степени n пополам.
И как вы уже догадывались, я запускаю поиск его рекурсивно.
Сейчас, а почему я могу так сказать?
Ну давайте по подробке.
Дело в том, что b, b' что это такое?
Это давайте вот b0 плюс b1 в степени x в степени n пополам умножить на b'0 плюс b'1 на x в степени n пополам.
Пока логично, да?
А теперь раскроем скобочки.
Это равно b0 b0' плюс x в степени n пополам на, ну в принципе я тут могу и закончить.
Ну давайте я все-таки распишу, тем более что нам это пригодится на самом деле.
То есть на самом деле это равно b0 b1' плюс b1 b0'.
И еще плюс добивочка x в степени n на b1 b1'.
Вот если прям в тупую писать.
Мы знаем, ну вот.
И мы откуда-то знаем, что это равно 1 плюс какой-то y на x в степени n.
Но тогда если мы все это возьмем обе части равенства по модулю x в степени n пополам,
то здесь останется только единица, а тут останется только b0 b0'.
Вот.
Ну или просто там можно теперь написать, что b0 b0' равно x1 плюс x в степени n пополам на x в степени n пополам,
минус там вот эта вот вся радость.
Там x в степени n пополам.
Нет, вот это равенство мы знаем, потому что мы вот это же обратное по модулю x в степени именно n,
поэтому там n.
То есть там n, а тут вот так.
То есть таким образом по модулю n пополам равенство получилось, и мы b0' ищем рекурсивно.
Теперь надо найти b1'.
Как его найти?
Ну давайте просто посмотрим на вот это равенство.
Вот.
Ну мы с вами уже знаем, что b0 на b0' равно 1 плюс какая-то гадость, но другая, на x в степени n пополам.
Видите, да?
Это мы уже знаем.
Тогда у нас получается интересное равенство.
То есть если вот я сюда подставлю, получается 1 плюс zx в степени n пополам.
Значит, соответственно, плюс там x в степени n пополам еще на, соответственно, b0 b1', плюс b1 b0'.
Значит, соответственно, плюс x в степени n b1 b1', это равно 1 плюс какая-то гадость на x в степени n.
Ну, соответственно, с единичками мы, собственно, делаем шлеп-шлеп.
И после этого обнаружим, что обе части равенства делятся на x в степени n пополам.
Видите, да?
Поэтому с ними мы тоже делаем шлеп-шлеп-шлеп.
И получается интересная вещь.
b0 b1', на самом деле получается плюс b1 b0'.
На самом деле получается равно, вот я так напишу, x в степени n пополам на, получается y и что там еще?
Минус b1 b1'.
Вот.
Вот.
Или не вот.
Где z?
А, тут еще z я забыл, да.
Так, нет, вопрос как бы, да, в другом тут нигде ли я тут это ничего не переврал?
Вроде нет.
Нет?
Так, ну хорошо.
Ну вот, но это, но на самом деле это не особо и важно.
На самом деле, что тут это?
Потому что самое приятное, что можно отсюда вывести, это то, что если, смотрите, мне что нужно?
Мне нужно найти b1', правда?
Причем b1', мне нужно найти по модулю тоже x в степени n пополам.
А по модулю x в степени n пополам вот эта вот штука равна нулю.
Понимаете, да? То есть просто вот то, что там x в степени n пополам, вот там,
заметьте, само неизвестное в нем участвует, но эта штука все равно дает ноль.
То есть как бы ноль приятен тем, что ноль умножить на что угодно равно ноль.
Такая черная дыра такая.
Вот.
Ну что это тогда значит?
Тогда получается, что b0 b1' равно, то есть сравнимо по модулю x в степени n пополам,
минус z минус b1 b0'.
Причем b0' нам уже известно, поэтому это мы за n лог n найдем, правда?
То есть единственное, что нам бы теперь поделить обе части равенства на b0.
А мы это умеем делать?
Нет, никаких рекурсивностей нам не нужно.
Потому что чтобы поделить по модулю x в степени n пополам b0, надо умножить на обратное по этому модулю.
А оно у нас даже не просто рекурсивно, оно уже есть.
То есть я просто это домножаю на b0' и получается, что b1' на самом деле по модулю x в степени n пополам
равно просто минус b0' умножить на вот этот вот z плюс b1 b0'.
То есть обратите внимание на магию.
Рекурсивный запуск нам на самом деле нужен только один.
Потому что вот видите, просто для b1' мы тупо вывели формулу теперь,
которая через буквально две фуриатинные пару сложений, собственно, вам выдаст то, что надо.
Ну ладно, вру, не совсем, потому что эту z вам еще тоже придется найти,
потому что для этого вам нужно еще b0 на b0' умножить и посмотреть, что там в остальных коэффициентах.
Вот.
Так что получается, мы делаем o от единицы фуриатин и один рекурсивный вызов.
Спрашивается тогда...
Что?
На каждом шаге.
На каждом шаге.
Тогда получается, что давайте внимательно смотреть.
t от n равно получается t от n пополам плюс o от n ловлен.
Плюс o от n ловлен.
Вот.
Уважаемые извытаки, внимание, вопрос.
Чему равно t от n?
n ловлен.
Да.
То есть на этот раз там третий случай, вот эта слагаемая доминирует.
Там жестко, эту бедную единичку.
Или что там, да, единичка.
Поэтому получается, да, это n ловлен.
Ну или тут даже еще просто, особенно если n степень двойки,
вообще просто можете распределить, что это n ловлен плюс n пополам,
ловлен пополам плюс n велики 4, ловлен поделить на 4 и так далее.
И там, в общем, вот тут константа разжиреет относительно этой,
даже не более чем в два раза получается.
Вот.
Так что вот таким образом оказалось, что
поделить многочлены
друг на друга оказалось не так сложно.
В чем так? n ловленчик.
Видите, да?
Чего?
Чего?
Чего будет?
Чего будет, прям так страшно, что ли?
Нет, пока на самом деле только есть ли тут какие-то вопросы,
потому что как бы следующий блок с этим всем не связан от слова никак.
Давай.
Чего, где?
Четвертая строчка с конца.
Сверху.
Четвертая строчка сверху.
Вот это?
Да.
А там равно, по-моему, для х-степеней пополам?
Ну, равно 1 плюс игр?
Нет, нет, нет, нет, это х пополам вот сюда имеет отношение.
Да, там просто четкая равенство.
А почему?
Потому что куда это?
А, ну потому что мы знаем, у нас вот б-штрих по определению,
мы знали, что это равно 1 плюс игр на х-степене.
То есть это определение б-штриха.
А, оно уже было.
Да.
То есть это просто...
Вот, это определение.
Вот.
Так.
Хорошо.
Вопросы?
Ну, у меня вначале кокнуло.
А как мы втукуем после делимого темы?
После ручками?
Водорим по модуле?
Или мы просто делим все?
Абсолютно.
Ну, абсолютно так же.
То есть сначала находим...
Ну, смотрите, мы нашли свободный член в этом начале.
Он, значит, равен 5 пополам.
Правда?
Ну, да.
Ну, тогда замечаем, что умножаем 5 пополам на эту штуку и вычитаем.
Что у нас получается?
Какой-то...
То есть...
Ну, после делим-то это понятно.
Я имею в виду, что и в правом по модуле, и в степене.
По модуле и степене?
Значит, мы останавливаемся в некоторый момент и все.
Нет.
По модуле и степене это означает, что когда мы умножаем многочлены,
то коэффициенты, которые у нас получаются при их степени n и выше,
мы просто уже игнорируем.
То есть нас интересует только это.
То есть получается тоже своего рода...
Ну, ладно, не поле.
Да, это опасно называть полем, потому что не на все элементы можно делить.
То есть, на самом деле, можно было бы сказать, что...
Сейчас.
Что все многочлены с не нулевым...
Да, с свободным членом, объединенные, видимо, с нулем,
ну, чтобы сложение было адекватным, да, образуют поле.
Ну, железно можно сказать, что многочлены с не нулевым свободным членом
образуют группу коммутативную.
В смысле, абельву.
Вот это можно, да.
Ну, вот там со всякими этими...
Ну, там, видимо, если добавить ноль, возможно, еще и поле получится.
Хотя нет, не получится.
Потому что это множество многочленов относительно сложения не замкнуто.
Так что, увы, там придется...
Так что словом, поле лишний раз тут не удастся проситься, да.
Вот.
Окей.
Вот.
Ну, вот оказалось, да, это вообще другое, конечно, умножение деления,
но, оказывается, к нему наше классическое умножение деления сводится, оказывается.
То есть вот таким вот, с помощью вот такого вот реверса.
Вот.
Ну, в принципе, да, это вообще такой маленький, такой общеприятный факт,
на самом деле, который иногда вот действительно помогает в задачах.
А именно что?
Вот жел был, вот вы перемножили многочлен, нам многочлен, получили что-то там, да, многочлен.
Так вот, оказывается, что если вы сделаете реверс тут и реверс тут,
то результат, это то, для получения результата надо просто тот ответ развернуть.
Ну, в общем-то, ничего удивительного в этом нет, если вспомнить просто,
просто определение произведения многочленов.
Ну, там просто если...
Так что там легко будет.
Так, еще вопросы?
Нету?
Окей.
Тогда смотрите.
Что будет дальше?
Здесь в итоге мы рекрутивно ищем b0, а потом b0' рекрутивно ищем,
потом восстанавливаем b1'.
Да, потом просто оказывается, что b1' на самом деле можно восстановить вот тупо вот по этой формуле.
И все.
И дальше продолжаем?
Ну да.
Ну да, просто все вот эти умножения мы, честно, с помощью фурье делаем уже.
Да, то есть обратите внимание, да, то есть если вы пропустили первые две лекции, как конкретно делает фурье,
то просто тут не принципиально, просто черный ящик.
Вот.
То есть все приятно и независимо.
Вот.
Ну, теперь начинается такое интересное шоу.
А как же делить числа?
Ну, делить числа тоже, знаете, часть идей оставим.
А именно вот эту идею мы оставим.
Что по большому счету, когда вы делите a на b, вам нужно просто с какой-то точностью найти число обратное к b, правда?
Вот.
Но правда задача у нас теперь будет, что у нас дано число b, и нам его нужно обратить, но желательно с точностью до n знаков.
Вот.
Ну, желательно, чтобы это было там, скажем, 1 делить на b, округленное вниз, допустим, до n знаков.
Вот такая вот у нас цель будет.
Значит, как же мы это будем делать?
Это мы все стираем.
Да, как я уже сказал, это нам не поможет.
Что?
Ну, почему?
С остатком?
Ну, как сказать, если вы научитесь делить просто с точностью до каких-то знаков, то это то же самое, что поделить с точностью до 0 знаков и округлить вниз, правда?
Поэтому остаток вы там найдете.
Ну, вот это все там сводится свиньи к обратным.
Значит, теперь давайте думать.
Что ж нам делать?
Значит, смотрите.
Для этого мы применим такой мистический метод.
Метод Ньютона называется.
Итак, представим себе, что вот у нас есть мистическое число a, и мы вот очень хотим найти вот то самое 1 делить на a.
Заметим, что то, что мы ищем, это, помимо всего прочего, корень уравнения f от x равно 0.
Где f от x равно, ну тут разные варианты можно написать, но мы напишем вот как.
1 делить на x минус a.
Понимаете, да?
Значит, давайте себе это как-нибудь вообразим.
Значит, как устроен график этой функции?
Ну, примерно вот таким вот нехитрым образом.
А что?
Ну, вам что это, вот это подкрутить что ли лучше, я не знаю.
Значит, смотрите.
Значит, идея у нас следующая.
Значит, смотрите.
Это у нас будет, значит, мы будем пытаться делать как ни странно такой интерационный метод.
Вот у нас есть вот этот мистический корень.
Мы его будем называть, как мы его будем называть?
Ну, например, xr. Видите, да?
Вот.
А мы так, начнем мы с какой-нибудь и титрации x0.
Давайте без особого ограничения общности представим себе, что x0 меньше, чем xr.
Мы еще, возможно, не успели ничего посчитать.
Ну, мы так захотели.
Нет, ну там есть причина, потому что у вас могло быть вопрос, почему она не вот такая.
Ну, просто, на самом деле, если мы ее умели адекватно считать, то может подошла бы нам и она.
Но проблема в том, чтобы ее адекватно считать, нужно уметь считать адекватно 1 делить на а.
Ну, знаете, это круто, да.
Сам себе режиссер, единственный в мире передача, в который, чтобы выиграть видеокамеру, нужно иметь видеокамеру.
Вот, да, такая проблема была.
Ну, да, сейчас ее в этой передаче уже нету, но не важно.
Вот.
Так вот.
А делать будем так.
Вот как видно уже по этому графику, чем ближе мы к нашей точечке, тем больше эта функция в нужной нам окрестностях похожа напрямую.
Правда?
Как это да?
То есть такое, ну вот.
Ну, действительно, мы знаем, что это водится так в дифференцируемых функциях.
Ну, вот.
То есть там водится всякое.
Вот можно написать даже, что там, допустим, f от x0 на самом деле равно f от xr.
Ну ладно, не f от xr.
Плюс там f штрих от какой-то гадости на x минус x0.
Ах, штрих, ах, ах, ах, ах.
Штрих, штрих, штрих.
Не, точечка это, если бы у нас было время.
Да, это была бы по переменной t, лучше не надо, да.
Вот.
Ну вот, откуда это взял?
Ну, тут, как всегда, можно сказать, что я взял ряд t и lora.
Ну вот.
Да, но на самом деле это домноженное на, то есть я взял теоремула Гранжа, домножил на x минус x0, что-то там перенес.
Вот.
А, и еще набрал тут с индексами, конечно.
Вот.
Так вот.
Причину.
Что за гадость это?
Неа.
Это гады, где гадость, это просто, то есть гадость, значит, лежит на этом полу.
Отличная тема, но мы не проходили.
Очень люблю такие.
Да?
Да, конечно же нет.
Да, что, не проходили?
Ну, значит, да, скоро увидите.
Нет, но там, да, там, понимаете, просто какая ситуация будет?
У вас, ну, во-первых, есть теорему роли?
Лемма ее нам не дал, кстати, он без нее работал.
Ну, вот, ну, я не знаю.
Нет, ну, я не знаю, я как бы не теорему.
Не, ну, без этого сложно, потому что, как бы, лемма сидит так, что жила была функция.
И на, и на границах отрезков у нее равное значение.
И она дифференцируемая на всем отрезке.
Тогда утверждение, где-то на этом отрезке обязательно найдется точка с производной равной нулю.
Первым отрезок будет, но он еще не начинал, открывайте.
Хорошо.
Ну, хорошо, хорошо.
Ладно, пока просто поверим, хотя, в общем-то, как бы, можно, можно потратить пять минут и это вывести.
Это не проблема вообще.
Значит, значит, но, но, то есть, но, то есть, есть, подождите, что вот что-то вот действительно очень похожее.
Поэтому тут идея такая.
Если бы мы обнаружили, что на самом деле это производная равна была бы f' от х0,
то мы бы, наверное, могли бы попытаться из этого даже найти хр, правда?
Вот давайте себе это представим, да, что у нас тут действительно вот такая прямая.
Вот такая прямая.
Вот это касательная.
Ну, вот.
И тогда представим себе, что график у нас бы совпадал.
Тогда у нас получается немножко наоборот, да.
Попробуем.
f х0 равно f от хр, допустим, плюс f' от х0 умножить на х0 минус хр.
Но, соответственно, теперь мы вспоминаем, что f от хр теперь у нас равно, то есть, на самом деле нулю оно у нас равно, правда?
И отсюда тогда могло бы последовать маленькая приятная вещь, что, ну, если я вот поделю на этот f'
да, очень в наглую воспользовавшись тем, что он тут нулем не бывает.
Видите, да?
Значит, хр, и тогда хр у меня получится равно х0 минус f от х0 поделить на f' от х0.
Вот такова у нас мечта.
Чего?
Ну, конечно, у нас эта функция не прямая, но, значит, идея у нас будет такая.
Значит, мы просто будем применять к х0 вот эту вот всю штуку.
То есть, мы будем, то есть, по х0, то есть, мы построим последовательность х0, х1, х2 и так далее.
И будем пытаться говорить, что каждое следующее х плюс первое это равно хит минус f от хит поделить на f' от хит.
Ну, как сказать, ну, может быть.
Ну, мы тут все-таки более математично, мы тут пытаемся прям абсолютно точно все найти.
То есть, на самом деле, да, в вычмотах, конечно, это все будет очень активно использоваться, это да.
Собственно, да, тут можно даже вспомнить, зачем эти ряды трейлора там вообще нужны.
Да, но давайте смотреть. Кого-то на самом деле может напугать, что нас все-таки заставляют что-то там делить, правда?
Но вот сейчас вот и сыграет на самом деле, почему мы выбрали именно эту функцию.
Потому что конкретно в данном случае это равно, вот я сейчас прям честно все напишу.
Значит, так, значит, 1 делить на х минус а, а теперь я делю минус 1 делить на х квадрат.
Ну, производная эта штука равна вот этому, правда?
Что приятно, да, то есть как бы этот х квадрат сюда вылетает и тут хит, конечно.
Вот, и получается, делить ни на что не надо.
А что получается?
Ну да, на самом деле обычно это записывают вот в таком виде.
хит на 2 минус ахит.
Ну вот так это записывают, да?
Понимаете? Вот.
Ну вот, значит, к чему нас...
Ну, то есть в принципе замечаем, что если у нас х это уже число с какой-то точностью,
то как бы мы там с помощью фуриатины это адекватно найдем, правда?
Потому что домножать надо на а, а не на х.
Вот.
Значит, смотрите.
Ну а теперь давайте думать, хорошо?
То есть утверждается следующее, что, ну так, по примеру, вот абстрактно,
что мы будем вот это вычислять, вычислять, вычислять, вычислять,
и это будет куда-то сходиться, сходиться, сходиться, сходиться.
Вот утверждается, что за какое-то адекватное число итерации тогда х это сойдется достаточно близко.
Ну вот, теперь осталось только выяснить, что такое достаточно близко и когда.
А думать мы будем вот о чем.
Нам жутко интересно.
Ну, во-первых, заметим, что если у нас, допустим, хи-то оказалось меньше, чем хр,
то в силу правильной выпуклости этой функции, очевидно, что и хи плюс 1 окажется меньше, чем хр, правда?
Да, пока на уровне картинки поверим, хотя мы все равно сейчас посчитаем, это увидите.
Теперь что, что у нас будет?
Давайте посмотрим, давайте попробуем найти такую штуку, как хр минус х, минус и плюс 1.
Вот давайте попробуем.
Тогда, если я это честно напишу, то это получится равно хр минус хи на 2 минус х, правда?
Вот.
Ну, теперь вопрос, как вы думаете, чем же это отличается, как же это отличается от, собственно, хр минус х?
Как вы думаете?
Ну, во-первых, заметим вот что, вспомним, что хр на самом деле это, что такое?
Это 1 делить на а, по определению, правда?
Еще нет?
Значит, это получается минус, ну, тут пока все остается.
Теперь идея такая, давайте 1 делить на а, вынесем за скобку.
Тогда тут получится 1 минус, а вот здесь я уже, может быть, скобочки я раскрою, потому что получится 2ха плюс, соответственно, а квадрат хит в квадрате.
Что-то знакомое, да?
Да, тут поделили, а тут домножили.
Да, тут поделили, а тут домножили.
Да, то есть на самом деле это, давайте продолжим тут писать, это равно 1 делить на а на просто, значит, 1 минус ах ит в квадрате.
То есть, если я, ну вот, ну, здесь я по-разному могу поступить.
Ну вот, значит, ну, на самом деле вот самое тупое, что я могу сделать, это теперь из этого вывести просто, просто взяв вот это равенство и домножив на а.
То получается, я вот домножаю на а, и у меня получается интересный факт.
То есть у меня получается тогда 1 минус ах ит, х и плюс первое, равно просто минус 1 минус, где-то я минус потерял.
А, нет, я нигде не потерял минус, потому что я с правильной стороны вычитал.
Тогда получается это равно 1 минус х ит в квадрате.
Минус я не потерял, все нормально.
Ну что ж, приятно.
То есть мы обнаружим, что, по крайней мере, вот если с точки зрения этого вот функционала, то есть мы понимаем, что разность, что получается разность до правильного ответа, она так возводится в квадрат.
Хорошо ли это?
Ответ. Как повезет? Все зависит от того, насколько далеко x0 было изначально.
Если x0 было далеко больше, чем на 1, то эта разность будет бесконечно возрастать.
Но если она изначально, вы нашли с точностью меньше единицы, то тогда, собственно, сходимость на лицо, правда?
Видите, да?
То есть более того, условно говоря, то есть так, условно, вы будете, то есть после каждого шага количество знаков после запятой вы можете увеличивать в два раза.
Ну вот, по крайней мере, мечта на уровне идеи.
Да, сейчас мы будем это тут.
Ну что, смотрите, если у вас тут вы нашли вот эта вот разность, хотя бы вот эта разность, значит, уже выполняется с точностью до, там, соответственно, то есть вот эта разность там уже имеет единицу только после n знаков,
то есть штука, допустим, меньше, чем 1 делить на 2 в степени какой-нибудь k, то тогда вот эта штука становится меньше, чем 1 делить на 2 в степени k плюс 1.
Да нет?
Нет, ну, возвели в квадрат, если возвести в квадрат 1 делить на 2 в степени k, получается 1 делить на 2 в степени k плюс.
Ну а вы возвели в квадрат не то.
Правое возвели в квадрат и получили левое.
А.
Ну, окей, окей, окей, ну ладно.
Ну ладно, по крайней мере, что я имел в виду, вы поняли, да?
Это-то, да, не точно, но да.
Да, хорошо, хорошо.
Вот.
Ну, единственное, конечно, вот оговорочка, конечно, только заключается в том, что нам, то есть тогда для полного кайфа неплохо было бы, чтобы на каждом шаге и работали с какими-то числами вот с разностью.
Но правда, заметим, что это не совсем то, что мы хотели.
Потому что вообще говоря в идеале, вообще говоря в идеале, нам было бы неплохо сделать так, чтобы у нас это с х было вот это, чтобы у нас там, например, было, что мы вот хотим, чтобы вот, допустим, хр минус х, это должно было быть меньше, чем 1 делить на, даже не 2 в степени i, а в идеале 10 в степени i.
Почему именно 10?
Ну, чтобы гарантировать, что там, что-нибудь про, то, что мы нашли ответ с точностью сюда, там, я не знаю, и знаков после запятой, да?
Три-четыре раза больше.
Вот.
Ну да, суть, в общем-то, одна.
Нет, ну просто нет, это просто ситуация в том, что в идеале, просто теперь вот, если мы начинаем уточнять, вот прям мы вот включаем формалистов в математику, мы тут говорим, что в идеале хочется не просто так, а еще хочется сказать, что на самом деле,
вот, что, допустим, х и т при этом равно 1 делить на 10i умножить на какой-нибудь там, какому букву сегодня еще не использовали, там, какой-нибудь w и т, где w и это целое число.
Вот, неплохо было бы такое иметь.
И что?
Нет, ну оно было маленькое.
Ну ладно, давайте, конечно, еще.
Нет, ну мы тут пока в латинице пишем уже, как-то.
Так-то, да, там это альфа, бета, кси, там это все, да, изобразие.
Амикрон, да.
Амикрон, да.
Да, амикрон, да.
Так, значит, поехали.
Ну вот теперь, ну во-первых, да, смотрите, на самом деле, нет, у нас сегодня нет чисел фибоначи, поэтому сегодня все нормально.
Сегодня все нормально.
Что фибоначи?
Она уже была.
Нет, и тут она нам не понадобится, я надеюсь.
Ну нет, обычно не понадобится, но мало ли, тут как всегда.
То есть вдруг там это будет новая идея.
Ну вот, значит, давайте смотреть.
Ну во-первых, да, у такой штуки, конечно, есть две проблемы.
Во-первых, проблема перехода, во-вторых, проблема базы.
Потому что вот это мы вот хотим, чтобы у нас каждый раз такое было.
Но тогда надо начать с правильного x0.
У нас есть десятки, которые зажаты, которые зажали число a.
Так, ну не совсем.
Значит, там нужно изначально давайте так, чтобы x-x0 должен быть, ну вообще, если вкратце, то, в общем, x0 должно быть просто, действительно, 1 делить на a каким-то мистическим образом, округленный вниз.
Ну ладно, тут, конечно, тут, наверное, еще можно заявить, что если a больше либо равно 1, потому что, скорее всего, мы обращаем целое число, то, наверное, неплохо было бы сказать, что просто это, скорее всего, равно 0.
Так что не заморачиваемся.
Правда, осторожно, это в предположении, что a целый больше либо равно 1.
Сразу предупрежу, да, возможно, мы в перспективе откажемся от этого, называется такого вкусного предположения.
А в каком собрании членов f от x должно быть 0?
У нас там же нынче нет.
Чего?
А если f от x это 1 делить на x-a, как мы должны распределить это?
А мы при вычислениях-то никогда f от x не вычисляем.
Мы вычисляем, каждая следующая члена прилетит вот по такой формуле.
Мы тут подставляли, подставляли, выяснилось, что это вот, оказывается, вот так вычисляется.
И получается 0.
Где получится 0?
Что же делать, к чему же проблема-то?
Проблема в том, что у нас f от x для 0 не определено, да?
Ай, как обидно-то.
Придется сразу с условного, с каких-то количеств знаков начинать сразу, да?
Ну с другой стороны, что же делать?
Ну с другой стороны, да, мы можем заметить, что а у нас скорее всего зажата между...
То есть а имеет n знаков у нас, да?
То есть это означает, что...
Что это означает?
Ну не совсем, вот так это означает.
Вот если совсем говорить точно, что означает, что а имеет n знаков,
на самом деле вот оно, что означает.
Ну то же пятой.
Но у нас а натуральный числож, условно, да?
Вот, поэтому на самом деле, самая первая
итерация, с которой нам хочется что-то сделать, это конечно, то есть на самом деле
сразу сказать, что мы можем заявить какую-нибудь x, я не знаю, лог 2n, там x
какой-нибудь лог 2n, нет, x нулевое, там они там все до какого-то момента по
такому определению будут нулями, вот, тем более, что, да, 10, ладно, не в степени и, а
на самом деле тут веселее будет. Мы же на каждом шаге в квадрат точности
повозводим, да, поэтому в идеале нам неплохо было бы, чтобы вот это было.
Но это означает, что как бы источностью до первых два в степени и знаков.
Вот, на самом деле даже так, видите, то есть x-то и да, то есть в
идеале да, вот неплохо было бы. Да, тут пока это x равно какому-то нулю, но это нам
продолжает не помогать, к сожалению, вот, но тем не менее, да, действительно, что
исходя из этого можно сделать. Но на самом деле, заметим следующее, давайте подумаем
вообще, какую задачу мы себе ставим, то есть мы хотим посчитать с точностью до
чего-то, но как бы, если с точностью до n знаков, наверное, это тривиально, потому что
там первые n знаков почти кроме, может быть, последнего будут явно нулей, правда?
Вот, ну там где-то там один, там что-нибудь начнется, но обычно, но тут на самом деле
логичнее поступать следующим образом, вот, ну потому что на самом деле обращать
нам может потребоваться любые числа, но заметим, что если мы это число
домножим там, скажем, на, допустим, 10 или поделим на 10, в смысле буквально
поделим, а не там с остатком каким-то, то задача особо не поменяется, правда?
Просто в ответе нужно точку куда-то там подвинуть, да? Поэтому, смотрите, давайте-ка мы
для удобства, значит, подгоним себе на самом деле a таким образом, что у нас a
это дробное число, вот, и оно, ну, например, вот, вот теперь скажем, что оно, допустим,
ну, я не знаю, от одной десятой до одного, а для того, чтобы у нас сразу x1, допустим,
был равен, скажем, единице, ну ладно, не единица, а как, а чему-то там 1, 2, 3, 4, 5,
что-нибудь в этом роде, да, ну чтобы, вот, ну да, то есть, там более того, заметим, что
так как с точки зрения десятки мы еще на два можем домножать на самом деле, вот,
поэтому на самом деле мы можем еще добиться того, чтобы а у нас вообще было, там, совсем при
желании от 0,5 до единицы. Ну, как бы, просто будем домножать вот это число на два, пока оно не
станет больше, там, чем 0,5, либо равно, вот, тогда и обратно потом мы там домножим на два, это,
вот, там, вот, в линейное время в общем станет, вот, но тогда мы замечаем, что 1 делить на а у нас
лежит на полуинтервале от 1 до 2, логично, да? Тогда это очень приятно, то есть тогда мы можем
расписаться в том, что на этот раз, что x0 равно 1. Если бы мы а загнали от 1 до 10, то у нас
бы 1 делить на а лежало бы от 1 десятых до одного, и мы могли бы взять от 1 десятых. Да, а здесь тогда,
действительно, здесь проблема. Так, сейчас, куда бы мы ее загнали, говорите? Пусть а от 1 до 10. Так, от 1 до 10,
тогда, ну, тогда бы она была x1, 2, 3, вот, что-то там вот такое было бы. Нет, наоборот, x0 равно 10.
Нет, а, ну, хорошо, давайте, давайте, хорошо, как скажете. Да, да, да, говорилось, хорошо, давайте,
пожалуйста. Пожалуйста, да, хорошо, хорошо. Нет, ну, на самом деле, да, там просто в других местах тоже
это там будет проявляться иногда, поэтому будем думать. На самом деле этого нам, то есть, ну, на самом
деле там в любом случае хватит, вопрос только какая константа у нас там потом вылезет.
Так, но на самом деле, вот при таком а, он поставлен, ну, ладно, ну, ладно, не важно, не важно. Так, хорошо,
да, да, да, да, да, все неправильно, да, да, да, ладно, значит, но правда, если x0, смотрите, ладно,
значит, мы ставим x0 равно 1 десятая, но, правда, замечаем, что этого нам все равно недостаточно для
такой цели, потому что x, если i равно 0, то тут нам требуется точность 1 десятая и разность здесь
может быть 9 десятых, поэтому, возможно, придется решать там, решать задачу каким-нибудь там
бенбольском по ответу, да, за логарифом 9, да, или, или тупо перебором, все равно константа, правда,
хотя это называется, а я предлагал на 2 домножать, да, а могу и поделить, кстати. Нет, ну, там просто
разность была на 2, ну, просто, нет, ну, давайте так, давайте я просто ашечку на 2 поделим,
можем поделить на 2, можем, тогда она будет от 1 до 5 и здесь будет 1 пятая, тогда десятка, там,
перебор, перебор вариантов, там, перебор вариантов буквально чуть-чуть сократился очень сильно,
правда? Ну ладно, не очень сильно, ну ладно, он не очень сильно сократился, так 1 до 10 отсекли,
ладно, чтобы он сократился сильнее, надо его прям на 5 поделить, то есть надо, ну, число на 5-то мы
можем поделить, тогда оно будет от 1 до 2, вот, тогда перебор сокращается в два раза, вот.
Какой безобой, да. Да, можно, можно, все в этом мире можно, ну да, нет, ну, вообще, так, нет,
не туда, там,
вот, у нас были вот математические, строгие математические варианты, вот мы пока застряли
на базе. Ну как застряли? Мы пытаемся сделать это максимально красиво, хотя уже
поняли, что если мы забиваем на внутреннюю константу, то это уже
делается, потому что в общем-то нам уже... То есть нам нужно просто, что вот делим
от одного до десяти, то есть добиваемся того, чтобы число было от одного до десяти,
просто, да, там деля на какие-то степени десятки, и тогда обнаруживаем, что чтобы
найти один делить на а, нам нужно просто перебрать там 10 вариантов. Ладно, меньше. Вот. То есть
просто честно их перебрать, перебрать, перебрать, то есть там вот. И для каждого из
них там просто аккуратно выяснить там результат больше единицы или меньше
единицы, но заметим, что каждый из этих проверок фактически это там, что это такое?
Это умножение числа а на вот это вот, то есть деление на десять, умножение на какое-то
короткое число и проверка, получилось ли больше единицы.
Нет, почему, я же говорю, ну мы не от одной десятой запускаем, а от одного из них тот,
который подошел. То есть мы просто бинпоиском ищем максимальную такую вот
что-то поделить на 10, чтобы это умножить, чтобы это было там меньше чем один
делить на а, а это эквивалентно тому, что ах0 меньше чем 1. Вот. Вот такая магия.
Так что х0 вот как-нибудь нашли. Да, иногда возможно придется там как-то
куда-нибудь поделить что-нибудь такое, но вот. Значит, что же у нас
получается дальше?
Вот. А можно было на два, потому что на самом деле, да, вот вопрос был, почему,
откуда у меня тут получается деление на два, потому что метод у меня будет
заключаться такой, что рассмотрим, вот довели число до этого состояния, мы
научились доводить, да. А дальше говорим следующее, если число уже попало в этот
полуинтервал, то все хорошо. Если оно попало в полуинтервал, если иначе, давайте
поделим число а на 2, тогда у нас получится число из полуинтервала от
1 до 5. Ну и повторяем операцию. Просто запоминая, сколько раз мы поделили на два, и
потом ответ мы тоже будем на два делить столько же раз. Получит все равно ли нет.
Поэтому тут можно и от одного до двух, можно даже, можно вообще еще поделить и, на
самом деле, добиться того, что у нас там число будет от одного до, там, не знаю, тех самых там
одиннадцати десятых, ну вот или там что-то подобного, и тогда у нас окажется, что
там вот х0 ищется однозначно. То есть, в общем-то, суть одна, не важно. Но единственное,
конечно, вот оговорка, что делим мы, конечно, специально именно на два, потому что
в десятичной системе числения, в которой мы живем, мы делим на 2 и делим на 5 в
абсолютной точности, правда? Вот. Теперь, а вот теперь давайте вычислять. Значит, что же у нас
будет получаться? Значит, мы с вами пока знаем, что у нас, на самом деле, в квадрат
возводится не совсем точность, а вот, на самом деле, такая 1 минус ах, это не совсем то же
самое, что вот это, правда? Но, правда, хр, на самом деле, это 1 делить на а, как мы помним, да?
Вот. То есть, на самом деле, вот такая вот у нас цель. Но давайте теперь разбираться.
Значит, что у нас тут?
Ну, тоже что-то из этого. Правда, единственное, от перебора нас это не избавило, к сожалению.
Просто перебор будет тогда не от 1 десятой до 9 десятых, а от 5 десятых до 9 десятых.
Просто перебор сократился. Как я сказал, да, если к правильным еще каким-то делениям можно еще
перебор сократить, то там уже вопрос, что будет дольше? Сделать перебор или, ну вот, или там потом
три лишних деления? Вот. То есть, это вопрос уже практически, но как бы вот. Итак, что же у нас дальше?
Вот у нас есть вот такой х и т, и про него мы вот кое-что знаем, да? Что это, на самом деле, то это число,
у которого после запятой ровно 10 в степени, ровно 2 в степени знаков. Видите, да?
Вот там может быть даже, даже, ну да, ровно столько знаков, на самом деле, у него. И это моя нота.
То есть, практически это ответ, то есть, это 1 делить на а, округленное вниз до вот этого количества знаков.
Вот. Теперь мы хотим в таком же виде плюс 1, только чтоб знаков было больше.
Но для этого мы честной фурьятиной вычисляем, вычисляем х и плюс 1. То есть, заметим, да, что мы немножко
отошли от алгоритма в том плане, что мы не просто в тупую, каждый следующий счет берем тупо х и вот это все вычисляем.
А на самом деле мы, мы это и плюс им не просто в этом виде сделаем, а еще и попытаемся как-то там округлить и чуть-чуть подвигать.
Понимаете, да? Ну, потому что дело в том, что это число, это не обязательно будет число с нужной нам точностью.
Поэтому нам придется, во-первых, отрубить лишние знаки, а во-вторых, обнаружить, что возможно к этим знакам еще там 10 в степени,
там 2 в степени плюс 1 умножить на что-то еще придется там чуть-чуть добавить, но там чуть-чуть будет.
Вот, то есть, ну, мечта у нас такая, но сейчас вы увидите, откуда я ее взял. Ну, чтобы ее увидеть, давайте я тут просто еще чуть-чуть попишу.
Смотрите. Так, ладно. Так, ладно, эту картинку можно убрать. Зачем? Сейчас увидите, зачем.
Ну, скажем так, за какое-то да, но по крайней мере гарантии будут сильно более мутные какие-то.
Ну, Садрева, давай я сейчас аккуратно напишу и посмотрим, потому что как бы метод везде один, все равно надо написать и посмотреть, что получится.
Если сразу получится, что ничего делать не надо, как там в каком-нибудь красночерном дереве тогда, то...
Может, может. Скажем так, ну, теоретически можно, всегда так может быть, но с другой стороны...
Ну, не знаю, на самом деле, все равно, ну, да, чуть медленнее, чем мог бы быть, но с другой стороны, да, вот так иногда наука устроена.
Что-то как бы до идеала сложно, тем более, что, честно говоря, я абсолютно точного описания алгоритма, который прям чесно за n log n, такого нет.
То есть обычно все описания там говорят, что, ну, вот, да, вот есть вот этот метод Ньютона, заметим, что как бы если у нас была ошибка Эпсилон, то теперь у нас ошибка минус Эпсилон квадрат, вот мы с этого очень радуемся и дальше никто ничего не пишет.
Вот. То есть если найдете более точное описание, то, собственно, присылайте, буду рад. Ну, вот, собственно, собственно, будем читать.
Мне самому интересно, на самом деле. Значит, смотрите...
Давайте напишем после перерыва.
А что?
Время написано тиктаком.
Что время? Так вот.
Тиктак, тикток.
Ну, давайте, ладно.
Итак, значит, соответственно, давайте думать, как все это будем писать.
Итак, 1, значит, что нам там надо?
1 делить на a минус x и плюс 1.
Это у нас равно шо.
Что это такое?
Вот.
Это у нас получается равно.
Значит, пишем.
Напоминаю.
Вот.
1 делить на a умножить на, значит, 1 минус a, x и плюс 1.
Согласны?
Пока я ничего умного не представил.
А теперь давайте я подставим x плюс 1 вот в том виде, в котором у нас, значит, получится.
То есть на самом деле это получается 1 делить на a на 1 минус, соответственно...
Сколько там получается?
a, x и т, плюс a, f от x и t, выделить на f штрих от x и t.
Есть такое подозрение, да?
Значит, это...
Ну, давайте думать, сколько это в храмах.
Это равно, значит, на самом деле...
Соответственно, вот эту h мы замечаем.
Так.
Ну и нот.
Так.
Значит, нот.
Теперь вот очень хочется как-то действительно показать, что это как-то связано с 1 минус
a, x и t в квадрате.
Вот.
Ну, давайте так.
Если мы вспомним, что такое f от x и t поделить на f штрих от x и t, то на самом деле что
у нас, нот?
То есть если действительно так уже честно писать, то есть на самом деле это будет
1, то есть минус a, умножить нас, соответственно, вот этому x и t на 2 минуса x и t, да?
Вот если так совсем расписать.
Так.
А вот мы там где-то писали.
Ну, помните, да?
Ну, на самом деле, вот просто напрямую вот отсюда я просто написал, чему равно x
и т, вот мы уже это вычисляли.
Да, да, да.
Посмотри, чему равно.
Да.
Ну, я просто вот напомнил, что мы делали так.
Не более того.
Ну, во-первых, замечаем, что это равно, если так раскрыть скобочки, то я утверждаю,
что это равно 1 делить на a на 1 минус a и x и t у квадрата.
Ну вот.
Но если я тут теперь его, ну вот, но если я это 1 делить на a занесу внутрь, то что
у меня получается?
То есть это то же самое?
Ну вот.
Нет, а где?
Нет.
Внутрь я его не занесу.
То есть мне придется написать a и только после этого я тогда могу сказать, что
это 1 делить на a минус x и t в квадрате.
Вот сразу с таким утверждением?
Да.
Вот.
То есть смотрите, что получилось.
То есть у нас возникла маленькая оговорочка.
Оговорочка заключается в том, что вот эта штука, то есть да, она равна этой штуке
в квадрате, но умноженной на a.
Ну вот.
То есть хорошо.
То есть если мы знаем, что вот эта штука, мы знаем, что она у нас меньше, чем 1 делить
на 10 в степени 2 в степени i, то теперь про вот эту штуку мы знаем.
Значит, что 1 делить на a минус x и плюс 1.
Это теперь, ну, во-первых, это больше нуля, это приятно.
Ну вот.
И может быть даже больше либо равно нуля.
Ну вот.
Но мы знаем, что это меньше, чем a поделить на 10 в степени 2 в степени i.
Да, и плюс 1.
Вот.
Ну в принципе давайте вспомним, а у нас, ну, давайте какое у нас a.
Так, на каком мы в итоге a остановились?
Нет, мы заметили следующее.
Следующее, что, во-первых, если мы поделим a на 10, сдвинув точечку, то и у обратного
потом просто нужно будет точечку сдвинуть, ну, примерно туда же.
Поэтому мы можем сдвинуть точку так, то есть без ограничений общности, считать,
что a на самом деле, ну, либо в этом полуинтервале лежит, либо вот в этом.
Потом мы дальше применили метод в духе, что давайте делить a еще на 2 до тех пор,
пока оно не попадет вот в этот полуинтервал, например.
Ну, например, да, или там что-нибудь еще в этом вроде.
Ну, типа того, да.
Вот.
Ну, например, да, если мы в итоге согласились, что у нас a, допустим,
действительно хотя бы от одного до, ну, вот, ну, там, то есть если мы добились
того, что a у нас действительно от одного до двух, да, то тогда мы уже можем
теперь прописать, что это меньше, чем вот это, но тогда отсюда автоматически
следует, что нам вот x и плюс один либо уже в этом виде подходит,
либо нам нужно прибавить вот один делить на эту штуку, и может, может оно подходит.
То есть либо оно подходит, вот x плюс это подходит, либо это.
Ну, проверяется это, соответственно, за одну фурежку.
Секундочку.
Секундочку.
Если у нас вот это выполняется.
Да.
Эта штука всяком меньше, чем один на десять в степени два в степени один.
Да, но нам уже нужно два в степени плюс один.
Отбирайте за нём и скажем, что у нас просто индексы будут на единичку отставать.
Индексы будут на единичку отставать.
Сейчас.
Так, вы понимаете, так, смотрите, тогда вам нужно.
Не пропадёте.
У меня тоже не совпадёт с тем, что у тебя было очень шарик.
Нет, у вас нужно тогда, смотрите, тогда тебе нужно потребовать такую,
чтобы вот эта точность, вот она должна, она там допустим равна epsilon i, да?
Тогда тебе нужно взять такой epsilon i, чтобы вот там условно, там чтобы epsilon i плюс первая
было меньше либо равно, чем значит a, epsilon i.
А почему бы не сказать, что мы теперь действуем точностью один делит на пять в степени?
Один делит на пять.
Почему именно один делит на пять?
Ну, потому что мы пока что помним, что у нас точность улучшается в десять раз и улучшается в два раза.
Ну, не совсем она, нет, она улучшается в квадрат раз, но ухудшается в два.
Вот так.
Я примерно понимаю, почему с формальной точки зрения следим за этой бойкой,
потому что чтобы соблюдать реакцию.
Ну да, мы там, не только, ещё не только с формальной,
но ещё чтобы у нас была абсолютно точная буквальное понимание фразы,
потому что мы нашли ответ с точностью до там какого-то количества знаков.
После таких, после таких интеракций.
Да.
Очень хочется.
Да, потому что фишка ещё в том, чтобы мы это адекватно считали,
потому что нам же важно ещё, чтобы все вот эти вычисления мы делаем с числами,
у которых ограниченное число знаков после запятой, а именно два степени i.
Ну слава богу, до запятой там не сильно много знаков,
потому что мы ещё себе подогнали число a, кстати, приятно.
Да.
Видите, что оно у нас, что там, в общем, до знаков то,
то есть там будет либо ответ 1 сразу, либо там до точки стоит ответ 0,
по-любому.
Так что неинтересно.
Поэтому получается, что там числа всякие, то есть у нас a имеет размер n,
допустим, ну в смысле n знаков после запятой, допустим,
да, после этой единицы.
Вот.
И, ну вот, и соответственно, фурьешки с ним мы тоже тогда там
за какой-то адекватный n log n выполняем.
Вот.
Так что поэтому мы тут здесь очень аккуратно следим, да,
то есть получается ответ либо x и плюс 1,
или x и плюс 1 типа проинкомментировать.
Ну вот, степень и плюс 1.
Ну вот, вот видите, то есть мы константу вон там подгоняли чисто для того,
чтобы, чтобы тут вариант был.
Потому что если бы там было, если бы a было от 1 до 10,
то опять бы пришлось варианты перебирать.
Ну то есть это константа.
Вот.
Ну а теперь, правда, давайте думать хорошо,
за какую теперь асимптотику тогда это работает.
Ну с каждым, нет, что значит берем, не понял.
Или x и плюс 1, или x и плюс 1 плюс эта штука.
Ну мы берем.
То есть мы берем, донажаем,
да, берем x и плюс 1, нет.
Но если, скажи так, про x и плюс 1 я и так уже знаю,
что оно меньше, чем 1 делить на a.
Я, вот, только мне теперь нужно,
что если это число тоже меньше, чем 1 делить на a,
я его беру.
Если нет, нет.
Но как мне сравнить число с 1 делить на a?
Надо домножить его на a и сравнить с единицей.
Все.
Ну вот, это я делаю нот.
Значит, смотрите, тогда получается,
давайте думать, что я делаю на,
ну, смотрите, сначала я делаю o от n итерации
на нулевом шаге, правда?
Видите, да?
Там какой-то, каких-то там o от n итераций,
что-то там подогнал.
Вот у меня n знаков, допустим, после запятой.
Теперь давайте думать,
что я делаю, значит,
что я делаю, значит,
значит, на i-то итерации.
Сколько я времени трачу?
Две фурьешки 1, два степени i.
Да.
Ух ты.
Это откуда?
Смотрите, подлянка тут в том,
что фурьешка у меня в фурьешке a,
и тут у меня a, и вот в этой проверке
у меня a учитывается.
Получается, что, на самом деле,
если пользоваться это в тупую,
то есть совсем в тупую написать,
то фактически я это делаю
за максимум из n и 2 в степени i,
там лог того же самого.
Ну, если совсем в тупую фурьешку брать.
Хотя ладно, на самом деле
у нас есть не тупая фурьешка,
которая умеет делать вот так.
Как мы в прошлый раз научили,
помните, мы уже в прошлый раз уже...
Резкая оптимизация, да.
Ну, не резкая, а просто, да,
помним, что делим большой многочлен
на блок по маленьким,
домножаем их, потом складываем, радуемся.
И получается тут лог-мин все-таки.
Вот, это у нас, да,
было на первой паре сегодня.
Вот.
А теперь давайте думать.
Давайте a на каждом шаге брать
с нужной точностью.
Ну вот.
Ладно, давай так,
я сейчас тут аккуратно допишу,
собственно, очень исторично,
но ты пока можешь у себя пописать,
что получится.
Вот.
Значит, смотрите,
просто о чем тут...
Значит, что тут уже видно?
Ну, во-первых, заметим,
что первое логарифом итерации, да,
то есть, фактически,
мы должны вот все это просуммировать
по i равно от единицы
до той степени количества знаков,
которые нам очень хочется, правда?
Это будет пусть k.
Это получается, значит, поехали.
То есть, в принципе,
можно разбить на две суммы.
Можно разбить на сумму
от 1 до логарифма n.
То есть, пока вот степень не происходит.
И тогда мы получаем...
Тут получается n умножить
на, соответственно,
ну, минимум из этого 2 в степени i,
получается умножить на i.
Видите, да?
Плюс...
Что у нас еще получается?
И плюс дальше...
А дальнейшую сумму по i равно
лог 2n плюс 1,
там, соответственно,
до этого k большого.
Мы тогда уже выполняем
за 2 в степени i лог n.
Но тогда получается,
если это все просуммировать,
то это равно.
То есть, здесь заметим,
что это получается
θ от n лог квадрат n
и плюс...
Что еще получается?
Ну, вот.
Ну, а здесь лог n выносится,
а степень двойки
это все равно, то есть,
фактически θ от k лог n.
То есть, обратите внимание,
если вам нужно найти, например,
1 делить на какое-нибудь мелкое число,
1 делить на 37,
там, условно,
с помощью, там,
с точностью до каких-то знаков.
Ну, вот.
Ну, ладно,
1 делить на 37,
там оно, возможно,
периодическое будет,
скорее всего, поэтому.
Неинтересно.
Вот.
Ну, если вы будете искать
1 делить на 37 столбиком,
то у вас просто остатки,
которые у вас...
Тональное число периодическое.
Ну да.
Ну да.
Причем самый главный период
у вас будет быстро находиться.
Но, на самом деле,
я просто имел в виду следующее.
Если n мелкое,
то есть, по сравнению
с количеством знаков,
которые вы ищете,
то, в общем-то,
вы там, что-то типа
за k лог n работаете, да?
Ну, то есть, дальше
просто вопрос,
что больше?
k...
То есть, ладно,
тут не k,
2 в степени k, пардон.
То есть, что больше?
2 в степени ваша точность
или n лог n?
Пока, по крайней мере.
Вот.
Ну да.
Кто-то, правда, утверждал,
что мы можем все-таки
домножать за n лог n,
а не за n лог квадрат.
Да.
Ну вот.
Да, делить.
За n лог...
Вот.
Кто-то это был.
Ну, значит, давайте думать.
Что же тут вообще
можно сделать?
В чем проблема?
Можно ли нам избежать
действительно этого...
избежать этого безобразия
на тему того,
что действительно
домножать надо на n?
Ведь у нас проблема
что только в том,
что мы первой логоитерацией
просто на n.
Все делаем с фугиатиной за n.
Вот.
Ну, а возникает
естественная мысль.
А действительно,
мы должны учтить то,
как там предложили.
А может быть,
на каждом шаге
мы будем рассматривать
не все число a,
а только его там,
вот эти вот два в степени i знаков?
Может быть.
То есть, давайте так...
Нет, давайте так,
давайте честно пропишем.
a и t.
Это...
Значит, a и...
Ну вот.
Это просто a
округленное вниз
до...
Сколько там?
Ну, до скольки?
До два в степени i знаков.
Ну понятно, что после запятой.
Ну, все, что...
На самом деле,
к чему же это нас приводит?
Ну, на самом деле,
рассуждение это абсолютно
те же самые, правда?
То есть, на самом деле,
то есть, что у нас...
То есть, как бы алгоритм
как видоизменяется?
Он видоизменяется лишь тем,
что у нас,
когда мы делаем какую-нибудь...
Переходим от i к i плюс один,
у нас вот эта a и t
просто заменяется на i плюс один, правда?
И тогда у нас может возникнуть...
Ну вот.
И тогда у нас просто...
То есть, если вот этот инвариант
сохранится,
то есть, вот это условие, да,
то тогда мы просто тупо
делаем то же самое,
что было раньше
и, в общем-то, радуемся жизни, правда?
Ну, если это работает.
Да.
А если это не так?
Ну, с другой стороны,
давайте подумаем.
Вот мы тут,
смотрите,
мы тут с вами.
Хорошо, вот a и t
превратилась в a и плюс один, да?
Превратилась в a и плюс один,
которое лежит на полуинтервале
от a и това
до a и t плюс
один делить на десять в степени
два
и и т, да?
Понимание, вопрос.
А как поменяется
один делить на а и т, реально?
Как вы думаете?
Нужно а делить на это.
Что?
Что-то вроде нужно а делить на это.
Ну вот.
Ну, давайте я тут...
Так.
Ну, давайте я тут аккуратно попишу.
Значит, смотрите.
Вот.
Как бы мне тут это...
Ладно.
Значит, это превращается
в один делить на а и плюс один.
То есть, это у нас лежит
на полуинтервале
значит, от один делить на
а и т
плюс один делить на
десять в степени, два в степени и
и тут один делить на а и т.
То есть, да.
То есть, мы получили что-то меньшее.
Поэтому, возможно, x и t нам не подходят.
Но остается только выяснить
а насколько.
Вот как вот...
Вот это вот действительно,
это число меньше.
Но насколько оно меньше?
Вот есть подозрение, что да,
вот ненасильно много.
То есть, как-то есть ощущение,
что если я...
Вот я могу просто взять
вот это...
Там взять теперь
и тупо проверить,
подходит ли мне текущее число x и t.
Если подходит, то все хорошо.
Если не подходит,
я вычитаю вот эту штуку
и проверяю, подходит ли оно.
И так делаю, пока не подойдет.
Понятно, что я делаю, да?
Ну, я вот...
Вот с этого...
В ходе идеи, понятно?
Ну, то есть, смотрите.
Я не рассматриваю не все,
опять число, а только...
Ну, то есть, напоминаю, да,
что мы хотим сейчас, да?
То есть, давайте вспомним,
как у нас вообще алгоритм был устроен.
У нас он был устроен,
потому что у нас было x и t.
Это число, вот, и состоящее из 2 в степени
из знаков после запятой
и вот с таким условием, да?
И мы проворачивали с ним...
Мы там делали там,
какую-то шамань-шамань-шамань...
То есть, мы там делали с ним
вот такую операцию,
делали x плюс 1,
уже получали, что результат...
То есть, разность теперь уже меньше,
чем 2 на 10 степени...
2 в степени плюс 1.
Ну, и делали там небольшое шаманство,
чтобы эта разность была
меньше, чем 1.
Вот.
Значит, а у нас теперь проблема
еще вот в чем.
То есть, как бы, если у нас будет
такое x и t, то мы, значит,
все это просто буквально повторим.
Но проблема в том, что у нас...
Проблема в том,
проблема в том, что вот это a
у нас теперь меняется.
Если после...
То есть, теперь у нас
вариант звучит вот так.
То есть, тут a и t, да?
И если...
То есть, действительно,
если это верно, то, как бы,
вот это
может
быть неверным.
То есть, потому что
a и плюс 1 стало больше,
это стало меньше, поэтому...
Хотя, стоп.
Нет, самое самое...
Нет.
Нет, юмор, на самом деле,
знаете, в чем?
Что это, может быть, даже и верно.
Потому что, на самом деле,
мы неявно себе подразумеваем
еще вот такой вариантик.
Ну, это если бы в тупую делали, да?
Ну, просто, так как, когда
вы...
В табло заменяете, да?
Тогда это число сдвигается,
и как бы, вот, если оно...
То есть, вот это точно верно.
Но будет ли оно больше
либо равно нуля?
Непонятно.
Правда, с другой стороны,
возникает такой вопрос.
Прослушайте, а оно будет
больше или равно нуля,
когда оно звучит?
Что?
Держите определение...
Какое определение?
В смысле, ауэ, ну...
Вон оно написано,
справа-сверху.
А, округленное низ.
Ну, с чего бы
больше нуля?
Почему это что-то небольшое?
А что это такое?
Нет, тупо того, что...
Минус х и т.
Если х и т больше,
чем 1 делить на аи и т,
нет, если...
1 делить на аи и т,
у тебя, как бы,
штука меньше нуля.
Ну да, вот разность.
Тупо то, что...
Ну, как бы, смотрите.
Ну, то есть, смотрите,
вот еще...
Или еще вот так.
Вот х и т,
вот 1 делить на...
Вот аи и т.
Но, когда вы его уменьшили,
может так случиться, что
1 делить на аи и т
плюс первое,
уйдет вот куда-то сюда.
Нет, само по себе
это не страшно,
но просто дело в том,
что...
То есть, может быть,
и как бы не глобально,
потому что все равно
вычисления от этого
не меняются,
у нас все равно получится там,
что у них будет
этот вот квадрат
предыдущей разности.
Но маленькая оговорочка теперь.
Если он слишком уйдет в минус,
да?
То тогда...
То есть, как видите,
то есть, если мы
на это забьем,
то он может оказаться
и меньше нуля,
и меньше одного,
и меньше двух,
и тогда, то есть,
конечно, у нас там разность
будет опять положительная,
но утверждает,
что она будет меньше,
чем вот там к cuadра...
То есть, она будет
квадратом на а,
но как бы это не нодс,
но это уже меньше,
вот этого уже не будет.
Потому что там уже это...
Потому что в квадрат
нужно будет возводить
уже не вот это число,
а тот модуль разности,
который там получится.
Поэтому желательно убедиться,
то есть желательно убедиться,
что он не сильно далеко ушел.
Вот.
Вот. Ну вот, давайте думать. Ну вот. Ну, давайте внимательно смотреть. То есть, что, вот действительно, насколько же мы далеко ушли, как вы думаете?
Ну, это да, а1 делить тогда от этого, насколько далеко ушел.
Нет, в смысле, как раз-таки мы ушли на а1 делить на...
Ну вот. Но, на самом деле, да, для того, чтобы понять, насколько мы, нет, по а-то, вот насколько мы тут далеко ушли вот в 1 делить.
Ну, для этого, слушайте, а давайте длину этого полуинтервала найдем?
Так что у нас получится? Вот к чему равно 1 делить на аит, минус вот это вот 1 делить на аи, плюс вот это вот гадость?
Назовем ее Эпсилон. Давайте Эпсилонит ее наконец назовем.
Вот. Тогда к чему это равно?
Ну, да, приводим к общему знаменателю, Эпсилонит поделить на аит, на аит плюс Эпсилонит.
Видите, да?
И это, вот чудо, смотрите, дело в том, что мы же, так, что мы там себе приписали, что а у нас больше либо равно 1?
Да, давайте, так, давайте я лишнее наконец уберу.
Ну, где у нас? Нет, у нас просто тут вот, как бы, давайте вот это вот уберем.
И наконец себе скажем, что а у нас вот подогнали, что оно от 1 до, ну, так и быть, 2. Мы, ну, 2, как бы, уже воспользовались.
То есть, видите, какая снижка, что нам теперь, теперь мы воспользовались не только ограничением сверху, но ограничением снизу.
Это вот нам очень важно оказалось.
Но, по причину, мы им, когда нулевую итерацию искали, воспользовались.
Хотя нет, нет, там мы не пользовались, ладно.
Вот, значит, смотрите, что у нас тут получается?
Ну, тогда получается, если a и t, любое a и t больше либо равно 1, то вот эта штука, она автоматически, ну, на самом деле, просто строго меньше, чем epsilon и t, потому что эта штука строго больше 1, на самом деле.
Вот, неплохо, так, да?
Вот, то есть, поэтому, то есть, длина этого полуинтервала на самом деле меньше нашей ошибки.
То есть, следовательно, тут два варианта можно еще делать.
То есть, если вы, то есть, либо вы как бы продолжаете упираться вот в вариант, чтобы тут было больше либо равно 0, и просто сдвигаете x на 1, если нужно.
Либо просто замечаете, что разница, если он даже уйдет в минус, то разница все равно будет меньше, чем epsilon и t.
И на самом деле вы все равно, там все равно можете себе там повозводить в квадрат и получить ровно то же самое, что и было раньше.
То есть, просто тут уже просто и так и так можно сделать.
А у нас epsilon, оно не помодулирует. То есть, epsilon и t, если это меньше 0.
Нет, оно не меньше 0.
Почему?
Потому что, ну, в варианте, это мы все, смотрите, в варианте-то мы по-любому прописали, что epsilon и больше 0.
Потому что epsilon и тупо равно вот этому числу.
Так что мы себе это прописали.
Вот. Ну, мы уже выяснили, что на самом деле тут, то есть, как бы это все равно, то есть, как бы epsilon.
Заметьте, что epsilon при вот этой вот комбинации, он все равно превращается в, там, a умножить на epsilon в квадрате, по факту.
Независимо от того, вы на самом деле положительные или отрицательные.
То есть, это мы себе только для удобства нарисовали картинку, что мы идем слева и рисуем epsilon с таком виде.
А на самом деле он может быть и отрицательным, и суть не изменится от этого.
Вот.
Но тогда к чему это нас приводит?
Но тогда это нас приводит к тому, что, когда мы тут работаем на i плюс первой итерации, мы перемножаем числа, которые по размеру не превосходят 2 в степени i плюс 1.
И тогда у нас здесь не максимум из n, 2 в степени i.
Ну, то есть, да, он действительно...
Но вот a вполне себе теперь самостоятельная 2 в степени i.
Вот.
То есть тогда, когда это убираем, получается, 2 в степени i на i, и на самом деле i этот квадрат убивается.
Нет, просто очень аккуратное ограничение.
То есть, в общем-то, конкретно здесь, в общем-то, действительно, не сильно страшно получилось.
То есть, обратите внимание, поделить с нужной нам точностью,
то есть поделить там, допустим, число с n значащими знаками, там с точностью до каких-нибудь n значащих знаков после запятой, точнее обратить, вы можете теперь взаимодействовать.
Ну, там более аккуратно теперь можете это.
Вот и все.
То есть, просто вот, да.
То есть, как бы, да, то есть, фактически, да, то же самое, потому что исходное это называется метод Ньютона, если быть точнее, метод Ньютона Рапсона на самом деле.
Вот.
Соответственно, то просто вот, если очень аккуратно делать, вот, как говорится, n лог n на лицо.
Но более того, на самом деле, метод на самом деле на этом-то не заканчивается.
Потому что, вот, давайте сейчас попробуем еще развлечься.
А только ли деление, точнее обращение, можно ли вот таким образом сделать?
Вот.
Потому что, наверное, где-то вот возникает жуткое ощущение, что можно на самом деле еще кое-что.
Вот давайте-ка попробуем таким методом корень развлечься.
Вот, да.
Как говорится, а вот, да.
Ну, а что?
Как говорится, а почему бы и нет?
А с чем черт-то?
Ну, черт-то с чем угодно шутит.
Мы тут при чем?
История.
История.
Вы там на истории корни извлекаете?
Столбик делаем.
Мы делаем всех, доделаем всех столбик.
Значит так.
Вот теперь поехали.
Итак, дано число а, и мы очень хотим извлечь из него а.
Извлечь из него корень.
Квадрат.
Ну, в перспективе окажется, что скорее, если этот получится, то, наверное, и корень любой константной степени извлечен, в общем-то.
Ну, вот так это.
То есть константный, ну да, в том же смысле, в котором у нас короцуба за n в степени 1 плюс f работает.
Константа.
Ну, пока давайте вот корень.
Корень.
Ну, давайте думать.
Значит, что же нам сделать?
Итак.
Значит, что нам надо?
Какие итерации делать?
f от x, ну какая там у нас формула была, да?
То есть f от x и плюс первое равно, таки так, ладно, не f надо, а x и плюс первое равно x и t минус f от x и t поделить на f штрих от x и t.
Ну, давайте думать.
Ну, кстати, есть самая вермонская последовательность.
Это какую?
Ну, там, короче, помнишь?
Короче, у нас в умотании была такая штука, которая называется вермонская последовательность, она очень быстро расходится.
А, это было то же самое.
А что это за последовательность?
Да там была, ну, мы на типа идиопатенте, что если x и плюс первое, это x и t плюс 2 и на x и t.
Ох ты.
И там расходится.
Она очень быстро расходится.
Ну, давайте разбираться.
Ну, давайте так, какую f тогда мы возьмем?
Ну, давайте напишем f от x равно x квадрат минус a.
То есть картинка будет немножко другая, то есть она теперь вот такая.
Так, ну, это похоже на параболу, да?
Вот.
А суть та же там.
Изначально x и t у нас будет это, то есть теперь, наверное, оно будет уже округленное вверх.
Вот.
Но, тем не менее, неважно.
Значит, поехали.
Хорошо.
x квадрат минус a.
Так, ну, давайте смотреть, что у нас тогда получится.
Получится, да, x и t минус, значит, x квадрат минус a поделить на 2x.
Так, x и t только везде.
Ну, если очень аккуратно порасписывать, то что там получится?
x и t пополам плюс a поделить на 2x.
Так, ну, допустим, делить мы умеем, да?
Вот.
Да, ну, допустим.
Так.
И к чему нас это будет приводить?
Ну, давайте как всегда.
Как это называется?
Делаем как всегда.
x и плюс 1 минус корень иза равно.
Чего оно равно?
x и t пополам плюс a делить на 2x и t минус корень иза.
Вот.
Давайте все под общий знаменатель заходят определиться.
Так.
Где?
Сейчас.
Где под общий знаменатель?
Ну, в общем, все под общий знаменатель.
Вообще.
Вообще все.
Так.
А что?
Давайте так.
Что мы за скобку вынесем?
Давайте.
Ничего.
Просто под общий знаменатель.
На одну вторую бы, наверное, я вынес.
Ну, в смысле?
Вот.
Я так скажу.
Это будет одна.
Сейчас.
Одна вторая и полный квадрат будет.
Это корень из x и t.
Собственно, минус корень из x в квадрате.
Вот.
Вот с этим я соглашусь.
Ну.
Ну.
Ну.
Ну.
Ну.
Ну.
Ну.
Ну.
Ну.
Ну.
Ну.
Минус в квадрате.
На одну вторую мне соглашусь.
Да.
Действительно.
Да.
А чего не подходит?
Так.
А!
А что не подходит?
О, сейчас. Так, хорошо, что нам нужно? Так, вот это нам нужно.
Да, ну давайте мысленно. Так, если мы это внесем, то у меня будет 1 минус корень из-за...
Ой, да, просто. А, просто квадрат, вот так, да?
Так, ну да, типа если его сюда вынести, то значит будет просто, да, просто a минус 2 корень из-за х, и тут х квадрат. Ну да, кайф.
Так, ну смотрите, видите, то есть проблема в том, что теперь у нас получается тэпсилон, это не точно.
Но с другой стороны, про иксы тэ это мы уже кое-что можем гарантировать, правда?
Потому что мы можем заметить, что у нас иксы тэ хотя бы там... ну то есть заметим, что иксы тэ мы можем здесь оценить снизу, правда?
Вот, например, если мы скажем, что у нас там а у нас как всегда... ну тут смотрите, тут правда оговорочки уже придется сделать посильнее, смотрите.
Потому что какое у нас должно быть а? Теперь замечаем, что с корнем уже надо аккуратнее подгонять.
Потому что если вы поделите на 10, то как бы ответ изменится уже в корень из 10 раз.
То есть если подогнать 100 раз, то тогда ответ изменится в 4, уже в 10 раз. Это уже нормально.
Поэтому с дригом точки можно добиться того, что а у нас от 1 до 100. Ну все равно константа, да?
Вот.
Да, константа, да. То перечие. Нет, ну как бы как всегда можно поделить, если в случае чего а можно всегда поделить, например, на 25.
Нет, а можно на 4 поделить. Если а поделить на 4, то ответ поделится на 2.
Поэтому поехали. 100 превращается в 25. Вот. Потом 25 автоматически превращается.
Называется тем... ну а стоп, если мы все равно делим на 4 до упора, то в общем кончается просто тем, что у нас от 1 до 4.
Что мы тут паримся-то? Что? Да, то есть как бы...
Если мы сначала сводим вот этот...
Кодому до 100, а потом...
Да, правда несколько раз, возможно там три раза придется поделить в худшем случае. Но получается, что от отводки 4, да.
Вот.
Но это не важно. Самое главное для нас, это то, что у нас все вот эти вот х...
Ну, во-первых, да. Во-первых, возникает вопрос...
Правда, а х0-то нам откуда блять теперь?
То есть нам очень хочется, чтобы на этот раз корень из х0-а было меньше, чем что?
Меньше, чем 1, да?
Да, неправильно.
То есть вот очень хотелось бы... Ну вот.
Но с другой стороны, нам нужно получается... Что нам нужно? Ну вот.
Но с другой стороны, тут опять есть подозрение, что можно сильно далеко не ходить и найти ответ бинпояс.
А у нас от 1 до 4, да, соответственно, значит мы что знаем?
Что 1 делить на а у нас где-то от 1 к 4 до 1.
Поразительно, я не могу в это поверить.
Ну вот. Ну и соответственно, если нам нужно с какой-то определенной точностью...
Ну вот. Хотя что?
Так как это в данном случае получается нам...
А нет, там не один. Если не равно 0, к сожалению, 1 десятая нужна.
С единицей бы мы с полпинка справились.
А с одной десятой... Ну, придется опять тут какие-то бинпоиски загонять.
Ну или... А нет, не или. Тут просто больше придется загонять без вариантов.
Вот. Или там... Ну или там, я не знаю, еще на какой-нибудь гадость делить.
Хотя нет, тут уже не поделишь просто так.
Вот. Ну а как бы тут уже более жестким бинпоискам тогда что-то искать.
Благо проверять число меньше или больше корня у нас тут легко, слава богу.
Вот. То есть функция приятная. Вот глазу. Поэтому так.
Поэтому это мы нашли. Но тогда, если мы это нашли, то вот эта штука,
то есть она равна, получается, меньше либо равно, чем e эпсилон i t поделить на...
Ну там x i t у нас больше на этот раз, да, поэтому они больше чем...
Больше чем 1. Больше либо равно, чем 1.
Поэтому это получается... Значит, получается, что это больше epсилон i t в квадрате,
и еще и пополам. Неплохо так, да? То есть более того, тут...
Ну вот. Единственная маленькая проблема, это то, что подгонять все равно придется.
Потому что еще мы должны отпилить... Потому что когда вы вычислите прям вот эту вот всю гадость,
вам какие-то знаки придется, вы какие-то знаки отпилите.
А когда вы отпиливаете какие-то знаки, то есть вот фактически вы из этого числа что-то вычитаете, правда?
Но вы можете вычитаться так, что у вас это число станет...
То есть вычитаете знаки так, что у вас оно попадет просто в меньше, чем корень.
Поэтому вам придется все-таки это проверить, и в случае чего, соответствующую одну единичку куда-то прибавить.
Но на самом деле, действительно, то есть заметим, что там, действительно, ошибка тут у нас...
То есть ошибка небольшая от того, что вы тут стерли, вы тут сдвинулись только не более чем на одну штучку.
Поэтому вам останется только проверить, действительно, куда округлять вверх-в-из, соответственно.
То есть получается, что и как-то с корнячкой тоже адекватно, правда?
Правда, единственная проблема, что, по-моему, в этих вычислениях все-таки...
А насколько жестко мы вообще сейчас пользовались тем, что этот корень именно квадратный?
Вот допустим, был бы кубический, что бы было?
Чего?
Ну там просто...
Так, тут будет тройка.
Нет, видите, вот эти вот штуки не скандачатся.
То есть теперь, в общем случае, не совсем так.
Подождите, у вас снизу стоит производная.
А, тогда у вас тут...
Хорошо, да, 3х.
Так.
Так, ну давайте думать.
Так, нет, ну давайте смотреть, что сейчас, как бы, вдруг получится.
Вот.
Значит, смотрите, что у нас тут получается.
У нас тут получается, тут шлеп-шлеп, получается 2 третьи хитого,
минус а делить на плюс, ладно, хит в квадрате.
Видим, да?
Ну правда, что мы тут видим?
К сожалению, да, то есть это...
Неприятность.
А, придите, так.
Ну вот, теперь, значит, что у нас тут получается?
Еще раз, значит, что у нас тут?
х и плюс 1 минус корень кубической степени иза.
Получился.
Чему равен?
То есть 2 третьи хитая,
значит, плюс а на там 3х и в квадрате,
минус корень кубической степени иза.
Все, прям помянем.
Ну...
Так.
Ну, я не знаю тут, как...
Хотя с одной стороны, да,
но с другой стороны, а что нам мешает?
Может быть, это...
Может, все-таки, удастся это как-то вот...
Ну, действительно, что нам могло бы помешать,
это пихнуть в квадрат.
Помешает пока то, что тут х и тут х разной степени, да?
Ну, это ж, казалось бы, там,
какой-нибудь подгоночкой-то решается, правда?
То есть более-то вообще я могу, ну вот...
Нет, можно...
Нет, а можно даже так, смотрите,
тут другой хит можно.
А может, мы же можем подогнать так,
чтобы тут было х в степени полтора
и тут х в степени полтора.
Можем так сделать?
Нереально, да?
Почему?
А в смысле подогнать?
Ну, как сказать?
Так, ну давайте, нет, просто...
Может, когда 2 третий подъемится?
Да, то есть, смотрите.
Нет, ну 2 третий, погодите, с двумя третями,
давайте сначала корень из х.
Повеселимся?
Значит, смотрите, так.
Вот, значит, я люблю так.
А делить на 3, значит, корень из хит.
И, значит, тут минус корень кубический из...
Ага.
Да, согласен.
Хорошо, хорошо, да, пожалуйста.
Так, ну что?
Спрашивает, вынесся квадрат?
Как вы думаете?
Так.
А, погодите, тут не корень.
Так.
Да, ну тут, да, тут,
тут, конечно, по-любому проблема,
конечно, заключает в том, что
либо Сашка как-то эту проблему решит.
Да, неприятно.
Нет, просто да.
Ну да, ну просто странно, почему
предыдущие два раза нам
почему-то так фортило, а тут не фортило.
И что?
Я еще не вижу, кто-то угол кубических корень ставит.
Нет, ну, понимаете,
как бы есть...
Нет, на самом деле есть ощущение,
есть ощущение, по идее, что как бы
ошибка должна быть квадратичной.
Вот.
Второй способ как бы
решать кубически, на самом деле сейчас в этом месте
все-таки попробовать поискать,
а нельзя ли действительно это все в общем видео
писать?
Давайте себе представим, что у нас
кто запрещал?
Да ладно.
Как это запрещать?
Ой, как это? Он не мог
вам ничего не запрещать, а запрещать по той простой
причине, что он умер.
Знаете, как это
говорится, да,
Тагеев умер там, не помню в каком,
в 1905 году.
И как следствие, собственно, не мог
там, собственно, не мог
присутствовать с нами ни в 1906,
ни в 1907,
ни в 1908, и так
дошел до 1974 года.
Ой, ладно, это отдельная песня.
Вот. А вот давайте
попробуем действительно это себе вообразить
в общем видео.
Что нам вообще?
Вот давайте просто хочется попробовать
поиграться,
потому что на самом деле просто
идея в следующем. Смотрите, вот мы с вами
на самом деле пытаемся
активно пользоваться тем, что
вот на самом деле f от x
тем, что вот f от x минус
f от x ноль на самом деле равно
ну, приблизительно
равно f штрих
от какой-то градости умножить
на x минус x ноль, да,
где кси
лежит на полуинтервале, на
интервале от x ноль до x.
Логично, да?
Ну вот.
Что ей так?
Все не нравится.
О, Господи, да.
Как это?
Вы в жизни тихо говорите, что
я что-то не понимаю.
Нет, просто фишка такая.
Дело
в том, что очень хочется написать
что-нибудь, потому что на самом деле
действительно очень хочется
приближать x
не с точностью до этого
epsilon, а с точностью до этой разности
на какую-то константу.
Ну, почему это константа? Потому что если мы
рассмотрим вот такую функцию,
как это называется, да,
из цикла, зачем вот анализ
этот вообще существует, да,
что он делает. Вот, смотрите,
то есть здесь у нас есть какая-то точечка,
то в epsilon-окрестности
ее мы знаем, что у нас
f от x очень
похожа на прямую.
Почему очень похожа? Потому что если она
имеет непрерывную производную,
то мы знаем, что
модуль разности f от x
минус f от x0
он значит будет,
то есть он равен модулю вот этому
и он будет не превосходить
какой-то константы,
допустим, b
на модуль x
минус x0, потому что на этом
полуинтервале, то есть на этом интервале
производная ограничена.
Ну, например, если она непрерывная.
А теперь вот идея возникает
следующая.
Очень хотелось бы теперь сказать,
то есть попытаться
оценивать это не из линейности,
вот мы сейчас из линейности,
по сути вся эта штука у нас там
из линейности пролазь.
То есть мы пытались
как-то подгонять.
А теперь возникает вопрос, а что будет,
если мы попробуем все-таки до второго знака
подгонять.
То есть смотрите, просто тогда у нас получится,
вот очень хочется
написать что-то в духе
f от x0 равно
f от x0
плюс f'
вот это и еще плюс какой-то
слагаемое.
Она родимая.
То есть формула Тейлора в этом месте говорит,
ну, даже в идеале
формула Тейлора
просто не заморачивается и говорит,
что тут это от x-x0 в квадрате.
Вот нам бы
давайте нам бы поточнее.
Давайте.
Вот эти я фамилии забыл уже.
Значит там хочется взять
что-то типа тоже
f два штриха от какой-то гадости
x-x0 в квадрате.
Возможно я тут двойку забыл.
А возможно и нет.
Сейчас забыл.
Ну да, по идее да,
что там в разложении вредня тут да,
на 2 в квадрате, на 30 в квадрате.
Вот.
То есть по идее вот такой вот это Тейлора.
Можно в принципе попробовать сейчас прям из керебра Лагранжа
просто это в наглую вывести.
Ну потому что
действительно
так.
Ну да, да, да.
Я понимаю, да.
Вот.
То есть ну значит
что у нас тут получается?
То есть откуда мы это возьмем?
То есть мы просто поняли, да?
То есть это вот. То есть это эквивалентно тому,
что f от x
минус
f от x0
поделить на
x-x0
должно быть равно просто
f'
от x0
называется плюс какая-то гадость.
От
x и пополам
от x минус
x0.
Ну то есть это вот эквивалентное равенство, правда?
Что мы знаем про эту штуку?
Про эту штуку мы знаем,
что она равна f'
от какой-то другой гадости.
Вот.
Да, даже правильно тут писать другую гадость.
И тут будем писать вот эту гадость.
А вот это, а вот тут
будем писать гадость для первого порядка.
Ну вот.
Но теперь
возникает такое...
А теперь у меня почему-то начинает возникает подозрение,
что не нужна тут никакая двойка.
Потому что если я сейчас
скажу, что у меня просто есть
непрерывная вторая производная, то я просто
тогда для, теперь уже для f'
теперь просто интервал от x0
до xi напишу просто теремулоз
раньше. Так что не нужна там никакая двойка.
Вот.
Вот.
Если она есть, то да.
То есть
нет, смотрите, то есть пока
то есть по идее вот это все было
вот так хорошо верно,
если мы имеем на этом полуинтервале
там, а лучше отрезке,
непрерывную вторую производную.
Вот. Понятно, да?
Вот это все,
что я утверждаю.
Теремилогранж это?
А, просто наличие производной, да?
Ну да.
Ну да, да, да, да, да.
Согласен, да, там в принципе только наличие
полного наличия
производной достаточно, да, согласен.
Вот.
Хорошо, хорошо. Ну вот.
Но тогда просто это мы к чему?
Потому что
то есть поэтому, смотрите,
у нас просто суть заключается в том, что мы
когда берем f от x,
мы пытаемся его приближать
каким-то таким вот образом, правда?
Вот, понимаете, да?
Поэтому вот очень хочется
просто найти такую, находить.
Вот представим себе, что у нас функция f
имеет
какую-то вот такую
красивую производную в том плане, что
она там, скажем, возрастает
и выпукла, да?
Ну выпукла для того, чтобы у нас тут вот
эти производные нормально сходились, они
начинали там кругляк какие-то
лепить. Понятно, да?
Тогда
вот в идеале очень хочется, что мы
просто когда мы, от каждого x
мы пытаемся вот вычесть вот эту вот
вот это вот какое-то линейное
представление, чтобы вот тут
тогда в разности осталось
только вот, то есть вот это вот
член.
Ну, по большому счету,
смотри, ну вот.
То есть вот такая вот пример на сути.
То есть именно вот отсюда
у нас вот возникает должно ощущение, что
как бы на каждой следующей
итерации, то есть разность должна быть как
в предыдущей итерации, но там
уже в квадрате. То есть потому, что
наша цель там сделать какой-то текст, чтобы вот
эта вот штука тупо обнулилась.
Вот, понятно, да?
Понятная идея?
Нет, ну что?
Нет, а что? В каком
месте что не так?
Ну вот.
Ну не знаю.
Пока просто да, честный
красивый ряд. Что еще надо?
Ну вот.
Нет, ну пока
пока вот да, честный мотан
ничего страшного.
Почему ложь?
Вот это ложь?
Все-таки пополам? Хорошо, где у нас
ошибка в доказательстве?
Ну в общем, видите, там нужно
вперед идти. Нет, ну я знаю, что
в ряде может...
Мы нашли просто тут f'
от...
И так далее.
Где у тебя константы?
Ну мы сейчас нашли какую-то веку, при которой
она... Да, это понятно.
Но это в существовательном интервале
от x до x0
или что-то такое.
Кто это гарантирует?
Теремовая гарантия?
Теремовая гарантия нам гарантирует.
Вы просто теремовую гарантию выиграли,
как можно вывести... Мы вообще не делали
этого, что вы отточили твердый мот,
чтобы он не умер.
Там и то его выводили, да?
Нет.
Вот я имею в виду, это там не отравлено.
Нет, ну можно.
Вот.
Ой, боже мой.
Нет, это прям страшно.
Это прям страшно, на самом деле.
Нет, ну вот на самом деле.
Ну, в любом случае
называется, какой бы ряд ни был,
а действительно, суть в том, чтобы мы действительно
попытались сделать так, чтобы у нас
соответственно x куда-то уходили.
Ну, во-первых, начнем
с того, что с точностью до константы,
у нас на каждой итерации, да?
То есть, мы знаем, что у нас,
допустим,
x и t минус x ноль,
то есть, если на эту штуку поделить
f от x и минус f от x ноль,
то есть, мы знаем,
что это равно, потеряемого гаранжа,
f штрих от какой-то x.
Есть такое?
Вот это точно.
Ну, вот.
Ну, вот.
Ну, просто можно
проверить. Или просто как-то
поверить, что, знаете, если у нас есть производная,
то есть,
какое-нибудь веселое диаметрическое доказательство.
То есть, рассмотрим график функции.
Вот он.
Вот.
И тогда
вот как-то
есть жуткое подозрение, что
действительно найдется какая-то точка,
у которой действительно
касательная будет параллельно этому
отрезку. Почему?
Знаете, совсем неформально может так доказывать.
Возьмем такую параллельную прямую
и будем ее просто сюда вот двигать, двигать,
двигать, двигать, двигать.
Она на точечку наткнется.
Вот на вот эту вот.
Причем, более того, наступит прямо именно момент,
когда она наткнется, потому что тут все непрерывно.
Да, как повезет. Но хотя бы на одну...
Но главное не будет такого момента, что, типа,
сейчас не наткнулась, а потом...
а дальше там будет много пересекать.
Вот и все.
То есть можно ее так...
Можно прям, как бы,
поверить в серему роли для ситуации,
когда эти штуки... когда f от x и равно
f от x ноль, и потом там повыводить еще можно.
Но это уже так.
Так что без паники.
Вот. Значит, соответственно, да.
То есть в такую серему мы все-таки еще поверим.
Вот.
Ну а теперь давайте разбираться.
Но заметим, что если у нас есть
уже вторая производная, которая еще и больше
нуля на этом полуинтервале, да?
Ну, то есть это означает, что...
в принципе, уже означает, что и первая производная
на самом деле непрерывна на этом
полуинтервале, правда?
То есть поэтому мы можем себе сказать,
что там, допустим,
модуль f штрих от x
он лежит
на, скорее всего, каком-то
полуинтервале, да? Желательно положительном.
Можем такое сказать?
Да.
Ну да. Напоминаю, что у нас
соответственно есть
нот. То есть напоминаю, что у нас интересует
какой-то урексов
какой-то там полуинтервал.
Такой можно сказать.
То есть какой-нибудь там даже отрезок
от, допустим, x
штрих до x2 штриха
какой-нибудь, да? И мы знаем, что
из кома и нами корень, вот этот xр
условно лежит на
x1 и x2 штриха.
Вот это я просто апеллирую
я все в той же картинке.
То есть пусть у нас функция монотонна
и выпукла вниз для удобства.
Видите, да?
Вот.
И что самое приятное, то есть у нас
мы еще хотим, чтобы она была выплыва вниз, то есть у нас
чтобы и вторая производная
у нас тоже была
тут
на каком-то полуинтервале желательно.
Вот так.
На каком-то отрезке, в чем желательно, чтобы
0 меньше и b1 и
c1.
То есть отделимо больше нуля.
Вот.
Но давайте смотреть.
К чему нас это приводит?
То есть тогда мы понимаем,
что xt-x0
это
в принципе отличается,
то есть фактически в константу раз
где-то от f от x
минус f от x0 просто по этой теории.
Согласны?
Ну да.
Но давайте
разбираться.
То есть нам бы просто
теперь очень хотелось, чтобы вот
x и плюс один минус x0
было в идеале меньше
либо равно, чем
x и t минус x0 на какую-то
мистическую константу g.
Вот очень бы хотелось, правда?
Вот.
Ну вот.
Но теперь вот возникает действительно вопрос.
Откуда же нам такую
штуку взять?
Взять ее можно вот откуда.
Вот.
Но соответственно мы знаем,
что x плюс один минус x0
это, то есть мы знаем,
что x и плюс один
ну вот мы пока думаем, как выучить
x минус x0.
Это у нас что такое?
Это с точностью до константа, то есть это
на самом деле f от
x и плюс один
минус f от
x и
поделить на
f' от epsilon.
Да?
То есть это в принципе там тоже, видите,
с точностью до константы. Я вот могу это там снизу оценить.
Вот один делить на это какой-то константой.
И поэтому получить что?
Ой, тут x0, конечно.
Ну вот.
И соответственно сказать, что
это то, что надо, да?
Вот.
Ну да.
Смотрите.
А это не важно.
На самом деле мы уже это себе прописали.
Нам даже не принципиально,
что оно возрастает, хотя это тоже правда.
Да.
То есть поэтому можно
сразу себе прописываем,
что это не
один делить на c,
значит f от x и
минус f от
x0.
Тут не x0, да, xr.
Пардон.
Мы же к xr стремимся.
Но смотрите,
чем приятно. У нас приятный заключается в том,
что f от xr равно 0, правда?
Есть такое подозрение, да?
Ну да.
Вот.
То есть на самом деле
вот.
То есть на самом деле
можно попытаться
сказать, ну вот.
То есть там можно попытаться
действительно сказать,
что это один делить на c,
f от x плюс 1.
Ну просто
вот.
Но тогда
смотрите, какая фишка.
Просто нам же очень хотелось
действительно, что мы делали.
Мы, помните, очень хотели вот
когда мы делали вот эту вот комбинат,
вот эту вот штуку веселую, нам очень
хотелось подогнать, чтобы
то есть просто провести тут
касательную и сказать, что тут был
0, правда? Помните вот этот
x и t мы откуда брали, помните?
Но тогда
если мы вот это вот, это вот выполним,
то у нас было x и t,
а это у нас было,
что это такое было?
Это было x и плюс 1,
а теперь давайте вспомним, чему оно равно.
Оно равно x и t
минус f от
x и t поделить на f штрих от
x и t. Было дело?
Вот.
Ну вот.
Ну поехали.
То есть это
ну вот,
то есть это на самом деле
1 делить на c1,
значит f от, вот допоминаю,
x и t, минус
f от x и t,
минус, минус, минус,
минус f штрих
от x и t. Ура!
Но!
Но теперь заметим,
то есть получается, видите, мы x и t,
то есть фактически
x и t вот изменили.
Теперь заметим, что мы же можем это на самом деле
пораскладывать во что-нибудь хорошее,
не только в окрестности точки
xr, но и
вот в этой окрестности, правда?
Ну вот. Чего нет?
То есть, ну вот.
Ну вот.
Ну в принципе на самом деле можем,
а можем и в той же окрестности точки r
на самом деле это пораскладывать.
Так.
Чего-чего?
Вот.
То есть можем действительно это
даже и пораскладывать.
И в принципе тогда у нас получится на самом деле, кроме
даже маленькой приятной штуки, типа
производной здесь.
Вот, кстати.
Вот все это в какую сторону теперь думать.
Вот. Ну просто сразу скажу, значит,
в какую сторону все это хочется это дописать.
То есть хочется это
действительно разложить действительно
до второго порядка.
Но причем разложить до второго порядка
таким образом, чтобы у нас там эти
слагаемые первого порядка торжественно схлопнулись.
И осталось у нас только вот
вторая производная какая-нибудь.
Ну может быть на константу, конечно.
Вот у нас c1, видите?
То есть вот какая у нас цель.
Да. Цель хорошее.
Вот.
Ну то есть при нот...
Да. Ну вот.
Да, действительно ровно это нам бы и хотелось.
Вот. Ну просто с этой целью, то есть помните, мы
добивались того, то есть мы пытались...
Вот давайте вспомним.
Чего мы пытались добиться?
Почему мы вообще писали эту функцию?
Потому что, да, мы...
То есть на самом деле
да, мы...
То есть мы хотели добиться того,
чтобы у нас действительно
на f от x и плюс 1
минус f от x и
поделить на
x и плюс 1 минус x и
вот с одной стороны мы хотим, чтобы
вот это было равно...
То есть это было равно
просто тупо.
Ну вот f' от x. Ну такая была бы мечта у нас
в идеале, да? То есть чтобы вот
подогнать под производную вот так.
Согласны? Ну правда, конечно, тут
не совсем f. Тут как бы
тоже это вот подгоняем.
То есть надо вот подогнать было так,
чтобы желательно, чтобы тут был 0.
Даже вот тут f от x и 1, типа
он был бы там псевдо 0.
Помните, такая у нас цель была на самом деле.
И ровно из этой цели мы там что-то
подогнали.
Вот. Ну вот теперь возникает
вопрос, как бы нам этим воспользоваться?
Вот.
Потому что...
Ну за нот...
То есть теперь
соответственно мы можем
заметить, что там соответственно
минус, что допустим
минус f от x и
это равно соответственно
x и плюс 1
минус x и
соответственно на f'
от x и.
Вот.
Такая вот например штука получается.
Вот.
Ну вот.
Из нее это получается и там соответственно
все деления
и собственно вылезают.
Вот.
Ну что? Так вот, как вы думаете?
Все будем делать?
Все?
Нет.
Нет.
Не катарсис, а затуп.
Да.
То есть катарсис как бы да,
если мы все-таки обнаружим,
называется... Осторожно.
А что там просто уже оно уже разрядилось
и это уже сказал, что...
Ну вот.
Да.
Действительно у нас батарея в ноль.
Но с другой стороны заметим, что
на самом деле чем эта штука вообще
полезна?
То есть на самом деле вот она,
то есть вот эта вот штука, на самом деле,
если вот перенести, то есть мы вот подгоняли,
что там она там, то есть какой-то вот x1,
чтобы она тут была ноль, да?
Но с другой стороны теперь идея такая, а давайте
попробуем вот просто в окрестности
x и попытаться эту штуку
действительно в ряд разложить.
Что получится?
Вот.
Получится примерно следующее.
То есть 1 делить на c1.
Значит тут получается
на самом деле f от
x и
ну вот
f от x и
плюс f от...
Ну в данном случае можно просто
сказать, минус f
от какой-то нюши
умножить на вот f от x и
поделить на f штрих
от x и.
Вот согласны, да?
Да.
Но парамерить с точностью до одного порядка.
Видите, да?
Ну просто как бы разность
между вот этим вот и x и там
будет как раз вот такой.
Но на самом деле, вот я собственно к чему
это все говорил.
Как бы что надо сделать, чтобы у меня тут
получился f штрих от x и, да?
Чтобы получился у меня тут f штрих
от x и,
то есть я просто
то есть должен разложить это до второго порядка
малости.
Нет, мы получим ноль и
второй порядок малости это
то, что нам нужно.
Смотрите, во, смотрите внимательно.
Дальше за руками.
Вот.
Смотрите, смотрите, смотрите.
То есть на самом деле,
то есть если
вот раскладывать прям до второго порядка
малости в том виде, в котором я сказал,
в чем там уже сейчас не очень принципиально будет есть там двойка
или нет.
Но вот, хотя я утверждаю, что есть
доказательства, найдете ошибку, буду рад.
Вот.
То на самом деле тогда у нас получается,
что это равно
f от x и
f штрих от x и
на там
условно,
да я так и напишу, господи, значит
x и плюс один минус
x и, да?
Плюс там f два
штриха от какой-то вот этой вот
нюши
на x и плюс один минус
x и у квадрата.
Но заметим, что
x и плюс один, вот зачем мы это
поняли, мы подгоняли так, чтобы вот это
был ноль, помните?
Вот реально мы их, то есть
определение x и плюс один было ровно таким,
чтобы вот это был ноль.
Все, нет? Не помните?
Мы ж ровно этого и добивались.
Нет, смотрите, еще раз, давайте
вспоминать, откуда мы брали форму?
Значит, вот
они прям от x и плюс один.
Нет,
не совсем так. Вот давайте
у нас есть...
Давайте
еще раз, внимательно, смотрите,
да, тут идея такая, получается
пум-пум-пум-пум-пум-пум.
То есть на самом деле
вот у меня жил
был x какой-нибудь ноль
и тут было f от x ноль.
Я
пытаюсь апроксимировать эту функцию
прямой, да?
Но тогда, если я вот возьму эту прямую,
обзову функцию, что g, которая вот
вот эта прямая, да?
Тогда мы понимаем, что g от x равна.
Она равна просто f от x ноль
плюс
x минус x ноль умножить
на какую-то
вот дель. То есть насколько она... Если я вот
по этой прямой сдвинусь на один, насколько
у меня функция изменится? Ну, в данном случае на
производную, потому что тут наклон такой, да?
Поэтому я здесь пишу
f' от той же самой x ноль.
И мы искали такой x, что эта
штука равна нулю. Видите, вот пересечение,
правда?
Ну, а фактически
в данном случае x плюс 1
искался так, что при фиксированном
x вот эта штука равна нулю.
Он так искался, обратите внимание.
Вот.
Но тогда, раз мы его
вот так искали,
то тогда получается, что
эта штука, внимание,
равна теперь 1 делить
на c1 на
вторую производную.
На какую-то вторую производную чего-то
на
x и плюс 1
минус x и в квадрате.
Но заметим, что так как мы подгоняли...
еще и хорошую выпуклость подгоняли себе,
да, то мы это можем...
Ну, во-первых, мы вторую производную
можем хорошо оценить,
хорошо оценить, да?
Да, помните, да, мы можем оценить,
как там...
Сейчас, погодите, мы...
Сейчас, а c1 мы откуда взяли?
Вот тут не c1 должен быть, везде
а b, потому что тут оценка...
Тут оценка первой производной,
да-да-да.
То есть тут b, b, b.
Ну, понятно,
локальность, ну вот.
А теперь нужна верхняя оценка на вторую
производную, то есть как бы...
Да, то есть получается c2 на b1
на x1 минус
x и в квадрате.
Но так как самое главное,
что мы подгоняли себе выпуклость таким образом,
что разность строго...
что разность строго уменьшилась, правда?
То есть как бы...
То есть как бы x
и плюс первая...
у нас оно заведомо
теперь, то есть как бы если у нас есть
и есть вот этот корень, x и
то x и плюс первая лежит
между ними.
Поэтому мы замечаем, что это просто
меньше либо равно, чем...
То есть я просто x и плюс 1,
он ближе к x и чем x и,
поэтому я просто заменяю его на r.
c2 на
b1 на
x и
минус x и в квадрате. Но это то же самое,
что и x и минус x и в квадрате.
То есть на самом деле,
то есть вообще какой
из этого всего вывод?
То есть этот вывод получается,
что у нас действительно сходимость,
то есть сходимость какая-то вот квадратичная
будет всегда,
будет для любой достаточно
хорошей функцией.
То есть если мы будем жить в какой-нибудь
окрестности, где функция
действительно там имеет
какую-то хорошую производную,
хорошую в смысле, там строго положительную,
желательно побольше
и при этом
имеют такую положительную
выпуклость, желательно поменьше,
то тогда
у нас
обеспечивается квадратичная сходимость.
На самом деле.
Дело в том, у нас просто
ключевой переход
произошел в том, что
в делимости,
во-первых, у нас просто получилась,
то есть у нас вот эта разность,
что она равна квадрату предыдущей,
она получилась тупо.
Просто сама просто легла.
Для корня, по-моему, мы там что-то где-то оценили,
но там какая-то формула тоже вынеслась,
поэтому легче оказалось.
Просто проблема в том, что там точной формулы
в кубической не получилось.
Вот мы просто в общем виде
взяли и оценили, на самом деле.
То есть воспользовавшись, правда, важным знанием,
что разложением там хороший ряд
до вот этой штуки.
Идея была бы очень простая.
Если бы мы раскладывали
до кубической штуки, тогда с этой
формулы не получилось бы, потому что мы добиваемся
и что мы это обнуляем.
Но, в принципе,
мы могли бы сказать себе, что
давайте вообразим
себе что-нибудь, и тогда
скажем, что у нас f от нот.
То есть тогда бы раскладывали до третьего
знака и сказали, что у меня тут какое-то
квадратное уравнение, давайте я просто x плюс 1,
это будет корень этого уравнения, допустим.
То есть добавим
такой корень, у нас будет так получаться,
и тогда мы просто будем гарантировать,
что если у нас будет адекватно находиться,
то есть тогда у нас
будем тогда,
после итерации у нас не два в степени знаков,
а три в степени знаков.
На самом деле,
да, да, да, так можно.
То есть отдельный вопрос, конечно,
насколько это точно и где будет, но в целом
абсолютно правильно.
То есть это все можно.
Сколько у нас там времени?
О, как раз то, что надо.
Нет.
Нет, да.
Нет, ну в принципе нет.
Нет, ну как сказать, нет.
Ну, как сказать, ладно, ничего принципиально нового
я как бы сейчас уже за 4 минуты не расскажу.
То есть нет, мы в следующий раз тоже продолжим
в фурье, потому что с ним еще там всякие
веселые вещи есть.
Нет, ну во-первых, там всякие мелочи там,
во-первых, надо просто там подумать,
как можно делать там всякую интерполяцию,
какие в принципе задачи на эту фурье можно решать,
например, еще. Точнее, на перемножение
фурьеров. Ну и, конечно, многомерное преобразование
фурье, куда же без него.
У нас получился опять НЛОК.
Ну, скажем так,
НЛОК,
учитывая в предположении,
что там всякие вот эти вот,
то есть вот эту красоту,
x-f от x поделить на f' от x, вы умеете
адекватно за НЛОК вычислять, конечно.
С нужной точностью.
Ну, то есть так,
делить мы уже научились.
Делить за НЛОК служит точностью,
мы уже умеем, как мы сегодня уже выяснили.
Вот, поэтому там f'
то есть, если вы будете делать, скажем,
кубический корень, то у вас там функция
будет x в кубе минус a.
Презводная у нее простая, вычисляется
адекватно, поэтому делить на нее можно.
Поэтому, да.
Мы же не просто делим,
мы удержаем и так далее.
Мы еще каждый раз обрубаем
какую-то точность.
И у числа a тоже обрубаем какую-то точность,
но ничего не доказываем.
Нет, ну, смотрите тут какая ситуация.
Мы делаем какие-то подгонки или нет?
Потому что в прошлый раз мы как-то не обошлись
без того, что мы делали подгонки.
Делаем. Нет, мы всегда делаем подгонки.
Мы делаем, просто еще доказывать про то,
что у нас тоже другая точность.
Смотри, от того, что ты что-то округлил,
то есть, ты сдвинул x куда-нибудь,
тогда как изменился f?
То есть, вот эта разность f.
То есть, ну, заметим, что
мы знаем, что разность любых x
это разность f от этих x.
Ладно, тут r.
Там поделить на какую-то
производную какой-то точке между ними.
Которая на этом отрезке
просто оценивается сверху и снизу.
Вот.
Поэтому там, соответственно,
если разность изменилась
на вот этот вот epsilon i,
который тебе надо,
то тогда у тебя разности f
измени...
В разности f их изменились, получается,
не более чем на этот же epsilon i,
только там, умноженный на какую-то константу.
Все. Ну вот.
А вывод в том, что...
Как делать алгоритм? Секунду еще раз.
Мы делаем предположение,
вычисляем x, где мы делаем x первое,
вычисляем x первое,
вычисляем x второе или подгоняем что-то?
Нет. Ну, в нашем случае
вычисляем и подгоняем.
А подгоняем мы тем, что делаем
с минус вот этот 10 в...
с минус. Причем невозможно ни один раз
на этот раз, потому что
на этот раз это у нас уже не...
Мы возбудим эту степень
и проверяем верно, что она больше или меньше, чем нужно.
Да, мы предполагаем.
Но если она у нас уже длинная,
то нужно еще обрубить какой-то знак,
чтобы обуздение степени не было слишком долгим.
Да. И при этом еще нужно оценить,
какой знак вы можете обрубать.
И чуть-чуть тоже подогнать,
чтобы было прям вот совсем хорошо.
Мы еще очень строго догадывали бы, чтобы в итоге
это не доказать. Почему?
По-моему, мы как раз все очень строго доказали.
Мы доказали какое утверждение,
но это не доказать строго алгоритма.
Сейчас. Что не так?
Нам все еще что-то закуда-то
когда-то обрубать,
что-то где-то проверять,
на том, что оно что-то когда-то где-то... Нет.
Нам просто гарантируется, что от того,
что мы, значит, изменили a и t
на a и плюс первое условно, да,
мы знаем, что требуемые х,
то есть вот тот, который хочется в этом варианте,
отличается от того, что мы уже нашли
не более чем на epsilon i,
как раз умноженную на константу.
Какую-то.
То есть эта константа берется вот уже
из первых и вторых производных.
Это мы абсолютно строго доказали.
Вот.
Тогда получается, то есть идея в том,
что за условно
эту константу умножить на...
За сколько вы там вычисляете f?
Вы это находите.
Все.
То есть это ты доходишь в функцию f и сравниваешь ее
больше или меньше на того, что надо.
Вот и все.
Можно это делать за эту константу
у вызовов, можно за логарифом констант
и адаптивным bin поиском там.
