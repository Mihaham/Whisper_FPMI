Прекрасно. Так, сегодня у нас тема услуга оптимальности и двойственность.
Давайте я запишу. Вот, и я думаю, что в следующий раз мы еще немножко
про двойственность поговорим перед тем, как переходить к тому, как слогеры сделаны.
Потому что в следующий раз будет, видимо, что-то про коническую двойственность.
Именно в следующий раз будет понятно, зачем они страдали какое-то время с конусами
и сопряженными к ним. И тогда уже немножко пазл будет почти полностью сложиться.
Совсем много сложится после того, как мы изучим то, как работает метод
безусловной оптимизации. Вот, собственно, через две-три недели, наверное, это произойдет.
И тогда будет понятно, в общем-то, вся картина в целом.
Детали будут проясняться постепенно, но это уже понятное дело такое.
На идейном уровне я, надеюсь, все расскажу.
Деталь и реализация частично не успеем, но все ссылки, если кому-то будет интересно,
можно будет поглубже в этом разобраться.
В принципе, много-много материала, который написан достаточно доступным образом.
Так, ну ладно. Может быть, какие-то вопросы есть по предыдущему материалу
перед тем, как начинать новый?
Вообще, поставьте там плюсики, если меня видно и слышно хорошо.
Ну, Суси, видно экран и слышно меня нормально.
Окей. Вижу, вроде, все в порядке со связью. Прекрасно.
Надеюсь, что сегодня никаких разрывов не будет.
Вот. Значит, есть ли какие-то вопросы по предыдущему материалу?
Вот у всех вопросов нет. Окей.
Давайте 10-20 секунд на то, чтобы что-то возможно спросить, если есть такая потребность.
Вот. Да, небольшой комментарий.
В прошлый раз, когда мы показывали, сейчас скажу, показывали утверждение
про дополнение по шуру, вот, то там вроде бы как будто бы
было показано только в одну сторону.
Но на самом деле все утверждения, которые там были сделаны, они работают в обе стороны.
Поэтому, наоборот, показывается прямым как бы прямым разбором,
что если там не выполнено, не выполнено то, что мы получили,
то мы получаем противоречие с условием.
Поэтому там как бы, единственный тонкий момент был немножко, наверное, про минимизацию.
Почему будет выпуклость после минимизации?
Но вроде бы мы его тоже как-то там объяснили через, соответственно,
выпуклость по совокупности аргументов и выпуклость по каждому из них.
Вот. Да, кстати, такой вопрос, может быть, странный.
Есть ли у аудитории понимание, чем выпуклость по совокупности аргументов
отличается от выпуклости по каждому из аргументов?
Поставьте плюс, если вы различаете это понятие, эти понятия и минус, если не очень различаете.
А, вижу, что люди это различают.
Ну, точнее, понятно, разница по определению, но кажется, правда же, что это равносильное подтверждение на самом деле.
А вот нет. Вот давайте сейчас.
Ровно поэтому я издаю этот вопрос.
Разница по определению? Не понятно.
Ну, вот смотрите, пример функции.
Вот x, y, тем она, наверное, хорошо известна.
Вот она по каждому из аргументов выпукла.
Это понятно, я надеюсь, тоже.
Потому что по каждому из аргументов она линейна.
Это видно? Вот.
Но в совокупности по двум аргументам она не выпукла.
Потому что гисиан у нее какой?
Он у нее, типа, вот такой.
Ну и, соответственно, он не положительно полуопределен.
Ну, это типичное седловое седло, наверное.
Я попробую это нарисовать, но у меня никогда это аккуратно не получалось так.
Это же 3D надо делать.
То есть, типа, вот так и вот, типа, вот так как-то.
Линии уровня будут располагаться.
Поэтому тут есть нюансы в том, что когда говорят, что есть выпуклость по всем аргументам,
и когда выпуклость только по каждому в отдельности, например.
Поэтому, пожалуйста, не путайте и внимательно следите за тем, какие условия у вас присутствуют в утверждениях.
Так, окей, ладно, вижу, что вопросов вроде бы таких нет, каких-то активных.
Давайте перейдем тогда к условиям оптимальности.
Ну и первое, будем идти, понятно, от простого к сложному.
И первое, что мы будем сейчас рассматривать, это простую безусловную задачу.
И случай, когда понятно теорему, что если у вас функция, точнее, наоборот.
Если x звездочка решение, то тут f дифференцируемо.
Так, давайте, не надо писать.
Пусть f дифференцируемо, x звездочка решение.
Тогда, ну понятно, градиент в этой точке ноль.
Я надеюсь, что этот факт, в общем-то, всем более-менее знаком.
Тем не менее, хочется его доказательства прописать чуть более подробно, чем сослаться на какой-нибудь классический результат.
Потому что из доказательств будет кое-что важное следовать.
Ну как доказываем.
Берем, опять же, некоторую точку и раскладываем в ряд Тейлора до первого члена, плюс.
А дальше идет соответственно остаточный член, ну не знаю, это типа функция, понятно.
При этом отношение r к норме разности равно 0 при x.
Кому стремиться?
Y стремится к x звездочкам.
То есть пока ничего вроде нового не произошло.
Все это, я надеюсь, так хорошо понимают и помнят.
Поэтому пока никакой магии.
Теперь пусть в x звездочке градиент не ноль.
Наш предположение.
И мы тогда рассмотрим такую вот точку, которая равна x звездочке.
Ой, сейчас, секунду, надо перестать торопиться.
x звездочки соответственно минус tau на градиент в этой точке.
Для некоторого положительного tau больше 0.
При подстановке этого выражения вместо y мы получим, что у нас f от y tau будет равен f от x звездочкой, плюс градиент в этой точке.
Извините, пожалуйста.
У нас, кажется, ошибка.
Давайте.
f' должно быть на y-x, наверное.
На y-x, да, вы правы.
Давайте правильно напишем.
Все отображается, я надеюсь, да?
Все работает.
Ну, соответственно, y-x тут получится минус tau f' от x со звездочкой,
что в каком-то смысле сейчас приведет нас к квадрату нормы, ровно то, что нам было нужно.
Плюс r от x со звездочкой, y от tau.
Вот, равно.
f от x со звездочкой, минус tau на норму, понятно, градиента.
Плюс, опять же, это r.
Я не буду писать себе документы, не упрощение.
Поскольку у нас есть вот это выражение, значимого звездочкой,
мы можем сказать, что найдется какой-то tau.
Точнее, так, найдется tau с чертой.
Такое, что для всех tau, от нуля до этого tau с чертой,
будет выполнено, что отношение между x со звездочкой y от tau,
давайте я напишу,
делить на x со звездочкой минус y от tau,
будет меньше либо равно, чем некоторые константы,
будет равна норме градиента в этой точке.
Придел 0, поэтому сама функция сверху там ограничена.
Соответственно, если мы теперь...
Ой, тут без квадрата, простите.
Теперь, если мы вот это вот распишем,
то есть это ровно то, что у нас было до того,
и это tau на норму, опять же, градиента.
Поэтому вот эта вот остаточная члена,
он будет меньше либо равен, чем tau пополам
на квадрат градиента.
Вот.
Ну и теперь, если мы все это дело подставим,
вот сюда, точнее, даже не сюда, а вот сюда,
то мы увидим, что у нас f от y от tau
минус f от x со звездочкой
будет меньше либо ранее, чем минус tau пополам
на, соответственно, норму градиента в точке x со звездочкой.
А эти меньше нуля.
То есть мы получили, что x со звездочкой перестал быть не минимум.
Ну, не точка минимума, хорошо.
Получили противоречие.
Понятны ли выкладки и основной результат?
И то, как мы к нему пришли.
Оставьте плюс, если понятно, и минус, если нет.
Хорошо, вроде всем понятно.
Ну и, собственно, зачем все это было проделано
в более отдаленной перспективе?
Для того, чтобы показать, что если у нас есть градиент,
то мы можем, пройдясь по этому sap anti-градиенту,
вот здесь вот получить значение функции,
которая будет меньше того, что у нас есть сейчас.
Это мы будем активно использовать через 2-3 недели опять же.
Так, ну ладно, это было что-то простое.
Далее, следующий, понятное дело, результат,
который напрямую не следует,
но связан с тем, что был только что.
Вот, утверждение такое,
что если у нас задача в исходной,
которую мы вот рассматриваем,
вот как-нибудь ее надо обозначить,
звездочка уже была,
если f выпукла и дифференцируема,
то x со звездочкой решения
уже будет равносильно тому,
что градиент в этой точке равен 0.
Ну, то есть теперь в другую сторону просто получилось.
То есть понятно, что с одной стороны,
если он глобальный, то он локальный,
то, как бы, в одну сторону очевидно,
смотрим предыдущий факт,
то есть если x со звездочкой решения,
cme выше.
Вот, то есть у нас есть,
со звездочкой решения,
cme выше.
Теперь наоборот.
А наоборот мы говорим,
что пусть у нас есть точка,
в которой градиент 0,
и функция выпуклая,
тогда у нас есть критерия первого порядка.
Вот, я вот так напишу.
А, это не то, простите.
По критерию первого порядка у нас выполнено,
что f от y больше либо равно,
чем f от x,
плюс градиент в точке x на y минус x.
Вот, ну теперь если мы вместо x подставим x со звездочкой,
давайте я к другим цветам.
Вот, то вот так замылиться,
и мы увидим, что у нас,
так это для любого y из Rm,
что f от y больше либо равно,
чем f от x со звездочкой,
то определение минимума.
Получили собственный критерий.
Понятно ли, что произошло,
и почему так быстро и легко все нам удалось.
Ставьте плюс, если все понятно,
и минус, если что-то могу пояснить.
Окей.
То есть, по сути дела,
если у вас есть биоусловная задача,
то ее решение сводится к тому,
что надо, ну и функция дифференцируема,
то ее решение сводится к тому,
что надо решить нелинейные уравнения,
f от x со звездочкой равно нелинейные уравнения.
Вот, как только вы его решили с некоторой точностью,
то эта соответствующая точность
будет соответствовать вам
точности вашего решения по норме градиента.
Ну и соответственно,
для биоусловных задач,
с дифференцируемыми функциями,
то норма градиента
будет являться
стоверным критерием остановки,
то есть пониманием того, насколько
вы близки к решению.
То есть, если у вас текущая точка
дает норму градиента 10 минус 5,
то, наверное, вы почти уже в решении,
и все в порядке, можно остановиться.
Вот зачем это надо.
То есть, помимо теоретической ценности,
все это имеет еще и достаточно
важную и широко используемую
практическую важность, практическую ценность
по плане разработки
и анализа
именно
численных методов. Так, ну ладно, это все
было биоусловные задачи, давайте к слову перейдем.
То есть, сейчас мы
поначалу будем смотреть довольно широко,
то есть задачи с ограничениями.
Так, а есть ли
понимание, что делать, когда функция
негладкая, но задача безусловная?
Да, нет. Минутку подумайте, пока я пишу.
Сейчас негладкая, но выпуклая?
Да-да-да, негладкая, выпуклая
безусловная. Три условия.
Ну, смотреть просто на значения в окрестности,
или имеется не алгоритмические, а математические?
Ну, условия в чумальности,
что нам может тут помочь?
То есть, градиент, понятное дело,
уже посчитать же нельзя.
Ну, у нас понятие сульдиференциала на семинаре было,
кажется, у нас всегда выпукло.
А если без этого
попытаться что-то сделать?
Без привлечения сложных конструкций
подручными методами, я бы сказал.
Ну что, есть какие-нибудь идеи?
Кажется, идеи особо нет.
Ну, смотрите, мы же это уже несколько раз обсуждали,
что если у вас есть вот такая вот задача,
то вы ее можете переписать просто в форме над графикой,
и рассмотреть уже вот такую вот задачу,
по которой мы сейчас будем
собственно говорить, что делать с ограничениями.
Поэтому ничего страшного,
что у вас есть негладкая функция, вот здесь нет,
вы можете благополучно ее переписать
как задачу уже с гладкой цельевой функцией,
но плюс ограничения.
И что вот с этим делать, мы поймем там
в течение сегодняшнего занятия
и следовательно закончим.
Поэтому я не трачу время
на подробное обсуждение всяких там субдиференциалов
и прочих объектов,
потому что, в принципе, если вы разберетесь
с тем, как строить свои оптимальности
для таких вот задач в случае негладких функций,
мы про это все частно говорим более подробно,
то как бы все это
не особо вам будет нужно в принципе.
Вот, ладно, давайте перевернемся
к... так, понятно ли
трюк и то,
как к чему что сводится?
4 человека вроде
написали, что понятно.
Ну, ладно, давайте обсудим теперь,
что делать с ограничениями. Для этого сначала
придется немножко
освоить инструментарий
двойственности, чтобы потом с его
помощью благополучно получить то, что нам нужно.
Значит, да, ведем обозначение,
что f от x со звездочкой будет равно
p со звездочкой. Почему буква p
ясно чуть позже. Вот, значит,
определение. Функция лагранжа
L, x от лямбда μ
строится как f от x
плюс сумма
лямбда i t g i t от x
плюс сумма
μ g t h g t от x.
Вот, соответственно,
лямбда множество лагранжа
для равенства, μ для
неравенства. Ну, записать
это мы записали, теперь с этим делать не понятно.
Что бы стало понятно, надо
построить вот такую вот функцию
g от лямбда м,
которая будет
являться инфимумом по x для
нашего лагранжана. Давайте я тут не поленюсь.
А, ну немножко поленюсь, конечно.
Вот, ну
делаем сейчас вот так.
Вот так. Можно стереть.
Короче, вот такой вот инфимум
от нашего лагранжана. Эта штука
называется двойственная функция.
Так, ну ожидание, что у многих
это уже было на семинарах, поэтому давайте
обсудим, какие у нее свойства. Какая она?
То есть смотрите, мы берем
инфимум по x, то есть
где у нас x? Здесь, здесь,
здесь и здесь. А остается
функция, которая зависит, соответственно,
от лямбда,
мю, подчеркиваю, где
какие переменные у нас в итоге
нарисовались. Так, ну что про нее
можете сказать? У нас на семинаре было
не очень понятно. Кажется,
если я не путаю с другой
двойственностью какой-то,
может, она выпуклая. Это не правда.
Это не правда. Значит, я путаю с
опряженной, наверное. Возможно.
Так, ну у кого-нибудь это было
или вы первый раз это видите? Кто видит первый раз,
поставьте плюсик. Кто-то видит первый раз.
Окей. То есть только один
человек видит первый раз, а все остальные
одиннадцать. Уже все
это видели, но почему-то хранит
молчание. Загадочное это все.
Видели. Ну так а что? Какие у нее
свойства? Кто-то еще хочет.
Прекрасно. Тишина. Понятно.
Давайте тогда вместе рассуждать.
Что мы знаем про эту функцию?
Мы знаем, что...
Ну да, давайте так. Наверняка каким-то
образом что-то связано с выпуклостью-вогнутостью
здесь будет присутствовать. Давайте
вспомним, что мы знаем про то, какие у нас
операции сохранят выпуклость. Давайте.
Кто какие помнит, пишите в чат. Выберем сейчас
наиболее подходящую. Максимум.
Классно. Как из инфимума сделать
супремумы тогда?
Сколько знаков и каких местах?
Знак...
Вокруг всего выражения и под
аргументом. Да, это правда.
То есть мы можем написать, что
у нас g от лямбда μ
это минус
супремум от минус f от
x минус сумма
лямбда i t g i t от
x минус сумма
μ g t h g t
от x. Отлично.
Супремум по xум. Что теперь можно сказать
относительно этого супремума?
То есть для каждого фиксированного
функции, которая стоит под супремумом,
какая? Каким свойством она обладает?
Она афинная.
Афинная тире линейная. Понятно.
Раз она линейная, значит она выпукла.
И взятие
супремума от бесконечного
числа выпуклых функций, все еще
дает на выпуклую функцию.
Оставьте плюсы, если вы осознали это
рассуждение. Так.
Вижу. Окей. Здорово.
Да, к сожалению, у меня не
поместилось. То, что обведено
в рамочку, это вот выпуклая штука.
Но поскольку у нас здесь стоит минус
перед супремумом, почему я
специально спросил про то, сколько минусов,
то в результате мы получим, что эта штука является
вогнутой. Так, понятие не вывод.
Хорошо. При этом заметьте, что
вогнутая функция, я в этом
добавлю, что она всегда вогнутая.
То есть какие бы функции f, g,
h не были у вас
в исходной задаче, вот здесь,
у вас результат
построения двойственной
функции таким способом всегда будет приводить
к вогнутому результату.
Ну, то есть
я надеюсь, понятно, что это довольно
мощный инструмент, потому что у вас
какая бы задача ни была,
построение двойственной функции автоматически приводит
к вогнутому объекту,
что приятно. Ну и, соответственно,
утверждение, которое нам сейчас
поможет, значит, если у нас
множитель Lagrange, который
соответствует неравенствам, больше
нуля, то
со звездочкой будет больше либо равно,
чем g от λ. То есть
двойственная функция доставляет
оценку снизу на оптимальное
решение исходной задачи, при условии,
что mu больше либо равно 0. Понятно ли утверждение?
Так, хорошо. Как доказывать будем?
Оказывается довольно просто, как обычно.
Вот. Можем
написать следующую точку неравенств.
Для произвольного х из допустимого множества,
значит f от х будет
больше либо равен, чем Lagrange
от х, давайте как-то его выделим,
для lambda и mu. Почему это так?
Потому что раз х лежит
в допустимом множестве, то это значит,
что вот это выражение, этот блок
слагаемых он же нулится,
а в этом блоке слагаемых у нас вот это
h меньше либо равно 0, а mu
у нас больше либо равно 0.
Это мы из f что-то вычитаем.
Поэтому такой неравенств.
Так, поставьте плюс, если понятно,
почему справедливый знак
в кружочке.
Ну, это Lagrange
в какой-то точке, значит он больше либо
равен, чем инфиум по всем хам.
А это по определению наша двойственная функция.
Поэтому теперь, если мы обе части
возьмем и променемизируем по х,
то мы получим, что p со звездочкой больше
либо равно, чем g от lambda и mu.
Ну, в общем, получили нашу оценку.
Раз это оценка снизу, то, я надеюсь,
у многих из вас возникает
естественное желание эту оценку
промоксимизировать, чтобы получить
значение как можно ближе к
оптимальному значению
цельевой функции исходной задачи.
Получаем двойственную задачу. Мы максимизируем
g от lambda mu
при условии, что
mu больше либо равно 0.
Эта задача всегда выпукла, независимо
от того, какой была исходная
задача. И она,
точнее ее решение, дает нам
оценку снизу, которая может,
кстати говоря, достигаться, о чем мы поговорим
чуть позже, для решения
исходной задачи. Соответственно,
поскольку это двойственная задача,
то оптимальное значение обозначает d со звездочкой.
Ну и, соответственно, p со звездочкой
там было, потому что это прямая задача,
то есть primal, поэтому p.
Значит, понятно ли
то, как мы все это получили, и самое главное
зачем? Ставьте плюс, если понятно,
минус, если не очень понятно.
Так, окей.
Теперь давайте посмотрим, какие
соотношения могут выполняться между d со звездочкой
и p со звездочкой. Первое, что
выполнено всегда, называется слабая двойственность.
Это когда d со звездочкой
меньше либо равно p со звездочкой.
То есть это выполнено всегда
дает некоторые нетривиальные оценки
на сложные задачи, типа дискретных,
каких-то бинарных,
потому что вы можете для бинарной
и дискретной задачи поставить
получить двойственную, решить ее
каким-нибудь полинамиальным методом
для выпуклых задач соответствующих,
после чего использовать найденное
решение как оценка снизу
на значение в прямой задаче.
Ну и второй способ, это
второе свойство, это называется сильная двойственность,
ради которой во многом все это
и делается. Это ситуация,
когда выполнена точная равность.
То есть когда оценка снизу достигается.
Понятно, что, я надеюсь,
что в общем случае для произвольной сдачи
эта штука не выполняется. Потому что
у нас только оценка снизу,
никаких дополнительных гарантий
на ее достижимость нет. Значит,
если задача выпукла, то
почти всегда
выполнена для выпуклых задач.
Почему почти всегда
и почему не просто всегда?
Будет понятно ближе,
наверное, к концу, когда мы будем
говорить про полуопределенную оптимизацию
и обсудим там...
Ну в общем, увидите.
Какая-то теория про то,
почему это важно, почему почти всегда,
я расскажу уже сегодня,
а пример, наверное, будет
уже чуть позже.
То есть, задача выпукла,
вы строите для нее двойственную,
у вас получается, что оптимальное значение
в прямой строго больше,
чем оптимальное значение в двойственной.
Вот такое тоже возможно.
Да. Далее.
Важный факт, что может выполняться
и для не выпуклых задач.
И каждый такой результат
требует отдельного доказательства
типа статей
полноценной.
Потому что это все
требует по сути объяснений
и формальных доказательств
снизу-сверху, почему
решение задачи двойственной
для не выпуклой исходной
будет давать то же самое решение.
Это довольно непростая история.
Что важно?
Важный объект, который
будет о многом говорить,
называется взор двойственности.
Это такая штука, которая
дает нам разность
между целевой прямой функцией
прямой задачи и двойственностью.
То есть, чему это важно
и почему мы можем это использовать.
Вот смотрите, что мы знаем.
Мы знаем, что p со звездочкой
уже больше либо равно, чем g от λi.
Давайте умножим
на минус единицу
и прибавим f от x.
У нас получится f от x
минус p со звездочкой,
меньше либо равняется, чем f от x
минус g от λi.
То есть, смотрите, слева у нас
стоит то, что мы не знаем,
потому что мы p со звездочкой не знаем.
Поэтому, если у вас
оптимальный зазор двойственности
меньше либо равняется,
это значит, что ваш x
дает такое значение функции,
что оно близко к f со звездочкой
на эту епсилу.
Понятно ли, что это значит?
Дурацкий вопрос, неправильно спрашиваю.
Понятно ли, что происходило до этого момента?
Что это значит, я сейчас по детали
расскажу.
Поставьте плюс, если все нормально,
и минус, если надо куда-то вернуться.
Ради минусов не вижу.
Надеюсь, что всем более-менее понятно.
Если что-то непонятно, рекомендую
активно об этом сообщать.
Зачем это надо?
Это надо за тем, чтобы у вас был некоторый
сертификат, я думаю, что если у вас был
курс способностей вычисления, то вы уже
это слово слышали, который
бы вам сообщал о том,
решили задачу или нет.
При этом, то, что происходит внутри
вашего метода, который вам будет
генерировать последовательности
лямбда, каты, мюкаты,
которые будут куда-то сходиться, как со звездочкой
лямбда, со звездочкой мюкат, со звездочкой.
Что происходит в этой стрелочке?
Каким-то там метод?
Вообще неважно. Если вы хотите
убедить сообщество
или ваших покупателей
условно говоря, что
ваш продукт, который решает
какой-то задачу оптимизации работает,
то вам совершенно не обязательно сообщать
детали реализации для того, чтобы обосновать
его работоспособность. Достаточно просто
провести статистику и логи
по зазору двойственности, который
генерируется в процессе
итерации вашего метода.
Как только вы это показали, и вы показали, что он стремится
к нулю, может быть, не монотонно, но
есть транс некоторые, то, значит, все хорошо.
То, что вы хотите
показать, продать, опубликовать
действительно работает. Ну и понятно, что
с точки зрения практики, с точки зрения теории
вам нужно
вы можете использовать
эту штуку как довольно достоверный
критерий того, что
ваш метод работает. То есть, если вы хотите
какую-то теорию навести на
формулы, которые у вас вычисляются,
то можно это использовать как раз-таки
для того, чтобы
показать, что вот зазор
двойственности, грубо говоря, на каждой итерации
уменьшается на столько-то раз или еще что-то.
Понятно ли про применимости?
Ну и, соответственно,
довольно простой вопрос,
давайте, если понятно
или непонятно, что
если нашелся x,
утверждение, наверное, какое-то
не очень сложное утверждение,
если x чертой
такой, что существуют какие-то
λ с чертой, μ с чертой
допустимые, то есть это значит,
что в кубочках μ с чертой больше 0,
такие, что f от
x чертой равняется g от
λ с чертой, μ с чертой,
то x чертой решение.
Нужно ли это утверждение
как-то доказывать и объяснять
или из всего того, что было выше сказано,
это более-менее очевидно.
Поставьте минус, если не очевидно,
и нужно доказать,
какие дополнительные выкупки проделать.
Минусов не вижу, наверное,
понятно, что это значит,
что эта штуковина, сильная двойственность
будет нам некоторым
характерием того, что мы нашли решение.
Ради этого все и затевается.
Теперь, наверное, свой результат,
который я не буду доказывать
сейчас, но я
оформлю доказательство в PDF
и пришлю просто текст.
Если бы я сейчас это, наверное,
начал доказывать, то мы бы на этом доказательстве
закончили занятие,
потому что оно не очень короткое.
Хочется побольше рассказать.
Теорема такая, наверное.
Утверждение такое,
что сильная двойственность
для выпуклой задачи...
Давайте я еще раз напишу,
чтобы было понятно,
какого типа задачи идет речь.
Мы говорили в общем виде.
У нас не было никаких ограничений
на h, i, t, h, i, t и g, i, t.
Пока что было абсолютно
произвольно для чего хотите.
Сейчас мы ограничиваем себя
только выпуклыми задачами.
И, соответственно, при условии,
что у нас ax равно b
и h, i, t от x меньше либо равно 0,
f и h, i выпуклой функции.
Сильная двойственность для выпуклой задачи
выполняется,
если выполнены условия
слейтера.
Это ровно то,
что отсутствие чего
приводит к тому,
что не выполняет сильную двойственность
для выпуклых задач.
Словие слейтера
это определение, наверное.
Не люблю такие формулировки,
но здесь по-другому как-то сложно сказать.
Говорят, что выполнено условие слейтера,
если нашелся какой-то x чертой,
в котором h, g, t от x
строго меньше 0 для всех g
и ax чертой равно b.
Давайте я пытаюсь вот так показать.
Надеюсь, видно.
Идея в чем?
Идея в том, что для любого множества,
допустив множество
для выпуклой задачи,
справедливо сильная двойственность.
И характеристика множества
определяется условием слейтера.
Кто понимает, что геометрически
это условие означает?
Можно вопрос?
Мы сформулировали задачу
без условий равенства.
Почему вот?
Видел?
Я его закрасывал.
Какой ужасный почерк.
Давайте я это перепишу.
Вот так.
Я надеюсь, попроще воспринимать.
Что геометрически это означает?
Кто может как-то перевести
с языка того, что у нас
функция строго меньше 0?
Какое-то равенство
выполнено на язык того,
что у нас есть множество,
свойства.
Есть точка не на границе?
Да.
Правильно.
По-другому это еще
формулирует часто,
что в множестве есть точка,
которая входит в множество
с некоторой окрестностью.
То есть то, что меньше 0,
значит, есть небольшой акцел,
который может доходить.
Понятно, что такое же не всегда
выполнено.
Надеюсь, что в конце мы успеем
посмотреть на задачу,
которой это выполнено не будет.
И поймем, к чему это приводит
в терминах и на условиях оптимальности.
Это, наверное, основной результат.
Сейчас мы будем его активно использовать.
Доказательства не самое простое.
Более того, существует несколько способов
доказательства этого результата.
Я выложу геометрически
на основе теоремы
о разделяющих гиперплоскостях.
Есть еще доказательства
через теоремы о неявной функции.
Поэтому если вы будете искать
каких-то источников дополнительных,
то не удивляйтесь, если увидите
какие-то другие подходы.
Теперь важный момент.
Называется...
Сейчас распишем некоторые цепочки равенства.
То есть пусть у нас теперь есть
сильная двойственность.
Х со звездочкой.
Соответственно, решение прямой задачи.
Я буду рисовать большую букву в КП.
А лямбда со звездочкой
и мю со звездочкой.
Соответственно, решение двойственное.
Что-то P и D довольно похожи.
Ладно, сейчас мы это исправим.
Можно сразу это обозначить.
Вот это будет D.
А это будет, видимо...
Сейчас я пойму, насколько это важно,
чтобы все было выпукло.
Нет, это неважно.
Так, сейчас...
Неважно, поэтому можно
пусть поставить вот сюда.
Парам-пам-пам.
Раз выполнена сильная двойственность,
то у нас есть вот такое вот равенство.
Что это такое? Это же у нас инфимум.
А раз это инфимум по X,
то это меньше либо равно,
чем значение Lagrangian
с точки X со звездочкой.
То есть F от X со звездочкой плюс...
Но X со звездочкой это решение.
Раз это решение, то это значит,
что эта штука зануляется.
И пока что остается только
F от X
с звездочкой плюс
сумма miujith
jt от X
со звездочкой.
Но смотрите, у нас же...
У нас же вот эта штука больше либо равна нуля,
а эта штука опять же меньше либо равна нуля.
Поэтому эта штука меньше либо равна,
чем F от X со звездочкой.
Поставьте плюс, если понятно,
в выкладке, который нас привели к такому результату.
Не λ уходит так.
Давайте, да, я понял. Спасибо.
Уходит не λ, уходит все выражения вместе
вот так.
В ноль, потому что... Давайте я тут уточню.
Потому что jt от X
со звездочкой равно нулю.
Потому что допустимое
решение, поэтому удовлетворяет всем равенству.
Всем условиям функциональным, которые
у нас выведены в задачах.
То, проблемы со связью,
у меня вроде ничего не пропало.
Ладно, я надеюсь, что вопрос
со связью вроде бы решили.
Так, Лидия, понятно ли теперь,
почему занудилась слагаемая?
Прекрасно. Есть ли
еще какие-то вопросы?
Все ли понятно в этой выкладке?
Сейчас будем с ней работать дальше.
Ну окей, минусов вопросов пока не вижу.
Тогда давайте дальше.
То есть, что мы на самом деле получили?
Мы получили, что у нас...
Мы начали
с F от X со звездочкой.
И мы закончили F от X со звездочкой.
То есть, на самом деле, все знаки неравенства,
которые у нас были,
они будут нам сейчас образовывать равенство.
То есть, вот здесь
должно быть равенство.
И где еще?
А, и все, да?
И вот здесь тоже равенство.
Значит, ничего не работает.
Давайте теперь поймем, что значит каждое этих равенств.
То есть, оранжевое. Из него что следует?
Из него следует, что X со звездочкой
это точка минимума Лагранжуана.
Так, понятно ли почему так?
Ну, то есть, у нас инфимум равен значению
функции под инфимум в соответствующей точке.
Поэтому это точка минимум.
То есть, тут я надеюсь...
Пожалуйста, мы разрешаем
μ быть равным нулю или они строго больше 0 у нас?
μ, может быть,
больше либо равно нулю, нуля.
То есть, ну, просто у нас последнее равенство свидетельствует.
То есть, то, что возле неравенства оказывается равенством,
свидетельствует о том, что у нас
μ равный нулю или hbt равный нулю.
Давайте мы будем последовательно идти.
Мы сейчас разбираемся с оранжевым равенством.
Зеленого, и все будет станет понятно.
Окей? Вот.
Так, прооранжевое, то есть,
x точка минимума Лагранжуана. Понятно почему?
Окей, вижу плюсик.
Супер. Ну вот, теперь, собственно, переходим
к этому второму равенству.
Второй раз это действительно обозначает
ровно то, что, почти то, что вы сказали,
что раз тут равенство, это значит, что
сумма неотрицательных
слагаемых ноль,
это значит, что каждая слагаемая ноль.
Значит, выполнено что вот так.
Эта штука называется условие дополнительной нежесткости.
Английский комплимент
reflectness, если вдруг будете смотреть
литературу. Не пугайте, это ровно оно.
Вот. То есть, кто из этого
следует-то? Из этого следует, что
если, если
μ, житое, больше нуля, то
мы находимся на границе. А если
мы находимся, а если мы находимся
внутри нашего множества, то
множество Лагранжа, соответствующий, равен нулю.
Вот такая интерпретация у этих
условий. Ну, собственно, теперь мы
у нас все готовы для того, чтобы сформулировать
условия хорошего конутакера.
Пока что необходимы. Так, есть ли
вопросы по выводу?
Как бы сделать, чтобы видно было
и побольше лист поместился?
Не знаю, ну вот так, наверное, да?
Вот все, вот видно. Так, есть ли вопросы
по текущей части? То есть, мы как бы проделали
некоторую подготовительную работу,
а сейчас будем итоги
подводить некоторые предварительные.
И формулировать
финальные
результаты, которые будем в дальнейшем
использовать. Да, кажется, сегодня
получится закончить лекцию ровно
в том объеме, в котором я ее
запланировал. Бывает нечасто. Окей.
Минусов я не вижу, вопросов тоже пока вроде нет.
Поэтому давайте начнем
формулировать. Это все дело.
Так, давайте надо один раз это написать
полностью, чтобы потом
только аббревиатуру.
Сокращенно понятно ККТ.
Значит, пусть у
нас есть решение
прямой и двойственной задачи, соответственно.
и
и выполнена сильная
двойственность. То есть смотрите, вот эта
штука. Это важно.
Вот это место.
Потому что у вас ясно, что
вы можете решить прямую задачу,
вы можете решить двойственную задачу, у вас получат некоторые
значения, некоторые аргументы, на которые
достигается минимум и максимум. Но сильное двойственность,
может, не выполняться. Поэтому,
здесь важное дополнение.
первое. первое и второе это просто то, что у нас допустимость у решений присутствует.
пока что тут все пишется для произвольного, произвольной, потенциально не выпуклой задачи.
треть, соответственно, мю со звездочкой больше либо равно нуля.
и четвертое, четвертое дополнительное еще не жесткость. мы только что выяснили это важно.
и пятое, собственно, поскольку у нас, вот здесь было понятно, что х со звездочкой точка минимума
лагранжана. раз точка минимума лагранжана, то в этой точке градиент
лагранжана по х равен нулю. то есть вот мы по сути дела собрали вместе все то,
что у нас получилось выше. пять условий. понятно, что все это делается пока что
в предположении дифференцируемости. тут fgh дифференцируемый отметим.
ну и теперь давайте поймем, что это все превращается, если мы дополнительно выпуклые потребуем.
понятно ли что за условия, куда взялись, как формулируются или есть какие-то еще вопросы.
давайте на это все посмотреть. минуса вроде не вижу пока. давайте продолжим.
движение первое. что если есть выпуклая задача, и для тройки чисел выполнена
ккт. тогда первое. у нас есть сильная двойственность. и соответственно это
тройка, решение f и вот. то есть грубо говоря, если вы сказали выпуклость и у вас выполнено
условие ккт для некоторых трех точек, то в принципе все хорошо. ну давайте посмотрим
доказательства. вот поскольку из первых двух условий следует, что x чертой лежит допустим множестве.
вот поскольку у нас mu больше либо равно нуля из чертой, из этого следует, будет сейчас хитрый ход,
что лагерныжан от x лямбда с чертой и mu с чертой будет выпуклым по x. понятно ли почему так?
давайте еще раз посмотрим на то, как выглядит лагерныжан. давно это было? ну вот здесь например.
то есть смотрите f выпукло, g и t афин, ну линейные, поэтому коэффициент перед ними неважно какой,
аж g и t выпуклы, и мы их взвешиваем с положительными коэффициентами, поэтому суммарно мы получаем
сумму трех выпуклых функций, которые будет выпуклой функцией. понятно ли такое объяснение? так вижу,
что двум студентам понятно. ну хорошо. то есть раз это выпуклая функция и да, раз это выпуклая
функция, то есть последнего условия из того, что l' по x в точке равно 0, там же 0 я написал, да написал,
следует, что x чертой точка минимума лагерныжана. но это значит, что наша двойственная функция в
этих точках равна лагерныжану, который в свою очередь равен, опять мы как бы разворачиваем
всю эту штуку. так, l' и t с чертой на a и t транспонированная, x с чертой плюс b и t,
это линейные наши ограничения равенства, плюс плюс сумма, mu gt с чертой на h gt от x с чертой. ну смотрим,
вот это опять зануляется, а это равняется f от x с чертой, потому что дополняющая нежесткость. то
есть вот эта штука 0. давайте я короче вот так работай. поэтому собственно сильная двойственность
выполнена. ну а раз есть сильная двойственность, то соответственно те аргументы, на которых она
достигается, являются соответственно решением прямой двойственности сдачи. понятен ли вывод?
окей. теперь как бы второе утверждение, сейчас вот нужно какое-то усилие приложить, чтобы понять,
в чем разница. значит смотрите, второе утверждение начинается таким образом. пусть выполнено
условие слейтера. то есть напоминаю, у нас внутри множество, то есть в множестве есть точка,
которая входит в него с некоторой окрестностью. тогда x со звездочкой, решение p, то есть прямой
задача, равносильно, внимание в обе стороны знак, существованию соответственно лямда с чертой,
таких что для x со звездочкой, лямда с чертой, мюс с чертой выполнены ккт. то есть смотрите,
ключевой момент здесь это вот-вот это и вот это. то есть до этого мы говорили, что у нас есть уже
какие-то три вектора, на которых ккт выполняется. и тогда типа все хорошо. здесь же мы в каком-то
смысле более сильное утверждение показываем, потому что условие слейтера нам гарантирует
существование двойственных перемен. нужно ли здесь что-то пояснить? догадательство не сложное,
но сама суть и разница между этими двумя пунктами, которые мы сейчас обсуждаем,
нужно ли что-то еще сказать? или в целом понятно разница? разница, безусловно, вот здесь.
то есть не вижу вопросов, я не знаю, это хорошо или плохо, может быть совсем ничего не понятно.
если что-то непонятно, сомневаетесь, поставьте лучший минус, я поясню подробнее. если понятно,
поставьте плюс и мы смело пойдем дальше. два человека вроде разобрались или просто
хотят пойти поскорее дальше, не знаю. что-то такого вала пониманий и плюсов, которые было раньше,
не наблюдается, то несколько тревожно, конечно. так, ну потихоньку вроде понимание приходит.
так, ну смотрите, давайте пока тогда сейчас продолжим, а в следующий раз может быть у вас
будут какие-то вопросы и уточнения, и мы еще раз к этому вернемся, потому что все равно продолжим
пол лекции, наверное, еще говорить. смотрите, ну во-первых, понятно, что достаточность
исследуется с предыдущего пункта. если задача выпукла, есть три вектора, для которых ККТ выполняется,
то х, соответственно, решение. есть у нас такие точки, для них выполнена ККТ, поэтому это,
я так понимаю, вот в эту сторону. теперь в другую сторону. так как есть выпуклость плюс условия
слейтера, то у нас есть сильная двойственность, и Пес Ладвилович достигает. это дополнительное
пояснение. то есть отсюда следует существование. и то, что для того, что мы существование чего мы
подтвердили, у нас будет выполняться ККТ, следует просто из тех предыдущих выкладок, которые,
короче, то что у нас здесь было. то есть общие выкладки это для случая, когда у нас не предполагалось
наличие выпуклости в задачах. здесь вот этого не было еще, когда мы двойственность получали. когда
мы дополнительную жесткость получали, вот здесь вот здесь нигде не использовался то, что у нас есть
что-то выпукуя. и вот здесь тоже это никак не используется, только требуется выполнение
выполняя сильные двойства. то есть если у вас сильная двойственность для него упуклась,
то все это тоже будет работать. понятно ли как мы это обосновали? довольно
прямолинейно и не замысловато. поставьте плюс если понятно и минус если не очень.
окей так ну и да слушайте прям отлично ровно финальный. финальный пример почему
помимо выпуклась нужно у совестаторов ккт. ну вот смотрите рассмотрим такую задачу. очень простую,
но тем не менее достаточно пример. поскольку мы только начали эту тему, то пример сейчас будет
простой. если мы немножко в ней разберемся и как-то привыкнем, то примеры пойдут посложнее и
собственно в следующий раз занятие будет посвящено тому, чтобы рассмотреть примеры выпуклых,
примеры задач и двойственные к ним те которые мы уже упоминали прошлый раз. когда типа
оптимизации рассматривали там линейно программирование квадратично полуопределенный и прочего. для них
будем получать двойственные задачи и смотреть какие основные свойства у них будут. но смотрите
вот такая вот задача она выпукло. я надеюсь это видит. потому что леофункция линейная, ограничения
квадратичные и там все положительно полуопределено. вот теперь если мы вот для выпуклых задачи
попробуем ккт найти векторка на котором все это будет достигаться. так ну давайте x λ1
лямдо 2 это что такое x1 плюс лямдо 1 на x1 квадрат минус x2. обращаю ваше внимание что важно чтобы
все знаки были меньше либо равно нуля. потому что мы выводили все именно для таких постановок
плюс лямдо 2 x2 плюс x1 в квадрате. вот это начистое ограничение. берем градиент по x. получаем довольно
простую конструкцию. некоторые технически понятные клубки. то есть он должен быть нулем первое. второе
лямдо 1 2 больше либо равно нуля. лямдо 1 на соответствующую функцию равно нулю. ну и лямдо 2
аналогично тоже равно нуля. ну да и понятно что допустимость никто не отменял. так что у нас тут
минус x2 меньше либо равно нуля и x2 плюс x1 в квадрате меньше нуля. вот записали все условия
ккт. условия равенства как видите нет. окей. ну давайте теперь перебирать. первый случай. что будет
если лямдо 1? неправильно. что? или правильно? да. лямдо 1 больше нуля и лямдо 2 больше нуля. короче
в этом случае выполнено что x1 в квадрате равно x2 и x1 в квадрате плюс x2 равно нулю. у этой системы
только одно решение 0 0. подставляем это решение в... куда? в лгрынжа. то есть должно быть выполнено
что давайте это я обозначу там x чертой. что x чертой лямдо 1 лямдо 2 равно 0. а оно на самом деле равно
1 1 и что-то там. то есть уже нулю не равно. видите? ставьте плюсы если вы понимаете что сейчас
происходит. и минус если не очень понимаете. так ну 4 5 человек понимает. то есть мы пишем
записали условия ккт. вот сейчас я это веду вот так. а потом начинаем так. вот Андрей не понимает.
а что непонятного? в каком месте? то есть вот это написано ккт. давайте я может быть вот так
сейчас делаю. вот это ккт. дальше мы пытаемся найти такие лямдо 1 лямдо 2 x1 x2 чтобы эта система
выполнялась. ну и как мы это делаем? поскольку у нас есть условия на лямдо 1 лямдо 2, то мы разбираем
случай. сначала смотрим на ситуацию когда лямдо 1 больше 0 и лямдо 2 больше 0. то есть когда
получается обе перемены лежат на границе. получаем в этом случае что только 0 0 являет
единственной точкой. вот подставляем это все в лгрынжан. то есть подставляется вот сюда. это
зануляется. это зануляется. получается тут единичка. а тут получается лямдо 2 минус лямдо 1. это неважно.
то есть тут единица и тут... а с чего вы взяли что равно? с чего это следует? нет. вы имеете в виду что
если вы сюда подставите то лямдо 2 будет равно лямдо 1. но это неважно. потому что тут у вас стоит
единица, а тут должен быть 0. уже мимо. уже ничего не работает. я поэтому здесь написал многоточку чтобы
ничего не выводить. потому что это неважно. ага. супер. хорошо. давайте второй случай когда у нас...
когда строго выполнено мы находимся внутри. то есть лямдо 1 ноль и равно лямдо 2. что в этом случае
будет? в этом случае будет все то же самое. то есть аналогично. потому что теперь у нас в
первой строчке занулиться опять же вот эти и вот эти. но только за счет лямдо. опять мимо. третий
случай. мы понимаем что здесь всего 4. но сейчас я распишу третий. четвертый делается аналогично.
поэтому я его наверное сейчас не буду расписывать. лямдо 1 больше 0. лямдо 2 равно 0. это что значит?
раз лямдо 1 больше 0 это значит что x2 равняется x1 квадрат. очень хорошо. значит смотрим снова
на наш градиент. тут я что-то неправильно написал что ли? а нет. все правильно. да. это раз. далее.
поскольку лямдо 1 больше 0 и лямдо 2 ноль. соответственно при постановке у нас получается 1
ноль плюс 2 x1 минус 1 умножается на лямдо 1. и это равно 0. отсюда мы получаем внезапно что лямдо
1 равно 0. то противоречит тому что у нас лямдо 1 больше 0 по нашей гипотетии. мы рассмотрим именно
этот вариант. то есть смотрите что произошло. у нас есть задача. мы записали условия КТ. абсолютно
честно. пытаемся разрешить эту систему. и сталкиваемся с ситуацией когда трех векторов прямых и двойственных
переменных которые будут удовлетворять эту систему просто нет. но не вопрос. что пошло не так? то есть
первый вопрос. понятно ли что мы получили? поставьте плюсик если понятно и минус если не очень. ну четвертый
давайте аналогично тоже не пишу. и если понятно что произошло то как вы думаете в чем причина
такого эффекта? что-то какая-то тишина подозрительная. а что не понятно? что мешает поставить
плюс? у нас не осталось допустимых лямб. нам не удалось найти такие лямбда и иксы чтобы
одновременно все все условия были выполнены. сейчас получается что вот эта штука не имеет
решения. почему так получилось? условия примера. а вот какие будут предположения? что у нас тут
сломалось? чтобы ничего сломалось достаточно нарисовать просто картинку. давайте нарисуем.
то есть тут у нас x1 тут x2. и одно множество одно условие нам задает. что x2 больше чем x1? то есть
вот эта штука это вот эта штука. а второе у нас x1 меньше либо x2 меньше либо равняйте
минус x1 в квадрате. то есть минус x1 в квадрате вот здесь, а x2 меньше. то есть на самом деле вот
здесь у нас вообще вот такое множество. то есть смотрите что получается. у нас единственная допустимая
точка которая лежит и там и там это 0. допустим множество этой одной точки. и условия свитера не
выполняется очевидным образом. потому что нет никакой окрестности. и поэтому мы над ним
получилось разрешить систему хорошекунтакер. понятно для объяснения? так окей вижу плюсы.
наверное это хороший знак. вот короче говоря такие патологические ситуации бывают. о них нужно как
упомнить и понимать при каких условиях вы пользуетесь теми или иными утверждениями. то есть бросаться
с вами голову при виде выпуклоздающей что-то пытаться найти. сначала надо проанализировать. ну не
всегда возможно найти явным образом точку которая входит в множество сокрестностей. но почти всегда
можно какие-то аргументы предоставить которые бы обосновывали просто-напросто само существование
такой точки. вот может быть вы не скажете что вот именно такая точка. именно в ней все хорошо. но
скажете почему она будет существовать. вот так ну слушайте 10.30 почти отличный идеальный тайминг.
тогда на сегодня все. в следующий раз мы продолжим смотреть на двойственность и рассмотрим более
интересные сложные примеры того как она работает, где выполняется. и как строить задачи двойственно
основе конического представления исходной задачи. вот я надеюсь что мы уложимся где-то в пол
лекции. а потом я надеюсь рассказать успеть про то как все это используется для построения
солверов которые вы можете использовать на практике. вот значит сегодня все. всем большое спасибо.
