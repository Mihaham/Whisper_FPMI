Да, всем здравствуйте, сегодня мы продолжим то, с чем остановились
в прошлый раз.
Но сначала небольшое возвращение того, что было обещано.
Мы в прошлый раз пользовались этим вот свойством, вот,
и я, собственно, добавил то, как он доказывается,
то есть вот эта штука была выписана в прошлый раз
просто на доске, вот, теперь про, собственно, доказательства
еще раз.
Напомню, положительная полуопределенность вот этой
штуки, блочной матрицы, эквивалентна положительной
полуопределенности выполнения Пашуру для соответствующего
блока С.
Вот.
Откуда это берется?
Берется, на самом деле, довольно, то есть, есть не
очень интуитивно понятное гибридическое доказательство,
которое опирается на то, как вы вот эту матрицу
раскладываете на произведение там, нижней треугольной,
диагональной, верхней треугольной, но сходу не очень понятно,
как за этого доходить.
Вот.
Поэтому, как бы, если вы вдруг встретите какое-то
другое доказательство, не пугайтесь, оно как бы
вполне правомерно, вот, но поскольку нам нужно всего
лишь вот этот факт без, без какого-то там разложения
на произведение, вот, то проще на это посмотреть следующим
образом.
Рассмотрим такую вот функцию, которая есть не что иное
как значение квадратичной формы с такой матрицей.
Она будет записана таким вот образом, где x и y соответственно
подвекторы, того вектора, с которым вы берете, ну,
в общем, который вы подставляете в квадратичную форму с этой
матрицы.
Вот.
Поскольку эта штука не отрицательно полуопределена,
то тут должно быть всегда больше либо равно нуля для
любых x и y, ну, любой вектор у вас определяется любой
парой x и y.
Вот.
Теперь, если вы проминемизируете вот эту вот штуку по y, то
у вас будет некоторая функция от x, и эта функция от x тоже
должна быть больше либо равно нуля, поскольку, ну,
для любых x и y это больше равно нуля, значит, если вы
минимум берете по одной переменной, у вас точно не
может никуда знак улететь.
Это понятно, я надеюсь.
Прозащина логика, все, все окей.
Соответственно, поскольку от y эта функция выпукла
в силу того, что c положительно определена, то мы можем
явно найти этот минимум, взяв градиент от этой функции
по y и приравнять его к нулю.
Получим вот такое вот выражение.
Далее, после подстановки этого выражения вот в эту
функцию мы получим функцию от x, которая матрица которой
будет в точности совпадать с дополнением ашуру.
Вот.
Таким образом, поскольку эта штука должна быть
для любого x больше либо равно нуля, значит эта матрица
должна быть положительно полупределенна.
То есть, взяли блокчную матрицу для блокченного
вектора, провели частично минимизацию по переменной,
которая соответствует блоку положительно определенному,
получили функцию от другой части блокченного вектора
и поскольку для этого блока все тоже должно быть больше
либо равно нуля, получаем положительную полупределенность
дополнения ашуру.
Понятно логика.
То есть, это было доказано в одну сторону, ну в другую
сторону более-менее понятно, как объяснять, я даже не
стал это записывать, что если вот эта штука не положительно
полупределена, то найдется такой вектор x, для которого
это будет меньше нуля, значит если мы этот x подставим
сюда, получим вектор y и получим вектор, на котором
вся квадратичная форма будет меньше нуля.
Поскольку не отрицательный, не отрицательный определенный
сцена у нас сохранился.
Поэтому получим противоречие, в обратную сторону все тоже
работает.
Понятное ли доказательство?
Или так себе.
Да, просто если это не положительно полупределенная
матрица, то найдется x, на котором вот это выражение
меньше нуля, а значит найдется и y, построенный по этому
x, такое, что все вот это выражение будет меньше нуля.
Не-не, еще раз, пусть вот это верно, это в одну сторону,
а теперь наоборот, пусть вот это неверно, то есть
хотим из вот этого вывести вот это.
Да, нет, убедительно, хорошо, вот, в итоге, в общем, три-четыре
буллета, да, понятно, вот, так, теперь возвращаемся
к тому.
Хочется показать, что если вот это правда, то правда
и вот это.
Так.
А, то есть надо сказать, что пусть вот это неправда.
Ну хорошо, пусть вот это неправда, делаем все те
же самые манипуляции, получаем то же самое противоречие.
Эти направления плюс-минус взаимозаменяемы, потому
что вы по найденному x, который, для которого находите значение
y, где вот это вот меньше нуля, вы тоже сам подставляете
вот в эту функцию f от x, получаете тот же самый знак вот здесь.
Поскольку, ну, х минимум и сохранение знака при
частичной минимизации.
Да, окей, спасибо.
Так, еще вопрос какие-нибудь есть?
Окей, вроде нет.
Так, окей, теперь возвращаемся к тому, на чем мы остановились
в прошлый раз.
В прошлый раз мы остановились на том, что определили,
что такое Lagrangian для утаковой задачи и хотим получить
некоторые условия оптимальности, а именно понять, каким условиям
будет удовлетворять x, чтобы он был решением задачи
или, то есть хотим понять либо необходимые, либо
достаточные условия, либо и то и другое.
Значит, ввели такую вот двойственную функцию и обсудили, почему
она вогнутая и, в общем, почему может быть минус бесконечность,
откуда берется вогнутость, почему эта вогнутость будет
всегда независима от того, какими свойствам обладает
f, g и h, g и t.
Вот, ну и теперь посмотрим, почему такая конструкция
может быть нам полезна для ответа на наш вопрос.
То есть, утверждение такое, что если коэффициент при
ограничениях типа неравенств больше либо равен нуля, то
какое бы значение двойственных переменных λ и u мы не взяли,
мы получим оценку снизу на решение исходной задачи.
Где-то даже определение было, да, вот оно.
Почему это так?
Доказательств тоже быть простым.
Возьмем некоторые векторы из нашего множества d и пусть
он, помимо этого, лежит еще в допустимом множестве.
И μ больше нуля.
Тогда если у нас, ну, то есть мы можем тогда f0 оценить
снизу как l от этого самого x, крышкой лямбда и mu.
Почему это будет правда?
Потому что если, то есть у нас ограничение вот здесь,
поэтому я буду на этом стадии показывать.
Если у нас x крышкой лежит в допустимом множестве,
значит вот эта штука зануляется, потому что g и t равно нулю.
А вот это вот, это значение h житого для всех g меньше
либо равно нуля, и мы их перемножаем на положительный
mu.
Это значит то, что стоит в этой сумме, оно меньше
либо равно нуля.
А раз оно меньше либо равно нуля, значит мы из f0 вычитаем
что-то положительное.
Ну, прибавляем что-то отрицательное.
Поэтому будет меньше.
Для какого-то фиксированного x крышки.
Понятно ли это неравенство?
Да нет, поднимите руком, понятно это неравенство.
Так, что-то как-то не очень.
Давайте еще раз.
Мы хотим понять, что как связан Лагранжан в некоторые
допустимые точки с значением самой функции в этой точке.
При этом у нас есть ограничение на коэффициент mu.
Поскольку точка допустимая, то есть она лежит в допустимом
множестве, то есть вот эти все ограничения, что она
лежит в д, и что житая в этой точке 0, и что аж житая
в этой точке меньше либо равно нуля тоже выполняется.
Это понятно.
Хорошо.
Теперь берем Лагранжан, вот тут он тоже написан.
Значение, то есть что, если вместо х поставим х с крышкой,
мы получим f0 от х с крышкой, это то, что у нас стоит слева
от неравенства.
Здесь мы получим 0, потому что все житы занулились.
А здесь мы получим аж житая, которая меньше либо равно
нуля, умножить на mu житые, которые больше либо равно
нуля, по нашему предположению.
Значит, эта штука меньше нуля, значит f0 плюс что-то
меньше либо равно нуля будет меньше, чем f0.
Именно это тут написано.
Подимитируй, кому стало понятно первое неравенство.
Прекрасно.
Так, отлично.
Теперь мы, поскольку записали Лагранжан для какого-то
фиксированного х с крышкой, то мы можем взять и проминемизировать
этот самый Лагранжан по всем х-сам.
Получим точно не больше.
Вроде логично.
А это наша функция g, которая, заметьте, от х-а уже не зависит.
Теперь нам осталось проминемизировать еще раз обе части по х с крышкой,
получить слева по созвездочку, а справа что-то, что от х-а
не зависит, поэтому мы ничего не делаем.
Получаем, что оптимальное значение исхода из задачи
оно не меньше, чем значение двойственной функции для
неотрицательных мим.
Естественный вопрос возникает.
Если мы получили некоторую степень свободы в том, как
приближать по созвездочкам снизу, что надо с этой функцией
сделать?
Максимизировать, конечно.
Получаем двойственную задачу.
Максимизируем двойственную функцию при условии, что
не отрицательности тех переменных, при положении
не отрицательности которых эта оценка была получена.
Какие бонусы мы сразу получаем?
Давайте обсудим.
Чем эта задача хороша.
Да, она всегда выпуклая будет, потому что у нас
функция g всегда вогнута, и мы ее максимизируем.
Вогнутая функция – это то же самое, что минимизация
выпуклой.
Ну и ограничение здесь тоже, понятное дело, выпуклое.
Это всегда выпуклая задача.
Теперь, если мы обозначим за d со звездочкой оптимальное
значение, то наша d со звездочкой будет являться некоторой
наилучшей нижней оценкой для p со звездочкой, которая
в принципе наша задача может дать.
Значит, вектора называются допустимыми, если μ не отрицательно,
а на 2 к лямбда и μ у нас функция принимает конечные
значения.
Ну понятно, что здесь могут быть дополнительные ограничения,
которые появляются в связи с тем, чтобы g не принимала
какие-нибудь милобесконечные значения, то есть дополнительность
сюда может вылезти.
Об этом надо помнить, и мы с этим столкнемся, наверное,
в следующий раз, когда будем примеры рассматривать.
Понятно ли постановка, откуда она взялась, какими
с 8 обладается?
Окей.
Теперь, собственно, про взаимоотношения между d со звездочкой
и p со звездочкой.
Первое отношение, которое всегда выполнено, это называется
слабая двойственность.
Это когда d меньше либо равно p со звездочкой.
Это всегда выполняется, потому что мы так строим
нашу двойственность, чтобы эта штука была выполнена.
Что она даи может дать?
Она может дать некоторые нитривиальные нижние границы
для непосложных задач, для которых вы можете построить
двойственность.
То есть, если у вас была какая-то сложная задача
с ограничениями типа x и t могут быть только ноликами
единицами, вот, эти ограничения кодируются.
Очень просто, что в g и t у вас будет типа x и t умножить
на 1 минус x и t равно нулю, это то же самое, что x и t либо
нолик, либо единица.
Поэтому для такой задачи вы можете спокойно написать
двойственную, получить некоторую выпуклую задачу,
и, собственно, решив ее, получить некоторую нитривиальную
нижнюю границу.
То есть, то, что снизу точно не меньше, чего ваше оптимальное
значение в исходной задаче.
Значит, бывает еще так, что выполнена сильная двойственность,
то есть, ваши значения в точности совпадают.
То есть, вы минимизируете по x, максимизируете по
лямбду мил, получаете одно и то же значение.
Некоторое чудо происходит, когда оказывается, что
достигается точное равенство в точках минимума исходной
задачи и в точках максимума двойственной.
В общем случае, понятное дело, это замечательное
свойство не выполняется.
Вот, обычно это выполняется для выпуклых задач, собственно,
поэтому они так приятны для изучения.
Тут написано «обычно», и оно выделено не просто
так курсивым, потому что сейчас будет чуть не чинец
к слайдам, будет сказано, почему не всегда для выпуклых
задач оно выполняется.
И, возможно, даже к концу лекции мы посмотрим на
конкретный пример, или этот конкретный пример будет
уже в следующий раз рассмотрен, сейчас говорю, не помню.
В общем, здесь 10 слайдов осталось, я думаю, тут просто
сегодня будет одно неприятное доказательство, единственное
неприятное доказательство в курсе, вот, поэтому, значит,
тут всего 10 слайдов, но мы их, наверное, как раз к концу
и закончим.
Вот.
Значит, да, для того, чтобы для выпуклых задач эта штука
выполнялась, нужно потребовать некоторую регулярность
ограничения, которая будет, соответственно, сказана
в своё время.
Вот, тут как бы большое поле для разведения всякой
теории, но на практике нам будет нужно всего лишь
одно условие, которое довольно легко проверяется.
Вот, приятно и несколько удивительно то, что вот
эта штука может выполняться и для невыпуклых задач,
то есть есть примеры, как минимум один, вот, где аналитически
показано, что если вы решили двойственную задачу или
решили прямую задачу, то оптимальные значения будут
совпадать, несмотря на то, что они не выпуклые.
Вот, то есть каждый такой пример – это отдельная
статья, которая публикуется в приличном журнале на
самом деле, потому что тут требуется какая-то специальная
техника для того, чтобы это продемонстрировать.
Вот.
Да, иногда решение двойственной задачи может дать решение
прямой задачи просто через связь между х со звёздочкой
и лямбда со звёздочкой, когда вы минимизируете
логранжан.
То есть когда вы вот здесь вот находите выражение
для g, вот, вы получаете некоторую зависимость х от лямбды
и мю.
И когда вы решили задачу для двойственной функции,
вы найденные лямбды и мю подставляете и получаете
х со звёздочкой.
Вот.
Это иногда случается, не всегда, вот, но когда такое
случается, это довольно приятно, вы как бы экономите
много времени.
Так, да, важная, как это, важная величина, которую
про которую надо сказать, называется взором двойственности
и равна разности между f0 и g.
Понятное дело, на допустимых х и лямбда и мю.
Почему эта величина важна?
Во-первых, эта величина важна потому, а, да, тут
нет этих оценок, сейчас я, наверное, их изображу,
потому что, во-первых, какой у неё знак?
Внезапный вопрос.
Да, она всегда не отрицательна.
Вот.
И равна нулю только когда выполнена вот эта.
Вот.
То есть, помимо этого, у этой величины есть следующее
замечательное свойство.
Так, сейчас, секунду, то есть мы хотим, мы целимся
вот в это, так, да, ну вот, смотрите, если у нас рассмотрим
вот такую, нет, не такую, эта штука всегда больше
либо равна нуля, да, теперь, то есть, что это значит,
что f0 от x, так, сейчас я пойму, то есть хочется показать
следующее, что, вроде так, да, ну, то есть, мы знаем,
что слева у нас фигурирует оценка на сходимость по
функции для исходной задачи, поскольку p со звёздочкой
больше либо равно, чем g, то можно оценить эту разность
сверху таким вот образом.
Всем ли понятно, это простое преобразование?
Так, поднимите руки, кому понятно, откуда этот знак
взялся?
Окей, вроде, вроде, нормально, ну, давайте я ещё подробнее
распишу, то есть, у нас есть утверждение, которое
мы показали в самом начале, что p со звёздочкой больше
либо равняется g от лям до мил, множим это всё на минус
единицу и добавим к обеим сторонам f0 от x.
Так, поднимите руки, кому понятно первый переход.
Так, окей.
А кому не понятно, что и что, что и что, что и что
не хватает?
Променьшаемся, а мы сейчас поговорим, пока только
вот это я хочу осознать, что всем понятно, почему
так.
Значит, смотрите, что произошло, слева у нас стоит некоторая
неизвестная на величина, мы же не знаем p со звёздочкой
заранее?
Это всем понятно, да, то есть мы как бы p со звёздочкой
мы ищем, но не знаем, но оценить вот эту штуку сверху
мы можем тем, что мы знаем, можем построить двойственную
функцию и как-то итерироваться по x, по лям до мю и измерить
вот эту вот величину.
Но эта величина оценивать сверху неизвестна нам величину
f0-p со звёздочкой.
Соответственно, если мы предъявим такие x и лям до
мю, что вот эта величина будет меньше епсилон, то
это значит, что и разница между значением f0 и p со
звёздочкой тоже будет не больше епсилона.
Хотя что происходит с p со звёздочкой мы вообще
не знаем.
Мы знаем только то, что, ну вот на этом этапе, мы
знаем только x, лям до мю, но вот эта вот величина
позволяет оценить сверху разность текущего значения
f0 и оптимального значения f0, к которому мы стремимся.
Поэтому эта величина позволяет оценить точность текущего
решения.
Ничего не знаю я о методе вообще.
То есть вот здесь вам не нужно объяснять и показывать,
как работает метод.
Достаточно показать, что те x и лям до мю, которые
он генерирует, дают значение этой величины меньше епсилона.
Это значит, что тот x, который вы получите при подстановке
в целевой функцию, будет давать отличие от p со звёздочкой
не больше, чем вот эта величина.
Если у кого-то была теория сложности какая-то, наверное,
была у кого-нибудь там n по полнота, всякая вот эта
вот история, то там обычно любят говорить про всякие
сертификаты правдивости, неправдивости вот этого
всего проверки.
Было такое, наверное.
Ну вот это типа сертификат к тому, что вы решили задачу,
не зная то, каким именно методом вы это делаете.
То есть вот у вас есть чёрный ящик, который вам решает
задачу и выдает вам тройки x, лям до мю.
Вы не знаете, что там внутри происходит, но хотите понять,
что работает правильно.
Ну вот вы это меряете и понимаете, правильно он работает или нет.
Вот такая вот простая история.
Да, ну в общем, также можно, эта штука может использоваться
для доказательств корректности сходимости методов.
То есть вы доказываете, что там на каждой итерации
вы убываете по вот этой штуке каждый раз всё меньше и меньше.
Так, теперь, да, сложный слайд обычно тяжело воспринимается.
Давайте попробуем с ним разобраться.
Где, на, как это, как все вот эти вот взаимоотношения
между прямыми и двойственными задачами понять на картинке.
Ну вот рассмотрим вот такую вот простую задачу исходную.
А, да, тут надо, короче, ладно, сейчас, я потом перерисую
немножко этот слайд, потому что он немножко путаный
сейчас сделан, но ничего.
Смотрите, значит, у нас есть f0 и f1.
И некоторое множество d, которым принадлежит x.
Мы хотим минимизировать наш функцию f0 при x из d
и ещё, чтобы f1 было меньше либо равно 0.
Понятна задача.
Чтобы построить двойственную, чтобы нарисовать это всё
на картинке, перепишем двойственную задачу в том стиле,
в котором мы переписывали задачи, когда вводили над график.
А именно, наша двойственная функция будет
infimum t плюс лямбда u, то есть она будет зависеть от лямбда,
потому что у нас одно ограничение типа не ранее,
с правильным видом, где u и t лежат в множестве g.
А множество g – это множество пар f1 и f0 таких, что x
исходно был в d.
То есть мы, как бы, если бы мы исходным образом записывали
нашу двойственную функцию, то мы бы написали
infimum f0 плюс лямбда f1.
Теперь мы f0 плюс лямбда f1 заменяем на t плюс лямбда u,
и t и u кодируют нам значение f1 и f0 для допустимых x.
Поднимите руки, кто понял эту запись.
Поднимите руки, кто не понял эту запись.
Так, ещё есть люди. Хорошо, давайте ещё раз.
Значит, наша изначальная постановка, она вот где.
Далеко, да? Вот.
При этом тут у нас это всё скалярное выражение.
То есть у нас все функции, они в R отображают, x.
То есть тут у нас какое-то стоит какое-то число,
тут стоит какое-то число, лямбда у неё тоже какие-то числа.
Никто не мешает нам переписать это всё в виде
принадлежности этих чисел некоторому множеству.
Это множество будет называться множеством значений этих самых функций f1 и f0.
Вот.
Типа плоскость.
Где x также, вот тут неявное ограничение, оно тут осталось.
То есть грубо говоря, вместо того, чтобы писать, что там f0 и f1,
мы пишем, что тут значение f0, тут значение f1,
но эти значения явно для f1 и f0 записаны, вот здесь.
Закодировано в том, что это множество.
Так, стало ли понятнее?
Поднимите руки, кто не понял.
Так, вроде никто не поднимает руки, но я надеюсь, что все поняли.
Окей, теперь давайте нарисуем картинку, самый такой нетривиальный этап здесь.
То есть зачем всё это делается?
Во-первых, давайте нарисуем множество g,
которое может принимать, ну, какой-то вот такой вот вид.
Вот оно тут.
Вообще, оно тут закрашено серым, но проектор всё это дело высвечивает.
Поэтому, в общем, множество g – это вот такая вот кривулянка, такая вот граница у него.
Понятно, да?
То есть тут каждая точка внутри g – это означает, что найдётся x из d,
что u равно f1, а t равно f0.
Вот что нарисовано.
То есть нарисовано множество пар f1, f0, где для тех x, которые лежат вот здесь.
Так, откуда взялось множество g – понятно.
Хорошо.
Теперь давайте поймём, где вот на этом графике допустимое множество,
на котором мы ищем решение вот этой задачи.
Простой вопрос на проверку того, чтобы вы поняли, что происходит.
Да, правильно.
Очень хорошо.
Смотрите, у нас есть ограничение, что f1 меньше 0.
За f1 у нас встречает переменная u.
То есть нам у нас интересуют только те значения,
для которых u меньше либо равно 0, то есть слева.
То есть мы ищем некоторое минимум f0, f0 – это t.
Там, где наша u меньше 0.
То есть вот в этой части только.
Поэтому созвёточка вот здесь вот.
Что такое?
Иначе оно было бы тут.
Потому что за t у нас отвечает f0.
Понятно?
Поднимите руки, кто понял, где находится p со звёздочкой
и почему оно находится именно здесь.
Так, ну, более-менее, окей.
Так, хорошо.
Разбрались, где находится p со звёздочкой.
Теперь давайте поймём, как нам найти, где находится g от лямбда
и как вообще оно получается.
Пусть лямбда, начнём с того, пусть лямбда 0.
А если у нас t меньше 0?
А если у нас t меньше 0?
Пусть лямбда, начнём с того, пусть лямбда 0.
Ну, в смысле, пусть лямбда равно 0.
Тогда мы ищем инфимум t по множеству u и t, лежащим в g.
Это всем понятно?
Это будет g от нуля.
Вот наша g.
И мы ищем значение t, которое минимально.
Где оно?
Где на этом графике t минимально, чтобы оно лежало в g?
Справа, да, конечно.
Вот это значение мы проводим прямую параллельную оси u.
Получаем здесь какую-то точку.
Это наша g от нуля.
Это всем понятно?
Прекрасно.
Увеличиваем лямбду.
Было 0, была плоскость.
Горизонтальная прямая.
Увеличиваем лямбду.
Теперь у нас тут сидит набор прямых вида t плюс лямбда u.
При фиксированном лямбде.
И нам нужно найти...
И это все равно некоторой константе c.
И эта константа c есть не что иное, как наше искомое значение.
Ну, понятно, да?
Теперь нам нужно выбрать минимальную такую константу,
чтобы минимальную константу, при которой u и t лежит в g.
Как это делается?
Поскольку тут сидит, что t плюс лямбда u равно c.
Это значит, что t равно c минус лямбда u.
Это набор параллельных прямых.
Они параллельны, потому что лямбда фиксирована.
Угол наклона тупой, потому что минус лямбда – отрицательный коэффициент.
И c параметризует то, где они пересекаются с помощью t.
При этом c одновременно с этим является еще и нашим искомым значением.
Всем ли понятно эти рассуждения?
То есть у нас есть набор параллельных прямых.
И мы ищем, при какой минимальном значении c они будут все еще касаться нашего...
Найдутся u и t, для которых какие-то значения еще принимаются.
Поэтому когда мы чуть-чуть увеличили u, например, до лямбда 1,
у нас получилась вот такая прямая, когда еще угол наклона не достаточно велик.
И все еще мы в этой точке подпираем наш график, нашу вот эту вот фигуру.
При увеличении лямбда мы начинаем подпирать уже в двух точках.
И при этом видите, что вот здесь было маленькое некоторое значение,
потом оно выросло до d со звездочкой.
И потом при дальнейшем увеличении лямбда мы начинаем операцию уже,
а вот этот край и наше новое значение g от лямбда 2 уже вот здесь.
То есть видите, мы как бы сначала увеличиваем до какого-то максимума,
а потом уменьшаем наше значение двойственной функции.
Вот она вогнутость, которая была доказана ранее алгебрически.
То есть у нас идет сначала рост до максимума, потом убывание.
Соответственно d со звездочкой у нас вот здесь.
И наш зазор p-d он вот ровно вот этот вот.
Теперь смотрите, ну в общем, мы еще к этому графику вернемся, наверное, один раз.
Почему возник зазор и почему он положительный?
Потому что это множество не выпукло.
Если бы оно было выпукло, то наша точка минимума, она бы совпала с некоторой.
Ну то есть у нас бы вот эта d со звездочкой, она бы совпала с той точкой,
которая была бы здесь.
За одним исключением, про которое сейчас будет несколько слов сказано отдельно.
И это исключение называется условие слейтера.
Ну то есть это не исключение скорее, это то, что обычно хочется от задачи
и то, что на графике сейчас все будет выполняться.
Значит условие слейтера формулируется таким вот образом.
То есть говорят, что оно выполнено,
если существует точка из внутренности множество d,
в которой равенство выполнено равенство,
а функции ограничения типа неравенства выполнены как строгие.
То есть что это геометрически означает?
Геометрически это означает, что вот здесь вот...
Давайте я нарисую картинку.
С картинкой, наверное, будет попроще.
Так, сначала надо перерисовать.
Так, у тем...
Так, я обычно...
Каждый раз я осознаю, каким образом это надо нарисовать,
и потом все отбываю.
Так, ну давайте как-нибудь вот так.
Так, и чего?
Пусть вот наше множество g выпукло и множество.
Все в порядке.
И у нас в множестве u,
то есть там t, u, это на самом деле что?
Это на самом деле f1, f0.
То есть мы хотим, что...
То есть вот наше...
То, что мы, где мы ищем минимум,
вот у нас p со звездочкой.
Ну и, в общем, несложно показать с помощью аналогичной процедуры,
что здесь d со звездочкой совпадет с p со звездочкой,
просто потому что мы как бы касательно будем подпирать
и потихонечку к этой точке сойдемся.
На ваше упражнение просто порисуйте,
чтобы поиграться с геометрической интерпретацией.
В чем может быть проблема?
И здесь, да, здесь заметьте, что есть точка,
в которой u строго меньше нуля.
Есть точка, в которой u строго меньше нуля.
Понятно.
Как геометрически изобразить?
То есть это условие слайтер u выполняется.
Теперь условие слайтера не выполняется.
Вот такая вот история.
То есть в нашем допустимом множестве
нет точек, в которых условия типа неравенства достигаются как строгие.
Что здесь будет происходить?
Здесь мы будем искать минимум для разных лямб,
и наша прямая категория,
которая у нас параметризована лямбой,
они будут все более-более вертикальными становиться,
вплоть до превращения в вертикальные прямые
соответствующих лямб до равной бесконечности.
Поэтому конечных углов наклона,
которые бы соответствовали двойственной функции,
здесь не будет.
Все ломается.
В общем, в общем-то,
у нас не будет ничего,
в общем, будет пример задач, в которые это реально происходит.
Это условия слайтера и его геометрическая интерпретация.
Поднимите руки, кто понял, что произошло.
Так, окей, не так плохо.
Да, теперь, собственно, зачем оно надо?
Зачем мы это все делаем, пытаемся?
А надо оно для того, чтобы доказать следующий факт,
который будет доказываться долго и упорно.
21 минута, окей.
Дотверждение такое,
что сильная двойственность выполняется для выпукла задачи такого вида,
если выполню условия слайтера.
То есть, вот эта вот обычная, которая фигурировала здесь,
написана для того, чтобы уберечь нас от невыполнимости условия слайтера.
А именно, наличие в допустимом множестве точек,
в которых ограничения типа не раз в полностью как строгие.
Вот геометрически это можно еще интерпретировать как,
что найдется точка, которая входит в допустимую область некоторой окрестностью.
Ну, понятно, я думаю, да?
Если у нас есть что-то меньше,
то мы можем немножко построить шарик,
так, чтобы достигалось точной равенства,
и это будет наша окрестность.
Примерно так.
Ну, все непрерывно, поэтому проблем с этим не будет.
Так, понятно ли утверждение?
Еще раз?
Да, давайте, я бы даже так сказал,
давайте делаем перерыв на 5 минут,
потому что я не хочу начинать доказательство, оно там длинное,
и потом делать перерыв,
когда у нас будет такой,
длинное,
и потом делать перерыв,
когда он будет по расписанию.
Так, сейчас 11.22, ну давайте 27 продолжим.
Так, доказательство, значит, этого замечательного факта
будет занимать три слайда, к сожалению,
но я надеюсь, что мы вместе прорвемся через все эти дебри.
Тут, на самом деле, идейно не так много чего происходит,
но, к сожалению, формальная запись этих идей немного громоздка, скажем так.
Значит, предположение, которым мы будем руководствоваться,
что у нас множество не пусто исходное,
то, которое должно было быть, на самом деле,
вот это вот множество не пусто.
И ранг матрица равен P.
То есть матрица состоит из строк и столбцов,
причем строк меньше, чем столбцов,
и строки линейно-независимы.
Если это не так, можно исключить все, что зависит,
выкинуть и оставить только то, что линейно-независимое.
Это делается обычно с ловерами на этапе предобработки задачи.
Если вы туда какой-то мусор подали,
вам этот мусор отфильтрует и вернут ровно то, что надо для решения.
Вот.
Да, значит, теперь первый этап.
Ведем два множества по аналогии с тем,
как мы это делали, когда обсуждали геометрическую интерпретацию двойственности.
Значит, множество A, фигурное, будет стать из вот таких вот векторов.
U, V, T.
При этом U это M, V это P, а T это R.
Это размерности.
Это такие вектора, что найдется точка из D,
что все ограничения F it меньше уитых,
равенства равны V,
ну, вот AX-B равно V,
а F0 меньше T.
То есть берем каждый X из D, подставляем,
и все такие уиты, для которых это будет выполнено,
запихиваем множество A.
Просто формальная запись.
И ведем множество B, фигурное,
состоящее из нулей соответствующих размерностей
и S, некоторое тоже число,
таких, что S меньше P со звездочкой.
Понятно ли от как они конструируются?
То есть тут набора векторов, тут набора тоже векторов,
только тут 0, S и S меньше P.
Что можно сказать про множество A и B?
Почему?
Погодите, почему пусто?
Это вот хороший вопрос.
Ну, то есть у нас есть некоторые P со звездочкой.
Это наше оптимальное значение.
Ну оно же, ну как бы,
нет, минимум абсолютно право, минимум.
И в тот сидят числа, которые меньше этого минимума.
Ну есть же числа меньше минимума.
То есть множество B ничего не знает про эту задачу,
ну кроме P со звездочкой.
То есть не про А, не про вообще.
Просто набор нулей и одно число.
Так, какими свойствами обладают два этих множества?
По основе вопроса можно понять, что хочется получить.
Умейте находить ответы в фруллеровских вопросах.
Ну можно начать думать про B.
Вот B это какое множество?
А это прекрасно, это правда луч.
Луч это какое множество?
Еще?
О, B это выпуклое множество.
Отлично.
Давайте помнем что-то про А.
Что можно понять про А?
И более важный факт, наверное, даже,
что надо понять про отношения A и B, взаимное расположение их.
Во, они не пересекаются, шикарно.
К этому осталось добавить, да, ну то есть,
во-первых, что P со звездочкой это эфиум по T,
где, в общем, такие элементы лежат в A.
И эти множества являются выпуклыми.
Про B уже сказали, что это луч.
Про А тоже понятно, что оно выпукло, потому что, смотрите,
это набор векторов.
Это набор векторов,
для которых существует точка.
То есть, пусть существует, возьмем некоторые два вектора,
и, то есть, поскольку эти два вектора будут лежать в этом множестве,
то в силу выпуклости F it и F0, и линейности AX-B,
мы сможем найти такие точки, что для выпуклы комбинации этих векторов
будет существовать некоторая точка.
Понятно ли это?
Вот про выпуклость именно вот этого множества.
Видимо, ну, то есть, вы назвали все, кроме выпуклости множества,
поэтому я про выпуклость множества спрошу.
Да, нет, руки поднимитесь, кому не понятно.
Всем понятно?
Замечательно.
Что из этого следует?
Да, ничего пересекается.
Не пересекается, точнее.
Что следует из 3 и 4?
О, отделимость следует.
Существует разделяющий гвир плоскости.
Для вот этих довольно хитрозаписанных двух множеств.
То есть, если это рисовать картинку, тоже, видимо, в 2D, понятное дело.
Так, сейчас.
Куча однотипных рисунков.
То есть, если по оси Y у нас будут наши значения f0,
я вот так сейчас это напишу, может быть, немножко грубовато,
ну, в смысле, достаточно формально аккуратно, но тем не менее,
тогда одно множество у нас будет каким-нибудь вот таким вот,
давайте красный можно нарисовать.
Какое это множество?
Это b, конечно.
А второе множество будет каким-нибудь вот таким,
зеленым можно нарисовать.
Такое вот.
Которое будет содержать, условно, то же самое неравенство f0.
Вот.
И наша разделяющая гвир плоскость будет иметь понятный вид.
Фиолетовый, например.
Вот какой-нибудь такой.
Понятно, да?
Тщательно.
Это первый идейный момент в доказательстве.
К нему пришлось идти целый слайд, чтобы вести все обозначения,
чтобы он начал работать.
Вот.
То есть, пользуемся отделимостью, на самом деле, в не самом,
то есть, начинали все с того, что сильная двойственность,
а пришли к тому, что нам нужна отделимость, неожиданно.
Вот.
Значит, вот эти, да.
Существует разделяющая гвир плоскость, значит, есть вектора,
есть векторы число, точнее.
Вот.
Которые здесь обозначены, вектор обозначен лямбда с волной,
мю с волной, ню.
Число обозначено альфа.
Значит, лямбда с волной, мю с волной, ню не нули одновременно,
потому что это нормально.
Вот. Альфа – какое-то число, пока не знаем какое, сейчас поймем.
Значит, для…
То есть, эти вектора существуют, и для любого элемента из одного
множества выполняется в одну сторону, для любого элемента
из другого множества выполняется в другую сторону.
Тут стоят нули, потому что, ну, у нас тут нули.
Они благополучно сократились.
Понятно ли эта запись, откуда она взялась?
Поднимите рюк, кому непонятно.
Поднимите рюк, кому понятно.
Лучше все поднимать руки.
Ага, отлично. Все, идем дальше.
Значит, вот эта штука выполнена для всех t меньше p со звездочкой.
Ну, по построению.
Переходим к пределу, ну, понятно, да?
Что t меньше p со звездочкой,
значит, мю на p со звездочкой меньше либо равно альфа предельный переход.
Вот.
Значит, более интересный факт следует из вот этой штуки.
Смотрите.
Вот отсюда следует, что лямбда и мю должны быть больше либо равны нуля.
Понятно ли почему?
Ну, написано, на самом деле.
Но вот это вот то, что тут написано, надо какое-то усилие предложить, чтобы осознать.
Смотрите, вот лямбда с тильдой, с волной.
Лямбда с волной, да.
Лямбда с волной и мю относятся к переменным векторам у и т.
Наши вектора у и т образованы вот этой штукой.
Для неравенств образованы как бы прожденные функциями из ограничений типа неравенств и из целевой функции.
Вот.
Значит, что может произойти, если они окажутся положительными?
Если они окажутся положительными, то вот эта штука может быть, ну, она может быть сколь угодно мал.
Ну, то есть, бесконечно можем это все дело угнать.
Вот.
И таким образом, пусть лямбда будет отрицательной.
Это значит, что у мы можем делать сколь угодно большой.
А это значит, что вот эта штука будет сколь угодно малой.
Сколь угодно малой.
А оно у нас по требованию больше ливерной, чем альфа.
Та же самая луя, которая была, когда мы обсуждали то, как, что происходит с лагринжаном, когда мы оцениваем f0.
Поднимите руки, кто понял, что произошло.
Так.
Окей.
Аналогичное рассуждение работает и для неравенства порожденным f0.
Какое место непонятно.
Давайте, кто не понял, задайте вопрос.
То есть, мы получаем два ограничения снизу на лямбда с волной и мюл.
30 секунд.
То есть, поскольку здесь u и t, они ограничивают сверху f it и f0 и могут быть сделаны сколь угодно большими, то если коэффициенты при них будут отрицательными, то все выражение может быть сделано сколь угодно маленьким.
А мы его снизу ограничили константы альфа.
Поэтому все сломается.
Значит, получаем ограничение на коэффициент.
Вот тут будет сейчас хитрый ход.
Значит, вот здесь перепишем теперь все то же самое, но теперь перейдем обратно от выражений для u, v и t из альфа к нашим f it линейным ограничениям и f0.
Поскольку мы их использовали как некоторое прокси обозначение, то теперь вот это вот записывается точно так же, только вместо u, v и t мы записываем f it ах-b и f0.
Получаем вот такое вот соотношение.
Тут лямбда it и f it.
Тут транспонирования не хватает, кстати.
Надо будет где-нибудь записать, чтобы поправить.
Вот, а тут все хорошо.
Это все больше либо равно альфа, а альфа у нас больше либо равно чем u на p со звездочкой.
Подставили.
Теперь пусть, то есть все пока было в порядке, никаких предположений избуточных не было.
Теперь пусть мю больше нуля.
Что тогда?
Тогда мы уже у него поделить.
Можем?
Мю больше нуля делим на мю.
У нас шкалируется на мю лямбда с волной, ню и тут f0 остается.
И тут p со звездочкой остается.
Тут остается некоторая функция, очень похожая на Лагранжиан.
От переменных x лямбда с волной на мю, мю с волной на ню.
И эта штука больше либо равна, чем p со звездочкой.
Для xsd.
А сейчас.
Ну да.
Из того, что xсd следует, что минимум Лагранжиана по x будет двойственной функцией, которая больше либо равна, чем p со звездочкой.
По нашему предыдущему построению.
По, ну короче, сейчас простите, я немножко тороплюсь.
Короче, вот это неравенство мы получили, просто поделив вот это выражение на мю.
Дальше говорим, окей, вот мы получили некоторые выражения.
И теперь у нас x лежит в d, и мы берем, минимизируем этот Лагранжиан по x, получаем двойственную функцию.
Наша двойственная функция, поскольку мы минимизируем величину, которая больше либо равна p со звездочкой,
Получаем, что она больше либо равна p со звездочкой.
А у нас по слабой двойственности она всегда меньше либо равна p со звездочкой.
Получаем сильную двойственность.
То есть, логика какая была?
Мы построили два множества, которые выпукло и не пересекаются.
Построили отделяющую гиберплоскость, внимательно посмотрели на
то, какие знаки у компонентов, переписали получившееся
неравенство через исходные функции, увидели, что получившееся
выражение похоже на лагранжан от некоторой переменной
и получили на него оценку снизу.
А проминемизировав, эта оценка сохранилась, но
потом мы вспомнили, что у нас была оценка сверху
на ту же самую функцию и таким образом получилось
точное равенство, которое эквивалентно сильной двойственности.
Так, это всего лишь одиннадцатый пункт.
Получили вроде как наш результат, напоминаю его.
Значит, сильная двойственность выполняется для выпукла
задачи в случае выполнения условия слейтера.
Внимание, вопрос, использовали ли мы хоть где-нибудь условия
слейтера?
То есть условия слейтера нам было нужно, чтобы вот
такое было выполнено.
Пока это всё нигде использовано на самом деле не было, но
сейчас будет, не переживайте.
Всё дело в том, что мы здесь предположили, что mu больше
нуля.
Почему mu не может быть равно нулю?
Логичный вопрос.
Сейчас давайте это поймём.
Mu равно нулю.
Что тогда?
Подставляем.
Здесь зануляется, здесь зануляется.
Получаем, что вот такое выражение больше либо равно нуле.
Ещё раз.
F0 ушло, правая часть ушла.
Осталось лямбда ИТФИТ и слагаемое оставшееся от линейных
ограничений типа равенства.
Тут транспанирование, кстати, появилось.
Это хорошо.
И это выполнено для всех эксовов СД.
Пусть он там и даже один.
То есть пока ничего, правда, неизвестно.
Наше предположение исходное то, что вот здесь вот было,
что оно не пусто.
Прекрасно.
Ну, тут на самом деле не совсем аккуратно, но я сейчас
не хочу просто в эти тонкости вдаваться.
Есть небольшой момент, где я слегка вас обманываю,
но для практического применения это роли не играет.
Возьмём х волной, лежащей внутри, для которого выполнен
совислейтер.
Вот тут оно наконец-то появилось.
Что это значит?
Это значит, что лямбда ИТФИТ от х волной больше либо
равно нуля.
Почему это правда?
Вот пока вот это не равнится.
Почему правда?
Громче?
Да, потому что раз х лежит в Д, то это занурилось.
Осталось только вот это.
Но поскольку здесь выполнено условие слейтера, то у нас
есть строгое ограничение на ФЛИТ.
А значит, у нас лямбда ИТ больше либо равно нуля.
Понятно, откуда взялось?
Так, осталось теперь понять, почему из этого будет следовать,
что лямбда в точности равно нулю.
Да, спасибо.
Именно так.
Мы умножаем какое-то отрицательное число на что-то не отрицательное
и должны ноль получить.
Так ведь?
И мы это можем сделать только когда у нас лямбда равно нулю.
А вот это у нас взялось ровно из этого.
То есть вот зачем нам было нужно анализировать
наши исходные неравенства на знаке компонент.
Понятно.
Получили, что лямбда равно нулю?
Окей.
Что теперь будем получать?
Ничего не хватает.
Именно с чем?
То есть давайте еще раз высокоуровневую логику.
Сортовали с некоторых множеств, получаем, говорим, что есть
разделяющая гиберплоскость.
В разделяющей гиберплоскости означает, что лямбда не ноль,
мю не ноль, ню не ноль.
Предполагаем, что м больше, что ли, а получаем наш ответ.
Сейчас нам нужно показать, что вот это предположение
это единственный возможный вариант.
То есть нам надо показать, что если ню равно нулю, то
и лямбда, и мю тоже равно нулю, и мы получаем противоречие
с тем, что есть ненулевая нормаль у гиберплоскости.
То есть только что мы показали, что лямбда равно нулю.
Теперь осталось показать, что мю будет равно нулю.
Чтобы прийти к противоречию по всем фронтам.
Поднимите руки, кто понял, что происходит.
Так, окей, неплохо.
Так, ну смотрите, что из этого еще следует?
Из этого следует, что мютер мю с волной транспонира
на ах-b больше либо равно нуля для х из d.
Давайте поймем, почему это так.
Вот и смотрите, пусть вот это будет меньше нуля.
Пусть это будет меньше нуля.
Вот есть вот это неравенство.
Нет, нет, погодите.
Так, есть верхние неравенства, вы правы.
Х из d у нас. Нет, х из d это просто...
х из d из недопустимого множества.
А только из d.
Смотрите, тут... сейчас я выдвину свой гипотез,
и вы скажете, сколько она правомерна.
Вот если эта штука будет меньше нуля,
допустим, то когда мы смотрим на а на мю,
смотрите, у нас вот здесь ограничений никаких нет.
Видно, да?
То есть мы гипотетически можем
раз для какого-то х эта штука отрицательна,
можем просто мю умножить на бесконечно большую константу,
хоть отрицательную, хоть положительную получить,
чтобы все пропало.
Поэтому нам нужно это обязательно оценить сверху,
как что это больше нуля.
Иначе мы получим противоречие с вот этой штукой.
То есть почему здесь обязательно вот эта штука должна быть больше нуля?
Да, прознуление это было для...
Где?
Не-не, смотрите, тут нюанс не в том, что внутренность,
а в том, что солюсейтер выполнен.
То есть мы взяли точку, в которой вот это выполнено.
Нет, вот отсюда следует, что если мы взяли точку,
в которой выполнено условие слейтера,
то в этой точке вот эта штука будет больше либо равна нуля.
Ну вот здесь вот для получения того, что лямбда 0,
мы явно использовали, что в некоторой точке у нас...
Условие слейтера выполняется в точке х...
Не, взяли какую-то точку.
Из того, что она выполняет...
А, я понял, что вы хотите сказать.
Да, наверное, так тоже будет работать.
Смотрите, да, спасибо.
Что взяли точку, в ней выполнено условие слейтера.
Поскольку у нас вот эта лямбда, она от х как бы не зависит.
Это некоторая универсальная константа.
Поэтому взяли...
Ну, мы подставили этот х.
Для этого х нейронизм тоже должно работать.
Но поскольку условие слейтера выполнено, то это отрицательно.
А сама лямбда больше ливра 0 всегда.
Поэтому она 0.
Поэтому теперь вот эта штука...
Ну, зановили, короче, глобально.
Вот, да, спасибо.
Получили вот эту штуку.
Что она больше ливра 0.
Переписали ее как...
То есть это для всех х, в том числе для того х,
для которого условие слейтера выполняется.
Подставили, получили вот такое вот...
Ну, тут просто переписали.
Я думаю, что алгебра здесь прозрачная.
Получили 0.
Понятно, почему 0.
Поведение тяжелее, кто понял, почему 0.
Ну, 0 по тем же самым причинам,
потому что в х волной выполняется слейтер.
Только теперь она у нас выполняется не для неравенства,
а для равенства.
То есть тут как бы на любой вопрос более-менее один и тот же ответ.
Что из этого следует?
Поскольку мы нашли...
У нас есть точка, в которой
наша функция равна 0.
И эта функция непрерывная.
Это значит, что если
вот этот коэффициент не 0,
вот этот коэффициент не 0,
то мы найдем в окрестности точки х
с волной некоторую другую точку,
в которой будет
отрицательный знак.
Это некоторое противоречие с тем, что...
А, ну, собственно, с вот этим, кажется, да?
Громче!
Это?
А, потому что слой слейтер выполняется...
Вот оно.
То есть мы как бы в одном случае пользовались им для неравенства,
а тут мы пользовались им для равенства.
Но в случае, когда мы
изучили вопрос неравенства, мы получили глобальное значение лямбда с волной,
которое здесь уже используем.
Поэтому тут 0.
Дальше используем непрерывность.
И то, что в случае, если
не константа,
то
получим противоречие с вот этим вот утверждением.
Все, получаем. Да, тут а теперь,
значит, если...
Надо докрутить.
Значит, если эта штука 0
теперь, и mu равно 0,
и mu с волной не равно 0,
то значит, нашелся некоторый вектор,
такой, что линейная комбинация
строк матрицы с элементами этого вектора равно 0.
Значит, ранг матрицы меньше p.
А это противоречит тому, что мы
три слайда назад предположили.
Значит, из этого следует, что
наши mu
действительно не 0.
Если 0, то наш весь вектор,
отвечающий за
разделяющий гир плоскость,
зануляется. Это противоречит теореме.
Конец доказательства.
Кто понял, что произошло? Поднимите руки.
Так, ну,
комсикомса, в общем.
Так, ну, давайте, там, 30 секунд,
может быть, кто-то задаст конкретный вопрос.
Почему все это было, да?
Да, давайте, смотрите.
Вот это, да?
У нас вот эта функция, она непрерывна.
И она равна 0 в некоторые точки.
Значит, найдется окрестность,
а она не только непрерывна, но и монотонна.
Важный момент.
Значит, найдется окрестность, где функция
принимает и положительные, и отрицательные значения.
Это значит, что в окрестности
найдется некоторая точка, в которой
вот это скалярное произведение 0 меньше 0.
Причем эта точка, она лежит
тоже в нашем множестве, поскольку
у нас сувейслейтер выполнен,
и у нас есть окрестность.
Окрестность точки х
с волной,
которая целиком в нашем множестве лежит.
Поэтому в этой точке
получаем то, что эта штука меньше 0,
но у нас было
ограничение на то, что для
всех иксов СД выполнено, что эта штука
больше 0. А мы показали,
что есть точка, где меньше 0.
Получили противоречие.
Ок-нек, отлично.
Еще вопросы?
Так, окей, ладно.
Если вдруг они возникнут в процессе
перечитывания или
какого-то применения,
то можно будет их задать.
Теперь, так, сколько там?
А, так это не то.
1.59, отлично.
Как раз 4 слайды на 3 слайды, даже
10 минут, я думаю, успеем.
Теперь, что такое дополнительная
нежесткость? Еще один ингридент
к условиям оптимальности, который надо
получить.
Фусь есть сильная двойственность.
У нас есть решение прямой задачи и
решение двойственной задачи.
Тогда справедлива цепочка
равенств в тирении равенств.
Сильная двойственность есть,
поэтому f0
от x со звездочкой равен g
от лямбда со звездочкой ми со звездочкой.
Это просто определение.
Далее. Вот эта штука
это инфиум нашего лагранжиана
по всем x-ам в точке
лямбда со звездочкой ми со звездочкой.
Тоже определение двойственной функции
подставили.
Поскольку это инфиум по всем
x-ам из d, мы можем его оценить сверху
как значение функции,
которая сядет под инфиум просто в
одной точке, например, x со звездочкой.
Даже у нас лежит в d, все хорошо.
Подставили.
Теперь смотрим, что у нас получилось.
У нас получилось, что здесь у нас
что-то равно 0,
а здесь у нас g
а gt меньше либо равно 0,
а mu gt больше либо равно 0,
потому что это решение,
а значит допустимая точка.
Значит, эта вся история сверху
оценивается f0 от x со звездочкой.
Да, получили странный факт, что
f0 от x со звездочкой меньше либо равно,
чем f0 от x со звездочкой.
А это значит, что у нас везде
стоят знаки равенства просто-напросто.
Что из этого следует?
Во-первых, из этого следует,
что x со звездочкой
здесь является точкой минимума
Лагранжиана. Это нам еще понадобится.
А второе, что
вот эта штука
в точности равна 0.
А поскольку тут у нас
сумма не отрицатель
неположительных значений,
то это значит, что каждая из слагаемых
в точности равна 0.
Да, первое, это x со звездочкой
минимизирует Лагранжиана, это первое неравенство.
Ну и второе, собственно, условие
дополняющей не жесткости,
тут надо английский аналог привести
complementary slackness.
Вот, что каждая
из этих вот произведений
равно 0. Что из этого следует?
Из этого следует, что если у нас коэффициент
при ограничении типа неравенства
больше 0, то
мы находимся на границе,
которая порождает соответствующим неравенством.
Если же у нас
мы находимся внутри множества по отношению
к нашему
ограничению, то соответствующий множество
Лагранжа равен 0.
Важно
понимать, что существуют
примеры, когда и μ,
и h равны 0 одновременно.
То есть не надо
тут делать каких-то
как называется там
чересчур оптимистичных утверждений,
что если одно не 0, то и другое не 0
и так далее. То есть может быть такое, что
что они в общем оба равны 0
и это
то есть надо проверять
именно вот эти все истории.
В итоге
сейчас соберем вместе так называемые условия
хорошего кунутакера или коктеса сокращенно
для произвольной
не выпуклой задачи.
Пусть у нас есть тройка
векторов,
которые являются решением прямой двойственной задачи
и есть сильная двойственность.
Важные сильные условия, которые тут фигурируют,
это наличие сильной двойственности.
Тогда 1, 2, 3
что это такое?
Это допустимость в исходной
задаче и допустимость в двойственной.
Пока никаких сюрпризов нет.
Всем понятно, откуда это взялось?
4, дополнительная жесткость,
которую мы только что получили.
Ну и 5, градиент лагринжана
равен 0.
По х в этих точках.
Мы объяснили
все кроме последнего.
Кто может легко и просто объяснить наличие
вот этого условия?
Смотрите, да.
Тут мы вспоминаем
об этом.
И понимаем,
что поскольку мы уже знаем,
что х от звездочки минимизирует
лагринжан, то есть является точкой минимума,
то мы пользуемся необходимым
условием оптимальности
для безусловной задачи.
То есть ссылаемся на самый простой факт
о том, что если мы знаем,
что точка является точкой локального минимума,
то градиент в ней равен 0.
Ровно этот факт
и является 5 условием.
То есть еще раз,
в конце концов все
свелось к самого наипростейшему
условию оптимальности через градиент
цельевой функции в точке минимума.
В общем,
ровно это тут написано.
Да, смешное замечание,
что в 1951 году
все это было написано
в работах Куна и Таккера.
Это два разных человека.
А потом нашли, что польский математик
Вильям Каруш вывел это все в своем дипломе
в 1939 году, и поэтому
добавили еще Карушу Куну Таккера.
Какое-то время назад это было просто
условие КТ, а потом добавил еще
одну букву К вот к этим двум ребятам.
Теперь для буквы значит, что изменится.
Изменится вот что.
Мы же не из-за этого
страдали за доказательством теоремы
специальной для выпуклой задачи
и условия с лейтером.
Сейчас будем ее активно применять в этом
контексте достаточности условий
ККТ, и получим следующий факт.
Значит, пусть прямая задача выпукла,
и для некоторых пар,
некоторые тройки векторов
выполнены условия ККТ.
Что тогда?
Тогда у нас есть сильная двойственность,
и эта самая тройка является
соответственно решением прямой и двойственной задачей.
То есть мы видим, что
если у нас есть ККТ,
тогда у нас есть
утверждение о том, что те вектора,
которые будут этим условием удовлетворять,
будут одновременно и
нужным нам решением.
Что довольно приятно. Получили инструмент некоторый.
Понятны ли утверждения?
Так, хорошо.
Будем доказывать.
Из первых двух условий ККТ следует,
что х с крышкой лежит допустим множеством.
Это, я думаю, никакой не дай сомнений.
Хорошо.
Из того, что
μ больше либо равно нуля, это наш третий условий ККТ.
Следует, что
лагранжан является выпуклой функцией по х.
Всем ли это понятно?
Понятно.
Поднимите руки, кто понимает,
почему лагранжан в этом случае
будет выпуклым по х.
Так, ну что-то не лез руку.
Ну смотрите.
Где бы найти запись лагранжана?
А вот.
Вот наш лагранжан.
Из чего он состоит?
Высокоуровнево он состоит из суммы трех функций.
Выпуклая функция,
потому что назначен выпуклым.
Здесь у нас стоит некоторая
линейная функция,
независимо от того, что происходит с λ.
А житая у нас выпуклая функция.
Поскольку мы складываем
выпуклые функции с неотрицательными коэффициентами,
то вся сумма будет выпуклой функцией.
И мы складываем три выпуклых функции.
Получаем выпуклую функцию.
Поднимите руки, кто понял теперь, что происходит.
Так, отлично.
Так, возвращаемся к доказательствам.
Так, есть выпуклость по x.
Дальше понятно.
Последнее условие означает, что в некоторые точки
градиент равен нулю.
Эта функция выпукла,
поэтому мы имеем, что наша x-крышка
минимизирует лагранжан.
Идем назад теперь.
До этого мы шли вперед.
Из того, что у нас была точка минимум,
мы получали пятое условие в ККТ.
Теперь наоборот.
Мы имеем выпуклую функцию
и знаем, что в ней
ее градиент в точке x-крышка
равен нулю, значит это минимум.
Подставляем.
Раз, подставляем два.
Пока просто подставим,
ничего не произошло.
Но поскольку тут
из условий дополняющей не жесткости
у нас что следует? Это тоже условие ККТ.
Что эта штука зануляется?
Эта штука зануляется, потому что у нас
это афинные равенства,
в них ноль.
Получаем, что g от λ с крышкой
μ с крышкой равно f0 от x с крышкой.
Получаем сильную двойственность.
И как следствие результат,
что вся эта тройка является решением
соответствующей прямой двойственной задачи.
То есть где нам здесь помогла выпуклость?
Она нам помогла
во-первых, вот здесь.
И во-вторых, вот здесь.
Заметьте, что пока
условия слейтера нигде не фигурируют.
Пока все исключительно
на мощных свойствах
выпуклых функций.
Есть ли какие-нибудь вопросы
по этому утверждению?
Так, ну окей.
Утверждение два.
Пусть для выпуклой задачи
есть условия слейтера.
Тогда x есть решение
в том и только в том случае,
когда найдутся коэффициенты,
для которых выполнена ККТ.
То есть почувствуйте разницу
с тем, что было написано тут.
Тут мы говорим,
пусть у нас есть выпуклая задача
и есть тройка, для которой
выполнена ККТ.
Тогда в этой тройке все хорошо.
То есть это в одну сторону
утверждения только.
Всем понятно, да, что это в одну сторону?
Тут уже
появляется
в обе стороны.
Именно
наличие вот этой вот в обе стороны,
чтобы это было правдой,
требуется выполнение слейтера.
Тут вот некоторые тонкие моменты,
потому что не всегда понятно,
к чему вот эта вот
некоторая приписочка,
которая немного в стороне стоит.
Сейчас будет понятно, почему.
Последний слайд, слушайте,
почти уложился.
Поскольку у нас
есть выпуклость есть условия слейтера,
то мы знаем, что
будет сильная двойственность по той теореме,
которую министы вот так долго доказывали.
И так, про достижимость
я не сильно акцентировал
на это внимание, но в общем, достижимость там будет,
все будет хорошо. Значит,
необходимость следует
сразу же из
отсюда.
Понятно, да?
То есть выпуклость слейтер дали нам
вот это вот
возможность оперировать.
Сказать, что
ну вот, мы бы же показали, когда есть сильная двойственность,
а мы для этого факта вот все расписали,
все хорошо, ККТ будет работать.
Вот.
Ну а
достаточность просто из первого пункта следует.
То есть довесок в необходимость
как раз таки обусловлено наличием условия слейтера.
Фуф. Так, окей.
Мы наконец закончили эту лекцию.
Не очень быстро, но тем не менее.
Значит, что
по теории основные моменты?
Первое, это условия оптимальности для задач
безусловной оптимизации, про градиенты,
про гессианы, не помню,
говорил ли я или нет, но я думаю, что
вы и так все это знаете.
Вот. Про дифференциальные условия
оптимальности важно,
про двойственную функцию надо знать,
что за функция, как ищется, какие
свойства, двойственная задача,
что это такое и зачем она
нужна, что такое сильная двойственность условия
слейтера и условия ККТ.
В следующий раз мы будем
оперируя тем аппаратом,
который был разработан сегодня,
находить двойственные задачи
для различных задач, которые были
рассмотрены ранее
и анализировать то, в какие там есть
нюансы в плане обнаружения
и использования двойственности.
Так, все. Всем спасибо.
В следующий раз продолжим.
