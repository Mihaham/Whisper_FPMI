Блоку про геометрию, скорее всего, всё до конца семестра
включительно будет про неё, вот, ну и по просьбам трудящихся
начнём сегодня прям с самых простых вещей, там что
такое точка и так далее.
Вот, ну нет, это, да, это я загнул, конечно, да-да,
хороший вопрос.
Окей, что такое точка мы определить не будем, но
как с ними работать мы посмотрим.
Значит, ну, во-первых, давайте немножко такую вводную
часть про точность, про то, что в геометрии часто
возникают проблемы с, ну скажем так, точными вычислениями.
Да, то есть, даже если вам надо просто пересечь две
прямые, если у них координаты, скажем, ну какие-то были
целые, там, если прямые как-то заданы с помощью каких-то
целых чисел, то уже при пересечении вы получаете,
ну, скорее всего, дробные какие-то числа, да, в виде,
ну, если у вас коэффициенты были целочисленные, то
точка будет рациональной, ну, там, типа, обе координаты
вражаются дробями.
И это, в принципе, еще не очень страшно, но если
вас просят, например, опустить перпендикуляры с точки напрямую,
то там уже надо извлекать корень, ну, чтобы расстояние
посчитать, и надо извлекать уже корень, и поэтому точка
у вас в точно виде представиться не сможет никак, ну, потому
что там извлечь корень, в любом случае будет какая-то
ошибка погрешности округления, потому что в, ну, например,
и сейчас я просто скажу, да, значит, ну, потому что
мы не можем там корни из чисел, из которых не извлекаются
корни, короче, и рациональные числа мы не можем с призвольной
точностью хранить, в любом случае какие-то погрешности
будут.
Ну, и, например, там, если у нас задача такая, опустите
перпендикуляры с точки на одну прямую и проверить,
что эта точка, которая вот основания перпендикуляра,
лежит на другой прямой.
Да, понятно тогда, что мы не можем просто подставить
вот эту точку основания перпендикуляра в уравнение
второй прямой, ну, потом, ну, и как бы проверить, что
коэффициенты сходятся, потому что у нас уже есть погрешность
и сравнивать, что там это число равно нулю какое-то,
да, там, характеристическое уравнение прямой, если поставить
в него точку, надо сравнивать не с нулем, а, ну, примерно
с нулем, потому что у вас накопилась погрешность,
на самом деле, если вы подставите, то будет что-то типа там
0, 0, 0, 0, 0, 0, 0, 1, 2, 3 и так далее, ну, короче, в каких-то
знаках далеко после запятой будет погрешность, и поэтому
все сравнения, да, если вы выходите там, если вы решаете
все в доблах, то все сравнения надо делать с точностью
до какого-то маленького эпсилона, типа, ну, вы там
возьмем какой-нибудь эпсилон, обычно 10-9 изгодится, и дальше
все проверки делаем с точностью 10-9, чтобы проверить, что
точка лежит на прямой, я не просто проверяю, что,
скажем, ax плюс by плюс c равно нулю, я проверяю, скорее,
что модуль этой величины не больше эпсилона, ну,
где эпсилон какая-то вот точность, которую мы считаем,
то с такой точностью у нас точно все будет посчитано,
вот, поэтому, как бы, если мы пишем в доблах, да, если
мы явным образом вычитаем все координаты, то вот всякие
сравнения надо делать с точностью до эпсилона, ну,
обычно, почти всегда, вот, либо же, да, как правильно
сказали, если у нас задача позволяет, можно решать
ее в целых числах, или же, скажем, там, написать какой-то
свой класс rational, да, класс дроби рациональной, и, скажем,
то есть, пересечение прямых можно будет посчитать как
дробь по x, дробь по y, вот, ну, и дальше с этими дробями
работать, ну, тут уже, в общем, зависит от задачи, я рекомендую
как бы старайтесь не переходить к вещественным типам данных,
то есть, к доблам не переходить, чтобы вот не было проблем
с точностью, что вы понимали, что у вас решение точно
всегда правильно работает, нет никаких ошибок округления,
потому что, ну, там, как вот анализировать, насколько
точно у вас опустился пермедикулярный прямой, ну, Бог его знает,
можно там как-то, но это, короче, неприятно, вот, поэтому,
если можно, пишите в целых, да, или в дробях, если нельзя,
да, если там явным образом надо корни извлекать или
синусы-костинусы извлекать, то, ну, ничего не поделаешь,
придется возиться с точностью, но про нее не забывайте.
Ну, к сожалению, нет, к сожалению, не поможет.
Вот, хорошо, значит, теперь давайте поговорим про стандартные
примитивы.
Ну, то есть, первый примитив – это точка, точка или вектор.
Вот, ну, мы живем пока что на обычной координатной
плоскости двумерной.
Каждая точка задается, собственно, своими координатами по
х и по у.
А, и то же самое, можно любой вектор задать двумя координатами
х и у.
То есть, с одной стороны, как бы, можно извести такую
сущность P, которая одновременно отвечает точке с данными
координатами х и у на плоскости, и она же отвечает вот такому
вектору из точки 0, 0 в точку P.
Собственно, радиус вектор, да, из нуля в эту точку P.
Вот, мы будем как бы их перемешивать, у меня будет
одна структура, которая одновременно будет и точкой
и вектором.
Наверное, с точки зрения хорошего программиста это
кринж, но я буду так делать, потому что так часто удобно.
Ну, потому что как бы мне надо хранить два поля, точка
это или вектор, я в зависимости от необходимости буду считать
точкой это или вектор.
То есть, грубо говоря, у меня будет какой-то структ-пойнт,
где внутри будет два поля х и у.
Ну, пусть, пусть, пусть.
Это уже ваши проблемы, не мои.
Вот, не, х и у, кстати, можно в этих координатах точек,
это можно, х и у, з даже можно, но это спойлер.
Ну, два х не надо, да.
Вот, хорошо, значит, понятно, да?
Значит, дальше давайте скажем, ну, например, как построить
вектор по двум точкам, вот есть у вас одна точка а,
есть у вас другая точка б, как построить вектор между
ними?
Ну, надо там вычесть какие-то координатки, да, конец-минус-начало,
вот.
Значит, можно вести, скажем, оператор минус.
Значит, он принимает две точки а и b, ну и возвращает
понятно, типа там х равно bx минус ах, у равно bx минус
ау.
Давайте я вот так напишу.
Вот, правда же, вроде правда, ну то есть, мы получили
вот такой вот вектор между двумя точками, если бы
мы хотели, наоборот, вектора, скажем, складывать, вот
есть два вектора, скажем, у и в, нам нужна их сумма,
да, то есть, вот строится в них параллограмм, тогда
сумма это будет, видимо, вот этот вектор, у плюс в.
Ну, аналогично, можно написать оператор плюс, который складывает
координаты по х, складывает координаты по у, и получается,
собственно, вот этот вектор, равный диагонали в таком
параллограмме, аналогично, оператор плюс, вот, бывает
еще полезно умножать вектор на константу, вот есть какой-то
вектор v, вы хотите его взять, ну там, раздуть вк раз, нарисовать
вот такой вот вектор, vk, ну тогда давайте напишем оператор
умножения на число, оператор умножения вектора на число
vk, ну и тогда надо просто обе кернаты раздуть вк раз,
да, нормально, ну типа, я спросил, я спросил, вы хотите
это послушать, мне сказали, да, так что, вот, так, ну
хорошо, хорошо, значит, давайте пойдем дальше, давайте посмотрим
на произведения всякие, скалярные, векторные, вот, представьте,
есть два вектора, мы совмешаем их начало, вектор, давайте
по ику я их назову, есть два вектора по ику, мы хотим
найти их скалярные произведения, ну, значит, скалярные произведения,
вот так назову x1, y1, x2, y2, вот, значит, тогда их скалярные
произведения это x1, x2, y1, y2, и оно же равно, значит, если
это вектор a, это вектор b, между ними угол phi, то это произведение
длин векторов, накосим с угла между ними, вот такое
открытие, значит, ну, обычно, да, то есть, если у вас есть
два вектора, посчитать их скалярные произведения,
то есть, как бы, грубо говоря, по умолчанию формула вот
такая, но, конечно, считать лучше так, она просто по
компонентное произведение, координаты, сложения, вот,
но зато, смотрите, что из этого можно извлечь, отсюда
можно извлечь, например, какой у вас тип угла между
векторами, между векторами a и b, зная, на самом деле,
просто знак скалярного произведения, мы понимаем
угол между ними тупой, острый или прямой, то есть, если,
скажем, скалярное произведение больше нуля, то угол phi острый,
то есть, он меньше 90 градусов, на счастье, эта штука равна
нулю, то угол прямой, то есть, равен 90 градусам,
и векторы перпендикулярны друг к другу, но если он
отрицательен, да, если скалярное произведение отрицательно,
то угол тупой, и, соответственно, больше 90, вот, но здесь угол
считается неориентированным, просто угол вот между двумя
векторами, есть какие-то два вектора, в такой картинке
он будет положительным, скалярное произведение
будет положительным, но это просто следует из-за
того, что cos phi такие знаки принимает, если phi острый,
то cos положительный, если прямой, то ноль, если тупой,
то меньше нуля, cos будет, соответственно, да, там картинка
здесь какая-нибудь такая будет, когда они перпендикулярны,
или когда они образуют тупой угол, ну, что-то вот такое,
здесь угол тупой, то есть по знаку скалярного произведения
можно понимать тип угла между векторами. Так, следующее
произведение, я буду дальше говорить всегда векторное,
но на самом деле оно псевдовекторное, я буду линейце говорить псевдовекторное,
у меня будет всегда просто векторное. Это следующее,
это x1y2-x2y1, и оно же можно доказать, что это произведение
длин на синус угла между векторами, вот, где здесь
на этот раз уже угол phi-ориентированный, угол phi-ориентированный в направлении
от вектора a к вектору b, phi-ориентированный угол от a к b, вот, ну, то есть, ну, например,
если у меня, давайте какую-нибудь картинку сделаем, грубо говоря, если бы a был вот здесь,
а b вот здесь, то у меня угол между ними, в этом случае ориентированный угол, брался бы не вот
такой вот, а вот такой вот, ну, типа, потому что я его считаю против часовой стрелки, скажем так,
то есть phi против часовой стрелки, вот, ну, собственно, только при таком понимании угла phi здесь
будет равенство, и это нам дает на этот раз понимание, в каком, как бы, в каком соотношении
эти векторы соотносятся, типа, они образуют левую тройку или правую тройку, в том смысле,
что поворот от а к b, в какую сторону короче, в сторону против часовой стрелки, как на этой картинке,
или в сторону по часовой стрелке. Например, если корמן по часовой стрелке, значит,
против часовой стрелки, будет вот такой длинный, развернутый угол, больше 180°,
и, соответственно, короче, синус будет отрицательный, да, потому что синус,
когда больше 180, он отрицательный, вот. Поэтому по знаку этого векторного произведения, на самом
деле, псевдо-векторного, потому что векторный этот, какой-то вектор в Р3, но не важно,
По знаку этого произведения можно сказать, в какую сторону ближайший поворот одного вектора к другому.
Соответственно, если такое произведение больше 0, тогда поворот атак-б идет против часовой стрелки,
как на этой картинке. Если я встаю сюда, моя цель это повернуть вектор а и совместить его с вектором b по направлению,
то здесь мне нужно поворачивать его против часовой стрелки.
Это случай положительного векторного произведения. Поворот а к b против часовой стрелки.
Ну, кратчайше имеется в виду, конечно, да, кратчайше, кратчайше, спасибо.
То есть поворот-то всегда есть, но вопрос какой из них короче.
Дальше, если вектор равен нулю, это значит, что векторы со направлены или же противонаправлены.
То есть синус равен нулю, когда угол 0 или 180, то есть эта картинка такая.
Либо они просто смотрят в одну сторону вот так вот, либо они смотрят вот так вот.
В обоих случаях будет синус 0, поэтому все, что мы можем сказать, это то, что только они корениарны,
но на одной прямой лежат. То есть они либо со направлены, либо противонаправлены,
но в любом случае коллинеарны.
Ну вот, а если меньше нуля, то значит кратчайший поворот идет по часовой стрелке.
Кратчайший поворот а к b по часовой.
Так, согласны? Вот, хорошо.
Ну давайте еще посмотрим на, что можно сделать с векторным произведением, вот этим вот.
С его помощью можно считать всякие площади.
Ну, например, если мы просто нарисуем такие два вектора, a и b, то что такое псевдовекторное произведение?
Вот в этих терминах, это на самом деле площадь, площадь параллограмма на них натянутого.
Если это a, это b, ну просто ab, длина вектора на длину вектора на синус угла между ними,
это там почти по определению площадь параллограмма.
Вот эта вот площадь, это есть значение векторного произведения.
Ну она может быть положительна, может быть отрицательна, то есть это скорее такая ориентированная площадь,
что если вектор один, ну короче, если они в правильном порядке, то площадь положительная, иначе отрицательна.
Но по модулю в любом случае это будет площадь вот такого параллограмма.
Ну то есть модуль векторного произведения есть площадь параллограмма, площадь параллограмма.
Вот, и с помощью этого можно считать площади, например, всяких многоугольников.
Представьте, у вас есть произвольник, это многоугольник на плоскости, ну что-то вот такое.
Значит тогда можно с помощью векторного произведения считать его площадь, очень просто.
Смотрите, ну я доказывать не буду, потому что не умею.
Давайте сделаем следующее, давайте мы встанем в точку 0,0,
значит давайте я занумирую все вершины многоугольника как-то,
p0, p1, p2 и так далее.
Вот, давайте мы проведем радиус вектора из нуля во все эти точки,
и посчитаем векторное произведение всех пар соседей.
То есть я посчитаю вот это произведение от p0 к p1, это будет там площадь какого-то параллограмма, грубо говоря.
Давайте я сразу скажу так, что я буду считать половину всех этих площадей, чтобы считать площадь этого треугольника.
Ну то есть понятно, что если я проведу такую диагональ, то параллограмма называется на два одинаковых,
и площадь вот здесь вот эта половинка от общей площади.
Поэтому, когда я беру половину вот такого векторного произведения p0 на p1,
я по факту получаю ориентированную площадь такого треугольника.
Дальше я беру вот эти два вектора, получаю ориентированную площадь такого треугольника.
Дальше, p2, p3, получаю ориентированную площадь вот такого треугольника.
Вот. Ну и, как можно заметить, у меня вот эти вот внешние, лишние части треугольников, они как бы все уничтожатся.
Потому что вот здесь вот я провел, его как бы добавил к ответу, а потом, когда p2 превращалось в p3, я вот эту часть всю вычел.
Ну и, соответственно, как бы у меня были вот это с плюсом, это с плюсом, потом это вычилось.
И, короче, можно показать, что все вот эти вот лишние части, которые здесь рисую от нуля к границам треугольника, они все там друг с другом хорошо сокращаться.
И с плюсом останется только то, что внутри треугольника.
Вот. Ну, то есть давайте напишем, что площадь всего, это всего-напросто сумма, ну давайте так, напишу, векторных произведений.
Кросспродакт это называется. Давайте там, кросспродакт. Да, спасибо.
От пар p и p и плюс один процент n для всех и от нуля до n минус одного.
То есть я все пары соседних векторов перебираю, включая вот эти вот два последние, там p последнее и p нулевое.
Я такое векторное произведение тоже считаю от p и n минус один к p ноль.
Все суммирую и получаю площадь.
Вот. Ну, на самом деле, то есть еще раз, да, я сказал, что все вот это вот лишнее, вне границы, вне многогольника, оно возьмется с плюсом, потом с минусом, то есть сократится.
Все внутри будет только с плюсом. На самом деле, не обязательно, может быть, наоборот.
Да, может быть, все, что все здесь возьмется с минусом. Ну, на самом деле, тогда надо написать, что площадь по модулю равна вот этой штуке.
Вот. Значит, это с одной стороны, с другой стороны это будет тогда, на самом деле, ориентированная площадь, ориентированная площадь многоугольника.
Вот. И она заодно, если мы не будем брать ее по модулю, она заодно нам даст в каком-то смысле его ориентацию.
То есть, в каком порядке вот эти вот вершины p0, p1, p2, p3, в каком порядке они обходят многоугольник? В порядке противчасовой или в порядке почасовой?
Ну, то есть, ну, кажется, что s, вот это вот, которое мы так посчитали, больше нуля, если и только если порядок обхода идет противчасовой.
Значит, порядок обхода противчасовой стрелки. Ну, в положительном направлении.
То есть, ну, грубо говоря, если бы я инвертировал порядок обхода всех вершин, да, сделал бы его не в таком порядке, а, наоборот, ну, как бы в противоположном,
тогда у меня все площади вылезли бы с противоположным знаком, потому что я поменял порядок всех пар средних векторов.
Соответственно, площадь бы поменяла знак, но это как раз значит, что там в каком направлении я похожу многоугольник.
Вот так вот или вот так вот. Иногда бывает полезно понять, в каком именно порядке он ориентирован.
Вот, если нет, то можно просто это посчитать, взять модуль, это будет площадь многоугольника.
Ага.
Она же может быть сначала найдет почасовую, потом обратно?
Ну, собственно, тут так и происходит, да? Ну, сейчас.
Это, ну, это хороший вопрос. На самом деле, смотрите, что значит по или против собой, да?
То есть вот как здесь, мы сначала типа туда вращаемся, потом туда, потом сюда.
Сейчас скажу.
Ну, вот типа вот, да, вот типа вместе. На самом деле, что такое по или против?
Это значит, что вот если вы возьмете, короче, если вы в гвоздик поставите внутреннего угольника
и начнете, проведете вот такую вот веревку, короче, ниточку вот такую сделаете,
начнете ею проводить по границам многоугольника,
то у вас в конце ниточка, она как бы сделает оборот вокруг этого гвоздика.
Ну, сейчас прям очень неформально, но как есть.
То есть еще раз, вот здесь гвоздик, вы ниточку ведете вдоль границы,
у вас ниточка вот так вот закручивается, и в итоге делает поворот 2p,
полный поворот круга вокруг этого гвоздика.
Вот, но если поворот был противчасовой, то, собственно, и обход был противчасовой, иначе почасовой.
Ну, он может дергаться как-то, но рано или поздно вы все равно, как бы вы, ну, вы из этой точки, вы обходите,
то есть представьте, что вы человек вот здесь стоите, вы смотрите глазами вот так вот вдоль границы многоугольника.
Вот так вот просто идете, иногда у вас взгляд туда-сюда дергается, как вот здесь, да, скажем.
Сначала, так, ну тут плохая картинка, ну вот, не знаю.
Ну, что-то вот такое, вы сначала вот здесь вот смотрели туда, на эту границу,
потом начали смотреть вниз, то есть, ну, иногда дергается.
Но суммарный вот этот вот обход, когда вы, когда вы всю ниточку вокруг всего многоугольника проведете,
она полный круг сделает.
Не последний, а суммарный поворот, суммарный вот поворот всех углов, которые вы делаете.
Можно сказать, что это определение просто?
Ну, можно, но я, я не знаю, ну, типа, блин, может быть.
Так, ну вот, хорошо, значит, это был первый метод, это метод треугольников.
Метод треугольников. Как подсчитывать площадь многоугольника?
Теперь давайте метод трапеции, тоже бывает полезно.
Метод трапеции.
Хорош, хорош, бывает.
Сейчас, давайте я сначала скажу, потом, потом скажу, когда он будет полезнее.
Значит, здесь тоже основано на том, что мы будем какие-то суммы брать с плюсами,
какие-то с минусами, и неправильные будут сокращаться.
Ну, давайте я вот что-то простое нарисую.
Значит, что я сделаю?
Я опять буду обходить все вершины многоугольников в каком-то порядке
и буду брать площадь вот такой вот ориентированной трапеции.
Значит, если у меня взяты две соседние точки P и P плюс один,
то я рассматриваю такой вектор из предыдущего в следующего
и считаю ориентированную площадь вот такой вот трапеции.
Так.
То есть, соответственно, если у меня, грубо говоря,
если она идет в положительном направлении в порядке возрастания х,
они упорядочены, то она будет с плюсом, иначе будет с минусом.
Так, скажите, пожалуйста, как мне посчитать площадь такой трапеции?
Ой, ну это, конечно, оверкил.
Да-да-да, нужна, видимо, какая-то площадь трапеции.
О боже мой.
Вот там, где у ППИ и у ППИ плюс один.
Да, вот давайте, значит, площадь трапеции, это полусумма оснований,
если это а, это b, да, на высоту, а плюс b на h.
Вот это вот будет, получается, h.
Вот.
Ну и что такое а и b?
А и b это, получается, x координаты,
парадон, y координаты наших точек, да, а b это y координаты
вершин многоугольника, y координаты вершин,
а h это, получается, разность x координат наших точек, разность x координат.
Ну и вот как раз, если мы просто берем ПИ плюс один минус ПИ,
то это будет с плюсом, ну то есть как бы, как раз из-за того,
что у нас есть здесь разность, я, скажем, вычитаю следующую,
ну короче, из следующей предыдущую, короче, не важно, да,
то есть если взять вот так вот, следующий минус предыдущую,
то есть h это ПИ плюс первая точка х, минус ПИ третья точка х,
потом вы все это складываете, получается как раз все как надо, да, да, да, да.
Вот.
Ну типа, ну вот если картинки прислать, то получится, честно, честно.
Вот, значит, чем это может быть полезнее?
Значит, это может быть полезно, когда у вас многоугольник такой клетчатый,
в том смысле, что все его стороны параллельны осям координат.
Вот, например, у вас какой-то такой многоугольник,
какой-то такой конструктор, вот, и все стороны параллельны одной из двух координат.
Тогда у вас все трапеции прощаются в прямоугольнике.
Ну, здесь, на самом деле, все было бы в целых числах,
у вас вектор на произведении всегда положительный, но, извините,
в смысле, если и коренаты были целые, то и вектор тоже целый.
Короче, бывают задачи, где, ну, как бы, смотрите, у прямоугольников у вас все понятно,
у них прямые стороны параллельны осям координат, здесь все здорово.
А когда вы рассматриваете треугольники, у вас треугольники получаются такие косые,
у них всякие вот эти радиус-векторы, они бывают всякаразно направлены, не очень приятно.
Если у вас, например, задача такая, что, ну, там, не знаю, например, у вас есть какая-то сетка,
и в каждой клетке написано какое-то число,
и вам надо посчитать сумму чисел, записанных вот здесь, вот, внутри всего многоугольника.
Тогда треугольниками непонятно, как это суммировать,
потому что непонятно, какие числа попадают в треугольник,
а здесь в трапециях очень понятно, какие числа попадают в треугольники, в эти, в трапеции, то есть в прямоугольники.
Ну, и они точно так же можно складывать, их вычитать.
Вот. Ну, короче, что больше нравится, то и делайте.
А эти площади в рандомном порядке, если точка в рандомном порядке?
Точно в рандомном порядке.
Ну, вот, не вот так, но следовательно.
Нет, в таком случае мы даже не понимаем, что такое многоугольник.
Если у вас просто на плоскости разбросаны вершины, точнее, точки,
и вам сказано, что они в каком-то порядке образуют многоугольник,
то непонятно, извините, а что у вас за многоугольник,
потому что по данному набору точек многоугольник может выглядеть там, ну, многообразно.
Вот, не знаю, вот, например, у вас вот такие пять точек.
Как тут можно нарисовать многоугольник?
Давайте, как-нибудь вот так.
Ну, можно вот так вот, вот что-нибудь, такое, такую галочку сделать.
А можно сделать более-менее что угодно другое, да?
Ну, вот такое, например, и какой из них, ну, непонятно.
Поэтому у вас многогольник всегда задается на самом
деле ломанной в порядке обхода границы, иначе никак
его не задашь.
Нет, прям просто координаты, да, да, да, да, чтобы было
ориентировано и чтобы с правильным знаком просто
координаты.
Но если мы знаем, что он выпыхнет, он там однозначно
определяет.
Ну если выпыхлый, то да.
И тогда слабо отнести.
Ну если у вас просто точки, и вы знаете, что они образуют
границу выпыхлого многогольника, то надо сначала определить,
в каком они идут порядке.
Вот здесь в любом случае, здесь я активно на порядок
опираюсь.
Я говорю, что у меня есть первые, вторые, третьи и так
далее.
Вы сначала определите порядок какой-то сортировкой по
углу, чтобы понимать, в каком порядке они идут, потом
запускаете то же самое.
Вот.
Хорошо.
Значит, ну про точки вектора, наверное, все.
Давайте к прямым переходить.
Прямая.
Как хранить прямую?
Ну я предпочитаю такой способ в виде трех, в виде трех
индексов ABC, в виде трех координат ABC.
Потому что если хранить в виде х равно кх плюс b,
то понятно, что там какие-то прямые не получатся.
Хранить типа вертикальные, кажется, не получается.
Да, потому что у не является функцией от х.
Вот.
А в такой виде любую прямую можно представить.
Возможно, занулив а, возможно, занулив b, но любая прямая
имеет такое представление.
Вот.
И более того, если у вас исходные координаты точек
были целочисленными, и вы хотите, ну вот, скажем,
задача, да, у вас есть две точки по ику, вы хотите
по ним провести прямую.
Тогда можно показать, что если у этих точек координаты
целочисленные, то можно взять такие целые ABC, чтобы
эта прямая через них проходила.
Ну давайте это сделаем.
Давайте скажем, что эта точка x1, y1, эта точка x2, y2.
Значит, тогда я утверждаю, что можно построить прямую,
да, вот такое уравнение прямой со следующими коэффициентами.
Так, ну сейчас что-то напишем и проверим, работает это
или нет.
Я утверждаю, что если взять такие ABC, то у вас получится
уравнение прямой, конкретно проходящее через эти две
точки.
Вот.
Ну как-то проверить.
Если не верится, то давайте просто подставим с данными
ABC вот эти x и y в уравнение, проверим, что всё получается.
Ну давайте x1 подставлю, x2 аналогично.
Значит, если я подставлю сюда x1, сюда y1, сюда вот
эту вот штуку.
Вот.
Ну что, Палыч, у меня будет x1, y1 с плюсом здесь, с минусом
здесь, поэтому вот это вот и вот это вот сократилось.
x1, y2 с минусом здесь, с плюсом здесь сократилось, ну и x2,
y1 с плюсом здесь, с минусом здесь тоже сократилось.
Получился ноль.
Вот.
Если вторую точку поставить, будет то же самое.
Ну типа того, да, ну как бы я, да, на самом деле,
да, но я сразу выписываю решение, чтобы не возиться
с коэффициентами.
Вот.
Хорошо.
Теперь давайте про всякие характеристики прямой
ещё разберёмся.
Вот есть прямая, задаваемая таким уравнением.
Давайте определим её вектор направляющий, например.
Давайте определим вектор, сонаправленный с нашей
прямой, ну, колениарной нашей прямой.
Значит, какой вектор будет?
Ну, например, минус BA, да.
Значит, минус BA будет сонаправлен с нашей прямой.
Почему?
Ну, потому что если какая-то точка x, y лежала на прямой,
если я к ней прибавлю этот вектор, то есть напишу
x минус B и y плюс A, можно показать, что если для x, y это уравнение
было верно, то и для этой точки тоже будет и верно,
поэтому эта точка на прямой, а значит L это разность между
какими-то двумя точками, значит это направляющий
вектор.
Вот, нет, я, наоборот, предпочитаю сначала сделать эту штуку,
потом вывести нормаль.
Вот.
Значит, дальше я утверждаю, что когда мы знаем направляющий,
я могу сделать нормальный вектор, то есть вектор перпендикулярный
прямой.
Значит, это что будет?
AB, да.
Ну, просто потому что он артагонален вот этому,
а это вектор вот такой вот.
Как правило, что они артагональны, надо посчитать скалярные
произведения, минус AB плюс BA, как раз ноль.
Вот они перпендикулярны, поэтому это нормаль.
Вот.
Ну, если надо, да, если надо, мы можем этот вектор, если
прям очень надо, точнее, мы можем этот вектор нормировать.
Да, то есть у нас, как бы, довольно часто будет нам
хотеться, чтобы n было единичным нормальным вектором, ну
и вообще, обычный как-то, как-то, вектор все-таки единичный,
да, задающее направление, они обычно единичные.
Поэтому, чтобы теперь этот вектор нормировать, мне
нужно поделить вот эти вот координаты на длину этого
вектора.
Да, и можно сказать, что вместо вектора AB можно
написать A делить на корень за квадрат плюс B квадрат,
и B делить на корень за квадрат плюс B квадрат.
Да, это будет уже единичный нормальный вектор, единичный
нормальный вектор.
Вот.
Так, хорошо, теперь давайте научимся опускать перпендикуляр
из точки на прямую, то есть точка, то есть прямая задаваемая
таким-то уравнением.
Я хочу найти две вещи, во-первых, хочу найти расстояние
от точки до прямой, во-вторых, найти, ну, основание этого
перпендикуляра, то есть найти длину вот этого отрезка
и найти, что это за точка Q, и являешься по факту
проекции точки напрямую.
Вот, ну, длина расстояния от точки до прямой считается
вот так вот.
Вот.
Ну, и здесь как раз вот, в частности, всплывает этот
корень A квадрат плюс B квадрат, и, как бы, потенциально мы
бы могли, вот здесь, когда строили прямую, вот в момент,
когда мы строили прямую, скажем, по двум точкам, мы
можем вот, скажем, в самом начале поделить A и B на корень
за квадрат в сумму квадрат, сделать нормальный вектор
единичным, и тогда уже ни на что делить не придется.
Вот.
Но, в общем случае, если мы это не сделали, то надо
поделить на корень из суммы квадратов A и B.
Вот.
Значит, почему это так?
Ну, давайте напишем, что, что такое Q, да?
По факту мне нужно к П прибавить нормальный вектор,
потому что вектор перпендикулярный прямой – это нормальный
вектор, но мне его нужно добавить с каким-то коэффициентом,
скажем, к.
То есть, мне нужно добавить вектор kn, чтобы попасть на
прямую.
То есть, у меня, скажем, пусть была точка вот здесь вот
xy, на P это xy, я к ней добавляю вектор kn, получаю точку
с коэффициентом, с координатами x плюс ka, y плюс kb.
Вот.
И мне хочется, чтобы теперь эта точка Q попала на прямую.
То есть, я сдвинулся вдоль нормального вектора на
какой-то коэффициент, попадаю в точку Q, я хочу, чтобы Q лежала
на прямой.
Ну, давайте, типа, сюда подставим, и все у нас получится.
Значит, я хочу, чтобы выполнилось вот такое вот равенство.
Вот так вот.
Ну и, собственно, отсюда все получается.
Отсюда получается 600k на…
Так, что-то странное.
А мы можем вектор нормального умножить на расстояние?
Ау?
Вектор нормального умножить на расстояние.
Ну, я так и делаю, вроде.
В смысле, и вливается просто ориентированно на расстояние,
и мы вроде не прямые?
Не-не-не, это я доказываю, почему-то верно.
Это вы уже как кунайте, я доказываю, как-то форму
уберется.
Так, вот это вот безобразие равно минус ax, минус by, минус
c.
Значит, k равно минус ax, минус by, минус c на квадрат
плюс b².
Вот.
Значит, мы знаем, с каким коэффициентом надо взять
нормальный вектор.
Ну, а дальше мы знаем, что длина нормального вектора
у меня – это корень за квадрат плюс b², да, если я ее
не нормирую.
Если у меня нормальный вектор произвольный, не обязательно
единичной длины, то его длина вот такая.
Ну, а значит, расстояние dist – это что такое?
Это просто расстояние, ну, длина отрезка pq.
Это есть просто длина вектора kn.
Но это есть как раз произведение, да, вот это штуки на эту.
Поэтому один корень из знаменателя уйдет.
Но здесь нужно написать модуль, потому что я беру
длину отрезка, как раз получается ровно вот это вот.
Согласна?
Чудно.
Значит, ну, расстояние нашли.
Ну и заодно мы поняли, как находить эту самую q.
Мы поняли, как находить проекцию.
Надо просто взять нормальный вектор n, координаты которого
мы знаем, где-то там вот тут написано, и добавить
его к p с коэффициентом k, где k вот тут тоже написано.
Поэтому мы не только расстояние знаем, но и основание перпендикуляра.
То есть мы нашли проекцию точки напрямую.
Так, из прямых мне осталось научиться пересекать прямые.
Представьте, есть две вот такие вот прямые.
Вам надо найти точку их пересечения, ну или сказать,
что там прямые параллельные или совпадают.
Тогда точку однозначно определить нельзя.
Вот.
Ну, чтобы это сделать, на самом деле, надо просто
решить вот такую систему уравнений.
Сейчас я покажу, как это делать проще всего.
Значит, это не гаус, как может показаться на первый
взгляд, потому что его, а?
Нет.
Потому что в гаусе надо ифать, грубо говоря.
Если у вас a1 равно нулю, тогда поделим a1, ну и так далее.
Давайте крамером решим.
Крамер делает следующее.
Он переписывает нашу систему в таком вот виде.
И дальше он считает такие три определителя.
Первое это определить вот этой обычной матрице.
1b2-a2b1.
Дальше определитель.
Это мы столбец свободных квестенентов
поставляем на место первого столбца.
У нас получается минус c1b2
плюс c2b1.
И наконец последнее.
Тогда мы столбец свободных квестенентов
поставляем на место второго столбца.
Будет минус a1 c2
плюс, ну видимо, a2 c1.
Ну и так же считаем определители.
Значит, я тогда утверждаю, что
значит, если дельта это ноль,
тогда прямые и параллельные не совпадают.
Прямые и параллельные
или совпадают.
Но это понятно, потому что не параллельные не совпадают.
Если у них коллинеарно направляющие векторы,
то есть то же самое у них коллинеарная нормаля,
коллинеарное означает, что у них вектор на произведении ноль,
Но это в точности вектор на произведении нормалей,
дельта давайте напишем, что это
векторное,
ну псевдовекторное произведение
нормалей.
И соответственно оно ноль ровно в том случае,
когда они коллинеарные,
ровно в том случае к paddle и main taxi
ровно в том случае, когда прямые и параллельные не совпадают.
Ну если дельта не ноль...
как ифнуть что дельта ноль или что а вот эти два но давайте чуть позже давайте
сначала точку точку построю значит тогда xy это
xy точка пересечения это дельта 1 делить на дельта дельта 2 делить на дельта вот
ну собственно метод крамера либо можно проскать там вот возьмем такие xy подставим
в системе ровня и проверим что они подходят если не верится вот метод хорош тем что еще
раз повторю да в отличие от метода гаусса где нужно найти из этих двух не нулевой то есть как
короче привести вот эту матрицу к какому-то виду ступенчатому нам надо понять какой из них не ноль
поделить строчку ну и так далее что-то вычитать короче долго а так просто формула готова у вас
вот уже крамеры вам просто раздает коэффициенты кардината обеих короче кардината точки как
проверить вот в этом случае как разделить параллельно совпадают давайте подумаем
ну когда они совпадают вообще они совпадают если у них уравнение отличаются умножением в
константу а то существует такая значит прямые совпадают если только если существует какая-то
константа к ну такая что давайте напишу так тройка а1 б1 ц равна тройки к а2 к б2 к ц 2
ну потому что что значит они совпадают значит множество решений вот такого уровня не одинаковая
это может быть только в случае когда ну как бы уравнение отличается 42 умножения ну короче у них
эти самые короче отличается умножение на константу вот только в этом случае не могут задавать
но это уж как-то можно сделать наверное не умею ну если научите буду буду признателен здесь я не
умею фать не фать подумайте не знаю не знаю так тут согласны совсем хорошо тогда идем дальше
значит последний примитив у нас окружность окружность но окружность я храню просто центром и
радиусом но есть точка ц является центром окружности и величина р является ее радиусом
вот ну здесь есть кажется два вопроса всего давайте научимся пересекать прямую окружность и две
окружности между собой во первых как пересечь окружность и прямую узнать вообще они пересекаются
или нет значит тут есть три случая как может прямая соотноситься с окружностью первый случай
пересекаются второй случай они касаются третьи случай когда не вообще не пересекаются разбирается
это очень просто надо просто посчитать расстояние от центра до прямой д если это
расстояние д меньше радиуса то пересекается если равно радиус а то касается все больше то не
пересекается первое что я делаю это считаю д как расстояние от центра окружности до прямой
прямой l, если d больше, чем радиус, то пересечений
нет.
Дальше я скажу следующее, давайте я точкой h обзову
основание перпендикуляра, но благо я уже умею опускать
перпендикуляры, так вот пусть h это основание перпендикуляра
Дальше если d равно радиусу, то h это единственная точка
пересечения, то я напишу так return h, но у меня есть единственная
точка пересечения, это точка касания, иначе в последнем
случае d строго меньше, чем r, точки пересечения две,
давайте найдем их координаты, такая окружность, такая
прямая, мы знаем c, мы знаем d, мы знаем h, мы знаем радиус
r, более того мы знаем, направляющий вектор это прямой, тогда
можно просто теперь Пифагора написать, понять чему равна
длина вот этого отрезочка, это ясное дело r квадрат
минус d квадрат, длина вот этого катета r квадрат минус
d квадрат, ну и все, а дальше мне нужно от h влево и вправо
вдоль этой прямой, то есть вдоль направляющего вектора
отступить вот такое расстояние, вот, ну короче не буду дописывать,
если у меня есть скажем нормированный единичный
вектор нормалия, не нормалия, а направляющий вектор прямой
нормированный, то мне нужно просто к h добавить плюс
минус a на вот этот корень, ну при условии что a нормированный,
то есть длины один, иначе надо еще поделить на его
длину, чтобы длина катета была правильной, вот, ну
и в этом случае у меня получается две точки, две точки пересечения
вот эта и вот эта, я их обе нашел, они как раз по обе
стороны от h лежат, вот, кажется так, значит вроде это лучше
всего, ну то есть как бы можно было решать эту задачу
куча разных способов, можно было сказать, окей, у меня
есть уравнение окружности, это там что-то типа вот такого,
да, сейчас мы к этому как раз перейдем, есть уравнение
окружности, есть уравнение прямой, одно из них квадратное,
другое линейное, давайте выразим x через y, поставим
туда, решим через дискриминант, найдем корни квадратного
уравнения, это не очень хорошо, потому что, ну да, там больше
точность будет теряться, вот, а здесь чуть-чуть получше,
короче, вот, ну и давайте подчеркну, что вот эти места,
где я сравниваю d и r, они конечно идут с точностью
потому что d я точно посчитать не могу, я могу только там
приближенно даст точность до то скольких-то знаков,
поэтому, когда я его проверяю на равенство, на самом деле
я, ну как бы лучше его проверять точностью до erosion, потому
что равенство у вас, скорее всего не будет, расстояние
от прямой до, от точки до прямой, скорее всего будет
какое-то там с ошибкой округления, потому что вы там корень
извлекаете, ну короче там, скорее всего, не будет
никакой точности, вот, ну а и при этом, скорее всего,
идет касание, то есть, у вас если они не намножились
отличаются там на 10 минус 10 тогда скорее всего это именно касание и вы считаете что не равно только из-за ошибок
окурления поэтому если они отличаются не больше чем на эпсилон тогда вы считаете что у вас касание и одна точка только
вот нормально хорошо теперь две окружности давайте присягнем
давайте так
сейчас еще раз что куда перенести
я понял вот эти оба должны быть нули тогда не совпадают да я понял я понял я понял
да ну хорошо утверждаю я я честно говоря сход сходу не понял почему-то верно короче
утверждает что прямые совпадают если только если вот эти штуки нули оба одновременно
да ну или кто-то из них 0 да да ну я понял я понял ну типа из того что это равно
не следует что там ц1 на б2 равно ц2 на б1 ну ладно короче бог с ним ну я ok ok ok говорят
правда я верю ладно хорошо отлично а нет ну в смысле если если все нули имеется
вы туда так теперь давайте окружность пересечем наконец вот ну давайте я напишу систему равнений
сначала мне нужно найти все решения такой системы равнений давайте я сделаю магию давайте
вычту одно равнение из другого значит давайте скажем из первого вычтем второе тогда у меня
квадраты по x и по y сократятся останется ой сейчас будет больно значит x на минус 2 x 1
плюс 2 x 2 дальше плюс x 1 квадрат минус x 2 квадрат плюс y на минус 2 y 1 плюс 2 y 2 плюс
y 1 квадрат минус y 2 квадрат ну еще r к я тоже принесу влево будет минус и рай так
пардон здесь да все правильно минус r 1 будет плюс r 2 квадрат вот да такие дела на все я
теперь утверждаю что чтобы решить изначальную систему достаточно решить систему из вот это
этот Commerce в уравнении чтобы решать систему чтобы решать систему 1 и 2 ну короче
она эквивалентной системе 1 и 1 минус 2 легко понять с любое решение этого решение этого
и наоборот любое решение этого решение этого поэтому теперь я свел на самом деле задачу перечень
двух окружностей к задаче перечение окружностей прямой потому что это уравнение прямой да но
линейная по x по y, а дальше какая-то большая там константа, но это как константа c просто будет.
Вот поэтому теперь достаточно пересечь, достаточно пересечь окружность и прямую.
Ну вот. Вроде все. Кажется, здесь единственный может быть тонкий момент, что когда вы
вычитаете одно из другого, у вас получается, например, ну вот короче, когда это не прямая,
когда оба коэффициента при x и при y нули, иначе это прямая. Вот когда может быть такое,
что здесь 0 и здесь 0, только в случае, когда у x1 равно x2 и y1 равно y2, то есть когда окружности
концентрические, вот тогда они либо совпадают, либо они не пересекаются. То есть единственный
плохой случай, такого почти никогда не бывает, это даже не надо отдельно ифать, но для формальности
надо сказать следующее, что единственная проблема бывает, когда это не уравнение прямой, это бывает
в случае, когда оба коэффициента при x и при y нули. Это только в случае, когда x1 равно x2,
y1 равно y2 происходит. То есть окружности либо вот обе одинаковые, либо просто концентрические.
Ну и тогда понятно, в этом случае они, как бы, пересечение равно любой из окружностей, в этом
случае они не пересекаются. Ок? Прекрасно. Ну вот, вроде с примитивами разобрались,
можно что-то еще сделать. О боже мой, Господь с вами. Нет, я думаю, что вы интегрировать
сами умеете. Периметр еще интереснее. Нет, спасибо. Вот, давайте поговорим про
триангуляция немножечко. Триангуляция. Значит, вообще штука очень полезная для моделирования,
ну, обычно для моделирования поверхностей. Представьте, у вас есть, не знаю, какая-нибудь гора,
и вам надо ее как можно более точно апроксимировать. Ну понятно, вы не можете хранить какое-то вот там
гладкое нечто в памяти компьютера. Лучше, что мы можем сделать, это как это апроксимировать. Ну
давайте там довольно много поставим точек на этой поверхности и разобьем на маленькие такие
треугольнички. То есть мы можем апроксимировать произвольную поверхность маленькими треугольниками.
Ну и типа, если у нас достаточно высокая частота дискретизации, если у нас очень много точек,
если у нас очень много треугольников, то в целом от того, что вы, ну короче, вот такую выпуклую
горку превратите в маленький треугольник, вы особо не потеряете рельеф. У вас она будет,
у вас вся поверхность будет довольно точно передаваться такими треугольниками. Вот. Ну
примерно так оно кажется и делается. То есть всякие поверхности, когда моделируются, они просто
дискретизируются до треугольников. И потом с треугольниками работать сильно проще, чем с чем-то
гладким, не пойми каким. Вот. Ну давайте, значит, частично про треангуляции что-то посмотрим. Давайте
посмотрим на треангуляции многоугольников. Для начала. Еще раз смотрите. В горе,
значит, что такое гора? Это... Нет, это не многоугольник, это на самом, ну то есть это я буду,
это плоский случай будет, то он на самом деле трехмерный. Это разные вещи. Это пока просто была
мотивация, почему-то треангуляции в принципе хорошие. Давайте пока частно более простой случай с
многоугольниками поделаем. Там на самом деле надо делать это в 3D. Мы до этого дойдем, но ближе к
концу. Короче, что-то подобное будет. Мы это сделаем еще, но позже. Вот. Пока давайте просто про
многоугольник поговорим. Значит, ну вот есть какой-то многоугольник. Возможно не выпуклый.
Что такое вот треангуляция? Это проведение в нем каких-то диагоналей так, чтобы все разбилось
на треугольнике. Да, значит, ну здесь там надо сказать, что диагонали у меня не пересекаются по
внутренностям своим. Они лежат строго внутри многоугольника. Ну и, короче, вот это... Да,
все правильно. Нет, любые простые многоугольники, у которых граница не сам пересекается. У любого
многоугольника есть треангуляция. Мы сейчас будем доказывать еще. Вот. Еще раз, треангуляция по факту
это просто покрытие многоугольника не пересекающимися треугольниками. Ну, они только по
сторонам пересекаются. Только по границам. Вот. Причем, смотрите, мы не хотим вот таких вот случаев...
Давайте сразу плохой случай нарисую. Как-то вот так вот, если у меня есть. То есть, если я провожу
вот такой отрезок и на нем лежит какая-то другая вершина, то я считаю, что такой отрезок,
такую диагональ проводить нельзя. Ну, потому что, короче, на самом деле надо было бы сделать вот так,
вот так и вот так. Это будет не треугольник, потому что на нем будет лежать какая-то точка. Я хочу,
чтобы внутри треугольника на его границе никаких других вершин не лежало. Вот. То есть,
диагональ, которую я могу проводить, это отрезок между не соседними вершинами. Диагональ.
Ну, смотри, ну, как бы тут можно по-разному. Можно сделать вот так вот и вот так вот.
Да-да-да. Диагональ – это отрезок, соединяющий не соседние вершины,
лежащий внутри многоугольника. Причем на нем нет других вершин многоугольника.
На нем нет других вершин многоугольника. Да, не является. Но у меня не является.
Вот. Ну и наша задача с помощью, то есть, провести какие-то такие диагонали. Так вот,
разрезать многоугольник на треугольнике. Вот. Ну, не знаю, упражнения, что ли. Можно
показать, что если в многоугольнике у вас n вершин, то в любой триангуляции ровно
n-2 треугольника. Значит, если в многоугольнике n вершин, то в любой триангуляции n-2 треугольника.
Ну, например, это можно через сумму углов сделать, потому что по факту я просто разрезаю многоугольник
на треугольнике, поэтому сумма углов при всех вершинах у меня сохраняется, а сумма углов
треугольника это p, а мы знаем, что сумма углов многоугольника это как раз p на n-2. Поэтому у меня
обязательно должно быть n-2 треугольника. А, ну не знаю, ну тогда в другую сторону. Ну короче,
да, да, какая-то индукция. Согласен. Ладно, ладно, ладно. Поэтому я говорю упражнения. Как-то это
делается. Вот. Ну, давайте теперь научимся строить какую-то триангуляцию многоугольника. Пока просто
какую-то. Для этого мне нужно еще одно вспомогательное определение. Значит, что такое ухо? Мы сейчас будем
отрезать многоугольником уши. Что такое ухо? Это вот такая вот штука. Так я нашел рыбку.
Это вот такой треугольник, который можно, грубо говоря, безопасно отрезать. Вот. Значит, это
треугольник, который можно безопасно отрезать. Формально, что это такое? Это треугольник,
образованный тремя последовательными вершинами. p-1, p и p-1. Да, такой, что вот этот отрезок является
диагональю. Ну, кажется, все, да. То есть, это просто три последовательные такие, что между ними
проводится диагональ. В частности, что это значит? Раз это диагональ, то в частности у меня не может
быть вот таких вот никаких заходов других вершин, других там сторон. Никакие стороны не могут
пересекать вот этот отрезок. Потому что иначе, но это была бы не диагональ просто. Она в этом случае
не целиком лежит внутри многоугольника. И даже более того, у нас не может быть никаких других
вершин на этом отрезке, потому что, ну, просто по определенной диагонали. А это была бы не
диагональ. Ну, как бы, это тогда неправильное. Ухо его нельзя отрезать, потому что у меня
многоугольник распадается на два несвязаных. Мы такого не хотим. То есть, ухо это именно то,
что можно отрезать, многоугольник останет, ну, как бы, сохранить свою структуру, только к нему вот
еще довешена с какой стороны ухо. Поэтому всего такого не бывает. И ухо это просто вот такой
треугольник. Давайте напишем, да, что это треугольник P-1 P и P-1, где P-1 P и P-1 это диагональ.
Вот. Ну и наш алгоритм будет, на самом деле, у многоугольника с катюшей их отрезать по одному.
Отрежем одно, у нас уменьшилось количество вершин, отрежем другое, уменьшилось количество
вершин и так далее. Да. Значит, утверждение, утверждение, что, коль скоро n хотя бы 4,
что если количество вершин многоугольника хотя бы 4, тогда в многоугольнике есть хотя бы два уха.
На многоугольнике есть хотя бы два уха, хотя бы два уха, не пересекающиеся по внутренностям.
Вот как тут слитно или раздельно? Мне кажется, раздельно, потому что есть зависимое слово.
Не пересекающихся по внутренностям. Вот. Давайте докажем.
Не, не это я сейчас буду доказывать, не почему там через пробел.
Теорема. Да. Доказательства. Давайте базы на равно 4 сделаем.
С точки зрения триангуляции четырехугольников есть всего два. Выпуклый и не выпуклый. Такая галочка.
В обоих случаях я могу нарисовать триангуляцию, ну и соответственно там будет два уха.
Здесь, например, могу нарисовать такие два уха. Вот одно, вот другое. Понятно, что оба треугольника
это уши, потому что это три последовательные вершины такие, что две не соседние соединены диагональю.
Значит, это уши и здесь вот это два треугольника тоже уши. Вот. Значит, дальше переход. Давайте
предположим, что для всех многоугольников с меньшими числами вершин мы все доказали. Теперь
давайте для N-угольника это делать. Ну вот есть какой-то N-угольник. Давайте мы выберем его какую-то
вершину P, при которой угол меньше P. Почему такое есть? Потому что сумма всех углов P на N-2.
А я не доказываю. Хорошо, то есть может не быть? Хорошо, окей, давайте тогда я не буду говорить,
что я доказываю существование триангуляции, я буду строить алгоритм ее построения. Вы можете
сходу сказать почему существует триангуляция? Ну вот я примерно то же самое хочу сделать. Окей.
Да вообще, да, что-то я прям как-то это. Нет, это мы сейчас будем делать. Это я как раз сейчас буду
рисовать. Понятно, да? То есть якобы доказываю с другого конца. Ой, ой, ой, ой. А по-другому никак нельзя
такать сумму углов P на N-2? Вы не умеете, да? Обидно. Нет, это неверно, что крайние левые две
соседи образуют диагонали. Это, конечно, неправда. Ладно, давайте я считаю, что у меня есть оракул,
который мне когда-то сказал, что у многоугольника сумма углов P на N-2. Давайте, если что, добавим множество
аксиома там, где мы рассуждаем. Ну а почему, типа? Ну то же самое, это эквивалентное утверждение, наверное.
Понятно, да.
Ладно, все, проехали. Короче, я верю, что у многугольника сумма углов P на N-2. Все, вы меня не сможете в этом разубедить. Я это буду
нещадно использовать. Значит, так вот, значит, в частности есть вершина, при которой угол меньше, чем P. Вот давайте возьмем любую такую вершину.
Дальше рассмотрим соседние с ней, собственно, P-1 и P и плюс один, и посмотрим на вот такой отрезок. Если внезапно это диагональ, то есть если внезапно в этом
треугольнике никого больше не лежит, включая вот этот отрезок, если на этом отрезке никто другой не лежит, никакая другая вершина не лежит,
тогда мы нашли ухо и почти победили. Но давайте этот случай разберем. То есть вот, например, мы нашли ухо какое-то одно. Мы нашли одно ухо. Давайте его отрежем. У нас
останется вот такой большой многоугольник. Ну то есть по факту я просто выкидываю P из списка вершин, а у меня остается вот такой вот
многоугольник на N-1 вершине. Значит, для него верно предположение индукции, и в нем есть два неперескающиеся уха.
Значит, как они могут выглядеть, да? Вспомним, что мне надо доказать, что есть два уха, а не просто одно. Но давайте, вот одно есть,
я знаю, что если его отрезать, то здесь тоже есть два уха. Два неперескающихся. Что? Да, неперескающихся по
внутренности. Значит, как они могут выглядеть? Это могут быть два нормальных уха, которые вот такие вот, да, грубо говоря, и, в общем-то,
их можно было бы взять в качестве ушей для N-угольника всего. Проблема может быть только в случае, когда они, ну, не являются
ушами большего многоугольника. Это бывает, например, вот в такой вот ситуации. Если у вас вот в этом вот N-1 угольнике вы в
качестве одного ушей взяли вот такую штуку, тогда нельзя сказать, что это уха в большем многоугольнике, ну, потому что это не уха просто,
эти вершины не соседние. Вот. Но, благо, такой треугольник максимум только один из тех двух ушей, которые в этом меньшем
многоугольнике находятся, у меня максимум только один, и содержит вот этот отрезок. Значит, другой какой-то обязательно является
ухом и меньшего, и больше многоугольников, поэтому можно взять и его, и его. Тогда два уха всегда есть. Хорошо, теперь второй случай,
когда это не диагональ. Давайте поймем, что в этом случае делать. Значит, если это не диагональ,
что это значит? Это значит, что во внутренности этого треугольника или вот сюда на этот отрезок
попала какая-то точка, какая-то вершина многоугольника, ну, или там что-то пересекается. На самом деле, обязательно
тогда есть здесь какая-то вершина. Но давайте сделаем следующее. Давайте из всех вершин, попавших в этот треугольник,
ну, кроме вот этих трех, давайте из всех вершин выберем самую далекую от этой вот прямой. Давайте
возьмем такую точку Q, от которой расстояние до вот этой прямой максимально. Ну, возможно, в частности,
расстояние равно нулю, тогда это просто какая-то источник на прямой. Значит, тогда я утверждаю,
что вот эта вот штука уже, давайте это будет P и у меня, я утверждаю, что вот эта штука обязательно диагональ.
Значит, еще раз давайте сейчас напишем все аккуратненько. Значит, пусть Q это самая далекая,
не знаю, значит, самая далекая от прямой, да, от прямой P и минус один P и плюс один,
точка внутри треугольника, внутри треугольника, ну, даже не точка, а вершина, можно сказать, вершина.
Вот, тогда утверждается, что по Яку обязательно диагональ. Вот. Ну, почему это диагональ? Потому
что, потому что когда это может быть не диагональю, когда кто-то его пересекает или кто-то здесь лежит на
этом отрезке. Ну, такого быть не может, потому что мы взяли самую далекую, если бы на этом отрезке
лежала какая-то другая вершина, она была бы еще дальше от этой прямой. Если бы что-то пересекало,
то есть, скажем, не знаю, какая-то вот такая вот штука есть, тогда, ну, смотрите, тогда получается,
что если я рассмотрю вот такую полуплоскость лежащую от, ну, короче, прямую параллельную вот
эту прямую проведу, рассмотрю полуплоскость относительно Q и здесь куда ее пересекаю, значит,
какая-то вершина обязательно все равно лежит в этой полуплоскости. То есть, чтобы у меня было
пересесение вот этой вот, как бы, диагонали с какой-то частью многоугольника, то мне нужно,
чтобы, по крайней мере, одна из его вершин была точно по эту сторону. Ну, иначе просто мы не
можем пересекать, ну, как бы, мне надо два раза пересечь этот отрезок, но я не могу один раз
пересекаться. Вот, значит, обязательно хотя бы одна из вершин там. Куковек или сойдет? Ну, короче,
порисуйте, да, то есть, еще раз, вот, как бы, самое главное, давайте еще раз это сделаю. Вот,
был у меня такой треугольник. Я ищу диагональ, да, в случае, если это не ухо, я ищу диагональ. Вот,
еще раз, я нашел самую далекую точку от этой прямой. Это значит, в частности, что в этой
полуплоскости, да, вот, вот, в этой полуплоскости, точнее, в этом треугольнике нет никаких других
вершин. В этом треугольнике нет никаких других вершин. Ну, тогда, как бы, что может помешать быть
этому отрезку диагональю? Здесь вершин других лежать не может, потому что они в этой полуплоскости,
ну, и ничего пересекать тоже не может, потому что, значит, ну, что значит, что что-то пересекает,
да, вот, что-то такое может быть, разве что. Ну, короче, если этот отрезок что-то пересекает,
то не может быть такое, что все концы вот этих отрезков пересекают. Ну, короче, если... вот так,
смотрите, если какой-то отрезок пересекает нашу псевдодиагональ, тогда, по крайней мере,
один из двух концов этого отрезка в той же полуплоскости, вот так. Ну, не может быть такого,
что у меня отрезок пересекается другим отрезком, лежащим целиком вне этой полуплоскости. Значит,
по крайней мере, одна из двух вершин, пересекающих, да, на... отрезок, пересекающий эту диагональ,
внутри полуплоскости противореч noi с тем, что мы выбрали самую, самую далёкую, прямую. Вот так.
Ну вот, значит мы нашли диагональ.
Видимо да, самую левую, если таких нескольких, самую
низкую, да?
Любую нельзя, потому что, возможно, будет угол pi,
но видимо да, видимо вы правы.
Нет, все нормально, все хорошо у нас.
Да, то есть еще раз смотрите, мы рассмотрели просто произвольную
вершину угол при которой меньше 180, дальше проверяем
является ли вот этот отрезок диагональю, то есть мы по
факту просто проверяем есть ли в этом треугольнике
какие-то другие вершины.
Если нет, то это диагональ, мы можем это ухо отрезать
и дальше разрезать уже оставшийся многоугольник.
Дальше, если это не диагональ, то мы нашли другую диагональ,
вот эту вот, pi te ku, а значит мы можем по ней разрезать
весь многоугольник и дальше триангулировать обе части.
Но давайте сначала вот эту вершину я до конца докажу,
то есть смотрите, я в том случае доказал что есть
два уха, теперь в этом случае как доказать что есть два
уха?
Ну картинка будет такая, да, у меня вот есть диагональ
какая-то найденная и соответственно многоугольник выглядит
как-то вот так, грубо говоря.
Ну раз ничто не пересекает эту отрезок, то многоугольник
какой-то вот такой.
Хорошо, тогда давайте я его разрежу по этой диагонали,
у меня будет два многоугольника, ну и значит по индукции
здесь есть два уха, здесь есть два уха, ну уж наверное
как-нибудь мы из них совместно наберем два уха, чтобы они
не пересекались.
То есть опять, худший случай, когда одно ухо вот такое,
вот такое, они не являются ушами большого многоугольника,
тогда их можно отбросить и взять вот это ухо и вот
это ухо, тогда как раз будет два не пересекающихся.
Ну и все, значит мы доказали утверждение про два уха,
значит нам достаточно то, что есть хотя бы одно,
ну и на самом деле за одно это все нам просто дает алгоритм
треангуляции, значит алгоритм треангуляции за квадрат,
да, алгоритм треангуляции за n в квадрате, значит ну
просто как бы по факту просто идем по доказательству,
да, сначала давайте обойдем весь многоугольник, найдем
какую-то вершину угол при которой меньше 180, проверим
на то является ли этот резак диагональю, за линию, то
есть просто проверим нет ли в этом треугольника
Если нету, то можно ухо отрезать и треангулировать оставшееся,
на это будет тогда, значит первый случай, что t от n,
это t от n минус 1 плюс o от n, то есть мы одно ухо отрезали
за линийное время и нам осталось треангулировать многоугольник
на минус одной вершине, на тогда, ну короче, видно,
что это квадратично будет расти, вот, либо второй
случай, мы поняли, что это не диагональ, но тогда
мы нашли другую диагональ и можем разбить многоугольник
на два, вот как в этом случае, да, по этой диагонали,
будет первый многоугольник и второй, тогда давайте
рекурсивно от них запустимся и треангулируем и сольем
эти две треангуляции, тогда в этом случае во втором
время работы будет равно сумме, точнее t от n1 плюс t от n2
плюс o от n, вот, ну где, ну что такое, n1 плюс n2 это, ну вот
не n, да, n плюс 2, но зато они оба хотя бы 3, вот так вот
скажем, во, раз они хотя бы 3 и их сумма n плюс 2, то
значит, каждый из них не больше чем n минус 1, вот, ну
и можно честно доказать, что тогда n квадрат будет
являться решением такой рекуррента, вот, ну то есть
формально надо просто провести индукцию, что существует
такое c, что t от n всегда не больше чем cn квадрат, значит
здесь у вас cn1 в квадрате, cn2 в квадрате, мы знаем, что
сумма квадратов не больше, чем, так, так, не очень хорошо
сделать, да, ну короче, короче, короче, это доводится,
времени уже не осталось, в общем, можно, оценив это
по индукции, что это cn1 квадрат, это cn2 квадрат, это
почти cn квадрат, но еще минус 2n1n2, правильно, вот, и
как раз, и как раз, и как раз вот это вот будет достаточно
маленьким, это можно сделать достаточно маленьким по
сравнению с тем, что вот здесь будет минус 2n1n2, вот, и
тогда как раз все это можно оценить опять c1 квадратом,
c квадратом просто, ну все, спасибо.
