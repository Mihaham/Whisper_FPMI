так ну все давайте продолжать нашу деятельность мы там что начали делать графы да а вспомнил что мы
начали делать мы посчитали деревья я рассказывал про то что можно обобщать это дело на случай
унициклических графов или графов которые связаны и при этом имеют данное количество
рёбер на данном числе вершин я по-моему ввел даже это обозначение но как-то вот
так вот писалось с от н к что ли количество связанных графов на n вершинах у которых
ровно к рёбер соответственно если к меньше чем n минус 1 это 0 если к точности равно н минус
один то это количество деревьев формула Kelly доказанная в прошлый раз ну и вот предполагалось
что мы начнем сегодняшнюю лекцию как раз подсчета числа унициклических графов то есть графов у
которых на n вершинах ровно n рёбер но они естественно унициклические потому что если
н рёбер то мы фактически к дереву добавили еще одно ребро образовался ровно один простой цикл так
ну давайте я даже не буду формулировать теорему довольно просто сообразить что такое ц от н н сейчас
будем пытаться вместе посчитать т от н ну просто до какого-то момента потом там будет обобщение
формулы Kelly я это скажу так как посчитать ц от н ну если граф у нас унициклический значит он
формируется как бы вокруг одного цикла какая может быть длина у этого цикла понятное дело
что у нас граф-то обыкновенный поэтому циклы не могут быть короче чем на трех вершинах правильно
циклов на двух вершинах не бывает потому что нет кратных рёбер нет петель значит тем более не
бывает циклов на одной вершине вот поэтому давайте опишем тупо вот такую сумму пока тройки до n k это
будет длина того цикла вокруг которого формируется наш граф вот я сказал что конечно циклов короче
чем треугольники не бывает так дальше мы очевидно пишем ц и z пока но это количество
способов зафиксировать к вершин для будущего цикла у нас всего n вершин мы из них выбираем
какие-то к вопрос к аудитории мы тем самым цикл зафиксировали нет да сколько есть способов
теперь еще зафиксировать цикл если мы задали конкретно и к вершин без учета порядка
но глупый ответ к факториал глупый потому что некоторые циклы можно поворачивать получается
одно и то же но не каменус 2 факториал а каменус 1 факториал пополам вот так имеется в виду что если
у вас есть какая-то последовательность вершин но обычная линейная это вот в духе того что мы
изучали когда обсуждали формулы обращения меобиуса там какие-то циклические последовательности то
конечно вы ее можете вот так вот написать и вот так ну и даже сака начать и это все будет один и
тот же цикл но кроме того вы можете прочесть в обратном порядке у наших граф то не ориентированный
то есть вы можете прочитать наоборот от а к до а 1 и тоже вот так вот подвигать по циклу к раз
еще будет к вариантов всего 2 к различных линейных последовательности которые дают один и тот же
цикл поэтому циклов 2 к раз меньше чем перестановок перестановок ка факториал а циклов ка факториал
поделить на 2 к ну в общем это такое простое упражнение вот а здесь надо написать вот такую
вот штуку f от n к что такое f от n к но на эти вот у нас есть какой-то простой цикл на каких-то
к вершинах тут какой-нибудь а 1 а 2 тут так вот тут давайте ака пусть будет после многоточия
пусть будет так а есть какой-то цикл как его достроить до унициклического графа надо каждый
вершине этого цикла нарисовать какое-нибудь дерево правда ну в том числе сама вершина тоже
является деревом то есть теоретически не надо ничего рисовать тогда тоже получится дерево
состоящие с одной семечки так тоже может но то есть что такое f от n к можете догадаться откуда
взялась буква f от слова лес f от n к дайте я напишу это количество лесов на n вершинах
к деревьями как компонентами каждый из которых является естественно деревом к деревьями причем
такими деревьями что одно из них помечена вершиной а 1 другое помечена вершины а 2 ну и
так далее к деревьями дайте я пшу помеченными лесодержащими там ну неважно помеченными вершинами
а это на каждой вершине свое дерево вот сколько таких лесов у которых всего n вершин и при этом
у каждого своя отдельная вершина вот из этого множества которая принадлежит циклу своя отдельная
вершина такая корневая если угодно она из нее растет это дерево но вот утверждение которое
доказывается тем же самым кодированием плюсера то и формула к или доказанная в прошлый раз оно
состоит в том что f от n к это на самом деле вот такая штука это к умножить на n к степени n
минус к-1 но то есть в частности если вы возьмете f от n 1 то это будет количество лесов с одной
компонентой да то есть это будет просто количество деревьев на n вершинах и это коррелирует формулой
Kelly то есть в частном случае это формула доказана но и я повторяю что в общем случае это утверждение
доказывается тем же самым кодированием плюсера как и в прошлый раз я не буду его доказывать но у
нас есть по моему даже текст этого доказательства для желающих кто не справится сам в моем понимании
лучше бы справились самостоятельно просто лучше поймете кодирование может быть это на семинарах
разберут я обычно прошу для непонимающих все-таки разобрать вот но в принципе это делается
абсолютно тем же процессом надо его немножко обобщить утверждается что имеет место такая форма
которая действительно связана формулой кэмми но в итоге вот у нас получается такая жуткая теорема
сейчас я напишу она жутковатая конечно которую утверждает что с от н это есть сумма пока от тройки
до n по к к минус 1 факториал пополам множить на к и на n в степени n минус к минус 1 но разумеется это
можно чуть-чуть подкорректировать к минус 1 факториал умноженная на к это к факториал как бы чуть-чуть
наверное жуть и меньше да но все равно совершенно непонятно что это такое ну то есть формула в виде
какой-то суммы она не говорит сто сходу о том как растет количество унициклический графов
наверное вершинах как оно соотносится например с количеством деревьев ну да тут к можно занести
но от этого сильно лучше не станет там можно цейзент пока расписать к факториал знаменателем
сократиться вот с этим к факториал да но тоже сильно лучше не станет то есть я конечно могу
вот так переписать сумма пока от тройки до n что-нибудь типа вот так n и n минус 1 n минус к плюс
1 на одну вторую и на n в степени n минус к минус 1 но честно говоря сильно-то лучше кажется не
стало сейчас я правильно написал да да правильно значит n факториал я сократил цен минус к
факториал получилось вот такое вот произведение а к факториал знаменателя сократилась вот с этим
к факториал но если кто-то понимает как вот такая функция растет с роста мэн сходу то это человек
выдающийся выдающих со способности аналитических я думаю что никто из присутствующих конечно сходу
не скажет насколько это кстати но это ясно что это больше чем число деревьев вообще должно быть
сейчас друзья понимаете что унициклических графов должно быть точно больше чем деревья
но уже из каждого дерева вы можете получить кучу разных унициклических графов конечно некоторые
наверное будут потом повторяться поэтому непонятно сколько их в итоге получится но как-то
ожидаемо их больше все-таки формула должна на что-то быть похожая но что больше чем n в степени n
минус два а вот отсюда это ну в общем не видно больше это не больше хрен вас берет короче говоря
анонс на следующий год на дискретный анализ буквально вот я вас сейчас не буду кокать никаким
анализом математическим тут можно провести серьезный математический анализ этой штуковины
и вот анонс состоит следующим оказывается можно доказать такое следствие из этой теоремы что
циатнн ведет себя симпатически ну в стандартном смысле эквивалент но в смысле как мат анализ
следующим образом это корень из пи поделить на 8 умножить на n в степени n минус одна вторая
величие математики особенно пугает наверное корень из пи на 8 да с чего бы он выпьет
но вот выпьет ну видно да что эта формула растет быстрее чем n в степени n минус два примерно
в n в степени 3 вторых раза ну там еще с точностью до вот этой вот странной константы но вот это
вот анонс то сейчас я доказывать не буду запоминать как бы тоже не обязательно порядок
роста в принципе можно запомнить это не очень сложно вообще люди конечно научились считать
любые циатнк но мы уже в это не будем так глубоко влезать я помню наизусть кажется только вот это
но это даже не анонс то есть я не собираюсь доказывать ни в какой момент известно например
что количество связанных графов цен вершинами н плюс одним ребром ведет себя вот так 5 24 умножить
на n степени n плюс один так плюс один да плюс то есть снова порядок роста по n растет
примерно как n в степени 3 вторых но то есть вот сначала формулу кэли умножили на н степени 3
вторых у нас получилось вот так потом эту формулу снова умножили на н степени 3 вторых но правда
вот появилась опять какая-то загадочная константа фиг знает откуда ну вот если этот фиг я поясню то
этот фиг даже пояснять вообще так чтобы вам это не казалось каким-то издевательством над
здравым смыслом я все-таки еще раз повторю мотивацию люди начали этим заниматься в середине
двадцатого века когда они поняли что за очень многие вещи в том числе практически в том числе
алгоритмически отвечает поведение случайного графа на n вершинах ну что такое случайный граф
я вам подробностях расскажу в курсе дискретного анализа это очень важный объект с которым мы
много будем иметь дело он действительно практически значим он работает там для того например чтобы
оценивать работу алгоритмов на каких-то скажем так на почти всех графах на всех графах может не
работать но на почти всех графах удается вы готовы пожертвовать какой-то маленькой долей от общего
числа графов и вот на оставшихся все-таки этот алгоритм реализовывать то вот вы должны научиться
работать со случайными графами от различные техники работы со случайными графами отслеживание
каких-то связанных компонент еще каких-то историй там кроматических чисел и так далее вот они
повязаны в том числе на эти асимптотики поэтому знание сколько бывает графов той или иной
структурой с тем или иным количеством ребер и вершин это очень важное знание в том числе в
конечном счете и для практических задач которые связаны с оценками сложности работы каких-то
алгоритмов так ну в общем виде там знаете можно вот так вот написать c от n плюс к это ведет
тебя как какая-то константа не знаю как ее обозначить ну какая-нибудь например а от к умножить
на n в степени n плюс 3 на к минус 1 пополам то есть каждый раз действительно идет умножение на
n в степени 3 вторых с точностью до каждый раз какой-то загадочной константы которую я уже не помню
дальше и последнее что я помню 524 при n плюс 2 я уже не помню так вот это правильно я написал сейчас
надо сообразить если к это минус 1 тут будет минус 4 пополам да минус 2 все сошлось формула кэли
получилось да сошлось вот ну это конечно если к константа или там не очень быстро растущая
функция от н друзья вы понимаете что вот это к в принципе может быть вплоть до порядка n
квадрат конечно-конечно да поэтому вот эта формула верна не для всех как как функции от
n для констант и для медленно растущих функций эта формула верна а дальше там будут какие-то
свои эффекты которых я просто не помню наизусть если кому-то интересно но вот история этой задачи
вот есть такая замечательная книга как раз посвященная случайным графам автор ее бэла
болла баш классик такой теории случайных графов и книга называют random graphs вот там можно найти
довольно много информации про эту задачу в более общем виде вот про все вот это там от к выписано
в явном виде некая рекурентная формула которая позволяет вычислить все вот эти коэффициенты вот
но я наизусть не помню и вам это незачем запоминать конечно просто если интересно можете найти эту
книгу она скачивается на каком-то пиратском ресурсе на русском ее нет к сожалению так ну наверное в
этом месте я бы закончил истории процета нн вернемся вот к этой асимптотике как к силе и славе
иллюстрации такого дискретного анализа уже в следующем году сейчас еще одну такую темку мы затронем
более или менее последнюю в этом курсе но она конечно сегодня не завершится не надейтесь так
сейчас я подотру
давайте как класс задач которые стоит озвучить прямо сейчас это будет называться ходы графов
но от кое-что вы несомненно знаете я думаю что вы это где-то уже встречали проходили это то
что называется эйлеровость графа правильно я понимаю что вы уже знаете такой объект да такое
понятие что такой граф эйлеровский знаете там были кенигсбергские мосты их надо было пройти
по одному разу вернуться в ту же точку суши точно все знают ну короче если связанный граф
представляет собой цикл в нашем определении который я давал в прошлый раз то такой граф
называется эйлеровским я просто сформулирую теорему которую вы конечно знаете можете сами
доказать если можете подумать можете граф даже так для вязаного графа следующие три утверждение
эквивалентны первая граф эйлеровский но от ровно в том смысле как я сказал целиком и полностью
образует цикл не обязательно простой но какой-то цикл второе степень каждой вершины чётно
понятно известный критерий степень каждой вершины чётно и третье можно ещё добавить
что множество ребер этого графа множество ребер этого графа является объединением
множество ребер простых циклов но придется написать далеко множество ребер простых циклов
не имеющих общих вершин никакие два из которых не имеют общих ой общих вершин извините общих
ребер не имеющих общих ребер общие вершины они как раз могут иметь общих ребер вот такая вот
структура просто более тонкая что любой сложный цикл представляет собой какую-то там вот такую
вот конструкцию но может быть еще более сложную который у простых циклов могут быть общие вершины
но не может быть общих ребер это все интуитивно понятно технически можно доказать я обычно
опускаю доказательств потому что это какая-то тривиальность на уровне конца первого курса я
стараюсь это этим не грузить но все-таки это надо знать это важная вещь я ее хочу зафиксировать
вот вокруг эйлеровости графов и не только кстати графов но еще и ориентированных графов есть одна
задачка которую я сейчас озвучу она симпатичная как приложение вот называется она последовательности
не то что такая сейчас будет очень понятно и в том числе с прикладной точки зрения
постановка значит смотрите вот пусть у нас есть последовательности длины n какие-то где
каждая аито это либо 0 либо единица там потом это можно обобщить на произвольные последовательства
пусть будет из нуле единиц есть такие последовательства можете считать что это слова такие на двухбуквенном
алфавите алфавица стоит из двух букв 0 и 1 и мы рассматриваем такие n буквенные слова ну
понятное дело что всего этих слов 2 в степени 1 штук про если вы составляете такой условный словарь
из этих слов то в этом словаре суммарно получится без учета пробелов там и чего-то еще содержит
вот столько символов ну просто вы друг за другом выписываете эти слова там неважно не через
запятую пусть пробелы какие-то будут не имеет значения вот то конечно у вас 2 в степени n слов
каждое слово содержит n букв но у вас будет такой словарь объема 2 в степени n умножить на так
я не очень гоню все же понятно вроде все просто ну просто выписываю друг подружка эти слова как
пайл если хотите загоняю ну сколько он символов содержит 2 в степени намножить на я предлагаю
немножко сархивировать то есть немножко компактифицировать этот словарь сделать его
не таким объем а именно я предлагаю смотреть вот такую последовательность 1 а 2 а с индексом
ан большое где сейчас мы поймем что такое он большой это пока не понятно какую последовательность
я хочу составить ну во-первых каждый аито это по-прежнему 0 или 1 а во-вторых я хочу чтобы все
слова из вот этого словаря получались следующим образом берем первые n букв вот в этой
последовательности получаем какое-то одно слово из этого словаря потом берем следующие n букв
опять же n букв получаем какое-то другое слово из этого же словаря и так далее то есть каждый
раз это вот окошечка вмещаем на единицу вправо и хотим чтобы в то время получались новые слова
длинные он маленький так чтобы в итоге исчерпался весь словарь вот такая последовательность если она
вообще существует как раз и называется последовательность дебрюин последовательность
в которой вот так вот друг за дружкой содержатся все возможные слова длины n из нулей единиц
сдвигаем сдвигаем сдвигаем и все исчерпываем какая длина у этой последовательности если
понятно постановка вопроса что такое n большое если мы надеемся вот так исчерпать два в степени
маленькое слово да ладно прям сложный вопрос задумайтесь задумайтесь нет вот не умножать
ничего не нужно в этом то есть и смысл я же хочу сорхивировать умножать не нужно там 2 в степени
он конечно но ни на что умножать не надо почему умножать то но смотрите вот первое слово потом
вот второе потом третье ну ясно что последнее там где-то вот тут вот будет последнее нет
равно не трудно сообразить плюс n минус 1 конечно да плюс n минус 1
понятно
нет непонятно ему не поняло вы поняли да в чем вопрос-то да то есть мы хотим два в степени n
последовательности из нулей единиц вот так вот друг за дружкой уложить но вот у нас первая
последовательность первая заканчивается на элементе с номером он маленькая вторая заканчивается на
элементе с номером он маленькая плюс 1 третье на элементе с номером он маленькая плюс два но на
каком элементе закончится последовательств номером два в степени не маленькая плюс два в степени
минус 1. Все равно плохо объяснил. Вот сейчас нормально, да? Вот как раз n плюс 2 в n и минус 1.
Все, то есть если она существует, то она, конечно, такой длины. Но я могу привести пример,
когда n равно 2, показать, что такая последовательность существует. Значит,
какая у нее длина. n большое равно 4 плюс 2, 6, минус 1, 5. Но вот, например, так. 1, 1, 0, 0, 1. Ха-ха.
По-моему, получилось. Видите, 1, 1, 1, 0, 0, 0, 0, 1. Что, не все, что ли? По-моему, все.
Так, при n равно 2 существует гениально. Почему существует при n равно 3? Ну,
можно подойти к этому вопросу по-разному. Значит, можно подойти, так сказать, со сложного бока.
Можно сказать такое правило 0 лучше единицы. Значит, как мы пользуемся этим правилом? Мы
рисуем n единиц, а вот затем начинаем пользоваться правилом. То есть ставим 0 до тех пор, пока мы это
можем сделать. Мы предпочитаем каждый раз ставить 0, если только нам это не запрещено условиями
задачи. Ну, то есть мы ставим 0 поначалу n раз, и это действительно ничему не противоречит. После
чего мы снова хотим поставить 0, но уже не можем, потому что повторятся слова из одних нулей. Вот здесь
мы вынуждены поставить единицу, но когда мы переходим к следующей позиции, мы снова задумываемся,
а можем ли мы здесь поставить 0? Ну, очень хочется. Но оказывается, что можем, если только мы не
находимся вот в этой ситуации, когда все уже исчерпано. Понятно? Я утверждаю, что если вы
будете строить по этому правилу, то вы не запнетесь и в конце концов действительно получите нужную
последовательность. Давайте теорема. Такой алгоритм приведет к успеху. Для любого n да. Но я не буду
доказывать эту теорему, потому что я сейчас расскажу гораздо более простое понимание того же самого. Такой
алгоритм приведет к успеху. Подумайте, почему эта теорема верна, но уж там получится, не получится,
это как повезет. Специально требовать, наверное, не будем, но разбор это вот должен произойти в
какой-то момент. Я думаю, что вам расскажут. Ну, скорее всего, вы сами поймете. Вот, но есть гораздо
более системный, так сказать, подход к этому вопросу, то есть к вопросу о построении последовательности
Де Брёйн об архивации такой. Видите, мы почти в n раз сократили размер исходного словаря. Ну,
конечно, это логарифм от общего числа символов, но все равно. Некоторые достижения. Сейчас я более
системный подход расскажу, который имеет прямое отношение к обходу смысле эйлеровости, но только
не графа, а орграф. Значит, смотрите, опять пример. Пусть n равно 3. Вот сейчас будем рассматривать
пример n равное 3. Хотим нарисовать последовательность Де Брёйна. Так, n равное 3. Да, хочу, наверное,
n равное 3. Так, ну давайте выпишем все слова, какие бывают. Бывает 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0,
дальше 1, 1, 0, так, 1, 0, 1, 0, 1, 1 и 3 единицы. Раз, два, три, четыре, пять, шесть, семь, восемь. Так,
восемь слов выписал. Ну их, действительно, восемь, два в кубе. Но я хочу составить последовательность
Де Брёйна, которая бы там имела какую длину? Восемь, десять, да? Но вот мне нужна последовательность длины
10. Я сделаю следующую штуку. Я нарисую такой вот ориентированный граф. У него будет четыре вершины.
Вершинам будут соответствовать слова длины два. Слова на единичку меньше длины, чем та, которая нас
в итоге интересует. Ну, то есть, вот здесь, например, я возьму 1, 1, здесь я возьму 0, 0, здесь 1, 0,
а здесь 0, 1. А теперь, смотрите, я иду вот по этому словарю исходному, который еще не сархивирован,
и я смотрю на каждое очередное слово. Оно начинается с какого-то слова длины два, и каким-то
словом длины два заканчивается. Ну, вот данная конкретная начинается и заканчивается 0, 0. Одним и
тем же. Я нарисую петлю. Да даже не орграф, а псевдоорграф в моей терминологии получится. Дальше идем
к 0, 0, 1. Это 0, 0 в начале и 0, 1 в конце. То есть, вот такая вот образуется стрелочка. Ориентация
от начала к концу. Дальше 0, 1, 0. Это что такое? Это вот такая стрелочка. 0, 1, 1, 0. Потом 1, 0,
0, 0. Это вот такая стрелочка. 1, 1, 1, 0. Вот такая. 1, 0, 0, 1. Это обратно вот здесь. 0, 1, 1, 1 стрелка
сюда. И петля вот тут. Вот такой псевдоорграф образовался. Дорогие друзья, вот вдумайтесь в то,
что произошло. Если я сейчас нарисую эйлеровский цикл в этом ориентированном графе, вы понимаете,
что он и будет соответствовать последовательности Дебрэйна? Или еще непонятно? Он эйлеровский,
то есть он по каждому ребру, ну в данном случае ориентированному ребру, пройдет ровно один раз,
поэтому каждое слово он встретит ровно один раз, и при этом он пройдет по всем ребрам, тогда он
исчерпает все слова, потому что мы изначально ребром как раз ставили в соответствие те слова,
которые нам нужны. Трехбуквенные. Можно я не буду искать здесь эйлеровский цикл и рисовать примеры,
или вы хотите, чтобы я искал? Если хотите, то продиктуйте. В каком порядке двигаться,
потому что я туплю. Будем рисовать пример или так понятно? Понятно, ну ладно. Почему в общем случае
эйлеровский цикл вообще существует? Какой критерий эйлеровости аналогичен сформулированному тут,
но тут-то он все-таки не для орграфа, тут нету ориентации. Что является естественным аналогом
вот этого основного критерия, что степень каждой вершины четна? Почему она должна быть четной,
потому что количество входящих и исходящих ребр должно быть одинаково, правда? То есть для
орграфа аналогом вот этого критерия служит утверждение, что входящая и исходящая степень
каждой вершины равны. Ну я тоже, конечно, доказывать это не стану, это стандартная вещь. Почему в общем
случае здесь входящая и исходящая степень каждой вершины одинаковая? Чему она вообще равна? Двойки,
конечно. Ну каждая вершина это слово длины n, если она... каждая ребро это слово длины n,
а каждая вершина это слово длины n-1. Вот если вы зафиксировали слово длины n-1, то к нему
дальше можно добавить единичку или ноль, соответственно, будет два ребра. И наоборот,
если вы зафиксировали конец длины n-1, то начать можно с нуля с единицы, то есть будет степень 2.
Конечно, степень исходящей и входящая двойка, поэтому они равны между собой. И вот существует
всегда Эллеров цикл. По-моему, это более системное решение, хотя вот этот алгоритм тоже работает,
и я прошу подумать над тем, почему. Ну слушайте, я продолжу сегодняшнюю традицию. Если кто-то хочет
глубже в этом разобраться, например, посчитать количество всех Эллеровских циклов, то есть
количество способов составить вот эту вот последовательность Де Брёйна, то можно взять
книжку Маршала Холла. Классическая такая книжка называется «Комбинаторика». Там есть целая глава про это.
Я сейчас наизусть не помню, сколько получается Эллеровских циклов, но грубо говоря, там смысл какой-то
вот такой. Их 2 в степени 2 в степени n-1, и тут что-то такое. Ну то есть всего последовательности длины
n большое вот столько, а это 2 в степени 2 в степени n плюс n-1. Это количество всех возможных последовательств
из нулей единиц, которые имеют длину последовательности Де Брёйна. Но вот из них примерно корень,
если извлечь, то это будет количество последовательности Де Брёйна. То есть их дофига в общем. Порядка
корня там, ну точно что-то какого-то логарифма еще. Порядка корня от общего числа последовательности
длины n большое. Если кто-то хочет разобраться, может по этой книжке посмотреть. Ну перерыв. Ладно,
с Эллеровостью я считаю мы разобрались. Даже какое-то применение не очень обычное
я рассказал, но мне кажется, что это полезно. Сейчас будет еще один важный вариант обхода графа,
который куда как менее изучен. То есть если в случае с Эллеровостью все совершенно понятно,
проверили четность степеней вершины и готово дело, то вот с другим вариантом непонятно толком
ничего, но есть масса разных признаков, которые мы и обсудим. Но не все, конечно, какие-то из них.
Это то, что называется гамильтоновость графа. Важная тоже характеристика свойства графа,
его гамильтоновость. Так, сейчас напомню, что значит граф гамильтонов.
G-гамильтонов.
Если существует простой цикл,
проходящий по всем его вершинам.
Ну, то есть с практической точки зрения речь идет, условно говоря, о таком, знаете,
торговце-бродячем, который должен пройти по всем городам, но при этом в каждый город заглянуть
только один раз. Грубо говоря, он там толкал людям всякой фигни и обратно за мордобоем
возвращаться не хочет, поэтому ему нужен простой цикл, возможно, или простая цель. При этом ему
совершенно не в его интересах пройти по всем дорогам. Это вот не эйлеровость отнюдь, зачем ему
тратить то лишнее время. Ему интересны не дороги, ему интересны города, а дорога как раз чем меньше,
тем лучше. В этом смысле простой цикл это идеальный маршрут. То есть, например, какая-нибудь вот такая
картинка ни в коем случае не является эйлеровским графом, но является гамильтоновым, потому что мы
спокойно проходим вот по этому внешнему контуру, а эту дорогу никак не задействуем, и слава богу,
лишний раз ходить не нужно. Так, понятно, да, что такое гамильтоновость? Ну, я думаю, что тоже
большинство про это слышало. Проблема с гамильтоновостью, в отличие от эйлеровости, состоит в том,
что человечество не знает вообще, существует какой-то разумный алгоритм проверки графа на
гамильтоновость или не существует. Ну, все понимают, да, что разумность алгоритма меряется его
полиномиальностью или отсутствием таковой. То есть, существует ли алгоритм, который работает за
полином от n, где n число вершин или ребер, неважно, и проверяющий данный ему на вход граф гамильтонов.
Вот это неизвестно. Ну, там есть знаменитая проблема p не равно np, которую вы, конечно, слышали,
но в подробностях пока не понимаете. Но, в общем, с гамильтоновостью проблемы, короче говоря, нет
никаких критериев необходимых и одновременно достаточных признаков гамильтоновости, которые
легко бы проверялись, таких не существует. Но существуют разные достаточные признаки и
необходимые. Я расскажу два достаточных признака гамильтоновости. Два, причем, ну так, как бы,
хорошо дополняющих друг друга. То есть, один работает для одного типа графов, а другой,
вообще говоря, для другого. Значит, первая теорема, которая служит опять упражнением,
но она проста. Действительно, проста, и я не буду доказывать. Это классический признак,
доказанный Дераком. Признак Дерака. Ну, у него есть разные варианты обобщения. Я сформулирую в
простейшем варианте. Пусть для любой вершины нашего графа, степень этой вершины больше
либо равняется, ну я вот так могу написать, мощность В попала. Меня подмывал написать
буквку N, имея в виду, что мощность В равняется N. Ну, N вершину графа. Почему бы нет? Так и буду
потом писать. Ну вот, давайте считать, что у графа степень каждой вершины это как минимум половина
от числа всех вершин. То есть, каждая вершина соединена с очень большим количеством других.
Тогда граф гамильтона. Ну и, в общем, я вам так доложу. Мне кажется, что это вполне интуитивно,
даже понятно. Но каждый раз есть много куда пойти. Пошли, еще пошли. Ну, доказывается не так,
доказывается обычно от противного, но интуитивно вроде понятно. В общем,
считайте, что это некое упражнение, которое вам предстоит обдумать, но это действительно
такая довольно простая вещь. Единственное, что я прокомментирую, понимаете, товарищи, вот сходу
прям мгновенно, что во всяком случае граф, который здесь описан в этих условиях, он точно связан.
Почему? Если степень каждой вершины не меньше половины от числа вершин,
почему он точно связан? Ну потому что, смотрите, вот возьмем две вершины какие-то, любые совершенно
в этом графе. Еще у него n-2 вершины, если n это мощность v. Ну, у этой вершины как минимум n
пополам соседок, и у этой вершины как минимум n пополам соседок. Но ясно, что вот эти множество
соседок пересекаются. То есть они просто цепью длины 2 соединены и все. А может и один, если повезет.
То есть это не просто связанный граф, а такой очень хорошо связанный. Расстояние между любыми
двумя вершинами не больше двойки. Диаметр графа этого, как говорят, равен 2. Он, конечно, связанный,
но вот можно доказать, что еще и гамильтон. Кроме того, знаете, давайте еще чего заметим, но понятно,
что он плотный очень. Если у каждой вершины степень не меньше половины от числа всех вершин.
Знаете, что общее число ребер этого графа, это примерно половина от числа ребер полного графа
на n-вершинах. Тумма степеней вершины это удвоенное количество ребер. Это очень плотный граф. В нем
количество ребер это половина от количества ребер полного графа на n-вершинах. Больше чем половина.
Дофига. Вот для плотных графов работает признак дирака. Сейчас я расскажу альтернативный признак,
который совершенно не так интуитивно понятен, как признак дирака. Для этого я введу два новых
объекта, вязанных с графами. Один называется или обозначается альфа дж, и называется число независимости.
Ну, тут надо чуть-чуть назад откатить, сказать, давайте считать, что множество вершин графа независимо,
если каждые две вершины в нем не соединены ребром. Ну, то есть вот как-то так. Берем, например, цикл.
Вот эти вот вершины образуют в нем независимое множество. Между ними цепочки какие-то есть,
но непосредственных ребер между ними нет. Вот такое множество вершин, любое, например,
две вот этих вершины, называется независимо. И, кстати, даже одна вершина тоже считается
образующей независимое множество, потому что граф у нас обыкновенный, петель в нем нет,
одна вершина всегда образует независимое множество по определению. Ну, а число независимости это
максимальная мощность независимого множества вершин. Вот на этой картинке с циклом как раз
нарисовано независимое множество максимальной мощности. То есть альфа от цикла, если у него
n вершин, это, конечно, целая часть от n пополам всегда через одну берем, а плотнее нельзя. Так,
понятная объясняю. Какое число независимости, кстати, у дерева, дорогие товарищи?
Ну, скажем так, если у дерева хотя бы три вершины, то два.
Не, ну, если дерево представляет собой одно ребро, то у него число независимости один,
и если одну вершину, то тоже один. А вот если вершин хотя бы три, то уже там есть две висячие
вершины, и эти висячие вершины образуют заведомо независимое множество. Помните,
мы такую штуку обсуждали, когда Келли доказывали, что у каждого графа есть две висячих вершины,
но если эти две висячие вершины не образуют одно и то же ребро, то есть вершин хотя бы три,
тогда не образует независимое множество. Ну, так просто, это сейчас понадобится даже в каком-то
виде. Скажу неприятную новость. К сожалению, в общем случае число независимости это тоже
НП-трудная задача. То есть искать для произвольного графа число независимости алгоритмически,
скорее всего, тяжело. Скорее всего, не существует общего полиномиального алгоритма, который считал
по числу независимости. Но, во-первых, есть очень неплохие аппроксимации, о чем я расскажу в
дискретном анализе, а во-вторых, зачастую на некоторых классах графов удается чисто аналитически
посчитать альфу. И такой пример я приведу здесь, в этом курсе, но, видимо, на следующей лекции.
Будет очень красивая история. Но сегодня она не произойдет, сегодня, я надеюсь, а хотя даже,
может быть, я не успею доказать. И признак-то, но посмотрим, как дело пойдет. Я сейчас введу
еще одну характеристику, вот так она обозначается. Каппа. Это буквица, читается каппа. Видали такую,
указать? Видали, описали? Справитесь. Ну, например, да, да, там много есть таких объектов, но физики,
да, да. Ну, хорошо. Не, но если вам тяжело, рисуйте буковку K или какую-нибудь там X, я не знаю,
все что угодно. Вот, ну, такая вот буква, да. Каппадже называется, это словами называется,
это вершинная связанность. Сам по себе объект тоже очень важный, в том числе с практической
точки зрения. Что такое вершинная связанность? Знаете, я напишу прям формально. Это минимальное
такое число K, что существует множество вершин нашего графа мощности K. Такое, что граф без этих
вершин не связан. Вот так. Что такое G, ограниченный на V-W, это значит, мы удалили вот эти W, удалили эти
K вершин вместе со всеми ребрами, которые к ним примыкали в исходном графе. Вот получился новый
граф. И вот если он не связан, и это минимальное возможное K, при котором такую несвязанность
дается организовать. Но тогда вот мы говорим, что это вершинная связанность. Минимальное число
вершин, удаление которых разбивает граф на отдельные компоненты. Понятно? Ну, практическая
значимость, это знаете, когда дороги строят в городе, там очень важно сделать так, чтобы не было
узких мест, там типа железная дорога идет, ее надо почаще прокалывать где-то, иначе буквально одну
вершину удалишь и все развалилось. Одно по одну сторону дороги, другое по другу. Вот. Ну, короче
говоря, есть теорема два, которую мы докажем во всех подробностях. Вопрос только в том, успеем ли
за 25 минут на это слушать, как пойдет. Я не хочу гнать ни в коем случае, у меня время есть. Мне важно,
чтобы вы понимали, что происходит, я все время пытаюсь все-таки вести диалог. Значит, теорема два
звучит так. Пусть n больше либо равняется 3, ну, если n меньше 3, какая гамильтоновость вообще
непонятна. Если у нас обыкновенный граф и вершин меньше 3, то о гамильтоновости речь не идет.
Главное другое, альфа дж не превосходит капа дж. Вот, понимаете, какая удивительная вещь. Максимальное
число вершин по парно несоединенных ребрами не превосходит минимального числа вершин, удаление
которых разбивает граф на отдельные компоненты. Вот это вот достаточный признак гамильтоновости
графа. Тогда g гамильтонов, давайте вот тут напишу, тогда g гамильтонов. Такие чудеса. Не, но я сейчас
докажу. Будете хорошо воспринимать, докажу за сегодня. Лучше бы за сегодня, конечно, как пойдет.
Начнем с рассмотрения идиотского случая. Предположим, даже не противное, а очень противное.
Ну, будем от противного доказывать, но предположим очень противное. Предположим,
в графе g вообще нет циклов. Это ну очень противно. Какой же он гамильтонов, если в нем вообще нет циклов.
Ну, давайте предположим, что нет, но вдруг нет. Сейчас убедимся, конечно, что это фигня. Так,
если в графе g нет циклов, то что он из себя представляет? Лиас, правильно. А, дорогие друзья,
вы понимаете, что вот это вот условие вообще-то нам гарантирует, что граф тоже связан. Почему граф
связан? Потому что k больше нуля, да. Понимаете, Даша, если граф не связан, то k равняется нулю,
а альфа все-таки хотя бы единица. Граф не пустой, у него три вершины целых. То есть граф, конечно,
тривиальным образом из этого условия является связанным, поэтому отсутствие циклов означает,
что g – дерево. Причем на хотя бы трех вершинах. Но я уже предпослал нужное рассуждение. Помните,
если дерево на трех вершинах, тогда у него альфа не меньше двойки, две висячих вершины,
не соединенных ребров. С другой стороны, с другой стороны, конечно же, k под дерево – это единица.
Если у этого дерева хотя бы три вершины, там есть вершина, которая не является висячей,
удаляем, все разваливается. Но опять противоречие тем же самым вот этим вот условиям. Но, конечно,
не думайте, что оно нужно только здесь. Это было бы смешно. Реально оно понадобится во втором пункте,
когда мы уже будем работать с более содержательной ситуацией. Итак, в графе есть циклы. Мы это только
выяснили. Давайте снова предположим противное. А именно рассмотрим самый длинный простой цикл.
Рассмотрим самый длинный простой цикл. Зовем его c, и пусть вершина в нем это x1 и так далее xk.
Разумеется, он не обязан быть единственным, но какой-нибудь, неважно, любой самый длинный
простой цикл. Любой самый длинный. И предположим тока строго меньше, чем m. Ну, то есть нет
гамильтонного цикла, а все циклы короче, чем общее число вершин. Так, это предположение противного,
надо прийти как-то к противоречию. Давайте я нарисую картинку. Вот этот цикл x1, x2, будет,
скажем, xk-1, xk, и вот так. Вот этот цикл самый длинный, k строго меньше, чем n, поэтому есть
какие-то вершинки, которые внутри этого цикла не попали. Ну их может быть только одна, я для
общности нарисовал несколько. Успеваем. Так, давайте рассмотрим граф g штрих. Такое сейчас вот
совершенно не аналитическое как раз чисто графовское рассуждение. Рассмотрим g штрих,
который получается из g, получается из исходного графа, удалением вершин цикла. Вот этих вершин x1,
xk. Ну, естественно, со всеми ребрами, которые к ним примыкают. Так, вопрос на понимание,
я довольно быстро читаю, но главное, чтобы вы воспринимали. Вопрос, как вы считаете,
g штрих обязан быть связанным или не обязан? Но это правда неочевидный вопрос, на самом деле
ответ на него неизвестно. Но ответ на него непонятен. Может быть, он связанный, может быть,
он не связанный. Это не так важно, но этого для себя как-то отразить. Ну, я не знаю, связанный
он или нет, но мы удалили вот эти вершины вместе со всеми ребрами, которые из них выходили. Вот есть
какие-то снаружи еще расположенные вершинки. Безотносительно того, связанный это граф или
не связанный, давайте рассмотрим в нем какую-нибудь связанную компоненту. Вот я возьму и теперь
обозначу это w, это множество вершин, образующих связанную компоненту в графе g штрих. Опять же,
для общности нарисую еще какие-то вершины снаружи, но их может и не быть, если g штрих
все-таки связан. Для красоты я нарисовал, но это может быть пустое множество. Поняли, да? Так,
давайте обозначим, сейчас я тут вот где-нибудь уже сюда перейду. Ведем такое обозначение n с
индексом w от g. Обозначение, смысл вот такой, это множество соседей или соседок, вершин из w в
графе g в исходном. Вот у нас есть w и мы смотрим на их соседок, но не находящихся в w, а где-то
снаружи. В исходном графе g, то есть до удаления вершины с цикла, ну сейчас я напишу. Значит,
это множество таких y из w, то существует так, из w без w, но таких y, которые не принадлежат w,
и что существует x принадлежащий w такой, что пара x и y образует ребро исходного графа g.
Формально так. n от слова neighbor, так мне кажется проще запоминать, соседки. То есть,
еще раз, смотрим вот на эти вершины и ищем вершины, которые соединены ребрами с кем-то отсюда,
и при этом множество w не принадлежат. Вопрос на засыпку, где находится множество n w? Где эти
вершины живут? В тыкле! Вот тут их быть не может. Если это множество не пустое, то, тем не менее,
n w с ним не пересекается. Понимаете, почему? Потому что это отдельная компонента или несколько
компонентов связанности графа g'. Ну, я надеюсь, все понимают. То есть, давайте я прямо это оформлю
как простое утверждение 1. n w от g вложено в t. Все эти соседки находятся внутри цикла и нигде больше.
Иначе не отваливалась бы вот эта компонента связанности, вот эта вот, не отваливалась бы,
даже после удаления вершин цикла. Ну, утверждение 1 вроде понятно. Утверждение 2. Если x' принадлежит
n w от g, то x' плюс 1 не принадлежит n w от g. Но это вот на картинке надо посмотреть. Если есть
какая-то вершинка x' и она принадлежит n w, значит у нас есть какое-то вот такое ребро в исходном
графе g, правильно? Я не очень гоню. Если мы предположим, что из вот следующей вершины x' и плюс 1 тоже
идет какое-то ребро куда-то внутрь w, то почему так не может быть? Потому что мы можем увеличить
наш самый длинный цикл, понимаете? Как увеличить самый длинный цикл? Вот тут какая-то цепочка есть.
Она может быть теоретически длины 0. Ну как? И у этой, и у этой может быть одна и та же соседка. Но даже
если она длины 0, ну тут виден новый простой цикл, у которого вот на эти два ребра больше,
и на это одно ребро меньше. Но так же не может быть у нас самый длинный простой цикл. Ну вот
получаем, что соседние вершины цикла не могут одновременно попадать в n w. Откуда, конечно,
следует моментальное утверждение 2, что n w от g, конечно, вложено в c, но уже с ним не совпадает.
То есть в утверждении 1 не надо было пририсовывать вот это возможное равенство, его как раз быть
не может. Потому что две соседние вершины из цикла не могут одновременно находиться в n w.
Нормальный темп? Понятно, что происходит. Так, чудесно. Вот теперь утверждение 4,
которое следует в том числе из утверждения 3. Так, ну давайте я так напишу. Мощность n w от g больше
либо равняется k под g. Ну то есть что фактически здесь утверждается, как вы наверное понимаете.
Утверждается, что если удалить n w от g, то граф развалится. Ну отсюда, конечно, следует,
что минимальное число вершин, удаление которых разваливает граф не больше, чем мощность n w от g.
Почему граф разваливается, если из него удалить n w? Точно успеваете на мысли?
Знаете, когда мы удаляем n w, мы фактически удаляем всех соседок вот этой сардельки. Правильно?
То есть сарделька точно отваливается. Но теоретически вот здесь могло быть пусто,
и если бы n w совпадало со всем циклом, то ничего не связанного бы не получилось. Но мы
только что выяснили, что n w не совпадает со всем циклом. Поэтому с одной стороны точно отваливается
сарделька, а с другой стороны точно что-то остается в цикле, уже с этой сарделькой не связанное.
Потому что все связанное это n w. И вот то, что осталось здесь, и вот эта сарделька образует
несвязанный граф. Поэтому n w удаляем, и граф разваливается как минимум на две компоненты.
Отсюда следует, что kappa не больше, чем мощность n w, ну или вот мне больше нравится в таком порядке.
Слушайте, я смог это объяснить или очень быстро? Я очень последовательно как раз работаю,
не совпадает, поэтому после удаления что-то в цикле остается, и еще w останется. Но вот они
между собой уже не связаны. Так, теперь давайте рассмотрим еще одно обозначение множества m,
которое определяется вот так. Это множество x и плюс первых таких, что x и t принадлежит n w от g.
Ну то есть берем все вершины цикла, которые попадают в множество соседок w, и от каждой
смещаемся на один вправо. Ну вот мы здесь выяснили, что x и плюс первый уже не принадлежит n w от g.
То есть в частности мы можем что сказать, что m пересеченная с n w от g, разумеется пусто.
Ну и кроме того, конечно же просто по построению мощность m такая же,
как мощность n w, мы просто сдвинули вот так вот, повернули руль. Ну а это больше либо равно
k под g, как мы только что доказали. Так, сейчас будет утверждение 5. Я точно не очень быстро говорю,
все успевают. Куда я дел тряпку? Вот верчусь как этот руль. Так,
я оставлю условия теоремы, остальное садру, включая картинку, потому что мне сейчас
потребуется чуть более подробная картинка. По сути такая же. Так, а это тоже надо снять.
О, сколько всего лишнего. Так, смотрите, утверждение 5 состоит в том, что m независимое
множество вершин нашего графа. В нем нет ребер. Сейчас я нарисую картину. Так,
вот это вот x1, это x2. Дальше возьмем какой-нибудь xy, xy плюс 1, потом возьмем xj, xj плюс 1. Многоточие
xk и вот так. Значит зачем такая подробная картинка? Мы сейчас предположим противное. Вот этим
утверждением. То есть давайте предположим, что есть вот такой, ой, неправильно нарисовал,
это же m виноват. Вот такое вот ребро. Вот такое. m по построению состоит из xy плюс 1. Вот я предполагаю,
что оно не является независимым вопреки утверждению 5, что есть какое-то xy плюс 1,
которое соседка xy из nw, по циклу соседка. И есть какое-то xj плюс 1, которое по циклу соседка
с xj опять же из nw. И вот они соединены тоже ребром. Да, этот цикл такой. И что? Цикл состоит из
вершин x1, xk. Вот стертая картинка была такой же. Сейчас, что вас смутило, не понял. У меня есть
изначальный цикл x1 и так далее xk. Вот я его нарисовал. x1, x2 и так далее xk. Вот это вот изначальный
цикл. Теперь я предполагаю, что вот в этом m, как оно определено, есть две какие-то вершины xy
плюс 1 и xj плюс 1, которые соединены ребром. Ну, если xy плюс 1 принадлежит m и xj плюс 1
принадлежит m, значит xt и xgt принадлежит nw. Вот сейчас я нарисую это w опять-таки. Вот оно w.
Там еще какие-то возможности снаружи вершины, неважно. Вот как у нас в старой картинке было.
Вот xt с кем-то соединена и xgt кем-то соединена. И тут есть цепочка, ну в крайнем случае длины 0.
Вот полная картина такая. Я хочу доказать, что есть более длинный цикл. Я предположил противное,
что есть xy плюс 1 и xj плюс 1 ребро. Сейчас я докажу, что есть более длинный цикл, нежели исходный и
приду к противоречию. Ну как его строить? Смотрите, из x1 идем в x2, идем и так далее. Доходим до кого?
До x этого, наверное. Вот до сюда доходим. Потом прыг сюда, ну пусть вот это a, вот это b. Значит,
прыг сюда это a. Потом идет вот такая стрелочка в b. Это вот это вот. Она может длины 0, потому что b может
впадать в ца теоретически. Так, потом нормальная стрелочка идет назад вот сюда в xgt. Дальше идет
много стрелочек в xy плюс 1. Вот мы так двигаемся. Потом прыг сюда за счет предположенного ребра.
Значит, прыг куда? В xj плюс 1. В xj плюс 1 прыг. Что-то я не то сделал, да? Сейчас. По-моему,
я что-то не то сделал. Подождите, какой же более длинный цикл? Что-то я зарапортовался. Не туда
что ли пошел? Сейчас. Из x этого в a, из a в b. А, нет, из b в xj все хорошо. Я же его уже использовал.
Это я туплю. Так, из xj, куда я двигаюсь? Господи, в xy плюс 1, потом в xj плюс 1. А, все. Все. Иду
обратно. Вы, кстати, просто по исходному циклу. Нет, подождите, каким пунктиром? У меня есть только
вот такое волнистое. Это не ребро, а цепочка ребер, которая может быть длины 0, если a и b совпадают.
Это не пунктирные ребра, это просто многоточие между вершинами. Но я не знаю, что такое x и
b. Может это и x2, вообще говоря. Я для общности нарисовал просто многоточие. Сейчас понятно, да?
Вот. Понятно, что то, что я нарисовал, действительно простой цикл, а то я сам запутался. Почему он
длиннее исходного? Потому что в нем добавляется вот это ребро, вот это ребро и вот это ребро.
Давайте я напишу вот это в плюс, вот это в плюс и вот это в плюс. Это три ребра добавилось,
они все использованы. А в минус пошло вот это ребро и вот это ребро. Два ребра пошли в минус.
Их нет в этом цикле. Ну, то есть на одно больше противоречия. Итак, m у нас независимое множество
вершин. Точно нет вопросов? m независимое множество. Так, ну слушайте, я уж прям совсем буду подробен.
Для любого x принадлежащего w, m объединенное с x тоже независимо, тоже независимо. Почему?
Ну, потому что m не пересекается с nw, а если вы x взяли из w, ну ясно, что x ни с кем из
m не соединен. x соединен может быть только с nw, а m пересеченное с nw пусто. Поэтому x ни с кем
внутри m не соединен. Ну и внутри m нет ребер. Значит, если мы к m добавляем любую вершину отсюда,
то снова получается независимое множество. Это вроде совсем очевидно, да? Все, сейчас будет
катарсис, ну победа. Смотрите, мощность множества m объединенного с x, она равна мощности m плюс 1 и
стало быть больше либо равна kappa j плюс 1. С другой стороны, она, конечно, не превосходит alpha j,
потому что это независимое множество, а alpha это мощность максимального независимого множества. То
есть мы получаем вот из этой цепочки неравенств, что alpha j строго больше хотя бы на единичку,
чем kappa j, а условие было таким. И вот это уже окончательное противоречие.
По-моему, довольно круто, но так, не ожидаешь по ходу дела, что дело получится. Слушайте,
ну идеально, сегодня прямо ровно-ровно закончил. На сегодня все, доказал теориям.
