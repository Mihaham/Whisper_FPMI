Так, алгоритм проверки на простоту, ну это вообще на самом деле тут вкладывать надо пафос,
конечно хочется чтобы сидела большая аудитория, но вот случилась накладка.
Будем считать что большая аудитория вот так сидит, как ковид.
Так, ну собственно все понимают о чем идет речь, мы хотим проверить число на простоту.
И пафос состоит в том, что ну вообще все классические алгоритмы, которые хорошо известны, это вероятность алгоритма.
То есть они с какой-то хорошей вероятностью конечно выдают правильный ответ, но в принципе могут ошибиться.
А тот алгоритм, который я буду здесь рассказывать, он замечательен тем, что он детерминирован.
Он работает с запаленом и при этом 100% на гарантированного дает правильный результат.
Ну пафос не только в этом, а в том, что надо кучу всего знать для того, чтобы обосновать, что этот алгоритм действительно работает.
То есть вот я в это как раз вкладываю особенный пафос.
Мне хочется показать, что и алгебра нужна какая-то продвинутая, там теория колец и поли.
Вот не просто что такое кольцо, как в анекдоте про ферматиста, а прям как следует.
То есть алгоритм сходу вообще непонятно почему должен работать.
Вот я его сейчас напишу. Проверка числа на простоту.
Да, что значит он полиномиальный? Понятно, да, что полином имеется в виду конечно от числа цифр, то есть от алгоритма.
Если вам на вход поступило число n, то полином это значит что большое от log n в какой-то стиле.
Сложность должна быть так. Ну вот алгоритм.
Первый, прям по пунктам не буду отделять, буду вот так писать чуть правее, в принципе народ совсем немного.
Камера поймаю.
Значит первый пункт проверяем. Вдруг так случится, что наше число n имеет вид а в степени b.
Ну где b конечно не единица. То есть это полная степень какого-то натурального числа.
Вот если это так, ну естественно мы выдаем что n составное и на этом алгоритм завершает свою работу.
Я потом буду комментировать, во-первых, почему он с должной сложности, почему нет там сложности.
Полином от логарифма n.
Ну а почему он сработает, в этом как раз основной пафос.
Почему он действительно детраминированно выдает за нужное время ожидаемый результат.
Дальше мы делаем такую интересную штуку. Мы ищем наименьшее число r натурально.
Такое, что...
Так, ну я честно говоря забыл как я обозначаю показатель числа по модуле.
У меня было какое-то стандартное обозначение дельта.
Так, помните, вот я рассказывал первообразные корни и там был показатель числа.
То есть минимальная степень, в которую надо возвести число, чтобы по этому модулю получить единицу.
Орд был. Дайте я просто О тогда напишу.
Мне что-то орд длинный, лень писать, но могу и орд написать.
Это на семинарах что ли было? Я такого точно не употреблял.
Ну пусть вот если на семинарах был орд, ну пусть будет орд.
Но показатель по-другому еще как порядок переводится.
У нас сегодня бонусная лекция. Заходите, можете послушать про алгоритм проверки числа на простоту.
Ну что поделать, вспомните молодость, а то у нас народу мало.
Мы забыли оповестить студентов, что сегодня лекция дополнительная.
У нас будет три слушателя.
Не, ну можете конечно не слушать.
Я так понимаю, что вы слушаете.
Ищем наименьше r такое, что показатель числа n по модулю r больше, чем лог двоичный в квадрате n.
Вот почему-то нужно, чтобы он был больше, чем лог двоичный в квадрате.
И конечно уже вот здесь совсем не понятно, почему сложность этого шага будет ожидаемо невысокой.
Здесь я думаю, что слушатели понимают, как действует, но тоже объясню.
А тут предстоит еще разобраться.
Вот так, третий пункт.
Ну допустим мы нашли такое r, допустим это делается быстро.
Потом обсудим.
Давайте сделаем следующую вещь.
Посчитаем, вернее пробежим в цикле по a от 1 до r.
Ну наверное r будет маленькой.
Если уж так верить в то, что вот этот шаг быстрый, наверное r будет небольшой.
Ну слушайте, я могу сказать, чтобы вам легче было воспринимать, я могу сказать,
окажется, потом окажется, что этот r не превосходит двоичного логарифма n в пятой сети.
Ну то есть я докажу просто аккуратно, что существует число r такое,
что показатель числа n по модулю r больше, чем лог в квадрате,
и это число не превосходит лог в пятой.
Тогда будет конечно понятно, что этот шаг делается за полином,
и этот шаг по крайней мере в рамках цикла тоже делается за полином.
Теперь что делается на каждой итерации цикла?
На каждой итерации цикла мы смотрим, а вдруг наибольший общий делитель чисел a и n,
ну я надеюсь, вот это a никого не путает, это разные а на разных шагах.
Не думаю, что это проблема.
Вот вдруг он такой, вдруг он лежит в пределах от 1 до…
Ну в этом месте, наверное, не нужно пояснять, почему нот считается быстрой, это алгоритм Ефрида,
тут вопросов, по-моему, быть не должно.
А поскольку r небольшой, то мы сделаем малое число итераций и быстро проверим, случилось ли так.
Но если так случилось при каком-нибудь a, то мы, естественно, выдаем, что n составно.
То есть опять в этой ситуации понятно, что алгоритм срабатывает корректно.
Так, четвертый пункт на самом деле можно пропустить, но я его для полноты картины нарисую,
а потом мы от него в каком-то смысле избавимся.
Проверяем, а вдруг n не больше, чем r?
Ну что значит n не больше, чем r?
Если мы уже знаем откуда-то, что r маленькая, там, лоб в пятой степени от n,
то, наверное, таких n лишь конечное число.
Потому что при маленьких n может так случиться, что n не превосходит пятой степени алгоритма.
Ну а мы будем, наверное, в дальнейшем, чтобы не напрягаться с какими-то выкладками,
считать, что n достаточно большое, поэтому, в принципе, этот шаг можно даже не делать.
Ну, например, считать, что n настолько большое, что это неравенство никогда не выполняется.
Мне же вам надо качественно объяснить, почему алгоритм работает не для любого n,
хотя бы для n достаточно большое, а для маленького полный перебор работает за поленом, понимаете?
Сейчас, друзья, я не очень гоню, вроде я просто говорю.
Понятно, что если n меньше, например, чем 10 квадриллионов, то, в общем, можно проверить.
На простату, правда, долго будет практически точка зрения, но ладно.
Короче, если это так, то мы, конечно, выдаем, что n простое.
Ну, потому что мы же прошли шаг номер 3.
Если мы его целиком прошли и не выскочили с информацией о том, что n составной,
значит, ни разу вот эта цепочка неравенства не выполнилась.
И если n при этом еще не больше, чем r, ну, конечно, n просто.
Мы просто со всеми предшествующими числами его посчитали нот.
Если этот нот окажется равным 1 или самому числу, значит, оно простое.
Но еще раз повторяю, этот шаг, в принципе, можно пропустить, считая, что n достаточно велик.
Так, пятый самый загадочный шаг, который обычно вызывает вопросы,
но вот он, собственно, алгебраическая техника под собой содержит.
Снова идем в цикле очередное, а у нас будет никак не относящийся к пунктам 1 и 3.
Значит, а меняется в пределах от единицы до числа, которые мы обозначим l,
и которые есть корень из r, помножить на лог двоичный.
Ну, понятно, что объем этого цикла снова небольшой,
потому что r не больше, чем лог в пятый, ну, тут еще какой-то лог добавить, все равно не так долго.
Главное, что мы делаем на каждой итерации цикла.
На каждой итерации цикла мы пишем вот такую вот штуку x плюс a в n степени
и проверяем, а вдруг это не равно x в n плюс a.
Ну, по какому модулю? Самое интересное, к какому модулю это будет сейчас самое непонятное.
Вы, пожалуйста, следите, если непонятно, то спрашивайте.
Ну, я, конечно, все поясню. x в r-то и минус 1 запятая n.
Топсия значила.
Ну, то есть мы коэффициенты вот этих вот многочленов сравниваем по модулю n,
факторизуем, если угодно, приводим по модулю n.
А кроме того, еще сам многочлен факторизуем вот по этому многочлену.
Ну, то есть имеется в виду, что если мы раскрываем, например, вот тут скобки,
то везде, где степень больше либо равна r-то, мы x в r-то и заменяем на единицу.
Вот, наверное, так проще всего объяснить.
Открываем скобки, там x вылезает в какой-то степени, вот x в r-то и заменяем просто на единицу
столько раз, сколько можем.
И потом еще каждый раз коэффициенты загоняем в полную систему вычетов по модуле.
Например, от нуля даем минус 1.
Если при каком-то A в рамках этого цикла вот такое случилось, что не равно,
тогда говорим, что n-составное.
Ну, слушайте, вот то, что n-составное, если равенство не выполнено,
это, вероятно, вы можете сходу понять, что вот это правильная информация.
Потому что, если бы n было простым,
но мы ж понимаем, что x плюс A в простой степени, это x в p-той плюс A в p-той.
Все остальные цешки, которые там вылезают, зануляются, или это не очевидно сходу?
Csp по одному, csp по дыру, там все на p делится.
Пропадают все центральные цешки, остается x в p-той и A в p-той.
А в p-той по модулю P это A, согласно малой теореме фирма.
Поэтому, если бы n было простым, то такого бы точно не случилось.
В чем даже не нужно редуцировать по вот этому модулю, достаточно по модулю A.
Поэтому этот вывод правильный.
Но замечательно то, что после вот этих вот не очень многих проверок,
как полинамиально многих, не очень многих.
Мы уже можем сказать, что n просто.
Вот это главный вопрос, почему так можно.
Можно утверждать, что если мы прошли какой-то степень логаризма вот таких вот проверок,
то n точно простой.
Вот все, весь алгоритм записан.
Итак, что понятно?
Понятно, что все случаи, когда мы выдаем составное правильное,
то есть они действительно корректно работают.
И понятно, что в этом случае простота тоже корректная.
Это я уже комментировал.
Глобальнейший вопрос, почему вот здесь правильно говорить, что n простое.
Ну и наверное есть еще вопрос, почему вот этот шаг полинамиально сложный
и вот этот главный шаг полинамиально сложный.
Или всем присутствующим в этой аудитории понятно, как действовать.
Как, например, проверить, что n представляет собой полную степень какого-то числа.
Ну вот по поводу пункта 1, почему он полинамиально сложный.
Ну понятно, что b не превосходит лог 2-ичный n.
Ну то есть если такое b существует, то оно не больше, чем 2-ичный логаритм.
То а не меньше 2.
Но мы можем тупо просто подбирать.
Что подбирать? Мы можем подбирать знаки вот этого числа a, цифры.
Цифры числа a, в которых понятно, что a не больше, чем n.
То есть цифра логарифмическое количество от n.
Мы каждую цифру можем просто подбирать.
Недолет-перелет, недолет-перелет.
Плохо говорили, понятно.
Но мы идем в цикле по b.
Цикл по b имеет объем логарифмический.
Для каждого b мы пытаемся подобрать a.
Как мы пытаемся? Сначала пытаемся подобрать первый бит.
Первую цифру числа a.
Там 10 вариантов, всего даже 9.
Для первой цифры 9.
Потом будет по 10.
9 вариантов.
Берем и возводим степень.
Перелет.
Ну значит надо меньшую взять цифру.
Дошли до недолета, вот отлично.
Выбрали первую цифру числа,
которая теоретически в этой степени b может давать n.
Потом точно так же выбираем вторую цифру числа.
Но возведение в степень,
в степень, которая не превосходит лог двоичный n,
оно конечно занимает порядка логарифма от n операции.
И таких возведений будет 10 на каждую цифру.
В конце концов там кубическая будет сложность по логарифму.
Ну тупой перебор, просто подбор цифр.
Сейчас плохо объясню или понятно?
Понятно?
Теперь как здесь действовать?
Ну в общем по аналогии в каком-то смысле,
не только не цифру подбирать.
Плоти 5, почему не логарифмическая, а полинамиальная сложность?
Ну как возводить в n степень?
Можно возвести не в n степень, а в квадрат.
Ну возвели в квадрат, редуцировали по вот этому модулю.
Ну если надо.
Когда в квадрат возвели, наверное, хв еще не выйдет.
Но по этому модулю может уже и не выйдет.
Так, возвели в квадрат.
В общем результат возведения,
возвели еще раз в квадрат.
Еще раз в квадрат.
И на каждом шаге, каждый раз после возведения в очередной квадрат,
редуцируем по этому модулю.
Ну редукция не требует большого числа операции.
По понятным причинам, r не большой.
А возведений в квадрат таких будет не больше, чем логарифмэн.
Правильно?
Логарифм двоичный.
В квадрат, в квадрат, в квадрат.
Но будет в степени 2 вкатый.
В степени 2 вкатый.
Ну k не больше, чем логарифмэн.
Ну может мы не попадем точно в n.
Но дальше снова начнем умножать.
Новозведение в квадрат, в квадрат, в квадрат.
Там уже поменьше будет степень.
И так в конце концов возведем в n.
То есть n представим как 2 вкатый, там плюс 2 вk,
плюс, вот тогда.
С каким коэффициентом?
Мы разобрались со всеми сложностями.
Ну, в смысле, сложностями алгоритмическими.
Алгоритм работает за степень логарифма.
Оценивать эту степень я не буду.
Плевать я хотел, я сейчас работаю на стеорию.
Мне хочется показать, что великое математическое знание
позволяет придумывать пальмамиальные алгоритмы.
А дальше уже можно как-то упрощать константы,
степени этих алгоритмов и так далее.
Вот это мне не так интересно.
Важно самую суть пронять.
Вот, осталось понять, почему шестой пункт правильный.
Все остальное вроде понятно.
Правда?
Вроде только это осталось.
А, нет, не только.
Еще вот это осталось.
Давайте вот с этого начнем.
Почему r не превосходит пятую степень алгоритма?
Значит, я раньше рассказывал немножко по-другому,
искусственно усложняя себе задачу.
Давайте я докажу более простую теорему,
нежели ту, которую я доказывал в прошлом году
и в предыдущие годы в этом месте.
Я докажу, что если n достаточно велико
больше некоторого n0, которое существует,
существует n0,
и такое, что если n больше либо равняется n0,
то найдется такое r,
не превосходящее лог пятой степени от t,
что n в степени r...
Нет, неправильно.
Как бы это сказать-то?
Сейчас, секунду.
Ну, наверное, что n в степени i
не сравнимо с единицей
по модулю r
для любого i
не превосходящего...
Ну, вообще говоря, можно сказать, конечно,
все от r, но n-шу r,
я думаю, это неважно.
Ну, r никто не гарантировал, что будет простым.
Мы же не утверждаем, что r простое число.
Здесь нигде не говорится, что r простое.
В определении показателя, конечно, предполагается...
Вот сейчас вот внимательно вслушайтесь в то, что я говорю,
потому что именно здесь отличие от прошлого года.
Значит, в определении показателя, конечно, предполагается,
что r и n взаимно просты, это важно.
Но нам достаточно доказать теорему, которую я сформулировал,
что в определении показателя говорится,
что найдется такое число r,
что, во-первых, n в итой
не сравнимо с единицей для всех итам, не превосходящих r,
и даже phi от r.
Если говорить про показатель, то phi от r.
И в то же время r и n взаимно просты,
иначе вот эта величина корректно не определена.
А в теореме, я говорю, да мне плевать,
там можно даже до r дотянуть,
в этот раз не так важно.
Но я не буду в этой теореме проверять взаимно просто r с n или нет.
То есть, может быть, это r и не взаимно просто с n.
Другое дело, что мы все равно это проверим здесь в рамках алгоритма,
оно окажется взаимно простым,
и потом уже в постфактум мы будем понимать,
что мы нашли именно то, что хотим.
Сейчас понятно, я сказал или сложно.
Ну, смотрите, вот мы хотим найти наименьшее число r,
показатель которого больше...
Глупость написал.
Вот так вот, я понял, что я плохо объясняю.
Конечно, тут не r, не phi от r.
Это я глупость сказал, просто алгоритм в квадрате.
Наша задача, что сделать, чтобы найти такое число r,
что по его модулю оговорился, глупость сказал.
Показатель n больше, чем лог в квадрате.
Конечно, это значит, что n вытай не сравнимо с единицей
не при всех ине превосходящих r или phi от r,
извините, глупость сказал,
а при всех ине больше, чем лог в квадрате.
Так, правильно?
Сейчас понятно.
Утверждение о том, что показатель больше, чем лог в квадрате,
неравносильно, но как минимум влечет то, что здесь написано.
Равносильно оно будет, если сказать, что r и n взаимно просты.
Сейчас вроде понятно.
Да, вот нам нужно вот здесь, вот в этом утверждении,
чтобы r и n были взаимно просты,
и чтобы n вытай было не единица по модулю r,
коль скоро ине превосходит лог в квадрате.
Вроде так.
Но я докажу теорему без взаимной простоты.
А дальше, ну какое бы r я не нашел,
если я найду не взаимно простою,
ну тогда все, тогда мы третий шаг пройдем
и выдадим, что n составно.
Ну или на четвертый выскочим,
и выдадим, что n простою.
То есть на третьем или на четвертом шаге
мы с этим r разберемся.
А вот если r получится взаимно простым с n,
тогда мы двинемся сюда,
и вот здесь это уже будет актуально,
что вот этот показатель порядок больше, чем лог в квадрате.
Понятно?
Поэтому я в прошлом году
дополнительно доказывал прямо в теореме,
что r и n взаимно просты.
Это усложняло рассуждение существа.
А нам это как бы не нужно,
потому что все равно вот этот факт
мы будем использовать только
при доказательстве того,
что пройдя все проверки пункта 5
и ни разу не выскочив вот на составном,
мы таки правильно решим, что n просто.
Ну и вот это все,
что мы делаем,
а потом мы таки правильно решим, что n просто.
Вот мы только здесь,
в этом рассуждении будем использовать,
что это именно r с n взаимно просто.
Что это именно показатель.
Но если мы дошли до пятого пункта,
значит мы уже убедились в том,
что r и n взаимно просты.
Поэтому не нужно в теореме
дополнительно усложнять рассуждение,
достаточно доказать вот так.
Ну а доказательство вот какое.
Дейно очень простое.
Давайте
пусть
r
это минимальное число,
которое не является делителем,
не делит
произведение пари
от единицы
до квадрата логарифма n
n в степени минус 1.
Ну я так прихохатываю,
потому что это правда,
ну что может быть проще.
Вот мы хотим, чтобы r
нет, чтобы n в итой
не равнялась единице по модулю r.
Ну наверное нам надо выбирать такое r,
которое не делит вот это произведение.
Это довольно естественно.
Вот мы возьмем самое маленькое r,
которое не служит делителем
этого произведения.
Автоматом мы получим то,
что хотим. Вот это.
Вот это.
Это мы получим автоматом.
Правильно?
Получим.
Вот, но нам надо как-то обосновать,
что r не превосходит лог с пятой степени.
И все.
Буквально все, что нам нужно, это убедиться,
что r не больше пятой степени логарифма.
Смотрите, как мы это сделаем.
Но давайте заметим,
что вот эта величина,
она не больше,
даже меньше,
строго,
чем n
в степени,
ну, например,
лог
двоичный в квадрате n
попало.
Нет, неправильно.
Не в квадрате, а в четвертой степени
тараплюсь
в четвертой степени.
Ну, я просто n в степени
и без единицы оцениваю сверху
тупо, как анвиты.
А произведение
анвиты это n в степени сумм
ишит.
Ну, а сумма, это
лог в четвертой попало.
Тоже меньше строго, чем четвертой
степень попало.
А, слушайте, а она не меньше строго, да?
Черт возьми. Какая неприятность.
Я забыл, что сумма
это же
верхний предел,
на верхний предел плюс один.
Ладно, друзья, не переживайте,
я напишу на что-нибудь другое поделить,
и все будет хорошо.
Поделить на полтора.
Ну, у меня
n больше не равняется нулевого,
помните, да, поэтому я волен
поделить на что угодно, чтобы от этого плюс
не избавиться.
Так, друзья, я понятно изъясняюсь,
или я очень шустрю.
Сумма по и от единицы до
чего-то, это вот эта чего-то, на чего-то
плюс один попала.
Мне же сверху надо оценить, чего-то
плюс один, но это почти чего-то,
нам нужно плюс один.
Ну, я грубо оценил, там просто делал не надо
полтора.
Начиная с какого-то нулевого, это точно
можно сделать. В общем, это получается
у нас
в степени
лог двоичный в пятую степень
n поделить на полтора,
и
вся недолга. Ну, какую-то грубую
оценку написал, хотите мне полтора
напишите, один и девять десятых,
от этого ничего не поменяйтесь.
Сейчас вы увидите.
Так, теперь смотрите,
r это
минимальное
число, которое не является
делителем данного.
Но, значит, данное число
делится на все числа
меньше, чем r.
Давайте я его как-нибудь обозначу.
Вот, с одной стороны у нас получилось, что
а меньше
вот этой величины
е в степени лог двоичный
в пятую n поделить на полтора.
А с другой стороны мы его сейчас
снизу оценим, за счет того,
что r минимальное число, не являющееся
его делителем.
А точно больше
ну, либо равно, не важно,
чем произведение всех простых
чисел, меньше, чем
r.
Но если оно не делится ни на одно число
от 1 до r-1,
то оно точно не делится ни на одно из простых
чисел, которые r-1 не превосходит.
Здесь вот можно написать
какие-то p1
и так далее.
Давайте с каким-то индексом s,
где
p1 это 2, например,
а дальше мы просто берем их по возрастанию.
Все различные простые числа
такие, что
ps
не превосходит
r-i
Отличные простые числа
от двойки до максимального
простого, который не превосходит r-i.
Так,
слушайте,
ну, давайте я буду использовать
наше великое знание из области
теории чисел. Мы
знаем, что различных простых
непревосходящих данного
числа
сколько?
Примерно
это число поделить
логарифом этого числа.
Ну, я доказывал только
Чебушовские оценки строго.
Я написал симпатический закон распределения.
Вот это
s
количество этих простых чисел
оно ведет себя симпатически,
как r-1
поделить на логариф натуральный.
Ну, это
r поделить на логариф
r, понятное дело,
будет стремиться к бесконечности, когда
n растет. То есть если n очень
большое, то можно считать, что s
там как-то, например,
вот так оценивается.
s больше либо равняется там 1
минус епсилон
r на логарифмы.
Где епсилон вы вольны задавать
как угодно, но я просто не соображаю.
Полтора написать
0,9
не важно, сейчас увидите, что епсилон
подбирается. Я опять же не очень
быстро говорю, но вроде к этим точкам
должны быть все привычности.
Вот.
Мы считаем, что n велико, поэтому тут мы можем
тяп-ляп действовать.
Значит, есть некая теоретика числовая
лемма, которая позволяет обойтись
без асимпатического закона, но она требует
довольно больших усилий для доказательства,
а мы все знаем. Давайте воспользуемся,
знай.
Для чего мы учимся? Мы знаем
асимпатический закон, и мы воспользуемся.
Тогда что у нас получается?
Получается, что a больше либо
равняется 2 на 3
на 4
на s.
Даже можно сказать, видимо, на s
плюс 1.
Но не важно.
Ну, в смысле, что p1 больше либо равняется
2, p2 больше либо равняется 3,
p3 больше либо равняется 4,
ps больше либо равняется
s плюс 1.
Просто очередное простое
число не меньше, чем его номер.
Это совсем очевидная оценка.
Ну, давайте я напишу, что это
больше,
чем
s факториал,
например.
Ну и как это можно оценить?
Давайте я это оценю вот так.
Это больше, чем s
поделить на e
в s и c.
Ну, такую оценку мы точно обсуждали.
По индукции доказывается.
Не надо никакого стирлинга знать.
Это индукция по s с участием
определения числа.
Ну, как это записать?
Надо записать
вот так.
Это e в степени s
логарифмов s
минус s.
Так, s в степени s, это
e в степени s на логарифм s.
Ну и минус s, это вот это e в степени с
в знаменатии.
Значит, это равняется e в степени
1 плюс о малое от единицы
s на логарифм s.
При s растущем оно будет расти.
Так, и про s мы знаем,
что оно оценивается снизу вот так.
Мы можем вот так написать это e
в степени 1 плюс о малое
от единицы.
Так, s это 1
минус епсилон.
Ой, да-да-да-да-да-да.
R на логарифм r.
Так, а что такое логарифм от s?
Ну, логарифм от s это, конечно,
логарифм от r.
Асимптатически.
А асимптотику мы добавим
вот сюда. То есть вот этого маленькой
от единицы не такое, как здесь.
Оно в себя включает еще
учет вот того, что мы здесь
взяли логарифм и записали его тоже
асимптатически, как логарифм r.
То есть умножить
на логарифм r.
Шлёп, шлёп.
В нашем любимом стиле.
Ну, что у нас получилось?
А вот чего у нас получилось.
Если мы сейчас
предположим, товарищи,
что вопреки ожиданию,
ожиданию вот такой,
наша r больше
чем пятая степень
логарифма,
если мы предположим,
что r больше, чем пятая степень
логарифма,
тогда здесь будет больше
чем пятая степень
логарифма,
но там она на какую-то фигню
асимптатически равную единице
умножается,
еще на один минус
епсилон умножается,
но извините, но при маленьком
епсилон это же больше,
чем лог в пятой степени на полтора.
И мы приходим к противоречию.
То есть с одной стороны
а меньше, чем вот это выражение,
а если вдруг r больше,
чем пятая степень логарифма,
то оно больше, чем это выражение,
приходим к противоречию
и оценка вот эта доказана.
Совсем просто.
Ну, немножко анализа, как всегда,
такого вот асимптатического,
но вроде все совсем просто.
Получилась теория.
Прекрасно.
То есть я доказал действительно,
что r при больших n не больше,
чем пятая степень логарифма,
поэтому да, все хорошо,
сложность шага номер два тоже пройдет.
Итак, все.
Если мы дожили до шага с номером 5,
дожили до шага с номером 5,
то мы можем считать,
что r и n взаимно простые.
Действительно, показатель n
по модулю r вот такой.
Ну и все вот эти неравенства
на самом деле равны.
Знак равно стоит.
Есть l, равенство.
Давайте я это куда-нибудь и напишу.
Мы не знаем, n простое или непростое.
Мы хотим доказать, что n простое,
но пока как бы не знаем.
Поэтому давайте скажем так,
поскольку
показатель r
по модулю n
если есть желание делать перерыв,
я сделаю, но
можно не делать, мне кажется.
Ну нелепо, да, народу немного.
Значит, поскольку
это больше там, чем лог
двоичный в квадрате,
ну это в частности больше единицы,
локально нам хватит того, что это больше единицы,
но конечно мы вот этой оценки потом
тоже воспользуемся.
Не думайте, что я издеваюсь.
Пока достаточно того, что орд
больше единицы. Из этого следует,
что существует
p простое.
Такое, что
p
является делителем n
и
показатель
писал r
p по модулю r
больше единицы.
Вот он просто больше единицы,
хоть нельзя сказать, что он больше, чем лог в квадрате,
но во всяком случае он точно больше единицы.
Это важный момент.
Мы сейчас будем работать алгебраически
именно с этим p в конечном счете.
Так, ну
это утверждение, я думаю, понятно, да,
что не может быть, что все простые
в каноническом разложении n
имели показатель по модулю r
равный единице,
а у самого n по модулю r больше единицы.
Это было бы неожиданно.
Вроде очевидно.
Так, ну, давайте заметим, что
p, конечно, больше, чем r.
Почему p больше,
чем r? Ну, потому что мы преодолели
вот эти два шага. Опять же, мы
прошли этапы проверок
и понемногу меньше, чем r,
иначе мы бы этот p нашли
просто на шаге с номером 3 или 4.
Мы бы убедились,
потому что n равняется p и все.
Вот, поэтому p, конечно,
больше, чем r,
то вообще можно там написать, чтобы
не тратить место на плюсы.
p больше, чем r.
Так, ну, прекрасно.
Так, прежде всего, заметим,
что, конечно же,
x плюс a
в этой степени равно
x в p плюс a
по модулю
x в r без 1
и n,
и p.
Нет, ну, это просто то, с чего я начинал.
Это очевидно. p простое число
по определению, поэтому это факт.
Нам-то нужно, конечно, n простое,
но здесь вот какой-то делитель n,
в конечном счете окажется, что это само n
и есть, но пока вот какой-то
делитель n, который, конечно,
удовлетворяет этому соотношению.
Причем здесь можно брать даже
вот такие a от нуля,
ну, например, до l.
a можно брать любым, ну, например,
до l.
Мы просто хотим унифицировать
результат.
Кроме того, мы, конечно, знаем, что
x плюс a в n-й степени
равно x в n-й плюс a
тоже по модулю
x в r без 1, но здесь
можно писать n как
на пятом шаге
алгоритма, но, естественно,
можно писать и p, потому что p – это
делитель n. Если по модулю n
все получилось, то по модулю p тем более.
p – это делитель
тем более верный,
а здесь тоже меняется от нуля
до l.
Но
следующее утверждение я не буду
сейчас аккуратно обосновывать.
В принципе, мы когда-то записывали
рассуждение, которое аккуратно его поясняет.
Некоторым очевидно сходу, некоторым – нет.
Просто вот из этих двух
утверждений
на самом деле
в некотором образ следует
еще одно вот такое.
Ну, чуть-чуть не очевидно.
То есть вот так вот сходу может быть не совсем понятно.
Вот такое.
Ну, и здесь все то же самое.
Ну, как бы рассуждать,
как хочется, что если
здесь не равно, то возведем это все
в степень p, получим тоже не равно,
а у нас равно.
Ну, надо немножко аккуратнее.
Но, в общем,
это можно доказать.
Если будут какие-то вопросы, обсудим.
Ну, не сейчас,
не в концентрации, не в семинарах.
В общем, я
хочу вот эти два
патта,
не средний,
а вот эти два,
первый и третий,
некоторым образом хитро обыграть.
То есть я хочу сейчас
построить какие-то алгебраические структуры,
на которых меч-то будет
выполнен,
и доказать, что n просто
на счет этого.
Ну, смотрите, давайте
скажем, что
какой-нибудь f от x
многочлен
и m
натуральный.
Перестановочный друг
относительно друга,
перестановочный или переставляется,
не важно, нет никакого
стандартного русского термина,
это просто моя попытка как-то понятно
сформулировать, что имеется в виду.
Вот скажем, что многочлен
и число перестановочные,
если
f от x
в mт
равняется
f от x
в mт,
ну а по модулю,
по нашему модулю,
смотрите, модулька наш.
То есть я пытаюсь просто обобщить
то, что случилось
в этих трех пунктах
на какую-то более широкую
ситуацию,
на более широкий набор случаев.
Есть какой-то многочлен, есть какое-то число,
вот мы говорим, что они друг относительно друга
переставляются, вот если
выполнено то, что написано,
f от x в mт это то же самое, что
f от x в mт.
Ну, в данном случае f от x это x+,
и оно переставляется с p.
Видите, да, здесь аргумент в этой степени,
а здесь многочлен.
И здесь тоже самое.
Ну и здесь на самом деле нам хватит двух
внешних фактов.
В принципе, почти бы хватило даже
одного вот этого, но чуть-чуть там
не сойдутся оценки, поэтому важно
этот случай тоже рассмотреть,
который чуть-чуть
порцит понимаемость.
Ну, смотрите, какие очевидны
свойства.
Знаете, оформлю это как лему
или как утверждение, но это очевидно.
Очевидно, что
во-первых, если
f от x
переставляется
с
m1
и с m2, вот есть два числа,
с которыми он перестанут,
то
f от x
переставляется
с произведением
этих чисел.
Абсолютно очевидно.
Ну, цепочку вот этих вот штук
подстановить сделайте, и все.
Сначала одно подставляется, потом друг.
Давайте тут напишу второй пункт.
Второй пункт
лему немножко не влез вниз,
слишком мельчить не хочется.
Наоборот, если
f от x
и g от x
переставляется
что такое?
Переставляется
с m,
то
f на g
тоже переставляется с m.
Совсем очевидно.
Простое утверждение,
что
все можно перемножать.
Если мы знаем, что
с x плюс a при каждом
a от 0 до l
переставляется как p,
так и n поделить на p,
то мы можем
p возвести в любую степень,
умножить на вот эту дробь
в любой другой, или той же самой,
не важно, в любой степени.
И вот такое произведение
будет переставляться с произведением
x плюс a
по всем a от 0 до l.
Это сразу
следует из леммы.
Так,
я сейчас напишу.
Так, а вот это мне зачем
теорема?
Теорема мне не зачем.
Все.
Теорема мне уже не нужна.
Следствие
отсюда такое. Мы можем рассмотреть
два множества. Пока что просто множество
чисел и многочленов.
Вот это вот множество такое
n поделить на
p,
вытой на p
вжитой.
Здесь
уже
натуральные с нулем.
Я перестал морочить голову тем, что натуральные
числа содержат ноль, поэтому я на всякий случай
говорю, что пусть и ноль.
Вот.
Ну, просто любые натуральные числа.
А p это множество многочленов
вот такого вида. Это произведение
по...
Так.
Что тут надо написать?
Тут надо написать
x плюс a
на
какой-либо степени, совершенно
неважно, я с индексом a,
а тут будет от 0
до l.
Ea
больше
либо равно цены.
Такое множество многочленов.
Согласно Немме,
любой многочлен отсюда перестановочен
по отношению к любому числу из i.
p перестановочен, n на p перестановочен,
можем p как угодно умножать,
n на p как угодно умножать,
а переставляется он с чем?
С x плюс a в какой угодно степени,
где a какое угодно
от 0 до l.
Любые переставляющиеся многочлены
можно между собой перенаживать.
Вот это вот я с индексом a
это просто целое число,
больше либо равно 0, натуральное или ноль.
Да, конечно, конечно.
Ну, еще раз.
Мы же знаем, что x плюс a перестановочен.
Мы знаем, что если f и g перестановочен,
то их произведение перестановочен.
Поэтому x плюс a можно
возвести в любую степень.
Просто взять в качестве f x плюс a
и в качестве g взять x плюс a.
Потом в качестве h взять x плюс a.
То есть x плюс a можно
возвести в любую степень.
Но еще можно перемножить от 0 до l.
Нет, пока все совершенно формально,
все понятно, все хорошо.
Сейчас мне нужны будут групповые структуры
на вот этих двух множествах.
На них очень простая групповая структура.
Она будет совершенно понятна.
Давайте обозначим g
множество
различных
вычетов
по модулю r.
Вот этого r.
В множестве i.
Ну g это подгруппа
подгруппа
в ZR созвездочек.
То есть в мультипликативной группе
вот этого кольца ZR.
ZR не обязательно простое,
ZR не обязательно поле,
а может быть кольцо.
Но g это подгруппа в ZR созвездочек.
Берем все вычеты
вот этих чисел по модулю r.
Определение группы g должно быть
полностью понятна, мне кажется.
Давайте обозначим т
порядок этой группы.
Что понятно про t?
Про t понятно, что оно не превосходит r,
потому что это подгруппа
в ZR созвездочек.
Если будут бедливые слушатели,
которые захотят сравнить с прошлогодней
лекцией на ту же тему,
можно здесь, конечно, fiater написать.
Fiater это порядок ZR созвездочек,
а g это подгруппа
в ZR созвездочек.
Тогда вот здесь, в принципе,
можно, если вы внимательно потом
посмотрите на рассуждение, написать корень
не из R, а из fiater.
Поскольку я нигде не гнался
за реальной сложностью, мне было достаточно
чтобы степень логарифма,
то я в этом году посчитал
нелепом перегружать вас.
Вот как-то я в прошлом году нарисовал
здесь fiater, не подумал.
А сейчас, кажется, зачем?
Потому что fiater, если р вдруг простой,
это то же самое, что и R,
в принципе.
Потом, когда кто-то захочет
что-то оптимизировать, ну да,
вот здесь можно нарисовать fiater, будет
чуть меньше операций, в общем случае
может быть даже сильно меньше,
но это вот за счет того, что здесь T
можно написать не больше, чем fiater.
Но это неважно, мне хватит
того, что T не больше, чем R.
С другой стороны, смотрите,
да, это вот тут напишу,
что с другой стороны, T больше
чем лог двоичной
в квадрате N.
Ага, почему?
Почему?
Почему?
Вот сейчас
все-таки мы воспользуемся этим квадратом
логичного логарифма,
который вот тут вот присутствует.
Понятно почему?
Ну, потому что среди вот этих
чисел есть все возможные степени P,
просто.
Не, неправильно, не P, да?
N,
вот я сказал,
можно g заменить на i, вот тут
и тут i написать.
Тогда у вас останутся числа вида N в степени
и получится числа вида N в степени
N.
Ну, чисел N в степени
и по модулю R
различных, больше, чем
столько. Ну, значит,
порядок нашей группы точно больше,
чем столько.
Это вот важно.
Так, кажется, я
могу стреть верхнюю часть алгоритма,
потому что вот то, что здесь написано
до пункта 4 включить,
сработало. А это еще нам, ну, хотя
вот это пригодится, поэтому я пока
оставлю.
А?
А может, камера не дотянется
еще?
Ну ладно, в общем, я в любом случае
эти три пункта стираю,
левая часть доски точенькая.
У меня есть полное ощущение, что я сегодня
все расскажу. Надо было в четверт
наступать, но кто знал-то, я что-то как-то
раскочегался.
А вдруг не так?
Сейчас разберем.
Ну, в общем, уже все понятно.
Сейчас будет некая другая групповая
структура на множестве многочленов,
с которой, я думаю, не всем,
не все будет понятно. Но я четко
постараюсь сказать, и в прошлом году
я четко постарался сказать,
что надо знать, а что
не надо знать.
В деталях, если хочется разобраться,
там было уже семинара,
если они успеют,
они успеют,
тоже зависит от того,
по-моему, и просто, или по-моему, и математика
нас слушают, в общем, немного разные
знания. Ну ладно,
не все знает.
Значит, мы вот чего скажем.
Если мы посмотрим
на вот этот вот
X-верт и без единицы,
по модулу которого мы до сих пор
живем, всю перестановочность
мы определяли по модулу X-верта
и без единицы и П.
Если мы посмотрим на этот многочлен,
то
существует
его,
ну его, это вот этого
многочлена, делитель
h от x,
степень которого
равна
орду
r от p,
ну и стало быть больше единицы.
Мы так
p больше единицы
мы проговаривали, где-то это еще сохраняется.
Сохраняется
орд p больше единицы.
Важно не только, что его степень
больше единицы, он там не приводим
по модулю P.
Существует такой делитель,
степень которого равна
показателю, который по модулю
P является неприводимым
многочленом.
И самое главное,
это хорошо, это да, ну существует,
допустим, существует.
Надо поверить.
Более нетривиально в этом
следующее, что если мы
возьмем,
походишь ки-хо-хо,
вот такую вот структуру
zp от
x,
фактор по h от
x,
то вот эта структура будет полем.
Я не знаю, было ли в каком-нибудь курсе
алгебры
или теории колец и полей
кто-то про это, я всегда прошу, чтобы
рассказывать, но насколько хорошо
про это рассказали или плохо, я не знаю,
поэтому, в принципе, я готов
оставить это заскок. Вот такое знание
тут требуется, что то, что вот здесь получится,
это вот.
Да, h от x неприводим, я это
произнес.
Была, да, отлично, вот это вот
поле. Да, h от x
неприводим. В целом утверждение звучит
так, вот у нас есть x-верт и без единицы,
существует его делитель h от x
вот в такой степени, неприводимый
над zp, по модулю P,
и вот эта штука образует
поле.
И вот давайте рассмотрим пересечение
этого поля,
ну, как бы пересечение,
немножко некорректно так говорить,
с множеством P.
Некорректно, потому что в множестве P
живут многочлены, а тут
живут классы вычетов.
Ну, вычетов или как, классы
эквивалентности, классы
смежности по модулю h от x.
Ну, понятно,
что имеется в виду, то есть просто
вот это множество точно так же
профакторизуем по модулю P
и по модулю h от x.
И представители разных классов, которые
здесь присутствуют, рассмотрим.
В этом смысле рассмотрим
пересечение P и вот
этого.
И вот эту конструкцию назовем
G красивая.
Эхе, смотрите, какой она
красивая.
Если вам не доступно рисование
красивого G, у меня есть
гениальный способ, как рисовать
красивые буквы или готические
еще. Знаете готические?
Готические буквы надо рисовать вот
так.
Но это шутка, просто есть готические
буквы, которые действительно так вот,
типа вот такого.
А мы все буквы готические будем так
рисовать.
Хвостик такой привису, получится
готическая буква. Ладно, это я
издеваюсь немножко.
Вот,
ну,
какую хотите букву напишите,
я называю G красивая.
Вот G красивая, еще раз, это
в кавычках пересечение вот этого поля
с вот этим P.
Но это группа, безусловно.
Это подгруппа мультипликативной
группы вот этого поля.
Вот так. Подгруппа
мультипликативной группы вот этого поля.
Так.
Не потерялись пока?
Вот есть две
алгебраических структуры.
G это группа, которая выбрана
из множества I, построена
на основе, скажем так, множества I.
А G красивая
это группа, построенная на основе
множества многочисленных.
И сейчас будет
самый катарсис.
Ну, не сразу,
но я его предвосхищу, то есть я сообщу
на основе чего будет катарсис.
Итак.
Теорема 1.
Теорема 1
я не целиком докажу, а
теорема 2, наверное, прям целиком.
Значит, теорема 1
утверждает, что
порядок
вот этой группы G красивая
не меньше, чем
Cист
по T-1.
Наверное, мне вот от всего,
что здесь написано, нужно только
значение L. Давайте я его сюда
выпишу.
Что L это корень из R
налог двоичный N.
И что там просто прошли столько
проверок, которые нам дали вот эту
перестановочную.
Я все могу тогда
стереть.
Сейчас я вам всю схему
расскажу, чтобы вы понимали, как
получается, что алгоритм сходит.
Итак, вот мы докажем вот это
до какой-то степени. Я пропущу
кусок доказательств, но вы поймете,
смысл будет совершенно понять,
почему такой порядок.
А с другой стороны, мы докажем
теорему 2. Я вот сразу
весь список оглашу.
С другой стороны, мы докажем
теорему 2, которая
говорит, что если
N
не равняется P в катой степени,
ну мы помним, P это простой делитель N.
Вот если N
само не является степенью
вот этого самого простого,
если N не равно P в катой,
то
порядок группы G
не превосходит N
в степени коренист T.
Конкурирующая оценка.
Ну и теперь
смотрите.
Вот я L специально выписал.
Про
T тут тоже кое-что сказано.
Вот это важно. Ну и вот это важно,
и вот это важно.
Здесь про T сказано.
Мы, с одной стороны, оценим
вот эту цешку, ну в духе
того, как мы асимптотики там разные считали,
вот эту цешку оценим.
И мы увидим,
что при нашем выборе параметров,
вот как выбрано L,
вот эта цешка,
в свою очередь, больше,
чем N в степени коренист T.
Понимаете, что это означает?
Это означает, что одна оценка
противоречит другой.
Мы убедимся в том,
что L выбрано так, чтобы вот эта штука
была больше, чем N
в степени коренист T.
Что отсюда будет следовать?
Отсюда будет следовать, что N
это P вкатый.
Но мы же
проверили на самом первом шаге
алгоритма, что N не является
полной степени никакого числа.
Все, из этого следует,
что N равно P.
И мы правильно сказали, что оно
простое. На шестом шаге.
Понятно в целом идею?
Что сделав вот такое
количество проверок,
мы организовали достаточно
жирные структуры
групповых на множестве
чисел и многочленов, которые друг
относительно друга в известном смысле
перестановочных.
Настолько жирные, что порядок уже очень
большой. И если бы N
было не степенью P,
то порядок был бы маленький,
мы бы пришли к противоречию.
Поэтому N это точно степень P,
а поскольку эта степень явно не
вторая, не третья, мы это проверили на первом шаге,
то все, N равно P,
и мы доказали корректность алгоритмы.
Нормально?
Ну, надо
доказать вот это и надо доказать вот это
и еще надо выкладку продолжить.
Может и не успею все со всего.
Надо сделать три вещи. Надо доказать теорему
один по модулю каких-то фактов, теорему
два и продолжить
здесь выкладку, чтобы она вступила в противоречие
я сейчас этим не радуюсь.
Три пункта остались в нашей программе.
Ну, давайте, теорема один.
Поскольку мы не до конца понимаем
природу вот этого многочлена h от
x, мы только понимаем, что он почему-то
неприводимый по модулю P
и мы знаем, что вот это вот будет поле.
Поскольку мы все-таки не
до конца понимаем, что такое h от
x, я пропущу
следующее утверждение.
А, только
единственно, сейчас до этого утверждения
я еще вот чего скажу
или это сейчас
не важно. Не, ничего не буду говорить.
Ничего не буду говорить. Вот просто
в доказательстве теоремы один
пошло оно, доказательство теоремы
один. Я
сформулирую утверждение
без доказательства.
Ну, желающие могут разобраться
и доказать. Утверждение
такое, если
f и g
это
многочлены
из множества P, просто
вот из такого множества P,
из P
в степени
не больше t-1
или строго меньше t, как
хотите. Если даны два многочлена
вот отсюда, каждый из которых
имеет степень строго меньше
чем t, не больше чем t-1,
то
в g красивом
они
различные.
Ну, может быть
надо сказать не различные, а принадлежат
разным классам, чтобы было совсем понятно.
То есть, после
редукции по модулю h от x и P
мы получаем разные
элементы группы g.
Ну, я не прошу это доказывать,
потому что мы не знаем до конца, что такое h от x.
Просто вот в это утверждение
придется поверить.
Если многочлены не очень большой
степени, то они после
редукции по модулю
попадают в разные классы вычета.
Теперь смотрите.
Вот давайте
в этот поверь.
Давайте рассмотрим
многочлены вот такие.
x, x плюс 1,
x плюс
n.
Ну, то есть, просто вот здесь e, a, t
возьмем единицей,
а а у нас будет
каждый раз какое-то.
Ну, просто возьмем вот эти x, x плюс 1
и так далее, они тут присутствуют.
Дорогие друзья, понятно,
что они разные по модулю h от x.
Ну, конечно,
потому что степень его больше единиц.
Уж это
мы про h от x знаем.
Совсем очевидно.
Степень его больше единиц,
поэтому по модулю h от x они разные.
Я утверждаю, что по модулю p
они тоже разные.
Почему?
Но мне достаточно доказать, что l
меньше, чем p.
Давайте попробуем понять, почему l
меньше, чем p.
Так.
l,
еще раз, это корень из r, давайте
оттуда перепишу просто на лог
двоичный n.
Надо, чтобы оно было меньше, чем
p.
Так.
Как бы это понять?
p у нас больше, чем r.
Нам надо, чтобы
это было меньше, чем
r, а это
больше, чем p.
Почему корень из r
на лог двоичный n меньше,
чем r?
А потому что, наверное, корень из r
больше, чем лог двоичный n.
А это то же самое, что
r больше, чем лог
двоичный в квадрате n.
Но это правда.
r больше либо равняется t.
Значит, вот отсюда следует
действительно.
Вот так вот.
Р больше, чем лог двоичный в квадрате n.
Отсюда следует
вот так снизу вверх, что корень из
r больше, чем лог n.
Но отсюда следует
то, что даже вот так вот лучше.
Отсюда следует вот это.
Вот это отсюда следует.
Корень из r больше,
чем лог n, поэтому корень из
r умножить на лог n меньше, чем
r.
Вроде правильно.
Ну, а r меньше, чем p
это вот здесь вот зафиксировано.
r меньше, чем
за счет третьего-четвертого шага алгоритма.
Мы выяснили.
Вот, поэтому l действительно меньше, чем p.
Все получилось, все подобрано гениально.
Значит, вот эти вот
многочлены первой степени, они
все разные внутри
же окрасивы.
Но не только они все разные.
Внимание!
Товарищи!
За счет утверждения
разные все многочлены,
которые можно получить,
перемножая этих товарищей
так, чтобы получилась степень не выше
t без единицы.
Так, что, кокнул, что ли?
Ну, мы перемножаем вот этих товарищей
так, чтобы получилась степень не выше
t без единицы.
Они разные согласно утверждению.
Вот сколько разных
многочленов, например, степени
t-1 в точности
можно сляпать, имея
l-plus-1 многочлен?
Первой степень.
Как это называется, товарищи?
Это число
сочетаний с повторениями.
Могут повторяться
вот эти товарищи, чтобы образовать
степень какую-то
и сочетаться так, чтобы в итоге
получилась t-1 степень.
Сочетаться нам не важно, порядок со множеством.
Поэтому, если
зафиксировать t-1 степень,
то их получается вот столько.
c из l-plus-1 по t-minus-1
с чертой.
Тут их l-plus-1,
то мы выбираем из них t-minus-1
без учета порядка.
Ну, это, как известно, не c из l-plus-1
плюс
t-minus-1-minus-1
по t-minus-1
шпок
шпок
шпок-шпок
шпок-шпок
А, ну да, это равно
c из l-plus-t-minus-1
по t-minus-1
Ну, а дальше
складываем просто.
Ну, тут не t-minus-1 будет, а t-minus-2, t-minus-3.
Вот вам тоже, честно.
Ну, это я сейчас зафиксировал
t-minus-1, а меня интересует
в многочленной степени не больше, чем t-minus-1.
Я могу отдельно зафиксировать
t-minus-2, t-minus-3.
У меня получится сумма вот таких цешек.
Она точно равна тому, что
написано справа в теоремиатике.
Согласно там тождеству номер 6, кажется.
Из которого следовали
всякие истории про суммы квадратов
и так далее.
Вот. Так что
теорему 1 по модулю вот этого утверждения
я доказал.
А тут вот, я думаю, все понятно.
Сука.
Какой ужас.
Так, ну, чего можно
стирать?
Так, что можно стирать?
Прям вот, совершенно не понятно.
А, вот это вот можно стирать. Точно.
Племма про перестановочность,
она очевидная, она давно
использована.
Ну, в принципе, все, вы помните,
все можно стирать. Ну ладно, давайте вот так
поставим.
Пока.
Так.
Еще. Теорему 2 докажем.
Наверное.
Теорему 2.
Теоремы 2.
Давайте
еще
сделаем. О!
Давайте
рассмотрим все
числа вида
n на p
вытой умножить на p вжитой,
вот отсюда, из и большого.
Пока, просто все эти числа.
Но не все числа, а рассмотрим все
числа такие,
что ноль меньше либо равняется
и меньше либо
равняется целая часть от корни
из t, то же самое сжи.
Сжи тоже в пределах от нуля
до целой части
из корни из t. Сейчас будет принцип
Дерехле просто.
Вот рассмотрим не все и и большое,
а только ограничим его на и маленький
в этих пределах и ножи маленькие
в тех же сахарах.
Так, сколько у нас получилось
чисел?
Ну целая часть плюс один умножить на целая
часть плюс один.
Давайте напишем их, не путать
с ux, их
так,
целая часть от корни из t
плюс один в квадрате.
Это строго больше, чем
t.
Вот я обещал, будет
принцип Дерехле. Что значит их строго
больше, чем t?
t напоминается порядок группы g,
которая состоит из различных вычетов
по модулю r.
А у нас чисел больше, чем
t.
Понимаете, что какие-то два совпадают
по модулю r.
Есть два числа
вот такого вида, какой-нибудь m1
и какой-нибудь m2,
с какими-то разными
иежи, которые совпадают
по модулю r. m1
не равно
m2, но
m1 сравнимо
с m2
по модулю r.
Так, сейчас, уследились, нет?
Чисел больше t,
потому что мы и взяли в пределах
от 0 до целой части корни
из t иежи.
Их строго больше, чем t.
t это по определению порядок
группы, которая состоит из вычетов
по модулю r вот в этом множестве.
Но если чисел
больше, чем порядок этой группы,
значит есть два числа, которые сравнимы
с собой по модулю r.
Два одинаковых элемента
из этой группы,
но при этом разных числа.
Группы, как числа, они разные,
а в группе они совпадают.
Прекрасно. Что из этого следует?
Сейчас вот этот перестановочник тоже
сотрем.
Так, что отсюда следует?
Отсюда следует,
что х в степени m1
равно
х в степени m2
по модуле х в р
и без единицы.
Понятно к чему?
Ну, давайте поясню.
Давайте считать, что m1
больше, чем m2.
Строго больше, чем m2.
Без ограничений общности считаем,
что m1 строго больше, чем m2.
Выносим х в степени
m2 за скобку.
В скобках остается х в степени
m1
минус m2
минус 1.
Ну, m1 сравнимо
с m2 по модуле?
Значит, разность m1 и m2
это нечто кратное r.
Вот тут вот стоит
какая-то k помножить
на r.
Ну, слушай, ну понятно, что х в степени
k r минус 1 делится на х в степени r
минус 1.
Ну, это вроде школьная
фотография.
Нет?
Понятно, да?
Ну, прекрасно. То есть я поясню.
Давайте я это пояснение сотру.
Все, у нас
получилось вот это.
Ну, раз получилось вот это,
я могу здесь дорисовать что угодно.
От этого, конечно, справедливость в утверждении
не поменяется.
Ну, добавил этот модуль просто для
общности, для полноты картины пока что.
А дальше, извините, я еще могу
вот так сделать.
Ну, аж
от х отделить х в р
по определению.
Поэтому я вместо модуля х в р
и без единицы могу взять модуль аж от х.
Тоже правда.
Почему бы это все?
А к тому, что по модулю аж от
х и п, как известно, у нас получилось
поле.
Сейчас, товарищи, будет тоже катарсис.
Смотрите, вы понимаете,
вот это вот мы сейчас работаем в поле.
Потому что работаем по модулю аж от
х и п. А в поле, товарищи,
ну, формально я, может, не доказываю,
только в ZP это доказываю.
Ну, ZP это поле. В любом поле,
в любом, абсолютно.
Справедливое утверждение о том,
что корней у многочлена
данной степени не больше,
чем его степень.
Как бы этим
воспользоваться?
Смотрите, как мы этим воспользуемся.
Мы же с вами, товарищи,
знаем,
что каждый вот такой вот
многочлен
перестановочен
с каждым числом отсюда,
переставляется с каждым числом отсюда.
Давайте возьмем любой
многочлен, так это F,
любой многочлен,
принадлежащий G красиво.
Вот представитель своего класса
в этом поле, в этой группе,
живет какой-то многочлен.
Возьмем любой многочлен.
Понятное дело, что
раз выполнено вот это,
то выполнено вот это.
По тому же модулю не лезет,
я и не буду писать по этому модулю.
По тому же самому модулю.
Просто взяли F отсюда, F отсюда,
конечно, равенство сохранилось.
А теперь пользуемся
перестановочностью. Получаем, что
F от X в m1
равняется
F от X
в m2.
То есть F от X является
корнем
вот этого уравнения.
Давайте я уравнение вот так обозначу.
Y в m1 минус Y в m2
равняется нулю
по соответствующим двум модулям
полевым.
Вот у этого многочлена
все элементы
G красивого являются
корнями.
Все элементы G красивого являются
корнями этого многочлена.
Ну, значит порядок группы
количества многочленов
в этой группе не больше
чем m1,
чем степень этого многочлена.
М1 больше чем m2
мы это зафиксировали.
Степень этого многочлена m1
все многочлены, все элементы вот этой группы являются корнями этого многочлена над полем,
значит их не больше чем степень. Ну а чего m1 не превосходит, если оно имеет вот такой вид,
где и не больше чем корень исты, и g не больше чем корень исты, но вот очевидно оно не больше
чем n в степени корень исты и все. Очевидно, да? Все. Все. Это не больше чем n в степени корень исты.
Такое вот сочетание принципа Дерехле и гениального факта о том, что в поле не
бывает больше решения многочлена, нежели его степень. Итак, у нас осталось 3-4 минуты,
сейчас я вам докажу выкладку. Вы думаете не докажу, а я возьму и докажу. Четверг не будет
лекции, все, можете все передать. Ну может я чуть-чуть задержу, но это почти очевидная выкладка.
Сейчас все будет.
Так, смотрите, c и t плюс c по t минус 1. Дайте так. Я сходу не соображаю l больше чем t или
меньше чем t, но я думаю, что это не очень важно. Во-первых, я, наверное, а, но это не очень важно в
том смысле, что в зависимости от того, какое из них больше, ну мы оценим либо как c из 2t,
либо как c из 2l. Так, согласны, что вот это вот точно больше, чем c из 2t по t минус 1,
но точно больше, чем c из 2l по t минус 1. А, нет, неправильно, не точно больше и того и другого,
а больше, чем минимум. То есть вот это верно, если вот это верно, если l больше чем t, а это
верно, если l не больше, чем t. Ну да, больше не правильно. Для единообразия не важно. Если l
больше, чем t, ну конечно, c из t плюс l мы можем оценить как c из 2. Сейчас l больше, чем t,
тогда тут 2l, что ли. Знаете, l больше, чем t, а нет, c из 2t, все правильно, l больше, чем t,
поэтому t плюс l больше, чем 2t, все правильно я написал. Так, l не больше, чем t, значит,
наоборот, t оцениваем снизу как l, получаем вот это неравенство. Это неравенство, верно,
всегда. Ну, протормозил на очевидном месте, поэтому получил звонок, но сейчас все будет,
товарищи. Знаете, любой из этих случаев рассмотрим, ну каждый. Что мы знаем про t? Про t мы знаем,
что это величина. Сейчас, вот t больше, чем л в квадрате n. Так, значит, t больше,
чем л в квадрате n. Это корень из t больше, чем л в двоичной n. Так, поэтому мы можем сказать,
что t больше, чем корень из t на л в двоичной. Следовательно, согласны? Ну, вроде, согласны.
Так, t больше, чем корень из t на л в двоичной n. Так, ну, смотрите, c из 2t по t это есть по t
минус 1. Это есть 2 в степени 2t на 1 плюс о малое от 1. Ну, это наша стандартная оценка при тест
тремячности в бесконечности. c из 2t по t или c из 2t по t минус 1 это 2 в степени 2t с точностью.
Ну, можно наверху написать, можно внизу этого малое от 1, как я писал. Мне почему-то сейчас так захотел.
Так, все понимают, что это то же самое, что 2 плюс о малое от 1 в степени 2t. Какая разница? 2 в
степени 1 плюс о малое от 1 это 2 плюс о малое от 1. К этому надо уже привыкать тоже. Итак,
вот оно такое. Тогда, что у нас получается? Что ж такое-то сейчас? Что-то я не то пишу или то. А,
нет, то! Все! Смотрите, t больше, чем корень из t на л в двоичной n. Значит, 2 в степени 2t больше,
чем 2 в степени 2 корень из t на л в двоичной n и на 1 плюс о от 1. Просто подставил вместо t вот
эту смешную оценку. Ну, так что у нас получается? 2 в степени л в двоичной n это n, у нас получается
n в степени 2 корень из t на 1 плюс о малое от 1. Согласитесь, это гораздо больше, чем n в степени
корень из t, которым мы оценили в конкурирующем случае. Понятно, да? Все! Ну, это, конечно,
предполагается, что n достаточно большое, но я с самого начала сказал, что с маленькими можно
работать на теплях. Это вот в первом случае я оценил. Ну, давайте l-ку точно также оценим. Я уже
где-то ее тут оценивал, правда, сверху. Ну, сейчас снизу оценим. l это корень из r на л в двоичной n.
Так, r у нас больше, чем t. Это больше либо равняется корень из t на л в двоичной n. Подставляем
сюда, получаем то же самое. В обоих случаях оценка сильно больше, чем та, которая была бы,
если n не равно p в степени k. Я единственное, что почему-то забыл про говорительное,
я думаю, все поняли это условие, что n не равно p в степени k. Оно как раз используется для того,
чтобы все вот эти числа были разными, сами числа чтобы были разными. Поняли, да? Когда вот мы
дирихлили, там рассматривали и в каких-то пределах, и в каких-то пределах, у нас получались разные числа,
потому что n это не полная степень p. Это очень важно, потому что они не разные, но сравнимые по модуле.
Возвращаемся к доказательству теоремы 2. Ну все, видно, что и в этом случае, и в этом случае мы
получаем вот такую вот величину, и теорема доказана. Все, я алгоритм доказал.
