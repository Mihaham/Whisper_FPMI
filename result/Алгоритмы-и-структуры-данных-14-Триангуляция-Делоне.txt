Итак, всем здравствуйте.
Мы продолжаем тему, близкую к диаграмме Воронова.
Сегодня будет реангуляция Делане.
Вот это очень-очень родственные вещи.
Посмотрим, как они связаны.
Ну давайте начнём с того, что такое реангуляция.
Мы уже знаем, что такое реангуляция многоугольника.
Когда мы проводим диагональки так, чтобы они не пересекались
и всё разбилось на треугольнике.
Вот.
А сегодня у нас будет реангуляция множества точек.
Не многоугольников, а именно множество точек.
Пусть дано множество точек.
Что такое реангуляция?
Давайте на картиночке сначала.
То есть теперь точкой могут быть внутри выпуклые оболочки.
Ну и реангуляция, это когда мы проводим отрезки между
какими-то вершинами, то есть между элементами множества,
между точками множества.
Ну и так, чтобы на картинке все грани получились треугольными.
Вот.
Значит, формально давайте напишем следующее.
Реангуляция.
Это у нас что точек?
Значит это совокупность треугольников с вершинами
в данных точках.
Причем любые два треугольника либо не пересекаются, либо
пересекаются по вершине, либо пересекаются по стороне,
по общей стороне.
Либо они пересекаются вообще, либо пересекаются по общей
вершине, либо пересекаются по общей стороне.
Вот.
И при этом объединение всех треугольников – это
выпуклая оболочка исходного множества точек, или иными
словами мы максимизируем число треугольников.
То есть мы строим, ну то есть как бы вот, представьте,
что у нас был исходного множества точек, мы там
рисовали какие-то треугольники, один за другим рисуем-рисуем-рисуем,
до тех пор пока можем.
И это будет как раз в том случае, когда у нас будет,
ну их объединение будет совпадать со всей выпуклой оболочкой.
Значит, более того, объединение всех треугольников совпадает
с выпуклой оболочкой исходного множества точек.
Вот.
Значит, ну мы проводим какие-то треугольники, так что в объединении
была вся выпуклая оболочка.
Значит, пример, что, например, не является треангуляцией.
Сейчас что-нибудь нарисую, как-нибудь вот так вот.
Вот это не треангуляция.
С жирными выделил вершинки множество, соответственно,
провел какие-то треугольники.
Проблема в том, что, например, вот эти вот два треугольника
пересекаются по какому-то куску, как бы эта сторона
вот этого треугольника, но для второго треугольника
это не сторона, а кусок стороны.
Вот такого мы хотим избегать, мы хотим, чтобы если пересекаются,
то как бы по целиковой стороне, не по части стороны, а по
стороне целиком.
Ну и поэтому, соответственно, если мы хотим треангуляцию,
то нам придется вот здесь провести такую еще диагональку,
чтобы это как раз вот подразвить все до треугольников, так
что пересечение любых двух было сторона, точка или
пустое множество.
Вот.
Ну что такое треангуляция?
Дальше.
Мотивация.
Зачем это?
Может быть, нужно?
И что мы хотим вообще от треангуляции?
Представь себе такую задачу.
Мы моделируем ландшафт какой-то поверхности.
То есть вот есть у нас там какой-нибудь, не знаю, географическая
задача, какая-нибудь большая площадь, там гора, реки,
что-нибудь.
В общем, какой-то ландшафт.
В каких-то точках, соответственно, у вас высота побольше, в
каких-то высота поменьше.
Ну и вы хотите как-то в компьютере задать эту поверхность
какую-то там, какую-то такую штуку, которая где-то
высокая, где-то низкая и так далее.
Понятно, что мы не можем задавать это как непрерывное
множество, непрерывное отображение из плоскости
XY высоты на уровне моря в каждой точке.
Потому что непрерывные функции мы задавать не можем в компьютере.
придется дискритировать. Вот, ну и можно, например, дискритировать следующим образом. Вот есть у вас,
так, давайте так так так вот нарисую. Вот есть у вас плоскость xy, вы в нескольких точках могли
померить высоту вот этой вот точки над уровнем моря, то есть вот есть у вас здесь какой-то ландшафт,
там какая-то гора, например. Вы знаете высоты вот в этих вот точках, то есть вы знаете, что эта
точка идет сюда. Высота здесь вот такая, здесь высота вот такая, здесь высота такая, и так далее,
и так далее. И вам нужно как бы по известным высотам в данном множестве точек как можно
более точно приблизить исходный ландшафт. То есть опять повторяю, мы не можем его восстановить
однозначно и непрерывно. Ну как бы понятно, что там физические всякие штуки, они непрерывные. Но мы
не можем это явно хранить, нам придется как-то дискретизировать. Ну давайте тогда сделаем следующее,
давайте мы построим на этом множестве точек какую-нибудь triangуляцию. Вот тут я от балды что-нибудь
нарисую. Вот. И дальше смотрите, если у меня в плоскости есть треугольник, я знаю, какую высоте
соответствует каждый из его вершин. То есть я знаю, что эта точка соответствует этой точке в пространстве,
эта точка вот эта, эта точка вот эта. Значит тогда дальше я могу просто построить в пространстве вот
этот поднятый треугольник. То есть я каждую точку поднимаю на свою высоту, собственно провожу
плоскость через эти три точки в пространстве, и у меня получается какой-то кусок нашей поверхности,
такой треугольный кусок нашей поверхности. Вот. Соответственно, если я полностью
триангулирую всю свою проекцию на плоскость, то есть все вот эти, на всех этих точках построю
триангуляцию, и все треугольники так подниму, у меня получится вот какая-то такая картинка.
Будет что-то такое. Да, то есть как бы у меня, я представлю свою поверхность как набор треугольников,
сшитых по сторонам, и при этом здесь опять все будет непрерывно. То есть да, здесь конечно какая-то
довольно грубая аппроксимация, потому что мы вообще не можем предсказать, какая высота там у
какой-то точки, не лежащая в нашем множестве. Ну вот лучше, что можем сказать, такая-то линейная
аппроксимация от каких-то трех ближайших точек, грубо говоря. Ну соответственно, мы ровно так и
делаем. Мы каждую точку погружаем в один из этих треугольников и приближаем наш ландшафт именно
вот такой вот кусочек непрерывной, кусочек линейной даже функции, что мы на каждом треугольнике,
ну у нас в каждом треугольнике какая-то линейная функция координата x, y, и соответственно,
мы эти треугольники сшили так, чтобы у меня получилась непрерывная функция, непрерывная поверхность.
Вот понятно более-менее. Вот хорошо, значит, зачем это может быть нужно. И более того,
давайте рассмотрим еще такой пример. Вот пусть в плоскости x, y дали следующие высоты для точек.
Скажем, у меня есть куча точек на одной прямой, про которые я знаю, что высота, ну там давайте
скажем 0, и здесь тоже куча точек, для которых я знаю высоту равную нулю. Вот, а здесь где-то по центру
есть куча точек высоты, ну там не знаю, 100, ну или что-то близкое к сотне. Давайте везде
напишу просто 100 для простоты. Значит, соответственно, примерно в такой картинке есть у вас какая-то гора,
а здесь какая-то равнина. И вот они все уходят туда, в задоску. Вот здесь везде высота 0, вот здесь и
во всех точках как бы за ней. Вот здесь везде высота 0, а здесь вот вы померили, в этой координате,
у вас тут получилась высота 100. Ну соответственно, все вот эти вот точки, на этом горном хребте вы
померили высоты, здесь везде получилось сотня, а здесь нули. Вот. И нам нужно, соответственно,
тоже здесь построить какую-то triangulation, чтобы попытаться приблизить этот ландшафт,
эту поверхность, ну вот, вот таким вот образом. Значит, здесь есть единственная загвоздка,
например, давайте я нарисую какую-нибудь такую triangulation. Сейчас. Как я ее нарисую?
Ну вот, например, вот такую давайте нарисую треугольник. Да, то есть понятно, что на самом
деле, если я нарисую какой-то один фиксированный треугольник, то это можно всегда дополнить до
triangulation, там в этом конкретном случае там что-нибудь вот такое вот будет. Ну и ладно, типа. Ну
как-то там я это могу дотреангулировать. То есть главное, что давайте возьмем вот такой треугольник,
который содержит две вершины в первом столбце и одну вершину в третьем столбце. Тогда у меня
получается, как бы, что поскольку все эти точки находятся на высоте ноль в результате измерений,
то у меня этот треугольник целиком лежит в плоскости x, y, ну то есть вот, короче, на нулевом уровне.
И, соответственно, я тогда говорю, что у меня вот этот вот мой горный хребет, он прерывается,
в моей дискретной аппроксимации, он прерывается каким-то куском нулевой высоты. Тут как бы сотня,
сотня, сотня, сотня, так дискретно. Тут отрезок нулей, потом опять сотня, сотня, сотня. Вот. Ну это
как-то не очень естественно. То есть мы бы хотели, ну там, что-то близкое к сотне иметь на
всей вот этой вот прямой. Вот. И здесь проблема основная вот этого треугольника в том, что он,
так называемый, тонкий треугольник, потому что у него очень маленький вот этот вот угол. То есть
какой бы мы хотели триангуляцию? Мы бы хотели триангуляцию в стиле вот такой. Ну что-то вот такое.
Вот это прям идеальное что-то. В данном конкретном случае вот такая треангуляция была бы оптимальной.
Вот. Ну и соответственно этот треугольник отличается от всех этих тем, что у него есть
один угол, который очень маленький. Вот. Ну и отсюда возникает такое интуитивное
понимание, что нам хочется не иметь треугольников с маленькими углами. То есть формально нам
хотелось бы найти треангуляцию, в которой минимальный среди всех углов треугольников максимально
возможен. То есть хотим максимизировать минимальный из углов всех треугольников.
Все в треугольниках. Ну понятно, что как бы тут тяжело доказать, что максимизация
минимального угла дает нам наиболее хорошую опроксимацию. Ну это вообще как бы тяжело
формализуемое утверждение, потому что не очень понятно, что там хорошая опроксимация ландшафта,
который мы толком не знаем. Да, но можем только что-то интуитивно про него предполагать. Вот. Ну
как-то вот отсюда примерно можно сделать вывод, что нам невыгодны тонкие треугольники. То есть те,
которые очень сильно растянуты, потому что, собственно, маленький угол где-то, значит,
что в другом месте есть большой угол, но и вот какой-то такой длинный и тонкий. Соединяет точки,
находящиеся как бы на большом расстоянии, про которые, по сути, мы, ну, про взаимосвязь,
в которых мы ничего не должны уметь говорить, мы, наоборот, хотим говорить что-то только про такие
толстенькие треугольники, где все точки рядом друг с другом. Вот. Ну и, соответственно,
треангуляция Дилана, в частности, вот этим способством обладает, что среди всех возможных
треангуляций минимальный угол в ней максимально возможен. Вот. Ну, к этому мы еще чуть-чуть позже
вернемся. Это пока такая мотивация. Сейчас давайте опять просто про треангуляции поговорим.
Пусть в множестве P N точек. Ну, давайте я сразу буду говорить сайтов, потому что у нас, в общем,
алгоритм будет практически такой же, как в алгоритме построения диаграммы Воронова. И чтобы
опять различать какие-то вершины, получаемые в результате работы алгоритма, и исходные точки,
по которым мы строим треангуляцию, давайте я это тоже буду называть сайтами. Итак,
пусть в множестве P N сайтов. На выпуклой оболочке P. Ну, давайте, на границе выпуклой оболочке.
На границе выпуклой оболочке P. К сайту.
Тогда любая треангуляция множества P
содержит 2N-K-2 треугольника и 3N-K-3 ребра. То есть опять такая лемма, которая нужна нам
только для того, чтобы понять, что размер треангуляции всегда линейен. То есть если всего N сайта в исходном
множестве, K из которых лежат на границе, то тогда треугольников линейное количество и
ребра линейное количество, то есть мы можем все это в линейную память уместить. Доказательства
здесь опять-таки формула Эллера. Причем здесь уже нам не нужно заботиться о том, что это там не
граф, как это было в случае с диаграммой Воронова, потому что были какие-то бесконечные лучи. Здесь
такого нет. Здесь все ребра – это просто отрезки. Соответственно, вершины – это сайты. Ребра – это
стороны треугольников. Связано здесь тоже автоматически следует из-за того, что покрытие – это
вся выпуклая оболочка, что все треугольники в объединении дают свою выпуклую оболочку. Ну раз
мы можем добраться по выпуклой оболочке между любой парой точек, значит между треугольниками
тоже можем добираться как угодно. Поэтому просто применяем формула Эллера. У нас вершин. Сколько
у нас вершин? Вершин в точности N по числу сайтов. Дальше – грани. Пусть грани у меня будет m плюс
1, где m – это внутренние треугольники, нормальные треугольники треангуляции, а 1 – это внешняя
грань, как бы все кроме выпуклой оболочки. То есть m треугольников и 1 внешняя. Потому что если у
меня есть какая-то треангуляция кого-то на что точек, вот такая, например, то у меня есть грани,
отвечающие треугольникам, и еще вот эта вот одна внешняя грань, тоже грань планарного графа,
все кроме, собственно, выпуклой оболочки. А ребер здесь? Сколько здесь ребер? Ну, я утверждаю,
что 3m плюс k пополам. 3m плюс k пополам. Значит, почему? Потому что каждая внутренняя грань дает нам по
три ребра. Каждая внутренняя грань дает по три ребра, потому что все грани треугольники. И тогда
у меня каждое ребро будет учтено дважды, потому что, ну, каждое обычное ребро, оно двум треугольникам
инцидентно, кроме ребер, которые лежат на, собственно, границе выпуклой оболочки. То есть все
ребра внутри будут посчитаны дважды, поэтому я поделил пополам, а все ребра на границе будут
посчитаны один раз. То есть вот эти вот все ребра, они инцидентны только как бы одному ребру, дающему
вкладку число ребер. Вот. Ну, то есть здесь 3m, да, а не 3m плюс 1. И, соответственно, мне нужно еще
сделать плюс k, чтобы можно было поделить пополам. То есть вот в этой вот сумме 3m плюс k, у меня каждое
ребро посчитано дважды. Каждое внутреннее ребро посчитано дважды от слагаемого 3m. Каждая
ребронная граница посчитана один раз из-за одного из треугольников и один раз из-за того, что я
добавил k. А поэтому вот здесь все ребра посчитаны дважды, поделил пополам, это будет число ребер.
Вот. Ну все, значит, все это склеиваем. Что у нас получается? n плюс,
пардон, минус 3m плюс k пополам, минус, точнее плюс m плюс 1 равно двойки, да, вроде. Вот. Так,
n и k это у нас параметры, это мы их знаем. Остается отсюда вытащить m. Давайте я попробую это сделать.
Единичку я сокращу, останется здесь единица. Минус 3 вторых плюс 1, то есть минус 1 вторая,
минус m пополам. Вот. Отсюда можно сказать, что m это как раз то самое 2n минус k минус 2 заявленное.
Да. Где m представляется число треугольников. Вот ровно мы его и нашли. Ну и все. Дальше,
чтобы понять сколько у нас ребер, мне нужно вот сюда вот подставить m, вот это вот m подставить
вот сюда и получить ровно вот это выражение. Но давайте уже не буду это проделывать, получится
вот ровно такая штука. Окей? Хорошо.
Определение. Давайте мы определим граф Дилане. Пусть, как обычно, p это ну что сайтов,
ну что сайтов. Граф Дилане это следующее. Значит вершины это сайты, множество вершин это просто p.
А ребра соединяют каждую пару сайтов, для которых соответствующие ячейки диаграммы Воронова
разделяют кусок границы положительной длины. Значит ребра. Мы проводим ребро между p и pg,
если их ячейки диаграммы Воронова, то есть vp и vpg, имеют общий кусок границы положительной длины.
То есть я беру в качестве вершин все сайты, то есть все точки из одного множества, и ребра, ну как бы отрезки
между ними провожу только в случае, если их соответствующие ячейки диаграммы Воронова пересекаются,
ну пересекаются по чему-то содержательному, да, по границе положительной длины, по куску положительной длины.
Ну пример какой-нибудь давайте нарисуем быстренько.
Значит если есть, давайте вот этот мой любимый, если есть вот эти вот точечки, являющиеся сайтами,
то мы знаем, что диаграмма выглядит вот так, да, давайте тогда я граф Деланэ нарисую другим цветом,
надеюсь будет видно. Значит вершины это собственно сайты, да, я вершины не меняю, вершины графа,
а ребра провожу между теми сайтами которые разделяют кусок границы какой-то, ну ячейки
которых разделяют кусок границы, но, например, вот эти две ячейки смежные потому что вот у них
общий отрезок есть. Я провожу вот такое ребро, значит здесь тоже самое, есть вот такое ребро,
есть такое risks, и есть такое ребро. Более того, у меня вот эти две скажем ячейки разделяют опять
таки общий луч, имеют общий луч у границы поэтому я провожу еще вот такой отрезок,
И это будет, получается, граф Дилане.
Все, что я нарисовал голубеньким, это граф Дилане.
Здесь хорошо получилась сразу и треангуляция, и
я утверждаю, что это будет та самая треангуляция
Дилане, максимизирующая минимальный угол.
Это мы еще докажем, но пока строим только граф.
Просто втупую взяли все вершинки, соединили отрезками
то, что разделяет то, что имеет общих круговых границ
в диаграмме Воронова.
Утверждение, граф, который мы построили, плотный,
плоский.
Плоский граф – это тот, у которого ребра пересекаются
только по вершинам.
То есть, если я возьму в этом графе два произвольных
ребра, они, если и пересекаются, то только по своим концам.
Скажем, вот в этом графе никакие два ребра не пересекаются,
кроме случаев, когда у них есть общий вершин.
Я здесь пишу плоский, а не планарный, потому что
планарный – это скорее тот, у которого существует
плоская укладка.
То есть, граф К4 планарный, потому что можно так нарисовать
четыре вершины на плоскости, провести между ними какие-то
кривые, что-нибудь не пересекаться.
И, соответственно, тогда у него есть плоская укладка,
какая-то конкретная конфигурация вершин и кривых между ними
не имеет пересекающих ребер.
Так вот, здесь я утверждаю, что не просто граф планарный,
его можно как-то уложить, а ровно вот это – это его
укладка.
То есть, именно эта картинка не имеет реберных пересечений.
То есть, этот граф именно плоский.
Не планарный, что его можно как-то уложить, а именно
плоский в том смысле, что ровно эта укладка является
такой хорошей, без реберных пересечений.
Так, доказательства, сейчас будет неприятно, но надо
сделать.
От противника.
Сейчас, одну секунду.
Ну ладно, вроде не рано, что-то противного, противного.
Пусть какие-то два ребра пересекаются по мясу.
То есть, пусть ПИПЖ и ПКПЛ – это два ребра графа
Дилане, которые пересекаются по внутренности, ну как
бы по, не по границам, а именно по какой-то, по внутренним
точкам.
Два ребра графа Дилане, пересекающиеся по внутренностям.
Значит, ну, будем рисовать картинки, и вспомним еще
такой факт.
Смотрите, вот я говорю, что ПИПЖ и ПКПЛ – это ребра
графа Дилане.
Но, что такое ребра?
Мы уже с вами проговорили, что ребро – это отрезок
между сайтами, которые разделяют кусок границ
в диаграмме Воронова.
То есть, по ПИПЖ ребро проводится только если это соседние
ячейки в диаграмме.
Они разделяют кусок границ.
Но у нас с вами есть критерий того, что вот это вот ребро,
ну, точнее, серединный перпендикуляр к вот этому отрезку участвует
в диаграмме.
То есть, как раз у нас есть критерии того, что ячейки
соседние.
Напомните, пожалуйста, когда у нас серпер к двум точкам
лежит в диаграмме.
Да, да, да, ровно так.
У нас был в прошлый раз утверждение, что две ячейки
соседние, то есть серпер между ними участвует в
диаграмме, если только существует какая-то пустая
окружность, содержащая только эти две точки, больше
никого.
Ну, да, с центром на серпере, который содержит PIPG и больше
никого не содержит.
Ни внутри, ни на границе.
Ну, значит, соответственно, здесь это верно для PIPG и
для PKPL.
Давайте это нарисуем.
Есть у меня ребро PIPG, и есть какая-то точка, давайте
я назову X ITGT, что если я нарисую пустой круг, максимальный
круг с центром в X ITGT, в нем будут лежать, ну, точнее,
на границе будут лежать PIPG и больше никого не лежит.
Так, хорошо, и причем этот X ITGT обязательно на серпере,
ну понятно, раз он равный удален от PIPG, то он точно
на серпере к отрезку между ними лежит.
Вот, давайте тогда рассмотрим такой треугольник, давайте
я назову T ITGT, это треугольник, состоящий из вершин X IG, PI, PG,
вот такой треугольник рассмотрим.
Значит, что можно сказать?
Во-первых, я утверждаю, что интервал от X IG до PI целиком
лежит в ИТ-ячейке диаграммы Воронова.
Интервал от X IG до PI целиком вложен в ИТ-ячейку диаграммы
Воронова.
Начну почему, потому что эта точка на границе между
ячейками, это точка серпера, разделяющая как раз равно
удаленное от PIPG, соответственно, вот эти все точки, они ближе
к PIPG, чем к PG, просто потому что они лежат по одну из
двух полуплоскостей.
Ну и все, то есть ко всем вот этим точкам самое
ближайшее PIPG и больше никто.
Если бы был кто-то другой, то они бы...
Ну тогда вот это вот...
Сейчас.
Ну да, собственно, мы знаем, что точка P I лежит в своей
ячейке, P I лежит в ИТ-ячейке диаграммы Воронова, а X
IG лежит на границе между ИТ и Житой, поэтому весь
отрезок целиком лежит в ИТ-ячейке, потому что она
выпукла, значит, весь отрезок лежит.
Ну а интервал лежит строго-строго внутри и больше нигде.
То есть он не лежит в, например, там, В от P I.
Этот интервал целиком только в ИТ-ячейке.
Давайте я даже напишу, здесь для строгости лежит во
внутренности.
А, interior, во внутренности ячейки лежит строго, то
есть больше ни в кое-другой ячейке не лежит, не на границе,
а именно во внутренности.
Ну и то же самое для второго отрезка X IG, P I.
Этот интервал целиком лежит во внутренности Жито-ячейки
диаграммы Воронова.
понятно вот хорошо так последнее что мне нужно здесь сказать это что в этом
треугольнике не лежит никакая другая точнее не лежит точка ни пк ни пл
треугольники тежи не лежит ни пк ни пл значит это более простой факт не
более того не просто в треугольнике не лежит никакая никакая другая точка ну и
во всем этом круге не лежит никакой другой сайт потому что ну мы взяли x
и житая ровно такую x и житая такова что в максимальном пустом круге с центром
ней лежат только по и и пж и больше никто значит в этом треугольнике тоже
подавно никто больше не жить потому что треугольник вложен в круг
а значит треугольник и никаких других точек нету вот и того что у нас есть
давайте выпшем все что у меня сейчас получилось мы знаем что в треугольнике
тежи нет точек пк и пл тежи нет пк пл соответственно если я сделаю все то
же самое только уже для отрезка пк пл то у меня получится наоборот что в
треугольнике тк л нет по и и пж ну то же самое да есть как бы там какой-то
какое-то ребро графа деланэ значит он соответствует какому-то сер перу в
диаграмме воронова соответственно все то же самое просто наоборот получается в
симметрическом треугольнике нет по и и пж вот и мы еще знаем что какие-то
стороны этих треугольников пересекаются
на какие-то стороны треугольник пересекаются
значит я хочу отсюда вывести что сейчас я давайте напишу так х и ж п и или х и
ж пересекается с x kl пк или x kl пл вот то есть еще раз у меня есть вот такая
такое условие что то есть у меня есть два треугольника расположенные как-то так
что в одном нет двух вишен другого в другом нет двух вишен первого и при этом
они пересекаются вот эти стороны их пересекаются тогда я сейчас докажу что
какие-то еще другие стороны пересекаются грубо говоря то есть что либо вот это
одна одна из двух этих сторон пересекается одно из двух вот этих сторон
если я это докажу то у меня будет противоречие вот с этим фактом что эти
как раз такие интервалы вот этот и вот этот и вот этот и вот этот они лежат по
парно различных ячейках диаграмма воронова значит если не пересекаются то
у меня ячейки пересекаются по внутренности противоречие мы знаем что
ячейки пересекаются только по границе давайте напишем если мы это докажем если
это доказать то получим что какие-то две ячейки диаграмма воронова вор от п пересекаются по
внутренности что собственно противоречит определению
так как понятно хорошо ну значит давай тогда это докажем давайте докажем что
если треугольники пересекаются по двум сторонам то они где-то еще пересекаются
давайте я нарисую треугольник t и g так довольно вольно треугольник t и g
значит это точка x и g это точка п и это точка п и g давайте я у каждой точки
подпишу ау если она лежит строго вне второго треугольника да я знаю что ни п и ни п и g в
другом треугольнике не лежат поэтому здесь могу написать значение а вот вот значит ну давайте
поймем что происходит с x и g ну на самом деле вообще говоря непонятно потому что просто
какая-то произвольная точка общая точка границы с ней непонятно что происходит давайте я
предположу тоже что она лежит вне второго треугольника она лежит вне
треугольника t и g vs пока это предположение дальше смотрите мериться треугольник все три его
вершины лежат строго вне второго треугольника то есть вне вvenue как бы вне треугольника
вместе с границей дальше есть какое-то отрезка пкп л который эту сторону пересекает ну как-то
так он пересекает, вот, то есть у меня есть две вот эти точки pkpl, которые пересекают этот отрезок
до p и pg, то есть соответственно на этом отрезке p и pg у меня есть, ну поскольку его граничные точки
лежат вне треугольника, а здесь где-то я захожу во внутренность треугольника, да, то есть когда
я пересекаю в сторону, понятное дело, что ну как бы я перемещаюсь из внешности треугольника во
внутренность второго треугольника, то есть вот эта точка как бы на границе, да, и значит я как бы этот
треугольник, в этот треугольник захожу, я должен из него где-то выйти еще, это точка находится
внутри, tahun внутри второго треугольника, вот, значит ну там где-то я еще должен выйти, то есть
есть еще какая-то вторая точка пересекения на этой стороне, потому что две крайние вне, значит если
я зашел один раз, то должен выйти, да, потому что на этом луче у меня непрерывно все должно вот
быть, если я был вне, то должен зайти, потом выйти, потом быть, что бы быть в конце
аут вот но что мы знаем мы знаем что этот отрезок ни одной своей вершинка не
лежит в треугольнике t и g поэтому такая красненько быть не может она ну какая-то
вот такая например да то есть этот отрезок он куда-то вне треугольника t и g
смотрит ну что-то такое то есть мы точно понимаем что если у меня отрезок pk
pl пересекает по и g но при этом ни одна его ни один из его концов не лежит в
t и g то значит у меня этот отрезок пересекает не только по и п и g но еще
какую-то другую сторону ну скажем вот это вот x и g п и g
раз мы зашли в треугольник t и g то мы должны из него выйти вот ну и здесь
тогда та же самая логика смотрите если у меня границы если у меня концы вот
этого отрезка x и g и п и g лежат вне второго треугольника а при этом здесь
есть точка их прещения по мясу значит здесь соответственно я захожу внутрь
второго треугольника если я двигаюсь вот отсюда сюда да я захожу внутрь
поэтому чтобы опять быть вне треугольника
мне нужно получить второе пересечение поэтому есть какая-то другая сторона
треугольника тк тк л которая также пересекает отрезок x и g и g
просто потому что если мы были вне потом зашли потом п börjar вне то мне
нужно опять получить по опять получить точка пересечения
значит здесь есть какая-то сторона которая еще пересекает x и g но это
обязательно одна из двух оставших сторон. То есть есть какой-то вот, скажем,
такой отрезок или вот такой отрезок, который пересекает нашу сторону. Давайте
вот так нарисуем. Есть что-то такое. Это, соответственно, сторона PLXKL. Вот мы
тогда показали, что в этом случае у меня сторона XJPJ пересекается со стороной
PLXKL. Это один из случаев, в которые нам нужно.
Вот. Профит. То есть если у меня эта точка лежала вне, то мы показали, что если
есть какое-то пересечение, то обязательно есть другое, причем с другой стороной.
Окей? Так. Ну тогда давайте еще рассмотрим случай, когда она лежит внутри. In. А эти лежат вне. Out.
Ну, начало такое же, что у меня есть какой-то отрезок PKPL, который пересекает эту сторону по
мясу. То есть если мы начали вне, закончили вне и при этом когда-то зашли внутрь треугольника,
то, значит, здесь есть еще какая-то другая сторона, которая пересекает нашу сторону
по IPJ. Так. А здесь мы начинаем внутри, заканчиваем снаружи. Да, здесь есть какая-то опять точка внутри.
Сейчас. Moment, moment, moment. Вот это, да? Да. Ну,
если рассмотреть эту сторону, то действительно у нас концы, один конец вне, другой конец внутри,
значит где-то есть точка пересечения, и это не вот с этим отрезком, потому что этот отрезок мы
поняли, с кем он пересекается. Значит, эта сторона должна пересекаться с одной из двух оставшихся,
ну, например, PKXKL. Здесь есть точка пересечения. То есть если мы были внутри и вне, значит где-то
по дороге мы были на границе, то есть должна быть еще сторона треугольника отличная от вот
этой вот, которая пересекается с нашей стороной PXJ. То, что надо. Ну вот, значит в итоге мы все
доказали, что как бы ни распагались эти два треугольника, все вот эти условия одновременно
выполняться не могут, потому что они ведут в противоречию к тому, что ячейки пересекаются по
внутренности. Да, следствие, да? Значит, смотрите, мы, мы показали, что какие-то из этих двух
отрезков пересекают, точнее, какой-то из них пересекается к каким-то из них. Причем по мясу
пересекается. Ну, то есть по внутренним, по внутренним точкам. Но, смотрите, мы знаем, что вот
этот интервал целиком лежит во внутренности этой ячейки. Этот интервал целиком лежит во
внутренности житой ячейки. Ну, потому что как бы мы это доказывали, что x и g лежит на границе
между p и pg, а pg лежит строго в своей ячейке, больше ни в какой. Соответственно, интервал между ними
ближе всего находится только к житой ячейке и больше никому. Они лежат во внутренности. И, соответственно,
если мы показали, что кто-то из них пересекается кем-то из них, то, ну, поскольку они все вложены в
свои попарно различные ячейки диаграммы Воронова, мы тем самым показали, что какие-то две ячейки
диаграммы Воронова, скажем, вот это и вот это, там it и lt, пересекаются по внутренности. У них
есть общие точки, точнее, есть целый общий интервал, точнее, не так, есть точка на интервалах,
которая лежит и там и там. Соответственно, есть точка, лежит во внутренности здесь и здесь. Вот это
быть не может. Ну все, отлично. У нас уже есть факт, что это граф плоский. Это уже неплохо.
Что здесь ребра, крайней мере, не пересекаются. Вот, значит, давайте еще такое утверждение я напишу.
Ну давайте напишу без доказательства. На самом деле, доказательства здесь тривиальные. Следует
из того, что мы в прошлый раз делали. Во-первых, ребро P и Pg присутствует в графе Делане,
так, присутствует в графе Делане, если и только если существует точка Q,
лежащая на серпере между ними. Такая, что C от Q содержит на границе P и Pg и больше никого не
содержит. Этим утверждением мы только что пользовались. Мы сказали, что если есть какое-то
ребро, то есть точка на серпере, такая, что пустой круг с центра вниз содержит ровно эти две точки и
больше никого. И это просто, собственно, факт с прошлой лекции, что если две диаграммы пересекаются,
точнее две ячейки диаграммы пересекаются, если только если как раз есть точка на серпере,
содержащая только эти две. Вот второй факт тоже следует почти немедленно из прошлой, значит,
с прошлой штуки. Три сайта P и Pg и Pg лежат в одной грани графа Делане, если и только если
существует Q, такая, что пустой круг с центром в ней содержит на границе эти три точки.
Вот, то есть грани нашего графа, ну и сейчас я уже могу говорить слова грани, потому что мы
доказали, что граф плоский, значит, собственно, там у него выделяются грани как-то однозначные,
все нормально. Значит, вот грани определяются так же, как вершины в диаграмме Воронова,
что мы говорили, что точка Q — это вершина диаграммы Воронова, если только если ее пустой круг
содержит хотя бы три точки на границе. Ну и здесь, соответственно, три точки попадают в одну грань,
если только если есть, собственно, вершины диаграммы Воронова, содержащие их на, ну как бы,
равнодаленные от этих от этих точек. Вот, значит, что отсюда следует? Отсюда следует,
на самом деле, что любая грань графа Делане — это еще не обязательно треугольник, но это,
по крайней мере, точно вписанный многоугольник. Любая грань графа Делане — это вписанный в окружность
выпуклый многоугольник. Ну потому что, что такое грань? Это несколько точек, такие,
что, соответственно, любые три из них имеют какой-то общий центр. Значит, понятно, что это тогда
точка Q общая для всех, ну потому что, собственно, это круг, содержащий эти три точки, значит,
как бы, все остальные на этом же круге должны лежать. То есть, собственно, у меня есть некий круг,
на котором, собственно, лежат все точки какой-то одной одной грани. Его центр — это очередная
вершина диаграммы Воронова, ну и, собственно, весь этот многоугольник — это очередная грань.
Ну просто потому что они равно удалены от одной и той же точки, значит, собственно, получается,
что это вписанный многоугольник. Ну и такое, собственно, довольно часто может получаться,
довольно спокойно может получаться. В графе Деланы могут быть многоугольники, а не треугольники,
ровно в этом случае, когда есть у вас несколько точек, там 4 или больше, которые лежат на одной
окружности. Вот здесь я нарисовал там, не знаю, 6 точек, они лежат на одной окружности, и все они
лежат, как бы, в одной грани графа Деланы. Это все одна грань графа Деланы. Окей, это был граф Деланы,
а дальше я говорю следующее, чтобы определить триангуляцию Деланы, я беру граф Деланы и все
его нетреугольные грани произвольным образом триангулирую. То есть вот у меня есть граф Деланы,
в нем как бы, ну он плоский, мы это уже доказали, в нем есть какие-то такие грани, которые более
чем треугольные. Вот давайте как угодно их триангулируем. Вот как хотим, так и триангулируем.
Вообще как угодно, пофиг. Вот так например. Допределение. Триангуляция Деланы.
Это, ну давайте я напишу произвольная триангуляция. Произвольная триангуляция. Продолжающая граф Деланы.
Продолжающая граф Деланы. То есть мне нужно просто дотреангулировать все нетреугольные
грани. Все нетреугольные грани. Вот. Почему у нас такая большая свобода выбора? Почему
любую грань граф Деланы я позволяю себе триангулировать как угодно? По следующей причине,
смотрите, у нас мотивация была такая, что мы хотим максимизировать минимальный угол. Мы хотим,
чтобы минимальный среди всех углов, встречающихся в треугольниках, был как можно больше. Но вот я
утверждаю, что если у вас есть вписанный в окружность многоугольник, то как бы вы его не
триангулировали, у вас минимальный угол будет один и тот же. На самом деле нужно просто из этих
дуг выбрать самую маленькую, посмотреть угол на нее опирающуюся, вот скажем, в этом случае
будет, видимо, вот этот угол. И всегда будет, не буду доказывать, всегда будет, хотя бы,
точнее не так, всегда будет угол, опирающийся на эту дугу, ну, значит, он будет как раз минимальным.
То есть, потому что когда вы триангулировали, у вас любой угол опирается на некоторую дугу,
и вот я утверждаю, что обязательно будет угол, опирающийся на минимальную дугу. Соответственно,
поэтому тогда в любой триангуляции минимальный угол будет один и тот же, просто как опирающийся
на самую маленькую дугу. Поэтому, как именно я триангулирую, неважно, давайте как-нибудь,
вот как хотим, так и сделаем. Вот, да. Ну да, тут на самом деле в доказательстве надо где-то
аккуратненько еще доказать, что... Ну да, да, да, да. То есть, вот на самом деле надо,
окей, давайте тоже BD напишу. Вот. В том плане, что здесь в доказательстве мы по сути это как бы
факты доказываем, что любая грань, то есть вот здесь в доказательстве мы на самом деле доказываем,
что любая грань ровно так и выглядит, что есть некая точка, являющаяся вершиной диаграммы Воронова,
и максимальный круг с центром в ней содержит все вершины этой грани. Это, собственно, как бы часть
доказательств скорее. Так. Есть вопросы еще? Хорошо. Значит, вот мы триангуляцию определили.
Теперь смотрите, значит, мораль. На текущий момент, что у нас есть? У нас есть алгоритм
конструирования триангуляции Дилане. Мы сказали, что давайте построим диаграмму Воронова, проведем
отрезки между сайтами, ячейки которых смежные, тем самым построили граф Дилане. Затем каждую
нетриугольную грань дотреангулируем, получим триангуляцию Дилане. Значит, в этот момент у нас
уже есть алгоритм построения триангуляции Зайн Логан. Зайн Логан. То есть просто строим
диаграмму, по ней строим граф, по нему триангуляцию. Вот. Пока что в данный момент это какая-то
рандомная триангуляция, просто какая-то, которую мы так построили. У нас все грань не благо выпуклая,
и мы их можем очень легко триангулировать. Итак, в данный момент у нас есть какая-то
триангуляция. Сейчас, в оставшем часть лекции, я буду доказывать, что в ней минимальный угол
максимален. То есть алгоритм у нас уже есть, сейчас будем доказывать, что в ней минимальный угол максимально
возможен. Теорема первых критерий. Триангуляция множества П является триангуляцией Диланы,
если и только если выполнять следующее условие, что если я описываю окружность вокруг любого
треугольника триангуляции, то в нем внутри нет никакого другого сайта. Если только есть любого
треугольника триангуляции, его описанная окружность не содержит внутри себя других сайтов.
На самом деле внутри себя просто сайтов, каких-либо. То есть чтобы проверить, что данная
треангуляция является треангуляцией Диланы, мы просто можем вокруг каждого треугольника описать
окружность. Вот есть там очередной треугольник в треангуляции. Я описываю вокруг него окружность
и проверяю, что сюда никакие другие сайты не попали. На границу могут попасть, а во внутренности
других сайтов быть не может. Так, доказательства. Ну давайте слева направо. Что такое треугольник
триангуляции? Треугольник триангуляции Диланы это либо грань графа Диланы, либо кусок грань.
Давайте возьмем случай, когда это был кусок грань. То есть у меня была какая-то грань графа Диланы,
я в ней ее как-то треангулировал, получил очередной треугольник. Давайте рассмотрим какой-то
конкретный треугольник треангуляции, который получается как треугольник внутри одной из
граней. Мы знаем, что исходный многоугольник, с которого мы начали, это вписанный в окружность
многоугольник, внутри которого никаких других сайтов нет. Потому что у нас есть теорема,
которая утверждает, что центр этой описанной окружности это как раз такая точка, что минимальный
круг с центра вниз содержит на своей границе только вершины этой грани и внутри себя больше
никого не содержит. Значит, эта же окружность совпадает с окружностью описанного круга этого
треугольника, и она никаких других сайтов внутри себя не содержит. Тут все просто.
А давайте что-нибудь напишем. Пусть треугольник лежал в грани f графа Диланы,
значит окружность описанная вокруг f не содержит сайтов внутри. Ну и эта окружность совпадает
по вот той теореме, что максимальный круг с центром в этой точке q, которая является
центром описанной окружности, никаких других сайтов не содержит. Ну и собственно эта окружность
совпадает с окружностью описанного вокруг нашего треугольника. Доказали. То есть вокруг
любого треугольника, если написать окружность, никаких сайтов внутри этой окружности нет.
Окей. Так, ну теперь обратно. С права налево. Пусть верно вот это вот условие про окружность
треугольника, почему тогда это треугольник Диланы. Ну из этого на самом деле можно сказать
следующее, что любой треугольник вот этой вот треангуляции, произвольной которой у нас есть,
он соединяет только вершины, лежащие в одной грани графа Диланы. При этом условии любой
треугольник треангуляции соединяет вершины одной грани графа Диланы. Ну потому что если у
меня есть некий треугольник, то есть по сути есть просто три точки p и p g p k такие, что если я
нарисую описанную окружность, то больше никаких точек внутри этого круга нет. Ну значит,
просто по вот этому вот факту они лежат в одной грани графа Диланы. Да, у нас есть факт, как раз
говоря еще, что три сайта лежат в одной грани, если и только если как раз-таки круг какой-то есть,
который содержит только их на границе и больше никого внутри. Ну собственно, ровно это нам и
говорят, что в этом круге нет точек внутри, значит, собственно, эти как раз три точки лежат в одной
грани графа Диланы просто по вот той теории. Получается, что все треугольники, которые мы
строим, они не противоречат графу Диланы, то есть мы соединяем треугольниками только вершины,
только сайты, лежащие в одной грани. Значит, ребер противоречащим графу Диланы мы не проводим,
мы проводим только ребр, как бы согласующий с графом Диланы, а значит мы просто строили
и эвокуют реангуляцию, ну поэтому это и есть реангуляция Диланы. Значит, не проводятся ребра,
ребра, не лежащие, ну точнее как бы противоречащие, да, противоречащие графу Диланы. Значит,
мы имеем реангуляцию Диланы. Значит, еще раз мы показали, что любой треугольник целиком лежит
в какой-то грани. Ну, то есть у нас есть какая-то реангуляция, которая является под реангуляцией
графа Диланы, поэтому это по определению просто реангуляция Дилана.
Так. Едем дальше. Значит, что нам нужно, нам нужно теперь сделать. Смотрите.
Давайте, давайте определение мы делаем. Значит, определение. Операция флип,
операция флип-ребра. По-английски, соответственно, edge flip, edge flip.
Значит, следующая картинка. Представьте себе, что у вас были, сейчас, были два треугольника,
разделяющие общую сторону. Вот представьте, что у вас есть какая-то реангуляция, в ней есть два
треугольника, разделяющие общую сторону. Тогда edge flip, это когда вы берете вот эту вот их общую
сторону и перекладываете на противоположную. Делаете вот так. То есть вы удаляете их общую
сторону и кладете ее, ну как бы, в другие вершины. То есть по сути меняете диагональ в этом
четырехугольнике. Это называется edge flip. Ну, это можно сделать только если, если объединение двух
исходных треугольников было выпуклым многоугольником, ну выпуклым четырехугольником,
потому что если не выпукло, то вы просто другую диагональ положить не можете на самом деле. Вот,
ну давайте считать, что только для выпуклых четырехугольников мы это можем делать. Вот,
значит, это edge flip. Мы будем говорить тогда, что edge flip полезный или ребро после операции
становится легальным, значит, если увеличивается минимальность углов. Значит, наша задача была
какая? Наша задача это максимизировать минимальный угол. Тогда вот давайте я все вот эти углы померю,
давайте напишу альфа один, альфа два, альфа три, альфа четыре, альфа пять, альфа шесть. Здесь там
бета один, бета два, бета три. Я произвольным образом их нумерую, неважно как. Мы говорим,
что ребро и жир нелегально, если после edge flip у вас минимум строго увеличивается. То есть,
если минимум по всем альфам меньше минимума по всем бетам. Так, плохо писать, и давайте я
напишу какой-нибудь, не знаю, s. Здесь напишу какой-нибудь t. То есть, это такой способ локально
увеличить минимальный угол. То есть, есть там вся внешняя часть нашей триангуляции, там есть
какие-то еще треугольники, в них есть какие-то свои углы. Но вот если мы можем здесь локально поменять
ребро на противоположное и при этом увеличить минимум среди встречающихся углов, то мы тогда
говорим, что нам нужно это сделать. Исходное ребро нелегально, то есть его нужно насильно флипнуть,
чтобы увеличить минимум. Это очень естественная штука. Мы как бы хотим максимизировать минимум,
давайте его пытаться максимизировать локально. Возьмем 20 средних треугольника. Если мы можем
здесь очень просто флипнуть всего одно ребро, увеличить минимум, тогда говорим, что такое
ребро нелегально, его как бы нужно флипнуть, чтобы увеличить минимум. Вот. Это определение нелегального
ребра. Соответственно, легальное это когда, наоборот, когда здесь значок будет больше
либо равно, когда флип не улучшает ситуацию. Это легальное нелегальное ребро. Ну, давайте
напишем прям тупо. Ребро легально, если оно не нелегально. И наконец, треангуляция легальна,
треангуляция легальна, если все ребра нелегальны.
Так, давайте простое утверждение. Пусть в треангуляции есть треугольники PIPGPK и PIPGPL,
соответственно, это треугольники треангуляции. Тогда утверждаю, что ребро PIPG легально,
ребро PIPG легально, если только если выполнять следующее условие. Окружность, описанная вокруг
первого треугольника, не содержит PL в своей внутренности. Окружность вокруг PIPGPK не содержит
внутри себя точку PL. Вместо того, чтобы мерить 6 углов, мы можем проверить легальность или
нелегальность ребра с помощью принадлежности точки кругу. То есть мы построили круг по трём вершинам,
проверили, лежит ли четвёртая точка в этом круге, да или нет. Если да, то значит ребро нелегально,
если нет, то значит ребро легально. Так, ну давайте нарисуем этот самый круг. Вот есть у меня
треугольник PIPGPK. Значит, если точка PL внезапно попала внутрь круга, внезапно попала внутрь круга,
то есть картинка у меня исходно была вот такая, тогда давайте посмотрим, что меняется после того,
как я это ребро флипаю. У меня остаётся, давайте окружность оставим. Есть PL, так, это ребро пропадает,
то есть я флипаю ребро ИЖ, у меня появляется вот такое вот ребро. Тогда я утверждаю, что минимальный
вырос. Ох, сейчас, одну секунду, как будет доказать.
Ну, видимо, мне придётся провести вот такие вот все прямые. Как-то так. Вот, значит, ну и здесь надо
просто померить все углы, как-нибудь их сравнить. Ну вот, смотрите, давайте, давайте, например, что это
за угол? Угол PGPIPL. Он равен, по сути, градусной мере вот этой вот дуги, потому что он у неё опирается.
Да, а если я перерисую это вот здесь вот, если я вот так вот перерисую, то, ну как бы понятно,
что угол при этой вершинке вырос. Дальше, кто теперь опирается на эту дугу? Вот этот угол
опирается на большую дугу, потому что угол PGPKPL опирается на большую дугу, потому что он содержит
ещё вот этот кусочек. То есть он опирается вот на это плюс вот это. Вот этот угол больше вот этого.
Что ещё можно, например, с чем сравнить можно? Ну, например, я хочу показать, что минимальный из двух
этих углов меньше, чем все углы вот здесь. Ну, например, я показал, что этот угол больше,
чем вот этот. Дальше, тоже самое, можем доказать, что этот угол, вот этот угол, больше, чем вот этот.
Ну, это просто аналогично, этот угол опирается вот на такую дугу, а этот угол опирается вот на
такую дугу, чуть побольше, содержащую ещё какой-то кусок. Ну, в общем, если аккуратно всё посмотреть
здесь на все возможные углы, то можно заметить, что минимальный из вот этих вот опирается на
какую-то такую дугу, а минимальный из вот этих опирается на дугу, содержащую, ну, как минимум,
ещё что-нибудь. Из-за того, что точка PL лежала строго внутри нашей окружности, то получается,
что как бы все дуги, на которые мы опираемся, они как бы только выросли. То есть вот к этой дуге
приклеилась, по крайней мере, вот этот кусочек. К этой дуге приклеился, по крайней мере, вот этот
кусочек. Поэтому все дуги только выросли, и, значит, минимальный из углов только вырос.
Вот. Очень неформально, но для формальности здесь нужно просто аккуратно все углы посмотреть,
понять, что, ну как бы, что, что минимальный из вот этих вот больше, минимальный вот там. Давайте
я тогда, наверное, без заказательств это оставлю, потому что все случаи рассматривать не очень хочется,
но идею я изложу. Вот. Ну и, соответственно, наоборот, если я нарисую случай, когда точка PL не
лежит внутри этого круга, точка PL лежит вне этого круга, да, какая такая картинка, и попробую
сделать флип, то я должен показать, что минимум, наоборот, не увеличится. Давайте сделаем флип,
вот такой вот. Так, да, сделал флип. Почему это не выгодно? Почему минимум не увеличился точно?
Начну, например, потому что вот здесь вот был угол какой-нибудь альфа, он опирался вот на эту
дугу. А теперь на эту дугу опирается угол, ну, смотрите, вот эта же дуга, вот она здесь,
и теперь, ну, как бы на неё если бы, если я бы взял какой-то вот такой угол, он бы на неё опирался,
был бы равен альфа, а здесь эта точка лежит еще дальше, поэтому этот угол еще меньше. То есть,
на самом деле, тут, как бы, нужен такой факт, что если, если мы опираемся на дугу, и точка
лежит вне окружности, то этот угол меньше, чем если бы мы опирались на, на дугу и лежали бы на
окружности, вот, поэтому этот угол будет меньше, чем альфа, ну, соответственно опять-таки, если
аккуратно всё проанализировать то, на что мы опираемся, как бы, у меня, у меня дуги только
сокращаются, наоборот, поэтому минимум может только уменьшиться. Вот, ну как-то на
пальцах так. Что-то надо здесь еще пояснить? Вам не нравится, да?
Ну, смотрите, давайте я такое утверждение сформулирую, которое
здесь, собственно, оставляем полагающее. Что нам нужно делать? Вот пусть есть
окружность, есть какая-то дуга АВ.
Есть дуга АВ. Давайте рассмотрим три точки. Одна лежит внутри круга, другая на
границе, а третья где-то вне. Тогда я утверждаю, что угол тем меньше, чем как бы
дальше вы от круга. То есть, вот здесь вот угол максимальный среди этих трех,
первый по величине, этот второй по величине, ну, в смысле, по, как бы, короче,
этот самый большой, этот средний между ними, а этот самый маленький. Вот, ну,
собственно, ровно это я здесь использую. Угол один, больше угла два, выше угла три.
Так, ну, и теперь, наконец-то, мы готовы доказать второй критерий. Второй критерий.
Триангуляция. Является триангуляция Дюанэ.
Если и только если она легальна.
Легальность, напоминаю, это значит легальность каждого ребра. То есть, что, если мы строим
окруженность вокруг любого треугольника, то, как бы, вершина соседнего треугольника
лежит вне этой окружности. Доказательство. Давайте вспомним первый критерий. Он говорит,
что триангуляция является триангуляцией Дюанэ, если и только если окружность,
описанная вокруг любого треугольника, не содержит вообще сайтов других никаких. А здесь я говорю,
что окружность, описанная вокруг любого треугольника, не содержит, как бы, соседнего сайта,
вершину соседнего треугольника. Понятно, что это условие только более слабое. То есть,
в первом критерии мы показали, что триангуляция является триангуляцией Дюанэ. Если и только
если окружность, описанная вокруг любого треугольника, не содержит других сайтов.
А в легальности я говорю, что окружность вокруг любого треугольника не содержит вершину соседнего
треугольника. То есть, здесь я показал, что вообще нет никаких сайтов. А в легальности я говорю,
что нет сайта, как бы, вершины соседнего треугольника. Вот если я опишу окружность
вокруг ПИ, ПЖПК, то у меня нет в этой окружности вершины вот этой вот ПЛ, соседнего треугольника.
То есть, здесь я говорю, что нет вообще сайтов, здесь я говорю, нет одного конкретного. Ну тогда,
слева направо вот эта вот стрелка очевидна. Очевидно, так как мы доказываем более слабые условия.
Так как справа более слабые условия. Более слабые условия. Согласны? Вот, ну теперь справа налево нужно
сделать. То есть, из легальности мне нужно показать вот это, что окружность вокруг любого треугольника
вообще сайтов не содержит. Дальше мы пойдем от противного. То есть, пусть треангуляция легальна,
но при этом есть треугольник такой, что внутри его описанной окружности есть какой-то другой сайт.
Давайте что-нибудь нарисуем. Так, вот есть окружность, есть треугольник, ПИ, ПЖ, ПК. И внутри
него, внутри этой окружности есть какой-то другой сайт, не являющийся при этом вершиной соседнего
треугольника. То есть, она легальна, но не вот такая. То есть, здесь есть кто-то, давайте какой-нибудь
ПЛ, не являющийся вершиной соседнего треугольника. А вершина соседнего треугольника, нормально,
она вне окружности. То есть, картинка какая-то вот такая примерно. Есть два соседних треугольника,
ПИ, ПЖ, ПК и ПИ, ПЖ, ПМ. Все нормально, то есть, эта ребра легальна в том смысле, что если я проведу
такую окружность, то ПМ будет вне этой окружности, но она не вот такая. То есть, в этом круге кто-то
есть. Вот есть какая точка ПЛ. Вот пусть есть такая конфигурация, мы сейчас перейдем к противоречию.
Значит, понятно, что точка ПЛ... Давайте еще раз нарисую это самое, без ПМ только. Вот есть такой
треугольник ПИ, ПЖ, ПК. Здесь есть точка ПЛ. Понятно, что точка ПЛ не лежит в этом треугольнике,
но потому что у меня есть треангуляция, то все треугольники сайтов не содержат, они только вершинами
могут выступать сайты. Значит, ПЛ лежит в одном из трех секторов. Либо в этом, либо в этом, либо вот
и в этом. В этом случае получается вот этот сектор. Тогда давайте скажем, что точка ПЛ лежит в секторе
ограниченным отрезком ПИ и ПЖ, не содержащем ПК. То есть, мы можем так переносить вершины,
чтобы это было ровно ПИ и ПЖ. ПЛ лежит в секторе ограниченном ПИ и ПЖ, не содержащем ПК.
Давайте скажем следующее. Из всех плохих ситуаций выберем ТУ.
ТУ, у которой угол ПИ, ПЛ, ПЖ максимален. То есть, мы идем от противного, говорим, что треангуляция
легальна, но при этом у нас есть какие-то окружности, содержащие другие сайты. Давайте возьмем тогда
из всех вот таких возможных плохих ситуаций, что окружность вокруг кого-то треугольника содержит
какой-то сайт. ТУ, то есть, тот набор ПИ, ПЖ, ПК, ПМ, для которого вот этот угол максимально
возможен. Вот этот угол максимально возможен. Понятно, что в таких конфигурациях конечное
количество, поэтому максимум я точно всегда могу найти. Вот из всех таких плохих конфигураций выберем
именно тот треугольник ПИ, ПЖ, ПК и ТУ точку ПЛ, для которой угол максимально возможен.
Вот. Тогда утверждаю следующее, что окружность, описанная вокруг
треугольника ПИ, ПЖ, ПМ, целиком содержит
сектор С. Давайте я скажу, что это С. Я утверждаю, что если я нарисую окружность вокруг этих трех
точек ПИ, ПЖ, ПМ, то в ней будет целиком лежать этот сектор. То есть, я нарисую такую окружность,
вот на этой картинке. Рисую окружность. Здесь целиком этот сектор лежит. Почему это понятно?
Вопрос, зачем нам это нужно. Смотрите, если мы докажем, что эта окружность целиком содержит
внутри себя этот сектор, то тогда получится, что на самом деле этот угол ПМ, ПЛ, ПЖ будет
еще больше, чем вот этот предыдущий максимальный. Потому что, как бы, раз точка ПЛ лежит опять-таки
внутри этого круга, если мы весь сектор содержим, то мы содержим и ПЛ, получается, что у меня опять есть
противоречие для треугольника ПИ, ПМ, ПЖ и точка ПЛ, которая лежит внутри него, внутри круга,
точнее, внутри этого круга. И этот угол будет еще больше, потому что он будет опираться на еще
большую дугу, потому что он просто равен сумме угла ПИ, ПЛ, ПЖ и угла ПИ, ПЛ, ПМ. То есть,
угол только увеличится, и мы получим противоречие с тем, что исходный угол максимальный. Сначала
докажем, почему это верно. Здесь мне нужна будет такая картинка. Смотрите, что я утверждаю.
Утверждается следующее. Вот есть у меня некий отрезок ПИ, ПЖ. Давайте я нарисую прямо полуплоскость
целиком вот эту вот. То есть, я рассматриваю полуплоскость, не содержащую ПК. Здесь построена какой-то
сектор, какая-то дугая окружность. Я знаю, что внутри этого сектора лежит ПЛ, по предположению, а вне
него ПМ. И я утверждаю, что если я нарисую окружность, проходящую через ПИ, ПЖ, ПМ, то у меня
оно только вырастет, и весь этот сектор будет по-прежнему целиком содержаться. То есть, окружность
будет какая-то вот такая. И этот сектор будет содержаться. Это очень простой факт, который на
самом деле следует из следующего. Если вы фиксировали две точки ПИ, ПЖ и рассматриваете
множество точек, из которых данный отрезок виден под данным углом, то вы получите как раз дугу
окружности. По крайней мере, внутри этой полуплоски вы получите дугу окружности. И чем больше этот самый
угол, тем ближе эта дуга окружности будет к отрезку ПИ, ПЖ. То есть, вот скажем, из этих вот точек
отрезок виден под углом 180 градусов, из этих точек там чуть-чуть меньше, чем 180 и так далее,
и так далее. Чем больше ваш угол, тем выше будет эта дуга. Соответственно, вот это вот множество
точек. Это множество точек, из которых данный отрезок виден под углом больше равно, чем какой-то
альфа. А вот здесь вот, для большей окружности, это множество точек, из которых данный отрезок
виден под углом больше, чем какая-то бета, которая меньше, чем альфа. Поэтому этот сектор содержит
внутри себя. Еще раз. Я пользуюсь следующим утверждением, что если у меня фиксированы две точки ПИ, ПЖ,
полуплоскость относительно этой прямой какая-то и число альфа, то геометрическое место точек,
из которых данный отрезок виден под углом больше равно, чем альфа, это некий сектор
на этих двух точках ПИ, ПЖ. Соответственно, чем меньше это альфа, тем больше у вас множество точек.
То есть, вот здесь вот, из всех этих точек данный отрезок виден под углом хотя бы альфа. Соответственно,
если вы уменьшаете альфу, у вас окружность увеличивается. Ну, собственно, ровно это здесь и происходит.
Был некий сектор, то есть множество точек, из которых данный отрезок виден под углом хотя бы альфа.
Вы взяли точку вне этого сектора, провели окружность, значит, соответственно, все, что в этой окружности,
это те точки, из которых это видно под еще меньшими углами. То есть, все больше подходят,
и несколько еще меньше добавилось. Поэтому внутренний сектор С вы содержите точно внутри себя.
Окей? Вот. Ну все, значит, это есть. Дальше, проговорю опять, что осталось. Дальше, значит, тогда,
можно пишу еще что-нибудь? То есть, тогда получается, что PL лежит внутри окружности
вокруг треугольника Pj, Pj, Pm. Ну это мы только что доказали, да, что если я построю вот такую
окружность Pj, Pj, Pm, то PL будет внутри. Вот. Ну и тогда угол Pj, Pl, Pm будет только больше,
чем угол Pj, Pl, Pj. Потому что он состоит из двух кусочков, и значит, он только вырастет. Да,
получается, что мы нашли ситуацию, где этот угол еще больше противоречит с максимальностью вот здесь.
Угол, так, давайте, Pj, Pl, Pm больше, чем угол Pe, Pl, Pj. Противоречит с максимальностью этого угла.
Противоречит с максимальностью.
Похож на правду? Ну, тут надо, на самом деле, аккуратно тогда еще сказать. То есть,
надо опять, опять точка PL лежит как бы либо здесь, либо в этом секторе, либо в этом секторе. Если
она в этом секторе, да, блин. Короче, если она в этом секторе, то есть, по ту же сторону,
ну, точнее, по другую сторону от Pj, Pm, что точка Pi по другую сторону, то получается, что этот угол
равен как раз сумме вот этого и вот этого. А если PL вот здесь вот, то я тогда буду измерять угол
Pe, Pl, Pm, вот этот угол, и он составляется из вот этого и вот этого. И как раз один из них — это как
раз исходный Pe, Pj, Pl. Вот. Ну, чуть-чуть не успели. Короче, все, давайте тогда закончим. Еще
раз мораль. Легальность треангуляции — то же самое, что треангуляция делана. Что, значит,
окружность вокруг любого треугольника не содержит соседних сайтов — это как раз треангуляция делана.
Почему больше? Ну, давайте еще раз. Вот есть у меня Pe, Pj, Pl какой-то, есть Pm, вот такое примерно.
Но тогда что такое угол Pe, Pj, Pl, Pm? Это угол Pe, Pj, Pl, Pi, плюс Pe, Pj, ну короче, плюс вот этот вот. То
есть просто этот угол, вот этот, составлен из двух. Первый у второго, а первый — это как раз вот этот
вот. Значит, он больше вот этого. Да. Ну, просто этот угол равен вот этому плюс еще что-то. То
есть вот это плюс еще угол Pe, Pl, Pl. Поэтому он больше просто. Все, спасибо большое за внимание.
