так друзья ну добрый день всем еще раз наверное пора начинать потому что звонок был да по моему
был я вроде слыхал а вас вы еще не все собрались это я понимаю да это конечно вот так но смотрите
значит сегодня я буду рассказывать об одном объекте комбинаторики который очень важен на
самом деле для разных применений например для кодирования и который не тривиально строится
и в том числе для его построения понадобятся квадратичные вычеты которые мы с вами изучали
в прошлый раз ну и свойства которые мы изучали в прошлый раз тоже пригодятся этот замечательный
объект называется матрица адамара такой объект комбинаторики
так ну саму фамилию адамар мы с вами здесь уже обсуждали контексте распределения простых
чисел ну и не только здесь да это хорошо ну да каши адамара это в каком смысле здесь тоже
а ну в смысле что не только в контексте простых чисел да да да адамар упоминался уже неоднократно
ну давайте я дам определение того что такое матрица адамара так
это матрица размера n на n которая состоит из плюс и минус единиц исключительно только из
плюс и минус единиц и у которой каждые две строчки перпендикулярны артагональны друг другу
так каждые да да да каждые две строчки артагональны в смысле обычного скалярного
произведения в клидово да каждые две строчки
артагональны то есть если мы просто сложим произведение чисел которые стоят друг над другом
то мы получим 0 так в этом смысле всем понят что такое скалярное произведение сейчас на
этом уровне уже не должно вызывать вопросов я когда на самой первой лекции по ктч рассказываю
про попарно не артагональные 0 1 вектора минус 1 0 1 помните да я долго оправдываюсь потому что
вы как бы этого не знаете но часто вы наверное понимаете о чем идет речь ну вот и хорошо
так ну давайте разбираться вообще бывает такое или нет ну давайте прежде всего заметим я не
знаю пусть это будет упражнение на очень простое я думаю что оно многим просто будет сходу очевидно
если такая матрица существует если существует такая матрица то у нее и столбцы тоже попарно
артагональный это я сейчас доказывать не буду кому очевидно тот молодец кому не очевидно тоже
особенно если подумает и потом докажет иначе не молодец вот хорошо но если мы это знаем тогда
мы знаете что можем сделать мы можем считать как следствие вот из фактов от описанного в этом
упражнении мы можем считать что матрица до мара имеет вот такой вид в верхней строчке
сплошные единицы и в левом столбце тоже сплошные единицы но тут плюс минус один так но это
наверное понятно почему мы можем каждый каждую строчку у которой каждую строчку у которой в начале
стояла минус единица умножить на минус один вы же понимаете что артагональность от этого не
пострадает если вы какую-то строчку умножите на минус один была она артагональна каждый из
оставшихся но останется она артагональна и каждый из оставшихся если мы верим в упражнения то
совершенно то же самое можно проделать с каждым столбцом умножая его на минус 1 правда же вот
поэтому мы можем считать ну скажем так да ну там плюс и минус единицы в каком-то количестве не но
она по определению состоит из плюс минус единицы но я написал что она состоит из плюс минус единицы
я имею в виду что в отличие от общего вида где может быть как угодно я вот предлагаю в таком как
бы нормальном виде это писать когда верхняя строчка из единиц и левый столбец из единиц а дальше
как-нибудь да все понятно давайте матрицу записанную в таком виде я буду обозначать
буквой аж и буду говорить что она записана в нормальном виде вот это вот нормальный ее вид
а дальше могу устроить всякие филологические а это конечно от слова домар но и аж это тоже от
слова домар потому что домар начинается на букву аж твоем французском оригинале пишет стон вот так
по-французски могу по-другому сказать нашу нормальной форме считайте что это буква n матрица
а домара в нормальной форме ну ладно это все шутки ясно что она может быть записана так давайте
смотреть дальше ну если n равно единицы то конечно аж равна единице и существует но матрица
домара из одного элемента существует по формальным причинам у нее только одна строчка поэтому
мы можем говорить что каждые две строчки артагональны значит если n равняется двойке то не меньше
ура звучит после вот такого вот прекрасного рисунка 1 1 1 минус 1 она что это матрица домар
это конечно матрица дома давайте подумаем а если n равно тройке существует матрица домара или
не нет конечно почему потому что вот можно это даже здесь увидеть половина единиц половина
минус единиц но это очевидно верно и в общем случае потому что если верхняя строчка состоит
из всех единиц а последующие строчки будя они существует состоят из единицы минус единиц и
должны быть артагональны этой то конечно в них должна быть половина единиц половина
на минус единиц, правда? Но это означает, что n четное. Не существует, конечно, и
вообще n-четное число, если только оно отличается от единицы, где все тревяет.
n-четное при n больше либо равным. Как только появляется с чем
ортогоналить, ну там сразу возникает четное число. Вот, но это не все, потому
что если n больше либо равняется четверке, то ортогональными в свою очередь должны
быть каждые две строчки, кроме верхней. Но смотрите, как они выглядят. Вот одна
строчка без ограничения общности выглядит вот так. Здесь n пополам единиц, n
пополам минус единиц. А другая строчка, ну в общем тоже без ограничения общности
выглядит вот так. Единицы, минус единицы, единицы, минус единицы, правильно? Ну то
есть у другой строчки какое-то количество минус единиц накладывается на единицы,
какое-то количество единиц накладывается на единицы и так далее. Ну давайте обозначим,
скажем, вот это вот наложение единиц на единицы буквой х. Сколько общих единиц у двух строчек,
каждая из которых состоит из половины единиц, половины минус единиц. Обозначим х. Тогда вот
количество, это n пополам минус х. Ну это понятно. Потому что единиц, n пополам,
значит, тут у нас минус единиц на единицы накладывает во сен пополам минус х. Так,
что можно сказать про количество единиц наоборот накладывающихся на минус единицы? Ну или что
проще посчитать? Не, проще вот это посчитать. Сивок единиц, н пополам, тут их х значит снова
получается n пополам минус x. И наконец вот это количество, когда минус единицы
накладывается на минус единицы, оно снова оказывается равным x, конечно.
Услетели? Вот. Но они же должны быть артагональны. То есть у нас получается вот
здесь минус один умножается на n пополам минус x.
Дальше у нас единица умножается на x, потом снова минус один умножается на n
пополам минус x. И снова единица умножается на x. У нас получается 2x
минус 2хd n пополам минус x. Это равняется 4x минус n. И это должно равняться нулю.
Ура! Значит n делится на 4. Ну я не знаю, насколько праздничным это является на
самом деле, но факт тот, что n сравнимо с нулем по модулю 4. Если n больше либо
равняется четверке, оно обязано делиться на 4 согласно этой выкладке.
Ну вы, наверное, мне сейчас скажете, о, сейчас мы сделаем n делится на 8. А вот это уже
фигушки неоткуда. Ну потому что здесь все уже симметрично дальше. Вот то, что они там пополам
делятся, вот эти строчки, ну бог знает, как они друг на друга накладываются. То есть то, что n делится
на 8, ниоткуда не следует. Ну можете подумать, я не буду это доказывать, но это действительно
ниоткуда не следует. Вот то, что n делится на 4 следует, а то, что на 8 нет, не следует. Это вот
забавный момент. Ну всего-то единиц n пополам в каждой строчке, кроме первой. Вот у нас всего
общее количество единиц, вот это вот n пополам, тут их x, значит тут n пополам минус x. Да, друзья,
вы не стесняйтесь, я все поясню, спрашивайте, конечно. Ну вот не получается, к сожалению.
Ни с восьмеркой не получается, ни с шестнадцатью. На самом деле легко видеть, что n сравнимо с нулем
по модуле четверки, это последнее свойство, которое, в общем, является необходимым для
существования матрицы. Ну, начиная с n равного четверки. То есть 1, 2, это выраженные такие простые
случаи, а дальше нет. Вот требовать, что n делится на 8 или на 16 совершенно необязательно. Но это
интересный вопрос, конечно, понимаете, но можно подумать, почему это так. Я же не запрещаю вам,
я не то что говорю, друзья, это очевидно, не думайте. Я вам говорю, я знаю, что больше ничего не
получится. Если вы придумаете, ну круто, вы опровергнете гипотезу Адамара, которая была
сформулирована уже больше ста лет назад. Гипотеза Адамара как раз в том и состоит, что для любого n
больше либо равного четверки h существует тогда и только тогда, когда n имеет вид 4k. Это гипотез,
не доказанная до сих пор. Для 12 существует. Значит, смотрите, для всех n не превосходящих,
ну скажем, кто-то типа 676 было доказано еще на уровне 70 какого-то года, потому что это
написано в какой-то старой книжке типа маршала Холла комбинаторика. Значит, я не следил за этими
рекордами сам, но, наверное, если посмотреть в какую-нибудь банальную википедию, там написано,
до какого n сейчас доказано. Я никогда сам не интересовался, до какого n доказали. Ну,
до тысячи может час доказали, компьютеры мощные появились. Ну, не суть, понимаете,
она не доказана в общем случае. Мне гораздо интереснее, конечно, асимпатические общие
конструкции. Вот их я знаю и парочка из них я с вами поделюсь сейчас прямо. Одна из них
основана на квадратичных вычетах как раз. Но начнем мы не с нее. Начнем мы с дурацкой
попытки построить матрицу Адамара, чтобы убедиться в том, что дурацкие попытки не
проходят. Нужны какие-то более хитрые и, может быть, даже катарсисогенные идеи. То есть,
вот эти квадратичные вычеты для этого как-то использовать. Дурацкая идея такая. Ну,
просто рисуем сверху все единицы как положено. Потом рисуем половину единиц, половину минус
единиц. Потом рисуем вот здесь половину единиц, половину минус единиц, половину единиц, половину
минус единиц. Я вообще опасаюсь, что я могу кого-то обидеть, потому что у кого-то в голове эта идея
уже была, а я взял и назвал ее дурацкой. Но она не дурацкая, она просто самая первая,
которая приходит в голову, и мне тоже она когда-то приходила. Это не значит, что мы с вами дураки,
но такая вот естественная идея. Понимаете, как дальше? Вот эти единички дробим пополам,
эти минус единички пополам, эти, эти и так далее. Но оно, да, но вот оно, к сожалению, прокатит,
только для n равного 2 в степени k, и строчек таких вы наберетесь только к, понимаете? То есть
логарифм от n по вертикали вы построите так. Вот оно потому дурацкое. Дробить надо сколько
может, только логарифм, но это вы понимаете. Все, дурацкая идея не прокатила. Теперь прекрасная
идея. Смотрите, я сейчас вам нарисую матрицу Адамара, и вы все поймете. Ну, сейчас 8 на 8 нарисую.
8 на 8 сейчас нарисую, смотрите. Ой, почему 8 на 8? Конечно, 4 на 4. Конечно, 4 на 4, да. Я же
4 ты еще не рисовал. Да-да, я рисую 4 на 4. Это что-то совсем какой-то смешной соскок. Я и не хотел
8 на 8. Кто хотел, тот и получил. Нет, самая первая задача, там были нолики. Там были три циферки,
1 минус 1 и ноль. А, ну первый кусок в каком-то смысле. Смотрите, как я ее построил. Это не
совсем про ту задачу. Там же надо было попарно не артагональные, здесь попарно артагональные. Это
как немножко разные вещи. Задача похожая. Про первую задачу мы еще вспомним. Нет-нет-нет-нет,
там... А, я понял, понял, понял. В каком-то смысле да. Ну, в каком-то смысле да, но она была
другая все-таки. Такая? Может, и такая. А может, и такая. Слушайте, я вспомнил. Да, наверное,
такая была в отцепке. Там же все разбивалось на эти коробки, в которых попарно артагональные
векторы. Да, наверное, там так и получилось. Но, смотрите, я-то специально ее рисовал блоками,
чтобы вы увидели идею. Идея не в том, чтобы вспомнить, как мы это делали в самой первой
задаче. Это правильно. Вы вспомнили, спасибо. Да, все абсолютно верно сказано. Действительно,
в первой задаче, на первой лекции мы такую штуку фактически нарисовали. Но я сейчас ее нарисовал
по-другому. Я взял вот этот блок, это вот эта вот матрица два на два, потом взял его же,
его же и его же со знаком минус. В этом некая технология. Товарищи, вот ее надо сейчас смотреть.
Вы поняли, да, что я сделал? То есть, я нарисовал матрицу, у которой каждый блок это исходная
матрица Адамара, умноженная на чиселку из нее же, из этой матрицы Адамара. Левый верхний блок
умножается на левую верхнюю единицу, правый верхний блок умножается, ну как бы, на правую
верхнюю единицу, левый нижний вот на эту, и правый нижний вот на эту минус единицу. И
получилось такая 4 на 4. И видно, что она матрица Адамара. Дорогие товарищи, кто-нибудь понимает,
как теперь построить матрицу 8 на 8 все-таки? Было на алгоритмах. Ну, кто ж знал-то, что... Ну,
не у всех на продвинутых алгоритмах, да? Ну ладно, что ж я могу поделать? Ну, дублируются иногда
вещи, кто-то что-то знает. Не, ну, идея-то, я же рассказывал, что было на алгоритмах,
вроде идея понятна. Надо взять вот эту штуку умножить на единицу, потом ее же умножить на
единицу, потом здесь ее же умножить на единицу, а здесь ее же умножить на минус единицу. Общее
определение такое, если у нас есть какие-то вообще две матрицы, две матрицы, может быть,
даже разного размера. Одна, скажем, N на N, а другая M на M. Есть какие-то две матрицы,
то есть такая операция, она обычно звездочкой обозначается, называется кронекеровское произведение.
Выглядит вот так a11 умножить на b, a12 умножить на b, a1n умножить на b,
an1nb, an2nb, annnb. Так, понятно, я число умножаю на матрицу точно так же, как вот здесь я, скажем,
минус единицу умножаю на матрицу. То есть я просто по элементам умножаю матрицу на это число.
Получаются такие блоки размером M на M каждый, ну и суммарно получается матрица Mn на Mn.
Да нет, можно, конечно, и для прямоугольных определять, но давайте я для квадратных. Я буду
считать, что они квадратные. Утверждение простое совсем, тоже я бы расценивал скорее как упражнение,
чего тут заморачиваться. Утверждение состоит в том, что если a и b матрица Адамара,
то a кронекеровский умноженное на b тоже матрица Адамара, ну и, естественно,
наоборот тоже там b на a, это неважно, матрица Адамара. Если обе матрицы матрица Адамара,
то легко проверить, что артагональность, конечно, сохраняется. Ну давайте тоже расценивать скорее
как упражнение, потому что это правда просто. Ну то есть отсюда следует, что для n равного 2 в
степени k матрица Адамара всегда существует. Это вот мы продемонстрировали. Но вообще говоря,
если для какого-то n вы построили, для какого-то m вы построили, то для n умножить на m вы тоже
построили. Вот, ну давайте я теперь расскажу, давайте я теперь расскажу, как строить матрица Адамара
помощью квадратичных вычетов. Ну я уж не знаю, может тоже было на алгоритмах. Этого не было,
да? Два вкаты только было. Называется эта конструкция пэли. Это, конечно, тоже очень известная штука,
старая, но очень красивая. Называется эта конструкция пэли.
Давайте рассмотрим любое простое число,
которое имеет вид как 4k плюс 3. Я, конечно, не доказывал. Ничто таких чисел бесконечно много,
ничто они тоже достаточно плотно распределены в натуральном ряде. Ну, можно в это поверить.
Их много. Нет, нет, ни в коем случае. Кохнет, ни в коем случае. Нет, нет, два упражнения,
два упражнения. Я все-таки, понимаете, я адекватен. Да, со звездочкой, с тремя. Не, ну ладно,
почему бы нет. По крайней мере, не открытая проблема, хотя бы известная. Просто не хочется
тратить время на то, чтобы это доказывать. Ну вот есть такие простые числа. Ну ладно,
ну 7, например. Есть такое простое число. 7. 11 тоже подходит, да? 3, 12, 15 не подходит.
4, 16, 19. Не, ну их дофига, видите? Из первых четырех их 3. Ну как, это дофига. Ладно,
я шучу. Не, ну конечно доля их стремится к нулю примерно так же, как доля всех простых в натуральном
ряде. Ну, вы же помните, да, что на отрезке от единицы до n простых n поделительно логориф
мэн. То есть доля стремится к нулю, конечно, не три четверти. Это нам повезло в начале просто.
Доля стремится к нулю, но их много. Они также плотно встречаются, то есть на коротких отрезках
есть такие простые числа. На каждом коротком отрезке такие простые числа есть. Вот я утверждаю,
что если n равняется p плюс 1, то существует матрица Адамара этого порядка. Ну, p плюс 1,
это слава богу, 4k плюс 4, то есть это 4 делится. Так что необходимое условие хотя бы выполнено.
И вот это уже показывает, насколько тонко все с делимостью. То есть если из общих соображений
про делимость на 8, 16 и так далее я рассуждать не стал, то отсюда уже видно, что, в общем,
скорее всего, никаких общих закономерностей вы не сделаете. Ну и не сделаете, потому что гипотеза,
что делится на 4 и все, тогда существует. Но вот пока не доказано. Это тоже упражнение.
Хорош. Так, ну ладно. Сейчас я вам ее построю. Прямо построю. Давайте возьмем сначала матрицу
размера p на p, не p плюс 1 на p плюс 1, а p на p, которая будет состоять из таких вот чисел А по
П умножить на П по П. Не-не-не, сейчас. Символ лижандра-то это правильно? Да. Не, неправильно.
Нет, зачем умножить? Глупо сказал. А минус Б по П просто. А минус Б по П умножать сейчас будем. Нет,
символ лижандра, конечно, но А минус Б по П, что-то глупо сказал. Не, я не гоню себе, не, П. П это
размер. Я имею в виду, что здесь П и здесь П. Никаких степеней. Все очень-очень просто и красиво.
Ну, меня чуть занесло. Я что-то стал умножать. Я собираюсь умножать, но чуть позже. Так, П это
простое число вида 4k плюс 3. Еще раз, П это простое число вида 4k плюс 3. А, А и Б? А и Б? Просто. А и
Б это вот такие чиселки. Кто бы мог подумать. Не-не, сейчас все будет понятно. Все очень просто. Да-на-да.
А и Б это просто полная система вычетов по модулю П. Ну, например, от единицы до П числа. Не важно.
А пробегает от единицы до П. Б пробегает от единицы до П. Но это означает, что на диагонали у этой матрицы
стоят нули. Это явно пока не матрица Адамара. Ну, так еще раз. Матрица Адамара будет размером П плюс
один на П плюс один. Я пока строю некую вспомогательную конструкцию, которая имеет размер П на П. Вот это
я просто здесь отметил, подчеркнув, что это пока не будущая матрица Адамара, но некая заготовка к
этой матрице. На диагонали у нее стоят нули, потому что на диагонали А минус Б дает ноль. Ноль по П по
определению это ноль. Это вы помните, да? Ну, а вне диагонали стоят действительно плюс и минус единицы,
потому что по определению символ лижандра это плюс или минус один. Это уже очень так мажется,
похоже на матрицу Адамара. Так, я хочу доказать сейчас, что скалярное произведение любых двух
строчек в этой матрице равняется минус единице. Ну так, тоже близко к тому, что нужно, но не то.
Матрицу обозначим. Ну, поскольку она не Адамарова, то давайте обозначим ее Б, потому что буквы А не
подходят по-любому. Она не Адамаровская, поэтому давайте обозначим ее буквой Б, но это неважно,
я не уверен, что нам это обозначение нужно. Значит, что я хочу доказать? Я хочу, давайте я напишу
доказать пока что. Вспомогательное такое утверждение, что сумма по теме B от единицы до
P A1 минус B по P на A2 минус B по P равно, равна минус единице. Я хочу это доказать. Вы согласны,
да, что B зафиксированное число какое-то от единицы до P, если мы, ой, виноват, наоборот,
A1, A2 зафиксированные числа от единицы до P это номера строчек, A1, A2 зафиксированные
номера строчек, тогда B пробегает полную систему вычетов, мы смотрим такие произведения,
это в точности скалярное произведение строк с номерами A1, A2. Посмотрите, если я где-то,
как в прошлый раз, не рисую понятную картинку, вы мне скажите, какую картинку нарисовать,
то в прошлый раз я доказывал квадратичный закон взаимности и все, что надо было нарисовать,
что что-то под диагональю, что-то над диагональю, а я это формально написал по x больше qy,
по y меньше, что-то такое, и народ запутался. Если вдруг здесь нужна какая-то картинка,
до которой я просто как-то там не догнался, ну скажите мне, пожалуйста. Так, все понимают,
что это скалярное произведение? Хочу доказать. Они не артагональны, но они близки к тому,
чтобы быть артагональны. Ну давайте я докажу такой помогательный факт. Сумма, скажем, по b
от 1 до p. Так, как это лучше написать? Ну давайте вот так b по p на b плюс t по p. Ему это равно,
если c не 0 по модулю p. Вот если c это не 0 по модулю p, то тогда будет с такой суммой. Ну я
вообще хочу сказать, что это то же самое. Ну потому что если вы a1-b замените на b,
то a2-b это и будет b плюс t, которое равно там a2-a1. Это я, наверное, быстро сказал. Я потом повторю.
Давайте вот эту сумму посмотрим. Это будет сумма по b от 1 до p минус 1, b по p, b на b в минус 1,
b на b плюс t по p. О, какой фокус алгебраический. Видите, алгебраический фокус. Значит,
я, во-первых, избавился от слагаемого с b равном p, потому что здесь 0. И b равное p можно не смотреть.
Поэтому я пишу b от 1 до p минус 1. Можно просто писать b не равно 0. Если b не равно 0,
тогда у него по модулю p есть обратный элемент. Конечно, в поле. Да, b в минус 1 – это элемент
обратный к b по модулю p. Ну то есть вот такой, что b на b в минус 1 – это 1 по модулю p. Я взял и
тупо заменил вот тут вот единичку на b помножить на b в минус 1. Могу же так? Все понимают? Могу. А
дальше я воспользуюсь мультипликативностью. Я вот это вот b по p вынесу, и оно возведется в квадрат.
Ладно, я переписываю. Я чувствую, что это будет быстро, если говорить словами. b от единицы до p
минус 1. Здесь b по p в квадрате. А здесь вот так вот остается единица плюс b в минус 1 c по p.
То есть b по p вынесу, b по p в квадрате – это единица. У нас получается сумма по b от единицы до p
минус 1. Просто 1 плюс b в минус 1 на c по p. Так, t не 0 по модулю p, b пробегает приведенную
систему вычетов. Но понятно, что b в минус 1 и в каком-то другом порядке тоже пробегает эту
приведенную систему. И b в минус 1 умножить на c тоже пробегает эту приведенную систему. Правильно?
Ну все. А, вы, наверное, не знаете вот чего. Сумма по b от единицы до p – это гениальная шутка.
Значит, двоечнику на экзамене предлагается посчитать вот такую вот сумму. Ее еще можно,
знаете, специально в шутку отнормировать. Я вам сейчас скажу как. Надо вот так домножить.
Вот так. Предлагается двоечнику на экзамене посчитать такую сумму. Если он отвечает,
что это равно двум, то он получает свою заслуженную оценку. Ну как он отвечает,
что это равно двум? Сумма по b от единицы до p чисел b – а я неправильно отнормил. Вот так.
Это p на p плюс один пополам. Делим на p плюс один. А, нет, вот тут же p есть. Да, все правильно.
Значит, вот здесь получается p на p плюс один пополам. Делим на p, получаем p плюс один. А,
на четыре надо, да? Ну ладно. Считаю плохо в уме, черт возьми. Шутка гениальная, но считаю плохо.
Так, вы поняли, что получилась оценка студента? Вы понимаете,
чего на самом деле здесь должно получиться? Это не арифметическая прогрессия, товарищи. Мы с
вами в прошлый раз выяснили, ровно половина чисел являются квадратичными вычетами и ровно половина
не вычетами. То есть половина слагаемых здесь один, а половина минус один – это равно нулю.
Совершенно неважно, на что тут умножать. Это неважно. Нет, если они… можно отнормировать как-нибудь.
Так, друзья, вы все это поняли, а то я тут расшутился что-то. Это очень просто.
Половина вычетов, половина не вычетов. Половина единиц, половина минус единиц. В сумме ноль,
конечно, будет. А здесь мы суммируем то же самое, только со сдвигом на единичку сверху. Поэтому если
здесь отсутствует ну то же самое, вот так, здесь отсутствует нулевое слагаемое, то… а, все-таки на
p-1, да? Ну ладно, хорошо, неважно. А здесь отсутствует соответственно слагаемое с минус 1. Так, друзья,
понятно? Всем? Нет вопросов. Здесь получается минус 1, ну и здесь получается минус 1. Давайте
я это повторю. Мы просто переприсвоим b равно a1-b, то есть вот это a1-b, теперь переприсвоим,
b будет a1-b. Тогда что такое a2-b? Как еще раз? Совершенно верно, b плюс a2-a1, именно так. Так,
я надеюсь, что вас, как программистов, таким я не кокнул. Вы не собираетесь же решать это
линейное уравнение относительно b? Вот, ну то есть здесь стоит фактически какое-то b,
которое пробегает полную систему вычетов, как вот здесь, а здесь стоит оно же прибавить разность,
которая не равна нулю, потому что a2-a1 разные. Ну то есть мы пользуемся вот этим и получаем
минус 1. Доказал? Вроде доказал. Круто. Так, а вот он. Продолжим стирать. Сейчас сделаем.
Да мы уже близки к победе. Сейчас возьмем матрицу b и сделаем вот так.
Звонок, конечно, звонит, но что делать? Я хотя бы допишу, что такое b'. Да,
это производная матрица по модулю P, да. Кручу. Не, все проще гораздо. Отличается от b добавлением,
ну вернее не добавлением, заменой, наверное, добавлением минус единиц на диагональ. Не буду
уже стирать. Ну, в общем, у b на диагонали стояли нули, а мы возьмем и все их заменим на минус единицы.
Все нули, которые стояли на диагонали, возьмем и заменим на минус единицы. Рассмотрим такую
матрицу, она уже будет размера n на n, потому что мы пририсовали слева и сверху нужные нам
строчки, так чтобы матрица получилась в нормальной форме. Так, вы согласны, что она прямо в нормальной
форме, то есть в каждой строчке сейчас половина минус единиц, половина единиц. Это вот вспоминаем
вот это гениальное упражнение. Мы добавили одну единицу, добавили одну минус единицу, а до того
остальных было поровну, вычетав и не вычетав. Поэтому сейчас в каждой строчке поровну единицы,
перерыв. Так, друзья, давайте уже завершим это дело. Тут на самом деле немного осталось,
но некий катарсис ждет еще тех, кто чего-то не допонял сам, потому что на самом деле все
готово, конечно же. Ну, видите, вот здесь мы оставили вот этот кусочек, который доказали
специально, чтобы вам просто было удобно смотреть на то, чего мы знаем. Ну, то есть смотрите,
чего мы знаем, глядя вот на эту матрицу. Еще до окончания предыдущей части лекции мы поняли,
что каждая последующая строчка, строго после первой расположенная, артагональна первой строчке.
Ну, мы с вами выяснили, что половина единиц, половина минус единиц в каждой из них. Выяснили?
Это было. Теперь смотрите, что можно сказать про две каких-то строчки. Вот у нас две каких-то
строчки. Как устроено их скалярное произведение? Оно равно один, вот здесь вот один стоит,
правильно? Прибавить ту самую сумму, которую мы посчитали, но я ее честно напишу, сумма по б
от единицы до п, а1 минус b по п на а2 минус b по п. То есть, ну прибавить минус единицу,
конечно. Но что еще произошло? Мы дописали на диагонали минус единицы, правильно? Вот тут,
вот на этой диагонали мы нарисовали минус единички вместо нулей, которые там были. Вот сейчас мы
смотрим строчку а1 и строчку а2, поэтому здесь написано а1 а2. Вот что изменилось? Вот здесь на
диагонали где-то стоял нолик, а превратился он в минус единичку. Значит, надо вычесть теперь вот
из этой суммы, которую мы посчитали, вычесть, потому что теперь здесь стоит минус 1 вместо нуля.
Что надо вычесть? Надо вычесть то, что написано тут, то есть а2 минус b по п. Вот тут вот b, правильно?
Сейчас, подождите, какое b? Это же а1. Сейчас, сейчас, должно быть а1, сейчас какое b?
Нет, смотрите, какое b? Здесь, конечно, а1, потому что мы находимся на диагонали,
мы находимся на диагонали. То есть, если здесь а1, то и тут тоже а1. Я чуть-чуть сегодня лажаю,
виноват. Конечно, здесь не какое-то общее b, а а1 в точности. Мы находимся на диагонали,
поэтому катарсис-то вот сейчас будет, смотрите, сейчас будет а2 минус а1 по п. Точно так же у а2 вот
здесь стоит а2, у а2 вот здесь стоит а2. То, соответственно, вот здесь появилась минус единичка
вместо нуля, и надо вычесть еще раз, но уже а1 минус а2 по п. Согласны? Все видят, что вот тут вот
добавилось со знаком минус а2 минус а1, а тут наоборот а1 минус а2. Вот это вот, а1 минус а2.
Вот это вот число, это а1 минус а2 по п. Все согласны? Нет проблем. Смотрите, так это равно
минус один. Так, смотрите, а2 минус а1 по п. Это минус один. Так, не так, минус один. Минус один.
Умножить на а1 минус а2. Все по п. По мультипликативности это минус один по п. На а1 минус а2 по п. А минус
один по п. Это, как мы знаем, минус один в степени п минус один пополам. Знаем? На прошлой лекции было.
А по п это а в степени п минус один пополам. Было-было. Так, вспоминаем, что такое п. Это минус один в степени
4к плюс три минус один пополам. Тут очень важно, что п имеет вид именно 4к плюс три, а не 4к плюс один.
Потому что 4к плюс три минус один это 4к плюс два. Пополам это 2к плюс один. И вот именно поэтому
получается минус один. То есть вот здесь стоит минус по отношению к этому. И они делают вот так
друг по отношению другу. Это называется шлеп-шлеп. Все, у нас получился ноль. Видите,
как подкомпенсировали. Но тут вот очень важна эта арифидическая природа. Все сработало.
Есть какие-то вопросы? Доказал? Все сработало. Так, ну давайте я, наверное, буду последовательно
рассказывать два применения матрицы. А, прежде чем применение все-таки. Смотрите, вот прежде
чем применение рассказывать матрица Адамара. Давайте я скажу следующее. Поскольку упражнение
с двумя звездочками состояло в том, чтобы доказать, что простые числа вида 4к плюс три тоже плотно
встречаются в натуральном ряде. Ну, шуточное упражнение, которое не надо решать, но просто
утверждение, которое известно. То мы тем самым получаем, что матрицы Адамара реально очень
много. Мы не доказываем, конечно, что для любого n вида 4к существует матрица Адамара. Это мы не
можем сказать. Но мы можем сказать так. Для любого, например, Эпсилон большего нуля на отрезке,
ну там. Так, для, существует n нулевое. Такое, что для любого n больше либо равного n нулевого,
на отрезке от n до 1. Так, ну, конечно, любого Эпсилона теперь надо вынести сюда. Виноват.
Так, но n найдется порядок матрицы Адамара. Вот так. Найдется порядок матрицы Адамара. Да,
вот так вот мы можем утверждать. Это следствие утверждений типа того, что на любом коротком
отрезке есть простое число какого-то вида. Мы можем зафиксировать, какое угодно Эпсилон
больше нуля, начиная с какого-то n, на этом узеньком отрезке обязательно найдется нужное
простое, а, стало быть, будет иметь... Мы найдем и порядок матрицы Адамара. Потому что простые в
натуральном ряде даже такого вида часто встречаются. Из конструкции, которая была с
Кронекеровским произведением, из конструкции 2 в степени k, ничего подобного, конечно, не следует.
Степени двойки очень редко встречаются в натуральном ряде, а простые числа часто,
поэтому гипотеза не доказана, но в каком-то смысле асимпатически она верна. Но вот именно в этом
смысле, что между n и чем-то очень близким к n есть достаточно много порядков матрицы Адамара.
Вот так. А теперь применение. Я вам расскажу два. Номер один – это будет задача о раскраске,
а номер два, это я сразу анонсирую, это будет кодирование.
Да, прям та самая, но немножко не такая. Сейчас я в реакцию на тему расскажу. Да-да-да, раскраска
будет прям такая, как на первой лекции. Мы все время сегодня вспоминаем первую лекцию по УКТЧ,
называется «Вспомним молодость», да? Молодость прошла. Ну типа того. Кодирование, конечно,
в каком-то смысле более прикладная история, потому что это коды исправляющие ошибки. Я решил,
что я с нее начинать не буду, вдруг не все успею. А раскраску я тоже всю не успею, но мне хочется
кодирование в одну лекцию впихать. Так, чтобы это прям целиком на одну лекцию пришлось. Поэтому
я, наверное, начну с раскраски. С другой стороны, мотивация – вспомнить молодость. Раскраска у
нас в каком смысле была? Ну, еще раз, помните, была задача 30… Что там? Не-не-не, было 30 человек,
просто множество из 30 элементов. В нем было 15 пятиэлементных подмножеств сочетаний, да. Мы
доказывали, что вот эти 30 элементов можно покрасить в два цвета, так чтобы каждое из этих сочетаний
было неодноцветным. Прям первая лекция. Принцев Дерехле. Была? Все помнят. Ну, давайте эту задачу еще
ужесточим. Мы хотим не просто покрасить под множество сочетаний, чтобы они были неодноцветными,
а мы их хотим так покрасить, чтобы они были как можно сбалансирование покрашены. Ну, то есть,
чтобы в идеале просто половина красных элементов, половина синих, в каждом множестве. Ну,
вы мне на это скажете, как это сделать, если элементов пять? Я на это отвечу никак. Тогда самый
лучший вариант – это два плюс три. Пополам элементы не делятся. Два плюс три тогда. Ну,
давайте я формально задачу поставлю. В общем случае причем сразу. Задача о раскраске. Давайте
я чуть более точно скажу. Это будет называться задачей об уклонении раскраски, об уклонении
просто. Важная, на самом деле, тоже история. Если найду время, я расскажу, почему важная. Но,
в принципе, просто красивая, интересная и хорошо иллюстрирующая, как работает матрица
одамара в каких-то конкретных применениях. Значит, история такая. Вот есть множество,
давайте его обозначим v с индексом n, и оно состоит из 30… ой, из 30 из n элементов. Это аналог того
самого объемлющего множества, которое было на первой лекции, когда n равнялось 30. Но в общем
случае n элементов, почему 30? В общем случае есть n чисел. Дальше. В этом множестве выбраны какие-то
подмножества m1, и так далее, m с каким-то там индексом s. Вот эта буковка s, это не 5,
это буковка s, это количество множества. Ну и сколько-то параметров задачи. Так, не видно что-ли,
да? Ёлки-палки. Ну давайте я сейчас перепишу в другом месте. Всё, можно продолжить. Ну хорошо,
m1, ms, да, это какие-то подмножества вот этого множества. Какие-то подмножества. Давайте считать,
что они даже все одинаковые мощности, хотя это неважно. Ну просто какие-то подмножества.
Они могут даже равняться самому множеству, да, то есть они не обязательно равномощны,
они могут равняться самому множеству, но каждое подмножество мы понимаем как сочетание,
то есть порядок элементов внутри не важно. Подмножество это сочетание. Ну давайте считать,
что все подмножества разные. То есть есть какие-то с-сочетания, и все они разные. Давайте
буквой m каллиграфически обозначим совокупность, которая состоит из этих подмножеств. М1,
ms сами подмножества, а m красиво это их совокупность. Множество состоящее из подмножества.
Так, теперь вот есть какая-то раскраска чисел от единицы до n. Помните, как раскраска вот этих
чисел от единицы до тридцати? В два цвета. Давайте ее интерпретировать вот так. Значит,
хи это раскраска. Буковкой хи, как вводится, будем обозначать раскраску. А интерпретировать
будем вот так. То есть мы каждому числу присваиваем плюс или минус единичку. Ну скажем,
это красный цвет, это синий цвет. Чуть-чуть уже напоминает что-то такое с матрицы Адамар,
но правда это вектор все-таки. Из плюс и минус единицы. Ну непонятно, но по крайней
мере плюс-минус один. Зачем плюс-минус один? Ну давайте еще введем вот такое обозначение хи
от митова. Я очень прошу прощения за то, что я два разных формально объекта обозначаю одной
буквой, но если я сейчас буду другую букву тут использовать, мне кажется понятнее станет еще меньше.
Ну еще понятнее, чтобы схоже было. Главное, чтобы они были похожи, но при этом обозначали
разное. Ну смотрите хи, вот здесь оно берет от элемента множества, а здесь от подмножества
множества. Формально это разные вещи. Ну то есть я могу конечно здесь х нарисовать, но я не знаю,
товарищи, неужели вы хотите, чтобы я букву поменял? Мне кажется не надо. Мне кажется ну просто вот так
взяли и обозначили. Хи от митова это просто сумма по ж принадлежащим митому хи от жи,
где хи от жи это уже плюс или минус единицы. Красный или синий цвет. Не, это никакое не скалярное
произведение. Мы просто читаем сколько красных вершин в этом множестве и сколько синих вершин
в этом множестве. И одно число мы читаем из другого. То есть нам хочется сделать так, чтобы это было
как можно меньшим числом, как можно ближе к нулю, чтобы модуль вот этого числа был как можно меньше.
Вот нам бы хотелось вот этого. Причем ну хотелось бы чтобы это было по всем и как-то вот равномерно,
чтобы для каждого и это было маленьким числом. Вот это место можете не записывать, потому что это
неформально, это просто я поясняю. Пока я дал определение, сейчас будет четко сформулированная задача.
Значит вот так вот обозначим. Диск это от слова discrepancy английского,
которое означает разброс, уклонение. Не от слова диск как круг, а такое длинное слово discrepancy,
разброс, уклонение. Задача-то об уклонении. Вот диск от mhi это будет максимум по и,
ну по и от единицы до s, если хотите я напишу явно, по и от единицы до s, модуля hi от митого.
Ну самый большой разброс на конкретном множестве по цветам. Так всем понятно,
что происходит. Модуль hi от митого это просто разность количества красных и синих вершин
внутри данного конкретного сочетания. И мы еще на их худший случай называем его вот таким вот
уклонением с совокупностью м в раскраске hi. И еще вводим вот такую штуку. Опять обозначаю
такой же буквы, но другой объект. Диск от м это максимум. Минимум. Вот как раз про минимум я
тут говорил. По всем hi. Диск от мhi. По-моему никакой путаницы не возникает. Ну аргументы разные,
все равно мне кажется. Нет, ну слушайте, ну если один аргумент, видно, что это другой диск. Ну
разные же аргументы, правильно. Я же нигде не буду. Значит, друзья, я небольшое лирическое отступление.
Некоторые из вас знают, что были такие бурбаки. Все знают? Ну не все, но были такие бурбаки. Это
группа ученых, которые объединились под таким псевдонимом и которые писали книжки по математике
и занимались программой по максимальной формализации математики в каком-то смысле. То есть они хотели
ну прям вот все очень-очень формально прописать аккуратно. Ну и, например, в аналиде, может быть,
вас учили, что функции, вообще говоря, надо обозначать вот не так. Это уже не функция, это число,
это результат подстановки икса в функцию. Сама функция обозначается просто вот так. Другой вопрос,
который всегда задавали этим людям. Ну хорошо, если мы пишем у равно х квадрат, вот что нам в этом
месте делать? Если у равно х квадрат, как это писать? Ну то есть функции сами образуют какое-то там
пространство множество. Поэтому объект этого пространства это не f от x, а m, сами функции. И если я
превращусь в бурбакиста, то прямо сию минуту у вас на глазах. Ну вы-то знаете какой из меня бурбакист,
какой я не формал. Но если я вдруг превращусь сейчас у вас на глазах в бурбакиста, то все эти
аргументы пропадут, и я буду говорить диск, диск, диск, там как f, f, f. И все, и тогда вы запутаетесь,
конечно. Но поскольку я всякий раз буду писать аргумент, то никакой путаницы не возникнет. Все,
прогон закончен. Нет, смотрите, мы каждому числу из вн-ого присваиваем красный или синий цвет,
плюс или минус единичку. То есть всему вн-ому мы присваиваем вектор из плюс-минус единицы,
от раскраска. Раскрасок два вн-ной степени. Я не то написал, да? Ой, елки-палки, да. Да-да-да.
Да-да-да, спасибо. Я совсем не бурбакист, со мной плохо, да. Еще хуже. Двойка мне все на экзамене.
Тем на балл выше, особенно задавшему вопрос. Да-да, товарищи, запоминайте все. Шучу-шучу-шучу-шучу.
Вот под запись, под... шучу. Ладно, товарищи, все. Так, ну все все поняли, что происходит. Значит,
если я получаю какую-нибудь верхнюю оценку на вот эту величину, ну какую-нибудь, то что это означает?
Это означает, что существует раскраска, в которой все вот эти разбросы действительно достаточно маленькие,
вот настолько маленькие, как здесь написано. А если я оцениваю эту величину снизу, там опять же чем-то,
то это означает, что как ни красть, какую раскраску ни бери, а где-нибудь выброс случится больше,
чем вот эта величина. Понятно сказал, да? Ну это такой просто понятный комментарий, чтобы много кванторов,
много минимумов, максимумов.
Значит, давайте я формулирую теорему, которую мне в итоге хочется доказать.
Теорема звучит, наверное, так. Теорема звучит так. Пусть
S равняется N, ну то есть множество сокупности мы хотим построить столько же, сколько и
элементов в объемлющем множестве. То есть не 15 пятиэлементных подмножестей, а 30, скажем,
пятиэлементных подмножестей, пятиэлементного множества. Значит, пусть S равняется N. Так, тогда
существует M, равное M1 и так далее, МС. Из необязательно равных множеств, вот это подчеркните
себе множество, могут быть разные мощности тоже. Хотя, подчеркните, не подчеркните,
наверное по факту-то они будут одинаковые мощности. Ну не важно, по факту в доказательстве они
одинаковые получатся. Значит, существует такая совокупность, то диск вот этой совокупности
больше либо равняется корень, ну ничего, сейчас справимся. Коль скоро, ну что-то я сегодня никак
не могу прям совсем гладко рассказать, коль скоро N это порядок матрицы Адамара. То есть,
ну конечно, это надо было в начале написать. Порядок матрицы Адамара. Ну сейчас я еще раз
повторю. Получше формулировка звучала бы так. Пусть S равняется N, где N порядок
матрицы Адамара. Тогда существует совокупность, у которой вот эта дискрепансия больше либо равен
корень из N попала. Но я забыл это условие написать в начале, поэтому я его поставил в конец, но неважно.
И S и N, которые равны между собой, да, мы считаем порядком матрицы Адамара. То есть, это число,
делящиеся на четверку, конечно. Мы верим в гипотезу Адамара, но доказать ее не можем. Поэтому,
вот если посмотреть сюда, то можно, конечно, переформулировать теорему сразу вот так.
Теорема штрих говорит, что если S равняется N, то диск вот M больше либо равняется 1 минус
Эпсилон N на корень из N пополам, где Эпсилон N стремится к нулю при Н-стремящемся бесконечности.
Существует некоторая функция, стремящаясь, некоторая последовательность чисел, стремящаяся к нулю,
такая, что дискрепанс оценивается снизу вот так. Потому что простые в натуральном ряде
встречаются плотно, и, соответственно, порядок матрицы Адамара можно найти около любого
натурального числа, отступив ненамного. Понятно, да, что вот то, что написано на левой части доски,
то, что сейчас написано в теореме штрих, вытекает, вместе дает как раз эту теорему за счет теоремы
без штриха. Еще раз, теорема без штриха вместе с тем, что написано в левой части доски, дает
теорему штрих. Ну, боксник. Это понятно, это должно быть понятно. Если непонятно, то вопросы
приветствуются. А я, в общем, хотел бы начательно доказывать это. Что я успею? Десять минут. Ой, плохо.
Ой, плохо. Я ничего не докажу. Нет, всю теорему точно не докажу. Нет, задерживаться не надо. Ну,
ничего неприятного в этом нет. Я вам сейчас сформулирую теорему. А? Не-не-не, почему я
начал следующую лекцию с доказательства этой теоремы? Это не вопрос. Вы что? Это очень красивое
рассуждение, смотрится одомара. Я ни в коем случае вам вот это не оставлю в качестве упражнения. Вы что?
Вы что? Я вам сейчас другую теорему сформулирую, которую не буду доказать. А? А, я понял. Не, ну,
смотрите, я же могу вам много чего оставить в качестве упражнения, просто сказав, что это верно.
Ну, в шутку оставить в качестве упражнения. Мы же не все в этом курсе проходим, что есть в
комбинаторике и в теории чисел, правда? У меня тоже. Знаете, какой был бы курс, если бы мы все
прошли? Весело было бы. Нет, давайте я объясню, что вот эта теорема, на самом деле, в каком-то
смысле крутая. В каком-то смысле она крутая, потому что есть теорема, которая, давайте без
доказательства, я всегда вот так пишу, без доказательства в нашем курсе. Она говорит,
что в условиях вот этой теоремы 1, верхней теоремы, в условиях теоремы, то есть,
порядок матрицы Адамара. Ну, кстати, это не так важно. Для верхней оценки это не так важно.
Для любого М, вообще любого диск от М не превосходит, ну, точную константу я не вспомню,
но 6 точно верно. Не превосходит 6 корней из N. Ну, так оценили. Это невозможно в двух словах сказать.
Тут работает вероятностный метод, очень красивый, нетривиальный, который я сейчас не могу рассказывать
вам, например, потому что вы вероятности формально не знаете. Вот у вас начнется вероятность скоро,
может, в дискретном анализе я вам это и расскажу. А сейчас в основах комбинаторики рассказывать не
буду. То есть, понимаете, вообще для любого М дискрепанс не превосходит 6 корней из N, условия имеется
в виду только вот это. То есть, матрица Адамара может и не существовать. Любого М диск от М не
превосходит 6 корней из N. Существование матрицы Адамара гарантирует неулучшаемость вот этой
верхней оценки более чем виноват в 12 раз. Ну, то есть, в 12 раз, может, ее и можно улучшить,
но корень из N это точный порядок роста, в этом пафос. Я понятно формулирую? Чуть-чуть меня сегодня
заносит, поэтому я боюсь вдруг опять что-нибудь не так сказал. Хочется, чтобы все было предельно четко.
Так, ну, знаете что, я, конечно, вам напишу, как строить вот эту М, но доказывать это буду в
следующий раз. Время-то есть, что не написать.
Берем матрицу H, которая матрица Адамара в нормальной форме верхние единицы,
левые единицы. Прибавляем к ней матрицу, которую будем обозначать G. G это матрица,
которая состоит из сплошных единиц. Это не единичная матрица, как учат в алгебре,
а это матрица из одних сплошных единиц. Ну, такая супер единичная матрица.
Ну, я не знаю, почему у вас так пополам. Ну, нормальная матрица, что такие используют,
конечно, и в алгебре тоже, но просто она называется... Ну да, да, это правда. Ну,
в общем, если вы берете матрицу H, то есть матрицу Адамара в нормальной форме,
прибавляете к ней G и делите пополам, то у вас в каждой строчке будут нули и единицы,
правильно? То есть верхняя строчка будет по-прежнему из сплошных единиц, а в следующих строчках будет
половина нулей, половина единиц. Так вот, совокупность M красивая, она будет состоять ровно из тех множеств,
которые соответствуют номерам позиций, где стоят единицы в строчках. Ну, вот здесь вот верхняя
строчка из единиц, то есть M1 это будет просто 1, 2 и так далее N. Все в N. Это будет M1. Дальше,
допустим, стоят половина единиц, половина нулей. Соответственно, M1 это будет 1, 2 и так далее N пополам.
Ну и так дальше. То есть вот те номера позиций, которые соответствуют единицам,
они и будут соответствовать нашим множествам. Помните, я задумался над формулировкой,
будут ли они одинаковой мощности? Ну, почти все будут, кроме одного верхнего.
Абсолютно непонятно, почему, как вообще с этим работать. Но пусть у вас будет интрига до следующей
лекции. Вот придете через неделю, я расскажу, почему это так. Ну ничего сейчас не успею,
5 минут осталось, никак не доказать. Нужно минут 20, наверное. Не успеваю. Не, ну самые крутые могут
попробовать доказать сами, но, с другой стороны, зачем? Я приду и порадую. Но вы лучше докажите
гипотезу Адамара. Это гораздо полезнее, понимаете. Я же не приду в следующий раз и не докажу вам
гипотезу Адамара. Вернее, приду, но не докажу. Ну для чего-то я и так доказал. Все, друзья,
на сегодня все. Спасибо.
