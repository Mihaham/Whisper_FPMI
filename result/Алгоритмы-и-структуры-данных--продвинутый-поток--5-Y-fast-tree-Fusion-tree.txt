так вот, ну давайте вспоминать, что у нас в прошлый раз было, да-да-да, и кореевуха, да-да-да, ну да,
про линкад мы промолчим, да, хотя нет, про линкад как раз не хочется молчать, линкад крутая вещь на
самом деле, да, ну это да, ну как бы это у вас еще можно сделать еще, ну да-да-да-да, вот, ну давайте
вспоминать, да, мы говорим о целочисленных алгоритмах, потому что чувствуем мы как раз-то
ближе к великому атомик хипу вообще, чем называется, чем казалось, да, более того, в атоме хипения
неожиданно появится выход на как-то более классический алгоритм, чем что-то там какие-то
абстрактные там, то есть в частности мы научимся искать миностов за линию, ну предположение, естественно,
что все там веса всех ребер это там целые числа, вот, то есть оказывается это более-менее на халяву
будет, так что видим, так что, видимо, после этого всей целочисленности, видимо, следующие цели,
там надо будет срочно пройти миностов, вот, что? Нет, ну как-то нет, что такое графчики, мы уже знаем,
потому что мы уже искали кратчайшие расстояния в них, да, но осталось еще тоже их научиться искать
за линию, но это сильно сложнее, к сожалению, потому что там, там помимо атомик хипа, придется еще
там себе там мозг взрывать на тему некоторой теории, называется миностов будет за линию искаться
более-менее на халяву, ну по сравнению с этим уж точно, вот, но там все выплывут, там даже Тарьян выплывет,
вот, то есть как-то, знаете, как приятно было читать в конце этой, в конце статьи про атомик хипа,
то есть казалось бы там Фредмон Виллор, да, казалось бы хоть где-то без Тарьяна, да, казалось бы,
а потом, а потом в конце мы благодарим Боба Тарьяна за, там, как-то, как они выразились,
стимулейтинг дискашнс, стимулейтинг дискашнс, вот, и, в общем, и, короче, за то, что он наткнул нас носом задачу про миностов,
вот, но да, но потому что дело в том, ну, почему, ладно, подробнее расскажу ближе к делу, а пока,
давайте, о чем мы остановились, мы тут пытаемся реализовать какой-то мистический черный ящик,
который умеет делать операции какие, ну, в первую очередь, я даже тут прям во главу угла напишу,
саксессор предсессор, вот, саксессор предсессор, причем более того, в какой-то момент нам даже
становится более-менее все равно, потому что помните, у нас этот интерес, прикол, что нам более-менее все
равно, что искать, потому что мы будем искать приблизительный элемент рядом, если он не с той стороны,
мы пойдем по списку в следующий, вот, значит, есть саксессор предсессор, какие у нас еще операции есть?
Ну, не совсем, не совсем, вот то, что у нас в прошлый раз было, теоретически у нас было, инсерт дилит тоже был.
Ну, не только, не только, нет, там не в этом дело было, там, на самом деле, то есть, ну, давайте сейчас
смотреть, какие у нас ассимтуетики есть, что нам еще интересно, ну, теоретически интересно еще,
конечно, память, вот, но так-то да, но все равно иногда бывает мечта все-таки сделать получше,
потому что, вот, мы с вами обсудили xfast, вот, давайте вспоминать, вот, давайте вспоминать,
вот, саксессор предсессор у нас за какой симпточку работал?
Вот, лог v, да, мы по этим битам там и хитрялись бин поиск делать, да, там бин поиск в хэшмапах,
вот этих всех. Ну, вот, ну, как умяли, там проблема, что вот инсерт, к сожалению, работал за, вот,
вот, видимо, да, оат, оат, да, ну, память, если была за оат v, это была бы мечта, конечно, ну, вот,
но да, память у нас, соответственно, оат nv, да, или там, оат лог, вот, ну, вот, но сегодня, ну, вот,
но мы неслучайно в прошлый раз закончили на одном конкретном виде корнячки, потому что у нас,
значит, теперь, значит, мы попробуем чуть-чуть повысить ставку, ну, вот, и повысим мы ставку,
вот, на что, то есть, это, ну, вот, вот, давайте смотреть, ну, о, ну, вот, действительно, очень хочется,
чтобы действительно, может быть, ну, вот, чтобы, с одной стороны, у нас саксессор предсессор был
за там какой-нибудь лог w, ну, вот, очень бы хотелось, чтобы, во-первых, памяти было оат n, а во-вторых,
а во-вторых, давайте посмотрим, то есть, не получится ли у нас еще и вставку удаления допилить
за логариф, вот, а вдруг, вот, да, нет, нет, тут, тут, и тебе будет, ну, то есть, а симпатика-то,
может, и такая, то есть, да, если в one md boss и поверить в эти все хэш-мапы, да, ну, вот, то, конечно, да,
но, тем не менее, называется, мы пойдем другим путем, вот, типа, Фреддман пошел другим путем,
кто мы такие, чтобы ходить не тем же, вот, ну, а теперь, вот, возникает вопрос, ну, вот, вот,
теперь возникает такой интересный вопрос, вот, действительно, там, как упихать, действительно,
память nw в оат n, ну, смотря, что такое та же идея, вот, ну, нет, нет, вот тут сразу скажу,
на самом деле, сегодня идеей x-fast 3 нам не понадобится, все, вот, мы можем просто себе
у нас есть черный ящик, который умеет вот так, ну, типа того, да, вот, ну, давайте смотреть, да,
может, на insert и delete мы на всякий случай, конечно, вопросик поставим, в идеале, конечно, да,
ну, вот, давайте думать, ну, какая тут идея возникает, ну, возникает, на самом деле, идея,
действительно возникает, идея, которая у нас была уже раньше, но не совсем такая, а возникает идея
такая, что, наверное, если мы хотим хранить в структуре меньше памяти, наверное, надо в структуре
хранить меньше элементов, вот, но как же это сделать, ну, да, можно, можно сжать, а можно, как всегда,
значит, вести boobin, ну, да, ну, нет, нет, мы храним n на w дичей к памяти,
каждый дичей рассчитается от единицы, да, вот, то-то и оно, то-то и оно, вот, значит,
смотрите, вот, х1 меньше, х2 меньше, х3, вот, вообразим себе, что у нас тут хранится вот такое
вот нечто, там массивчик какой-то отсортированный, да, вот, там меньше, я даже его как-то, но меньше,
кстати, ну, естественно, мы его себе так вообразим, вот, ну, вот, но на самом деле, конечно, мы, мы все
равно будем хранить там в некотором смысле, действительно, этот вот и опять двусвязанный список,
то есть, где там по каждому элементу мы там легко получим там предыдущий следующий, это для нас
проблемой не будет, да, ну, поддерживать будем, это нам, конечно, будет, нет, он не циклический,
там xn, все нормально, нет, циклическая цепочка строгих неравенств, это вообще что-то подозрительное,
вот, вот, значит, смотрите, так вот, итак, мы введем бубен и разобьем на блоки, на блоки по бубен
элементов, вот, разобьем, значит, по соответствии бубен элементов и более того, мы даже хитро заведем
очень интересные числа, мы заведем числа, допустим, вот, r0, r1, r2, r3, ну и так далее, но r там,
условно, n поделить на бубен, ну, точнее так, это называется rk, k там приблизительно равно n
поделить на бубен, да, количество блоков, блоки, более того, эти блоки мы тоже назовем, там даже s1,
s2, s3 и так далее, sk, ну, в общем, я даже немножко набрал, что в каждом блоке будет по бубен
элементов, ну, во-первых, n не обязана делиться на бубен, вдруг n простое число, правда, да,
во-первых, чуть-чуть подгоним, а во-вторых, мы и поддерживайте вариант, будем, что в каждом блоке у нас
будет, ну, что-то в духе от, ну, как всегда, давайте, вот, тут константы мы потом подгоним, если что,
но давайте, как всегда, от одного, от одной второй бубна до двух бубнов, а r и t, да, внимание, это
важно, r и t это число, то есть r и t такое число, которое вот меньше либо равно всех, значит,
s, там меньше, чем, допустим, s и плюс первых, но при этом, ну, вот так, даже подгоню тут,
r и t нет, ну, то есть, на самом деле, это да, на самом деле, это будет число из множества, но на самом
деле, нас интересует, что это вот какое-то число, да, даже не принципиально, что оно конкретно
обязательно из множества, точнее, к двум соседним блокам, потому что r и t это разделитель, но, то есть,
смотрите, то есть, дело в том, что всех числов s и там меньше, чем всех числов s и плюс первым,
ну, от одного, количество, количество блоков, ну, r даже, да, вот, можно сказать, ну, актуальных
r, на самом деле, даже k-1, я бы сказал, вот, то есть, вот такая вот красота, то есть, r и t это
разделитель, то есть, я, конечно, тут немножко неформально написал, что множество меньше либо
равно числа, но, я думаю, вы понимаете, что имеется в виду, вот, ну, я тут могу написать
какие-нибудь максимум, минимум, но это все уже мелко, так вот, идея такая, значит, так вот,
значит, я буду использовать в качестве черного ящика вот этот вот xfast, вот, но чит у меня будет
заключаться в том, что, соответственно, я буду хранить нот, то есть, да, я буду хранить,
соответственно, все эти ноты в xfast-е именно, именно r и t, да, вот, так что храним r и t, ну,
вот, так вот, значит, r и t, значит, храним, то есть, r и t храним в xfast-3 и, соответственно,
что нот, а каждый, каждый по отдельности, внимание, с и, каждый с и в двоичном, да, так и хочется
написать в dd, короче, храним, но я напишу в ddp, в двоичном дереве поиска, короче, да, ну,
как-то, ну, каком-нибудь, который работает за логарифом, s это блок, то есть, это не элемент,
это множество, вот, да, какой-то он же это проговорил, да, я не знаю, какой-то он, я не знаю,
кто, вот, очень просто, ну, и когда я говорю, что множество меньше либо равно числа, я имею в виду,
что все числа этого множества меньше либо равны этого числа, ну, да, да, ну, вот, ага, ну,
а все, тем не менее, ну, то есть, так, то есть, ладно, я бы, ну, вот, ну, то есть, можно привести такую
аналогию, которая нам периодически тоже, знаете, вот, начнем подгружать в памяти, помните такую
структуру данных, как b дерево, так вот, на самом деле, так вот, если бы у нас было b дерево, у которого
есть вот k, вот, таких вот детей, то вот, r могли бы быть ключами вверши, то есть, смысл,
нет, ну, это так, но это просто вот аналогия для того, чтобы понимать, действительно, что такое s,
что qr, как они связаны, только для этого, ну, и для, ну, и потому, что в каких-нибудь в этих там,
там fusion деревьях, там это b дерево или еще или там светлый образ его могут понадобиться, вот,
значит, смотрите, что у нас сейчас тут будет, ну, вот, ну, давайте для начала попробуйте угадать,
чему будет равен boobin, прям вообще без вариантов, нет, ну, действительно, конечно, если мы хотим,
чтобы у нас x-фаз, действительно, был, но, действительно, адекватной памяти, то, наверное,
памяти надо быть в w, ну, я вам так скажу, в реальности будет w, ну, ладно, если понадобится,
в каты не надо, там, видите, ну, понятно, да, нет, понятно, что в с этой, да, да, да, но, знаете,
нет, с этим, ой, с этим мы еще, у нас там будет и w в квадрате, и w в степени 1 четвертая,
там и 11 w в степени 1 пятая, ну, здесь, а здесь и не надо, нет, смотрите, нет, идея просто такая,
чем нам помогает w, то есть, если boobin у нас w, то, пока и меряем память, в которой мы можем это
хранить, она действительно o от n, почему, потому что erac у нас асимпатически o от n поделить на,
n поделить на boobin, именно, нет, память, нет, нет, памяти, смотрите, у нас памяти, смотрите,
у нас хранится kr, ну, там плюс-минус, да, k, поэтому память у нас k на w, ну, так как k это асимпатически
n поделить на boobin, то, то есть, n поделить на w, то n поделить на w, множество w равно n, вот, да,
еще, да, то есть, мало того, что заметим, что каждое конкретное ddp мы храним за линейное время,
помните, да, хранить за время это хорошо, конечно, да, вот, ну, хранить, да, хорошо,
храним за линейную память действительно, но и что самое приятное, запрос там поиска каких-нибудь
саксессоров-предесессоров у вас тоже великолепно будет работать за вот требуемый лог w, да, это готовая
структура, так она будет устроена, вот, по крайней мере, вот, да, пока нет инсортов и дилитов и прочих
саксессоров-предесессоров, ну, хотя, да, давайте начнем с саксессоров такой, с разминочки, да,
саксессор-предесессор, как тут искать саксессора-предесессора, ну, в общем, сначала за лог w мы найдем подходящую r,
с помощью ее найдем подходящий блок, в котором надо искать ответ, ну, а найдя блок мы просто отправимся в
двоичное дерево поиска и за тот же самый лог w найдем само число, тут пока все просто, или нет?
Что? Ну, практически, да, нет, ну, точнее так, блок-то вы быстро поедете, что вы найдете там
какой-то нот, то есть вы там, допустим, найдете, дали вам какой-то х, вы находите у него там,
допустим, upper bound, да, какой-то вот он upper bound, значит, наверное, если х есть, то он лежит вот в этом
блоке, все, ну, вот, точнее так, ну, если х есть, ладно, если вы ищете саксессора, например, то и он как бы лежит
либо в этом блоке, либо минимум вот в этом блоке, хотя, ну, да, если еще подобные мелочи добавить, то да,
нам становится вообще, нет, нет, нет, нет, нет, нет, нет, нет, нет, вовсе не обязательно, и сейчас вы увидите почему,
потому что смотрите, да, потому что, смотрите, тут же еще одна красивая фишка, хорошо, саксессор,
предсессор, мы уже поверили в блок w, да, потому что у нас в x-фасте саксессор, предсессор с блок w работает, вот,
обратите внимание, зачем мы это делали, у нас есть крутая структура данных, которая вот с саксессора
предсессора, она круто ищет, да, она тут страдает со всем остальным, но вот относительно страдает,
конечно, вот, но зато саксессора предсессора она прям вот, вот, и мы этим пользуемся, поэтому,
то есть когда мы ищем саксессора предсессора в этой структуре, мы за вот эту асимптотику находим
там этого саксессора предсессора, то есть там upper bound, lower bound там среди эрог, понимаем в какие блоки
вообще надо смотреть, ну вот, точнее скорее в какой блок, и в этом блоке уже за там, уже в двоичном
керебе поиска ищем, собственно, lower bound, upper bound, вот, но так как в каждом из них w элементов,
то опять же из лог w мы никуда не делись, вот, так что вот такая вот, такая вот штука, пока мы не
начинаем делать insert и delete, так, еще тут какие-то вопросы есть? Тут пока все понятно,
потому что может быть, да, пока вот, как искать саксессор предсессор, поняли, ну и как структура
устроена тоже, да, хорошо, вот, нет, ну не волнуйтесь, пока, ну вот, ну а теперь дальше, ну в принципе,
в общем-то, да, дальше вступает в дело, наверное, то есть вот этот вот отрезок, наверное, вызывает
какие-то ассоциации с прошлой лекции, правда? Ну давайте вспоминать кодовое слово корнячка,
вот, помните, вот, мы не случайно в прошлый раз рассмотрели такую задачу, как жил-был массив,
мы хотим его вставлять, удалять и там искать какую-то там какую-нибудь сумму на отрезке,
но при этом вот хотим это делать корнячкой, здесь мы будем делать буквально то же самое,
да, я не буду пересказывать как делать корнячку, я вместо этого расскажу как тут, ну вот, а идея
очень простая, мы просто, то есть хотим мы делать insert, но все очень просто, мы по экам
сориентируемся в какой блок надо вставлять, вот, за логарифом сориентируемся куда надо вставлять и
вставляем, да, в дерево поиска, да и да, ну вот, ну да, то есть пока, то есть некоторое время,
пока мы тут никуда не вышли за пределы этого отрезка, ну да, ну не совсем,
bin-поиск раз вы понимаете куда вставлять, а вот как-то уже там вставка, это уже двоичное дерево поиска,
нет, ну почему, ну как бы тут, спокойно, ну это можно назвать bin-поиском, наверное, где-то,
но как-то понятно, это всегда у нас неразрывно связано с bin-поиском, да, ну и потом в конце концов
спуск по дереву, это ли не bin-поиск, да ладно, господи, двоичное дерево поиска, это структура,
которая создавалась, чтобы узаконить bin-поиск, да, это дерево bin-поиска на самом деле,
так вот, значит, ну хорошо там вставку, мы сейчас не будем обсуждать, как делать вставку в ВВЛ,
мы это уже обсуждали, вот кому сложно можете красно-черное вставить, да, вот, значит,
неважно, черный ящик умеет, и это хорошо, вот, далее, вот, значит, смотрите, но, конечно же,
в какой-то момент начинается, что у нас расширяется, что у нас отрезок может расшириться,
ну в принципе он может стать очень-очень-очень большим, два бубен плюс один, что делать,
вот стал у нас отрезок жирным, да, ну естественно, как это, да, вот тут нам пришло время таки в этот
х-фаст сделать вставку, то есть придется тут попилить, попилить налево, попилить слева, тут бубен
элементов, да, будет справа бубен элементов и новая r-ка, да, правильно, поэтому я говорю бубен здесь,
бубен здесь и один новый элемент, да, вот, ну как сказать, не совсем обязывались, вот, вот,
ну и потом, даже, и потом, это не особо проблема, думаю, если в одном из этих нож будет бубен плюс один
элемент, то мы не расстроимся, так что есть, вот, так что и, ну как мало, нет, w это какая-то
бесконечно растущая функция, да, мы верим, да, что она растет, будет расти бесконечно в истории,
да, ну вот, ну, да, человечество вымрет, а w будет расти, да, вот, так вот, значит, короче,
достаем это r, я его назвал r2,5, почему я назвал r2,5, потому что, да, приходит время разбить
блок на два, и это означает, придет время вставить новую r-ку в великий xfast, вот, и придется,
правда, на эту штуку, сколько времени потратить, да, придется потратить w, но, как говорится,
уже догадываетесь, где тут победа, да, да, вот, да, вот в этом-то и ставка. В данном случае, да,
мы, раз уж мы и insert делаем за OAW, то и пилить деревья мы будем за OAW, да, здесь мы не
заморачиваемся, то есть, там, тотальная перестройка, там, собственно, ничего страшного, не та перестройка,
ну вот, перестройка только одного блока, а не вот это вот швы, там, каждый корень, кореньской
операции. Ну, короче, когда пилим блок, просто мы плюем, и просто, значит, в этом блоке, там,
находим медиану, там делим этот блок на два, и в каждом блоке, там, заново это делим, там,
свое это, там, AVL-ку строим. Ну или, ну или, ну или, там, да, пожалуй. То есть, в этом месте это
будет работать за OAW. Значит, ну, основная идея, за какой это будет работать, то, что у нас,
видите, пока у нас, пока, пока у нас нет дилитов, вот, предположим, что у нас нет вообще дилитов,
да, тогда мы замечаем следующее, что изначально у нас все блоки размера бубен, в смысле W, да,
и до следующего сплита, чтобы с отрезком произошел сплит, нам нужно в него, конкретно в него сделать
хотя бы W инсертов. То есть, поэтому, если мы просто каждый инсерт в блок, там, дает нам, скажем,
там, монетку или, там, при желании две, если хотите, вот, то тогда у вас накапливается два W,
там, монет, чтобы выполнить вот этот вот разбиение блоков и амортизировано это будет даже
за OAW от единицы работать. Нет, это от LOGW у нас это не убьет, потому что рядовые операции работают
за LOGW. Ну вот, но, по крайней мере, сами вот эти вот распилы, да, но распилы у нас амортизацию дают.
Ну, значит, мы копим монетки. Значит, каждый раз, когда мы, да, на каждом блоке лежат монетки.
Каждый раз, когда в блоке появляется новый элемент, мы кладем в него, мы кладем на него монетку.
После, ну вот, и когда, ну вот, и утверждение, что так как у нас, что к тому моменту, когда блок
придется пилить, на этом блоке скопится, там, от, от, от, там, тета от W монеток. Ну, тогда, вот,
но, нет, в лучшем случае, нет, в лучшем случае ровно W, потому что у нас-то сейчас будет два,
сплит нужен, когда у нас их станет два бубен плюс один, а пока у нас при инсерте их изначально,
да, так что, так что, да, так что, да, тут в этом смысле круто, да, вот, а получилось, да, вот.
Ну, вот, так что, соответственно, если бы у нас не было инсерта, если бы не было дилита, то мы бы
действительно все победили, да, пожалуй, да, тот вопросик мы стираем, а вот с дилитом, конечно,
еще, еще что-то остается, но с другой стороны, ставка как вектор, видите, то есть, не случайно мы
себе снизу тоже ограничили, то есть, нам надо, чтобы и до, так сказать, мелко, до того, когда
отрезок станет слишком маленьким, нам пришлось поработать, и когда он станет слишком большим,
придется поработать, ну да, так что делать, но давайте поймем, а что делать, если наш отрезок
слишком маленький, вот, ну, дальше, но тут вот, вот сейчас нужно, конечно, проявить определенную
аккуратность, да, давайте, давайте, давайте, давайте, смотрите, чего забить, куда забить,
если забить, дилита не будет, значит, смотрите, так вот у нас был маленький отрезок, вот он стал,
допустим, вот пришло время, и он стал, одна-вторая бубна, я даже, даже для красоты, пожалуй, знаете,
я тут еще вот так напишу, вот, что, типа, одна-вторая бубен, все, мы его зупили, надо что-то делать, но что
предлагается делать, ну да, давайте, возьмем какой-нибудь соседний блок, совершенно верно, да,
совершенно верно, совершенно верно, вот, но если соседний блок есть, то тогда, значит, если их за
о от бубен опять же объединить, да, соответственно, да, залог w, соответственно, выпилив, соответственно,
вот эту вот эрку, да, нет, даже неправильно, лучше правильно его так написать, да, за о от w, да,
выпилив эту штуку из х-фаста, она с устраивает, что вот за от w, вот, и дальше в результате у нас
появится блок, в котором количество элементов, соответственно, равно от бубен до двух с половиной бубнов,
вот так, да, на самом деле, вот так, да, ну вот, вот, ну и что нам тогда предлагается, ну понятно, да,
что, ну вот, понятно, что если получилось слишком много, то надо распиливать, причем, как бы,
нас не устраивает сказать, что если у вас там получилось два бубна, значит, оставим как есть,
почему нас это не устраивает, потому что тогда амортизация при инсерте перестанет работать,
то есть, если мы сейчас создадим большой блок, возможно, на следующем шаге придется его пилить
обратно, это нам не нужно, вот, поэтому мы сделаем по, чуть-чуть поаккуратнее, значит, мы скажем,
что дальше мы это будем распиливать, если у нас будет, ну, например,
я не знаю, мне что-то хочется 1.75, я не знаю, почему. Понял, сказал Барман и написал вот это,
вот, вот, ну давайте, хорошо, пожалуйста, давайте ровно так ровно, значит, тогда, если у нас больше
чем 5 третих бубнов, то тогда мы этот блок мы снова делим пополам, но на этот раз пора, вот,
и тогда получается, что либо у нас, значит, получился блок размера от бубна до 5 третих бубна,
ой, оптимально, что такое оптимально, ой, боже мой, ну тогда, то есть, тогда уже можно подкручивать,
тогда же, если что-то пошло, то тоже можно вместо одной, второй и двух другие константы подгонять,
если 5 третих бубнов, то, значит, либо, значит, у нас тут это было по 5 третих бубен, и тогда,
значит, при, так сказать, объединении, а потом распили пополам, у вас тут будет от, значит,
где-то 5 шестых бубен, значит, 5 шестых бубен, ну да, ну, точнее, так, круто, ну, это 5 третих,
ну да, но там, точнее, так, от 5 шестых бубен до, ну, до, вот, если это пополам поделить,
то до 5 четвертых бубен, короче, вот так, да, это если распил произошел, если распила не произошло,
то там все просто, 5 третих, вот, там просто будет большой блок размера 5 третих, то есть,
таким образом, при такой штуке мы себе гарантируем следующее, что если произошло, там,
инцет или дилит, инцет или дилит, согласен, да, согласен, безусловно, да, то есть, в переводе,
но тогда, в переводе говоря, теперь можно сформулировать такое просто глобальное утверждение,
что если с отрезом, с каким-то блоком произошел инцет или дилит, то мы гарантируем, что в результате
этого инцета и дилита появились блоки 1 или 2, размеры которых лежат на отрезке от 5 шестых до 5
третих бубна, вот, то есть, заметим, что этот отрезок строго вложен вот в этот отрезок и его не касается,
то есть, это означает следующее, что глобально говоря, что до того как, ну понятно, что с каждым
отрезком, конечно, то есть, конечно, неверно, что, то есть, хочется, конечно, сказать, что с отрезком теперь
произойдет какое-нибудь безобразие, там, слияние или распил, теперь получается только через тета от
бубен операции, да, вот, да, но важно это, что сам инициирует, потому что любой отрезок может,
там, любой красивый вообще гармоничный отрезок может быть в любой момент объединен со своим
обнищающим соседом, вот, но ничего страшного в этом нет, на самом деле он не такой уж и обнищавший,
да, деньги у него есть, да, нам придется, конечно, пенсию проиндексировать немножко,
потому что, обратите внимание, раньше мы тут шли от бубна до двух бубнов, то есть, можно по одной
монетке класть, да, а теперь у нас задача, что теперь вот у нас тут за треть бубна надо,
чтобы все накопилось, поэтому там пенсию, как минимум, придется тут поднять в три раза,
так, пять шестых, а, и тут одна треть, кстати, вот, да, да, да, кайфец, да, все. А это мы гарантируем,
что после всех сплитов и мержей все получившиеся в результате блоки будут по размеру вот где-то
в этом отрезке, но тогда нет, вы сказали так, если размер до пяти третих бубна, он остается на
месте, нет, не бубн, а блок, если блок был в результате вот этот мерженный блок оказался размера
меньше чем 5 третьих, меньше либо равно, то нас-то устраивает, да, тогда размер будет от одного до
пяти третьих, а если он больше чем 5 третьих, да, бубна, то мы распиливаем на два и получается два
блока размера от пяти шестых до пяти четвертых бубна, в общем, в совокупности получается глобальное
утверждение, что, в общем, в результате этого объединения у нас оба блока, там, блок, или
два блока и размера они будут от пяти шестых до пяти третьих, вот, поэтому да, тут вот расстояние
теперь, то есть получается теперь, что, то есть идея такая, что каждый раз, когда вы в блок
добавляете или удаляете элемент, в чем, заметьте, когда им и когда добавляете, и когда удавляете,
обратите внимание на это, да, но вот и когда добавляете, когда удаляете, то выкладете монетку,
поэтому мы гарантируем, что когда блок, так сказать, сам инициирует у себя либо объединение
с соседом, либо самосплит, то тогда в нем будет лежать уже theta w монетка, вот, это нот, поэтому
вот, поэтому получается, что и вот, и инстакт, и дилит у нас получился, да, амортизировано, да,
да, амортизировано, да, с хэшпапом внутри х фаста, да, нет, ну, на практике-то да, ну,
ну, на практике у нас и w64, да, но это, конечно, уже не та константа, которую можно уже захотеть
сооптимизировать, потому что мы там хэшмапе хранили, какие вершины в боре вообще есть,
то есть мы в явном виде бор не хранили, а хранили там все, да, только храним не деревца, а храним
то-то те вершины, которые там реально есть и в хэшмапе, да, и это позволяло нам там, да,
поэтому это хэшмапа не хэшсет, да, вот, правильно, и дальше там начинался бинпоиск, да, бинпоиск
по хэшмапу, да, красота, вот, так что вот, так что вот такое вот, так что такая вот красота,
то есть в принципе это уже, то есть y-фаст уже как-то стал, да, чуть поприличнее, чем x-фаст,
вот, но, соответственно, да, ну, вот, ну, собственно, да, видимо, несложная структура
оказалась, но, как говорится, сейчас будет чуть-чуть сложнее, вот, хорошо, значит, мы поверили в y-фаст,
мы много чего, да, но раз ли в этом, нет, ну, как сказать, я не могу сказать, что мы вот это
сейчас улучшим, потому что, значит, теперь следующая ставка, значит, так, ну, значит, теперь я могу это
все стирать, потому что далее y-фаст мы продолжим использовать как черный ящик, не знаю, видимо,
видимо, видимо, он красивший. Вот, а еще разные подходы, а еще разные подходы изучать,
ну, вот, то есть как бы, да, мы ее уже проходили частично, но я не знаю, мне вот это с блоками
нравится конструкция, я не знаю, нет, я понимаю, да, что мы не проходили там какой-нибудь условный,
там это называется 5Demo, там вот это все, да, ну, вот, да, да, да, безусловно, безусловно, вот, так что думаю,
вот, но теперь, соответственно, значит, следующий номер нашей программы, значит, ну, вот, значит,
значит, будет у нас вот такая красота, значит, Fusion 3, но мы с вами все-таки не по Википедии учимся,
да, нет, ну, мало ли, может, конечно, полегко окажется, что все это из Википедии, но, по-моему, вот этого всего Википедии,
ну, в Викиконспектах, да, нет, что-то, нет, вот, да, значит, ну, вот, значит, ставочка теперь такая,
значит, Successor, Predecessor, но, правда, тут, конечно, оговорочка придется, что нам придут, что мы,
возможно, ограничимся немножко статической версией, вот, ну, вот, в статической версии, значит,
если вот брать статик, вообще есть, вот, ну, нет, хотелось бы, но я пока не должен, ну, вот, ну, вот,
но здесь, в общем, оставляя мечта, нет, смотрите, теперь оставляя мечта, чтобы тут был log n,
только log по основанию w, ну, как бы, да, то есть, если w растет, то, как бы, этот log прификсирован
mn уменьшается, поэтому, то есть, как я уже говорил, то есть, это, в принципе, комбинация игр к фасто,
ну, или там, дерево для босса, вот, и Fusion 3 позволяет вам вообще там делать какие-нибудь
successor и predecessor за время корень из log n, помните, да, вот, то есть, поэтому, поэтому такая приятная
штука, то есть, как бы вы, то есть, казалось бы, у вас есть какое-то w, но оказалось,
грамотно им воспользовавшись, вы ухитряете придумать себе симпатику, которая от w не зависит,
вот, то есть, уже так неплохо, но, соответственно, да, с памятью, конечно, у нас будет больно,
да, а, ну, инсертов, дилитов у нас нет вообще, так, ну, вот, ну, по памяти, ой, ну, даже, вот даже интрига,
сколько у нас там, уложимся в УАТ, или не уложимся, статическая структура,
пока до successor, predecessor не подойдет, так-то, да, у нас есть фешмапа, да, вот, то есть, как бы,
к сожалению, не по, то есть, successor, predecessor, да, к сожалению, successor, predecessor это не возьми
элементы, не просто возьми элементы из сета, просто возьми там, lower bound, upper bound, то есть,
как бы, да, то есть, когда-то они, то есть, я не знаю, когда-то давно наука его называла successor,
predecessor, хотя он сейчас актуальней, конечно, lower bound, upper bound его называть, наверное, вот,
но давайте смотреть, вот, давайте делаем вставочки, сколько нам вообще тут памяти потребуется,
ну, пока, ну, я не знаю, просто я боюсь, что УАТ может не уложиться, впрочем, давайте
смотреть, давайте смотрите, за счет чего, сейчас будет такой, еще один достаточно традиционный
метод, да, то есть, в принципе, у нас уже данный, как этот метод, вида, что давайте возьмем какие-нибудь
блоки размера log w и там будем с ними что-то делать, да, и там что-то делать как-то адекватно и за счет
этого у нас все сократится в log w раз, ну, напоминаю, да, помните, log n по основанию w это log n
поделить на log w, да, помните, вот, так вот, значит, наша ставочка, что такое fusion tree, это b дерево,
это, значит, у нас ставка, значит, вот, я прям так и напишу, fusion tree is b tree,
правда, есть одна проблема, ну, правда, да, что-то, правда, что нужно, чтобы задать b дерево,
да, параметр t бы не помешал, то есть, смотрите, сколько у нас веток будет, так вот, ну, вот, с,
вот этим вот, так вот, параметр t будет w в степени 1 на 5, точно 1, да, а, ну, да, там,
из вариантов, да, 1 на 5, там, как говорится, увидим почему, в общем, такое шоу. Нет, все очень просто,
все 4 это 2 в 6, так что 2 в степени 6 в пятых, ну, что-то там между 2 и 4, да, так что конкретно тут, да,
конкретно в нашем случае 2-3 дерева вполне подойдет, да, ну, а что, может, он писал кто-нибудь в сервисе,
это 2-3 дерева, ну, знаете, как это, да, да, да, я был, кошмар, да, я был, да, я был в
кроватке, да, и у меня была каруселька с хипами, да, да, да, да, да, нет, нет, на самом деле я боюсь,
что не совсем, потому что то, b дерево, это было бы 2-3-4 дерева, а 2-3 дерево, это, по-моему, там,
потому что это что-то допиленное, я не готов, в общем, да, там уминали обеими ногами. Так,
ребят, так, ребят, все, так, ребят, все, мы уже это переросли в сервис, вот, какая разница,
ну, там, в конце концов, все равно ее там никто на 100 баллов и не решил, там, у Гайнулина было время,
он набрал 91, как раз 91, это то, что можно было набрать без 2-3 дерева, ну, вот там выжил,
вот, не важно, в общем, так вот, а у нас будет вот b дерево с вот таким вот крутым, значит, фактором
t, но давайте ставить, какова тогда высота дерева будет? Да, мы помним, что высота у нас дерева,
это log tn, вот, но в нашем случае это, там, если уж проделать эти мистические операции log,
там, double, поставить double 5n, это равно log n поделить на log w, там, 1 пятое, да, это тоже самое,
что 5 logarithm of n поделить на log w, в общем, короче, ну, короче, t от log wn, вот, вот, все, да,
вы, да, вот, ну, мало ли, вот, нет, я понимаю, что вы там все писали егэ, но вдруг кто-то там,
да, вдруг там это кто-то через это, через все распроходил, да, вот, вот, так вот, так вот,
все было бы ничего, то есть, можно, конечно, казалось бы, да, вот, обсуждение на этом,
можно, казалось бы, закончить, все, высота log wn, у нас все операции, там, делаются,
там, от высоты, ура, до свидания, ну, вот, но только вот, все, да, но есть одна, да,
есть одна маленькая проблема, да, да, к сожалению, операция делается за t log tn, там, эти всякие,
вот, ну, вот, а так w, да, то есть, к сожалению, то же самое, только на w умножить, а это нас
не устраивает, даже если это w в степени 1 на 5, это все равно больше, чем 1, вот, вот, что делать,
значит, смотрите, значит, какая идея, ну, идея в языке это очень простая, просто, значит,
нам с вами нужно научиться, значит, нужно с вами научиться искать, соответственно,
upper bound, lower bound, тоже в какой-то вот статической версии, то есть, у нас будут эти все, то есть,
у нас в вершине стоят вот эти разделители, да, и нам нужно в них тоже искать lower bound и upper bound, да,
в вершине, ну, хорошо, хорошо, ну, смотрите, то есть, откуда у нас берется вот это вот t восьмом
точке на log tw, да, потому что мы помним, что если мы делаем какой-нибудь successor, predecessor или
просто элементарный search, то что мы делаем, то мы говорим, что мы говорим, вот у нас есть вершина,
да, log tn, да, согласен, то, значит, у нас есть вот эти вот товарищи r1, r2, r3 и так далее, да,
и, ну ладно, не r, там, допустим, плюс-минус t, вот, ну, помните, оно же там не фиксировано, да, вот,
вот, так вот такая, помните, да, борода такая, вот, мы, значит, среди этих r-ок найти, должны
найти вот по нашему x между какими r-ками он находится и, собственно, отправится в соответствующие
дерева, кодовое слово, найти, между какими r-ками он находится, нет, то дерево, нет, ну, допустим,
нет, ну, не важно, нет, знаете, время построения дерева нас сейчас не особо волнует, потому что,
ну, в конце концов, мы можем эти все, все ключи, нам же, раз дерево статическое, то есть, все ключи
нам даны заранее, поэтому, что мы в таком случае делаем, ну, давайте отсортируем эти числа, за какую
точку мы умеем сортировать? Да. Нет, нет, радикс, сам себе радикс это nw, nlog w это кирпатик sort, вот, а лучше,
ну, а лучше мы, как флаз, да, да, да, да, да, да, да, да, да, да, да, да, да, да, да, да, да, да, да, да, да, да, да, да, да, да, да, да, а лучше вы как флаз, да, да, да, да, да, да, да, да, да, да, да, да, да, да, да, да да, да, да, да, да, да, да, да, да, да, да, да, да, да, да, да, да, да да, да, да, да да, да, да, да, да, да, да, да да, да, да, да, да, да да, да, да, да, да да, да да, да, да, да, да да да, да, да, да да, да, да да, да да да, да, да да да, да
Не, ну что, N? Не, ну 8. может это не очень, но тем не менее.
Н log N поделить на log W.
Ну да, N log N поделить на log W.
Ну ладно, пусть даны пока вот это все равно.
Нет, ну тут дальше можно задуматься, а можем ли мы отсортировать log W чисел.
Вот это W биток за от их количества.
Но я подозреваю, конечно, что...
Нет, наоборот.
Ну что-нибудь подобное видеть, потому что тут вся наука на самом деле сейчас будет об этом.
То есть если у нас элементов не слишком много, то есть там логарифом в какой-нибудь степени, то мы все можем сделать за 1.
То есть у нас...
А вот ситуация, потому что у вас будет какая-нибудь ситуация в духе, что у вас есть структура данных,
которая хочет вставлять, удалять, искать саксессор-предсессор или искать минимум еще в Atomic Hippie будет.
И ставка у нас будет такая, мы очень хотим, и предположим нам фантастически повезло,
что элементов не более чем log N в какой-нибудь степени.
Тоже вот 1.5 или 1.4.
Это имеет отношение к W, потому что, помните, у нас же вообще предположение...
То есть у нас же N и W не совсем независимы друг от друга.
То есть мы помним, что N на самом деле должно быть меньше, чем 2 в степени W, например.
Или то же самое, что log N меньше, чем W.
Поэтому мы понимаем, что log N может быть достаточно серьезным.
Если у нас элементов мало, то хочется, чтобы это было за O от единицы.
Не за O от мало, а за O от единицы.
И потом на этот логарифм мы будем везде делить.
Основная идея Atomic Hippie именно такая, а сегодня мы явно до этого доживем.
Не полностью, полностью не обещаю.
Идея такая, но если мы в тупую эти эрки храним...
Построение там, это уже вопрос второй, и я автора в статьи тоже не сильно волновал.
Может я не прав, могу прислать статью.
Хотя вроде это не статья, это конспект.
Ну, конспект. Ну, не важно.
Ну, кстати, это есть, более-то там есть ссылка на эту статью.
И там даже есть еще, вот, кстати, есть уж отличие, что да, есть динамическая версия,
в которой ко всем этим осим-точкам придется добавить log log N.
Вот, красота.
Log N, не log W.
Именно log log N.
А вот, по ходу, за столько же.
Что?
Нет, log log N, заведомо, лучше, чем log log N.
Вот.
Вот.
Это другой пример.
Так, значит, смотрите, эрка миша.
Ну, теперь вот, единственная наша мечта, теперь, что
Соксессор-предесессор, конечно, для этих эрок, хочется считать за O от единицы.
То есть, если мы научимся его считать за O от единицы,
то тогда что у нас произойдет?
Тогда мы, соответственно, действительно будем в каждой вершине работать за O от единицы.
И таким образом, этот log N действительно поделится на log W.
И никакие вот дополнительные вещи домножаться не будет.
Вот, понятная идея.
То есть, таким образом, по большому счету,
нам требуется с вами сделать следующее.
Нам с вами потребуется сделать,
то есть, нам с вами потребуется сделать вот тот же самый черный ящик.
То есть, такое вот, ми, так сказать, мини-фьюжн-три такое, да?
Чтобы никаких инсортов и дилитов не было.
Но при этом, что все работает за O от единицы,
но в предположении, что N, значит, там меньше либо больше,
значит, там меньше либо равно, чем W в степени 1 на 5.
Секунду.
Да.
У нас, мы решаем тренируемую версию,
потому что у нас бы дерево полностью заблокировано,
и в каждой вершине не более, чем t элемент.
Ну, почему-то.
Потому что надо было доходить до 2-й, 3-й подержки.
Именно это и спаси.
Ну да.
Нет, ну по большому счету, да.
Ну, на самом деле, да.
Ну, там оно будет не происходить W,
потому что, понятно, брейчен фактор может быть, на самом деле,
одна вторая там на W и так далее.
Вот.
Ну, как всегда, мы, как говорится, мы это,
верные рыцари асимптотики, собственно, не заморачивайте.
Да, да, да, да, да, да, да.
Мы не только рыцари, но еще и зануды.
Да, да, да, мы помним об этом.
Обязательно, обязательно.
Без этого никуда.
Но в данном случае, но это не к этому случаю.
Вот.
Так что вот.
Хорошо.
Значит, далее.
Вот.
Значит, итак.
Значит, за счет чего мы попытаемся себе облегчить жизнь?
Именно.
То есть, вот такая.
То есть, у нас, в принципе, вот такая ставка.
То есть, мы говорим, что если мы умеем решать
завод единицы до вот какого-то n,
то вот до какого-то момента,
то тогда мы можем, как бы,
тогда вот высоту дерева мы можем брать не log n,
а log n поделить на, собственно,
log того, что у вас тут реально будет.
То есть, вот такая оптимизация.
Можно один вопрос?
Э.
Э.
Мы считаем память, мы считаем количество w видных ячеек.
Да.
Но w не константа.
Какого константа?
Ну, потому что ты можешь менять систему.
Почему мы не считаем количество zbit?
Ну, вот.
Потому что zbit ему надо будет быть.
Подожди.
Ты вообще понял, что ты ответил?
Сейчас.
Да, мы работаем быстро с w-видных ячеек.
Правильно.
Это хорошо.
Но если у нас система, для которой w...
Сейчас.
Если мы считаем w не константой,
то n bit-ов и n w bit-ных чисел
это разные ассинтотики по памяти.
Ну, хороший вопрос, конечно, действительно.
На самом деле, хороший вопрос.
Называется так.
Ну, к сожалению, более продвинутого ответа,
чем так жизнь сложилась.
К сожалению, я ответить не могу.
У нас здесь какая-то наука.
Я так понимаю.
Есть.
Считаем.
И оптимизируем.
Пытаемся оптимизировать w раз.
Считаем, что w это охренеть как много.
Забиваем на него память.
Ну, потому что это будет единица памяти.
Такая.
Это же не константа.
Они ее, точнее, мистически делают не константой.
Нет, она же константа.
Она константа как минимум в том плане,
что с точки зрения времени
мы с ними работаем за 1.
Вот.
То есть, тут такое.
Нет, я понимаю, что по времени,
если мерить память в байтах,
то от того, что мы увеличили w,
количество байт от этого меньше не стало.
Да.
Но тем не менее.
Так вот.
Значит, смотрите.
Значит, что у нас в этой науке?
Значит, дальше идет.
Итак, значит, n меньше либо меньше w в степени 1 на 5.
Итак, значит, смотрите.
Ну вот.
Но теперь придется копнуть уже в самете.
То есть, сейчас мы будем очень жестко
пользоваться тем, что это целые числа.
Даже не просто целые числа, а битые числа.
Причем, смотрите, как интересно.
Сами в чисел у нас
очень-очень-очень сильно меньше,
чем количество бит в этих числах.
Что это значит?
А значит, это маленькую приятную вещь.
Что на самом деле, если мы хотим
там, допустим, сравнивать как-то
между собой эти числа, хотя бы между собой,
то на самом деле нам для них
не надо хранить все биты.
Ну потому что, помните, вообще два числа,
если прям в тупую сравнивать,
то мы это делаем как бы типа
за от единицы, то есть за от w.
Идем первые биты сравниваем,
то второй, третий и так далее.
Нет, понятно, что в реальном компьютере
это будет за от единицы делать.
Но теперь мы попробуем
воспользоваться тем,
что у нас, что на самом деле,
если у нас чисел w
в степени 1 на 5,
то на самом деле,
чтобы сравнивать числа,
по крайней мере, между собой,
нужно от них знать только порядка w
в степени 1 на 5.
Да нет, 1 на 5.
А вот почему.
Потому что, смотрите, вот жили были
наши длинные относительно числа.
Нет, мы алгоритм себе вообразили.
Сейчас вы увидите, что я имею в виду.
Просто размышляем.
То есть мы замечаем следующее.
Если мы рассматриваем, то мы замечаем,
что некоторое время все эти числа,
у них первый бит одинаковый,
второй бит одинаковый,
и в какой-то момент
произошло чудо.
Какие-то биты тут
неожиданно стали
нулем, а какие-то единицы.
Значит, мы говорим, что
этот бит
интересный для нас.
Дальше, действительно,
если мы вот так рекурсивно идем,
то дальше тоже мы замечаем,
что, допустим, некоторое время 0, 0, 0,
1, 1, 1.
Ну, типа того.
И теперь тогда мы вот утверждаем,
что вот этот бит будет интересным.
Да, он по-любому будет интересным.
У нас не будет понятия
интересный бит для конкретных каких-то там чисел.
У нас просто есть понятие интересное.
Да, заметим, что
этот бит от этого
интересным не становится.
Спасибо за замечание, это очень важно.
Ну, смотрите, дело в том, что
вообразить себе
это нужно примерно следующим образом.
В общем, короче,
бит является интересным,
если на соответствующей высоте,
если бы строили битовый борт,
то на этой высоте происходила бы развилка.
Тут вот как интересно будет.
Тут будет 0, 0, 0, 1, 1, 1,
0, 1, 11 .
Тогда я объявляю, что этот бит
тоже будет интересным.
Потому что вот тут теперь раздел пошел.
Тут пошел раздел и вот тут раздел пошел.
Тут нам сейчас придется
страдать и чуть-чуть вот так сколько у нас там времени то нормально у нас по
времени да вот ну вообще 5 но не ваш хотя хотя да нету значит смотреть ну
тут нет ну я даже так закончу праймере то лекция на том что я просто скажу
программу действия потом мы ее будем успешно реализовывать следующие две пары
нет но может и меньше я не знаю значит значится поехали значит ну вот то есть
вот такие вот у нас биты вот мы их даже там как-нибудь назовем кстати так
сейчас уточню даже в каком порядке в каком порядке мы их назовем на всякий
случай ну вот хотя нет нормально нет но это нет пока это важное определение то
есть это вот будут у нас такие интересные биты то есть ну там где-то у
нас еще явно будет там какие-то пары интересных бит то есть у нас будут вот
эти вот интересные биты очень вот интересные биты они для но вот то есть
они будут соответственно так и назовем b 0 b 1 b 2 и так далее и количество этих
бит у нас будет там r это будет последний бр минус 1 r там соответственно можно
сказать строка меньше чем соответственно строка меньше чем дабл и
в степени 1 5 логично да то есть даже не от а вот прям строк ну давайте вот пусть
они вот так да в степени 1 5 в случае чем подгоним константу всегда а потому что
скажем ну потому что смотрите потому что каждому интересному биту вот в вот
этом вот дереве на котором висят м-листов да нет а в степени 1 5 ну потому что мы
тут сказали что я то есть на самом деле да правильно там было на письмо нет нет
там скажет так сейчас увидите там будет причина почему это именно 1 5 но вот не
так смотреть самое интересное значит смотрите то есть нам понадобится не столько
интересные биты нам понадобится из каждого из этих чисел делать вот так сказать скетч ну потому
что заметим следующее что есть у нас вот эти числа там допустим там какой-нибудь x это будет
x нулевое это x первая это индекс если что да ну потому что в дереве с n листами внутренних
мало кто знает но ну если не знаю какая дискетка у вас была наверное где я тут dfs
пользуюсь я помню что мы не знаем dfs мы там ничего не знаем вот минус новым узнаем явно
скоро вот да как говорится идея заключается в том что как говорится я прогрю меня проглючила
вот только вот так вот так вот дело в том что значит почему я сейчас пишу сверху потому что
снизу я хочу индексировать биты соответствующего числа логично так так так так так так давайте все
это уберу мы все равно отсюда уйдем так смотрите сейчас красота будет значит будет у нас такая
маленькая приятность приятность будет заключаться в том что то есть действительно заметим что каждому
x то есть если у нас есть вот число x которая состоит из там соответственно w битов то мы ему
можем поставить то что будем называть sketch sketch от x а видите почему я там индексы сверху
поставил так вот значит теперь у каждого и по каждому x я поставлю следующие значит
меня на самом деле будут интересовать только x значит x вот и один очень короче говоря интересные
вот ну ой как сказать как сказал штирлиц как-то трудно ответить на ваш вопрос до конца честно
пас так и тем честнее я вам отвечу тем больше мужицом могу вам показаться
x число бит w битовое число это его бит
так вот значит смотрите значит давайте теперь значит на значит на уровне идеи значит просто
интерес будет такой нам очень захочется ну просто в идеале было бы неплохо так хочется научиться
то есть но опять заметил что пока имели сами вот эти вот иксы да можно сравнивать по скетч вот
вытекает такое мистическое утверждение то есть если я вот беру именно числа вот оттуда да то
тогда x это меньше чем x житое тогда и только тогда когда скетч от x этого меньше чем скетч
от x жито вот такая красота
вот так вот
ну хорошо хорошо если так ну да ну да так в данном случае да и это хорошо меньше n
которая меньше хорошо пожалуйста вот то перс заметим но здесь вот есть очень тонкий момент то есть
это верно только для конкретных иксов да то есть помните да что интересные биты они брались из
того что у нас есть конкретное n минус один число правда да даже не минус один даже вот вот поэтому
тут начали но но тем не менее значит у нас будет мечта у нас будет мечта хранить эти скетчи в этом
что ноты то есть каким-то образом действительно эти скетчи хранить и попробовать за отъедение
и пробовать за там как-то от единицы но даже там в игре фасте хранить их конечно не получится
потому что игре фаст это прощаю от единицы сразу там будет логарифом там видимо логарифом всего
чего угодно но не единиц вот но тем не менее очень хочется создать действительно такие вот маленькие
числа и в них вот ближайший x искать то есть просто к сожалению неверно что да вот то есть но нам
бы конечно очень хотелось бы действительно найти то есть помните да вот по заданному какой-нибудь
произвольному но от балды там я не знаю игроку то есть мы хотим найти там допустим такое к что
x катая меньше либо там допустим меньше игрока меньше чем x в степени там там меньше либо
ну хотелось бы что-то такое правда да это верхний индекс это это наша мечта да ну зачем мы все это
вообще забабахиваем да то есть напоминает что мы вообще хотим по игроку за от единицы находить
между какими и сами он лежит помните да это наша мечта вот вот ну и соответственно действительно
мы действительно хочется применить такую красивую идею что соответственно это просто надо просто
сравнивать по скетчам yeah that's the problem yeah yeah unfortunate да да да а еще надо это
говорить более однотонным голосом и тогда по нот и тогда это будет пучить как максимально
пафос надо вот но вот но вот то есть да к сожалению у нас да вот такая проблема
но тем не менее то есть очень ну просто если-то идея в том что очень хотелось бы сводить задачу
к поиска лавербаунда но там в нашем случае а пербаунда к задачу а пербаунда к а пербаунду
на скетчах чего но это пока но вот но тут но тут проблем но тут как всегда две проблемы во
первых как это делать на скетчах то есть как бы на скетчах почему идея ну потому что идея в том
что да у нас совсем что скетчи у них теперь еще и бит дабл и в степени 1 5 поэтому есть надежда
что мы что мы умеем это делать круто но вот но тут я вам даже ладно давайте так для интереса я
вам даже эту интригу спалю как мы это будем делать и так представьте себе что у нас все
иксы мелкие у нас все иксы то есть у нас все иксы имеют размер там не более чем дабл и в степени
1 5 мелкие да именно иксы именно иксы то есть и так вот давайте все отчеркнем это все то есть
это как бы да просто то есть это так для затравочки да чтобы просто понять не волнуйтесь там все все
в итоге сойдется давайте все представим что эти все там 0 меньше либо равно x 0 меньше x 1 меньше
и так далее меньше x n минус 1 и все они тоже меньше чем дабл и в степени 1 5 и нам очень и нам
вот задан вот какой-нибудь игрок и мы очень хотим найти действительно такое ка вот перепишу так и быть
так вот если прям чист то есть что значит что они очень мелкие это означает маленькую про эту
вещь что я их в принципе могу хранить в одном дабл юбитом числе прям все но я с конкретинировать
например даже так да но на самом деле я вам так забирать вперед скажу к сожалению да да да нет
но там в 2 5 но там вот вы увидите почему там 1 5 то есть для того что я сейчас говорю в принципе
могло одной второй хватить но как бы просто там много еще проблем будет поэтому там придет то
есть конкретно вот этот скетч нам еще и там не там хранить на науке не уверена что это возможно
в принципе но вот да вот реально да прямо до такой степени да наука реально реально подозревает что
это может быть невозможно в принципе искать там искать скетч как-то адекватно видимо по там
Ну, видимо, там имеется в виду, что предположим, что вы хотите искать скетч, и вам там заданы какие-то произвольные к бит.
Да, но мы-то не будем.
Но, как бы, поэтому мы себе, если мы скетч добавим там несколько более удобных для нас бит, то нас это устроит.
Вот, и мы их и добавим.
И будет у нас теперь не w в степени 1-5, а w в степени 4-5, но это вот уже...
Значит, смотрите, смотрите, сейчас все будет.
Так вот. Не, не паникуйте.
Так вот, смотрите.
Значит, как тогда их искать?
У нас это есть. Давайте представим себе, что все они имеют фиксированную длину.
А, да, я неправильно написал.
Правильно написать 2 в степени w в степени.
Вот, да. Во-первых, да, мы это имеем в виду.
То есть давайте я представим, так вот, идея будет такая.
Мы запишем, так вот, мы запишем великую маску.
Теремия фирма.
Теремия фирма. Маска.
Теремия фирма. Маска. Великая. Теремия фирма. Маска.
Так вот, значит, идея такая.
Вот.
Значит, смотрите, значит, идея такая.
Я создам великую маску, где запишу вот такое число.
Вот.
Даже мало как-то.
Ну, я говорю, в будущем их будет w в степени 4,5.
Поэтому там придется...
Кого-то.
Ну, число. Вот.
Это для нас просто очень важно.
Так, ну вот и так далее.
Вот.
То есть вот такая вот у меня масочка.
А.
Да.
Но в данном случае их n, которые не превосходят.
Совпадение пока случайное.
Вот. Так вот.
Значит, как мы теперь будем искать апербаут?
Значит, смотрите.
Значит, ну еще, значит, смотрите.
Нет, смотрите, тут сейчас фишка будет такая.
Ну, во-первых, так.
Я еще введу такой.
Маск 1 равно 1,0,0.
Тоже вот их будет w.
Вот.
Одна пятая бит.
То есть 1,0,0,1,0,1,1,0.
Вот.
Но это уж совсем уж полностью.
Так вот.
Теперь. По каждому игроку.
Теперь, если мне приходит запрос игрок.
Тоже мелкое число.
В противном случае у него за 1 апербаунт ищется.
Теперь я делаю так.
Смотрите, какую магию я делаю.
Значит, я по игроку.
Создаю великий маск игр.
Да.
Там запрет подсчет.
Так.
Ладно, давай я сначала скажу чуть ряд.
Потом будем думать, как это.
Идея такая.
Ноль игрок.
Ноль игрок.
Да. Каждый игрок мы записываем как w.
Соответственно, бит.
Подзадача.
Очень слабенькая.
Никак не относящийся.
Где фонарик?
Сами чипы маленькие.
Пока что у нас там мало интересных бит.
Что-то такое.
Здесь у нас задача простая.
Да.
Вот. То есть по каждому игроку я могу создать вот такую штуку.
Но на самом деле я могу создать ее за o от единицы.
Нет, я это могу создать за o от единицы, потому что легко видеть, что я на самом деле y тут просто на что-то домножил.
О, точно.
Там.
Да, на что-то раз оно всегда фиксировано, что приятно.
Да.
Ну, я бы сказал так.
Примерно маска 1, только без, по-моему, последнего блока 0.
Я бы сказал.
Ну, что-то в этом роде.
Так вот.
В чем приятность?
Идея теперь такая.
Что будет,
если я из
маска
вычту
Старыми анекдотами разговариваешь.
Вот.
Вот.
Значит, из этой маски,
глобальной маски,
я вычту маски.
Да, ну вот.
Но, во-первых, давайте внимательно посмотрим,
что произойдет.
Уже кто-то догадывается.
Ну, давайте его снимать.
Не очень.
Вот так.
Значит, смотрите,
что у нас дальше произойдет.
Нет, смотрите.
Не, ребят, не волнуйтесь.
У нас с вами, так как у нас
после перерыва тоже наши пары,
задержали сейчас, можем потом пару
чуть позже начать. Это не проблема.
Нет, зачем?
Вот.
Значит.
Да.
Да.
Но даже если бы оно было больше,
то тогда лавербаунт и пербаунт вы с полпинка нашли.
Правда?
Так что это не идея.
Так что интересный игрок, это, конечно, игрок,
который не более, чем W.
Так вот.
Если мы это вычтем,
значит, заметим, что, вот я тут
не случайно нарисовал вот эти блоки,
то есть, заметим, что при вычитании,
то есть, в каждом блоке это вычитание будет
независимо происходить. Правда?
Ну, то есть, условно, если вы тут
будете вычитать, скажем, вот в этом блоке
побитого, то там никакие переносы
на следующий блок не повлияют. Правда?
И более того, а что интересно,
если Y,
то есть, заметим, что,
если Y, вот пока вот в некоторое
время, Y будет больше, чем вот эти
X. Да?
То есть, будет происходить тогда, в этот момент,
тогда у вас вот эта единичка при
вычитании замениться на ноль. Правда?
Но это если Y больше.
А если в какой-то момент Y стал
меньше либо равен этого X,
то тут единичка останется на месте. Правда?
Тогда,
если вы у этой штуки
возьмете AND,
собственно, маска 1,
вот, то,
то у вас, обратите внимание,
то тогда у вас останутся,
то есть, тогда все это будет там,
что тут при вычитании произошло, будет
зачищено, останутся только вот
эти единички. Причем,
обратите внимание, те
единички, которые, то есть,
единички останутся, причем там и только там,
где были
иксы, которые больше или
равны игрокам. То есть,
да.
Но тогда идея такая. Тогда остается вам
в этом числе
найти самую первую единичку,
то есть, самую старшую единичку.
Там по-разному.
Но там по-разному.
Но на самом деле
мы уже в прошлый раз поверили в этом месте, что
нет, ребят, на самом деле операция
найти старший бит и так уже
там верится, что она умеет завод единицы?
Да. Верится, верится, верится.
Во-первых,
есть отдельная статья,
как это делать завод единицы.
Это, во-первых.
Во-вторых, есть
статья еще, в которой рассказывается, как
это делать завод единицы.
Да.
Да. Ну и в-третьих, да.
Ну и в-третьих, так как их сортированы, то
по факту у нас действительно всего
n вариантов там, ну n плюс
минус 1 вариантов того, чего у нас там реально может
оказаться.
Ну да, но правда у нас
вот как раз близкий шанс, как раз это
без нее обойтись.
Нет, вот сейчас мы им пока не пользуемся.
Обратите внимание, да?
Да.
Ну и в-третьих,
у нас есть
параллельно
параллельно
параллельно
параллельно
Обратите внимание, да?
То есть это пока так, это прикидочная технология.
Вот.
Но пока же, да, то есть обычно
верят, что это можно либо завод единицы найти,
либо просто, скорее всего, в современные компьютеры умеют
это искать завод единицы тем или иным способом.
С точки зрения
компьютеров
вообще уже не очень хорошо говорить
о единицах. В смысле,
что такое вот единиц,
когда они перестают быть наукой, начинают быть
компьютерами?
Ну нет, реально,
от единицы времени, то есть вот
единицы контактов процессора.
Ну да. Нет, вот там понимаете,
в чем проблема? Нет, там дальше
начинается, что
алгоритмы что-то такого
вида еще бывают, что на самом деле
что как бы для каждого конкретного n
вы делаете схему, да?
Ну там сталкивались с какими-то такие схемами.
В смысле,
сортировка сетьми
или что-то такое? Ну, может быть.
Но там просто нет. Суть в том, что
алгоритм устроен так,
что там, скажем, что у вас какое-то деревце,
условно.
То есть у вас там, скажем,
на вход у вас подаются какие-то нолики,
единички.
И там
в каждой вершине с ними что-то делается,
я не знаю, ссор, например,
или какой-нибудь
или там что-нибудь еще в этом роде.
И получается результат,
0 и 1. Или даже не один результат,
а несколько результатов.
Вот так вот.
Ну вот, утверждение.
Наука умеет
ну, то есть, допустим, у вас
дано, допустим, n,
и вам очень хочется там найти какой-нибудь
старший бит у него.
Так вот, утверждается, что наука умеет
построить последовательный схем,
то есть для каждого им построить схему так,
чтобы высота этих схем
была
от единицы.
В смысле, не превосходила какой-то константы.
То есть там...
То есть, наоборот, как раз аппаратная,
потому что для каждого конкретного w
по сути вы будете...
Ну, количество...
Количество вершин зависит от w,
но время работы будет зависеть
в первую очередь от глубины,
потому что на одной и той же глубине
все электричество будет одновременно работать.
Так вот, а вот тут
а вот тут став.
Прям глобально константа.
То есть существует c,
то есть для любого w.
Там вот смысл
примерно такой,
кодовая фраза, вот встретите
какую-нибудь аббревиатуру ac0,
это вот типа алгоритм там вот
лежит в ac0, там вот что-то такое.
Так что поэтому верим в этот старший бит,
но поэтому старшему биту мы здесь, соответственно,
очень легко ориентируемся,
где же у нас встретился первый х.
То есть более того, заметим
на будущее, что, в общем-то, если у вас
что на самом деле мы этот скетч
можем чуть-чуть увеличить,
ну то есть просто проблема будет в том, что
если нам просто задали вот эти вот биты,
то есть допустим мы там взяли
иксы, их там они уже посорчены как-нибудь,
и по этим иксам мы восстановили себе
интересные биты, да, нам очень хочется их хранить.
Но, к сожалению,
рандомные биты, видимо, с рандомными битами
так не получится, чтобы прям скетч
было удобно за вот единицы доставать.
Вот, поэтому
нам придется подобавлять
к этим битам еще какие-то биты,
и у нас там
получится так называемый
супер скетч.
А мы будем вычислять
эти хорошие интересные биты?
Там-то биты вычислять будем,
но нет функции,
которая число переводит
в его скетч. Да,
но будет супер скетч.
А как мы будем искать
интересные биты?
За вот количество, да,
нет, а будет, на самом деле, супер скетч,
который тут будет очень
интересно. То есть, на самом деле, он
будет хранить себе те же самые биты,
но только между ними могут там, будут
вставляться какие-то нолики.
Мы скипнули интересный вопрос.
Как мы интересные биты находим за вот количество часов?
Или за,
за что нам их можно находить?
Какая нота?
Ну, в HD.
Да, в HD.
Вообще не могу про все битам дать.
Нет, тут я отвечу просто.
Скорее всего, тут ответ простой.
Мы просто не сильно заморачиваем,
за какое время мы это будем строить.
Нет,
по большому счету, нет, на самом деле,
после сортировки, на самом деле,
интересно, там это все легко делается,
но там интересные биты, если нам плевать на порядок,
они находятся за n log w.
Ну вот,
за n log w пошли.
Не, посмотри,
у двух соседних элементов
найти интересный бит,
ну, по крайней мере, бит, который их различает,
очень просто, ты взял к сорту.
Вот, поэтому можно прям
после того, как элементы отсортированы,
просто честно их найти.
Да, некоторые биты будут лишними,
да, но ничего страшного.
Для каждых двух соседних
для каждого длечающего дни,
сказали, что он
добавим его в множество интересных.
Что этого хватит,
потому что они отсортированы.
Нет, ну они заранее не отсортированы,
но если мы уже n log w времени потратили на сортировку,
то, наверное, вот...
Они должны быть, ну, условно лишнили бы
дерева, а сортированы поэтому,
поэтому нет.
Я про сортировку не спрашиваю.
А про что ты спрашиваешь?
Просто, что если оно дано
просто ровно чисел,
как достать интересные биты?
Ты, вроде, сказал, что можно взять соседние
и взять в них отличающиеся биты.
Ну да.
Вот, да, очень удобно.
Вот.
То есть нет, поэтому я просто заранее говорю,
что как бы сразу предупреждаю, что заметим,
что вот эта технология нам дает, по идее,
некоторый запас.
То есть она нам даст запас,
потому что если мы научимся
по всяким...
То есть заметим,
что в некотором случае, в смысле,
у нас тут будет не w в степени 1,5,
а w в степени 4,5.
Ну вот.
То есть суперскетч увеличит.
Да, ну вот. Но правда, единственная
проблема, что просто,
как мы уже сказали, вот эта проблема
все равно даже суперскетчем не решится.
То есть, ну вот.
Но, как бы, поэтому да.
Для нас будет такой черный ящик.
Данные относительно мелкие.
Числа размера w в степени даже 4,5,
но их мало.
Там w в степени 1,5.
И наша задача, соответственно, их каким-то образом
собственно куда...
Наша задача в них уметь искать
лавербаунт, опербаунт.
То есть будет у нас...
Вот мы это уже научились делать,
потому что выяснилось, что это вот таким вот образом
красиво делается.
А вот как же, ну вот.
Но как же действительно с этим всем справляться?
Вот это мы, пожалуй, уже после перегрыва и поговорим.
