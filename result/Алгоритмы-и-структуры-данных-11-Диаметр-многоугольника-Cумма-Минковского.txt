что хотите максимум скалярное произведение ну давайте очень быстро давайте
представьте себе такую задачу у вас и сфиксировано но что точек
и к нему поступают такие запросы дается пара координат аб вам нужно найти максимальное
скалярное произведение векторов аб на xy по всем точкам xy из s
вот то есть множество точек фиксировано надо звать максимум скалярное произведение с фиксированным
вектором аб давайте сделаем следующее давайте во-первых заметим что в качестве точек которые
мы перебираем достаточно перебирать точки только вершины выпукло оболочки
ну потому что вот давайте нарисуем выпукло оболочку что такое скалярное произведение с
вектором аб ну давайте давайте на сомнение уровня
значит что такое при фиксированной гамме и аб множество точек таких что скалярное
произведение равно гамме но это какая-то прямая перпендикулярно вектору аб ну что-то такое вот
напрямую скалярное произведение с вектором аб константа но если аб как раз нормальный
вектор то это в точности просто уравнение прямой вот но дальше понятно что если в эту гамму будете
менять то у вас прямая будет параллельно двигаться вам надо найти в ком смысле и экстремальное
положение то есть на вот так вот всеми возможным способом параллельно сама себе двигается вам
надо найти крайний момент когда она еще пересекает с на то есть когда на этой прямой есть какая-то
точка ну понятно тогда что там ну в одну сторону у вас получается увеличение скалярное произведение
другую уменьшение и также понятно что вам достаточно рассматривать только вершины выпукло оболочки
потому что мы будем двигать двигать двигать двигать до тех пор пока можно до тех пор пока мы
находимся хотя бы чуть-чуть внутри выпукло оболочки но так она или поздно мы начнем касаться многоугольников
какой-то вершине не достигается оптимум но там это грубо говоря в эту сторону было увеличение
вот сторону уменьшения значит здесь будет максим тут будет минимум понятно на картинке же
еще раз вот это прямая прямая перпендикулярно вектору ab
теперь если вы ее начнете параллельно само себе двигать у вас меняется гамма просто но вам
надо найти экстремальное ее положение там в эту сторону или в эту так чтобы по крайней
мере еще она хотя бы чуть-чуть пересекала выпукло оболочку вот но соответственно вот
это положение это максимум вот это минимум ну или наоборот в зависимости от того куда обе смотрит
окей ну вот а дальше давайте скажем следующий давайте мы рассмотрим отдельно независимо
верхнюю часть выпукло оболочки и нижнюю часть выпукло оболочки тогда я утверждаю что если мы
ну давайте сделаем так давайте мы возьмем точку xy будем ее непрерывно вот так вот ею будем
скользить по верхней скажем выпукло оболочки ну вот так вот там какая-то ломаная на самом деле
вот давайте возьмем точку она будет непрерывно скользить по вот этой ломаной тогда я утверждаю
что это скалярное произведение с вот с вот этим фиксированным вектором будет грубо говоря сначала
увеличиваться потом уменьшаться то есть если я нарисую ну давайте здесь будет п откладываться
у меня который скользит вдоль границы верхней выпукло оболочки а сверху буду откладывать f от
п как скалярное произведение координат точки с ну короче скалярное произведение п на б тогда
у меня сначала увеличивается потом уменьшается ну более-менее по тем же соображению вот представьте
вы сюда поставили прямую двигайте ее и следите как она пересекается или не пересекается верхней
выпукло оболочкой сначала она будет пересекаться то есть при движении п по этой ломаной у вас будет
то есть вы в каждой точке считаете рисуйте прямую и претендикулярно обе тогда новость начала
будет двигаться в одну сторону потом потом начнет ну в другую в противоположную сторону двигаться
вот ну понятно что она так что она так двигается сначала бывает потом
либо наоборот у нас сначала бывает потом взрастает что-то такое
теорема
нет слов теоремы значит что это не сложный факт а неважно ну это правда ну это правда
какие вы скучные все надо доказывать блин
да смотрите смотрите потому что у вас давайте я скажу так давайте у вас
нет это нельзя досказать сейчас сейчас сейчас сейчас
что на ней константа если мы чуть-чуть
уменьшается да ну да
я не говорю слома там
каждая прямая перпендикулярная б некоторая гамма вот вот вы грубо говоря вот это на
самом деле график гаммы от п она сначала возрастает потом бывает
нет конечно еще раз это грубо говоря свободный коэффициент в уравнении прямой да вот у вас
точность написано ax плюс b y минус гамма вот минус гамма свободный коэффициент то есть я
рисую в каждой в каждой точке границы верхней упоколоболочки я рисую прямую
перпендикулярную ab то есть как раз вот одно из линий уровня каждый из них ну они они все имеют
одинаковые коэффициенты ab вот у них меняется гамма как свободный коэффициент то есть я переношу
прямую параллельно у нее меняется гамма я отвернусь сначала возрастает потом бывает
ну или наоборот сначала бывает потом возрастает ну вот замечательно все тогда здесь можно сделать
например бинарный поиск вот давайте посмотрим на стороны первая сторона вторая сторона третья
сторона четвертая и так далее понятно что если мы движемся вдоль отрезка просто вот если я
просто движусь вдоль отрезка то моя штука монотонно что-то делать возрастает или убывает ну да
вот значит на самом деле каждый отрезок он грубо говоря мне либо увеличивает скалярные
произведения то есть при движении вдоль него у меня либо увеличивается скалярные произведения
либо остается неизменным либо уменьшается вот ну значит поскольку у меня сначала увелич骑 потом
уменьшается я могу сказать след GU庫 у меня сначала в течение нескольких шагов
оно увеличивается в течение нескольких сторон потом начинает уменьшаться как бы вдоль
стороны оно монотонно убывает с какого-то момента мне нужно найти значит вот эту точку где
происходит переключение до которой всё увеличилось после которой все начинает убывать здесь будет
экстрем, очевидно, потому что все вот эти вот стороны
при движении вдоль всех этих сторон у меня увеличивается
скалярное произведение, при движении вдоль этих
убывает.
Буквально бинпоиск, да, по, ну как бы, по стороне.
Бинпоиском находим место, находим две соседние стороны,
так что вдоль одно скалярное произведение увеличивается
впроходе от начала к концу, вдоль другое, при проходе
от начала к концу, убывает.
То есть нам надо просто посчитать скалярное произведение
вот этой точки и вот этой на обе, вот этой и вот этой
на обе, понять как соотносятся значения в этих 2 точках.
Надо найти такое, что здесь увеличивается при проходе
а здесь уменьшается. Такое находим, значит, здесь экстремум.
Вот. Получается запрос, если мы можем быстро изначально
насчитать выпуклооболочку, то дальше просто логарифм
по верхней или нижней выпуклооболочке.
Ну, если надо, да. Нормально? Кайф.
Так, ладно. Теперь давайте к следующему перейдем.
Значит, следующая. Давайте научимся находить диаметр множества.
Диаметр. Ну, определение. Пусть у нас есть конечное множество точек.
Диаметр в нем это максимальное из попарных расстояний между точками.
Максимум по всем И, Ж, расстояние между П, И, Т и П, Ж, Т.
Ну, обычное эвклидовое расстояние на плоскости.
Вот. Соответственно, задача помножить, найти диаметр.
Найти две самые далекие точки.
Ну, замечание первое. Давайте поймем, что на самом деле
в качестве, опять-таки, в качестве перебираемых точек
достаточно рассматривать только вершины выпуклооболочки.
Потому что, значит, говорю, да, достаточно рассматривать
вершины выпуклооболочки Конватес.
Ну, почему? Пусть не так. Давайте предположим, что
максимум расстояния достигается на какой-то паре точек ПКУ.
Давайте как-то так нарисую.
Вот этот отрезок, да, эти две точки лежат В,
и тут достигается максимальное расстояние.
Давайте, скажем, продолжим этот отрезок в прямую,
ну, или там, в луч.
Если эта штука лежала внутри выпуклооболочки,
то рано или поздно этот луч пересечет какую-то сторону.
Понятно, что до нее расстояние только выросло, да,
то есть, поскольку я продлил отрезок, у меня это расстояние
стало только больше.
Ну и дальше я утверждаю, что если из этой точки
начать двигаться вдоль стороны, хотя бы, ну, как бы,
в одну из двух сторон, то у меня расстояние тоже будет увеличиваться.
То есть, по крайней мере, один из двух этих отрезков
будет иметь строго большую длину.
Ну, почему?
Потому что как ведет себя вообще расстояние
от точки до прямой.
Вот у меня есть точка П,
вот у меня есть какая-то прямая,
то есть, я провел прямую через сторону,
давайте опустим перпендикуляр.
Понятно, что наименьшее расстояние достигается
как раз вот до этой точки, до проекции точки на прямую.
А дальше, если вы начнете эту точку двигать
в любую из двух сторон от останования перпендикуляра,
у вас будет расстояние расти строго монотонно.
Ну, а то есть, чем дальше точка от основания перпендикуляра,
тем больше это расстояние.
Ну, потому что просто гипотенуза
в прямоголем треугольнике с растущим катетом.
То же самое здесь.
Когда вы двигаетесь от основания перпендикуляра,
у вас расстояние только увеличивается.
Вот, значит, на этой прямой,
на прямой задерживающей сторону есть какая-то точка,
такая, что при движении от нее в любую сторону
часто не увеличивается.
Ну, а вы встали в какую-то произвольную точку
и двигаетесь в обе стороны от нее,
тогда обязательно хотя бы в одной из двух сторон
будет увеличение.
Ну, то есть, там где-то есть перпендикуляр,
скажем, перпендикуляр где-то вот здесь,
значит, при движении туда расстояние увеличивается.
Если, наоборот, перпендикуляр здесь,
то при движении туда расстояние увеличивается.
Ну, все, значит, вместо этой Q
можно было бы рассматривать одну из вершин
выпуклооболочек. То же самое с P.
Хорошо?
Вот, значит, нам достаточно
вершин выпуклооболочки.
Окей, мне нужна будет такая лемма еще.
Значит, пусть диаметр вот с достигается на паре
точек пп.
Я утверждаю, что все множество с, давайте картинку нарисую
сначала.
Я утверждаю, что если провести вот такую полоску со сторонами
перпендикулярными отрезку ПКУ, то есть ПКУ это диаметр,
ПКУ это отрезок, на котором максимальное расстояние
достигается между точками С.
Дальше я провожу такую полоску со сторонами перпендикулярными
отрезками ПКУ, ограниченную как раз таки отрезками
ПКУ.
Тогда я утверждаю, что С целиком лежит внутри этой
полосы.
Значит, тогда С целиком лежит внутри полосы, стороны
отрезку ПКУ и при этом опирающийся на точке ПИКУ, то есть одна
опорная прямая проходит через П, вторая опорная
прямая проходит через К.
Значит, внутри полосы опирающийся на ПИКУ.
Вот, надо доказать, что это действительно элементарно.
Если это неверно, если я искаю эту точку вне полосы,
скажем, вот здесь вот, тогда расстояние от П до нее больше
чем ПКУ.
То есть вот это вот расстояние строго больше чем ПКУ, потому
что ПКУ это минимальное из всех расстояний до прямой,
потому что это основание перпендикуляра.
Если я ухожу куда-то за прямую, то у меня расстояние может
только вырасти.
То есть у меня вот это вот расстояние, скажем, до
пересечения с полосой больше, чем ПКУ и потом еще куда-то
я дальше ухожу.
Еще больше получается.
Ну, по факту, просто противно, да?
Противно, иначе диаметр можно было бы увеличить.
Нормально?
Вот, ну теперь давайте на основе этой леммы мы сделаем
алгоритм.
Смотрите, вот мы поняли, что чтобы найти диаметр,
нам достаточно как-то зажать наш многоугольник, наш
выпуклоблочек между двумя параллельными прямыми
с двух сторон.
Так что с обеих сторон эти прямые как бы опираются
на одну из вершин выпуклоблочек, по факту.
Ну, давайте тогда сделаем следующее.
Давайте всеми возможными способами эти две прямые
нарисуем.
То есть вот так вот их всеми возможными способами
проворачиваем.
Найдем все вот такие вот полоски, содержащие целиком
внутри себя все S, ну и найдем среди таких конфигураций
то, при котором вот это расстояние между опорными
точками максимально.
То есть я просто переберу все возможные вот эти вот
опорные прямые параллельные.
В частности, в какой-то момент я рассмотрю и такое
положение моих опорных прямых, если я посчитаю расстояние
между теми точками, на которые они опираются, я найду как
раз диаметр.
То есть среди всех возможных таких пар я найду максимальное
расстояние, это будет диаметр.
Алгоритм.
Ну, на уровне идеи мы вращаем пару опорных прямых L1,
что они будут параллельными у меня, и находим расстояние
между опорными точками.
То есть L1 и L2 касаются угольников какой-то точки, L1 здесь,
L2 здесь, посчитаем между ними расстояние, провращаем
дальше L1 и L2, они начнут опираться на какую-то другую пару
точек, посчитаем между ними расстояние и так далее.
Так все конфигурации вот этих ограничивающих полосок
мы переберем, значит мы в частности найдем вот
эти самые две ПК на максимальном расстоянии.
Вот такая идея.
Теперь надо понять как это вращать.
Мы хобби тогда учтем.
Значит, смотрите, понятно, что нам можно не рассматривать
довольно много положений прямых.
Понятно, что, например, вот если у меня есть такое
положение прямых, если я его чуть-чуть провращаю
и у меня ничего не изменится, то есть вот так чуть-чуть
поверну, то у меня будут те же самые две опорные точки.
И более того, если начну вращать обе эти прямые,
поскольку они параллельно, я их должен вращать синхронно,
то есть как бы на один тот же угол проворачивать,
то следующее изменение, изменение опорных точек
произойдет только в момент, когда одна из прямых будет
совпадать с одной из сторон.
То есть, ну иначе я просто вращаю, вращаю, у меня ничего
не меняется, у меня ничто не мешает вращать дальше.
Происходит изменение только когда у меня, скажем, ну
как быть, когда у меня одна из прямых начинает быть,
начинает содержать одну из сторон.
Вот.
Ну и в этот момент мы приводим переключения, мы говорим,
что ок, ага, раньше у меня вращения были относительно
по Яку, теперь вращение относительно этой точки
и вот этой.
Дальше продолжаем вращать точно так же, то есть,
завершаем вращать вот это вот, рано или поздно
происходит новое переключение, у меня, скажем, новое опорное
Вот здесь вот. Ну, окей, тогда будет вот это и вот это. Я начну вращать относительно вот этой точки и вот этой точки.
Вот. И все такие пары переберу.
Значит, давайте это напишем как-то.
Ну, начало такое. Давайте я, чтобы долго не думать, выберу изначально просто вертикальные положения обеих прямых.
Давайте найдем самую левую вертикальную прямую, самую правую вертикальную прямую в нашем многоугольнике.
Что-то вот такое.
То есть по факту просто точку с минимальным х и точку с максимальным х я нахожу, через них провожу такие вертикальные прямые l1, l2.
Значит, дальше начинаем их вращать. Ну, окей, давайте напишем, да, что l1, l2. Изначально вертикальные.
Да, конечно, конечно, конечно, да.
Вот. Значит.
Да, провели вертикальные прямые.
Дальше мы поддерживаем те точки, на которые опираются мои две прямые l1, l2. Давайте, скажем, их назову i и j.
То есть у меня все точки вдоль этого многоугольника, вдоль выпуклоболочка, занумерованы. Пусть это i и пусть это j.
Давайте начнем их потихонечку вращать вокруг этих двух точек. На маленькие углы.
Ну, опять понятно, что в течение какого-то времени, пока углы маленькие, ничего не происходит. Они продолжают вращаться вокруг тех же самых точек.
Значит, мне нужно понять, когда произойдет переключение. Какое переключение будет раньше, грубо говоря? Вот из-за этой стороны или из-за этой стороны?
Ну, понятно, у кого угол меньше, там и надо переключиться. То есть, грубо говоря, мне хотелось бы померить вот эти два угла, вот этот и вот этот.
Тот, кто из них меньше, там раньше переключение, и там надо переключиться.
Потому что при вращении как раз следующее препятствие, следующее препятствие, это та сторона, до которой угол меньше, чем до другой.
Ну, естественно, углы мы мерить не хотим. Мы вместо этого давайте просто посчитаем какие-то векторные произведения.
Значит, вот давайте я скажу, что это вектор У, это вектор В.
Вот, тогда я утверждаю, что если векторное произведение У на В кажется меньше нуля, сейчас подумаю.
Давайте по выразительной картинке. Вот, например, здесь пусть сторона такая какая-то, а здесь вот такая.
Вот, например, пусть здесь И, пусть здесь Ж.
Тогда у меня У вот такой вот, а В вот такой вот.
И понятно, что если у меня изначально прямые и вертикальные, то раньше поворот происходит вот здесь.
Ну, потому что В более близко к вертикальной прямой, чем это.
Вот, но если я нарисую В вот здесь же, из той же точки исходящей, что это У, это В.
Тогда у меня, ну как раз знак векторного произведения говорит, какой из поворотов раньше.
Вот здесь поворот получается положительный. Значит, надо увеличивать Ж, иначе плюс плюсы.
То есть мы еще пропустили его или нет?
Мне, честно говоря, нет.
Ну вот, давайте я здесь просто картинки порисую.
Вот, смотрите, когда угол от В до вертикальной прямой меньше, чем от У до вертикальной прямой,
то поворот между ними как раз от У до В идет в ближайший поворот против часовой.
А если бы у меня В была более наклонной, какая-то вот такая, скажем, если бы эта сторона была вот такой.
Вот такой вот.
Тогда у меня поворот был бы уже по часовой.
Ну, просто потому что как раз, то есть вот этот угол больше вот этого, значит у меня ближайший направлений поворота вот в эту сторону,
и здесь было бы больше, чем П просто.
Вот. Значит, тогда нужно было бы, наоборот, и увеличивать.
Ну все.
Значит, алгоритм такой. Мы нашли самую левую точку, самую правую точку, сказали, что это и Ж.
Дальше рассматриваем, в каждое время рассматриваем две стороны.
Сторона начинается в точке И, сторона начинается в точке Ж.
Рассматриваем их как векторы.
Берем их векторное произведение, и по знаку векторное произведение понимаем, какое из переключений следующее.
То есть какая из прямых меняет свою опорную точку раньше, чем другая, L1 или L2.
Ну и в зависимости от этого я сдвигаю одну из опорных точек Ж сюда или И сюда.
Да.
Если углы одинаковые, то не важно.
Если углы одинаковые, то не важно. Сейчас это докажем.
Вот. Но если, скажем, у меня никогда здесь не возникает нулей, то я вот делаю ровно то, что надо.
Я перебираю опорные прямые, я их потихоньку вращаю, понимаю, когда впервые, ну то есть, при каком угле,
происходит переключение опорной точки, и переключаю опорную точку.
Да, то есть тогда, если тут никогда не бывает района, что все у меня однозначно,
я тем самым переберу всевозможные конфигурации вот этих двух прямых параллельных.
Вот. Ну и в каждый момент, давайте напишем, что в каждый момент времени обновляем анс
через расстояние между упытой и пожитой.
То есть всегда, когда нашли новую пару опорных прямых, прорелаксировали ответ расстояния между опорными точками.
Вот. Ну и да, теперь давайте нарисуем картинку, что происходит, когда здесь знак равенства,
то есть когда у меня стороны параллельны, поймем, что алгоритм можно ставить таким же, ровно таким же, все, все будет хорошо.
Значит, что происходит с параллельными сторонами?
То есть представьте, что в какой-то момент у меня такая дилемма, что у меня, вот если у меня, например, были вот такие, да, вертикальные прямые,
то следующее переключение, оно как бы одновременно проходит через вот эти вот две стороны.
И вот здесь вот, и вот здесь вот, углы одинаковые, то есть эти две стороны параллельны,
у меня прямые как бы одновременно должны переключиться и по и и по жи, грубо говоря.
А я делаю это постепенно, сначала и переключаю, да, ну то есть у меня как бы вот эти вот два вектора параллельные,
у меня у них векторное произведение нулевое, поэтому я сначала переключу, скажем, одну координату, ну в этом случае, видимо, и,
то есть я сдвину и, потом посчитаю векторное вот этого на вот это и сдвину жи.
Вот. Ну в каком-то смысле я перебрал, на самом деле не все, то есть мне по факту в идеале мне нужно было бы перебрать 4 точки, да,
4, точнее, отрезка, вот эти два и вот эти два, потому что когда у меня опорные прямые параллельные и содержат по две точки,
ну не понятно, что такое опорная точка вообще, да, их как бы две.
И в идеале мне нужно было бы перебрать все 4 отрезка, значит давайте их напишу как-то, A, B, C, D,
мне нужно перебрать все вот эти вот отрезки A, D, A, C и B, D, B, C.
И B, D, B, C.
Вот. Ну понятно, что там максимум, максимальное из расстояния это один из этих четырех чисел.
Вот. Ну а мой алгоритм перебирать не все, но он точно переберет A, D, perdон, A, C и B, D.
Он точно переберет диагональ, я утверждаю.
Ну потому что сначала он находится в этом положении, в вертикальном, когда мы еще не дошли до вот этих параллельных сторон,
тогда мы как раз задеваем какую-то диагональ.
Потом мы начинаем вращаться, приходим в состояние, когда мы параллельны обеим сторонам,
переключаем сначала одну вершину в другой конец, потом другую вершину в другой конец,
и тем самым просматриваем вторую диагональ.
По пути, да, еще заодно B, C просмотрим, но не важно, главное, что мы просмотрим обе диагонали.
И вот я утверждаю тогда, что если у меня в четырехугольнике A, B, C, D два основания параллельны, A, B, C, D параллельны,
тогда максимальный из диагонали больше, чем максимальный из сторон, поэтому мне будет достаточно рассмотреть только диагонали.
Что алгоритм точно рассмотрит обе диагонали,
и этого будет достаточно.
Ну, потому что можно доказать следующее утверждение.
Пусть в четырехугольнике A, B, C, D основания параллельны, то есть A, B параллельны от C, D,
тогда максимальный из диагонали больше, чем максимальный из боковых сторон, я утверждаю.
Максимальный из диагонали от C, B, D больше, чем максимальный из боковых сторон.
A, D, B, C.
Это как раз значит, что из вот этих четырех отрезков мне не нужно перебирать обязательно все четыре,
мне достаточно перебирать те два, которые так алгоритм переберет.
Ну, давайте докажем.
Давайте трапецию нарисую, раз два параллельных основания, то это трапеция или параллелограмма.
Давайте трапеция, A, B, C, D.
Давайте рассмотрим вот сторону, какую-то боковую сторону A, D, например.
Сумма углов при ней 180 градусов, потому что эти две стороны параллельны,
значит сумма этих двух углов 180, значит какой-то из них больше равен 90.
Например, вот этот.
Этот угол больше равен 90 градусов.
Значит, в этом треугольнике A, C наибольшая сторона, потому что лежит против наибольшего угла,
поэтому A, C больше, чем A, D.
Значит, A, D точно меньше, чем какая-то из диагоналей.
То же самое со второй стороной.
Профит.
Значит, рассмотрим боковую сторону A, D.
Боковую сторону A, D.
Один из углов при ней больше или равен 90 градусов,
значит, A, D меньше диагонали того треугольника.
Меньше противолежащей стороны в том треугольнике.
Меньше противолежащей стороны в том треугольнике.
Кажется, все.
Нормально?
Ну вот.
Значит, как бы весь наш алгоритм корректный.
Давайте еще раз проговорю.
Я сначала построю выпуклую оболочку за NLGN,
потом нахожу крайние вот эти вот опорные прямые вертикальные слева справа,
говорю, что они опираются на точке IJ.
Дальше начинаю вращать.
То есть я храню опорные точки, смотрю на два исходящих вектора,
понимаю, какой из них менее крутой,
в какой из них раньше происходит переключение,
ну и делаю переключение, скажем, я сравню, какой из векторов меньше,
и говорю, что окей, теперь мое состояние вот такое.
То есть у меня опорная точка вот эта и вот эта.
Дальше опять смотрю, какой из векторов вот этот или вот,
ну короче, опять два следующих вектора смотрю,
понимаю, кто из них менее крутой, поворачиваю относительно него.
И каждый раз, когда сделал поворот, когда сделал проворачивание,
обновляю ответ через текущее расстояние между опорными точками.
То есть после того, как я построю выпуклую оболочку,
остается просто O от N, потому что мне нужно проворачивать прямые
от такого положения до, ну короче,
прохождение по сторонам будет линейное количество,
поэтому будет линия после этого.
Почему максимальный диаметр не пропустим?
Потому что максимальный диаметр всегда порождает вот такие две опорные прямые.
А мы перебираем вообще все опорные прямые, опорные пары.
Почему?
Ну, мы не перебираем те, которые не отличаются парами опорных точек.
То есть да, грубо говоря, вот, опять же, на этой картинке,
я, то есть у меня вот такая пара опорных прямых не отличается вот от такой.
Ну, вот от такой.
Потому что я просматриваю только пары опорных точек.
Вот.
Ну и как бы, что, неправдоподобно что ли?
Ну и там, где очевидно, как раз может быть что-то зарыто.
Не, ну как, еще раз, смотрите.
У нас есть в каждом момент времени, по факту, у нас неявно есть какие-то прямые,
которые, то есть по факту, у меня есть полоса в каждом момент времени вот такая,
которая внутри себя целиком строит многоугольник.
Ну вот, тогда ответ больше бы равно, чем это расстояние точно.
И в какой-то момент, поскольку есть полоса,
для которой опорные точки это концы диаметра, я их тоже когда-то найду,
потому что я все положения перебираю.
Ну, расскажете в чем проблема, потому что я не вижу, чтобы здесь было что-то не точно, на самом деле.
Что? Хорошо. Не, ну я знаю, что правда, может доказать неполное просто.
Ну, еще раз, мы перебираем как бы не все, а те, которые...
А? По факту все, да, по факту все.
Ну ладно, поговорим еще тогда.
Так. Окей.
Тогда идем дальше. Мне нужен будет такой технический факт.
Значит, давайте определение. Все, с диаметром покончили, мы его научились находить, забыли.
Дальше, определение.
Пусть у меня есть какое-то конечное количество точек, не знаю, там,
P1 и так далее, PkT.
Значит, тогда их выпуклой комбинацией...
комбинацией...
называется сумма вот такого вида.
Сумма лямбда ИТ, ПИТ,
где все лямбды не отрицательные,
то есть И от 1 до К.
То есть это такая линейная комбинация П-шек
с не отрицательными коэффициентами, сумма которых один.
Выпухлая комбинация.
То есть это ограниченный случай
линейной комбинации, да, только с не отрицательными коэффициентами, сумма единиц.
Ну, по координатно.
Вот как мы там делаем, векторы, точки, я их смешиваю всегда.
Ну, векторы складываю, да.
Ну, типа, блин, по координатным точке складываю.
То есть векторы. У меня точка равно векторам.
Можете меня булить, но...
Для меня точка это вектор, и наоборот.
А? Да, конечно.
Ну, то есть эта пара, как бы каждая P, это пара х за 5y.
Я по координатным все складываю, получаю пару, там,
х большое за 5y большое.
То есть пусть есть, конечно, множество точек.
Тогда...
Эм...
Выпуклая оболочка
это в точности множество всех линейных комбинаций,
выпуклых комбинаций и точек из С.
Ладно.
Множество
всех выпуклых комбинаций,
точек из С.
Нет, тут проще.
Тихо, тихо.
Тихо, тихо. Базы данных, что?
А, я понял. Бесплатно, да, бесплатно.
Бесплатно.
Так.
Давайте начнем куда-нибудь, неважно.
Я утверждаю, что здесь происходит равенство.
Давайте начнем, например, с такого вложения.
То есть что любая точка из выпуклой оболочки
обязательно представляется в виде линейной комбинации.
Вложение слева направо значит, что любая точка выпуклой оболочки
обязательно представляется в виде линейной комбинации.
Вот. Но мы с вами знаем вроде более-менее,
что выпуклая оболочка это обязательно выпуклый многоугольник.
Ну, типа того, да.
Вот.
Ну, догадываемся, по крайней мере, об этом.
Давайте его триангулируем.
Тогда любая точка выпуклой оболочки
любая точка изạмон��жта
попадает по крайней мере в один из треугольников.
А, ну и что, тогда
любая точка
из конвесс
попадает в один из треугольников.
Ну, там не знаю, например, ABC, какая-то точка Q попала
в треугольник ABC.
Вот, я тогда утверждаю, что Q является выпуклой комбинацией
точек ABC.
Ну, это простой факт, потому что давайте, например, ну,
если Q совпадает там с, если Q лежит, неважно, пофиг.
Значит, пусть Q внутри треугольников, тогда давайте проведем прямую
CQ до перещения с A-B.
Давайте, это какая-то точка будет X.
Тогда поскольку X лежит на отрезке А-Б, то понятно,
что X-ка это какая-то их выпуклая комбинация.
Ну, то есть, как бы, вот у меня есть отрезок, да, мне
нужно взять B с каким-то коэффициентом, а с каким-то
коэффициентом сложить, чтобы получить точку Х.
Тип-того.
Тип-того, да.
Т.е., мне нужно посмотреть на длины этих отрезков и
взять-то ... если тут длина А, то здесь нужно повесить
вес А, и если тут Б, то тут нужно повесить вес Б.
Там, деленная на А плюс B.
Вот.
Тогда у меня получится, что какая-то выпуклая комбинация
А и Б – это X.
То же самое с отрезком c и x. Мне нужно взять выпуклую комбинацию c и x, у меня получится точка q.
Вот, ну и понятно, что выпуклая точка. То есть, если x это
какая-то там, не знаю, лямбда a, плюс 1 минус лямбда b.
И мне еще нужно взять q, равную, скажем, mu c, плюс 1 минус mu x.
Но если я сюда вместо x поставлю вот это, у меня как раз получится выражение q через a b c.
Значит q это выпуклая комбинация
a b c.
Сейчас q из оболочки?
Нет, q это произвольная точка внутри треугольника. То есть, я беру следующее, я говорю, что пусть q это произвольная точка отсюда.
Ну, внутри выпуклая оболочка, в смысле, да. Она, в частности, внутри какого-то треугольника. Вот она является выпуклой комбинацией его вершин.
На самом деле, утверждение-то сильнее?
Нет, ну не важно.
Вот, ну а раз она выпуклая комбинация этих трех, то она выпуклая комбинация всех n, потому что можно все остальные взять с нулеми процента.
Но ведь неправда.
Вроде доказали, давайте в обратную. Тут будет чуть больше возни.
Значит, я хочу сказать, что если какая-то точка является выпуклой комбинацией точек из s, то она обязательно лежит в выпуклой оболочке.
Давайте докажем это индукцией по количеству не нулевых коэффициентов.
Значит, пусть
Q это...
Давайте я... Смотрите, у меня в выпуклой комбинации какие-то коэффициенты нулевые, давайте нулевые сразу выброшу.
Давайте оставлю только положительные.
Значит, пусть Q это какой-нибудь лямбда и первая, p и первая, плюс и так далее, плюс лямбда и kt, p и kt.
Значит, все лямбды больше нуля, потому что нулевые я могу выбросить, они не влияют на сумму.
Вот, докажем индукции по k.
Не, n, n количество точек, k это количество активных выпуклых комбинаций.
Значит, индукция. Пока докажем, что Q лежит внутри выпуклой оболочки s.
База k равна 1.
Тривиально, потому что в этом случае, если у меня есть только один коэффициент, только одна точка,
то единственный способ получить сумму равно 1, это чтобы тот коэффициент был единицей.
В этом случае просто Q равно какой-то там, p и первая, а это, понятное дело, лежит в выпуклой оболочке.
Каждая точка лежит в выпуклой оболочке.
Вот, ну переход.
Давайте мы
представим Q как выпуклые комбинации. Ну, давайте я рассмотрю вот первые k-1 слагаемые.
И их, вот эту вот сумму превращу в выпуклых комбинаций.
Значит, пусть
лямбда, это сумма первых k-1 коэффициента, лямбда и первая, плюс и так далее,
то есть лямбда и k-1.
Значит, пусть
лямбда и первая штрих, это лямбда и первая делить на лямбда и
так далее.
Лямбда и k-1 штрих, это лямбда и k-1 делить на лямбда.
Ну, я просто взял первый коэффициент, сложил, получил какую-то сумму лямбда, и теперь все эти коэффициенты поделил на ту самую лямбду.
Тогда, если я определяю Q-штрих
как сумма лямбда и первая штрих, p и первая,
плюс и так далее,
плюс лямбда и k-1 штрих,
p и k-1,
то это выпугла комбинация каких-то точек.
Почему? Потому что все коэффициенты остались по-прежнему не отрицательными,
потому что я их просто поделил на какую-то положительную константу лямбда.
И при этом их сумма
стала равной единице, потому что как раз я их все нормировал, так что теперь, если я просуммиру все штрихованные лямбды,
у меня как раз получится сумма вот этих штук делить на лямбду, это 1.
Вот, значит это выпугла комбинация. Значит, она по предложению индукции лежит в конватес.
Ну и все, теперь осталось выразить Q через Q-штрих и вот эту последнюю точку по икате.
Значит, что такое Q?
Я утверждаю, что это вот такая вот линейная комбинация
точки Q-штрих и по икате.
Просто потому что вот это вот лямбда.
Вот.
Ну это лямбда, потому что лямбда это сумма всех, кроме последнего. Значит, это как раз 1 минус лямбда икате.
Теперь, когда я Q-штрих домножу на лямбда, у меня как раз все эти знаменатели пропадут. Останутся просто первые камни с одной слагаемой и
плюс последние слагаемые. Ну, просто определение Q.
Вот. При этом я знаю, что вот эти две точки
лежат у меня в конватес.
Лежат в конватес.
Ну а потом я беру их в выпуклую комбинацию с коэффициентами таким и таким.
Вот. То есть у меня были какие-то две точки Q-штрих и по икате.
Я знаю, что эти два конца отрезка лежат в выпуклой оболочке, а потом я рассматриваю какую-то их выпуклую комбинацию. Потому что сумма коэффициентов
равна единице и они оба нетрицательны.
Ну как раз, да, выпуклая комбинация точек, двух точек, это какая точка на отрезке?
Какое утверждение мы доказывали для точек из набора?
Какое утверждение мы доказывали для точек из набора?
Смотрите.
Нет, нет, ничего не надо такого делать. Еще раз, смотрите. Вот здесь я мог это сделать, что Q-штрих в конватес?
Вот это правильный переход? Дальше. Вот это правильно, что эта точка лежит в конватес?
А дальше что? У меня написано, что Q-это выпуклая комбинация точек лежащих в конватес. Дальше я не пользуюсь.
Индукцией. Дальше пользуюсь здравым смыслом. Что есть у меня две точки внутри выпуклой оболочки и
какая-то точка на отрезке между ними, то эта точка Q тоже лежит в выпуклой оболочке. Потому что выпуклая оболочка и выпуклая множество.
Значит все точки на отрезке между ними лежат в конватес. А Q-это как раз, потому что это выглобинация двух точек, лежит на отрезке между ними.
Отсюда следует, что Q тоже лежит в конватес.
Чего? Да.
Нет. Нормально?
Хорошо.
Вот. Хорошо. Вот есть у нас такая, получается,
эквалентная интерпретация выпуклой оболочки, если надо.
Наверное, будет надо.
Так, давайте ехать дальше.
Определение. Сумма Минковского.
Множеств, произвольных множеств. А и Б.
Называется
Следующее множество. Мы его будем обозначать просто А плюс Б.
Значит это всего лишь сумма всех точек. Таких, что одна в А, другая в Б.
Так, вот.
Если у меня есть два множества на плоскости, я, грубо говоря,
одной точкой итерируюсь по всему множеству А, пробегаю всю множество А,
второй точкой пробегаю всю множество Б, рассматриваю всевозможные такие попарные суммы.
Ну, все, что получается, это А плюс Б.
В точности множества всех сумм точки из А, точки из Б.
Вот.
Ну и задача найти сумму Минковского для каких-то двух выпуклых многоугольников.
Значит, где я мытый, это выпуклые многоугольники.
Вот.
Значит, где я мытый, это выпуклые многоугольники.
Ну, давай сначала, например, скажем, зачем это вообще может быть нужно.
Ну, к сожалению, контеста вставлял не я, потому что поэтому я не знаю, что там.
Вот.
Я буду не рад.
Значит, например, через сумму Минковского можно научиться находить,
научиться проверять, можно ли, фу ты, пересекаются ли два многоугольника.
Вопрос, пересекаются ли М1 и М2.
У вас есть два выпуклых многоугольника, вы хотите понять, есть ли у них общие точки.
Ну, тогда, например, можно сделать следующее.
Давайте мы посчитаем вот такую вот сумму Минковского.
А сколько будет сказать сумму?
За линию.
М1 плюс М2.
Ну, то есть, с иными словами, это все, как бы, все разности, точка отсюда, минус точка отсюда.
Тогда, если эта штука, ну, как бы, точнее, это критерий, да, вот эта сумма содержит ноль,
если и только если многоугольники пересекаются.
Нет, с мясом, многоугольник с мясом у меня всегда.
Что? Ну, в смысле, с внутренностью.
С внутренностью, с внутренностью.
Вот.
Значит, что значит, что они пересекаются?
Значит, есть какая-то общая точка Х, и здесь, и здесь.
Ну, соответственно, когда я вычту Х из Х, вот здесь у меня как раз получится ноль.
Ну и обратно, если здесь получился ноль, значит,
можно взять какую-то точку отсюда, вычесть точку отсюда,
чтобы получить ноль, значит, есть как раз
одинаковая точка там и там.
Вот.
Более того, можно научиться находить расстояние между M1 и M2.
Расстояние между фигурами как минимальное из расстояния
между точками фигур.
Вот.
Ну а это просто мы строим ту же самую фигуру
и находим наиболее
близкую точку к нулю.
То есть опять я рассматриваю тот же многоугольник
и нахожу в нём точку самую близкую к нулю.
Ну, потому что как раз разности
это всевозможные вот эти вот там точки по required Q.
Мне нужно, чтобы найти расстояние
нужно минимизировать
вот такую разность по всем P из M1
по всем Q из M2.
Но как раз если я найду
такую разность, то дальше
мне нужно будет просто, ну на самом деле, это будет
какой-то выпукло многоугольник,
дальше мне нужно будет выпукло многоугольник и найти
Ну это как-то делается, это просто совсем.
Ну это как раз мотан, потому что, ну типа расстояние
между фигурами, если они замкнуты, достигается
на точках границы.
Это мотан.
Вот эту задачу вы как-нибудь сами решите, ладно?
Ну типа да, может быть расстояние.
То есть еще раз.
Я утверждаю, что когда вы рассмотрите такую сумму,
это будет обязательно многоугольник.
Вот, ну какой-то такой многоугольник.
Дальше вам надо найти самую близкую к нулю какую-то
точку из вот этого многоугольника.
Ну сделайте как-нибудь, пожалуйста.
Достаточно, на самом деле, рассматривать стороны,
но расстояние с точки до отрезка как-нибудь найдешь.
Давайте.
Слушаю.
Смотрите, многоугольник, в моем понимании, это всегда
не только граница, но и то, что все внутри границы.
Ну вот именно с мясом.
Ну типа все, смотрите, вот тут вот все, что заштриховано,
это все многоугольник.
Вот все, что внутри тоже многоугольник.
Ну то есть M1, M2 это многоугольники с мясом.
Каждая из них это вот такая фигурка заштрихованная
внутри.
M2.
Мы описываем границу и все, что внутри, говорим,
что лежит в многоугольнике.
Ну типа вот вы нарисовали границу, вот вся внутренность
границы это многоугольник, включая границу, все это
многоугольник.
Отлично.
Так, ну что, давайте разбираться теперь с Минковским, как
его строить.
Ой, утверждение, значит, если M1, M2 выпуклые многоугольники,
то утверждается, что их сумма Минковского записывается,
ну в частности равна следующему множеству.
Это выпуклая оболочка всех попарных сумм P1 плюс P2,
где P1 это вершина M1, P2 это вершина M2.
Я напишу обобщенно, P1 это вершина M1.
В отличие от определения, я рассматриваю не все возможные
суммы точка из одного, точка из другого, а только
вершины оставляю.
То есть я беру вершину одного, вершину другого складываю
и по всем ним беру выпуклую оболочку.
То есть в обычном определении я рассматриваю просто сумму
точек из МИ, а здесь сумма вершин из МИ.
И потом выпукляю с помощью выпуклой оболочки.
Чего вы орёте?
Хейтеры блин, жесть.
Так, давайте сначала заметим, первое, что я хочу сделать,
это докажем, что M1 плюс M2 выпуклая фигура.
Выпуклая фигура.
Определение.
Вот это сумма Минковского.
Это множество точек.
Множество становится выпуклым, если при взятии любых двух
точек.
Окей.
Да, хорошо.
Ну, сложили вот в обычном понимании по определению
просто.
Дальше.
Почему это выпуклая штука?
Ну давайте просто, типа, возьмём какие-то две точки
и докажем, что отредок между ними целиком лежит.
Вот пусть у меня, скажем, какая-то точка P1 плюс P2
взялась в M1 плюс M2 и какая-то другая точка Q1 плюс Q2 взялась
в M1 плюс M2.
То есть, это какая-то точка из M1, это какая-то точка
из M2, это из M1, это из M2.
Мне достаточно доказать, что весь отрезок лежит
целиком в M1 плюс M2.
Ну, это сделать несложно.
Я знаю, что любая точка на отрезке представляется
выпуклой комбинацией вот этого и вот этого.
Любая точка, скажем, Z, это вот такая вот, например,
выпуклая комбинация своих концов.
Вот.
Ну, это можно спокойно расписать.
Значит, можно писать, что это лямбда P1 плюс один
минус лямбда Q1 плюс то же самое с индексами 2.
Просто скобки раскрыл, перегруппировал.
Дальше первая слагаемая лежит точно в M1, потому что
мы знаем, что P1 и Q1 лежат в M1.
Значит, выпуклая комбинация, ну, короче, это какая-то
точка на отрезке между P1 и Q1, эта штука лежит обязательно
в M1.
То же самое здесь, P2 и Q2 лежат в M2, поэтому их выпуклая
комбинация лежит в M2, потому что M1 и M2 выпуклые по предположению.
Значит, мы показали, что любая Z-лигращая на отрезке
представляется в виде суммы двух точек из M1 и M2, значит,
доказали то, что нужно.
Лежит в M1 плюс M2.
Да?
Кайф.
А вот это то, что вы получили, это всего выпуклая комбинация
для суммы?
Что?
Вот.
А то, что вы получили, это всего выпуклая комбинация
для суммы?
Я не пойму вопроса, извините.
А почему всё ещё?
Почему она лежит?
Почему вот это в M1 понятно?
Да.
Почему вот это в M2 понятно?
Ну, выпуклая комбинация.
Да.
Ну а дальше, что такое M1 плюс M2?
Это все возможные суммы, точка из M1 плюс точка из M2.
В частности, вот эти две.
То есть, вот это плюс вот это.
Так, теперь мы знаем выпуклость.
Будем доказывать вот это вот равенство.
Давайте вот в такую сторону сначала докажу.
Теперь будет доказывать, что вот это вложено сюда.
Ну, возьмём произвольную точку из M1 плюс M2.
Давайте опять её назову Z.
Раз точка лежит в сумме M1 плюс M2,
значит, она представляется в виде какой-то суммы,
ну, скажем, X и Y.
Z равно X плюс Y,
где X пришло из M1, Y пришло из M2.
Потому что по определению M1 плюс M2,
это все вот такие суммы,
поэтому для Z есть какое-то такое представление.
Дальше сделаем следующее.
Поскольку M1 и M2 это многоугольники,
давайте их треангулируем.
И поймём, в каких треугольниках лежат X и Y.
Скажем, X попал куда-то в треугольник A1, A2, A3.
Это всё лежит целиком в M1.
А Y попал в треугольник B1, B2, B3.
И это всё целиком лежит в M2.
А поскольку это точки из M1, M2,
то они лежат в каких-то таких треугольниках.
А в М2?
В М1, в М2, в М3.
А в М4?
В М4?
В М4?
В М3?
отрицательность суммы 1, а у — это сумма межитая
бежитая, где межитая неотрясательность суммы 1.
Ну, потому что они в треугольниках, да, мы знаем, что начинка
треугольника — это все выпуклые комбинации.
Вот.
Мне надо понять что-то про х плюс у.
Ну, смотрите, давайте заметим, что z равный х плюс у.
Я могу записать в следующем видео.
Сумма по и, сумма по ж, лямбда и плюс межи, аи плюс бжи.
Я вот ожидаю, что выполняется такое равенство.
Ну почему, потому что, если я здесь просто раскрою
все скобки, давайте, например, посмотрим, с каким коэффициентом
идет у меня аит.
Аит в эту сумму входит с коэффициентом лямбда ит плюс мя 1, плюс мя 2,
плюс мя 3.
Ну, то есть, три таких слагаемых.
Извините, не плюс, умножить, виноват, умножить здесь,
умножить.
Иначе было бы плохо.
Лямбда ит умножить на межитая, виноват.
Вот.
Теперь, еще раз, да, почему это верно, раскрываем здесь
все скобки, смотрим на коэффициент при аи.
Коэффициент при аи будет лямбда ит умножить на мя 1,
плюс лямбда ит умножить на мя 2, плюс лямбда ит умножить
на мя 3.
Но мы знаем, что сумма мюшек это 1, значит, как раз коэффициент
при аи будет просто лямбда ит.
То же самое при бжи, коэффициент будет мюжитая, то есть, мы
получаем, что при раскрытии у меня получается в точности
х плюс у, а это z по определению.
Да?
Ферштейн.
Хорошо.
Ну, это вроде все, что нужно.
Почему?
Потому что мы на самом деле доказали в частности следующее.
А что нам надо было?
Нам надо сказать, что z лежит внутри выпуклой оболочки
вот таких вот штук.
Но мы показали даже более сильную вещь.
Мы показали, что z лежит в выпуклой оболочке множество
следующих точек.
Ну, давайте так не пишу, просто аи ит, плюс бжи ит, по всем
и от 1 до 3, ж от 1 до 3.
Ну, потому что вот здесь как раз написано выпуклая
комминация этих точек, потому что все эти коэффициенты
не отрицательные, их сумма равна 1, ну, потому что если
просуммировать, то у вас как раз получится, там, сумма
лямбда иты на 1 будет 1.
Значит, z, вот эта вот запись означает, что z лежит в выпуклой
оболочке, является выпуклой комминацией вот этих точек,
ну а все эти точки в частности были вершинами наших многоугольников.
Значит, мы доказали все, что хотели.
А эта штука уже вложена в p1 плюс p2, где p это вершина
митра.
То есть, мне даже для вот этого доказательства, что
z лежит здесь, мне достаточно перебрать не все возможные
p1 и p2, а вершины многоугольников, а в качестве p1 достаточно
взять вот эти вот 3, любую из этих трех, в качестве
2, любую из этих трех, и даже если ограничу так,
то у меня получится, что z лежит в этой выпуклой
оболочке.
Значит, и в этой.
А?
Думаю, что нет.
Ну, это слишком громоздкое было бы просто определение.
Понятно?
Ну, типа, если фиксировать i и просуммировать пожи, то
у меня получится, то есть, если я лямбда и т вынесу,
у меня будет сумма пожи мюжи, это 1, а останется сумма
лямбда и умножить на 1, это 1.
Так, хорошо, в одну сторону доказали, надо в другую
теперь.
Так, а другую это вот так вот, что если взять любую
точку отсюда, то она лежит в m1 плюс m2.
Ну, здесь я утверждаю, достаточно доказать, что для любой п1,
для любой вершины m1, для любой вершины m2, их сумма
лежит в m1 плюс m2.
Потому что если я, то есть, смотрите, я говорю, что мне
достаточно только для вот этих вот порождающих,
то есть, смотрите, у меня выпукла оболочка какого-то
множества точек порождающего.
Вот я рассматриваю все вот эти точки, если я так говорю,
что все они лежат здесь, то значит, выпуклая оболочка
на них натянутая тоже лежит здесь, потому что мы доказали,
что эта штука выпукла.
А это тривиально, да.
То есть, еще раз, я про каждую точку из вот этого множества
говорю, что они не лежат в m1 плюс m2, каждая такая точка
лежит в m1 плюс m2.
Дальше, если я это выпукляю, строю выпуклую оболочку,
то поскольку вот эта фигура выпуклая, то и выпуклая
оболочка тоже полностью содержит, потому что выпуклая
оболочка это минимальная выпуклая содержащая данное
множество точек.
А это какое-то.
Значит, это содержит выпуклая оболочка, и мы победили.
Но это тривиально, да, мы знаем, что если взять любую
точку из m1, любую точку из m2, то их сумма лежит в m1
плюс m2 по определению.
Что это тривиально.
Все, доказали.
Ну, следствие, если m1 и m2 выпуклые многоугольники,
то их сумма тоже выпуклая многоугольник, потому что
конечно множество точек.
Вот.
Ну, я не буду доказать, я говорю, что это тривиально
то есть м1 и м2 это выпуклая оболочка, конечно множество
точек, то в частности это выпуклая многоугольник.
Мы пользуемся только выпуклостью.
Да.
Мы пользуемся только выпуклостью, а теперь я еще навешу, что
это еще и многоугольник.
Можно, сейчас мы как раз это сделаем.
У нас алгоритм как раз будет это делать.
Вот.
Значит, давайте теперь сразу строить алгоритм, потом
поймем, почему он корректен.
Значит, сделаем следующее.
Дело, как обычно, выберем левые нижние точки в обоих
многоугольниках.
Ну, если, то есть выбираем самую левую, если таких
несколько, среди них самую низкую.
Вот.
Дальше, ну понятно, это какие-то вершины, не знаю,
p1 и p2.
Понятно, что их сумма является вершиной сумм Минковского.
Ну, потому что эти точки экстремальные по иксу, их
сумма будет экстремальная по иксу, это обязательно
будет вершина.
Значит, я могу нарисовать сразу на плоскости где-то
точку p1, p2.
Это будет одна из вершин выпуклой оболочки, одна из
вершин суммы Минковского.
А дальше идея очень похожа на то, что мы делали вот
с этими вращающимися прямыми.
Значит, давайте рассмотрим вот эти две стороны, следующие
две стороны, сходящие из текущих точек.
Давайте поймем, какая из них менее крутая.
И пририсуем ее, начиная из этой точки.
Вот, ну, видимо, вот это вот, ну, то есть, как бы, опять,
я измеряю какой-то угол, вот этот будет меньше, чем
вот этот.
Значит, я тогда рисую просто вот эту стрелку.
Да, я к уже нарисованной точке пририсовываю вот этот
вот вектор.
И дальше сдвигаю вот здесь вот индекс вот сюда, то
есть, теперь следующий рассматриваемый вектор будет
вот такой.
Теперь опять, у меня есть точка здесь, точка здесь,
я рассматриваю сходящие стороны из них, смотрю,
какой из них менее крутой, ну, то есть, какой более,
то есть, грубо говоря, если я, то есть, я хочу понять,
какая страна будет следующая, какую сторону нужно
нарисовать следующую, вот это или вот это.
Но если я их нарисую из одной точки, у меня будет вот
этот сюда, а этот куда-то вот сюда.
Но мне нужен тот, который, как бы, ну, вот, против
часовой обходит весь мой многоугольник.
Поэтому я беру вот эту сторону.
Я ее рисую и приношу указатель вот сюда вот.
Потом опять, есть две стороны, я выбираю, ну, там,
если они параллельные, то я любую из них рисую
и сдвигаю указатель вдоль этой стороны.
И так далее.
То есть, у меня есть опять, у меня есть две стороны,
в каждый момент времени я выбираю, какая из них менее
крутая, то есть, ну, вот как раз лежит на выпуклооболочке,
да, то есть, вот здесь я могу нарисовать два таких вектора,
я рисую из них самый, ну, самый внешний.
Рисую его и сдвигаю указатель вдоль той стороны,
по которой я прошелся.
Ничего не надо.
А, в смысле, удалить точку посередине?
Ну, можно, ну, можно, да, да.
Ну, это уже, это уже тонкость совсем.
Да.
Да.
Мы по факту просто сторону пририсовываем.
Ну, потому что, смотрите, вот мы P1 плюс P2 нарисовали
правильно, вот это какая-то точка здесь.
Дальше я говорю, что, ну, если я буду двигаться, скажем,
вот этой точкой вдоль стороны, то у меня, на этой картинке,
да, когда у меня P2 скользит вдоль этого отрезка,
сумма P1 плюс P2 скользит вдоль того же параллельного отрезка.
Вот. Ну, давайте тогда я просто открис hour сюда перерисую.
Потом, у меня, скажем, выбор новый.
Я могу либо этой точкой скользить вдоль такого отрезка
и получить вот такой отрезок в результате,
либо этой точкой скользить вдоль этого отрезка
и получить вот этот отрезок.
Ну, понятно, что это более внешнее, да,
Я это рисую, сдвигаю указатель вот сюда.
Ну и так далее.
Так далее обхожу оба многоугольника, как-то вот там он так все прорисовывает,
пока не вернусь обеими точками в начало.
Да, я вот это буду рисовать.
Не понятно, что я обязательно вернусь в конце в ту же точку, откуда начал.
Ну, потому что я этот многоугольник обошел, этот обошел.
У меня сумма векторов нулевая, значит я вернулся туда же, откуда начал.
Правда ли, что если вы пришли одной из точек изначально,
то больше мы до конца алгоритма и уже не вернемся?
Да.
А, потому что мы выбрали две точки при точке нажат?
Да, нажат.
Вот.
Ну и соответственно тогда понятно, если такой алгоритм корректен,
то он работает за, ну за линейное время.
Если здесь была n вершина, здесь m, то мы за время n плюс m все нарисовали,
потому что у меня хранится указатель на вершину здесь, указатель на вершину здесь.
Я рассматриваю две стороны, понимаю там по знаку векторного напряжения между ними,
понимаю, какую из них нужно нарисовать дальше и сдвигаю указатель на единичку
в том многоугольнике, откуда пришла сторона.
Вот, ну и так делаю, пока не пройду все вершины по одному разу слева и справа.
Такой алгоритм линейный.
Почему он корректен?
Давайте подумаем.
Значит, ну давайте про корректность.
Во-первых, я отражаю, что то, что мы нарисовали гарантированно вложено в m1 плюс m2.
Ну потому что что мы сделали?
Мы взяли какую-то точку, равную сумме двух вершин.
Понятно, что это лежит в m1 плюс m2.
Дальше вот я делаю ровно это.
Я одну точку зафиксировал, а второй скольжу вдоль отрезка.
Сумма их скольжит вдоль отрезка.
Поэтому я нарисовал что-то, что точно лежит в m1 плюс m2.
Вот это все литово m1 плюс m2, я взянул эту точку сюда.
Теперь я скольжу здесь по этому отрезку и здесь по этому.
У меня сумма будет либо это, либо это.
Я нарисовал вот это, это лежит в m1 плюс m2.
Все стороны, которые я рисую, гарантированно лежат в m1 плюс m2,
просто потому что они являются суммами каких-то там,
точка плюс сторона.
Значит все, что я нарисовал, точно вложено в m1 плюс m2.
Почему это ровно m1 плюс m2?
Ну давайте думать.
Так что давайте, предположено, мы как-то шли-шли-шли,
давайте какой-то префикс, что мы нарисовали правильно, в какой-то момент ошиблись.
То есть например, вот эти стороны правильные
это реально стороны m1 плюс m2.
А дальше мы нарисовали какую-то чушь.
То есть, например, я шел-шел-шел, и там что-то нарисовал.
Потом нарисовал, скажем, вот это вот.
Это то, что мы нарисовали.
А настоящая правильная сторона m1 плюс m2 какая-то другая?
Например какая-то такая, да, настоящая сторона.
просто сторона. Да. Такой картинки быть не может. То есть не может быть такое, что мы нарисовали
вектор более выпуклый, да, смотрящий вовне по сравнению со стороной m1 плюс m2. Поэтому такой
картинки не бывает. Плохое, что могло произойти, это наоборот, когда мы нарисовали более внутренний
угол по сравнению с правильной стороной m1 плюс m2. Давайте докажем, что такого тоже быть не
может. То есть внутри этот вектор лежать не может, потому что как раз мы только какую-то вложенность
рисуем. То есть мы нарисовали алгоритмом, нарисовали что-то вложенное в m1 плюс m2. Значит может быть только
то же самое. Нет, правильный вопрос на самом деле, но по той же причине. Смотрите, вот если мы
нарисовали что-то вот такое, то смотрите, если вот где-то здесь, если в правильном ответе где-то
здесь сторона, то значит мы нарисовали что-то не лежащее внутри. Такого быть не может. А если
правильная сторона куда-то вот туда уходит, то это не выпуклый ногоугольник. Ну гипотетически,
если вдруг правильная m1 плюс m2 содержит вершину где-то на стороне, то есть она уходит либо туда,
либо сюда, то это бред сразу. Потому что внутри она быть не может, а вне нарушилась бы выпуклость.
То есть мы по сути смотрим первое расхождение, пересечение m1 плюс m2 с тем, что мы получили,
и говорим, что это должна быть вершина вот из этого. Да. И дальше вершина. Да, да, да, да, да. Вот,
значит, вот картинка, например, такая. Давайте поймем откуда все вот это взялось. Давайте
рассмотрим предыдущий вектор. Он будет не нужен, но неважно. Значит, вот эта точка мы ее нарисовали
как сумму чего-то из m1 плюс m2. Пусть это была точка какая-то p плюс q. То есть у меня был
какой-то вектор, какой-то угол в ногоугольнике m1, был какой-то угол в ногоугольнике m2. Я нарисовал
сумму этих двух точек вот здесь вот, и дальше в алгоритме нарисовал вот эту сторону. Ну что это
за сторона? Это наименее крутая из вот этих двух. Ну давайте как-то более явно это выражу. Пусть
вот здесь такая сторона, здесь такая. Да. Ну и наш алгоритм нарисовал соответственно что-то вот такое.
Поскольку я в качестве стороны выбираю одну из следующих сторон, да, в качестве стороны
результат выбираю одну из следующих сторон, понятно, я выбрал вот эту вот. Давайте назовем
вот эти стороны. Пусть это будет u, вектор u, это вектор v. Поскольку я нарисовал u, а не v, то в
частности это означает, что векторное произведение u на v, да, положительно, ну не отрицательно,
потому что поворот как раз, поворот от u к v идет против часовой, то есть положительный,
поэтому я сначала рисую u, потом когда-то в будущем нарисую v. Так, хорошо, значит вот этот вектор
это вектор u. Мы его вот тут нарисовали. Окей, но при этом мы считаем, что есть какая-то сторона в
правильном m1,2, здесь есть какая-то сторона. Но давайте скажем, что вот эта точка это x плюс y,
где x точка где-то внутри вот этого многоугольника, y точка где-то внутри вот этого многоугольника. Ну
потому что это сумма двух точек из m1,2, значит x где-то в этом углу, y где-то в этом углу. Вот,
ну и тогда вроде понятно, что раз v это самый крайний угол, ну как бы самый крайний вектор в том
направлении, здесь u самый крайний вектор в том направлении, то сумма вот этих двух векторов,
она не может выходить правее, чем u. Формально более-менее. Почему? Значит смотрите, поскольку
у меня x лежит внутри m1, то в частности я могу написать, что векторное произведение px на v. Нет,
это не хочу, давайте вот здесь нарисую. Вот здесь qy на u, здесь поворот идет почасовой,
поэтому штука отрицательна. Ну потому что y лежит внутри такого угла, поэтому направление
на этот вектор идет почасовой. Более того, если я здесь же нарисовал бы вектор u, то у меня здесь
было бы тоже самое, потому что v еще левее, чем u, поэтому векторное с px на u тоже меньше оно нуля.
Ну и дальше, поскольку у меня векторное произведение на самом деле линейно,
чего мы не доказывали, но это верно, можно просто по определению расписать. Тогда можно написать,
что векторное произведение суммы тоже меньше оно нуля. Ну а это как раз вот этот вектор,
значит он лежит где-то вот здесь вот, он не может быть правее, чем u. То есть вот тот как раз вектор
px плюс qy, вот этот вот вектор, он обязательно лежит левее, чем u, потому что векторное произведение такое.
Все. Ну все, спасибо. Мы доказали, поэтому наш алгоритм корректен, за n плюс m умеем
строить Минковского. Конец.
