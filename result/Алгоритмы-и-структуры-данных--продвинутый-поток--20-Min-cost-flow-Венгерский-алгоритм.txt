Но на этот раз обратите внимание, что интересно, стоимость бывает отрицательной.
Да, то есть иногда некоторые дороги очень хотят, чтобы по ним кто-то ехал.
То есть типа я труба, я хочу, чтобы у меня текла вода, я готов за это доплачивать.
Вот, такая вот типичная ситуация тоже вполне возможна.
Но она, в общем-то, в перспективе будет для нас и неиспешной.
Итак, теперь о каждом ребре пока будет писаться 5 и соответственно еще стоимость.
То есть получается, что ограничение на прописную способность никто не отменял.
То есть мы говорим, что по этой трубе может течь не более чем 5 единиц жидкости,
но за каждую единицу жидкости, которая течет, мы будем платить 7.
Ну, каких-то там условных единиц.
Ну, то есть если по этой трубе будет течь, скажем, 3 единицы потока, то мы заплатим 21 конкретно за эту трубу.
Если 2, то 14. Если 3,5, то, соответственно, там сколько? 24,5.
Ну, если будет течь там 3,5 машины.
Ну, здесь прописные способности у нас все такие.
Но вполне вероятно, что иногда за каждую машину будут доплачивать, но верхние ограничения никто не отменял.
Вот, 4.
Ну, тут если вот так.
То есть 4,2,1,3,4.
1,2,3.
И стоимости тут может быть абсолютно какие-то.
2,3,5.
1,5,3,2,1.
Ну да.
Вот.
Вот.
15.
Вот.
Что нам теперь, какую задачу нам теперь хочется решить?
Ну, конечно, оставая задачу, которую обычно хочется решать, это максимальный поток минимальной стоимости.
То есть, как бы формировку, то есть, или вот формировка называется mean cost max load.
То есть, что это означает?
Мы хотим найти максимальный поток.
Но, как мы помним, максимальный поток, он один только по величине.
Но самих по себе максимальных потоков, как функции, их может быть огромное количество.
Поэтому из них нам надо выбрать тот, который имеет минимальную скорость.
Да, правда, сразу возникает естественный вопрос.
А он существует вообще?
Да.
Почему?
А почему нет?
Потому что не может быть.
А вдруг существует, а вдруг это там что-нибудь типа недостижимая точная нижняя край?
Ну, то есть, понятно, что стоимости потоков ограничены снизу, безусловно?
Да.
Да, но вдруг существует какая-то точная нижняя край, и как бы сколь угодно близко к ней поток существует такой стоимости, а вот само этой нижней край не существует.
Потому что если у нас есть функции потоков, то можно этим пределы взять.
Это, короче, замкнутая множество.
Ну да, как всегда.
Или просто начать ругаться какими-то словами типа compact.
Ну да.
Да, совершенно верно.
Не искать, что если нашли сточности депсовум, то дальше не надо.
Думаю, нет, хватит.
Ну, как-то так.
Если поток сточности депсовум может не совсем, то оно не существует.
Вот, хорошо.
Ну, теперь вот весь такой вопрос.
Как его найти?
На самом деле, тут начинаются подлянки.
Вот, как бы очень часто, вот когда говорят о декомпозиции потока на пути, забывают, что вообще поток декомпозируется на пути и циклы.
Конечно, когда вы пишете декомпозицию на пути, то цикла вам не сильно принципиальна.
Потому что, в общем-то, если вы циклы этих забыли, то стой, то величина потока не поменялась.
Теперь это не так.
Потому что здесь оказывается, что иногда по циклу пустить поток очень вполне себе выбирано.
Потому что оказывается, казалось бы, какой оптимальный поток будет величиной 0?
Казалось бы, просто никого не трогай.
Но нет, это не так.
Потому что оказывается, что если я вот здесь пущу поток вот такого рода, то у меня получился вполне себе цикл, и у него будет суммарная стоимость минус 9.
То есть, на каждый прокат по этому циклу, собственно, одной машины в холостую, мы будем получать 9 условных единиц.
Ну вот, получать поток это минус 9, это круче, чем ничего не делать.
Поэтому оказывается, что циклы действительно такое могут быть.
Правда, забегая вперед, скажем, что мы этот минимальный поток все равно будем искать в предположении, что, по крайней мере, изначально циклов отрицательного веса нет.
Но тем не менее, даже в этом случае, да, обычно алгоритм, который это делает, он на самом деле всем известен.
Скорее всего, вы его даже писали.
Ну, кто хоть раз в жизни Минхоз писал хоть в каком-нибудь виде?
Нет, я сейчас не претендую на ДДХ с потенциалами.
А, не все, да?
Окей, а кто о нем слышал?
Я слышал.
Нет, просто не слышал.
Да, в смысле, да только что, или?
Слишком долгомучно в отмоге пить.
Обысками.
Понятно.
Ну вот.
Правда, в любом случае, хорошо.
Но, действительно, классический алгоритм поиска Минхоз говорит, что, если у вас изначально в графе нет циклов отрицательного веса, то идея очень простая.
То есть, мы просто запускаем поток, ищем формы Фолкерсона, но на каждом шаге находим от СТ кратчайший путь, на этот раз по стоимости.
Не пихай.
Все, нужно отрицать.
Почему это работает?
У нас было важно, чтобы он был кратчайший.
Нет, это не было важно.
Нет, сейчас важно, что не по кратчайшему количеству ребра, теперь важно, чтобы он был именно минимальной пастой.
Ну, то есть, это будет максимальный поток, потому что метод Фолкерсона предполагает, что вы можете пихать вообще как угодно.
Ну, конечно же, имеете в виду остаточное сеть, то есть, если вы пихнули, у вас течет вода вот сюда, то вы имеете право в следующий раз пройти по этому ребру в обратную сторону за стоимость минус 5.
Разве что метод Форда Фолкерсона не работает?
Не работает.
Не исходится.
Проблема.
Вот утверждается...
Но придется нам остановиться в этот раз до утверждения, что если он сойдется,
если он сойдется,
то тогда он найдет, ну, в данном случае, минимальный, максимальный поток.
Мы просмотрели, что он сойдется.
Нормально.
Нормально.
Существенно, это все всегда понятно.
Правда ли, что он может не сойтись?
При том, что мы ищем минимальный по стоимости путь.
Искали минимальное по стоянии, нам это помогло, спасло.
Ну да, ну, не знаю, не знаю.
Будем думать.
Ну, в данном случае, смотрите, так.
Ну, тут надо говорить о том, что на самом деле существует этот кратчайший путь.
В смысле?
Да еще, просто интересный факт.
У него в всяком графе существует кратчайший путь?
Да!
Прикинь?
В смысле, ассоциация цикла?
Да.
Ну, нет.
Ну, если не будем создавать.
Это из отчаяния?
Нет.
Вот, мы их не будем создавать.
Появиться не могут.
Вот.
Нет, не могут.
Вот.
Не могут.
Ну, в смысле...
Да, на самом деле, да, не могут.
Но это не трибиальный путь.
Ну, конечно, но это не то, что нам мешает.
Да, просто интерес будет в том, что мистическая свойство будет заключаться в том, что цикл отрицательного веса просто не будет появляться.
Ну, вот.
То есть, мы этим будем даже пользоваться.
То есть, можно было пройтись по нему.
То есть, увольте, что если нет циклов отрицательного веса, то можно вообще там ввести потенциалы, искать, как я шикую путь, потом дэкстрить.
Помните потенциалы Джонсонов?
Я помню, но...
Ты сейчас как-то очень резко скакнулся.
Сразу до самого нормального, самого крутого гритма.
Ну, это...
Ну, как?
Ну нет, то есть, самый крутой, как минимум, полиномя или...
Потому что то, что мы ищем, оно работает за, как бы...
Условно, там...
Называется размер, это величину максимального потока, на, там, за сколько вы там ищете, короче, ошибок.
Я ищу он еще раз.
Вообще?
Ну, проталкиваю.
Проталкиваю, вроде чего.
Проталкиваю, да.
Мне так кто-то сказал.
Может быть.
Ну, может быть.
Мне он, по крайней мере, не известен.
Нет, ну понятно, что есть.
То есть, я знаю, что, как минимум, есть алгоритм, который ищет этот Минкос за полинома ТВЕ.
Как вы разговариваете?
А вот его я не знаю.
Я знаю, что он существует.
Да, вот не все следует.
Ну, хотя вот я не знаю.
Чем бы закончилось, еще месяц...
Ну, черта месяца надо заниматься, можно и есть.
То есть, мы сейчас вообще не умеем искать поток минимальной скорости на нецелочистных играх.
Нет, на нецелочистых...
Ну, по модулю сходимости.
Нет, даже если сходится, мы можем с нецелочистской скоростью проделать.
Ну, получается, да.
Ну, в смысле, для F все нормально.
Вопрос в том, что у нас зависит от увеличения потока.
Это плохо, может быть.
Ну, нет, не совсем.
Но, как вы помните, поток может не сходиться к максимуму.
Это отдельно для меня, да.
Так что, увы, да, не все так просто.
То есть, нас в этом смысле начинает выручать только то, что в подавляющем большинстве случаев,
конечно же, попустые способности все целые.
Ну вот, поэтому все как всегда.
Ну а теперь, значит, это было краткое содержание...
Да, это было краткое содержание того, что мы сегодня представили.
Значит, теперь подробнее.
На самом деле, конечно, в первую очередь, конечно, математически удобнее искать, конечно, не мелкост,
а такое понятие как циркуляция.
То есть, минимальная.
Вот нам будет интересно найти минимальную циркуляцию.
А мы знаем, что это?
Первое, что нужно для этого сделать, это узнать, что это.
Определение очень простое. Циркуляция – это поток величины 0.
Все.
Минимальная циркуляция – это что?
Минимальная циркуляция – это поток величины 0 минимальной стоимости.
Все.
Не путаем величину потока и стоимость потока.
Мы же отказались от циркуляции.
Да, мы отказались.
Но минимальную циркуляцию как раз мы будем искать произгонно.
Почему стрелочек двойные нарисованы?
Ну, это потому, что они взаимосвязаны.
Нет, дело в том, что я утверждаю, а это даже не важно,
я утверждаю, что даже не важно, отказались мы от циклов или нет,
на самом деле утверждается так, что если мы научимся искать минимальную циркуляцию
каким-то мистическим образом,
то мы научимся искать максимальный поток минимальной стоимости.
В любом грани уже.
Абсолютно в любом.
Абсолютно в любом.
Светение очень простое.
Я его могу даже просто показать.
То есть мы просто проводим, как скрести поток в циркуляцию.
Бесконечная пропускная способность.
И бесконечная стоимость.
Да, но важно, смотрите, пропускная способность плюс бесконечность.
Плюс бесконечность.
Да.
Самая выгодная ребра на призовании.
Потому что нам нужно, чтобы поток был сначала максимальный, а потом все остальное.
Да.
То есть нам нужно, чтобы по этому ребру цикло как можно больше.
Понятно, что вместо минус бесконечность надо подобрать достаточно большое число,
настолько большое, чтобы оно перевесило все, что тут может быть.
У меня там в презентации были оценки какие-то.
Минус три на е, на пост.
Это вы сами можете подогнать.
Я думаю, суть уже и так, парни.
Вот такая красота.
То есть действительно видим, что поток так сводится к циркуляции.
То есть теперь, по сути, любая машина, которая ехала из СТ,
быстренько открывает окно,
соответственно, спускается по пожарной лестнице,
поднимается к себе, открывает окно, вылезает и приветит к тете Любу.
Ну, то есть, если какая-то вредная консьержка не пускает крестей,
то можно таким образом выйти.
Но для этого вам нужна там эта добрая девочка, живущая в этом поместье.
Ну, видели эту кириллашу, я думаю?
Нет.
Смотрите.
Вам понравится.
Ну, вот.
Ну, вот.
Ну, вот.
Ну, вот.
По принципу.
Это интеллектуально, да?
Вот.
Значит, вот.
Так что таким образом.
То есть, если мы сейчас научимся искать минимальную циркуляцию,
то мы найдем и максимальный поток минимальной стоимости автоматически.
Итак, давайте, как минимум, в принципе, искать минимальную циркуляцию.
Каким образом?
Мы просто добавим такое ребро и найдем поток уже в этом игре.
Не только циркуляцию.
Циркуляцию.
Ну, вот.
Нет.
Если мы знаем циркуляцию, как мы найдем минимальную?
Возьмем эту циркуляцию и выкинем вот это ребро.
Утверждение.
Это и будет максимальный.
Останется поток, и он будет максимальным.
Хорошо.
Так что нам тут будет вот это максимально.
Ну, а теперь у нас есть какой-то вопрос.
А что такое минимальная циркуляция вообще?
Ну, и что такое, понятно?
Вопрос.
Какая она?
Она минимальная.
Да.
А есть ли у нее еще какие-то свойства?
Ну, вот.
Ну, есть у нее приятные свойства.
Нет.
Цельного цикла достаточно.
Да.
В, значит, циркуляция минимальна.
Да?
То есть, вот, есть ли у нас циркуляция минимальна, да?
То, оказывается, то, значит, из этого следует, что в остаточной сети...
сети
нет
цикла отрицательного веса.
Ну, очевидно.
А если такой цикл есть, пустим по нему машинку и получим более, меньше циркуляции.
Понимаете?
Ну, вот.
Так вот, собственно, мистическое утверждение.
Ну, действительно, как-то логично.
Причем у нас в форде-форке Sony тоже оказывалось, что если в остаточной сети нет пути, то поток оказывается максимальный, да?
Значит, возьмем к слову о цикле.
Ну, в состоимости они-то тоже самые.
Ведь, действительно, рассмотрим...
То есть, действительно, рассмотрим какую-нибудь циркуляцию, пусть она не минимальна, да?
Тогда, значит, в ней...
Тогда внутри этой остаточной сети можно запустить циркуляцию отрицательной стоимости.
Ну, это не очевидно.
Ну, точнее так.
Смотрите.
Жила была циркуляция A, жила была циркуляция B.
И была минимальна.
То есть, в сети G у нас была циркуляция A и циркуляция B.
Тогда я утверждаю, что в циркуляции G-A, то есть в остаточной сети относительно циркуляции A,
существует, так сказать, вот я, может быть, в кавычах напишу, B-A.
Ну, может быть, так сказать.
Ну, скорее, минус.
Только если A и B, это, что, это ли буквы?
A и B, это циркуляция.
Так, ну ладно.
Какие-то, любые пока.
Я пока говорю просто по любые циркуляции.
Вот.
То есть, что такое B-A?
Это, значит, по каждому ребру должно течь воды, равная, сколько течет тут, минус, сколько течет тут.
Ну, легко показать, что действительно это корректно.
Ну, очевидно, что, во-первых, это циркуляция.
Ну, значит, эта циркуляция, это корректная циркуляция именно в этой сети, правда?
Это понятно?
Ну да.
Это вот с ребром или без ребра?
Нет, циркуляция, это поток.
Мы забыли про то сведение.
Все, все, забыли.
Мы просто живем про циркуляцию.
Все, про поток мы забыли.
Время-то, конечно.
Про поток мы забыли.
Мы говорим просто про абстрактных циркуляций.
И мы говорим, что если у нас есть циркуляция A и циркуляция B, то в остаточной сети же A, относительно циркуляции A, есть циркуляция B-A.
А мы вот тоже сверху, в правую сторону уже доказали?
Ну, это очевидно.
Потому что, смотри, представь себе, что у тебя была циркуляция, а в остаточной сети образовался цикл отрицательного веса.
Остаточная сеть в том же смысле, в котором раньше.
Да, абсолютно.
Но тогда ты можешь пустить по этому циклу еще поток.
Да, но если как бы была циркуляция, то ты еще в циклу поток пустил.
Циркуляция осталась циркуляцией, правда?
Да.
Ну и стоимость ее строго уменьшилась.
Отрицательного веса отрицательной стоимости.
Отрицательного поста.
А пропуск на инстинкту?
Ну, как всегда, там должно быть положительное, конечно.
Ладно, давайте так, циклов отрицательного веса на ненасыщенных ребрах.
Хорошо, давайте, раз уж у нас так принято писать, давайте так писать.
Ну и мы же считаем, что если у нас есть ребро в обратную сторону, ребро вес минус ц.
Да, безусловно.
Ну, конечно же, если вы хотите, если стоимость проезда какой-то машинки была 5 и вы хотите ее отменить, то, наверное, стоимость отмены должна быть минус 5.
Конечно, конечно, конечно.
Вот.
Итак, понятно, что такое циркуляция б минус а?
Да.
Понятно, почему она восточность не существует, да?
Да.
Вот.
Ну теперь интерес такой.
А теперь предположим, что b минимальная циркуляция, а a не минимальная.
Тогда заметим, что вот у этой циркуляции стоимость меньше нуля.
Ну она потому что у нее стоимость будет тоже по стоимости b минус а, правда?
Да.
А теперь детическое утверждение.
Любую циркуляцию можно декомпозировать на циклы.
Ну, можем, конечно, вылить воду из чайников, доказать, что любой поток можно декомпозировать на пути и цикла, а пути и не будет, потому что у нас от циркуляции поток вылечены ноль, значит, декомпозиция на цикле.
Ну вот.
Ну, на самом деле, а можно и просто, как всегда, с чайником, если хоть по какому-то ребру что-то течет, значит, мы тут говорим, что так, раз текло, значит, вытекло, значит, вот сюда, раз текло, то вытекло и так далее, идем-идем, пока не зациклимся, а мы зациклимся, потому что у нас количество, это совершенно конечное.
Вот, все, нашли цикл, по которому течет вода, отменили поток по нему, повторили операцию.
Ну, смотрите, и так мы декомпозировали поток на, то есть декомпозировали нашу цикуляцию на циклы, видите, да?
Декомпозировали поток на циклы, но так как их суммарная стоимость этих циклов меньше нуля, то мы вынуждены заключить, что у одного из этих циклов стоимость меньше нуля.
Все.
То есть следовательно мы показали, что если цикуляция не минимальна, то в остаточной сети найдется цикл отрицательного, в смысле отрицательной стоимости.
Вот, примете, да?
Вот.
Сейчас, а можно еще раз повторить, что у нас такое бэминса? Это мы просто взяли вот цикуляцию В и...
У бэминса, ну то есть...
Ну, это, ну смотрите, вот у нас были ребра изначально, да? И были обратно еще ребра в второй пропускной способности ноль, да?
Вот.
Ну да, там, конечно, немножко удвоение получится, но не суть.
Вот.
И, значит, мы говорим, что если у нас, допустим, было ребро какое-нибудь, ну то есть в остатке, то есть если у нас было ребро, допустим, один...
Так, ладно, давайте, допустим, было три, пропускная способность была, там, я не знаю, 57, да?
И если мы решили пустить по нему неожиданно поток величины два, то что у нас тогда получается?
Тогда у нас остается, тогда в остаточной сети у нас остается следующее, что у нас тут есть один и, соответственно, 57, но есть обратное ребро.
Пропускной способности, соответственно, два и стоимости минус 57.
Это вот та самая отмена потока.
То есть это вот как у нас строится остаточная сеть.
Вот.
Ну вот, а теперь говорим следующее.
Это вот как у нас строится остаточная сеть.
Вот.
А теперь говорим следующее.
Ну вот.
Ну это строится остаточная сеть.
Ну а теперь заметим следующее, что вот чем отличается циркуляция А от циркуляции B?
Они отличаются в следующем.
Что?
Может быть так, что по какому-то ребру, например, в циркуляции A течет две единицы потока,
а в циркуляции B по этому же ребру течет три единицы потока.
Значит, в остаточной сети в циркуляции B- будет, вот поэтому ребру течет та самая одна единица потока.
А может быть, наоборот, поэтому ребру в циркуляции A течет две единицы потока, а в циркуляции B одна.
Или даже наоборот, ноль давайте, ноль.
Тогда наоборот, тогда в этой циркуляции B- в A у нас по вот этому ребру будут течь две единицы потока.
Вот что такое циркуляция B-.
Ну если тут один и тут два, то тут должно течь один.
А если тут два, тут ноль, то тут вот здесь течь два.
Именно вот здесь течь два.
Так что вот такая красота.
Но как вы скажете, если она не минимальна, то...
Ну если не минимальна, то тогда в остаточной сети A найдется циркуляция отрицательной стоимости.
Ну потому что берем минимальную циркуляцию и вот у них по имени Саш считаем, да?
Ну вот, это циркуляция отрицательной стоимости.
Мы ее декомпозируем на циклы и говорим, что стоимость этой циркуляции это сумма стоимости этих циклов.
Ну нормированная, там умножить на сколько там потока по этим циклам текет.
Но раз сумма отрицательна, значит какое-то слагаемое отрицательное.
Хотя бы одно.
Следовательно, найдется цикл, у которого стоимость отрицательна.
Ну стоимость умножить на поток, но поток положительный, поэтому отрицательный.
Так что вот такая красота.
Да, тут пока все просто, да?
Вот.
Ну тогда на самом деле получается, получается на самом деле, называется такой аналог метода forDefault300.
То есть, которая предлагает, то есть идея говорит следующее.
А давайте просто, то есть как искать теперь минимальную циркуляцию?
А искать ее так, берем первый попавший, там есть, так думаем, есть ли в графе цикл отрицательного веса?
Если есть, находим его, пускаем по нему поток, повторяем операцию.
И так делаем пока такой цикл найдется.
Если не найдется, то значит ура.
Мы победили, мы нашли минимальную циркуль.
То есть как это можно делать?
На самом деле, то есть есть на самом деле метод клея, да?
Который предлагает это делать достаточно аккуратно.
Значит предлагается это делать вот аккуратно.
Вот давайте пока, допустим, для простоты, предположим, что все ребра единичной пропускной способности.
Да, да, да, да, вот.
И делать будем тогда так.
Изначально, значит у нас изначально, изначально, изначально, изначально.
Есть в графе.
И мы удалим все ребра.
И будем добавлять ребра по одному.
И пропускать, возможно, какие-то циклы.
С той целью, чтобы у нас были пропускные, чтобы у нас не было в остатке сети циклов отрицательной весы.
Ну, изначально база выполнена.
Тут циклов отрицательной стоимости нет, потому что нет ребра.
Вот.
Идея теперь будет следующей.
Представим себе, что у нас есть какая-то сеть.
А точнее, у этой остаточной сети есть пропускная способность.
Пропускная способность.
Вот такая какая-то.
Вот.
Это остаточная сеть.
Да.
Пусть это именно остаточная сеть.
Это, так сказать, GF.
И мы в нее добавляем новое ребро УВ.
То есть способности 1.
Допустим, вот.
Не, не допустим.
Ждать на прицетном и еще обратно.
Ой, да, да, да.
Так.
Ну давайте, ну я не знаю.
Вот добавили новое ребро.
Мог ли появиться от добавления этого ребра циклов отрицательной стоимости?
Да.
Ну да, вполне что бы и нет.
В данном случае нет.
Да, в данном случае нет.
Ну давайте, хорошо, давайте.
Это-то мы проблему решим.
Вот.
А мог появиться.
Но что для нас сейчас приятно?
Приятно для нас сейчас то,
что если у нас такой цикл отрицательной стоимости появился,
то он обязан проходить через это ребро.
Ну, возможно, через еще как-то.
А как же нам это понять?
Существует ли такой цикл, проходящий через УВ и отрицательный?
Можно хоть алгоритм, но в пути.
Но идея очень простая.
Ведь действительно, вот в черном вот этом графе,
в том, что было до добавления ребра, да,
не было циклов отрицательной стоимости.
Так, естественно, когда я говорю о расстоянии,
я имею в виду расстояние только по не насыщенным ребрам.
Я думаю, вы понимаете.
Понимаете?
Угу.
Да переча.
Ничего.
Идем.
Находим.
Расстояние.
Ну вот, то есть теперь идея такая.
Давайте, ну вот, то есть у нас нет циклов, но есть расстояние.
Так вот, давайте попробуем найти в этом графе
расстояние между вершинами В и У.
Расстояние не в количестве ребра, а в сумме стоимости.
Конечно.
То есть минимальный путь.
То есть если этот путь плюс наше ребро оказался больше либо равно нуля,
то цикл отрицательного веса не появился.
Ну потому что то, что мы нашли, это вообще минимальный цикл с участием этого ребра.
Вот.
Ну вот.
Ну могло так оказаться, что нет.
Это все-таки оказался цикл отрицательного веса.
Ну тогда идея такая.
А давайте тогда по этому циклу, эту единицу потока и пустим.
Теперь эта ребра насыщена?
Ну не совсем, не совсем.
Тут как бы хочется сказать, что мы победили, других циклов не появилось.
Но с другой стороны заметим, да, что допустим пока можем гарантировать, что убилось это ребро.
Да, это обратное появилось.
Да.
Но помимо него появились еще вот эти вот обратные ребра.
Ну что?
А вдруг с их помощью неожиданно появились какие-то циклы отрицательного веса уже в другой части игры?
Нет.
Не запущаю.
Да?
А почему?
Вот почему они не появились?
Иначе мы в начальном графе не были.
А почему это?
В изначальном графе этих ребер не было, теперь они появились.
Там могло появиться ликро?
Нет.
А почему они не появились?
Иначе мы в начальном графе не были.
А почему они не появились?
Там могло появиться ликро?
Ну, через него не будет цикл, потому что если через него сейчас нет цикл, то существует более короткий путь от Ведаума.
Ну, условно...
Нет, погодите, погодите, погодите.
Нет, сейчас вот, я...
Вот этого ребра не было.
А сейчас она есть.
И чего?
То есть если сейчас, может быть конкретно сейчас существует более короткий путь от Ведаума, но без черных ребер?
Нет, пусть у нас появился какой-то путь...
Пусть появился цикл.
Пусть появился какой-то цикл отрицательного веса.
Да.
Да, он должен был задействовать в какой-то забратной графе.
А не УВ.
Так, обязательно.
Ну, допустим, да, вот.
Давайте его влезем в цикл.
Давайте.
И как-то там ушел цикл.
Да, как-то шел.
Как какой-то вот такой цикл, и вот это красненькая ребра.
Вот тогда существует более минимальный по весу цикл, чем тот, который у нас есть у УВ.
По идее.
Да, но может быть в нем задействованы еще несколько красных ребер?
Давайте.
Ну, если только одно красное ребро задействовалось в этом цикле.
Если только одно окрасное веково, то у вас существует путь от В до нижней части, до нижней вершины, это веревра.
Путь, напоминаю, у нас там шел как-то вот так.
Вот сюда, вера тут была.
Правда, вот это пересевщение вот этого и вот этого может быть и более.
Да, но если оно такое-то реальное, то вот этот путь, который есть центральная веревра совсем, он лучше, чем, который мы нашли его.
Ну да, ну да, то есть действительно мы обнаружим, что если это цикл отрицательного веса, то есть мы знаем, что это ребро тогда по стоимости меньше, чем сумма вот этого всего.
Если осматривать эти ребра вот в эту сторону.
Тогда непосредственно перед проталкиванием, да?
То есть мы по этому пути явно могли пройти в другую сторону, правда?
Почему? Ну потому что он состоит из тех ребер, которые не трогались, то есть по которым вода не протекла и так далее, ну вот.
Нет, хотя нет. Сейчас, погодите.
А что с красными-то?
Нет, ну я, нет, тут хочется сказать, что...
Можно же по-другому это сказать.
Как, давай.
Вот мы пихнули первый путь от VEDA-U, первый цикл от VEDA-U.
Да, и после этого нашелся вот этот.
И после этого оно уменьшилось, наша стоимость и меньшность.
Потом мы пихнули вот этот правый цикл. Стоимость еще уменьшилась.
И что?
Значит, ну когда мы его пихнули, мы по сути отменили отрибро.
То есть итоговая стоимость и квалентно, ну квалентно нашими ногами.
И она меньше, чем то, что мы взяли.
Ну да.
Ну да, то есть действительно заметим, что если пихнуть поток VEDA вот этот путь и этот цикл,
то у вас получится какой-то поток величины 1, вы можете декомпозировать на то ли путь, то ли путь и цикл.
Но если, причем в исходной сети, обратите внимание, да?
И тогда, если вы можете декомпозировать на путь, то получается путь не был как чаще.
А если декомпозировать на путь и цикл, то получается, что цикл отрицательного веса там все-таки будет.
Это если у нас нескольких красных ребер на цепле или это неважно?
Что-что?
Цикл нескольких красных ребер на цепле.
Не важно, какой поток меньшего.
Не, а нам неважно поток.
Нам, ну вот, то есть мы говорим, что мы его пустили, предположим, что нашелся цикл отрицательного веса.
Просто вообще.
Даже не важно, что он там прицеплен к этому пути, не прицеплен, не важно.
То есть, допустим, что после того, как мы по этому пути пустили поток, у нас все еще есть цикл отрицательного, ну вот.
Ну вот, по этому циклу пустили поток, да?
Пусть неожиданно выяснилось, что в графе все еще есть цикл отрицательного веса.
Тогда что получается?
Получается, оказывается, следующая штука.
Значит, что, действительно, что этот путь может декомпозировать на, видимо, не более чем два цикла.
Путь какой?
Ну, цикуляцию, короче.
Надо про суме в две цикляции.
Ну вот, один цикл, вот этот, через УВ.
А второй через, ну второй, да, заметим, что он, заметим, что как бы, ребро от УВ первый цикл убил.
Да.
Поэтому, может быть, второй цикл, конечно, отменил этот, это УВ, да?
Это ВУ.
Но тогда, но вот, но тогда это будет немножко странно.
Не может, если убил, то раньше тоже спел цикл отрицательного веса.
Ну вот, тогда получается, что да, действительно, нот как тот.
Грайс существовал.
Да.
Да, придет нот.
Ну, хотя, я не знаю, но...
Нет, тут другая подлянка.
Может быть, вот это и есть отрицательный цикл, они друг друга тупо отменят?
Вот это просто...
А, ну, хотя с другой стороны, да.
Ну вот, просто, ну да, тут, нет, у нас есть просто доказательства, тут аккуратно,
просто если совсем формализовывать, то просто приводится к следующему.
Что, допустим, после того, как мы пустили вот по этому циклу, нашелся еще один цикл, да?
И тогда объединение и бомба, да?
И тогда объединение и двух циклов, это циркуляция, которая декомпозируется на,
вот почему-то нам кажется, не более чем два цикла.
Да, отдельно, просто почему не более чем два?
Ну вот.
Ну, это вообще...
Не важно.
Ну да, на самом деле не важно.
Ну, не важно.
Для нас просто нет.
Возникает такой интересный случай, а не декомпозируется ли она на ноль циклов?
Нет, потому что иначе это циклы обратные.
Да, потому что нет, потому что заметим, что важно, что циклы обратные,
потому что нет, потому что заметим, что важно, что оба цикла отрицательного веса.
То есть это означает, что циркуляция не тривиальная.
Вот.
Ну вот.
А теперь замечаем, что, да, есть ли эти циркуляции...
Ну да.
То есть, конечно, эти два цикла могли, конечно...
То есть теперь вот на секретный вопрос, у нас вот по этому ребру В вода течет или не течет?
Если вода не течет, то получается, мы и без этого ребра нашли циркуляцию,
отрицательную циркуляцию, то есть отрицательный цикл третьего речи.
Вот.
Ну правда, с другой стороны нам...
Ну вот.
Но тогда получается, что...
Значит, так как у нас...
Ну вот.
Тогда получается, что по этому ребру вода течет.
Понимаете, да?
Но тогда у нас итоговый цикл получается либо один, либо несколько.
И заметим, что только в одном из этих циклов по этому ребру течет вода,
потому что у нас единичные стоимости напоминаем, да?
И тогда отсюда получается, что если цикл больше, чем один, значит мы нашли цикл отрицательной стоимости,
а если эти два цикла дали один цикл,
то тогда получается, что мы там от В до У, видимо, нехорчайший путь нашли.
Все это было, да?
Ага.
А что мы делали?
Что-то вообще все забылось абсолютно.
Что-то мы что-то строили, что-то добавляли.
Это было бы лектик смотреть, чтобы не забыть, что мы вообще делали.
А что мы вообще делали?
На совершенном мы по очереди рёбом добавляли,
и каждый раз пытаемся через рего найти цикл отрицательной стоимости.
Причем мы еще поняли, что все циклы отрицательной стоимости,
они не были в том числе, как у нас были.
Мы еще поняли, что все рёбра имеют этот цикл отрицательной стоимости.
Но зачем на самом деле?
Нет, это другой вопрос.
Ну, пока для простоты.
А у тебя будет стоимость такая же, как и изначально?
Ну, что лишается, что это могут быть и обратные книги,
что это остаточная сеть.
А так, так, конечно.
Значит, еще раз.
А то как это было?
Намы фор намы, Гжекаш прежвеждекеич.
Класс.
Ну, знаете, как называется?
Называется Допрос польского пленного.
И вот каждый раз спрашивают там имя, фамилия.
Гжекаш прежвеждекеич.
Чего?
Гжекаш?
Классика на самом деле. Популярно было.
Вот.
Ну, по этому слову, вот это вот АЧФ это мне как-то напомнило.
Значит, смотрите, еще раз.
Краткое содержание предыдущих серий.
Значит, смотрите.
Как мы пытаемся искать минимальную циркуляцию?
Мы пытаемся говорить так.
Мы добавляем ребра по одному.
И поддерживаем инвариант, что у нас никогда нет в ненасыщенных ребрах цикла отрицательной стоимости.
Добиваемся, мы пытаемся добиться этого так.
Значит, вот у нас есть остаточная сеть, в которой циклов отрицательной стоимости нет.
Мы добавляем новое ребро УВ.
И пытаемся из него привести цикл отрицательной стоимости.
Делаем мы это так.
Мы находим кратчайший путь от В до У.
Если вместе с этим кратчайшим путем цикл не получился отрицательной стоимости, значит циклы и не появились, очевидно.
А если он появился, то тогда мы по этому циклу упускаем единицу потока.
Утверждение.
После этого инвариант выполнен.
То есть цикл отрицательной стоимости в этой остаточной сети больше нет.
То есть вся остальная мистика – это доказательство этого абсурдения.
Вот до этого момента понятно?
Да.
Отлично.
До этого момента понятно.
Играем дальше.
Теперь доказательство.
Доказательство звучит так.
Итак, мы пустили вот этот цикл.
Заметьте, циркуляция от этого уменьшилась.
Предположим, что у нас где-то в этом графе, абсолютно неважно где, цикл отрицательной стоимости все еще нашелся.
Значит, тогда у нас получилась какая-то…
Ну, суммарно эти два…
Ну, пропихнем тоже.
И тогда у нас в исходной сети, вот до того, как мы вдоль ув пропихивали, получилась какая-то циркуляция отрицательной стоимости.
Суммарно, которую можно декомпозировать на несколько циклов.
Ну вот.
Но возникает вопрос.
Из скольких циклов она состоит?
Ну, как минимум, больше, чем из нуля.
Потому что у нас есть циркуляция отрицательной стоимости.
Больше, чем из нуля.
Потому что она отрицательная.
Вот.
Но, если существует хотя бы два цикла, то тогда хотя бы в одном из этих циклов не присутствует вот это ребро.
Логично, да?
УВ.
Да, УВ.
Ну, она…
Ну, логично, да.
Вот.
То есть, нет, это верно именно потому, что это единичный ребро.
Чтобы было бы не единичное, кстати, это могло бы быть неправдой.
Ну, там какой-нибудь тупой пример.
В духе, что вот была у вас остаточная сеть, вот такая единичная, да?
А потом, бам-бам, и появилось ребро прописной способности 2.
Видите, да?
Ну, это именно прописной способности, а вот по стоимости, вот зелененькой, тут оказывалось, что это там минус 5, а тут все красиво.
1.1, там 1.2.
Тогда одного цикла, одного пропуска не хватит.
То есть, как бы забирая вперед, то есть, когда стоимости будут бывать целыми, но больше, чем 1, нам, мы будем просто добавлять прописной способности прямо по единичке.
Это для нас будет важно.
Вот.
Вот.
Ну, пока единичка.
Значит, у нас все циклы, которые мы декомпозируем, имеют, собственно, по ним течет вода один.
И, как следствие, то есть, это означает, что эти циклы не пересекаются поредом.
Понимаете, да?
Значит, если циклов хотя бы два, то хотя бы в одном из них этого вибра нет, а это означает, что это цикл отрицательного, ну вот.
Нет, хотя нет.
Не так.
Сейчас.
Вот давайте так.
Вот в этой декомпозиции мы знаем, что эта декомпозиция у нас...
У нас эта декомпозиция сейчас отрицательной стоимости.
Вот мы ее декомпозировали на циклы.
Вот.
И, соответственно, давайте из этих декомпозиции выкинем все циклы...
То есть, и эта новая декомпозиция, она меньше, чем вот вес вот этого цикла, который мы изнасиловали.
Вот.
Тогда идея теперь такая.
Берем эту декомпозицию, и из нее выкидываем ноты, и из нее выкидываем все циклы не отрицательной стоимости.
Остается декомпозиции еще меньше.
Уже не строго, но меньше.
Ну вот.
Ну вот.
И тогда возникает такое.
Тогда вот у нас возникает в этой декомпозиции цикл отрицательной стоимости.
Если...
Если он не проходит через это ребро, значит он проходит только через черные ребра, и получается, что у нас в исходной циркуляции уже был цикл отрицательного веса противоречия.
Правильно?
Да, нет.
Сейчас черные это...
Которые были.
Перед добавлением красного ребра и проталкиваем вот этой воды.
Если цикл не проходит через ребро в В, то он проходит только через черные ребра, и получается, что у нас в исходной циркуляции уже был цикл отрицательного веса противоречия.
Да, нет.
И имеет отрицательный вес.
Имеет отрицательный вес, то...
Он был там и перед добавлением красного ребра.
Нет, не только через В, еще и через обратную.
А причем туда обратную?
Нет, мы же уже декомпозицию рассматриваем.
То есть мы добавили ребро в В, да?
И сказали, что вот этот синий цикл плюс еще какой-то найденный цикл отрицательного веса образуют в нем циркуляцию отрицательной стоимости.
А, стоп. Мы не пустили пока еще по...
Нет, ну как бы пустили.
А, пустили.
Пустили, но рассматриваем ее с точки зрения той сети, которая была сразу после добавления в В.
Ну как бы была сдаточная сеть.
Вот эта черная, да?
Мы в нее добавили ребро в В, пока ничего не сделали.
Да?
Потом после этого мы запустили поток сначала вот по этому циклу, а потом еще по какому-то циклу, да?
Это можно интерпретировать как вот в этой исходной сети мы запустили циркуляцию.
Понятно, да?
Именно эту циркуляцию...
Ну вот в этой циркуляции вот этого ребра...
То есть в этой сети вот этого ребра не существует.
Точнее не существует, но оно насыщенно.
В битоне, да?
Ну исходно.
Ну сразу после добавления ребра у В в сеть вот этого ребра не появилось.
Ну да.
Оно было насыщенно.
Поэтому, когда мы будем рассматривать эту нашу циркуляцию, вот этого ребра ни в одном из этих циклов не будет.
Вот этого, обратного.
Вот этого, обратного, да?
То есть вообще, на самом деле, циркуляция для нас, то есть более того, вот этих красных там тоже не будет.
То есть как бы, как в потоках, да?
То есть мы нашли поток, да?
То есть там остаточная сеть в данном случае...
Остаточность это была там какое-то какое-то свойство.
Ну да, не свойство, а там просто какой-то хак, который мы использовали для чего-то там.
А так мы просто нашли поток сети.
Все.
То есть мы вообще забываем это вместе даже о концепции обратной сети.
Так, забыли.
Значит, пока мы просто говорим...
Значит, пока мы просто говорим, что предположим, что у нас нашелся вот цикл, а потом, когда мы тут по нему пропустили, в остаточной сети еще там нашелся какой-то цикл, да?
То есть это означает, что мы говорим, что у этого цикла стоимость была, допустим...
Ну там, допустим, минус w, буду писать, минус для подчеркивания, что...
Ну ладно, не минус w, а минус там...
Минус х, да?
А если то, что у нас там нашелся еще цикл отрицательного веса в остаточной сети, это означает, что у нас образовалась циркуляция минус х и еще минус y.
Типа меньше, чем минус х.
То есть в этом графе есть циркуляция.
Еще меньше, чем минус х.
Вот мы сейчас... вот я утверждаю, что это неправда.
Вот я это доказываю сейчас.
Я окончательно запутался, что там ребра обратные, не обратные.
Сейчас, у нас же в остаточной сети есть обратные ребра?
Сейчас, у нас же в остаточной сети два цикла, один через w и второй.
Если мы их сложим, то там точно не будет по остаточным... ну по обратным ребрам идти.
Ну, тут скажем так, тут остаточная относительность чего?
То есть как бы в любой момент эта сеть является остаточная относительность чего-то, но давайте так.
Давайте считать, да приступим, будем говорить, что вот...
То есть у нас назовем g сеть, которая была перед добавлением uv.
Вот будем называть ее g и будем считать, что она не остаточная.
Вот, все.
Все, вот это сеть g.
Тогда у нас остаточная сеть g там какая-то появляется, только когда мы вот добавляем ребро uv и пускаем вот тут.
Тогда появляются эти обратные ребра, они лежат в этой остаточной сети.
И в этой остаточной сети еще цикл есть.
Отрицательного веса мы по нему пропустили.
Что это значит?
Тогда суммарно получается, что если как бы с этими манипуляциями, то в исходной сети g мы пропустили какую-то циркуляцию.
Только там ребра uv, вы сказали, не было?
Ну, да, ну это, ну можно сказать, что...
Ну, можно сказать, когда ребро uv было, но это не обратное ребро, это просто новое ребро.
Мы добавили ребро и пропустили циркуляцию.
Все, забыли о всех остаточностях.
Теперь, у нас есть циркуляция.
Она отрицательной в стоимости, следовательно, она нетривиальна.
То есть ее можно декомпозировать на больше, чем ноль цирков.
Вот, ну может быть один, может два, может три, может там сто пятьсот.
Ну, скорее всего, не более, чем два, но это другой вопрос.
Значит, у нас есть какой-то набор циклов.
То есть в итоге, в этой циркуляции вот.
Какие-то из них, по стоимости, меньше нуля, какие-то больше нуля.
Ну, могут быть и равные нули.
Но давайте лишнее уберем.
То есть от этого циркуляция станет еще меньше, правда?
Значит, останутся циклы меньше нуля.
Значит, останутся циклы меньше нуля.
Но заметим, что если хоть у какого-то из этих циклов,
в каком-то из этих циклов не присутствует ребро УВ,
то тогда получается, что мы и до добавления УВ,
у нас существовал цикл отрицательного веса.
Противоречие.
То есть следовательно, вчера?
Вчера?
Ну нет, я просто по-другому переформулировал.
Хорошо.
Но пока, к сожалению, это еще не все доказательства.
Потому что означает следующее, что в каждом из этих циклов
мы говорим, что в каждом из этих циклов присутствует красное ребро.
Вот это УВ.
Ну, но так как у нас ребро в своей способности один,
то на самом деле такой цикл существует ровно один.
Да.
Тогда.
Но тогда получается, то есть у нас существует цикл,
то есть видите, все вот это мы убили,
и тогда у нас получается существует цикл,
проходящий через ребро УВ,
и у него стоимость меньше либо равно, чем минус Х минус Х.
То есть она минус Х, минус И, как и еще минус вот это вот все.
Но этого просто не существует, а этим мы просто выкинули.
А это противоречие.
Потому что что такое цикл между У и В?
Это ребро УВ, к которому добавили путь от В до У.
А ведь минус Х откуда брался, помните?
Мы же взяли этот путь от В до У кратчайший.
А тут получается, что мы нашли еще меньше.
То есть это противоречие.
Вот такая.
А минус И как это стоимость пути от В до У, да?
Нет.
Нет, минус И как это стоимость второго цикла,
вот того самого отрицательного цикла,
по которому мы там достаточно сети пустили потом.
Еще.
То есть здесь сначала первое, потом ребро УВ,
через него.
Это минус Х, его стоимость была.
А потом мы сказали,
пусть появилась еще одна,
ну еще один цикл отрицательного веса.
И он же минус И.
Ага.
Мы говорим, что если он появился,
то на самом деле слева путь короче.
Ну то есть и так, мы доказали,
рассмотрели эту цикляцию,
рассмотрели все циклы отрицательного веса в ней,
а их суммарная стоимость еще меньше, чем минус Х минус И.
Ну меньше не правда.
Сказали, что все эти циклы,
может быть только один цикл,
и тот должен проходить через УВ,
потому что в противном случае
был цикл отрицательного веса в исходной сети.
Вот, и все.
А тогда получилось, что,
а этого быть не могло,
потому что мы нашли исходно,
мы пропустили единичку
по минимальному циклу,
проходящему через УВ.
Почему сейчас мы получили меньше,
чем минус Х, в принципе?
Потому что мы выкинули циклы,
которые не отрицательные стоимости.
Сказали, что после этого у нас остался
только цикл отрицательный,
один цикл отрицательной стоимости,
проходящих через УВ,
других быть не могло.
Мы получили меньше рабочих.
Да.
Их могло не быть просто.
Да, могло не быть.
Вот так.
Да.
Так что вот это да.
То есть на самом деле вот таким вот образом
это можно доказать,
если вы поставите цель себе
на этот цикл.
Но на самом деле сейчас целесообразно
будет рассмотреть другое доказательство.
А, можно про него забыть.
Ну нет, его полезно дать,
потому что знаете, это доказательство
оно как бы позволяет вот собственно это
прошарить, вот ощутить происходящее.
Потому что то, что я сейчас расскажу,
оно будет немножко заклинанием.
То есть знаете, вот как в Шторм Вакнере,
да, то есть в Шторм Вакнере, да,
вот как эта задача такая,
рецепт делайте вот так.
Ну если какой-то придумал,
с какой черной магией не понятно,
но вот доказательство, что это работает.
Ну как числа в Рибанаке, да.
Что?
Да, терема.
Ну там, допустим, у нас есть последовательства,
допустим вот это вот,
один, один, два, три, пять,
это восемь и так далее, да.
Ну вот.
Ну я же прям приехал.
Ну вот, терема fn равно
там что-то там, там один плюс корень
в степени m на что-то там,
плюс там что-то там.
Нормально.
Один из пять пополам.
А такого в том, что когда вы с этим знакомитесь,
вы говорите, как говорится,
откуда это, как это придумать непонятно,
но просто честно по индукции доказываем,
что это действительно так.
Прямо арифметикой занимаемся.
Мы так не делали.
Да, нет, это другой вопрос,
что вы там знаете уже про производящие функции,
там знаете, там более черноманический алгоритм,
находить формулы, да, это другой вопрос.
Но, как говорили, наверное,
когда вы впервые в жизни знакомились с этим,
то есть это было подобного рода черноманический алгоритм.
Нет.
Ну, значит я как-то подругу научу.
Ну ладно, значит я как-то подругу научу.
Потому что обычно производящие функции
узнают сильно позже, чем узнают вообще,
что такое число фибоначи.
Не важно знать производящие функции,
чтобы уметь раскладывать.
Не, мы делали с помощью декурятных.
Это мы здесь делали,
как-будто за первый раз формулу увидел бы вы все.
Да.
Ну, это такой результат.
Ну, может быть, другой алгоритм штурмар.
Хорошо.
Там вот непонятно, как это придумать.
Значит, мы сидим на одном утверждении.
Два часа?
Ну, нет.
Вообще не два.
Нет, ну один слишком.
Да не волнуйтесь, не волнуйтесь.
Так.
Значит, смотрите.
Так вот, на самом деле,
то есть, как это еще теперь,
как это доказать по-другому
и заодно придумать, как это сделать.
Вопрос, как вы будете искать корчайший путь,
кстати, от Вайда?
Туда его.
Только даже если изначально у вас не было
ребер отрицательной стоимости,
то как бы потом как обратное не появится.
Блин.
Поэтому вообще, значит,
можно сделать форда Велмана,
а можно сделать потенциалы.
Ура.
В этом другое реальство.
А оно сейчас заодно и будет.
Отлично.
Потому что наша будет цель,
потому что мы знаем, да,
у нас есть мистическая теорема,
там мистическая теорема о том,
что в графе не существует циклов
отрицательной стоимости тогда и только тогда,
когда можно ввести потенциалы так,
что все приведенные стоимости
оказываются не отрицательными.
Было такое.
Было в прошлом году такое, помните?
В прошлом году?
Было, было.
В прошлом году не было.
В прошлом полугоду.
Ну, в календардах, кстати, в прошлом году было.
Сейчас мы скажем,
что в графе нет отрицательных циклов,
если можно ввести потенциалы.
Ну, просто потенциал.
Любый.
Просто существует такой массив П,
что для любого ребра В,
века что П от У плюс вес В минус П от В
больше ребра В.
Вот это вот.
Вот В у В, я напоминаю,
переходит в П от У
плюс В в В минус П от У.
Обычно число П называется потенциал.
Если все такие положительные.
То есть утверждается,
что в графе не существует циклов отрицательного веса
тогда и только тогда,
когда можно ввести такие массивы П,
что все вот такие веса будут не отрицательными.
Хорошо.
Не обязательно положительные.
Вот.
Нет, суть в том,
что мы будем поддерживать потенциалы.
Нет, ну да.
Доказательство того движения тогда было так.
Понятно, что если все такие ребра не отрицательные,
то заметим, что вес цикла и приведенная вес цикла
это одно и то же.
Вот.
Теперь.
Теперь какая ситуация?
Теперь тут аккуратная технология.
Во-первых, заметим,
что с помощью потенциалов ДХ3 теперь кратчайший путь от ВДО.
Можем?
Можем, конечно.
С помощью потенциалов ДХ3.
Потенциалы ввели, в итоге вам в графе нашли путь ДХ3,
потому что теперь можно.
Вот, нашли теперь путь от ВДО.
Так вот.
А теперь финту шаги.
Мы подменим потенциал теперь.
Потому что,
ну раз мы нашли,
потому что когда мы запустили ДХ3,
мы нашли на самом деле расстояние от вершины В,
не только до вершины У, но и до других вершин.
Правда?
И один из красивых таких нот,
и как бы если забыть время на прокрасное ребро,
то на самом деле один из способов ввести потенциал
это просто объявить, что новый потенциал
это расстояние кратчайшее от вершины В.
Будет ли это и правдой?
Последовольение ребра?
Нет.
Но самое главное, правда ли это до добавления ребра?
Да.
Ну казалось бы,
действительно, жило было расстояние от вершины В.
Мы знаем, расстояние существует, оно корректно.
Вот оно У, вот оно В.
Теперь давайте рассмотрим,
что такое вот это вот П от У,
такие вот, как ВП, мы теперь ДИСТ от ВУ,
плюс вес этого ребра, так сказать, у В.
Ой, как плохо.
Давайте все-таки крестик напишем.
Вот.
И минус ДИСТ от ВИХ.
Это, очевидно, больше ли правда у нуля?
Почему?
Да потому что ДИСТ от ВИХ это длина кратчайшего пути,
а ДИСТ от ВУ плюс ВУХ это длина какого-то пути до Х.
А какой-то путь всегда больше либо равен минимального,
как что у нас сегодня был уже этот путь, да?
Вот.
Вот.
Такая вот штука.
Так что получается, так что смотрите, теперь фишка.
Мы сейчас, значит, нашли эти кратчайшие пути и подменили потенциал.
По строям нашли, да.
Со старыми потенциалами нашли, с новыми подменили.
Подменили на новые.
Что делать с вершинами, которые не достижены из В?
Потенциал ноль.
Не ноль, там может быть отрицательные ребра, может не получиться.
Сейчас.
Да, на самом деле есть подлянка, что этот новый потенциал,
он может оказаться определён не для всех,
потому что не до всех можно дотянуться из вершины В.
Их можно не менять.
Можно ли?
Нет, может их и потребуется менять.
Но идея на самом деле следующая.
Смотрите, что такое эти, вот смотрите, жила была вершина В,
и есть вот граф, вот всё, до чего она дотянулась.
Здесь вот потенциал определили, да.
Есть все остальные вершины.
Между ними тоже есть какие-то ребра, может быть даже циклы.
Вот всё остальное.
Но заметим, что все ребра между ними теперь идут вот отсюда сюда.
То есть вот туда нет ребра.
Так вот, тогда идея такая.
У них же были старые потенциалы, с которыми было вот этим ребром хорошо, правда?
Тогда у нас был, вот смотрите, у нас вот на этом множестве есть потенциал, с которым всё хорошо.
И на этом множестве был потенциал, с которым всё хорошо.
Так вот, идея такая.
А давайте прибавим вот ко всем этим вершинам одинаковое число.
Ладно.
То есть тогда с этими ребрами будет всё в порядке, а у этих ребр стоимость будет увеличиваться.
И можем и увеличить на столько, на сколько нам.
А это необходимо?
Нельзя, конечно, ознакомиться.
Ээээ...
Ну мы тут меняем какие-то потенциалы.
Вдруг-то понятно, что...
Вдруг нет.
Не, ну как-то...
Ну а наблюдаем ноль.
Не, ну в реальности этот алгоритм просто никто не пишет, потому что никому обычно не надо искать циркуляцию.
То есть обычно все ищут МинКост, а в МинКосте просто можно показать, что всё, что вам нужно, это искать пути через СТ.
То есть, в смысле, какие же пути из СТ.
Понял.
Ну и так, забегаем.
Вперед мы уже сильными, и вперед мы уже близки.
Так вот.
Хорошо, подогнали новый потенциал.
Значит, зачем мы это сделали?
Конечно же, всё равно относительно этого потенциала вот это ребро может оказаться отрицательным.
Более того, оно кажется отрицательным относительно этого потенциала.
Тогда и только тогда, когда вот кратчайший путь плюс это ребро дают действительно отрицательный цирк, правда?
Согласны?
А на СТ нет, то всё хорошо?
Ну если да, если его нет, то да, действительно да, всё.
Вот.
Ну единственное, ну вот.
Ну а если он появился, значит у нас есть путь от В до У.
Ну ладно, это тоже неправда.
Видите, наша технология допускает такое, что может даже так случиться, что от В до У пути не было вообще.
Но мы подогнали потенциал так, что относительно этого потенциала это ребро всё-таки стало отрицательным.
Ещё раз.
Ну могло так получиться.
Ну смотрите, ну я вот решаю, что могло так получиться, что как бы цикла нет, а ребро относительно нового потенциала стало отрицательным.
Ну мелкая подлянка.
А катаблятор может быть.
Но правда я тут, нет, на самом деле просто идея такая, если до У пути не было, то надо просто вот это красное ребро учесть вот в числе прочего.
Ну даже да.
Вот.
Но если до У пути был, и этот цикл отрицательной стоимости нашёлся, то что делать?
Ну тогда я утверждаю, что надо просто пропустить значит этот поток.
По вот этому циклу.
И тогда утверждается, что относительно этого потенциала у нас все выжившие ребра будут не отрицательной стоимостью.
Почему?
Это всё ещё верно только С1.
Да.
Мы всё по единичке делаем.
Почему так?
Ну потому что, что у нас произошло?
У нас появились в остаточной сети вот эти вот обратные ребра.
А также появился вот это ребро.
Ну заметим, что это ребро убилось, а появился вот это ребро, и оно, так как это ребро было отрицательной стоимостью, то это стало положительным.
Правда?
Да.
Так работает нормально, да?
Вот.
А переча.
А что касается вот этих ребр?
Ведь здесь могло быть так, что эти ребра были положительные, а стали отрицательные.
Но на самом деле фишка в том, и мы уже, по-моему, возможно даже с чем-то подобным уже сталкивались,
я утверждаю, что учётная стоимость этих ребр, приведённая, она равна нулю.
Ну приведённая вот это вот.
Потому что они были в нашем кратчайшем пути.
Да, потому что они были в кратчайшем пути, тогда получалось, что кратчайший путь до сюда плюс это ребро равно кратчайшем пути.
И тогда получалось, что эти ребра были нулевые.
Относительно.
Именно, понимаете, вот именно за этим мы ввели новый потенциал.
А в том, мы в потенциале, вот к началу кенсельбра, мы вычитаем из начала конец.
Да.
Ну для того, чтобы вот это доказательство прокатывало.
Может быть третье, мы сказали, что это обратная игра, но вот для всех остальных.
Для вот этих вот, да. У них стоимость будет ноль.
Ну потому что и для этих ребр она была ноль.
Стоимость или потенциальный стоимость?
Потенциальный стоимость.
Ну приведенный стоимость, конечно, да.
Почему?
На самом деле это по построению нового потенциала.
Потому что новый потенциал вы построили так, что потенциал это расстояние от вершины В.
В общем расстояние в исходном графе, да?
Да.
Ну без потенциала.
Ну там просто есть фишка, что если вы нашли кратчайшее расстояние по приведенным стоимостиам, то вы можете легко найти расстоянии по обычному.
Потому что, там надо что-то при body потенциал в конце и вычитать потенциал в начале.
Вот.
Смотрите, то acá утверждение следующее. Расстояние от вершины В до сюда, плюс вот это ребро равно расстояние от вершины В до сюда.
Но расстояние это чтобы BRAZ-17.
Да, но по стоимостиам.
По приведенным стоимостиам.
но и потом да нет почему это расстояние на этот раз по обычным стоимости а мне по
приведен
новый потенциал какой новый потенциал это обычное расстояние но расстояние плюс
ребро равно на этот раз расстояние следовательно по новому потенциалу
приведенная стоимость равна 0 но тогда и обратного тогда тоже будет 0 то есть
следовательно мы ухитрились построить потенциал то есть пропустить поток и
построить потенциал так чтобы серебра стали не отрицательными относительно
этого потенциала
как вы нашли тист?
какой?
новый потенциал
помните?
нет, это реально часть алгоритма
потому что смотрите как мы его нашли
перед добавлением этой ребра у нас в качестве варианта мы говорили что у нас просто есть хороший потенциал
относительно этого потенциала мы нашли кратчайшее расстояние от вершины ВЭДа в всех остальных
потом мы воспользуемся тем что найти кратчайший путь относительно потенциала
и просто найти кратчайший путь это одно и то же
мы их нашли и объявили что новый потенциал это кратчайшее расстояние от вершины ВЭД
и теперь оказалось что относительно этого нового потенциала все хорошо
и мы это реально делаем
то есть очень важная технология, важно здесь именно подменять потенциалы
это часть алгоритма
чем она нам помогает?
то есть мало того что она упрощает доказательства мы теперь не должны рассуждать что-то там про циркуляции вот эти все
хотя упихивать жадность мы могли и так
но теперь у нас просто есть потенциал
то есть мы поддерживаем что у нас есть потенциал такой что
относительно которого все существующие ребра не отрицают
существующие в смысле не насыщенные потому что вот это ребро
отсюда и следует что циклов отрицательной стоимости нет
так что вот так, то есть можно по идее это доказывать просто напрямую так
что делать со своими большими единицами?
о, а если еще не целыми, ну проблем
боюсь что все что я могу предложить это приблизить их рациональными числами
да множить их на правильный простанту чтобы сделать их целыми
и вперед приблизили
это был метод клеина чтобы...
то есть это такой метод построения минимальной циркуляции
то есть работает он конечно за суммарную
для целых... ну то есть так, понятно что если у вас целая пропускная способность
но не единичная, значит вы их просто как бы представляете
как много-много ребр с единичной простой способностью
и тогда получается что эта работа
суммарная пропускная способность этих ребр умножить на dx
А мы новый потенциал считаем после добавления ребра или до?
Новый... Нет, секундочку. До?
До.
Ну, в общем, непосредственно перед.
Умножить на dx3.
Ага.
Это громко сказано.
Потому что раз у нас ребра теперь е, в смысле максимальный поток, в смысле, господи, сумма это сумма ц, а dx работает за е.
А, ну это не проблема для нас.
Потому что в реальности, конечно же, вы, то есть реально расслоять эти ребра на единички не надо.
Ну просто...
В реальности вы просто в каждом, в каком-то ребре вы будете увеличивать пропускную способность на единичку.
То есть знаете, как это...
А теперь добавили триби в сериал.
И сад у нас умирает глава семейства.
Ну вот, и биолог там, соответственно, в какую-то клетку с бактериями, что-то там.
Вот мы будем делать дальше.
Сложная ассоциация, да?
Ладно.
Вот.
Так вот.
Ну, на самом деле, заметим, что, конечно, это нужно делать не всегда.
Ну, вы можете заметить, что иногда это можно пытаться оптимизировать, то есть не симпатическая оптимизация,
что если вы добавили ребро относительно старого потенциала, оно не отрицательно, то, в общем-то, зачем dx запускать?
То есть только когда у нас проблемы, вот тогда мы, давайте, начнём переписывать потенциал.
В смысле? dx сейчас запускать надо.
Когда мы добавляем новый ребро, нужно dx запускать из начала этого ребра.
Нет, если у тебя добавилось ребро и относительно того потенциала, который у тебя уже есть, оно не отрицательно,
то не надо запускать dx.
А, мы dx запускаем после вот этого ребро, хорошо, да.
Ну, вместе.
Ну, это не важно, но я бы так сказал.
Лучше не надо, потому что при добавлении этого ребра, формально говоря, у вас нет понятия кратчайший путь в этом графе.
Мы пытаемся его добавить, если понимаем, что можно добавить, то запускаем dx.
Нет, если понимать, что можно добавить, то всё, добавляем.
Если нельзя, точно будет плохо, то тогда мы перепиливаем потенциал, добавляем ребро, пропускаем, вот. Вот так мы делаем.
То есть если оно уже почту ля, без кучи потенциалов, то цикл мы не обведём?
Ну, потом, в смысле, мы будем закрываться.
Чего-чего ещё раз?
Если цикл некого взява отрицать через это ребро.
Если что?
Если ребро положительно.
Ну да.
Ну да, тогда у вас просто окажется, что у вас всё ещё есть сеть, в которой все ребра не отрицательные, значит цикл отрицательный.
Очень удобно.
Есть потенциал, значит цикла нет, всё хорошо.
Нет потенциала, цикла есть.
Цикла нет, потенциал есть, цикла нет.
Вот это всё.
Вот.
Так вот.
Но на самом деле можно заметить, что, можно обнаружить ещё маленькую приятную вещь.
Заметим, что в каждый момент времени у нас в сети есть минимальная циркуляция.
Ну, минимальная относительно тех ребр, которые туда были добавлены.
Вот, понимаете, да?
А теперь заметим следующее.
И тогда это приводит к классическому случаю Минхоза.
К классическому случаю Минхоза.
То есть мы предположим, что у нас изначально в сети нет циклов отрицательного венца.
Тогда как можно искать?
Ну то есть мы ищем минимальную циркуляцию в этом графе.
Добавляем все вот эти ребра.
А изначально у нас потенциал 0,0,0,0,0 и не заворачиваемся.
Ну ладно, не 0, ладно, там какой-то другой потенциал, но он существует, мы это знаем.
Знаем, что циклов отрицательного венца тут нет.
Можем найти при желании.
То есть мы потенциал с ним.
А после этого, что мы делаем?
Мы начинаем добавлять по единичке.
То есть у нас есть какой-то потенциал тут уже.
И мы начинаем добавлять по единичке проблестную способность к вот этому вот дополнительному ребру.
То есть добавляем единичку, находим цикл, пропускаем.
Добавляем еще единичку, еще пропускаем и так далее.
И так далее, пока в какой-то момент добавление еще одной единички не приведет нас к тому, что...
Не заявит, что добавили, ну и добавляете все с потенциалом в порядке.
Хорошо, а что с минус бесконечности?
Нет, минус бесконечность нужна для того...
Значит теперь смотрите, как это работает.
Нет, то минус бесконечность нужна была для того, чтобы, напоминаю, мы тут пустили как можно больше поток.
Чтобы мы тут не ходили, а пустить по такому циклу поток было бы выгодно.
Вот.
Но тогда...
Ну вот.
То есть получается, видите, что мы применили просто метод клеина, но просто только к этому ребру, потому что добавить вот эти ребра у нас было все в порядке.
Понимаете, да?
Да.
Но по факту-то, да, то есть мы говорили о том, что надо тут поддерживать какой-то потенциал, вот этот вот, да?
Но на самом деле, то что мы делали?
По сути мы делали следующее.
То есть по сути, на самом деле, мы заметим, что если у нас...
По сути, каждый раз, когда мы ищем, вот добавляем новую единичку, мы ищем кратчайший путь по остаточной сети.
От S до T, правда?
Просто ищем кратчайший путь.
И заметим, что пока он существует, вот этот цикл будет отрицательным, потому что у нас тут минус бесконечность, правда?
И тогда это будет означать, что если эта новая единичка не дала циклу отрицательного веса, значит в остаточной сети у нас больше пути от S до T тупо нет.
А это и означает, что поток максимальный.
Следовательно, мы действительно нашли максимальный поток минимальной стоимости.
Мы нашли циркуляцию минимальной стоимости, и мы знаем, что в ней заведомо будет...
Здесь пройдет воды равно вот этому вот F очке.
Это вот F очке.
Ну и тут минус бесконечность, но это какое-то фиксированное число.
И тогда отсюда автоматически... Если его убрать, то получится просто поток этой вот максимальной величины F, причем он очевидно минимальный в возможность стоимости.
То есть тем самым мы доказали, что действительно на самом деле все, что нам нужно, это искать...
То есть оказывается, что когда вычислим максимальный поток минимальной стоимости, вам нужно в каждый момент времени искать кратчайший путь от S до T.
Искать, пока этот путь существует. Если существует, найти путь кратчайшей стоимости.
Но более того, на самом деле можно еще два уточнения сделать.
Во-первых, если это в тупую, то самое тупое, там по-моему 80% задач, на самом деле вы можете в тупую искать Фордом Белманом этого хватит.
Ну там просто проблема в том, что тут будет еще сложнее искать контрпримеры, то есть искать примеры, когда T extra будет заходить, а Форд Белман нет.
Особенно с какими-то оптимизациями.
А в задачах чаще всего бывает, что там не произвольная сеть строится, а какая-то очень экзотически конкретная.
Поэтому там сложно.
В этом смысле самая крутая задача на Минкос, которую я так встречал, была конечно в 2015 году на четвертой финале.
Ладно, у вас будет она тоже появится.
Я так понимаю, все мы тут четвертые листы.
Ну вот 15-го года.
Кстати, тогда ее решил только Чемпион.
Жаль, такая задача, по-моему, ее должно доставлять удовольствие просто решать.
Вы не условия не видели.
И что?
Там такая задача красивая.
Петя ездил в командировку, бегался домой.
А его дома ждала девушка.
Она ревнивая.
Отлично. Поэтому нужно найти минимальный поток на смартфоне.
Не-не-не. Ему нужна...
Она, значит, он ей показывает фотографии.
На фотографиях, значит, он, его какие-то друзья и еще какие-то девушки.
И она спрашивает, а это кто?
Ну чтобы...
Ему нужно объяснять, соответственно, что...
Это кто? Это Катя.
Это девушка Жорика.
Вот Катя, вот Жорик, да.
А это кто? Ну вот.
А это что? А это что такое?
Ну вот. А это Аня.
Это там, это усложно, это девушка Вася.
Так, окей.
А это что?
Ну вот, это Ианна.
Это девушка Вода Нот.
Это девушка вот этого товарища.
А это кто?
О, это Катя.
Так, не понял.
А где Жорик?
А, они тогда расстались с Жориком.
А, нет, точнее так.
Нет, там было условие...
Это Юля.
Это девушка Жорика.
Так, Жорика.
Чего?
Ты же сказал, что Жорик встречался с Катей.
Так, нет, это потом было.
А ныне с Катей расстались.
Ну вот это...
Так, он ушел от Катей.
Вот к этой вот мымре, ну сомнительно.
Ну, допустим, значит, в чем?
А задача в следующем.
Значит, Катя рассыпкает.
А Петя уже так побежает и досветит уже самолет.
Он знает, что девушка устроит ему допрос.
Значит, это во-первых.
Во-вторых, он знает, в каком порядке будут рассматриваться фотографии.
И еще знает, что если выяснится, что какой-то парень бросил там, допустим, девушку X ради девушки игр,
то тогда подозрительность Лены увеличится на F от X игр.
Не, она очень подозрительная.
И надо, собственно, придумать легенду так, чтобы суммарная подозрительность была как можно меньше.
Вот.
Я думаю, замечательная задача, особенно когда ее начать решать.
Я не знаю, честно скажу, у меня там вообще кошмар начинался.
То есть давайте там, на каждой фотографии, каждой девушке найдем вершину.
Там какие-то вот тут ребра.
Ну, там ребра просто способности ноль, если там...
Ну, там что-то там, что-то типа, там каждый парень...
Или там каждый, там сейчас как там было?
Каждый там по паре идет как-то через девушку, но там что-то такое.
Причем для того, чтобы оптимизировать, приходится на каждом уровне вводить понятие, там, фиктивная девушка там, ну и так далее.
То есть я очень рекомендую порешать что-то в районе задачи.
Вон.
Да, то это вот шедевр.
На самом контесте решили только чемпионы.
Но там, правда, это вообще редкий был случай.
Чемпион решил все 12 задач, а второе место решил 8.
Ну, вот.
Ну, там эпическая ситуация была.
Но, правда, это было только в Москве.
Ну, в Москве там это просто...
Потому что конкретно питерцы там порешали, все там порешали.
Ну, 12 задач не решил никто, но там все так порешали.
Там нормально решили, там 10 задач, 11.
Сказали, так, дорогая Москва, вы что там все спали там все в это время, что ли?
Амбамаха ламаха, молодцы.
Вот.
Ну, так вот, по-моему, пока они знали эту задачу, если я правильно.
Ну, там была просто проблема в другом.
Там куча умного народа в Москве деморализовала задача К.
Ну, там это, жюри считал ее самой сложной.
Ну, вот.
Но почему-то команды Фистеха вслед за одной ее просто быстро порешали.
А быстро они ее порешали, потому что там просто на 20-й минуте одна команда ее сдала Жадником.
Нет, как потом оказалась доказательно правильным Жадником.
Просто жюри его не придумала.
Вот.
Надо будет загуглить.
Так что будет?
Да, я говорю, Рикмеду, вы порешайте весь четверть финал.
Не пожалеете, там вообще крутой четверть финал.
И при этом очень сложный.
Вот.
То есть, соответственно, вот это решали, остальные наши команды просто посмотрели, так, сдали они.
Так.
Так, если это сдал Мипдзимул, значит, так, на 20-й минуте, значит, наверное, что-то не миросложно.
Что они вообще могли сдать?
Ну, вот.
Наверное, что-то это.
И в результате Жадник придумал.
Ну, вот.
И в результате, так, еще три команды сдали.
Хотя, там, ну, какие-нибудь топовые команды, так, естественно, не мыслят.
Поэтому они оказались просто в панике.
Хотя нет, наши еще так, наши еще так мыслят.
Там, по-моему, Дженатего, будущий финалист, собственно, так затупило.
Там это, там, там главный фаворит полуфинала.
Эмису Тринити зависла в этом месте.
Ну, вот.
То есть, вообще, то есть, на самом деле, это, то есть, вообще, это выглядит, конечно, так, что как находятся задачи, которые толпой решает весь пистех, а все остальные молчали.
То есть, вообще интрига.
Сидим мы такие, смешив, тихо бегаем, не знаю, и думаем.
И где утечка?
Ну, то есть, как сказать, мы, ну, как бы там, условно говоря.
Ну, то есть, понятно, Миша уже вели, я участвовал в прорешке.
То есть, все задачи знали, конечно.
Но, как бы, Миша вроде не.
Но забавно, в общем, было.
Ладно.
Так вот.
Так что это вот, как говорится, к вопросу о веселых задачах на Минкоз.
Вот.
Смотрите.
И так вот, то есть, вот таким образом мы доказали.
Ну, во-первых, теперь, как это искать Минкоз быстрее, чем за размер потока на, соответственно, форму Белла?
Ну, как следует из предыдущего механизма, на самом деле, можно просто поводить доэксперс потенциалами, правда?
Потому что, просто, все, что вам на каждом шаге нужно, это, когда вы находите расстояние от СДТ, быстренько переписать потенциал.
Ну, переписать потенциал на расстояние от СДТ, причем реально.
Понимаете, да?
То есть, нашли расстояние.
Нашли расстояние в исходном графе.
Заменили потенциал.
И то и пропустили по оптимальному пути потом.
Да, в качестве добивки, кстати, если на какой-то вершины, вершины С не дошли, то, как вы уже знаете, вы уже не дойдете до нее никогда.
Поэтому, что там будет у нее потенциалом, вам вообще все равно.
В смысле, у нас изменение потенциалов, это просто твой потенциал и расстояние от С.
Все, очень просто. Прикольно.
В чем здесь даже заморачиваться не надо.
То есть, если плюс бесконечность, значит плюс бесконечность начать.
Потому что вас и эти вершины уже волновать не будут.
А если у нас в начале есть это удовлетворительное весо?
То, что у нас нет.
Тогда придется их каким-то образом...
Нужно как минимум найти минимальную циркуляцию.
То есть, уже решить не будешь.
Знаешь, на них можно дать ребро и не заворачиваться.
Да, увы, увы, увы.
Ну, чаще всего бывает, что там большинство задач, там даже не то, что циклы потрицентного веса,
там, скорее всего, и стоимости все изначально отложены.
Поэтому даже первую фазу можно сделать дэйкстером.
Да, в общем, в случае, обратите внимание,
вам самую первую фазу для первонахождения качающих расстояний, по-любому, придется Фордно Белломана запускать.
Ну, помните, в алгоритме Джонсона то же самое было.
Вы делали один Форд Белломан, а потом дальше куча дэйкстеров.
А алгоритм Джонсона вообще что делал?
Искал качающие расстояния между всеми парами вершин.
Которые NM% отлог?
Да.
Ну, если дэйкстер услышит Фибоначчи, то да.
Так что, если вы еще напишите кучу Фибоначчи,
алгоритм будет работать, возможно, еще медленнее по факту.
Ну, кому вообще нужна скорость работалегии?
Главное себе тостика.
Ну, а на самом деле нет.
Смотрите, тут еще.
Какой тонкий?
Ну, не тонкий.
На самом деле, еще важное замечание тоже в задачах помогает.
Отсюда, на самом деле, из этой теории еще есть ответный факт.
Вы не только находите максимальный поток минимальной стоимости,
но на каждом шаге вы находите поток заданной величины и минимальной стоимости.
Прикольно.
После одного пути вы нашли поток величины 1 минимальной стоимости.
После того как вы запустили два потока, вы нашли поток величины 2 минимальной стоимости.
Это вот, на самом деле, полезное замечание.
То есть, на каждом шаге вы получили.
Т.е. иногда, действительно, это шагик хорошо помогает.
Если ваша задача найти поток величины K минимальной стоимости,
запустить кайф лиц потом. Вот такая красота. Вот такая нот. Так что это вот, важная эта ручка. Вот, значит, что тут еще хочется сказать.
Формально говоря, конечно, вас надо до перерыва пускать, но так не хочется. Через 20 минут мы должны
будет у нас последний перерыв, и следующая пара будет мещерина. Нет, погоди, пара E будет с 15-20 по-любому.
Просто у нас через 25 минут закончится третья пара. Нет, я вам просто, смотрите, какая ситуация. Дело в том, что из, ну вот, я очень, ну скажем так, я пересмотрю, ничего ли я не забыл, но вообще, из обязательной программы про потоки, я на самом деле сказал все, кроме венгевского алгоритма.
Вот, и, ну вот, ну и на самом деле есть еще один развлекательный алгоритм про любовь. Ну это так, знаете, очень хочется закончить эту теорию про потоки именно им будет. Так вот, поэтому, то есть, в идеале, просто хотелось бы так, может быть, я бы вам рассказал этот венгевский алгоритм и пошел бы. И у вас тогда был бы уже глобальный перерыв на, в принципе, паре. Сегодня или? Сегодня, сегодня. Прямо сейчас. Сколько нам на этом можно ориентировать? Думаю, немного. Думаю, немного.
Ну максимум, думаю, за полчаса отправимся. Можно тогда все про все. Можно сейчас дослушать и отправиться. Ну да. Если не слишком голодные люди, конечно. Нет, просто вы сейчас пойдете кушать, потом придете полчаса и еще будете там это ходить. Я думаю, мы потянулись.
Если я седу кушать, я больше не рожу. Ну... Нет, тут начинаются тактические маневры в духе, а не знаешь ли ты случаи венгевский алгоритм? Нет, конечно. Зачем? Можно просто так сказать.
Ну, а смысл как... Нет, вопрос, на самом деле, из того же цыпла, а зачем нужно дерево отрезков, если, там, скажем, сплей дерева умеет делать то же самое? Или, там, AVL умеет делать то же самое? Вот.
Вот. Ну, знаете, пока я стираю... Ну, тут по-разному. Знаете, пока рассказываю, Тридцать Петров жаловались, что в Америке в 30-е годы, на самом деле, были... То есть, просветали очень крутые способы, как продать людям электрическую плиту.
Ну, казалось бы, вот это... То есть, там, кучу денег, чтобы они потратили, хотя, казалось бы, у них есть газовая плита, она нормально работает. Но, значит, механизм очень простой.
Значит, звонок в дверь, ну или, там, стук. Вы открываете на пару часов, и товарищ говорит, «Здрасте, я пришел установить вам новую электрическую плиту».
Ну, у меня же есть газовая, она работает. Электрическая плита гораздо удобнее, но, впрочем, я не буду вас убеждать. Я сейчас просто ее вам тут поставлю, настрою и уйду.
Вот. Она будет стоять у вас месяц. Можете делать с ней что хотите. Я приду через месяц. Если она вам все еще будет не нужна, я ее просто заберу.
Вот. А если она вам понравится, то тогда у нас очень удобные условия. Кредит на первый взнос 25 долларов, а потом...
Ну, давайте. Вот все. Это ошибка. Почему? Потому что, значит, первые два дня у вас стоит какая-то плита, что-то там, ну, что-то там стоит, и вы думаете, ну ладно, давайте попробуем что-то.
Вы начинаете пробовать. Да, понимаете, что что-то на ней лучше получается. Прямо тут удобнее. То есть, она там с какими-то дополнительными функциями там, и какие-то продвинутыми.
И, к концу месяца, вы реально понимаете, что вы уже привыкли жить без нее и не можете. И соглашайтесь там, называйте любой кредит, который вам предложат. Все.
Это к тому, что эти первые все задачи будут с плей-теремом писать?
Нет, это как к тому, что вместо плей-терема, вы что, будете деревоотреском писать?
Не, вы так писали. Это моя газовая плита.
Да, потому что, да. Нет, это просто к тому, что, как бы, теористов нет. Проблема в том, что деревоотреском вообще не надо, потому что теоретически это мухновые деревья, все то же самое. Но оно гораздо удобнее.
Как оно раньше появилось почему-то.
Вот. Но правда, там, видите, там, почему это реплама? Основой это за что он работал? За счет того, что электрическая плита действительно не удобнее пользоваться, чем газовая.
Погнали есть хочу.
Кажется сейчас...
У нас есть хорошее условие. Стартовый КД 25...
Так, да, это не то.
Нет, есть 25 дуров, я не буду.
Ну да, может когда-нибудь.
Ладно, значит, смотрите. На чем вообще у нас Венгельский алгоритм?
Венгельский алгоритм у нас вот о чем.
Хорошо, смотрите.
Он о том, как искать максимальное совершенное просочетание минимальной стоимости в двудольном графе.
Прям задача обычно даже так и формулируется.
Дан двудольный граф.
Все ребра взвешены.
Причем, что самое интересное, граф полный.
Причем задаются прям вот матрицы смежности.
1n, 1n.
Это важно, что 1n.
И известно, что все, давайте так, все-таки, все a и t, g, t больше либо равно 0.
Да, это тоже важно.
А, ну хотя, в общем-то, не сильно важно, но...
Мы можем ко всем реабилитировать одно и то же число.
На самом деле, да, да, да.
Согласен, согласен, согласен, да, не сильно важно. Не заморачиваемся.
Наша задача найти совершенное просочетание минимальной стоимости.
Как это сделать?
Ну, с высоты той теории, которая у нас есть, мы, конечно, могли бы тут просто построить вот, как всегда, s, t, сеть, поток, правда?
А работало бы это у нас за либо nln, либо n на...
А зачем?
Все гораздо проще.
Если ты делаешь ndx на графе с 2mершиной в квадрат рынка,
то у тебя получается nd.
Ура!
Да, заметил, что да.
Все, то есть, поэтому я и приводил аналогию с ovel и ndx.
Лучше не будет.
Асимпатически.
Но, тем не менее, у того, что я сейчас расскажу, константа как-то и обновлюсь.
Вот.
Ну, вот алгоритм альтернативный, то есть там...
Как его называется, да, он там бенгерский, потому что...
Сначала какие-то два венгра придумали, как решать эту задачу за этот четвертый.
Причем это были какие-то 50-е годы еще.
Там теория потока зарождалась, а то и раньше еще было.
Но задача уже сама по себе была.
Ну, потому что она формулируется без потоков, просто по рассочетанию.
Вот.
А потом пришел кун, еще кто-то, по-моему, возможно даже, не венгр.
И они допилили тот же алгоритм.
Вот.
Сейчас это с вами сделаем.
И мы.
Сделаем мы это вот.
Вот, смотрите.
Основная технология будет такая.
Да, нам не важно, что ребра бывают положительные отрицелами.
Но нам важно, что у нас есть...
Значит, у нас есть...
У нас есть...
Значит, соответственно, наши веса, и у нас есть потенциалы.
У и В.
У и В это потенциалы.
Массивы потенциалы.
И мы будем поддерживать...
Значит, это не совсем тот потенциал, который у нас был обычно.
У нас будет мистический инвариант.
Для любых ИЖ будет верно, что УИТ плюс ВШИТ меньше либо равно, чем АИТ.
Смотрите немножко по-другому.
Да, слово потенциал, но как бы забудьте о предыдущих потенциалах.
Тут слово только совпало.
Например, минус бесконечность.
Ну, да, изначально так и будет.
Но только изначально.
Потому что, смотрите, еще мы ведем такое понятие, как жесткое ребро.
Будем говорить, что ребро ИЖ жесткое, если вот это неравенство обращается в равенство.
Вот.
Теперь мистическое утверждение.
Почему нам важно именно НН?
Я утверждаю, то есть наша цель отгонять потенциалы, не нарушая их вариант, таким образом, чтобы у нас нашлось совершенное просочетание на жестких ребрах.
Я утверждаю, что оно и будет ответным.
Понимаете?
Я утверждаю, что оно и будет ответным.
Понимаете, почему?
Нет?
Ну, идея такая.
Предположим, что у вас нашлось совершенное просочетание на жестких ребрах.
Тогда, смотрите, если вы просуммируете все веса ребра, то у вас с этой стороны равенства получится просто сумма всех потенциалов.
Но тогда получается, что по той же причине вы можете заметить, что у любого совершенного просочетания суммальный вес не меньше, чем сумма всех потенциалов.
То есть получается, она не меньше, но ровно столько вы уже нашли на жестких ребрах.
То есть, заметьте, видите, потенциалы мы сейчас будем подгонять аккуратно, видите, да?
Сейчас мы будем вот очень-очень-очень аккуратно подгонять.
И смотрите, как мы это будем делать.
Ну да, все-таки понятно, делаем как бы жестко.
Да.
Значит, идея будет такая.
Значит, так предположим.
Ну, изначально понятно, у нас потенциал – это какая-нибудь минус бесконечность, минус бесконечность.
Ну, или если в серию брони отрицательно изначально, то ноль.
Это, в общем-то, неважно.
Важно другое.
Значит, давайте скажем, до какого-то предпол...
Значит, у нас будет вариант такой.
Мы будем идти тут по очереди.
Вот.
И будем говорить, пусть мы до какой-то вершины наконец-то дошли.
Да?
Ну вот.
У нас есть какие-то потенциалы, и они подогнаны таким образом, что у нас есть просочетания на жестких ребрах, покрывающие все вот эти вершины.
Ну, вот какой-нибудь.
Вот такое, например.
Ну, я отболтываю, пожалуйста.
То есть первые несколько левых, и все правые.
Сколько это правые?
Первая вот, жесткая первая вот эта левая, и какие-то правые.
Ну, понятно, что не все, но какие-то.
То есть теперь наша задача на следующей итерации сделать так же, только чтобы помимо этих вершин была покрыта еще и...
Просочетание нам нужно в явном виде.
Как же мы это будем делать?
А очень просто.
Мы будем делать это методом поиска удлиняющих цепей.
А именно мы из этой вершины запустим DFS по жестким ребрам.
Все ребра ориентированы вправо, ребра с просочетанием ориентированы влево.
Но нас интересует только, напоминаю, жесткие ребра.
Если мы в процессе DFS отойдем до какой-нибудь вершины правой доли,
то, поздравляю, удлиняющая цепь по рассочетанию улучшилась.
Победили.
Логично, да?
Да.
Но может так случиться, что так не произошло.
Почему ребра жесткие ориентированы?
Потому что потенциал не поменяли?
Нет, ребра поменяли.
Нет.
Какая разница? Жесткость, не жесткость, ребра никак не связаны с собой ориентация.
Мы DFS только по-жестки пускаем.
И сейчас. Наши удлиняющие цепи раксовали по ней.
Получили какое-то абсолютно другое множество ребра.
Мы выбрали другое просочетание. Мы ничего не меняли, ни веса, ничего.
Ну и что у нас? Ребра другие стали теперь.
Я не понимаю, что мы сделали. Можно еще раз?
Еще раз.
В DFS он все ребра ориентировал.
То есть он их не создал и не ударил.
Без проблем, без проблем.
Он их ориентировал.
И теперь он их ориентировал. Все ребра из просочетания влево, все остальные вправо.
Он запустил с DFS из этой вершины.
Отлично.
По-жестким ребрам.
В смысле?
Только по-жестким.
Только по-жестким.
Это важно.
DFS мы пускаем только по-жестким ребрам.
И если бы нам удалось найти удлиняющую цель в процессе этого DFS, то поздравляю.
Ну а то тогда мы победили и улучшаем просочетание радовицы.
То есть в этой картинке красные обозначенные ребра из просочетания и они еще и жесткие.
Да.
У нас это прописано в инварианте, что в каждый момент времени у нас то просочетание...
Нет, потому что у нас никак не обозначены просто жесткие ребра на графе.
Это меня просто выпило.
Да, да, да.
Так вот.
Идем дальше.
Значит, что же делать, если мы из вершины В запустили DFS и очень вот...
То есть запустили DFS и каким-то мистическим чудом до какой-то свободной вершины правой доли мы не нашли.
Не дошли.
Вот бабах такой случился, например, в самом начале.
Когда у вас тут минус бесконечность, минус бесконечность была, да?
Что делать?
Изменить потенциалы.
Значит, как?
Увеличивать или уменьшить?
Изменить потенциалы всего множества слева.
А теперь смотрите.
Логика следующая.
Значит, давайте посмотрим, докуда мы дошли.
Вот DFS докуда-то дошел.
Можно так сказать L плюс и R плюс объявить доля.
Все остальное L минус и R минус.
Помните, мы этим уже занимались в свое время, да?
Угу.
Ну L, R это слева вправо, плюс типа обойти над DFS, минус необычно.
Что мы можем сказать?
Мы можем сказать, если мы рассмотрим все ребра из доли L плюс, из L плюса в R минус, да?
То мы замечаем, что все эти ребра не жесткие, правда?
Да.
Так вот.
Из L плюс в R минус.
Куда мы не дошли?
Все они не жесткие.
Вот.
Теперь.
Магия такая.
Значит, мы введем мистическое число Дельта.
Почему они не могли быть красными из взятных просвещаний?
Потому что, а как мы в эту?
Потому что мы...
Ну да.
Дельта, так вот, идея такая.
То есть они все не жесткие.
А теперь давайте подумаем.
А на сколько они не жесткие?
Дельта это минимум по разности.
Это будет просто минимум.
Значит, по всем I лежащим будет плюс C, J лежащим в R минус 7.
Такой замечательной величины, как AITJT минус UIT минус VJT.
То есть, если рассматривать такую приведенную стоимость ребер,
то у всех ребер, соединяющих L плюса минусом,
то есть у всех таких ребер вес больше либо равен, чем DELT.
Видите, да?
А у кого-то ровно DELT.
То есть тут везде больше либо равен, больше либо равен.
Вот.
Так вот.
Так вот, там наша цель сделать так, чтобы по какому-то из этих ребер DFS в будущем мог пройти,
но при этом, чтобы все было адекватно.
Поэтому мы скажем, что...
Значит, поэтому дальше механизм такой.
Для всех вершин в L плюсе мы потенциал увеличим на DELT.
И для всех вершин в R плюсе мы потенциал уже уменьшим внезапно.
Вот заклинание предлагается так.
Ну и бишно.
Сейчас можно посмотреть, тут три ребра зеленых, верхний из них идет из L минусу L.
Ой, ой, ой, ой, безобразие, безобразие.
Давайте оно вот-вот сюда.
Вот так еще можно.
А вот это больше равно DELT? Это вес ребра больше равен?
Приведеный.
Ну то есть мы говорим, что у нас приведённый вес ребра это как бы вес ребра минус сумма потенциала в конце.
Она всегда должна быть больше либо равно 0.
Так вот, теперь давайте думать, осталась ли эта приведённая стоимость не отрицательна.
Ну давайте подумаем, если ребро лежит целиком обойдено DFS, то у него приведённая стоимость не поменялась.
Ну плюс дельта.
Если оно целиком не было обойдено DFS, то тоже не интересно.
То есть самое приятное, если оно соединяло L-R+, такие ребра тоже есть, то приведённая стоимость могла только увеличиться.
Даже не просто могла, просто увеличилась на дельта.
То есть получается мы какие-то жёсткие ребра могли даже потерять.
Но это для нас не важно.
Для нас важно, что в том, что мы обошли DFS, мы жёсткие ребра не потеряли, остались жёсткими.
Но самое главное, что если рассматривать ребра от L-R+, то у них стоимости все строго уменьшились на дельта.
И самое важное, что нашлось хотя бы одно ребро, которое стало жёстким.
А это означает, что если мы теперь запустим новый DFS учётом новых потенциалов из этой вершины,
то когда мы запустим DFS, то мы обойдём как те же вершины, плюс как минимум ещё вот эту.
Понимаете, да?
И тогда это означает, получается каждый следующий DFS будет увеличивать количество вершин, которые мы покрыли.
А следовательно, рано или поздно, то есть раз мы их будем увеличить, то рано или поздно попадётся в правой доле вершины непокрытой простичитания.
Мы всегда начинаем только из этой вершины.
А дальше у нас два варианта, либо мы дошли до вершины правой доли непокрытой простичитания, либо не дошли.
Ну и напоминаю, DFS ходит только по жёстким рёдам.
Если мы не дошли, то мы подгоняем потенциал так, чтобы у нас по жёстким рёдам можно было дойти чуть дальше и ещё чуть дальше.
То есть вот такой алгоритм. То есть мы доказали его правильность. Теперь осталось только выяснить, за сколько он работает.
Ну давайте начнём с того, что у нас N вершины.
Что у нас есть? У нас есть не более чем 2 NDFS.
Ну не 2, а просто N.
Ну N, потому что мы на каждом шаре покрываем новую правую вершину.
То есть получается, на каждой итерации мы делаем. То есть у нас есть NDF, N раз мы делаем на DFS, плюс изменение потенциала.
Ну давайте, если совсем в тупую, то как бы изменить потенциал можно тупо. То есть эту дельту можно найти тупо перебрав с серёбра.
Ну потому что всё равно же на квадрат работает, правда?
То есть давайте в тупую. Ну давайте за O от E так и напишем.
Ну теоретически там можно думать в стиле, что...
Ну тогда раз DFS тоже N квадрат, то получается O от F4.
Ну кто-то обещал N-куб.
Ну собственно, по-моему не помню, между статьями прошло 2 года.
И теперь вот возникли технологии, как этот N-куб всё-таки соптимизировать Дэн в треть.
Прям отдельная статья, все то, что вот этот алгоритм оптимизирует...
Удивительный факт, каждый раз когда у нас проходит 60 секунд, в Китае проходит целая минута.
Вопрос, как этот N-куб оптимизирует Дэн в треть?
Да...
Можно пытаться выисплыть дельту?
Ну смотрите.
Ну не совсем.
У нас DFS.
Но начнем.
Ну смотрите.
На самом деле начнем с простого.
На самом деле вот этот N-квадрат действительно достаточно легко оптимизировать до N-ки.
Следующим образом.
Нам надо прибежаться по всем вершинам из R-.
И у каждой из них найти минимальное ребро, которое соединяет эту вершину с множеством L+.
Мы можем заметить, что L-плюс у нас тоже множество, которое разрастается экстенсивно.
То есть что туда попало, оно уже попало до конца.
Понимаете, да?
Ну в смысле этого длиняющего цепи.
Поэтому возникает такая идея.
А давайте введем такое понятие, как Минже.
То есть Минже.
Житэ.
Может ИТ?
Житэ.
Лучше вообще Минве.
Минже.
Все?
Все нормально.
Ну давайте назовем Минве.
Я где-то видел это по значению Минже.
Возможно даже на иМаксе.
Ну вот.
Вот.
Как это говорят, да?
Значит Минве Житэ это равно минимальное такое ВИТ Житэ, что И лежит в ЛП.
Да, нас это интересует.
А, ну мы это можем в принципе поддерживать для всех вершин.
И нам в общем-то плевать.
Разве ВИТ Житэ?
Ну А.
Возможно даже должно быть посоединение пенциала.
Или нет.
Мы искали минимальное.
Ну что, побери.
Да, да, да, да.
Хорошо, хорошо, хорошо.
Значит теперь поехали.
Что происходит?
Значит, то теперь заметим, как меняется.
Теперь заметим, как это происходит.
Ну когда у нас в процессе DFS
новая вершина появляется в L+,
то как бы вы можете прежде...
Вам все равно нам придется пробирать по ребрам, да?
Так давайте сначала пробежимся по ребрам
и обновим вот это вот Минве.
Ну никаких проблем с этим не будет, да?
Это делается за ним.
Но правда еще есть подлянка, что
у нас в процессе DFS
это делается за ним.
Но правда еще есть подлянка, что
возможно, что у вас еще
потенциалы меняются.
Как бы не мирно.
И нам бы очень не хотелось это в тупую пересчитывать.
Но на самом деле заметим следующее.
Мы заметим, что потенциалы
в R+, вообще-то нам все равно
что-то происходит, да?
Если вершина в R-,
то здесь мы делаем следующее.
Если в R-, то
когда мы вот это делаем, да?
Вычитаем тейту в R+.
А, ну здесь вообще ничего не происходит в R+, да?
Ну в вершинах R+,
от того, что мы ко всем
вершинам прибавили,
это вычтет DEL, то ничего не поменялось.
Ну да, мы могли, конечно,
Минве поддерживать еще в R+, и там
вычитать тейту.
Но что делать с R+,
ну с R+,
делать все очень просто.
Если ко всем вершинам R+,
прибавилось DEL,
это означает, что у всех вот этих вот вершин,
там все
вот эти вот веса,
они все изменились тоже вот
на одной и той же величине.
А именно уменьшились на DEL.
А значит и минимум уменьшился на DEL,
то есть надо из этих Минвеш
их все уменьшить на DEL.
Понимаете, да?
То есть нужно поддерживать...
В смысле?
Можно это сделать в текуе, наверное,
а можно в форме поддерживать.
Ну да, на самом деле, да.
Надо ко всем R- делать минус DEL.
Ко всем Минве отжимать.
Ну R- сделать Минве.
Ну то есть по факту, да,
можно дальше задумываться
на тему того, что не делать
какой-нибудь дэкс без кучи.
Ну это ж напрямо похоже, правда,
можно найти какой-то минимум, да?
И иногда какие-то вершины
надо просто выпиливать.
То есть когда DFS дошел до какой-то вершины
новой R- ее надо исключительно выпиливать.
Ну не то чтобы вам в данном случае
на полном графе это сильно поможет,
да, то есть как на полном графе
мог шить честный для экстрима.
Но, по крайней мере, мы добились того,
что каждая фаза вот эта
между DFS-ами, она,
то есть кроме DFS-ов,
работает за линейное время, правда?
Понимаете, да?
Да.
А теперь остается только одно.
Как же теперь
после этого добиться того,
чтобы у нас не было NTFS?
Можно поддерживать
множество плюсов.
Да, и конечно,
и мы обязательно будем это делать.
Ну еще конечно, а также
мы для MinV будем поддерживать
не только минимум, но и то откуда мы его взяли.
И тогда будет идея такая,
что на самом деле,
то есть просто будет идея, что если у вас
дошлось вот это ребро, да, это нулевое,
то вместо того, чтобы запускать DFS
и эти вершины проходить заново,
мы просто говорим, что поздравляем,
DFS дошел аж до этой вершины,
и мы просто из нее запускаем DFS заново.
Ну не заново, просто запускаем DFS,
но с учетом того, что эти вершины уже помечены.
Ничего не понятно.
DFS слева запускали.
Да, мы запускали слева DFS.
Вошли когда-то эти вершины, да?
Теперь мы знаем, что
остановились, не дошли ни до одной
вершины в правой доле.
Нет, даже надо было, ну там дошли до каких-то
правых или... Да, не дошли ни до одной
свободной правой доле.
Уменьшили потенциал.
Увидели, какое множество
вершин добавилось справа. Ну, одну
добавили справа. Ну, одну хотя бы.
Ну, потому что одну не важно.
Не важно.
Значит, тогда идея такая, из этой вершины,
если она в правой доле не покрыта
по рассочетаниям, то мы победили.
Теперь не покрыта, потому что мы как раз
кинули. Нет, по рассочетаниям мы пока не меняем.
Да, еще раз.
Она могла быть покрыта по рассочетаниям.
Но мы на нее могли не дойти.
Да, вполне могли такое.
Просто
все ребра мягкие. Да.
То есть вполне вероятно было, что
ребром с дельтой было вот это.
Ладно.
Ровно из-за этого у нас
N DFS, а не один.
Да, вот подляночка.
Тогда нам нужно пустить еще раз DFS.
Ну, не еще раз, а просто
сказать так. Старые пометки мы не стираем,
просто запускаем DFS из этой вершины.
Ну, из этой, в смысле
помещаем ее, идем сюда, и там
дальше идем тоже.
Потому что там, конечно, пути будут по жестким
ребрам. Ну, хотя нет, даже пути по жестким
ребрам будут те же. Обратите
внимание, потому что
от того, что мы тут пошаманили с потенциалами,
жесткие ребра внутри L+, R+,
остались жесткими ребрами.
Поэтому для каждой вершины
можем аккуратненько поддерживать,
из какой вершины мы в нее пришли, по какому ребру.
Вот эта жесткая ребра
уже останется жестким навсегда.
Ну, по крайней мере, в наших рамках.
И поэтому будем продолжать.
И тогда получается, что эти N DFS
будут работать экстенсивно,
каждая вершина попадет в DFS ровно один раз.
И тогда получается, что
у нас не N DFS.
А на самом деле у нас получается,
это мы убираем, а на самом деле сюда
вставляем плюс DFS
И, которые суммарно работают
за N квадрат.
И тогда это получается
N на N
плюс DFS
И того
это N куб.
Вот.
Когда мы сделали
один перечет потенциала,
у нас не появляется сразу
прочитание новое.
Не можем сразу прочитание увеличить?
Ведьм не.
Потому что мы изменили и дошли.
Нет, если дейта соединяла...
Если эта дейта ведет
в R минус, то вполне вероятно.
Куда она еще может вести что?
В вершину не покрытую про сочетание.
Она может вести в вершину
покрытую про сочетание.
И тогда после следующей DFS покроет вот эту вершину,
и эту вершину пойдет дальше.
Вот. Ну дальше да.
Дальше начинается отдельная песня
и мы скажем, что делать, если у вас
ребер не N квадрата, все-таки E
каких-нибудь.
Типа можно улучшить.
Ну, типа.
Вот.
Нет, ну то есть это считать...
Ну да, там это будет работать, действительно,
что просто будем считать, что все остальные ребра есть,
только они плют бесконечно.
Ну это легко понять.
Да. Но тогда суммарно DFS работают, во-первых,
не за V квадрата, за O от E,
а за N квадрат.
Ну можно это сделать не за N квадрат,
а на самом деле просто вот...
За E лог. Ну как минимум за E лог.
А на самом деле да.
Ну давайте так.
Ну во-первых, заметим, что вот эти все прибавления
ну что у нас происходит,
когда мы к L плюс что-то прибавляем,
да, у нас все
веса увеличиваются
на одну и ту же константу, да?
Да. Как правильно там Чифин заметил
с самого начала, действительно, мы могли
прибегаться, а просто хранить
собственно этот двиг, правда?
Сейчас, как там это...
Как ты это назвал?
Хранить шифт, хранить вот так?
Шифт хранить. Чего хранить?
Ну пуши, хорошо.
Ну ладно, шифт можно назвать. Шифт.
Вот хранить шифт.
Но тогда у нас получится
штука, тогда у нас получает
нужна опять структура данных, которая умеет
хранить себе сет каких-то элементов,
надо уметь прибавлять одну и ту же константу
ко всем, значит
уменьшать
какую-то штуку
и доставать минимум.
И доставать какие-то
элементы.
Ну, по-моему,
структура данных, умеющая
это делать, называется куча фибоначи.
Ну есть просто куча за е лоб ве,
а куча фибоначи будет это за
е плюс ве лоб ве делать.
Так что в принципе, то есть если
вот очень-очень-очень аккуратно
запилить, то получится
ве на
что-то типа е плюс ве лоб.
Да, то есть надо, ну вот, и там
дальше я сейчас, конечно, не буду
так подробно прописывать, но действительно
на самом деле это можно реализовывать.
То есть, может быть, это тоже можно интерпретировать, как такой
очень красивый мемпост
с каким-нибудь красивым потенциалом.
Знаешь, что-то в этом не уверен.
Хотя всякая.
Так, ну вот, с вингеткой в общем-то и все.
