Вот давайте так еще раз. Итак, список всех паттернов, их больше и гораздо больше.
Кстати, я на самом деле встречал несколько различных паттернов.
И очень многие не согласны, например, с тем, что я вот так делаю.
Вот эти подходы я выделяю в качестве паттернов.
Очередь или функциональное разделение как паттерн.
То есть имейте в виду, что это все достаточно условно, здесь нету прям правил.
А кто-то считает паттерном объектно-ориентированное программирование?
Вот объектно-ориентированное программирование один паттерн,
да Main Dreaming Design другой паттерн.
Будете потом встретить с этим с работой, в работе не бейтесь в кровь.
Нет вообще принятого правильного ответа.
Но суть это не меняется.
Это некий подход, это некий кирпичик, из которого может складываться архитектура.
Некий прием, который вы можете применить до решения той или иной задачи.
Даша, пласток мы все прошли, мы с вами попытались собраться в некий алгоритм.
Первый шаг алгоритма это описать бизнес-лиг.
То есть описать все цифры, все как система будет развиваться,
все, что с ней происходит, все, что пользователь может в ней делать.
Какие функции выполняешь сейчас, какие функции будут выполнять потом,
через год или там тоже нужно читать.
Опять все данные.
Причем данные описываются нас вами, помните, в трех размерах, в трех осях.
Мы узнаем средние, мы узнаем максимальные значения данных.
А третье я не помню.
По-моему сейчас и потом, опять же, время, третье, третье время.
То есть какие объекты есть, какие уклони размера, что с ними можно сделать,
сколько их может быть, если это пользователи, сколько их может быть,
если это друзья у пользователей, сколько может быть друзей у пользователей и так далее.
Причем как средние значения, так и максимальные допустимые.
Самое плохое слово, которое можно сказать, что нет никаких ограничений.
Вот это прям всегда жди подвоха, в правде нет никаких ограничений.
Не заметьте, ограничений везде есть.
Живой журнал была такая соцсетка «нельзя больше пяти тысяч друзей»,
«бойфрэйнд ленту нельзя откручивать больше, чем месяца в шесть прошлое» и так далее.
То есть везде есть какие-то ограничения, они неспроста.
И нефункциональные требования.
То есть как быстро должна работать система, как быстро отвечать,
может ли она ломаться и так далее.
Дальше, описали все. Шаг второй.
Считайте, просадитесь и считайте, сколько данных, сколько процессоров,
сколько каналов, сколько еще чего, сколько памяти,
что вообще, сколько записей, сколько чтения.
То есть пытайтесь нащупать на критический путь,
то есть некую проблемную точку, она нам потом потребуется.
То есть что может сломаться? Где может это закончиться?
что может... если это youtube, то, очевидно, нам дисков нужно дохренище, если это
тестовый индукциондекс, то дохренища тестовый индукциондекс, да, размера дисков.
есть, например, это новостной сайт, да, по большому счету канал, что еще, да, то есть,
вроде как, вычисления особо нет, баздано маленькое, диск не нужен, зато нужно очень
много это отдавать, а если это vpn, то что? во что упрямься, если это vpn? сеть, наверное. раз, а еще?
до спроса упрямься тоже, будем перкодировать, включить vpn на телефоне, у вас батарейка разъедит
пять раз быстрее, почему? неспроста. вот, короче, ищите какой-то такой самый критический путь. дальше,
это мы с вами, вот, как бы, второй, третий, четвертый, мы с вами исследуем систему будущую,
чтобы понять, за что зацепиться нам при проектировании. второе, это пытаемся понять,
что может допустим и деградацию. мы спрашиваем просто у project manager, слушай, а насколько можно
вот здесь ужать, а вот здесь не вовремя сделать, а вот здесь? например, такой деградация может быть
разная. например, новостной ресурс в моменты перегрузки может выдавать новости с пяти минутной
задержкой или не может, а friendlent может пускать не по порядку новости, а не новости о посты. или не
может, опять же. вот, везде такие будут какие-то небольшие, все вот эти вот отклонения от некого
допустимое, допустимое отклонение всех нужно собрать. еще один пункт, который мы допустим,
и еще один пункт, пытаемся построить схему движения данных. просто как данные у нас в
системе живут, как они двигаются, как они в нее попадают, как они преобразуются, как хранятся,
как отдаются пользователю и так далее. некое workflow именно для данных. в большинстве случаев, скажем
так, данные, именно вокруг данных вы будете представить, строительство и архитектур. вот,
то есть, и дальше мы пытаемся все это собрать. то есть, нам с вами нужно выбрать вот ту особенность
некой нашей программной системы, на которую мы могли бы опереть. либо это вот какая-то критическая
точка во что мы приемся, либо это какие-то свойства данных, либо это какие-то пункты,
были градации и так далее. если помните, мы с вами в прошлый раз в работе, когда проектировали
спортивный транспорт, мы с вами оперлись на то, что данные для всех одинаковы. вот это прекрасно
примерно что можно опереть. на этом оперлись и на то, что на путь движения данных, что данные
входят из одного источника, по большому счету, контролируемого нами, а выходят по множеству.
для всех одинаковые. вот мы взяли эти две особенности и собрали из них архитектуру.
дальше мы все это делаем, то есть как бы проектируем нашу архитектуру. и шестой шаг,
который мы в прошлый раз с вами не рассмотрели, мы пробуем его сломать. мы смотрим на нее и думаем,
а что будет, если этот узел будет справа. то есть у нас есть национальное требование по
неубиваемости, по отказу в стойчивости, то мы решаем вот это. тренируемся. тренироваться будем так.
можете, пожалуйста, пятый шаг. у нас сейчас с вами будет три задачи. у нас 6 команд,
да, ничего не изменилось. 7. команда без логики. ну пусть будет команда без логики.
у них и название, конечно. нам достаточно сейчас команд без логики.
сейчас дальнейшие действия. у нас следующий. у нас будет три задания.
начнем работать над ними сегодня. закончим в следующий раз срочно.
первое. профили на сайте знакомств. второе задание. проектировать френд-ленту. третье задание.
проектировать хэштег. ленту хэштега в твиттере. все непростые. профили на сайте знакомств.
самое-самое-самое-самое лайтовое, конечно. но вот френд-лента и хэштеги сложные.
мы начнем сегодня. сейчас я вам вкратце расскажу про каждый проект.
затем вы разобьетесь на сессионные залы. именно по командам. и поработаете в сессионных залах.
что значит поработаете в сессионных залах? внутри сессионного зала вы сделаете следующее.
первое. выберите себе проект. выберите себе архитектуру, которую будете проектировать.
второе. начнете составлять, сообщите мне, какой архитектур вы выбрали.
третье. начнете составлять список вопросов. я прожиг менеджер всех трех проектов. вы должны
выяснить у меня, чего я хочу. вы готовитесь. составляете список вопросов. потом через 15-20 минут
я к вам прихожу. вы мне задаете. я вам на них отвечаю. после этого можете остаться еще поработать.
но наша цель в следующий раз, в следующую среду, мы с вами защищаемся очно. и вы защищаетесь друг
перед другом. вы просто выходите, стоите перед доской и начинаете как команда рисовать свою
архитектуру. и все остальные будут задавать вам вопросы. а что произойдет, если так? а подумали
ли вы об этом? а что если пользователь поведет себя вот так? а что если у него будет миллиард
друзей? и так далее. и вы должны, ваша архитектура должна выдержать этого самого атаку. вот такая
вот история. в результате мы с вами сформируем за эти две недели прямо три готовые архитектуры.
естественно, это значительно обличит вам прохождение экзамена. успешные прохождения
вот этого самого. вот этих самых двух недель. и так, погнали. вопросы по схеме работы есть?
нет. а залы сессионные, они где появятся? или вы нас просто раскидаете сейчас как-то?
нет, я не раскидаю. они появятся прямо здесь. я не знаю, как они появятся. я нашу кнопку и вы их увидите.
я включил свободный переход по всем залам. вы просто зайдете и сами зайдете в зал
своей команды. залы названные по названию команды. так, еще вопросы по процессу.
вопросов нет. погнали. итак, профиль на сайте знакомств. очень просто. сайт знакомств,
badoo или tinder, что угодно. то есть любой. пользователь заполняет амкету. амкета большая,
там могут быть картинки, фотки, еще что-то на приличного размера. получается логинт
порой для доступа к своему личному кабинету. ну и пользователи могут смотреть профили друг
друга. вот базовая задача такая. она очень простая, поэтому я буду задавать в процессе
различного рода дополнительные сложные вопросы. то есть вам потребуется наворачивать различного
рода сервисы вокруг этой системы профилей. например, поиск по параметрам. например,
список заходящих на вашу амкету, просматривающих вашу амкету в последнюю неделю. то есть какие-то
дополнительные сервисы будут. сейчас их проектировать не надо, но нужно учитывать, что они будут.
дальше пользователи. пользователи 200 миллионов. амкета занимает 10 килобайт.
амкет, соответственно, всего получается по объему 3200 байта. китов 5 миллиардов
в день. 5 миллиардов просмотров чужих амкет в день. это довольно много. значит, что я уже готов вам
сообщить по поводу еще по поводу деградации. деградация недопустима. ни в коем случае, ни по
каких условиях. данные пользователя потерять нельзя. это так называемые персданные. это
называемые персональные данные. это очень важно. это очень критично. пользователь на эту тему очень
переживает и так далее. это европа. дикие штрафы за неправильную работу с персональными данными.
это первая часть. дальше. первый проект. второй проект. вопросы будете задавать потом,
когда сформулируете их со своей командой. фрейдбук. у него есть фрейдбук. здесь мы делаем только
фрейд ленту. только этот сервис. больше ничего. друзья, профили, фотки, все находятся за пределами
нашего сервиса, который нам нужен. пользователь подписывается на других пользователей. заносит их
в друзья. подписывает. и пользователь может посмотреть список постов друзей примерно
в хронологическом порядке. это не критично, но порядок примерно хронологический. я как пользователь
могу посмотреть список постов. пользователей очень много. пользователей 2 миллиарда. каждый пост в среднем.
Я сейчас презентацию кину прямо в чате к нам, чтобы вы просто цифру отбрали.
Можешь не записывать. Каждый пост в среднем занимает 300 байт, но может быть до 10 килобайт.
Мы пока реализуем первую версию. Фосты только текстовые, все очень просто.
Цифры, посещаемости такие. 10% пользователей заходят ежедневно.
В среднем в течение дня они заходят три ежды.
И в среднем в течение дня каждый пользователь пишет один пост из зашедших.
Примерно прикидывайте, сколько чего, какой поток объем данных будет,
как быстрая светобаза будет запросить и так далее.
Дальше. Пользователь просматривает в среднем 20 верхних пасов.
Но у него по большому счету нет никаких ограничений.
Сколько процессора его компьютера-браузера хватит, он может вертеть и вертеть с них.
FriendLent подгружается при прокручивании экрана.
И у одного пользователя в среднем 300 друзей, но может быть сколько угодно.
Он может быть подписан на любое количество других пользователей.
Если я на кого-то подписываюсь, то посты этого пользователя появляются у меня во FriendLent.
Но и деградация частичная запустима.
Посты терять нельзя. Порядок не обязан быть строго хронологическим.
И пока мы с вами не рассматриваем и не обрабатываем ситуацию, что нам делать,
когда пользователь удалился из друзей или удалил кого-то из друзей.
Потому что в обычном мире FriendLent перестраивается.
Нужно удалить этого пользователя.
Вот мы пока на эту тему не паримся.
Итак, это FriendLent.
Пложная задача. Следующий кусочек Twitter.
Не менее сложная задача.
Конкретно ленту хэштега.
Ленту хэштега.
Итак, у нас есть точно так же пользователи.
У нас есть пользователи, пишут посты.
В каждом посте могут быть хэштеги.
Это все как бы вне нашей системы.
Но мы реализуем только ленту постов внутри этого хэштега.
Друзья, профили все за пределами сервиса.
Значит, пользователь может посмотреть ленту постов по этому конкретному хэштегу.
Пользователь смотрит этот список постов в хэштеге примерно в хронологическом порядке.
Пользователей миллиард.
Каждый пост в среднем 100 байс.
Максимальная длина 140 байс.
Посты только текстовые.
В посте может быть...
Сколько влезет хэштегов?
До 10.
Среднее количество хэштегов в каждом посте 2.
Среднее 1.
10% пользователей заходят ежедневно.
В среднем каждый смотрит одну ленту хэштега в день.
И в среднем пользователи пишут 7 постов в день.
Пользователь просмотрит в среднем 20 верхних постов в ленте хэштега.
Но у него опять же нет никаких ограничений.
При прокручивании экрана это все будет появляться.
Так, вот эти три проекта.
Теперь...
Я запускаю...
Поддеградация еще должна быть же.
Ой.
Сейчас.
Сейчас запущу.
Деградация действительно должна быть.
Слушай, ну там то же самое.
Деградация недопустима.
Ничего не может ломаться.
Ничего нельзя терять.
Примерный хронологический порядок.
Ничего нельзя терять.
Примерный хронологический порядок.
Делать пластынь нельзя.
Порядок не обязывает строго хронологически.
Если пластынь отредактировал пост, то мы на это не реагируем.
То есть если пластынь взял и удалил хэштег из поста,
мы пока ничего не делаем на эту тему.
Мы не переживаем.
Так.
Значит, все.
У вас по-прежнему семеро.
Больше не надо.
Запускаю с пустенной залы.
Так.
Сколько мы ожидаем популярных хэштегов?
То есть типа, например, тех, на которых приходится 90% запросов на показ?
Запросы на показы.
Значит, смотри.
Есть два пункта этой популярности.
Первая популярность – это на показы.
Цитрат.
Первая группа цитратов не спросила.
То есть есть хэштеги, которые часто запрашиваются на чтение.
Чаще, чем другие.
И есть хэштеги, которые часто обновляются.
Чаще, чем другие.
Мы подумали, что это одни и те же будут примерно.
Ну и мы тоже это подумали.
Ну, в принципе, да, можно так сказать.
Согласен.
Скорее всего, будут одни и те же.
Распределение крайне неравномерно ге.
И крайне изменчивое.
То есть все, как у первой группы.
То есть есть такие хэштеги, которые прямо очень-очень популярны в течение дня
или в течение промежутка какого-то времени.
Потом они уходят, теряют популярность.
Появляются другие и так далее.
То есть есть какие-то лидеры.
И есть огромный хвост влачащих жалкое существование хэштегов.
Так.
Давай дальше.
А можно ли делать поиск?
Я прослушал, а вот эти вот горячие с ними-то.
Там же очень большой поток создания новых постов.
То есть нам нужно, когда новый пост горячий попадает,
тоже его отображать?
Или все же мы хотим, чтобы там была какая-то консистентность постов.
Скажем, чтобы они не слишком часто обновлялись.
Потому что кажется, когда слишком много желаний написать по хэштегу,
там просто в помойку это все превратится дело.
Мы это никак не ограничиваем.
То есть как бы вот именно технологически никак не ограничиваем.
Интерфейсно, да.
Если ты, кстати...
Как Twitter решила эту проблему?
Не замечали?
Ну, очень просто.
Он просто добавляет наверх...
Вот ты листаешь свою ленту.
То есть он добавляет сверху значок о том, что чувак что-то появилось.
Нажми на вот этот значок, нажми на иконочку.
Я теперь загружу страницу.
То есть интерфейсно это, конечно, решается.
Потому что невозможно будет читать ленту хэштега
при постоянных добавлениях новых сообщений.
Но технологически никак не ограничиваем.
Даже если туда пишут миллион сообщений в минуту,
мы должны готовы записать миллион сообщений в минуту.
Давай дальше.
А может ли быть поиск по несколько хэштегов?
Нет. Не может.
Ну и как, наверное, какие-нибудь другие фильтрации, например, по автору?
Нет. Нет. Нет. Нет. Нет.
Вроде всё, ребят, поправьтесь.
Можно вот от меня такого вопроса дать?
Ну то есть наша цель для хэштегов – это просто сделать список айдисников,
которыми потом отдадим внешнему сервису, который эти посты отрендерит
и отдаст HTML, который мы отдаем клиентам.
Да.
Хорошо.
Да.
Ладно, хорошо. Отключаемся от хэштегов.
Кто следующий?
Есть здесь группа, готовые задавать вопросы?
Можно ещё по хэштегам позадавать?
Если есть, давай.
Там у команды возникли вопросы, а какая максимальная длина самого хэштега?
Вот утверждается, что в Twitter можно сделать хоть 139 символов,
но хотим ли мы взять меньше?
Максимальная средняя длина?
Мы уже решили, что это 50.
50 символов, ага.
Это максимумы были в среднем?
Это максимумы.
А в среднем?
Длина, не знаю, 12.
Дальше, там вот ещё с точки зрения хранения,
а сколько постов могут содержать один тот же хэштег?
То есть вопрос пересекаемости по хэштегам?
Нет никаких ограничений.
В среднем тоже ничего нет?
В среднем цифры есть презентации,
то есть на каждый пост в среднем два хэштега у нас.
Нет, наоборот, на каждый хэштег сколько постов?
Ребят, ну...
Какое-то число постоянно растёт.
Что за вопрос?
Да, это на каждый хэштег,
ну, может быть, сколько в день.
Я не знаю.
Распределение не равномерное.
Есть очень популярные посты,
есть хэштеги, есть редко используемые.
Вот. В популярных это обычно, естественно, какая-нибудь, не знаю,
какой-нибудь гауссовый
или какое-нибудь любое распределение возьмите.
Не...
Нет никаких ограничений для популярных хэштегов.
Они могут быть очень большими.
Распределение – это уже какое-то сильное ограничение.
Нормально.
А сколько люди готовы ждать на прокрутке и при первой загрузке?
Вот мы зашли посмотреть на какого-то хэштега.
Сколько можно подождать, пока появятся посты?
Ну, слушай, блин, полсекунды.
Ну, то есть как бы нельзя ждать.
То есть любая задержка – это какая-то проблема.
Ну, и сколько можно ждать перед тем, как пост появится в ленте, если мы его добавили?
Там, кажется, Сергей уже задал такой вопрос.
Вот здесь я понимаю, что могут быть какие-то задержки.
То есть опять же нужно стремиться к тому, чтобы все происходило, не знаю, сразу.
Но я пойму, если пост будет до ленты катиться некоторое время.
Несколько минут.
Несколько минут.
Так, и есть ли какие-то посты, которые у нас уже есть до того, как мы начали дизайнерскую архитектуру?
Или считается, что все посты будут добавляться по мере работы?
То есть какое-то legacy в этом смысле?
Слушай, ну подожди.
Так.
Так.
Слушай, я отвлекся, но помню вопрос.
Вот мы начали проектировать систему с хэштегами.
У нас уже были до этого какие-то посты, которые как-то хранились?
Или все посты будут новыми?
Просто если посты были, то их нужно как-то переложить, и на это нужно потратить какое-то время.
И вместе с этим другой вопрос.
Кусок, который отвечает за прием новой информации и ее хранение – это наша сфера дизайна?
Или кто-нибудь другой предстоит нам хранилище, с которым нужно работать?
То есть какие тут ограничения?
Ну давай так.
Кто-нибудь другой предстоит нам хранилище, с которым нам нужно работать.
Ну давай так.
Давай мы не надо тратить времени на какие миграции.
То есть у тебя как бы уже постов допустим, допустим, до сих пор нет.
Вот ты запускаешь систему, и все, сразу побежало.
Но она не растет у тебя при этом постепенно.
У тебя сразу миллиард пользователей, у тебя сразу огромное количество постов в день и все тому подобное.
То есть вдруг говорят, ты на существующем работающем сервисе запускаешь новую функцию.
Давай, Даша.
Ну у нас по вопросам все, спасибо.
Окей. Кто еще? Какие еще группы готовы? Спрашивайте.
Есть кто-нибудь еще?
Да, давайте. В общем, ну тут частично уже про...
Я про Фродлента увидел, тут частично про Twitter это обсуждалось.
У вас задержка на прогрузку 20 постов и догрузка дальнейшие 500 миллисекунд, видимо, да?
Ну у вас то же самое, да.
Ну вообще 500 миллисекунд это дохрена, конечно.
Это значит, что у вас довольно медленный сервис. Не должно быть такого.
100 допустим, нормально.
Ну да.
Ребят, смотрите, если вы никогда по большому счету не сможете...
Вы же знаете, что такое персентили?
Да.
Ну вот. Вы никогда не сможете перейти к ситуации, когда вы гарантируете, что ваша страничка дает...
Ну допустим, да.
Так, хорошо. Сколько у нас пользователь постов учитает за один свой закон?
Вот он скролит, скролит ленту, он подгрузил 20, он продолжает скролить. Сколько он за такую сессию обычно прочитает?
Ну вот там ты делаешь-то немного. В среднем он читает 20 постов.
В ленте хештега, в ленте for friendly и for friendly тоже, но потом может догружать дальше сколько угодно.
Ну да, ну то есть, догрузка данных до среднего пользы вообще никогда не происходит.
Мы первично 20 постов выбили, дальше он ничего не догружает.
Если вы первично даете именно 20, то да.
Хорошо. Дальше, если у нас, допустим, пост, не знаю, трехдневной давности, мы можем все посты трехдневной давности по случайному порядку внутри одного дня выдавать?
Нет.
Или все будет более точно?
Нет, это очень важно. Кстати, друзья, для хештегов тоже, если хештеги здесь остались, порядок никогда не меняется.
Вот он один раз сформировался, и я, как пользователь, я ожидаю, что именно так все и будет.
А, типа порядок не строго хронологический, но неизменный?
Да. Да, именно так.
Дальше, так сколько за раз, у нас нагрузка как распределена по времени?
У нас глобальная сеть, поэтому она примерно одинаковая, или там, не знаю, большая часть полиции все еще живет в США, поэтому там какие-то их дневные часы, вечерние часы там нагрузка в два-три раза выше, допустим?
Глобальная сеть, у нас все примерно одинаково.
Так, хорошо. Ну вроде все. Спасибо.
Еще френдлента. Какие вопросы по френдленте?
Здрасте. Подскажите, вот мы же не можем редактировать посты и удалять посты по френдленте пока что, да?
Нет, не можем.
А можем показывать только часть поста, а потом там принажать и подгружать его целиком?
Можем. Ну, можем, да, может и так сделать.
Ну и распределение тоже неравномерное, то есть есть очень популярные посты, есть очень популярные визеры, да?
Да.
Все верно. Еще?
А вопрос про порядок постов в френдленте. Что значит, что он должен быть неизменным и не обязательно хронологическим?
Вот, то и значит. Неизменным это означает, что в моей френдленте я ожидаю, я увидел, что после поста Вася идет пост Пети.
И вот я ожидаю, что теперь так оно и будет. При этом я не всегда смотрю, что пост Вася, который идет у меня в френдленте выше, он на самом деле на пять минут раньше поста Пети.
Если я на следующий день опять зайду во френдленту и долездаю до этих вчерашних постов, то они в том же порядке будут.
Да, да, именно так.
То есть разброс там пять минут, то есть можно на пять минут как бы их перемешивать?
Нет, их можно перемешивать, но как бы нет четкого времени. Вы не сможете, я просто понимаю, что вы не сможете реализовать четкое ограничение по времени.
Скажу вам пять минут, все. Пять минут, если появляется у тебя четкое ограничение по времени, то у тебя, считай, появляется жесткий хронологический порядок, потому что архитектура меняется полностью.
Поэтому я говорю, что жесткого ограничения нет, нет такого времени, в течение которого вы должны обязательно в порядке положить этот пост во френдленту.
Нет, может быть пять минут, может быть минута, может быть час и так далее, но вы должны примерно это время контролировать, то есть примерно его считать, мониторить.
То есть я к вам буду приходить и спрашивать, в среднем какое отклонение от допустимого вы будете говорить?
Ну, в среднем такое, распределение вот такого, это персентиль, пять минут такое.
Так, еще вопрос. Все? Все френдленты знают, как она будет работать? Окей.
Чего-чего? Давайте я про профили спрошу тогда. Давай. Анкета, наверное, может меняться. Вот как быстро нужно. Я поменял анкету.
Через какое время при просмотре моей анкеты другие пользователи видят изменения?
Сразу.
Окей. Как пользователи находят чужие анкеты? Вот как я нахожу анкеты других людей? Меня просто ссылку кидает в личку?
Да, тебе это не волнует. У тебя появляется ссылка, ты должен ее показать.
Хорошо. Нужно ли я надумать по настройке приватности? Ну, то есть кто-то запрашивает мою анкету.
Я могу настроить, чтобы какие-то категории пользователей видели мою анкету? Какие-то не видели. Ну, могли и не могли посмотреть. Или не нужно в этом думать?
Ну, давай. Давай нужно. Я могу конкретным пользователям запретить просмотр своей анкеты.
Окей. У нас насколько равномерно распределили анкету обещаемости? Есть какая-то статистика?
Ну, то есть у нас есть анкеты, которые больше и которые меньше открывают, да? Насколько больше разбросов?
То же самое, что и везде с потенциальной распределением. Есть некоторые анкеты, которые анкеты, я не знаю, модомные.
Ее смотрят все просто по глазей. Хорошо. Есть ли свечка какая-то между кластеризацией пользователей по каким-то признакам и анкетами, которые они открывают?
Ну, например, география или что-то подобное? География? Ну, ты знаешь, ну обычно она есть, но она не строгая, то есть нет никаких гарантий.
Гарантий, конечно, нет. Но статистически это география, да? Да, статистически география, конечно.
Какие у нас примерно данные в анкете? Куча текстовых полей, куча текстов по большому счету.
Ну, там, понятно, много персданных и... Ладно, ладно, хорошо. Не надо выполнять мне сейчас какой-то сплошной четвертый МЗ. Нет, не надо, на этом не парься.
Ну, это понятно.
Так, что за личный кабинет? Доступ в личный кабинет по логину паролю. Что за личный кабинет, нужно ли нам знать, что это такое?
Нет, ну это просто способ редактирования анкеты. Хорошо. Это личный кабинет, это есть анкета мая.
Хорошо. Планируется ли какая-то функциональность через полугода, через год дополнительная, кроме просмотра анкеты?
Да, вот так как у вас по умолчанию самый простой проект, давайте мы его немножечко усложним.
Я хочу фильтр. То есть как бы я хочу искать пользователей по некоторому фильту. Не по строке.
Ну вот все вот эти вот параметры, там куча параметров. Допустим, там их 20.
И по этим 20 параметрам, как лучших, там я не знаю, фактических, нехороших проектах, я могу выбрать цвет глаз, рост, вес, там не знаю, объемы, талии и прочее, прочее, прочее.
И вот это все числовые параметры, то есть у вас 20 числовых параметров.
Но не полнотекстовые поиски.
Не полнотекстовые поиски. То есть эти 20 числовых параметров я могу выбрать.
Я могу задать какие-то там диапазоны и добавить еще.
Как бы у вас по большому счету будет подсказочка, как бы 2 сервиса у вас. Ну давайте.
Какого числа анкета, какую динамику мы ждем? Там через год, через полгода. По числу пользователей.
Они растут. Там у нас сейчас 200 миллионов. Ну давай добавляется 20 миллионов.
Ну хорошо.
Вот у нас примерно, сейчас я вспомню сколько у нас было пользователей в сутки.
5 миллиардов просмотров анкет в сутки. Вот они равномерно по суткам распределены?
Или есть какие-то...
Да, у нас большой, ну как бы каждый кластер же определенный, где равномерно.
Московские кластеры или там московские пользователи смотрят московских...
Московские мальчики смотрят московских девчонок в московское время, да.
В московским вечером.
Но в целом по системе у нас все примерно равномерно.
Хорошо.
Так.
10 килобайт анкету. Ну у нас числовые поля, поэтому это ровно 10 килобайт на каждую. Хорошо.
Ну примерно, да. Там немного пряшено. Ну да, да.
Да, логин пароль тоже мы не проверяем.
Это все за нас делали, нам просто головки дадут?
Да, да, да.
Так, вроде все.
Да, вроде все, спасибо.
Так, еще вопросы у кого-нибудь остались?
Поехали.
Так, ну начнем с самого банального.
Какой стандартный пайплайн нахождения пользователя во френд-ленте?
У нас френд-лент, да, если что проект.
Угу.
Поясни свой вопрос, что ты имеешь в виду под стандартным пайплайном?
Ну вот человек заходит во френд-ленту, что он делает?
Он листает посты, тыкает на них и читает, правильно?
Нет, тебе нужно сделать следующее.
Тебе нужно вернуть список постов.
Вот я зашел на френд-ленту, и у меня список постов.
Вот это тебе нужно сделать.
Если он там куда-то переходит, заходит внутрь профиля, еще что-то, это делать уже не надо.
То есть, ну, по факту это просто лента, в которую он читает, что там не постит другие?
Да, да, да.
Хорошо, а тогда такой вопрос.
Комментарии там оставлять, это не наша сфера уже?
Не ваша, не ваша, не ваша.
Лайки, все это, шаринг, это все не выйдет.
Тогда такой вопрос.
Сейчас, ну, то есть он заходит, получается, в френд-ленту, и вот он может просто написать пост, запостить его, видимо, да?
И чужие посты прочитать как-то?
Нет, он постит пост не во френд-ленту.
Он постит пост к себе, на страничку.
Потому что при этом она раскладывается во все френд-ленты всех друзей, которые на него подписаны.
Вот так скажешь.
То есть я пишу пост, и во всех френд-лентах, не моих друзей, а людей, у которых я в друзьях, появляется этот пост.
Вот так.
И все, больше ни у кого не появляется, правильно?
Если, например, есть какой-нибудь Марк Цукерберг, и он там основатель вот этой вот, всей штуки, это не значит, что его пост будет появляться абсолютно у всех.
Только у тех, у кого он есть в студии.
Да, кто подписан, у кого, да, кто сказал, что Марк Цукерберг его друг, да?
Хорошо, такой вопрос. Получается, уже есть функциональность того, что, ну, короче,
пользователь может себе на страницу записывать пост, мы должны просто раскладывать его по френд-лентам, по сути.
Ну, по друзьям.
Да.
Еще раз.
Да.
Хорошо. Такой вопрос. Вот насчет популярных пользователей.
Насколько, ладно, это...
Ну, окей, да, популярные пользователи, у нас, видимо, бесконечное количество друзей, может быть, все такое.
Какое количество таких пользователей мы ожидаем, у которых там больше, например, 10 тысяч друзей?
Все то же самое, эксп потенциальное распределение.
Здесь очень популярные пользователи, их немного, есть огромных ложек.
Хорошо, тогда по пиковым нагрузкам вопрос.
Вот вопрос номер один. Вот есть, например, цифра в десять процентов людей в день.
В пиковый час от вот этих десяти процентов сколько можно ожидать?
У нас международная сеть.
Вделенная на 24.
Вделенная на 20, не великий, понятно дело, когда солнце надо...
То есть, равномерно все у нас, правильно?
Да, в целом равномерно, да, по времени равномерно.
Хорошо, а вот в среднем человек постит по одному посту в день.
А бывает такое, что в каких-то ситуациях люди начинают в среднем постить больше?
Конечно, конечно, это же мы же американские компании или российские компании.
Мы делаем эту штуку как некое информационное в том числе оружие.
Естественно, могут быть ситуации, когда кто-то начинает писать очень много или очень активно,
или что-то вообще, даже если не рассматривать конспирологические теории,
просто бывает извержение вулкана в Азии какой-нибудь, не знаю, где-нибудь в Индонезии или Цунами,
и понеслась огромное количество постов.
То есть, могут быть стресски любые, вы должны быть готовы ко всему.
Хорошо, а во сколько раз примерно больше мы рассчитываем, они будут писать?
Может быть, десятикратные стресски.
А бывают пользователи, которые пишут, имеют одно сообщение в минуту,
и мы их никак не ограничим.
А, хорошо.
Никак не ограничим.
Но их очень мало, естественно.
Окей, ну а в смысле, если там злоумышленники решили так сделать?
Это от нас.
Злоумышленники решили так сделать?
Да.
Это не ваша задача.
Хорошо.
Перед вашим сервисом стоит что-то умное, что ловит злоумышленников.
А во сколько раз число читаемости может возрастать?
Тоже в десять.
Бывает пользователи, я не знаю, вот Трамп выгоняют из Белого дома,
и вот в этот момент все читают, что он скажет.
Или Илон Маск решил что-нибудь очередное купить, и все побежали читать Илона Маска.
Ага, хорошо.
Не, подождите, а когда нам разница?
Это профили будут читать свою френд-ленту?
Все равно, бывают такие ситуации, да, тоже десятикратные.
Что-то происходит, и я начинаю читать свою френд-ленту, смотреть, как народ реагирует, что происходит.
Хорошо.
А бывают ситуации, в которых размер поста сильно увеличивается в среднем?
То есть у нас раньше, например, могла быть ситуация, что много постов, но размер у них все же средний.
А бывают ситуации, когда размер поста увеличивается сильно в среднем?
Например, там не 300 байт становится, а 3000 байт?
Нет, такого не бывает.
То есть распределение по размеру поста, но стабильное?
Да, да.
Хорошо.
А можно тогда делать деградацию, например, по размеру поста?
Да.
Нельзя.
Такой вопрос еще насчет функциональных требований.
Вот есть ли у нас разные круги внутри друзей по постам, типа близкие друзья или родственники?
Разделение какое-то такое?
Неа.
Есть ли хэштеги?
Неа.
Поиск постов есть в ленте?
Неа.
А как мы планируем, чтобы расширялся функционал?
Он будет как-то расширяться дальше?
Нашего куточка пока не вижу.
А вот там, сейчас, секундочку, в том, что вы писали, это у нас было?
Да, да, сейчас.
Подожди, это не функциональное требование.
Ладно, окей.
Была информация про то, что удаление друзей не влияет на френд-ленту.
И в скобочках пока.
Что это значит?
Ну, не влияет.
Не проектируйте это.
Потом вместе в следующий раз подумаем, как бы мы могли, какой бы навесочек мы сделали сверху, если все-таки влияло.
Пока не влияет.
А вот это означает, что после того, как мы отписались от человека, от него все равно будут прилетать новости?
Или это значит, что просто старые новости не удаляются?
Старые новости не удаляем.
Но новых нет.
Ну да, да.
Хорошо.
Ладно, если по функциональным требованиям в будущем у нас нет никакого расширения, по данным проще?
Да.
А так у нас на данный момент данные это только текст, правильно?
В какой-то момент у нас будут изменяться данные?
Нет, пока не делаем этого.
Пока не делаем.
Хорошо, размеры данных соответственно тоже у нас не меняются никак, правильно?
Да.
Как растет количество пользователей?
Тихонечко.
Я не знаю.
100 миллионов.
То есть взрывов нету никаких?
Нет, взрывов нету.
Но уже слишком большие.
Ладно, а у данных есть какая-то связь друг с другом?
Ну, то есть посты людей могут ссылаться как-то друг на друга?
Нет, не по этим.
Ладно, окей.
Подумай еще, что насчет данных можно.
Вот насчет нефункциональных требований, сколько мы хотим, чтобы грузилось FriendLent?
Ребят, ну быстро.
Пол секунды максимум.
99 в течение 100 миллисекунд.
Окей, понял.
Даже если мы очень далеко зашли.
Окей, через сколько у нас чужие посты появляются в ленте?
Чем быстрее, тем лучше, жесткого ограничения нет.
Чем быстрее, тем лучше.
Проверить невозможно, понимаешь?
Хорошо.
Как быстро лента перестраивается, если, например, другу добавили?
Как быстро лента перестраивается, если, например, другу добавили?
Старые его посты не появляются в ленте.
Появляются только новые.
Угу, окей.
Ну ладно, как часто можно постить, мы спросили.
Насколько нехронологический порядок может быть?
Можно иногда его более плохим делать?
Угу.
Ну, можно.
Окей, а что значит нехронологический просто порядок?
Совсем или чуть-чуть?
Чуть-чуть.
Чуть-чуть.
А чуть-чуть это в пределах дня или в пределах недели?
Или часа?
Это в пределах часа максимум.
Ну опять же, жесткого ограничения нет.
Но если у вас будет много постов, которые перепутаны больше, чем на час,
то я как Проджек справлюсь.
Приду к вам и попрошу переделать архитектуру на более быстрый.
То есть вы должны мониторить скорее.
Эта цифра должна быть под контролем.
Вы должны примерно представлять, насколько могут быть такие задержки.
Угу.
Хорошо.
Окей, ладно.
А вот нефункциональные такие требования, типа скорости, там загрузки и всего такого,
они у нас будут меняться в будущем?
Нет, не планируем.
Окей.
В принципе, вы все спросили, по-моему.
Я клипировал.
Ну ладно.
Но если есть вопросы еще, то спрашивайте.
Окей.
А мы вам потом еще можем их дать, Инос?
Или как это происходит?
Можете в чатике.
Хорошо.
Спасибо.
Ладно, да.
Да, еще вопросы есть.
Открываю все залы.
Возвращаю всех.
Ну, я не знаю, что делать.
Открываю все залы.
Возвращаю всех.
Вопросы есть?
Вопросы-вопросы остались?
Ребята, давайте.
Ну, все.
Если нет, тогда всем пока.
Расходимся.
Встречаемся через неделю у ВДК еще в 11 часов.
