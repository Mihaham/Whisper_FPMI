так друзья ну все давайте начинать я немножко позже начинаю но вроде народ как раз собрался так
ну как я обещал сегодня у нас с вами а сейчас мне меня ведь не снимают не транслирует или снимают
а хорошо хорошо ты эту штуку повисал так ну значит сегодня у нас квадратичные вычетые
не вычетые но это вроде как мы в прошлый раз уже анонсировали так что все это понимают давайте
я еще раз напишу что это такое и так у нас есть какое-то натуральное число м
кисло а называется квадратичным вычетом так вычетом по модулю м если а эм взаимно
простые и сравнения x квадрат сравнима с а по модулю м имеет решение вот такое вот
определение в принципе я его давал и в прошлый раз тоже если такое сравнение имеет решение
тогда мы говорим что а это квадратичный вычет по модулю м но на самом деле понять
про конкретное число является оно квадратичным вычетом или нет это такой вызов достаточно
непростой и собственно эту лекцию я хочу посвятить этому вопросу почему это важно почему это круто
я расскажу на следующей лекции в том числе среди прочим а сегодня это просто ну такая классическая
тема из теории чисел и действительно в теории чисел ей всегда уделяют достаточно много внимания
вот прежде всего давайте я напомню такой факт замечательный алгебраический называется теорема
ла гранжа он нам в какой-то мере пригодится не только в рамках этой темы но и в рамках многих
других тем которые будут возникать дальше значит теорема утверждает следующее пусть
f от x многочлен какой-то степени м от одной слава богу переменной то есть это не как в
и зиве это одна переменная многочлен какой-то степени м пусть также п простое число здесь
важный момент пусть п простое число тогда у сравнения f от x сравнимо с нулем по модулю
п не более м различных решений так многочлен степени м а сравнение по модулю п м и п здесь
никак не соотносится м это просто степень какое-то натуральное число а п это модуль по которому мы
решаем сравнение утверждается понятная вещь корней у многочлена степени м не больше чем м
ну в данном случае это утверждение не в обычном поле действительных или комплексных чисел а в
поле zp где п простое число так ну доказательства можно провести например от противного давайте
предположим так я надеюсь я понимаю что различные решения различные по модулю п то есть различные
в zp да давайте предположим то есть больше решений какие-то x1 так далее xм плюс один разные решения
разные по модулю п давайте напишем многочлен f от x вот в таком виде к м умножить на x
минус x1 x минус x2 x минус xм плюс к м минус 1 на x минус x1 x минус x2 x минус xм минус 1
плюс и так далее плюс к1 на x минус x1 и плюс к0 вот так прям нарисую
так друзья первый вопрос к аудитории понятно что так можно сделать
нет так многочлен у нас м той степени допомните что он степени м значит к с индексом м к с индексом
м минус 1 к 1 к 0 это все какие-то числа которые мы подбираем ну числа из zp конечно но это не
важно вот мы их подбираем так чтобы здесь при x видите здесь x будет в м той степени после
раскрытия скобок получился тот самый коэффициент который находится прием той степени у f от x
подобрали к м ну естественно тут будет и какой-то коэффициент при x в м минус первой степени
потому что мы выбрали какой-то к м раскрыли скобки но x в минус первой степени получит
какой-то коэффициент подберем к м минус первая так чтобы здесь-то просто будет x в м минус первой
степени но так чтобы вместе два этих слагаемо давали в точности коэффициент при x в м минус
первой степени тут дальше уже не будет м минус первой степени разложили в другой базе сда
можно так сказать согласен так друзья сейчас понятно как подбираем ясно что так подобрать
можно теперь смотрите мы же знаем что у f от x согласно нашему предположению x 1 является решением
но подставьте сюда x 1 что получится к 0 ну то есть вот так я пишу f от x 1 сравнимо с 0 по
модулю p следовательно к 0 сравнимо с 0 по модулю p так f от x 2 сравнимо с 0 по модулю p то отсюда
следует только один сравнимо с 0 по модулю p потому что эти все зануляться а и кстати на x 2 разные
по условию и тут важно что п это простой модуль то есть важно что когда вы к 1 умножаете на нечто
и это оказывается нулём по модулю p а это нечто не 0 только 1 0 видите здесь важно что п простое
отсюда следует что к 1 это 0 по модулю p f от x м плюс 1 сравнимо с 0 следовательно к м сравнима
с 0 но то есть мы получаем что f от x от тождественной 0 мы получаем что если у f от x корней больше
чем м то он тождественной 0 у него все вот эти к 0 к 1 и так далее они все равны нулю
сейчас товарищ неужели я кокнул здесь это вроде простой рассуждение вот ну хорошо в данном контексте
в контексте квадратичных вычетов теорема ла гранжа говорит нам исключительно о том что если
вообще решение у этого сравнения есть то этих решений не больше двух но это можно было конечно
и без теорема ла гранжа сказать но вот тем не менее она нам пригодится в будущем поэтому давайте
выведем из нее этот замечательный факт так ну смотрите давайте вообще разбираться со
случаем квадратичных вычетов когда м равняется п вот будем разбирать только этот случай в течение
всей лекции у нас м будет простым числом мы будем рассматривать квадратичные вычеты по
простому модулю так ну если п по определению степени м он тождественной 0 ну нет ну конечно
нет ну давайте я так скажу пусть многочлен степени м не тождественно равны нулю то есть не все
коэффициенты которого равны нулю по модулю п но наверное это можно было сказать формулировки
теоремы но это как бы предполагалось но ну да мы мы рассматриваем многочлены как формальные
степенные ряды конечные многочлен для нас это чисто алгебрагический объект не функция
сейчас понятно да все никого не запутали этим обсуждением так значит смотрите если
п равняется двойке но давайте не будем этот случай рассматривать в нем все по-моему очевидно
то все очевидно если вдруг кому не очевидно рассмотрите что будет при равном единице по
все будет очевидно но там только равно единица актуально потому что а и п должны быть взаимно
просто на конечно будет вычитан давайте будем считать теперь что п нечетная это очень полезная
договоренность которая нам сильно поможет дальше то есть при единственном возможном
четном простом числе все очевидно потому что оно маленькое и там рассматривать нечего поэтому
считаем что п нечетная и наша глобальная цель научиться хоть как-то понимать конкретное
число а является квадратичным вычетом по модулю п или не является ну так перебором конечно можно
решить эту задачу но хочется как-то вот более аккуратно действовать так ну что будет если
п нечетная значит так если а квадратичный вычет то существует x1 такой что x1 в квадрате
сравнимо с а по модулю п мы знаем что решений не больше двух согласно теория мелагранжа и
очевидно совершенно что минус x1 в квадрате тоже сравнимо с а по модулю п но это я думаю очевидно
правда минус x1 в квадрате важное замечание состоит только в том что минус x1 не сравнимо с x1 по
модулю п потому что мы ограничились от случая когда п равняется двойке простите меня за эту
казуистику то есть пока ничего умного вообще не происходит то есть мы нашли оба решения которые
в принципе могли бы существовать вывод такой если а квадратичный вычет то ровно два решения есть
а смотрите я написал а и м взаимно просто я определил квадратичные вычеты только в случае
когда а и м взаимно простые то есть а не предполагается равным нулю потому что а и п взаимно
просто по определению это правильное замечание но я от него ограничился заранее то есть у каждого
квадратичного вычета ровно два решения которые но больше которых быть уже не может согласно
так теперь смотрите если а1 и а2 разные квадратичные вычеты разные квадратичные вычеты то
соответствующие плюс минус x1 и плюс минус x2 тоже разные это вроде очевидно
имеется в виду что если а1 квадратичный вычет мы доказали что соответствующие решения плюс
минус x1 разные у а2 тоже какие-то разные плюс минус x2 и вот вот это множество из двух элементов вот
этим множеством из двух элементов не пересекается мне кажется это очевидное утверждение вот из этого
очевидного утверждения что следует давайте заметим заметим то конечно квадратичными вычетами
квадратичными вычетами являются числа 1 в квадрате 2 в квадрате и так далее п-1 пополам в квадрате
я пока говорю абсолютные какие-то тупые тривиальности вы меня пожалуйста прощайте за это а если кому-то
кажется что сложно то это потому что вы ждете что будет сложно ну ясно что полные квадраты
являются квадратичными вычетами это конечно не решает исходную задачу никак потому что мы же
не знаем как их загнать обратно в zp то есть что из себя вот эти полные квадраты представляют
по модулю п если рассмотреть их как элементы приведенной системы вычетов ну не знаем но
очевидно что эти полные квадраты действительно являются квадратичными вычетами вот у
этого будет плюс-минус один решение у этого плюс-минус два там у этого плюс-минус
p-1 пополам при этом все вот эти пары решений которые я только что произнес тут пара
решений тут пара решений тут пара решений они попарно не пересекают но стало быть сколько
решений суммарно получается. П-1. Отсюда следует, что общее количество решений
квадратного сравнения, которые возникают вот из этих чисел, общее количество
решений равно П-1. Но это означает, что не просто вот эти числа являются
квадратичными вычетами, а других квадратичных вычетов нет. Мы заполнили всю приведенную
систему вычетов по модулю П парами решений для вот этих вот квадратов. Очевидная
совершенно вещь, нет? Или я все-таки быстро рассказываю? Вот поэтому не просто вот есть
тривиальное замечание, что эти числа являются квадратичными вычетами, но других квадратичных
вычетов нет. То есть следствие такое, квадратичных вычетов П-1 пополам и квадратичных не вычетов
П-1 пополам. И еще есть ноль, который не является ни вычетом, ни не вычетом по
определению. Квадратичных вычетов и не вычетов поровну П-1 пополам штук. Но все равно, если
вы смотрите просто на набор чисел от единицы до П-1, представьте там П это 101. И вот вы смотрите
на числа 1, 2 и так далее 100. Про каждое конкретно из этих чисел вы ничего сказать
априори не можете. Вы знаете, что половина из них вычет и половина не вычет? Это я сейчас доказал.
Пока больше ничего не знаете. Не, ну не про каждое. Про один вы знаете. Один это вычет. Так, друзья,
понимаешь, что один это вычет? Четыре? Ну хорошо, да. Четыре тоже. Ну какое-то количество этих
квадратов попадает, конечно, внутрь набора от единицы до П-1, но дальше они начинают вылетать
за пределы и про них уже не очень понятно. Так, ну хорошо. Я всю доску исписал тривиальностями,
уже надо стирать. Какое несчастье. Да, все квадраты, которые не превосходят 100, про них все понятно.
Пири там 9 и дальше до 100. А, вот так хотите. Ну спасибо. Да, должно хватить. Спасибо. Так,
значит, смотрите, чего я хочу сказать. Есть такое замечательное явление, которое называется
малая теорема фирма. Малая теорема фирма. Мы ее с вами очень много применяли, изучали.
Ну вот я ее написал сейчас. Смотрите, я ее могу вот так переписать. А в степени П-1 пополам минус
1 на А в степени П-1 пополам плюс 1 сравнимо с нулем по модулю П. Ну просто вычел,
перенес и справа влево и применил формулу стандартную. П-1 слава богу пополам делится,
потому что П нечетное число, но мы это уже пользовали на прополу. Ну вот,
смотрите, если А квадратичный вычет, то А в степени П-1 пополам, это то же самое,
что Х1 в степени П-1. Потому что А это то же самое, что соответствующий Х1 в квадрате. А это Х1 в
квадрате, каким-то там Х1. Поэтому А в степени П-1 пополам, это Х1 в степени П-1. А Х1 в степени
П-1 это опять единица согласно малой теореме фирма. Ну извините, второй раз применяю малую
теорему фирма за три строчки. Значит, вот это снова по малой теореме фирма. То есть получается,
что если А квадратичный вычет, то имеет место вот эта вот скобка, равенство нулю вот в этой
скобке присутствует. Слушайте, ну я вот так очень вязко, конечно, рассказываю, но я стараюсь это
как-то расцветить радостью речи. Ну мы сейчас придем к понятному утверждению. Значит, смотрите,
мы поняли, что если А квадратичный вычет, то он удовлетворяет вот этой скобочке. И больше того,
мы знаем, что квадратичных вычетов П-1 пополам, вот там было написано, помните? Их столько же,
сколько не вычетов. Их П-1 пополам. Внимание, теорема LaGrange снова применяется. У этой скобки
не больше, чем П-1 пополам решений. И при этом П-1 пополам решений есть. Это квадратичные вычеты.
Сейчас, секунду, я. Ладно, чуть позже. Так, понятно. Значит, все квадратичные не вычеты удовлетворяют
вот этой скобке. Ну, я могу, конечно, писать. То есть, он удовлетворяет первой скобке
всего решений у первой скобки П-1 пополам, и они квадратичные вычеты. Больше их быть не
может, по теореме LaGrange. Следовательно, все квадратичные не вычеты удовлетворяют
второй скобке. Удовлетворяют второй скобке. Вот так. Ну, отсюда вывод такой. Давайте,
может быть, это оформим как утверждение. А, давайте даже не так. Давайте это оформим
как утверждение для некоторого объекта, определение которого сейчас дадим. Объект
это так называемый символ Лежандра. Это очень важная штука, которая, собственно, отвечает нашему
вопросу. Символ Лежандра пишется вот так. А дробь П и в вертикальных скобочках читается просто А по П,
А по модулю П, А по П. Это не А поделить на П ни в коем случае. Это единица, если А квадратичный
вычет. Это ноль, если А ноль по модулю П, и это минус один, если А квадратичный не вычет.
Символ Лежандра. И утверждение в терминах этого символа Лежандра состоит в том, что А по П
сравнимо с А в степени П минус один пополам по модулю П. Это следствие того рассуждения,
которое находится тут. А в степени П минус один пополам сравнимо с единицей тогда и только тогда,
когда А квадратичный вычет, и с минус единицей тогда и только тогда, когда не вычет. Ну на самом
деле сравнимо. Это, наверное, сильно сказано. Ну ладно, сравнимо, да, потому что здесь все-таки
сравнение по модулю. А по П это А в степени П минус один пополам по модулю П. Ну смотрите,
мы ее не решили в том смысле, что все равно для конкретного А понять вот эта штука единица
или минус единица сложно. Ну перебор какой-то. Я понимаю, в каком смысле вы понимаете вопрос,
сложно или несложно. Ну за константу операция это делается или за сколько? Ну за логарифм поделается,
да, то есть полиномиальность уже мы получили, я согласен. Я хочу за константу что-нибудь научиться
решать. То есть да, в каком смысле действительно это все, задача решена. Но там есть чего поделать
дальше. Значит, дальше мы замечаем, что раз такое утверждение верно, то, например, из него вытекает,
что А умноженное на В по П это А по П на В по П. Это видно сразу из сравнения. Называется
мультипликативность символа или жанра. Мультипликативность символа или жанра.
Так, что-то еще я хочу сказать. Ну ладно, это один по П равно единице. Это ниоткуда не следует,
это очевидно. Это просто так я на всякий случай записываю, чтобы было понятно. Ну как, один,
конечно, квадратичный вычет по любому модулю. Вот, у меня задача следующая. Я хочу найти два по П.
Я хочу сказать, что это, в общем, да, ну, что еще очевидно. Это, наверное, минус один по П очевиден.
Это минус один. В какой степени? В степени П минус один пополам. Здесь это все-таки очевидно.
Можно просто написать, если П это там 4К плюс один, тогда это будет единица. Если П это 4К плюс
три, тогда это будет минус единица. Тут не надо перебор делать. Не, ничего. Где пентагональные?
А, ну нет, это просто простое какого вида. Я пытаюсь понять, четное или нечетное просто
вот это число. Ничего умного. Нет-нет, здесь просто вот это число четное, ну тогда будет единица.
Вот это чему равно? Вот это мы сейчас докажем. Чему равно? Ну, хотите, я это сформулирую в виде теоремы.
Сразу два по П тоже можно отыскать. И это равняется минус один в степени П квадрат минус один поделить на восемь.
То есть это тоже законстанту ищется, в общем. Так, но это надо доказать. Это сейчас займет определенное
время, это уже не так тривиально. Не так тривиально. Так, сейчас надо не запутаться. Давайте знаете,
как действовать? В каком-то смысле так же, как мы действовали, когда у нас с вами была
малая теорема ферма. Помните, вы там перемножали какие-то числа? Ну, не помните, не страшно.
Давайте посмотрим вот на что. Возьмем число А умножить на один, А умножить на два и так далее.
А умножить на П один, где П один это будет обозначение для П минус один пополам. Для краткости через П
минус один. Через П один обозначим П минус один пополам. Вот рассмотрим такие числа. А умножить
на 1, на 2, на p1. И каждое из этих чисел, ну скажем,
а на p1, запишем в таком виде. Эпсилон 1 на r1 по модулю
p и так далее. Ой, почему а на p1? Давайте а на 1. Что-то
я не в том порядке написал, виноват. А вот здесь будет
а на p1. И оно будет Эпсилон 1 на r1 по модулю p. Что такое
Эпсилон? Что такое r? Эпсилон Ит это плюс-минус единица,
это знак. А r Ит это нечто из множества 1 и так далее
на p1. Вот так. Каждое число вида а умножить на нечто
можно представить в виде плюс-минус такой вот r там
с каким-то индексом. Ну то есть мы просто загоняем
числа от минус p-минус один пополам до p-минус один
пополам. Такое множество. Это приведенная система
вычетов по модулю p на и меньше по абсолютной величине
того числа, которое в нее попадает. Ну ноль не получим,
я имею в виду, что мы вот в этот отрезок загнали,
а ноль не получим, конечно, никогда. Это вы правы. Внутри
этого отрезка загоняем, но в ноль, конечно, не попадем.
Это правильное замечание. В ноль не попадем, потому
что а и p взаимно простые. То, на что мы домножаем,
а и p взаимно простые. Что в ноль мы, конечно, попасть
не можем. Так, согласны, что любое число можно загнать
в такой отрезок? Это тоже приведенная система вычетов
по модулю p. А, ну приведенная без нуля. Я говорю слово
приведенная, давайте ноль я выкину. Просто взяли
вот так и написали. Теперь перемножаем слева, перемножаем
справа. Слева у нас получается а в степени p-1 пополам, ну
а в степени p-1 то же самое. У нас p-1 со множители, p-1
это p-1 пополам, поэтому а будет в такой степени.
Дальше будет 1 и так далее p-1. Ну, если хотите, это
p-1 факториал, но неважно. А справа будет epsilon-1 и так
далее epsilon-p-1 умножить на, дайте я, нет, ладно,
здесь напишу, r-1 и так далее r-p-1. Все это по модулю p.
Дорогие друзья, чего я хочу сказать? Помните, я напоминал
доказательства малой теоремы фирма. Кто скажет, чего я
хочу сказать? Чего я тут могу сделать с этим поганым
равенством? Ну, схлопнуть в каком смысле? Что сократить?
Копки сократить, вот эти, да? На самом деле числа,
которые вот эти вот r-1, r-p-1, они же все разные, но естественно
они все разные по модулю p, что вот эти все числа разные
по модулю p. Друзья, понятно, что вот эти числа разные
по модулю p? Нет? Ну давайте, а умножить на х? Нет, они
с разным знаком, да, то есть, epsilon-ы могут быть разных
знаков, epsilon-ы могут быть разными. А? Нет, такого
не может. Так, сейчас, подождите, ну давайте разбираться.
Ладно, нет, что-то непонятно. Так, куда я делал тряпку-то?
А, вот она. Так, подождите, что-то непонятно, да? Я хочу
сократить, да, я хочу сказать, что это разные числа. Сейчас,
ну, что-то тут непонятно. Так, сейчас-сейчас-сейчас-сейчас,
это вроде бы должно быть очевидно. А умножить на х? Сейчас, подождите-подождите, кто? Сейчас-сейчас-сейчас-сейчас. Значит вот, пусть
а на какой-то х сравнимо с epsilon-1r и а на какой-то y сравнимо,
ну, давайте начнем с epsilon-1r. Пусть будет вот просто один,
один здесь не надо писать, просто ax сравнимо с epsilon-r, а y сравнимо с epsilon-r.
Это понятно, что так быть не может? Это, наверное, всем понятно. Так, поэтому
предполагаем вот так, то ax сравнимо с epsilon-r, а y сравнимо с
Ну что, сложить их надо просто. Надо написать а на х плюс y сравнимо с нулем, да?
Но у нас x и y находятся в множестве от единицы до p-1 пополам, поэтому их сумма
находится в множестве от единицы до p-1. И, стало быть, их сумма тоже не может
делиться на p. Ну а а не делится на p по определению. Значит, это чушь.
Ну хорошо, да, давайте, конечно, аккуратно проверять. Так, теперь понятно, что r1rp1
это просто перестановка на множестве чисел от единицы до p1. Так, друзья, поднимите
руки, кто еще не потерялся в происходящем. Это хорошо. Если вдруг что
непонятно, давайте, давайте разбираться, никуда я не спешу. Так, ну все, у нас
получилось знаете, что такое следствие промежуточное, что мы получили в рамках
доказательства теоремы? Мы получили, что a по p это в точности a в степени, нет,
сейчас, это в точности epsilon-1, да, и так далее, epsilon-p1, произведение вот этих
знаков, потому что мы знали, что a по p сравнимо с a в степени p-1 пополам, а
теперь выяснили, что a в степени p-1 пополам это произведение знаков, ну
значит, a по p в точности ему равняется. Ну это просто такое промежуточное
следствие, наблюдение, которое мы сделали. Что, кокнул, что ли? Так, теперь давайте я вот такое
утверждение сделаю, но можно оформить как утверждение. Утверждение epsilon-i равняется
минус единица в степени целая часть, давайте epsilon-x, вот 2ax поделить на p, вот так
можно написать этот знак, с чего-то такого, с понталыку, сейчас будем разбираться, почему это так,
почему epsilon-x, это знак числа a умножить на x, представляет собой именно то, что я нарисовал,
ох-ох-ох, ну давайте я попробую доказать это утверждение, вот есть числа 1 и так далее,
p-1, потом есть числа, ой-ой-ой, ну давайте я докажу после перерыва, потому что это займет
определенное время, сейчас перерыв 5 минут, я как раз перезвоню, там мне звонили. Так, все, товарищи,
давайте продолжать. Так, у нас, ну такая не очень приятная штука, на самом деле все довольно
просто, целая часть это округление вниз, я всегда использую такую целую часть, хотя, конечно,
можно стереть верхние палочки, но это неважно, потому что число у нас положительное, для него все
равно, что такую целую часть, что нижнюю. Нет, еще раз, это округление вниз, просто для отрицательных
чисел есть разница между округлением вниз и округлением, которое обычно обозначают вот так,
но давайте не будем это дискутировать, это округление вниз, все. Да, можете писать так,
как вам привычнее, я обычно так пишу целую часть, просто целая часть числа. Ну хорошо,
я все-таки поясню, целая часть минус 2,1 это минус 2, это не округление вниз для отрицательных
чисел. Знаете, когда я пишу такую целую часть, я имею в виду именно целую часть, то что до запятой,
но для положительных чисел это округление вниз, а для отрицательных вверх. Так, давайте напишем 1
п-1, потом напишем что-нибудь 2п-1, чего там, сейчас, почему 2п-1, что я написал, нет,
я не то написал, подождите. Сейчас мы просто разобьем всю прямую на вот эти вот приведенные
системы вычетов, ну там п какое-то есть, я от него хотел избавиться, будет п плюс 1 и так далее,
2п-1, потом будет 2п плюс 1 и так далее, 3п-1, ну то есть так вот всю прямую заполняю до бесконечности
этими приведенными системами вычетов, которые попарно не пересекаются. Вот у меня есть чиселка
а умножить на х, вот я хочу там вот есть чиселка а умножить на х, я хочу посчитать ее знак,
вот в этом смысле, в котором здесь это написано. Так, ну что может произойти с ней? Вот смотрите,
если а умножить на х, как бы это сейчас подчетче объяснить, значит если а умножить на х лежит в
левой половинке какого-нибудь из этих отрезочков, ну здесь это означает до п-1 пополам, здесь это
означает до п прибавить п-1 пополам, понятно, да, в левой половинке лежит, то какой будет знак,
плюс или минус? Ну будет, конечно, плюс, вот здесь будет плюс везде, а вот тут будет минус и тут
будет минус, и тут будет минус. То есть если само число а умноженное на х попадает в левую
половинку, то получается плюс, в левую половинку вроде тоже получается плюс, да, да, конечно и так
далее. Так, друзья, вот этот момент понятен? Он простой, он простой. Теперь, что будет с два ах,
с два ах, что будет? Как бы это написать-то? А, что значит, давайте так, что значит ах лежит
в левой половинке? Как-нибудь напишем прям вот совершенно явно, что такое ах лежит в левой
половинке, там где плюс, значит он больше либо равняется, давайте, какого-то k умноженного на
p плюс один и все, да, он больше либо равняется какого-то k на p плюс один и меньше либо равняется того
же самого k на p плюс один и плюс p минус один пополам. Вот это же означает лежать в левой половинке
формально. Существует натуральное число k, с которым ах лежит вот в таких пределах. Тогда два ах в
каких пределах лежит? Это будет 2kp плюс два, а здесь будет 2kp плюс два плюс p минус один. Ну,
это равняется 2k плюс один на p плюс один. Нет? Плюс один лишнее, да? Ой, да, лишнее, ой,
лишнее. Так, действительно ошибся. Минус один, да, это очень важно, иначе ничего не получится,
конечно, конечно, ошибся, виноват. Да, да, да, да, то есть два ах лежит, ну, тоже в каком-то таком вот
интервале, который начинается с 2kp плюс два и заканчивается на, ну, как лучше сказать, может
быть лучше сказать 2kp плюс p минус один. Вот так, 2kp плюс p минус один, то есть находится в том же
самом интервале, который начинается с 2kp плюс один. Ну, тут вот все разбито на такие интервалы. Вот
где-то будет интервал, который начинается с 2kp плюс один, а заканчивается на два, ну, как вот,
2kp плюс один p без единицы. Вообще, на самом деле, наверное, ну, все-таки вот в таком виде понятнее.
Видите, он всегда заканчивается на каком-то числе, умноженном на p без единицы. То есть,
вот это 2ax целиком лежит в интервале, который начинается с 2kp. Ну, это означает, что если вы
2ax теперь поделите на p, то это больше либо равняется 2k плюс два на p, меньше либо равняется 2k плюс
что? Да, p минус один на p. Можно так написать. Давайте 2k плюс p минус один на p. Ну, то есть,
это означает, что когда вы возьмете целую часть, то вы получите 2k. Ура! Абсолютно простая вещь,
но немножко притормаживаю. Если вы теперь возьмете целую часть от 2ax на p, то вы получите 2k и
2k, подставленное вот сюда, даст ту самую плюс единицу, которую мы анонсировали. То есть,
действительно, минус один в степени целая часть от 2ax на p, это единица, коль скоро ax лежит вот
в таких пределах. Позвольте мне вторую половинку не проверять, но все будет то же самое. Понимаете,
да, что дальше то же самое? Ну, точно так же. Пишете неравенство, а x лежит там в каких-то
пределах вот таких. Умножаете на двойку, и там вместо четного 2k получается нечетное 2k плюс
один, которое дает минус единицу. Так что утверждение верно. Это очень приятно. Из этого,
в частности, следует, что a по p, это теперь есть вот такая штука минус один в степени сумма по
x от единицы до p один, целая часть от 2ax на p. Но я сейчас постараюсь рассуждать максимально пафосно,
потому что, ну это мы получили и получили, опять ничего не понятно, все равно же надо складывать
по одно число. А у нас, видите, анонс-то великий, ничего складывать не надо. Вот как бы к этому прийти.
Сейчас будут очень веселые выкладки. Совершенно такие, знаете, прям вот теория чисел,
теория чисел. Да, я не знаю, к чему она равна. Вот я сейчас буду ее считать. Ужас в том, что выглядит,
ну и ничего не получилось. Ну мы бы написали какую-то сумму, и опять ничего нового. Но это
такая тч, прямо в степени тч, тч раз. Я понятно сказал? Очень крутая тч, но...
Где откуда взялась? Что взялось?
Нет, подождите, два я зачеркнул, это была ошибка. Правая граница вот такая,
это вообще надо стереть. Этого нет, я ошибся. Я сказал, что я ошибся, мы это зачеркнули и все,
оно пропало. Его нет ни в коем случае. Так, все, возвращаюсь сюда. Сейчас буду какие-то очень
хитрые выкладки делать. Давайте предположим, сейчас я сюда перепишу то, что у меня получилось.
А дальше можно стирать. Так, минус один, степени сумма по х от единицы до п1, целая часть от 2 х на
п. Это то, что у меня получилось. Давайте считать, что а нечетное число. Зачем-то? Вот просто пусть
а нечетное. Пусть. Для каких-то целей а нечетное число. Так, сейчас рассмотрим символ Лежандра два
а по п. Вот просто рассмотрим такой символ Лежандра два а по п, где а нечетное число. Предполагаем,
что а нечет. Так, я утверждаю, что это то же самое, то четырежды, сейчас будет ужасно, а плюс п пополам
по п. Значит, ужасно то, что вот это не дробь, а символ Лежандра, а вот это дробь. Я не знаю,
как с этим бороться. Можно взять одна вторая, наверное, умноженная на а плюс п. Сейчас увидите,
сейчас увидите, в этом великий замысел. Я говорю тч в степени тч тч раз. То есть это такая перегонка,
которую, ну, конечно, надо придумать. Ну, перегонка. Так, друзья, вы поняли, да, что вот это символ
Лежандра, а вот в этих скобках находится просто дробь. Так, почему это верно, вы понимаете? То есть
вот здесь наверху написано два а плюс два п, два а плюс два п. Но согласитесь, что факт о том,
что два а является квадратичным вычетом или не является, равносилен факту о том, что таковым
является или не является два а плюс два п. Если мы сдвигаемся на модуль, то от этого не меняется,
скажите, справедливость того является это вычетом или нет. Вот, поэтому мы можем сдвинуть. Так что
действительно имеет место вот это равенство. А теперь мы пользуемся вот этой формулой. Да нет,
но не совсем. Мы замечаем, что сперва мы замечаем, что имеет место мультипликативность. То есть вот так.
Это четыре по п умножить на, давайте я так напишу, одна вторая а плюс п по п. Мультипликативность,
помните, имеет место. Это тоже очень важно. Но четыре по п это что такое? Всегда единица, конечно.
Опять по мультипликативности это два по п в квадрате. Это единица, поэтому мы получаем просто
одна вторая а плюс п по п. Если кто не понял, нечетность а используется вот в этом месте. То,
что а нечетная, оно прибавляется к нечетному простому, получается, что она действительно делится пополам.
Так можно сделать. Для четного так сделать нельзя. Так, ну и теперь применяем вот эту формулу. Минус один
в тепени сумма по х от единицы до п один. Целая часть. Ну а вместо а мы подставляем одна вторая
а плюс п. То есть получается а плюс п на х поделить на п. Последили, товарищи? Ну мы используем
формулу для символа Лежандра. В этом месте она верна для любого а. Например, вместо а можно
взять полусумму а и п. Подставляем вместо а полусумму, двойка с половинкой сокращается,
остается а плюс п на х. Ёлки-палки, извините, пожалуйста, сейчас я все-таки возьму. Смотрите,
я вот так это перепишу. Минус один в тепени сумма по х от единицы до п один. Целая часть вот а х на
п. Целая часть закрывается и к этому прибавляется х. Вот так. Смотрите, пх поделить на п это просто
х. Это целое число в пределах от единицы до п один. Поэтому его можно вынести из подзнака целой
части. Это равно. Давайте, ладно, сюда не буду ниже писать. Минус один в тепени суммы по х от единицы
до п один. Целая часть а х на п плюс. А сумма х это п один на п один плюс один пополам. Но это
просто сумма арифметической прогрессии. Тут ничего умного нет. Вспоминаем, что п один это п минус один пополам.
Но осталось чуть-чуть, да. Смотрите, у нас получается минус один в тепени суммы по х от
единицы до п один. Целая часть а х на п. И вот здесь как раз вылезает п квадрат минус один поделенное
на восемь, которое успели стереть, но оно было в утверждении доказываемым нами в теореме. П один
это п минус один пополам. То есть здесь стоит п минус один пополам, здесь п плюс один пополам.
Итого п квадрат минус один на четыре и еще пополам. Почитали в уме? Успеваете? Так, сейчас будет
абсолютный катарсис. Так, так, так, смотрите. Подставим а равные единицы. Ну, то есть мы получим,
что вот сюда подставим? Получим два по п, два по п. А справа мы получим минус один в тепени суммы
по х от единицы до п один. Целая часть х х на п. Прибавить п квадрат минус один на восемь. Но
все х меньше, чем п. Это числа от единицы до п один. Поэтому все целые части равны нулю. Мы
складываем много нулей и в итоге получаем ровно то, что и заявляли. Теорема доказана.
Доказано? Нечетно а подставили. Равные единицы. Почему бы нет? Но есть еще одно следствие важное.
Значит, смотрите. Мы же доказали, что два по п такое. Следствие, если а нечетно и не обязательно
равно единицы, любое, если а нечетно, то два а по п равняется, ну давайте, а нет, не два а по п,
а по п. А по п равняется минус один в тепени суммы по х от единицы до п один. Целая часть от а х на
п. Это жесть, понимаете? Вот смотрите сюда, вот в этот уголок. Здесь написано, что а по п всегда,
при любом а, равняется минус один в степени суммы, целая часть два а х на п. А тут мы говорим,
если а нечетно, то двойку можно убрать. А вот туда и дели. П квадрат минус один на восемь,
то был до два а по п. То есть доказательство следствия, это какое? Пользуемся здесь
мультипликативностью. Два а по п, это два по п умножить на а по п и два по п сокращаем.
Да, я понимаю.
Не, не так.
Не, сейчас, что ж такое? Ой, сейчас, сейчас, сейчас, запутался.
Все нормально, да, да, да. А, сюда, вот сюда надо смотреть, да. Повезло. Повезло. Смотрите,
два а по п, вот тут много-много равенства, оно равно вот этому. Но я здесь его еще раз переписал,
оно же равно вот этому, правильно? Да, два по п равно вот этому. По мультипликативности оно равно
вот этому. Два по п мы нашли просто, нашли, мы его знаем. Поэтому смотрите вот сюда и смотрите
вот сюда. Вот это с вот этим сокращается и остается следствие в аккурат. Пояснил теперь всем?
Но это, конечно, так офигенно звучит. Для всех а двойка нужна, а для нечетных а можно двойку убрать.
И это очень полезно. Сейчас я объясню почему. Я, конечно, хочу надеяться, что я успею, но что-то у
меня... Значит, вот есть такой великий факт, который называется квадратичный закон взаимности,
и который позволяет искать не только два по п, но очень многие значения символов лижандра.
Квадратичный закон взаимности. Друзья, ну точно с темпом пока все нормально? Все успевали, да?
Значит, квадратичный закон взаимности звучит так. Пq нечетные и простые, пусть нечетные и
простые. Тогда p по q умножить на q по p, такая взаимность, p по q на q по p, равняется минус 1 в
степени p1 умножить на q1. Где q1 это, конечно, q-1 пополам. p1 это p-1 пополам, q1 это q-1 пополам.
Точно так же, как и p. Вот такое утверждение. Сейчас я попробую его успеть доказать. q1 вот здесь,
да, это q-1 пополам. p1 это p-1 пополам, а q1 q-1 пополам. Ой, что? Ох-ох-ох-ох. Так. Нет,
смотри, что мы знаем. Давайте я буду доказывать. Мы знаем, что p по q на q по p, согласно вот этой
последней замечательной записи, вот она важна здесь, она принципиальна в этом доказательстве.
Есть разные доказательства, но вот мое доказательство на это завязано жестко. Значит,
тут будет минус 1 в степени сумма по х от единицы до p1, целая часть qх на p, плюс, это все в
показателе минус единица, сумма давайте по у от единицы до q1, целая часть py поделить на q.
Это мы знаем, это мы знаем согласно следствию, написанному в середине доски. Теперь знаете,
что мы сделаем? Давайте сделаем вот, что мы хотим доказать, мы же хотим доказать,
что это p1 умножить на q1, но я пока поставлю три знака вопроса, потому что это вроде не очевидно,
но давайте просто посчитаем разными способами количество пар x и y таких, что единица меньше
либо равняется x, меньше либо равняется p1, единица меньше либо равняется y, меньше либо равняется q1.
Просто все пары чисел прямоугольники в декардовом произведении. Не, ну понятно,
что их p1 на q1, товарищи. Это вот совершенно понятно. Понятно, ну вы понимаете, я хочу доказать,
что их на самом деле и столько тоже, то есть можно так посчитать. Объясняю, почему это так. Но,
смотрите, во-первых, давайте заметим, что py не равно qx никогда. Понятно, почему py не равно qx?
Нет? Но почему py не равно qx? Ну пусть py больше, чем qx, хорошо, да? А, хорошо, я понял,
так возьмем пусть p больше, чем q, так? Справа в qx не может быть множителя p, потому что x
меняется до p-1 пополам, а q меньше, чем p. Да, не может быть множителя p, ну все вроде. Друзья,
понятно сейчас? Ну и наоборот точно так же. Так, py не равняется qx. Ну, значит,
количество пар можно сложить, как количество пар, для которых здесь это написано. Вот можно
такие пары посмотреть, а можно посмотреть, я лучше вот так напишу, вот такие пары, qx больше,
чем py. Вот есть такие, а есть такие. Равных не бывает. Ну, сколько таких? А, наверное,
надо было в другую писать, qx меньше, чем py, вот так. Сколько таких? Но это значит,
что x меньше, чем py поделить на q. Но, то есть, x меньше либо меньше, либо равняется целой
части от py поделить на q, правда? Для каждого y от единицы до q1 таких x вот ровно эта целая часть.
То есть, сумма по y от единицы до q1 таких вот целых частей, это и есть количество таких пар.
Написать на доске что-то или что? Не очень понятно на слух. Значит, смотрите,
еще раз. Понятно, что количество всех пар складывается как сумма. Количество таких
пар и количество таких пар. Или отписать на доске тоже. Так, хорошо. Количество пар xy таких,
что qx меньше, чем py, плюс количество пар xy таких, что py меньше, чем qx. Эта вот сумма,
это и есть p1 на q1. Вот эта сумма, которая сейчас написана на доске, это p1 на q1.
Ну, может быть, вы не понимаете. Конечно, вот это предполагается выполненным и тут, и тут. То есть,
количество пар, для которых, конечно, вот это все выполнено, и при этом еще qx меньше, чем py.
Отдельно количество пар, для которых вот это все выполнено, и py наоборот меньше, чем qx. Ну,
естественно, в сумме это будет количество всех пар, то есть p1 на q1. Сейчас я понятно сказал? Сейчас
успели все? Так, считаем количество вот этих пар. Смотрите, я написал, то вот это вот, давайте
я тут подчеркну, и вот тут подчеркну. Вот это вот нераменство qx меньше, чем py, равносильно тому,
что x меньше, чем py поделить на q, а это равносильно тому, что x не превосходит целой части. Потому что
не делится, да. Потому что не делится. Ровносильно тому, что x не превосходит целой части. Так,
мы считаем количество пар x и y, для которых qx меньше, чем py. Для каждого y... Ну, давайте
я что-нибудь сотру, раз вы хотите, чтобы я писал. Сотру. Значит, для каждого y от единицы до q1...
Так, для каждого y от единицы до q1 количество таких x, что qx меньше, чем py,
py равно целой части от py поделить на q. Это мы только что доказали. Вот таких x-ов столько. Сейчас,
друзья, это понятно? Ну как, ну что-то что-то непонятного-то. Но мы зафиксировали какое-то
число y, неважно сейчас в каких пределах. Ну, в этих пределах, конечно. Мы его зафиксировали. Мы
хотим найти количество x-ов, для которых qx меньше, чем py. x-ы меняются от единицы там до чего-то,
да. Но такие x-ы должны не превосходить вот эту целую часть. Но если они от единицы меняются,
значит их и есть столько, сколько написано справа. Вроде понятно, да? Вот я написал их целая часть
py поделить на q. Это для каждого y так. Ну, значит, количество пар x-y, для которых, давайте я вот это
количество пар все как-нибудь обозначу буквой k1, а вот это количество пар обозначу буквой k2.
Ну, тогда отсюда следует, что k1 это сумма по y от единицы до q1 вот этих целых частей py поделить
на q. Для каждого y столько x-ов, а количество пар x-y это надо просуммировать по всем y количество
x-ов. Так, друзья, у меня был контрольный слушатель, на которого я смотрел, но, может, я на кого-то
еще должен посмотреть. Понятно, нет? Как посчитать пары? Зафиксировать y и посмотреть, сколько
соответствующих x-ов, потом зафиксировать другой y и так сложить. Но совершенно аналогично k2 равняется
сумма по x от единицы до p1 целая часть от qx поделить на p. Абсолютно аналогично, просто то же самое рассуждение.
Кто не выйдет за пределы? Py поделить на q, ну давайте сравним, или что?
Да-да-да-да-да. Значит, нам что нужно доказать? Что целая часть py поделить на q не превосходит
p-1 пополам, но это вроде очевидно. Нет, разве? Или не это мы хотим доказать? По-моему, ровно это. Да,
я вроде понял вопрос. То есть, вот когда я отвечал на вопрос контрольного слушателя, я долго втирал,
что x должен не превосходить вот этого, значит, количество x-ов такое, потому что x-ы стартуют
единицы. Но вопрос другой, а вдруг x-а должно быть не больше, чем p1? А вдруг это число больше,
чем p1? Тогда мы лишнее посчитали. То есть, вопрос Тихона про то, верно ли, что вот такое неравенство
выполняется. Но у нас y не превосходит q1, который q-1 пополам. И если мы q-1 пополам делим на q,
то это получается строго меньше 1 второй, ну и когда мы возьмем целую часть, мы получим вот
этот неравенство. Так что это правильный вопрос, но это верно. Мы действительно не вылезаем ни
в какой момент за границей, и поэтому не надо здесь брать, условно говоря, минимум из q1 и
чего-то такого. Или вот здесь вот минимум, вот здесь не надо брать. Целая часть, это правильный
ответ. Все, k1 плюс k2, это q1 на p1, ну вот оно. Это что такое? Это k2, да? Это k2, а вот это вот k1. Мы доказали.
Мы доказали, что количество вот этих пар, которые очевидно равно p1 на q1,
можно вот так вот хитро пересчитать как сумму двух сумм. А поскольку мы знаем, что произведение
символов Лежандра это минус один в степени суммы этих двух сумм, ну значит мы действительно
получаем, что это минус один в степени p1 на q1. Такой вот квадратичный закон взаимности. Ну,
понятно, мы знаем 2 по p, значит мы, наверное, можем вычислить еще и p по 2 там, или что-нибудь в
таком духе. Мы можем много чего найти с на этот закон. Ну наоборот скорее, да, это правда.
Так, друзья, ну вот доказательства было понятно сейчас целиком? Квадратичного
закона. Поднимите руки, кто понял. Ну хорошо. Это великий закон, у него есть миллион разных
доказательств, но я вот всегда так рассказываю. В принципе, это соответствует изложению из
книжки Виноградова. Знаете такую книжку? Есть такая книжка Виноградова «Основы теории чисел».
Значит, она с одной стороны очень хорошая, потому что написано подробно по пунктикам,
там прямо все очень-очень аккуратно. С другой стороны, она кокоющая, она обманчиво понятная,
она тонюсенькая такая, там вроде все кротенько так написано, а потом вы открываете задачки,
и оказывается, что там какие-то нерешенные проблемы в задачках. В общем, она такая,
она с двойным дном на самом деле, но книжка неплохая, можете посмотреть. Ладно, все,
тогда на сегодня я закончу.
